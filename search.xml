<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Nextcloudç§æœ‰ç½‘ç›˜çš„å¤‡ä»½ä¸è¿ç§»</title>
      <link href="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/"/>
      <url>/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€è™šæ‹Ÿæœºç¯å¢ƒæ­å»º"><a href="#ä¸€ã€è™šæ‹Ÿæœºç¯å¢ƒæ­å»º" class="headerlink" title="ä¸€ã€è™šæ‹Ÿæœºç¯å¢ƒæ­å»º"></a>ä¸€ã€è™šæ‹Ÿæœºç¯å¢ƒæ­å»º</h1><hr><p>æœ¬æ¬¡å®è·µæ˜¯é€šè¿‡Vmwareè™šæ‹Ÿæœºæ˜¯å®ç°çš„ï¼Œ</p><ul><li>åŸºäºCentOS 7 64ä½ç³»ç»Ÿï¼Œ</li><li>1æ ¸1G 20G</li><li>ç½‘ç»œæ¡¥æ¥</li><li>ä½¿ç”¨1panelé¢ç‰ˆ</li><li>dockeréƒ¨ç½²çš„mysqlå’Œnextcloud</li></ul><p>æ¥ä¸‹æ¥å¼€å§‹</p><h2 id="åˆ›å»ºç¬¬ä¸€å°è™šæ‹Ÿæœº"><a href="#åˆ›å»ºç¬¬ä¸€å°è™šæ‹Ÿæœº" class="headerlink" title="åˆ›å»ºç¬¬ä¸€å°è™šæ‹Ÿæœº"></a>åˆ›å»ºç¬¬ä¸€å°è™šæ‹Ÿæœº</h2><p>æ‰“å¼€VMwareè™šæ‹Ÿæœºâ€“&gt;æ–°å»ºè™šæ‹Ÿæœºâ€“&gt;å…¸å‹â€“&gt;ä¸‹ä¸€æ­¥â€“&gt;é€‰æ‹©è‡ªå·±å‡†å¤‡å¥½çš„æ˜ åƒæ–‡ä»¶ï¼ˆCentOS-7-x86_64-DVD-2009.isoï¼‰â€“&gt;ä¸‹ä¸€æ­¥â€“&gt;è‡ªå·±å–åå­—å’Œä½ç½®â€“&gt;ä¸‹ä¸€æ­¥â€“&gt;20G,å°†è™šæ‹Ÿç£ç›˜æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶â€“&gt;ä¸‹ä¸€æ­¥â€“&gt;<br>è‡ªå®šä¹‰ç¡¬ä»¶â€“&gt;ç½‘ç»œé€‚é…å™¨â€“&gt;æ¡¥æ¥æ¨¡å¼ï¼Œå¤åˆ¶ç‰©ç†ç½‘ç»œè¿æ¥çŠ¶æ€â€“&gt;å®Œæˆ</p><p>ç¼–è¾‘â€“&gt;è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨â€“&gt;æ›´æ”¹è®¾ç½®â€“&gt;æ¡¥æ¥æ¨¡å¼â€“&gt;ä»¥æ¡¥æ¥è‡³WiFiâ€“&gt;åº”ç”¨ï¼Œå®Œæˆ</p><p>è‡ªå·±åˆå§‹åŒ–å¼€æœº<br>ç”¨æˆ·ï¼šroot<br>å¯†ç ï¼š123456</p><ol><li><p>å…³é—­é˜²ç«å¢™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure></li><li><p>ç¼–å†™ç½‘ç»œé…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-ens33 </span><br></pre></td></tr></table></figure><p>ifcfg-ens33æ–‡ä»¶å†…å®¹</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">TYPE=Ethernet</span></span><br><span class="line"><span class="string">PROXY_METHOD=none</span></span><br><span class="line"><span class="string">BROWSER_ONLY=no</span></span><br><span class="line"><span class="string">BOOTPROTO=static</span>  <span class="comment"># &lt;--ipåœ°å€æ”¹ä¸ºé™æ€</span></span><br><span class="line"><span class="string">DEFROUTE=yes</span></span><br><span class="line"><span class="string">IPV4_FAILURE_FATAL=no</span></span><br><span class="line"><span class="string">IPV6INIT=yes</span></span><br><span class="line"><span class="string">IPV6_AUTOCONF=yes</span></span><br><span class="line"><span class="string">IPV6_DEFROUTE=yes</span></span><br><span class="line"><span class="string">IPV6_FAILURE_FATAL=no</span></span><br><span class="line"><span class="string">IPV6_ADDR_GEN_MODE=stable-privacy</span></span><br><span class="line"><span class="string">NAME=ens33</span></span><br><span class="line"><span class="string">UUID=c001d0a2-561f-xxxxxxxx-59853fe09d04</span></span><br><span class="line"><span class="string">DEVICE=ens33</span></span><br><span class="line"><span class="string">ONBOOT=yes</span>    <span class="comment"># &lt;--è¿™é‡Œå¿…é¡»æ”¹ä¸ºyes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸‹æ˜¯è¦æ·»åŠ çš„å†…å®¹ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®¿ä¸»æœºç¡®å®šipåœ°å€çš„ç½‘å…³å’Œå­ç½‘æ©ç </span></span><br><span class="line"><span class="string">IPADDR=192.168.3.31</span></span><br><span class="line"><span class="string">NETMASK=255.255.255.0</span></span><br><span class="line"><span class="string">GATEWAY=192.168.3.1</span></span><br><span class="line"><span class="string">DNS1=8.8.8.8</span></span><br><span class="line">       </span><br></pre></td></tr></table></figure></li><li><p>ä¿å­˜é‡å¯ç³»ç»Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">init 6</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ipåœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip a</span><br></pre></td></tr></table></figure><p>5545</p></li><li><p>pingä¸€ä¸‹å¤–ç½‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.baidu.com</span><br></pre></td></tr></table></figure><p><img src="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/file-20251130162037692.png"><br>ç½‘ç»œè¿æ¥æˆåŠŸ</p></li><li><p>æ›´æ–°æº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vi /etc/yum.repos.d/CentOS-Base.repo</span><br></pre></td></tr></table></figure><p>CentOS-Base.repo</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">base</span>]</span><br><span class="line"><span class="string">name=CentOS-$releasever</span> <span class="bullet">-</span> <span class="string">Base</span> <span class="bullet">-</span> <span class="string">Alibaba</span> <span class="string">Cloud</span></span><br><span class="line"><span class="string">baseurl=http://mirrors.aliyun.com/centos/7/os/$basearch/</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"></span><br><span class="line">[<span class="string">updates</span>]</span><br><span class="line"><span class="string">name=CentOS-$releasever</span> <span class="bullet">-</span> <span class="string">Updates</span> <span class="bullet">-</span> <span class="string">Alibaba</span> <span class="string">Cloud</span></span><br><span class="line"><span class="string">baseurl=http://mirrors.aliyun.com/centos/7/updates/$basearch/</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"></span><br><span class="line">[<span class="string">extras</span>]</span><br><span class="line"><span class="string">name=CentOS-$releasever</span> <span class="bullet">-</span> <span class="string">Extras</span> <span class="bullet">-</span> <span class="string">Alibaba</span> <span class="string">Cloud</span></span><br><span class="line"><span class="string">baseurl=http://mirrors.aliyun.com/centos/7/extras/$basearch/</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"></span><br><span class="line">[<span class="string">centosplus</span>]</span><br><span class="line"><span class="string">name=CentOS-$releasever</span> <span class="bullet">-</span> <span class="string">Plus</span> <span class="bullet">-</span> <span class="string">Alibaba</span> <span class="string">Cloud</span></span><br><span class="line"><span class="string">baseurl=http://mirrors.aliyun.com/centos/7/centosplus/$basearch/</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line"><span class="string">enabled=0</span></span><br></pre></td></tr></table></figure></li></ol><p>æ¸…ç†ç¼“å­˜ + é‡å»ºç¼“å­˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum clean all </span><br><span class="line"><span class="built_in">sudo</span> yum makecache</span><br></pre></td></tr></table></figure><ol start="7"><li><p>æ›´æ–°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum install update -y</span><br><span class="line"><span class="built_in">sudo</span> yum install upgrade -y</span><br></pre></td></tr></table></figure></li><li><p>æŒ‰è£…å¯èƒ½éœ€è¦çš„æŒ‡ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install vim -y</span><br><span class="line">yum install screen -y</span><br><span class="line">yum install tree -y</span><br><span class="line">yum install rsync -y </span><br></pre></td></tr></table></figure></li></ol><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><p>9.<a href="../linux%E5%AE%89%E8%A3%85docker.md">æŒ‰è£…docker</a></p><p>åœ¨ CentOS 7 ä¸Šå®‰è£… Docker çš„æ­¥éª¤å¦‚ä¸‹ã€‚ç”±äº <strong>CentOS 7 å·²äº 2024 å¹´ 6 æœˆ 30 æ—¥åœæ­¢ç»´æŠ¤ï¼ˆEOLï¼‰</strong>ï¼Œå®˜æ–¹ Docker ä¸å†æ”¯æŒç›´æ¥é€šè¿‡ <code>docker-ce</code> å®‰è£…ï¼Œä½†ä½ ä»å¯é€šè¿‡ä»¥ä¸‹æ–¹æ³•æˆåŠŸå®‰è£… <strong>Docker Engineï¼ˆç¤¾åŒºç‰ˆï¼‰</strong> æˆ–ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆã€‚</p><blockquote><p>ğŸ’¡ å‰æï¼šå·²é…ç½®å¥½ç½‘ç»œï¼ˆèƒ½è®¿é—®å¤–ç½‘ï¼‰ï¼Œå¹¶æ›´æ¢äº† yum æºï¼ˆå¦‚é˜¿é‡Œäº‘æºï¼‰</p></blockquote><hr><h3 id="ç¬¬ä¸€æ­¥ï¼šå¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¦‚æœ‰ï¼‰"><a href="#ç¬¬ä¸€æ­¥ï¼šå¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¦‚æœ‰ï¼‰" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¦‚æœ‰ï¼‰"></a>ç¬¬ä¸€æ­¥ï¼šå¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¦‚æœ‰ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure><hr><h3 id="ç¬¬äºŒæ­¥ï¼šå®‰è£…å¿…è¦ä¾èµ–"><a href="#ç¬¬äºŒæ­¥ï¼šå®‰è£…å¿…è¦ä¾èµ–" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå®‰è£…å¿…è¦ä¾èµ–"></a>ç¬¬äºŒæ­¥ï¼šå®‰è£…å¿…è¦ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure><hr><h3 id="ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ -Docker-å®˜æ–¹ä»“åº“ï¼ˆä½¿ç”¨é˜¿é‡Œäº‘é•œåƒä»£ç†ï¼‰"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ -Docker-å®˜æ–¹ä»“åº“ï¼ˆä½¿ç”¨é˜¿é‡Œäº‘é•œåƒä»£ç†ï¼‰" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ  Docker å®˜æ–¹ä»“åº“ï¼ˆä½¿ç”¨é˜¿é‡Œäº‘é•œåƒä»£ç†ï¼‰"></a>ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ  Docker å®˜æ–¹ä»“åº“ï¼ˆä½¿ç”¨é˜¿é‡Œäº‘é•œåƒä»£ç†ï¼‰</h3><blockquote><p>âš ï¸ å®˜æ–¹ <code>download.docker.com</code> åœ¨ CentOS 7 ä¸Šå¯èƒ½æ— æ³•è§£ææˆ–ä¸‹è½½å¤±è´¥ï¼Œå»ºè®®ä½¿ç”¨ <strong>é˜¿é‡Œäº‘ Docker CE é•œåƒ</strong></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªåœ°å€æ˜¯é˜¿é‡Œäº‘å¯¹ Docker å®˜æ–¹ä»“åº“çš„é•œåƒï¼Œé€Ÿåº¦æ›´å¿«ä¸”å…¼å®¹ CentOS 7ã€‚</p></blockquote><hr><h3 id="ç¬¬å››æ­¥ï¼šå®‰è£…-Docker-Engine"><a href="#ç¬¬å››æ­¥ï¼šå®‰è£…-Docker-Engine" class="headerlink" title="ç¬¬å››æ­¥ï¼šå®‰è£… Docker Engine"></a>ç¬¬å››æ­¥ï¼šå®‰è£… Docker Engine</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum install -y docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæç¤ºæ‰¾ä¸åˆ°åŒ…ï¼Œå¯å…ˆåˆ—å‡ºå¯ç”¨ç‰ˆæœ¬ï¼š</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | <span class="built_in">sort</span> -r</span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‡å®šç‰ˆæœ¬å®‰è£…ï¼ˆä¾‹å¦‚ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum install -y docker-ce-20.10.21 docker-ce-cli-20.10.21 containerd.io</span><br></pre></td></tr></table></figure><hr><h3 id="ç¬¬äº”æ­¥ï¼šå¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯"><a href="#ç¬¬äº”æ­¥ï¼šå¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯" class="headerlink" title="ç¬¬äº”æ­¥ï¼šå¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯"></a>ç¬¬äº”æ­¥ï¼šå¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl start docker</span><br><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><p>éªŒè¯æ˜¯å¦è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> docker --version</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docker version 20.10.21, build baeda1f</span><br></pre></td></tr></table></figure><h2 id="ipanelé¢æ¿"><a href="#ipanelé¢æ¿" class="headerlink" title="ipanelé¢æ¿"></a>ipanelé¢æ¿</h2><ol start="10"><li>å®‰è£…1panelé¢æ¿<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh -o quick_start.sh &amp;&amp; bash quick_start.sh</span><br></pre></td></tr></table></figure>ä»¥ä¸Šæ¥ä¸‹æ¥çš„å®‰è£…æ­¥éª¤çœç•¥</li></ol><h3 id="å®‰è£…mysql"><a href="#å®‰è£…mysql" class="headerlink" title="å®‰è£…mysql"></a>å®‰è£…mysql</h3><p>å…è®¸å¤–éƒ¨è®¿é—®<br>å®¹å™¨åï¼šmysql<br>rootè´¦æˆ·å¯†ç ï¼š123456</p><p><img src="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/file-20251130164054918.png"></p><h3 id="å®‰è£…nextcloud"><a href="#å®‰è£…nextcloud" class="headerlink" title="å®‰è£…nextcloud"></a>å®‰è£…nextcloud</h3><p>å…è®¸å¤–éƒ¨è®¿é—®<br>å®¹å™¨åï¼šnextcloud</p><p><img src="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/file-20251130164355366.png"></p><h2 id="åˆ›å»ºç¬¬äºŒå°è™šæ‹Ÿæœº"><a href="#åˆ›å»ºç¬¬äºŒå°è™šæ‹Ÿæœº" class="headerlink" title="åˆ›å»ºç¬¬äºŒå°è™šæ‹Ÿæœº"></a>åˆ›å»ºç¬¬äºŒå°è™šæ‹Ÿæœº</h2><p>ä»¥å…‹éš†çš„æ–¹å¼ï¼Œå…³æœºï¼Œç»™ç°åœ¨çš„è™šæ‹Ÿæœºæ‹å¿«ç…§</p><p>è™šæ‹Ÿæœºâ€“&gt;ç®¡ç†â€“&gt;å…‹éš†â€“&gt;ä¸‹ä¸€é¡µâ€“&gt;å…‹éš†è‡ªè™šæ‹Ÿæœºå½“å‰çŠ¶æ€â€“&gt;åˆ›å»ºå®Œå…¨å…‹éš†ï¼Œä¸‹ä¸€é¡µâ€“&gt;å…‹éš†åå­—è‡ªå·±å–â€“&gt;å®Œæˆ</p><p>å¯åŠ¨ï¼Œä¿®æ”¹ipåœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-ens33 </span><br></pre></td></tr></table></figure><p>æ”¹ä¸ºä¸€ä»¥ä¸‹:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">TYPE=Ethernet</span></span><br><span class="line"><span class="string">PROXY_METHOD=none</span></span><br><span class="line"><span class="string">BROWSER_ONLY=no</span></span><br><span class="line"><span class="string">BOOTPROTO=static</span></span><br><span class="line"><span class="string">DEFROUTE=yes</span></span><br><span class="line"><span class="string">IPV4_FAILURE_FATAL=no</span></span><br><span class="line"><span class="string">IPV6INIT=yes</span></span><br><span class="line"><span class="string">IPV6_AUTOCONF=yes</span></span><br><span class="line"><span class="string">IPV6_DEFROUTE=yes</span></span><br><span class="line"><span class="string">IPV6_FAILURE_FATAL=no</span></span><br><span class="line"><span class="string">IPV6_ADDR_GEN_MODE=stable-privacy</span></span><br><span class="line"><span class="string">NAME=ens33</span></span><br><span class="line"><span class="string">UUID=dc5079e4-1f77-4d20-8e81-37ffed5dfd6f</span></span><br><span class="line"><span class="string">DEVICE=ens33</span></span><br><span class="line"><span class="string">ONBOOT=yes</span></span><br><span class="line"><span class="string">IPADDR=192.168.3.32</span>  <span class="comment"># &lt;--è¿™é‡Œä¿®æ”¹äº†</span></span><br><span class="line"><span class="string">GATEWAY=192.168.3.1</span></span><br><span class="line"><span class="string">PREFIX=24</span></span><br><span class="line"><span class="string">DNS1=8.8.8.8</span></span><br></pre></td></tr></table></figure><p>ä¿å­˜é‡å¯è™šæ‹Ÿæœº</p><p>æŸ¥çœ‹ipåœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip a</span><br></pre></td></tr></table></figure><p><img src="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/file-20251130165641533.png"></p><h2 id="åˆ›å»ºåå­—ä¸ºNextcloudDBçš„æ•°æ®åº“"><a href="#åˆ›å»ºåå­—ä¸ºNextcloudDBçš„æ•°æ®åº“" class="headerlink" title="åˆ›å»ºåå­—ä¸ºNextcloudDBçš„æ•°æ®åº“"></a>åˆ›å»ºåå­—ä¸ºNextcloudDBçš„æ•°æ®åº“</h2><p>ä¸‹é¢çš„å¯†ç ä¸º123456</p><p><img src="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/file-20251130164241197.png"></p><h1 id="ä¸‰ã€-æ•°æ®å¤‡ä»½"><a href="#ä¸‰ã€-æ•°æ®å¤‡ä»½" class="headerlink" title="ä¸‰ã€ æ•°æ®å¤‡ä»½"></a>ä¸‰ã€ æ•°æ®å¤‡ä»½</h1><hr><h2 id="æŸ¥çœ‹docker-compose-yml"><a href="#æŸ¥çœ‹docker-compose-yml" class="headerlink" title="æŸ¥çœ‹docker-compose.yml"></a>æŸ¥çœ‹docker-compose.yml</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">networks:</span></span><br><span class="line">    <span class="attr">1panel-network:</span></span><br><span class="line">        <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">nextcloud:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">$&#123;CONTAINER_NAME&#125;</span></span><br><span class="line">        <span class="attr">deploy:</span></span><br><span class="line">            <span class="attr">resources:</span></span><br><span class="line">                <span class="attr">limits:</span></span><br><span class="line">                    <span class="attr">cpus:</span> <span class="string">$&#123;CPUS&#125;</span></span><br><span class="line">                    <span class="attr">memory:</span> <span class="string">$&#123;MEMORY_LIMIT&#125;</span></span><br><span class="line">        <span class="attr">environment:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">PUID=1000</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">PGID=1000</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">TZ=$&#123;TIME_ZONE&#125;</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">linuxserver/nextcloud:32.0.2</span></span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">            <span class="attr">createdBy:</span> <span class="string">Apps</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">1panel-network</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">$&#123;HOST_IP&#125;:$&#123;PANEL_APP_PORT_HTTPS&#125;:443</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./data/config:/config</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./data/data:/data</span></span><br><span class="line"><span class="string">è¿™æ˜¯docker-compose.ymlæ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>æ ¹æ® <code>docker-compose.yml</code> æ–‡ä»¶å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®š Nextcloud çš„æ•°æ®ç›®å½•å’Œé…ç½®æ–‡ä»¶çš„æŒ‚è½½è·¯å¾„ã€‚</p><h3 id="å…³é”®ä¿¡æ¯è§£æ"><a href="#å…³é”®ä¿¡æ¯è§£æ" class="headerlink" title="å…³é”®ä¿¡æ¯è§£æ"></a>å…³é”®ä¿¡æ¯è§£æ</h3><p>ä» <code>docker-compose.yml</code> æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°ä»¥ä¸‹é‡è¦ä¿¡æ¯ï¼š</p><ul><li><strong>æœåŠ¡å</strong>ï¼š<code>nextcloud</code></li><li><strong>ç½‘ç»œ</strong>ï¼šä½¿ç”¨å¤–éƒ¨ç½‘ç»œÂ <code>1panel-network</code></li><li><strong>ç¯å¢ƒå˜é‡</strong>ï¼šåŒ…æ‹¬ PUIDã€PGID å’Œæ—¶åŒºç­‰</li><li><strong>é•œåƒ</strong>ï¼š<code>linuxserver/nextcloud:32.0.2</code></li><li><strong>ç«¯å£æ˜ å°„</strong>ï¼šå°†å®¿ä¸»æœºçš„Â <code>$&#123;HOST_IP&#125;:$&#123;PANEL_APP_PORT_HTTPS&#125;</code>Â ç«¯å£æ˜ å°„åˆ°å®¹å™¨å†…çš„ 443 ç«¯å£</li><li><strong>å·ï¼ˆvolumesï¼‰æŒ‚è½½</strong>ï¼š<ul><li><code>./data/config:/config</code></li><li><code>./data/data:/data</code></li></ul></li></ul><h3 id="æ•°æ®ä¸é…ç½®æ–‡ä»¶ä½ç½®"><a href="#æ•°æ®ä¸é…ç½®æ–‡ä»¶ä½ç½®" class="headerlink" title="æ•°æ®ä¸é…ç½®æ–‡ä»¶ä½ç½®"></a>æ•°æ®ä¸é…ç½®æ–‡ä»¶ä½ç½®</h3><p>åŸºäºä¸Šè¿°ä¿¡æ¯ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p><ol><li><p><strong>Nextcloud ç”¨æˆ·æ–‡ä»¶å­˜å‚¨ç›®å½•</strong>ï¼ˆå³æ•°æ®ç›®å½•ï¼‰æ˜¯æŒ‚è½½åœ¨å®¿ä¸»æœºçš„ <code>./data/data</code> è·¯å¾„ä¸‹ã€‚<br> åœ¨1panelä¸­ï¼Œè¿™åº”è¯¥æ˜¯ <code>/opt/1panel/apps/nextcloud/nextcloud/data/data</code> ç›®å½•ã€‚è¿™ä¸ªç›®å½•å¯¹åº”å®¹å™¨å†…éƒ¨çš„ <code>/data</code> è·¯å¾„ã€‚</p></li><li><p><strong>Nextcloud é…ç½®æ–‡ä»¶</strong> æ˜¯æŒ‚è½½åœ¨å®¿ä¸»æœºçš„ <code>./data/config</code> è·¯å¾„ä¸‹ã€‚</p><p> å¯¹åº”çš„å®Œæ•´è·¯å¾„ä¸º <code>/opt/1panel/apps/nextcloud/nextcloud/data/config</code>ï¼Œè¯¥ç›®å½•å¯¹åº”å®¹å™¨å†…éƒ¨çš„ <code>/config</code> è·¯å¾„ã€‚</p></li></ol><h2 id="å¤‡ä»½ç­–ç•¥"><a href="#å¤‡ä»½ç­–ç•¥" class="headerlink" title="å¤‡ä»½ç­–ç•¥"></a>å¤‡ä»½ç­–ç•¥</h2><h3 id="1-å¤‡ä»½ç”¨æˆ·æ–‡ä»¶ï¼ˆæ•°æ®ç›®å½•ï¼‰"><a href="#1-å¤‡ä»½ç”¨æˆ·æ–‡ä»¶ï¼ˆæ•°æ®ç›®å½•ï¼‰" class="headerlink" title="1. å¤‡ä»½ç”¨æˆ·æ–‡ä»¶ï¼ˆæ•°æ®ç›®å½•ï¼‰"></a>1. å¤‡ä»½ç”¨æˆ·æ–‡ä»¶ï¼ˆæ•°æ®ç›®å½•ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾å¤‡ä»½ç›®å½•ä¸º /backup/nextcloud </span></span><br><span class="line"><span class="built_in">mkdir</span> -p /backup/nextcloud/data </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ rsync æˆ– tar è¿›è¡Œå¤‡ä»½ </span></span><br><span class="line">rsync -a /opt/1panel/apps/nextcloud/nextcloud/data/data/ /backup/nextcloud/data/ </span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨ tar å‹ç¼©å¤‡ä»½ </span></span><br><span class="line">tar czvf /backup/nextcloud_data_$(<span class="built_in">date</span> +%F).tar.gz -C /opt/1panel/apps/nextcloud/nextcloud/data data</span><br></pre></td></tr></table></figure><h3 id="2-å¤‡ä»½æ•°æ®åº“"><a href="#2-å¤‡ä»½æ•°æ®åº“" class="headerlink" title="2. å¤‡ä»½æ•°æ®åº“"></a>2. å¤‡ä»½æ•°æ®åº“</h3><p>é¦–å…ˆéœ€è¦ç¡®è®¤ MySQL&#x2F;MariaDB å®¹å™¨åç§°ã€‚å‡è®¾å®¹å™¨åä¸º <code>mysql-container</code>ï¼ˆè¯·æ›¿æ¢ä¸ºå®é™…çš„å®¹å™¨åï¼‰ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰¾åˆ° MySQL å®¹å™¨å </span></span><br><span class="line">docker ps --format <span class="string">&quot;table &#123;&#123;.Names&#125;&#125;\t&#123;&#123;.Image&#125;&#125;&quot;</span> | grep -E <span class="string">&quot;(mysql|mariadb)&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾ MySQL å®¹å™¨åä¸º mysql-container </span></span><br><span class="line">docker <span class="built_in">exec</span> -i mysql-container sh -c <span class="string">&#x27;exec mysqldump -u root -p&quot;your_mysql_password&quot; nextcloud&#x27;</span> &gt; /backup/nextcloud_db_$(<span class="built_in">date</span> +%F).sql </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœå¯†ç åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œæ¨èä½¿ç”¨ .my.cnf æ–‡ä»¶æ¥é¿å…æ˜æ–‡å¯†ç </span></span><br></pre></td></tr></table></figure><h3 id="3-å¤‡ä»½-Nextcloud-é…ç½®æ–‡ä»¶"><a href="#3-å¤‡ä»½-Nextcloud-é…ç½®æ–‡ä»¶" class="headerlink" title="3. å¤‡ä»½ Nextcloud é…ç½®æ–‡ä»¶"></a>3. å¤‡ä»½ Nextcloud é…ç½®æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -r /opt/1panel/apps/nextcloud/nextcloud/data/config /backup/nextcloud/</span><br></pre></td></tr></table></figure><h1 id="å››ã€æ•°æ®è¿ç§»"><a href="#å››ã€æ•°æ®è¿ç§»" class="headerlink" title="å››ã€æ•°æ®è¿ç§»"></a>å››ã€æ•°æ®è¿ç§»</h1><hr><p>æ•°æ®æ¢å¤è¿‡ç¨‹</p><p>åœ¨ä¸Šé¢çš„ç¯å¢ƒä¸­ï¼ˆ1Panel + Docker + <code>linuxserver/nextcloud</code> é•œåƒï¼‰ï¼Œ<strong>æ¢å¤ Nextcloud æ•°æ®</strong>éœ€è¦æŒ‰é¡ºåºæ¢å¤ <strong>æ•°æ®åº“</strong> å’Œ <strong>æ–‡ä»¶æ•°æ®ï¼ˆåŒ…æ‹¬é…ç½®ï¼‰</strong>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´ã€å®‰å…¨ã€å¯æ“ä½œçš„æ¢å¤æµç¨‹ã€‚</p><h2 id="ğŸ”-æ¢å¤å‰æ"><a href="#ğŸ”-æ¢å¤å‰æ" class="headerlink" title="ğŸ” æ¢å¤å‰æ"></a>ğŸ” æ¢å¤å‰æ</h2><ul><li>ä½ æœ‰ä»¥ä¸‹å¤‡ä»½å†…å®¹ï¼š<ul><li>æ•°æ®åº“ SQL æ–‡ä»¶ï¼ˆå¦‚Â <code>db_20251129.sql</code>ï¼‰</li><li>ç”¨æˆ·æ–‡ä»¶ç›®å½•ï¼ˆå¦‚Â <code>/backup/nextcloud/data/</code>ï¼‰</li><li>é…ç½®ç›®å½•ï¼ˆå¦‚Â <code>/backup/nextcloud/config/</code>ï¼‰</li></ul></li><li>Nextcloud å®¹å™¨å’Œ MySQL å®¹å™¨<strong>å·²åœæ­¢æˆ–å¤„äºç»´æŠ¤çŠ¶æ€</strong></li><li>ä½ çŸ¥é“æ•°æ®åº“å¯†ç ï¼ˆç”¨äºæ¢å¤ï¼‰</li></ul><h2 id="ğŸš§-ç¬¬ä¸€æ­¥ï¼šåœæ­¢-Nextcloud-å®¹å™¨ï¼ˆé¿å…å†™å…¥å†²çªï¼‰"><a href="#ğŸš§-ç¬¬ä¸€æ­¥ï¼šåœæ­¢-Nextcloud-å®¹å™¨ï¼ˆé¿å…å†™å…¥å†²çªï¼‰" class="headerlink" title="ğŸš§ ç¬¬ä¸€æ­¥ï¼šåœæ­¢ Nextcloud å®¹å™¨ï¼ˆé¿å…å†™å…¥å†²çªï¼‰"></a>ğŸš§ ç¬¬ä¸€æ­¥ï¼šåœæ­¢ Nextcloud å®¹å™¨ï¼ˆé¿å…å†™å…¥å†²çªï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ Nextcloud åº”ç”¨ç›®å½• </span></span><br><span class="line"><span class="built_in">cd</span> /opt/1panel/apps/nextcloud/nextcloud </span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢å®¹å™¨ï¼ˆä½¿ç”¨ docker-composeï¼‰ </span></span><br><span class="line">docker-compose down</span><br></pre></td></tr></table></figure><blockquote><p>âš ï¸ æ³¨æ„ï¼šä¸è¦åˆ é™¤å®¹å™¨ï¼Œåªåœæ­¢å³å¯ã€‚<code>docker-compose down</code> ä¼šåœæ‰å®¹å™¨ä½†ä¿ç•™å·ï¼ˆvolumesï¼‰ã€‚</p></blockquote><h2 id="ğŸ—ƒï¸-ç¬¬äºŒæ­¥ï¼šæ¢å¤æ•°æ®åº“"><a href="#ğŸ—ƒï¸-ç¬¬äºŒæ­¥ï¼šæ¢å¤æ•°æ®åº“" class="headerlink" title="ğŸ—ƒï¸ ç¬¬äºŒæ­¥ï¼šæ¢å¤æ•°æ®åº“"></a>ğŸ—ƒï¸ ç¬¬äºŒæ­¥ï¼šæ¢å¤æ•°æ®åº“</h2><h3 id="1-ç¡®è®¤-MySQL-å®¹å™¨æ˜¯å¦è¿è¡Œ"><a href="#1-ç¡®è®¤-MySQL-å®¹å™¨æ˜¯å¦è¿è¡Œ" class="headerlink" title="1. ç¡®è®¤ MySQL å®¹å™¨æ˜¯å¦è¿è¡Œ"></a>1. ç¡®è®¤ MySQL å®¹å™¨æ˜¯å¦è¿è¡Œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps | grep mysql</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡è¿è¡Œï¼Œå…ˆå¯åŠ¨å®ƒï¼ˆå› ä¸ºè¦å¯¼å…¥æ•°æ®ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœ MySQL æ˜¯ç‹¬ç«‹éƒ¨ç½²çš„ï¼ˆé nextcloud compose ç®¡ç†ï¼‰ </span></span><br><span class="line">docker start your-mysql-container-name </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœ MySQL ä¹Ÿåœ¨ nextcloud çš„ compose ä¸­ï¼ˆä¸å¤ªå¯èƒ½ï¼‰ï¼Œåˆ™ï¼š </span></span><br><span class="line"><span class="comment"># docker-compose up -d mysql</span></span><br></pre></td></tr></table></figure><h3 id="2-å¯¼å…¥å¤‡ä»½çš„-SQL-æ–‡ä»¶"><a href="#2-å¯¼å…¥å¤‡ä»½çš„-SQL-æ–‡ä»¶" class="headerlink" title="2. å¯¼å…¥å¤‡ä»½çš„ SQL æ–‡ä»¶"></a>2. å¯¼å…¥å¤‡ä»½çš„ SQL æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾ä½ çš„å¤‡ä»½æ–‡ä»¶æ˜¯ /backup/nextcloud/db_20251129.sql </span></span><br><span class="line"><span class="comment"># å‡è®¾ MySQL å®¹å™¨åä¸º nextcloud-mysql-1ï¼ˆè¯·æ ¹æ®å®é™…è°ƒæ•´ï¼‰ </span></span><br><span class="line"></span><br><span class="line">docker <span class="built_in">exec</span> -i nextcloud-mysql-1 mysql -u root -p<span class="string">&quot;ä½ çš„MySQLå¯†ç &quot;</span> nextcloud &lt; /backup/nextcloud/db_20251129.sql</span><br></pre></td></tr></table></figure><blockquote><p>âœ… æˆåŠŸå¯¼å…¥åï¼Œæ•°æ®åº“å°±æ¢å¤åˆ°å¤‡ä»½æ—¶çš„çŠ¶æ€äº†ã€‚</p></blockquote><h2 id="ğŸ“-ç¬¬ä¸‰æ­¥ï¼šæ¢å¤ç”¨æˆ·æ–‡ä»¶å’Œé…ç½®"><a href="#ğŸ“-ç¬¬ä¸‰æ­¥ï¼šæ¢å¤ç”¨æˆ·æ–‡ä»¶å’Œé…ç½®" class="headerlink" title="ğŸ“ ç¬¬ä¸‰æ­¥ï¼šæ¢å¤ç”¨æˆ·æ–‡ä»¶å’Œé…ç½®"></a>ğŸ“ ç¬¬ä¸‰æ­¥ï¼šæ¢å¤ç”¨æˆ·æ–‡ä»¶å’Œé…ç½®</h2><h3 id="1-æ¸…ç©ºå½“å‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰"><a href="#1-æ¸…ç©ºå½“å‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰" class="headerlink" title="1. æ¸…ç©ºå½“å‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰"></a>1. æ¸…ç©ºå½“å‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰</h3><p>å¦‚æœä½ è¦<strong>å®Œå…¨è¦†ç›–</strong>ç°æœ‰æ•°æ®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤ç°æœ‰ data å’Œ configï¼ˆè°¨æ…ï¼ç¡®ä¿å·²å¤‡ä»½å½“å‰æ•°æ®ï¼‰ </span></span><br><span class="line"><span class="built_in">rm</span> -rf /opt/1panel/apps/nextcloud/nextcloud/data/data/* </span><br><span class="line"><span class="built_in">rm</span> -rf /opt/1panel/apps/nextcloud/nextcloud/data/config/*</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ å¦‚æœåªæ˜¯éƒ¨åˆ†æ¢å¤æˆ–æµ‹è¯•ï¼Œå¯ä»¥è·³è¿‡æ¸…ç©ºï¼Œç›´æ¥è¦†ç›–ã€‚</p></blockquote><h3 id="2-æ¢å¤ç”¨æˆ·æ–‡ä»¶ï¼ˆdataï¼‰"><a href="#2-æ¢å¤ç”¨æˆ·æ–‡ä»¶ï¼ˆdataï¼‰" class="headerlink" title="2. æ¢å¤ç”¨æˆ·æ–‡ä»¶ï¼ˆdataï¼‰"></a>2. æ¢å¤ç”¨æˆ·æ–‡ä»¶ï¼ˆdataï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -a /backup/nextcloud/data/ /opt/1panel/apps/nextcloud/nextcloud/data/data/</span><br></pre></td></tr></table></figure><h3 id="3-æ¢å¤é…ç½®ï¼ˆconfigï¼‰"><a href="#3-æ¢å¤é…ç½®ï¼ˆconfigï¼‰" class="headerlink" title="3. æ¢å¤é…ç½®ï¼ˆconfigï¼‰"></a>3. æ¢å¤é…ç½®ï¼ˆconfigï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -a /backup/nextcloud/config/ /opt/1panel/apps/nextcloud/nextcloud/data/config/</span><br></pre></td></tr></table></figure><h3 id="4-ä¿®å¤æƒé™ã€å¾ˆé‡è¦ã€‘"><a href="#4-ä¿®å¤æƒé™ã€å¾ˆé‡è¦ã€‘" class="headerlink" title="4. ä¿®å¤æƒé™ã€å¾ˆé‡è¦ã€‘"></a>4. ä¿®å¤æƒé™ã€å¾ˆé‡è¦ã€‘</h3><p><code>linuxserver/nextcloud</code> é•œåƒä½¿ç”¨ PUID&#x2F;PGID æ§åˆ¶æƒé™ï¼Œé»˜è®¤æ˜¯ <code>1000:1000</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R 1000:1000 /opt/1panel/apps/nextcloud/nextcloud/data/</span><br></pre></td></tr></table></figure><blockquote><p>å¦åˆ™ Nextcloud å¯èƒ½å› æƒé™é—®é¢˜æ— æ³•å†™å…¥æ–‡ä»¶ã€‚</p></blockquote><h2 id="â–¶ï¸-ç¬¬å››æ­¥ï¼šå¯åŠ¨-Nextcloud"><a href="#â–¶ï¸-ç¬¬å››æ­¥ï¼šå¯åŠ¨-Nextcloud" class="headerlink" title="â–¶ï¸ ç¬¬å››æ­¥ï¼šå¯åŠ¨ Nextcloud"></a>â–¶ï¸ ç¬¬å››æ­¥ï¼šå¯åŠ¨ Nextcloud</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/1panel/apps/nextcloud/nextcloud </span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>ç­‰å¾…å®¹å™¨å¯åŠ¨å®Œæˆï¼ˆå¯é€šè¿‡ <code>docker logs nextcloud</code> æŸ¥çœ‹æ—¥å¿—ï¼‰ã€‚</p><h2 id="ğŸ”§-ç¬¬äº”æ­¥ï¼šæ‰§è¡Œä¿®å¤å’Œæ¸…ç†ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰"><a href="#ğŸ”§-ç¬¬äº”æ­¥ï¼šæ‰§è¡Œä¿®å¤å’Œæ¸…ç†ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰" class="headerlink" title="ğŸ”§ ç¬¬äº”æ­¥ï¼šæ‰§è¡Œä¿®å¤å’Œæ¸…ç†ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰"></a>ğŸ”§ ç¬¬äº”æ­¥ï¼šæ‰§è¡Œä¿®å¤å’Œæ¸…ç†ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰</h2><p>è¿›å…¥ Nextcloud å®¹å™¨ï¼Œè¿è¡Œä¿®å¤å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨ï¼ˆå®¹å™¨åé€šå¸¸ä¸º nextcloudï¼Œç”± docker-compose.yml ä¸­å®šä¹‰ï¼‰ </span></span><br><span class="line">docker <span class="built_in">exec</span> -u abc -it nextcloud php /config/www/nextcloud/occ maintenance:repair</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ æ³¨æ„ï¼š<code>linuxserver/nextcloud</code> é•œåƒä¸­ï¼ŒWeb æ ¹ç›®å½•æ˜¯ <code>/config/www/nextcloud/</code>ï¼Œä¸”é»˜è®¤ç”¨æˆ·æ˜¯ <code>abc</code>ï¼ˆä¸æ˜¯ www-dataï¼‰ã€‚</p></blockquote><p>ä½ ä¹Ÿå¯ä»¥å¼€å¯&#x2F;å…³é—­ç»´æŠ¤æ¨¡å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯ç»´æŠ¤æ¨¡å¼ </span></span><br><span class="line">docker <span class="built_in">exec</span> -u abc -it nextcloud php /config/www/nextcloud/occ maintenance:mode --on </span><br><span class="line"><span class="comment"># å…³é—­ </span></span><br><span class="line">docker <span class="built_in">exec</span> -u abc -it nextcloud php /config/www/nextcloud/occ maintenance:mode --off</span><br></pre></td></tr></table></figure><h1 id="äº”ã€è„šæœ¬å®šæ—¶å¤‡ä»½å’Œè¿ç§»"><a href="#äº”ã€è„šæœ¬å®šæ—¶å¤‡ä»½å’Œè¿ç§»" class="headerlink" title="äº”ã€è„šæœ¬å®šæ—¶å¤‡ä»½å’Œè¿ç§»"></a>äº”ã€è„šæœ¬å®šæ—¶å¤‡ä»½å’Œè¿ç§»</h1><hr><h2 id="è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬"><a href="#è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬" class="headerlink" title="è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬"></a>è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬</h2><p>ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„å¤‡ä»½è„šæœ¬å¹¶è®¾ç½®å®šæ—¶ä»»åŠ¡æ¥è‡ªåŠ¨åŒ–æ•´ä¸ªè¿‡ç¨‹ï¼š</p><h3 id="nextclouå¤‡ä»½è„šæœ¬"><a href="#nextclouå¤‡ä»½è„šæœ¬" class="headerlink" title="nextclouå¤‡ä»½è„šæœ¬"></a>nextclouå¤‡ä»½è„šæœ¬</h3><p>backup-script.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="built_in">set</span> -e </span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® </span></span><br><span class="line">NEXTCLOUD_DIR=<span class="string">&quot;/opt/1panel/apps/nextcloud/nextcloud&quot;</span> </span><br><span class="line">MYSQL_CONTAINER=<span class="string">&quot;nextcloud-mysql-1&quot;</span> </span><br><span class="line">MYSQL_PASS=<span class="string">&quot;your_password&quot;</span> </span><br><span class="line">BACKUP_ROOT=<span class="string">&quot;<span class="variable">$HOME</span>/backup/full&quot;</span> </span><br><span class="line">DATE=$(<span class="built_in">date</span> +%Y-%m-%d) </span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. å¼€å¯ç»´æŠ¤æ¨¡å¼ </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ğŸ”§ å¼€å¯ Nextcloud ç»´æŠ¤æ¨¡å¼...&quot;</span> </span><br><span class="line">docker <span class="built_in">exec</span> -u abc nextcloud php /app/www/occ maintenance:mode --on </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å¤‡ä»½æ•°æ®åº“ï¼ˆä½¿ç”¨ --single-transactionï¼‰ </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ğŸ—ƒï¸ å¤‡ä»½æ•°æ®åº“...&quot;</span> </span><br><span class="line">docker <span class="built_in">exec</span> -i <span class="string">&quot;<span class="variable">$MYSQL_CONTAINER</span>&quot;</span> \ sh -c <span class="string">&quot;exec mysqldump -u root -p&#x27;<span class="variable">$MYSQL_PASS</span>&#x27; --single-transaction --routines --triggers nextcloud&quot;</span> \ | gzip &gt; <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>/db_<span class="variable">$DATE</span>.sql.gz&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¤‡ä»½æ–‡ä»¶ </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ğŸ“ å¤‡ä»½ Nextcloud data å’Œ config...&quot;</span> tar -czf <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>/nextcloud_<span class="variable">$DATE</span>.tar.gz&quot;</span> -C <span class="string">&quot;<span class="variable">$NEXTCLOUD_DIR</span>/data&quot;</span> data config </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å…³é—­ç»´æŠ¤æ¨¡å¼ </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;âœ… å…³é—­ç»´æŠ¤æ¨¡å¼...&quot;</span> </span><br><span class="line">docker <span class="built_in">exec</span> -u abc nextcloud php /app/www/occ maintenance:mode --off </span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æ¸…ç†æ—§å¤‡ä»½ ï¼Œæ¸…é™¤å‰3å¤©çš„å¤‡ä»½</span></span><br><span class="line">find <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>&quot;</span> -name <span class="string">&quot;*.gz&quot;</span> -mtime +3 -delete <span class="built_in">echo</span> <span class="string">&quot;ğŸ‰ å¤‡ä»½å®Œæˆï¼&quot;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°†å…¶æ·»åŠ åˆ° cron å®šæ—¶ä»»åŠ¡ä¸­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x /path/to/backup-script.sh </span><br><span class="line">crontab -e </span><br><span class="line"><span class="comment"># æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œå¤‡ä»½ï¼‰ </span></span><br><span class="line">0 2 * * * /path/to/backup-script.sh</span><br></pre></td></tr></table></figure><h3 id="mysqlå¤‡ä»½è„šæœ¬"><a href="#mysqlå¤‡ä»½è„šæœ¬" class="headerlink" title="mysqlå¤‡ä»½è„šæœ¬"></a>mysqlå¤‡ä»½è„šæœ¬</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="comment"># Backup MySQL database only </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -e </span><br><span class="line"><span class="comment"># === é…ç½®åŒº === </span></span><br><span class="line">MYSQL_CONTAINER=<span class="string">&quot;nextcloud-mysql-1&quot;</span> <span class="comment"># æ›¿æ¢ä¸ºä½ çš„ MySQL å®¹å™¨å </span></span><br><span class="line">MYSQL_ROOT_PASSWORD=<span class="string">&quot;your_mysql_password&quot;</span> <span class="comment"># æ›¿æ¢ä¸ºä½ çš„ MySQL å¯†ç  </span></span><br><span class="line">DB_NAME=<span class="string">&quot;nextcloud&quot;</span> </span><br><span class="line"></span><br><span class="line">BACKUP_ROOT=<span class="string">&quot;<span class="variable">$HOME</span>/backup/mysql&quot;</span> </span><br><span class="line">DATE=$(<span class="built_in">date</span> +%Y-%m-%d) </span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤‡ä»½æ•°æ®åº“å¹¶å‹ç¼© </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Backing up MySQL database &#x27;<span class="variable">$DB_NAME</span>&#x27; from container &#x27;<span class="variable">$MYSQL_CONTAINER</span>&#x27;...&quot;</span> docker <span class="built_in">exec</span> -i <span class="string">&quot;<span class="variable">$MYSQL_CONTAINER</span>&quot;</span> \ sh -c <span class="string">&quot;exec mysqldump -u root -p&#x27;<span class="variable">$MYSQL_ROOT_PASSWORD</span>&#x27; --single-transaction <span class="variable">$DB_NAME</span>&quot;</span> \ | gzip &gt; <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>/nextcloud_db_<span class="variable">$DATE</span>.sql.gz&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç† 3 å¤©å‰çš„å¤‡ä»½ </span></span><br><span class="line">find <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>&quot;</span> -name <span class="string">&quot;*.sql.gz&quot;</span> -mtime +3 -delete </span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;âœ… MySQL backup completed: <span class="variable">$BACKUP_ROOT</span>/nextcloud_db_<span class="variable">$DATE</span>.sql.gz&quot;</span></span><br></pre></td></tr></table></figure><h3 id="å®Œæ•´å¤‡ä»½ï¼ˆNextcloud-MySQLï¼‰"><a href="#å®Œæ•´å¤‡ä»½ï¼ˆNextcloud-MySQLï¼‰" class="headerlink" title="å®Œæ•´å¤‡ä»½ï¼ˆNextcloud + MySQLï¼‰"></a>å®Œæ•´å¤‡ä»½ï¼ˆNextcloud + MySQLï¼‰</h3><p>åˆ›å»ºæ–‡ä»¶ï¼š<code>~/backup_nextcloud_full.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="comment"># Full backup: Nextcloud files + config + MySQL database </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -e </span><br><span class="line"></span><br><span class="line"><span class="comment"># === é…ç½®åŒº === </span></span><br><span class="line">NEXTCLOUD_DIR=<span class="string">&quot;/opt/1panel/apps/nextcloud/nextcloud&quot;</span> </span><br><span class="line">MYSQL_CONTAINER=<span class="string">&quot;nextcloud-mysql-1&quot;</span> </span><br><span class="line">MYSQL_ROOT_PASSWORD=<span class="string">&quot;your_mysql_password&quot;</span> </span><br><span class="line">DB_NAME=<span class="string">&quot;nextcloud&quot;</span> </span><br><span class="line"></span><br><span class="line">BACKUP_ROOT=<span class="string">&quot;<span class="variable">$HOME</span>/backup/full&quot;</span> </span><br><span class="line">DATE=$(<span class="built_in">date</span> +%Y-%m-%d) </span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯ç»´æŠ¤æ¨¡å¼</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ğŸ”§ å¼€å¯ Nextcloud ç»´æŠ¤æ¨¡å¼...&quot;</span></span><br><span class="line">docker <span class="built_in">exec</span> -u abc nextcloud php /app/www/public/occ maintenance:mode --on</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- 1. å¤‡ä»½æ•°æ®åº“ ---- </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Backing up MySQL database...&quot;</span> docker <span class="built_in">exec</span> -i <span class="string">&quot;<span class="variable">$MYSQL_CONTAINER</span>&quot;</span> \ sh -c <span class="string">&quot;exec mysqldump -u root -p&#x27;<span class="variable">$MYSQL_ROOT_PASSWORD</span>&#x27; --single-transaction <span class="variable">$DB_NAME</span>&quot;</span> \ | gzip &gt; <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>/nextcloud_db_<span class="variable">$DATE</span>.sql.gz&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- 2. å¤‡ä»½ nextcloudæ–‡ä»¶å’Œé…ç½®Nextcloud data å’Œ config ---- </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Backing up Nextcloud data and config...&quot;</span> </span><br><span class="line">tar -czf <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>/nextcloud_full_<span class="variable">$DATE</span>.tar.gz&quot;</span> -C <span class="string">&quot;<span class="variable">$NEXTCLOUD_DIR</span>/data&quot;</span> data config </span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­ç»´æŠ¤æ¨¡å¼</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;âœ… å…³é—­ Nextcloud ç»´æŠ¤æ¨¡å¼...&quot;</span></span><br><span class="line">docker <span class="built_in">exec</span> -u abc nextcloud php /app/www/public/occ maintenance:mode --off</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- 3. æ¸…ç†æ—§å¤‡ä»½ ---- </span></span><br><span class="line">find <span class="string">&quot;<span class="variable">$BACKUP_ROOT</span>&quot;</span> -name <span class="string">&quot;*.gz&quot;</span> -mtime +3 -delete </span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;âœ… Full backup completed!&quot;</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ğŸ“ Data &amp; Config: <span class="variable">$BACKUP_ROOT</span>/nextcloud_full_<span class="variable">$DATE</span>.tar.gz&quot;</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ğŸ—ƒï¸ Database: <span class="variable">$BACKUP_ROOT</span>/nextcloud_db_<span class="variable">$DATE</span>.sql.gz&quot;</span></span><br></pre></td></tr></table></figure><h3 id="ğŸ”-è®¾ç½®è„šæœ¬æƒé™"><a href="#ğŸ”-è®¾ç½®è„šæœ¬æƒé™" class="headerlink" title="ğŸ” è®¾ç½®è„šæœ¬æƒé™"></a>ğŸ” è®¾ç½®è„šæœ¬æƒé™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x ~/backup_nextcloud.sh </span><br><span class="line"><span class="built_in">chmod</span> +x ~/backup_mysql.sh </span><br><span class="line"><span class="built_in">chmod</span> +x ~/backup_nextcloud_full.sh</span><br></pre></td></tr></table></figure><h3 id="å®šæ—¶ä»»åŠ¡"><a href="#å®šæ—¶ä»»åŠ¡" class="headerlink" title="å®šæ—¶ä»»åŠ¡"></a>å®šæ—¶ä»»åŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p>æ·»åŠ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯å¤©å‡Œæ™¨ 2 ç‚¹å…¨é‡å¤‡ä»½ </span></span><br><span class="line">0 2 * * * /root/backup_nextcloud_full.sh &gt;&gt; /var/log/nextcloud-backup.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><blockquote><p>åˆæœŸå»ºè®®ä¿ç•™æ—¥å¿—ï¼ˆ<code>&gt;&gt; /var/log/...</code>ï¼‰ï¼Œç¡®è®¤ç¨³å®šåå†æ”¹ä¸º <code>&gt;/dev/null 2&gt;&amp;1</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> docker </tag>
            
            <tag> nextcloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring</title>
      <link href="/2025/11/20/Spring/"/>
      <url>/2025/11/20/Spring/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><hr><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p>å®˜ç½‘åœ°å€ï¼š<a href="https://docs.spring.io/spring-framework/reference/index.html">https://docs.spring.io/spring-framework/reference/index.html</a><br>githubåœ°å€ï¼š<a href="https://github.com/spring-projects/spring-framework">https://github.com/spring-projects/spring-framework</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-2ä¼˜ç‚¹"><a href="#1-2ä¼˜ç‚¹" class="headerlink" title="1.2ä¼˜ç‚¹"></a>1.2ä¼˜ç‚¹</h2><ul><li>Springæ˜¯ä¸€ä¸ªå¼€æºçš„å…è´¹çš„æ¡†æ¶ï¼ˆå®¹å™¨ï¼‰ï¼</li><li>Springæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€éå…¥ä¾µå¼çš„æ¡†æ¶ï¼</li><li>æ§åˆ¶åè½¬(IOC),ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)!</li><li>æ”¯æŒäº‹åŠ¡çš„å¤„ç†ï¼Œå¯¹æ¡†æ¶æ•´åˆçš„æ”¯æŒï¼</li></ul><p>&#x3D;&#x3D;æ€»ç»“ä¸€å¥è¯ï¼šSpringå°±æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬ï¼ˆIOCï¼‰å’Œé¢å‘åˆ‡é¢ç¼–ç¨‹çš„ï¼ˆAOPï¼‰çš„æ¡†æ¶ï¼&#x3D;&#x3D;</p><h2 id="1-3-ç»„æˆ"><a href="#1-3-ç»„æˆ" class="headerlink" title="1.3 ç»„æˆ"></a>1.3 ç»„æˆ</h2><p><img src="/2025/11/20/Spring/file-20251114161052625.png"><br>Spring æ¡†æ¶æ˜¯ä¸€ä¸ªåˆ†å±‚æ¶æ„ï¼Œç”± 7 ä¸ªå®šä¹‰è‰¯å¥½çš„æ¨¡å—ç»„æˆã€‚Spring æ¨¡å—æ„å»ºåœ¨æ ¸å¿ƒå®¹å™¨ä¹‹ä¸Šï¼Œæ ¸å¿ƒå®¹å™¨å®šä¹‰äº†åˆ›å»ºã€é…ç½®å’Œç®¡ç† bean çš„æ–¹å¼</p><p><img src="/2025/11/20/Spring/file-20251114161203236.png"><br>ç»„æˆ Spring æ¡†æ¶çš„æ¯ä¸ªæ¨¡å—ï¼ˆæˆ–ç»„ä»¶ï¼‰éƒ½å¯ä»¥å•ç‹¬å­˜åœ¨ï¼Œæˆ–è€…ä¸å…¶ä»–ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—è”åˆå®ç°ã€‚æ¯ä¸ªæ¨¡å—çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li><strong>æ ¸å¿ƒå®¹å™¨</strong>ï¼šæ ¸å¿ƒå®¹å™¨æä¾› Spring æ¡†æ¶çš„åŸºæœ¬åŠŸèƒ½ã€‚æ ¸å¿ƒå®¹å™¨çš„ä¸»è¦ç»„ä»¶æ˜¯ BeanFactoryï¼Œå®ƒæ˜¯å·¥å‚æ¨¡å¼çš„å®ç°ã€‚BeanFactory ä½¿ç”¨ _æ§åˆ¶åè½¬_ï¼ˆIOCï¼‰ æ¨¡å¼å°†åº”ç”¨ç¨‹åºçš„é…ç½®å’Œä¾èµ–æ€§è§„èŒƒä¸å®é™…çš„åº”ç”¨ç¨‹åºä»£ç åˆ†å¼€ã€‚</li><li><strong>Spring ä¸Šä¸‹æ–‡</strong>ï¼šSpring ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘ Spring æ¡†æ¶æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚Spring ä¸Šä¸‹æ–‡åŒ…æ‹¬ä¼ä¸šæœåŠ¡ï¼Œä¾‹å¦‚ JNDIã€EJBã€ç”µå­é‚®ä»¶ã€å›½é™…åŒ–ã€æ ¡éªŒå’Œè°ƒåº¦åŠŸèƒ½ã€‚</li><li><strong>Spring AOP</strong>ï¼šé€šè¿‡é…ç½®ç®¡ç†ç‰¹æ€§ï¼ŒSpring AOP æ¨¡å—ç›´æ¥å°†é¢å‘åˆ‡é¢çš„ç¼–ç¨‹åŠŸèƒ½ , é›†æˆåˆ°äº† Spring æ¡†æ¶ä¸­ã€‚æ‰€ä»¥ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ Spring æ¡†æ¶ç®¡ç†ä»»ä½•æ”¯æŒ AOPçš„å¯¹è±¡ã€‚Spring AOP æ¨¡å—ä¸ºåŸºäº Spring çš„åº”ç”¨ç¨‹åºä¸­çš„å¯¹è±¡æä¾›äº†äº‹åŠ¡ç®¡ç†æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨ Spring AOPï¼Œä¸ç”¨ä¾èµ–ç»„ä»¶ï¼Œå°±å¯ä»¥å°†å£°æ˜æ€§äº‹åŠ¡ç®¡ç†é›†æˆåˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</li><li><strong>Spring DAO</strong>ï¼šJDBC DAO æŠ½è±¡å±‚æä¾›äº†æœ‰æ„ä¹‰çš„å¼‚å¸¸å±‚æ¬¡ç»“æ„ï¼Œå¯ç”¨è¯¥ç»“æ„æ¥ç®¡ç†å¼‚å¸¸å¤„ç†å’Œä¸åŒæ•°æ®åº“ä¾›åº”å•†æŠ›å‡ºçš„é”™è¯¯æ¶ˆæ¯ã€‚å¼‚å¸¸å±‚æ¬¡ç»“æ„ç®€åŒ–äº†é”™è¯¯å¤„ç†ï¼Œå¹¶ä¸”æå¤§åœ°é™ä½äº†éœ€è¦ç¼–å†™çš„å¼‚å¸¸ä»£ç æ•°é‡ï¼ˆä¾‹å¦‚æ‰“å¼€å’Œå…³é—­è¿æ¥ï¼‰ã€‚Spring DAO çš„é¢å‘ JDBC çš„å¼‚å¸¸éµä»é€šç”¨çš„ DAO å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚</li><li><strong>Spring ORM</strong>ï¼šSpring æ¡†æ¶æ’å…¥äº†è‹¥å¹²ä¸ª ORM æ¡†æ¶ï¼Œä»è€Œæä¾›äº† ORM çš„å¯¹è±¡å…³ç³»å·¥å…·ï¼Œå…¶ä¸­åŒ…æ‹¬ JDOã€Hibernate å’Œ iBatis SQL Mapã€‚æ‰€æœ‰è¿™äº›éƒ½éµä» Spring çš„é€šç”¨äº‹åŠ¡å’Œ DAO å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚</li><li><strong>Spring Web æ¨¡å—</strong>ï¼šWeb ä¸Šä¸‹æ–‡æ¨¡å—å»ºç«‹åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ¨¡å—ä¹‹ä¸Šï¼Œä¸ºåŸºäº Web çš„åº”ç”¨ç¨‹åºæä¾›äº†ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥ï¼ŒSpring æ¡†æ¶æ”¯æŒä¸ Jakarta Struts çš„é›†æˆã€‚Web æ¨¡å—è¿˜ç®€åŒ–äº†å¤„ç†å¤šéƒ¨åˆ†è¯·æ±‚ä»¥åŠå°†è¯·æ±‚å‚æ•°ç»‘å®šåˆ°åŸŸå¯¹è±¡çš„å·¥ä½œã€‚</li><li><strong>Spring MVC æ¡†æ¶</strong>ï¼šMVC æ¡†æ¶æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½çš„æ„å»º Web åº”ç”¨ç¨‹åºçš„ MVC å®ç°ã€‚é€šè¿‡ç­–ç•¥æ¥å£ï¼ŒMVC æ¡†æ¶å˜æˆä¸ºé«˜åº¦å¯é…ç½®çš„ï¼ŒMVC å®¹çº³äº†å¤§é‡è§†å›¾æŠ€æœ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ JSPã€Velocityã€Tilesã€iText å’Œ POIã€‚</li></ul><h2 id="1-4æ‹“å±•"><a href="#1-4æ‹“å±•" class="headerlink" title="1.4æ‹“å±•"></a>1.4æ‹“å±•</h2><p><strong>Spring Bootä¸Spring Cloud</strong></p><ul><li>Spring Boot æ˜¯ Spring çš„ä¸€å¥—å¿«é€Ÿé…ç½®è„šæ‰‹æ¶ï¼Œå¯ä»¥åŸºäºSpring Boot å¿«é€Ÿå¼€å‘å•ä¸ªå¾®æœåŠ¡;</li><li>Spring Cloudæ˜¯åŸºäºSpring Bootå®ç°çš„ï¼›</li><li>Spring Bootä¸“æ³¨äºå¿«é€Ÿã€æ–¹ä¾¿é›†æˆçš„å•ä¸ªå¾®æœåŠ¡ä¸ªä½“ï¼ŒSpring Cloudå…³æ³¨å…¨å±€çš„æœåŠ¡æ²»ç†æ¡†æ¶ï¼›</li><li>Spring Bootä½¿ç”¨äº†çº¦æŸä¼˜äºé…ç½®çš„ç†å¿µï¼Œ<strong>å¾ˆå¤šé›†æˆæ–¹æ¡ˆå·²ç»å¸®ä½ é€‰æ‹©å¥½äº†ï¼Œèƒ½ä¸é…ç½®å°±ä¸é…ç½®</strong> , Spring Cloudå¾ˆå¤§çš„ä¸€éƒ¨åˆ†æ˜¯åŸºäºSpring Bootæ¥å®ç°ï¼ŒSpring Bootå¯ä»¥ç¦»å¼€Spring Cloudç‹¬ç«‹ä½¿ç”¨å¼€å‘é¡¹ç›®ï¼Œä½†æ˜¯Spring Cloudç¦»ä¸å¼€Spring Bootï¼Œå±äºä¾èµ–çš„å…³ç³»ã€‚</li><li>SpringBootåœ¨SpringCloundä¸­èµ·åˆ°äº†æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼Œå¦‚æœä½ è¦å­¦ä¹ SpringCloudå¿…é¡»è¦å­¦ä¹ SpringBootã€‚</li></ul><p>å› ä¸ºç°åœ¨å¤§å¤šæ•°å…¬å¸éƒ½åœ¨ä½¿ç”¨SpringBootè¿›è¡Œå¿«é€Ÿå¼€å‘ï¼Œ<strong>å­¦ä¹ SpringBootçš„å‰æï¼Œéœ€è¦å®Œå…¨æŒæ¡SpringåŠSpringMVC!</strong> æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼<br>I<br><strong>å¼Šç«¯ï¼šå‘å±•äº†å¤ªä¹…ä¹‹åï¼Œè¿èƒŒäº†åŸæ¥çš„ç†å¿µï¼é…ç½®ååˆ†ç¹çï¼Œäººç§°ï¼šâ€œé…ç½®åœ°ç‹±ï¼â€</strong></p><h1 id="2-IOCç†è®ºæ¨å¯¼"><a href="#2-IOCç†è®ºæ¨å¯¼" class="headerlink" title="2. IOCç†è®ºæ¨å¯¼"></a>2. IOCç†è®ºæ¨å¯¼</h1><hr><h2 id="2-1-åˆ†æå®ç°"><a href="#2-1-åˆ†æå®ç°" class="headerlink" title="2.1 åˆ†æå®ç°"></a>2.1 åˆ†æå®ç°</h2><p>æˆ‘ä»¬å…ˆç”¨æˆ‘ä»¬åŸæ¥çš„æ–¹å¼å†™ä¸€æ®µä»£ç  .</p><p>1ã€å…ˆå†™ä¸€ä¸ªUserDaoæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€å†å»å†™Daoçš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;è·å–ç”¨æˆ·æ•°æ®&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€ç„¶åå»å†™UserServiceçš„æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€æœ€åå†™Serviceçš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>();</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">       userDao.getUser();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">UserService</span> <span class="variable">service</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">   service.getUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æˆ‘ä»¬åŸæ¥çš„æ–¹å¼ , å¼€å§‹å¤§å®¶ä¹Ÿéƒ½æ˜¯è¿™ä¹ˆå»å†™çš„å¯¹å§ . é‚£æˆ‘ä»¬ç°åœ¨ä¿®æ”¹ä¸€ä¸‹ .</p><p>æŠŠUserdaoçš„å®ç°ç±»å¢åŠ ä¸€ä¸ª .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoMySqlImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;MySqlè·å–ç”¨æˆ·æ•°æ®&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€æˆ‘ä»¬è¦å»ä½¿ç”¨MySqlçš„è¯ , æˆ‘ä»¬å°±éœ€è¦å»serviceå®ç°ç±»é‡Œé¢ä¿®æ”¹å¯¹åº”çš„å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDaoMySqlImpl</span>();</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">       userDao.getUser();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‡è®¾, æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªUserdaoçš„å®ç°ç±» .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoOracleImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;Oracleè·å–ç”¨æˆ·æ•°æ®&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨Oracle , åˆéœ€è¦å»serviceå®ç°ç±»é‡Œé¢ä¿®æ”¹å¯¹åº”çš„å®ç° . å‡è®¾æˆ‘ä»¬çš„è¿™ç§éœ€æ±‚éå¸¸å¤§ , è¿™ç§æ–¹å¼å°±æ ¹æœ¬ä¸é€‚ç”¨äº†, ç”šè‡³åäººç±»å¯¹å§ , æ¯æ¬¡å˜åŠ¨ , éƒ½éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç  . è¿™ç§è®¾è®¡çš„è€¦åˆæ€§å¤ªé«˜äº†, ç‰µä¸€å‘è€ŒåŠ¨å…¨èº« .</p><p><strong>é‚£æˆ‘ä»¬å¦‚ä½•å»è§£å†³å‘¢ ?</strong></p><p>æˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦ç”¨åˆ°ä»–çš„åœ°æ–¹ , ä¸å»å®ç°å®ƒ , è€Œæ˜¯ç•™å‡ºä¸€ä¸ªæ¥å£ , åˆ©ç”¨set , æˆ‘ä»¬å»ä»£ç é‡Œä¿®æ”¹ä¸‹ .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"><span class="comment">// åˆ©ç”¨setå®ç°</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">       userDao.getUser();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨å»æˆ‘ä»¬çš„æµ‹è¯•ç±»é‡Œ , è¿›è¡Œæµ‹è¯• ;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">UserServiceImpl</span> <span class="variable">service</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">   service.setUserDao( <span class="keyword">new</span> <span class="title class_">UserDaoMySqlImpl</span>() );</span><br><span class="line">   service.getUser();</span><br><span class="line">   <span class="comment">//é‚£æˆ‘ä»¬ç°åœ¨åˆæƒ³ç”¨Oracleå»å®ç°å‘¢</span></span><br><span class="line">   service.setUserDao( <span class="keyword">new</span> <span class="title class_">UserDaoOracleImpl</span>() );</span><br><span class="line">   service.getUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MySqlè·å–ç”¨æˆ·æ•°æ®</span><br><span class="line">Oracleè·å–ç”¨æˆ·æ•°æ®</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p>å¤§å®¶å‘ç°äº†åŒºåˆ«æ²¡æœ‰ ? å¯èƒ½å¾ˆå¤šäººè¯´æ²¡å•¥åŒºåˆ« . ä½†æ˜¯åŒå­¦ä»¬ , ä»–ä»¬å·²ç»å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„å˜åŒ– , å¾ˆå¤šåœ°æ–¹éƒ½ä¸ä¸€æ ·äº† . ä»”ç»†å»æ€è€ƒä¸€ä¸‹ , ä»¥å‰æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯ç”±ç¨‹åºå»è¿›è¡Œæ§åˆ¶åˆ›å»º , è€Œç°åœ¨æ˜¯ç”±æˆ‘ä»¬è‡ªè¡Œæ§åˆ¶åˆ›å»ºå¯¹è±¡ , æŠŠä¸»åŠ¨æƒäº¤ç»™äº†è°ƒç”¨è€… . ç¨‹åºä¸ç”¨å»ç®¡æ€ä¹ˆåˆ›å»º,æ€ä¹ˆå®ç°äº† . å®ƒåªè´Ÿè´£æä¾›ä¸€ä¸ªæ¥å£ .</p><p>è¿™ç§æ€æƒ³ , ä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ , æˆ‘ä»¬ç¨‹åºå‘˜ä¸å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºäº† , æ›´å¤šçš„å»å…³æ³¨ä¸šåŠ¡çš„å®ç° . è€¦åˆæ€§å¤§å¤§é™ä½ . è¿™ä¹Ÿå°±æ˜¯IOCçš„åŸå‹ !</p><h1 id="2-2-IOCæœ¬è´¨"><a href="#2-2-IOCæœ¬è´¨" class="headerlink" title="2.2 IOCæœ¬è´¨"></a>2.2 IOCæœ¬è´¨</h1><p><strong>æ§åˆ¶åè½¬Ioc(Inversion of Control),æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDI(ä¾èµ–æ³¨å…¥)æ˜¯å®ç°IoCçš„ä¸€ç§æ–¹æ³•</strong>ï¼Œä¹Ÿæœ‰äººè®¤ä¸ºDIåªæ˜¯IoCçš„å¦ä¸€ç§è¯´æ³•ã€‚æ²¡æœ‰IoCçš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶åè½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯ï¼šè·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚<br><img src="/2025/11/20/Spring/file-20251114170639609.png"><br><strong>IoCæ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒå†…å®¹</strong>ï¼Œä½¿ç”¨å¤šç§æ–¹å¼å®Œç¾çš„å®ç°äº†IoCï¼Œå¯ä»¥ä½¿ç”¨XMLé…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£ï¼Œæ–°ç‰ˆæœ¬çš„Springä¹Ÿå¯ä»¥é›¶é…ç½®å®ç°IoCã€‚</p><p>Springå®¹å™¨åœ¨åˆå§‹åŒ–æ—¶å…ˆè¯»å–é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æˆ–å…ƒæ•°æ®åˆ›å»ºä¸ç»„ç»‡å¯¹è±¡å­˜å…¥å®¹å™¨ä¸­ï¼Œç¨‹åºä½¿ç”¨æ—¶å†ä»Iocå®¹å™¨ä¸­å–å‡ºéœ€è¦çš„å¯¹è±¡ã€‚</p><div align = "center">    <img src = "Spring/file-20251114170757947.png" width ="50%"/></div>é‡‡ç”¨XMLæ–¹å¼é…ç½®Beançš„æ—¶å€™ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯æ˜¯å’Œå®ç°åˆ†ç¦»çš„ï¼Œè€Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼å¯ä»¥æŠŠä¸¤è€…åˆä¸ºä¸€ä½“ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯ç›´æ¥ä»¥æ³¨è§£çš„å½¢å¼å®šä¹‰åœ¨å®ç°ç±»ä¸­ï¼Œä»è€Œè¾¾åˆ°äº†é›¶é…ç½®çš„ç›®çš„ã€‚<p><strong>æ§åˆ¶åè½¬æ˜¯ä¸€ç§é€šè¿‡æè¿°(XMLæˆ–æ³¨è§£)å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹å»ç”Ÿäº§æˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚åœ¨Springtä¸­å®ç°æ§åˆ¶åè½¬çš„æ˜¯IoCå®¹å™¨ï¼Œå…¶å®ç°æ–¹æ³•æ˜¯ä¾èµ–æ³¨å…¥(Dependency Injection,Dl)ã€‚</strong></p><h1 id="3-HelloSpring"><a href="#3-HelloSpring" class="headerlink" title="3.HelloSpring"></a>3.HelloSpring</h1><hr><blockquote><p>å¯¼å…¥jaråŒ…</p></blockquote><p>æ³¨ : spring éœ€è¦å¯¼å…¥commons-loggingè¿›è¡Œæ—¥å¿—è®°å½• . æˆ‘ä»¬åˆ©ç”¨maven , ä»–ä¼šè‡ªåŠ¨ä¸‹è½½å¯¹åº”çš„ä¾èµ–é¡¹ .</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¼–å†™ä»£ç </p></blockquote><p>1ã€ç¼–å†™ä¸€ä¸ªHelloå®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;Hello,&quot;</span>+ name );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€ç¼–å†™æˆ‘ä»¬çš„springæ–‡ä»¶ , è¿™é‡Œæˆ‘ä»¬å‘½åä¸ºbeans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--beanå°±æ˜¯javaå¯¹è±¡ , ç”±Springåˆ›å»ºå’Œç®¡ç†--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Hello&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Spring&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">UserServiceImpl</span> <span class="variable">serviceImpl</span> <span class="operator">=</span> (UserServiceImpl) context.getBean(<span class="string">&quot;ServiceImpl&quot;</span>);</span><br><span class="line">   serviceImpl.getUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org.example.Hello,Spring</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><h2 id="æ€è€ƒé—®é¢˜ï¼Ÿ"><a href="#æ€è€ƒé—®é¢˜ï¼Ÿ" class="headerlink" title="æ€è€ƒé—®é¢˜ï¼Ÿ"></a>æ€è€ƒé—®é¢˜ï¼Ÿ</h2><ul><li>Helloå¯¹è±¡æ˜¯è°åˆ›å»ºçš„ï¼Ÿ<br>  helloå¯¹è±¡æ˜¯ç”±Springåˆ›å»ºçš„</li><li>Helloå¯¹è±¡çš„å±æ€§æ˜¯æ€ä¹ˆè®¾ç½®çš„ï¼Ÿ<br>  helloå¯¹è±¡çš„å±æ€§æ˜¯ç”±Springå®¹å™¨è®¾ç½®çš„ï¼Œ</li></ul><p>è¿™ä¸ªè¿‡ç¨‹å°±å«æ§åˆ¶åè½¬ï¼š</p><ul><li><strong>æ§åˆ¶</strong>ï¼šè°æ¥æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºï¼Œä¼ ç»Ÿåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ˜¯ç”±ç¨‹åºæœ¬èº«æ§åˆ¶åˆ›å»ºçš„ï¼Œä½¿ç”¨Spring,åï¼Œå¯¹è±¡æ˜¯ç”±Spring:æ¥åˆ›å»ºçš„.</li><li><strong>åè½¬</strong>ï¼šç¨‹åºæœ¬èº«ä¸åˆ›å»ºå¯¹è±¡ï¼Œè€Œå˜æˆè¢«åŠ¨çš„æ¥æ”¶å¯¹è±¡.</li></ul><p><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šå°±æ˜¯åˆ©ç”¨setæ–¹æ³•æ¥è¿›è¡Œæ³¨å…¥çš„ï¼š<br>IOCæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œç”±ä¸»åŠ¨çš„ç¼–ç¨‹å˜æˆè¢«åŠ¨çš„æ¥æ”¶ã€‚<br>å¯ä»¥é€šè¿‡newClassPathXmlApplicationContextå»æµè§ˆä¸€ä¸‹åº•å±‚æºç <br><strong>OK,åˆ°äº†ç°åœ¨ï¼Œæˆ‘ä»¬å½»åº•ä¸ç”¨å†ç¨‹åºä¸­å»æ”¹åŠ¨äº†ï¼Œè¦å®ç°ä¸åŒçš„æ“ä½œï¼Œåªéœ€è¦åœ¨xé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œæ‰€è°“çš„loC,ä¸€å¥è¯æå®šï¼šå¯¹è±¡ç”±Springæ¥åˆ›å»ºï¼Œç®¡ç†ï¼Œè£…é…ï¼</strong></p><blockquote><p>ä¿®æ”¹æ¡ˆä¾‹ä¸€</p></blockquote><p>æˆ‘ä»¬åœ¨æ¡ˆä¾‹ä¸€ä¸­ï¼Œ æ–°å¢ä¸€ä¸ªSpringé…ç½®æ–‡ä»¶beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans  </span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;MysqlImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.dao.UserDaoMySqlImpl&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;OracleImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.dao.UserDaoOracleImpl&quot;</span>/&gt;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.service.UserServiceImpl&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="comment">&lt;!--æ³¨æ„: è¿™é‡Œçš„nameå¹¶ä¸æ˜¯å±æ€§ , è€Œæ˜¯setæ–¹æ³•åé¢çš„é‚£éƒ¨åˆ† , é¦–å­—æ¯å°å†™--&gt;</span>  </span><br><span class="line">        <span class="comment">&lt;!--å¼•ç”¨å¦å¤–ä¸€ä¸ªbean , ä¸æ˜¯ç”¨value è€Œæ˜¯ç”¨ ref--&gt;</span>        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;OracleImpl&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">UserServiceImpl</span> <span class="variable">serviceImpl</span> <span class="operator">=</span> (UserServiceImpl) context.getBean(<span class="string">&quot;ServiceImpl&quot;</span>);</span><br><span class="line">   serviceImpl.getUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Oracleè·å–ç”¨æˆ·æ•°æ®</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p>OK , åˆ°äº†ç°åœ¨ , æˆ‘ä»¬å½»åº•ä¸ç”¨å†ç¨‹åºä¸­å»æ”¹åŠ¨äº† , è¦å®ç°ä¸åŒçš„æ“ä½œ , åªéœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ , æ‰€è°“çš„IoC,ä¸€å¥è¯æå®š : å¯¹è±¡ç”±Spring æ¥åˆ›å»º , ç®¡ç† , è£…é… !</p><h1 id="4-IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"><a href="#4-IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="headerlink" title="4. IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"></a>4. IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h1><hr><h2 id="4-1-é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"><a href="#4-1-é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º" class="headerlink" title="4.1.é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"></a>4.1.é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</h2><blockquote><p>é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º<br>ä½¿ç”¨æ— å‚æ„é€ åˆ›å»ºå¯¹è±¡ï¼Œé»˜è®¤</p></blockquote><p>1ã€ User.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;useræ— å‚æ„é€ æ–¹æ³•&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;name=&quot;</span>+ name );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span>  </span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  </span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span>        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>SpringStudying<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Spring-study-03<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span>        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span>    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="comment">//åœ¨æ‰§è¡ŒgetBeançš„æ—¶å€™, userå·²ç»åˆ›å»ºå¥½äº† , é€šè¿‡æ— å‚æ„é€ </span></span><br><span class="line">   <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">   <span class="comment">//è°ƒç”¨å¯¹è±¡çš„æ–¹æ³• .</span></span><br><span class="line">   user.show();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;C:\Program Files\Java\jdk-17\bin\java.exe&quot;</span> </span><br><span class="line">useræ— å‚æ„é€ æ–¹æ³•</span><br><span class="line">name=YaoYinjin</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p>ç»“æœå¯ä»¥å‘ç°ï¼Œåœ¨è°ƒç”¨showæ–¹æ³•ä¹‹å‰ï¼ŒUserå¯¹è±¡å·²ç»é€šè¿‡æ— å‚æ„é€ åˆå§‹åŒ–äº†ï¼</p><h2 id="4-2-é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"><a href="#4-2-é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º" class="headerlink" title="4.2.é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"></a>4.2.é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</h2><blockquote><p>é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</p></blockquote><p>1ã€UserT . java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserT</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">UserT</span><span class="params">(String name)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;name=&quot;</span>+ name );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€beans.xml æœ‰ä¸‰ç§æ–¹å¼ç¼–å†™</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç¬¬ä¸€ç§æ ¹æ®indexå‚æ•°ä¸‹æ ‡è®¾ç½® --&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.UserT&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="comment">&lt;!-- indexæŒ‡æ„é€ æ–¹æ³• , ä¸‹æ ‡ä»0å¼€å§‹ --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;YaoYinjn2&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!-- ç¬¬äºŒç§æ ¹æ®å‚æ•°åå­—è®¾ç½® 2.é€šè¿‡ç±»å‹åˆ›å»ºï¼Œä¸å»ºè®®ä½¿ç”¨ï¼--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.UserT&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="comment">&lt;!-- nameæŒ‡å‚æ•°å --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;YaoYinjn2&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!-- ç¬¬ä¸‰ç§æ ¹æ®å‚æ•°ç±»å‹è®¾ç½®  3. å‚æ•°å(è¿™ç§æ–¹å¼å¤Ÿäº†)--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.UserT&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;YaoYinjn2&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testT</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">UserT</span> <span class="variable">user</span> <span class="operator">=</span> (UserT) context.getBean(<span class="string">&quot;userT&quot;</span>);</span><br><span class="line">   user.show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šåœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ï¼Œå®¹å™¨ä¸­ç®¡ç†çš„å¯¹è±¡å°±å·²ç»åˆå§‹åŒ–äº†ï¼</p><h1 id="5-Springé…ç½®"><a href="#5-Springé…ç½®" class="headerlink" title="5. Springé…ç½®"></a>5. Springé…ç½®</h1><hr><h2 id="5-1-åˆ«å"><a href="#5-1-åˆ«å" class="headerlink" title="5.1 åˆ«å"></a>5.1 åˆ«å</h2><p>alias è®¾ç½®åˆ«å , ä¸ºbeanè®¾ç½®åˆ«å , å¯ä»¥è®¾ç½®å¤šä¸ªåˆ«å</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åˆ«åï¼Œå¦‚æœæ·»åŠ äº†åˆ«åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«åè·å–åˆ°è¿™ä¸ªå¯¹è±¡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span><span class="attr">alias</span>=<span class="string">&quot;userNew&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-2-Beançš„é…ç½®"><a href="#5-2-Beançš„é…ç½®" class="headerlink" title="5.2 Beançš„é…ç½®"></a>5.2 Beançš„é…ç½®</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">id:beançš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæˆ‘ä»¬å­¦çš„å¯¹è±¡å</span></span><br><span class="line"><span class="comment">c1ass:beanå¯¹è±¡æ‰€å¯¹åº”çš„å…¨é™å®šåï¼šåŒ…å+ç±»å‹</span></span><br><span class="line"><span class="comment">name:ä¹Ÿæ˜¯åˆ«åï¼Œè€Œä¸”nameå¯ä»¥åŒæ—¶å–å¤šä¸ªåˆ«å</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.UserT&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user2 u2,u3;u4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span><span class="attr">value</span>=<span class="string">&quot;Spring&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-3-import"><a href="#5-3-import" class="headerlink" title="5.3 import"></a>5.3 import</h2><p>è¿™ä¸ªimport,ä¸€èˆ¬ç”¨äºå›¢é˜Ÿå¼€å‘ä½¿ç”¨ï¼Œä»–å¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ª</p><p>å‡è®¾ï¼Œç°åœ¨é¡¹ç›®ä¸­æœ‰å¤šä¸ªäººå¼€å‘ï¼Œè¿™ä¸‰ä¸ªäººè´Ÿè´£ä¸åŒçš„ç±»å¼€å‘ï¼Œä¸åŒçš„ç±»éœ€è¦æ³¨å†Œåœ¨ä¸åŒçš„beaä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨importå°†Fæ‰€æœ‰äººçš„beans.xmlåˆå¹¶ä¸ºä¸€ä¸ªæ€»çš„ï¼</p><ul><li>å¼ ä¸‰</li><li>æå››</li><li>ç‹äº”</li><li>applicationContext.xml  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans2.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans3.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>ä½¿ç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨æ€»çš„é…ç½®å°±å¯ä»¥äº†</p><h1 id="6-ä¾èµ–æ³¨å…¥-DI"><a href="#6-ä¾èµ–æ³¨å…¥-DI" class="headerlink" title="6. ä¾èµ–æ³¨å…¥(DI)"></a>6. ä¾èµ–æ³¨å…¥(DI)</h1><hr><blockquote><p>æ¦‚å¿µ</p></blockquote><ul><li>ä¾èµ–æ³¨å…¥ï¼ˆDependency Injection,DIï¼‰ã€‚</li><li>ä¾èµ– : æŒ‡Beanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ . Beanå¯¹è±¡çš„ä¾èµ–èµ„æº .</li><li>æ³¨å…¥ : æŒ‡Beanå¯¹è±¡æ‰€ä¾èµ–çš„èµ„æº , ç”±å®¹å™¨æ¥è®¾ç½®å’Œè£…é… .</li></ul><h2 id="6-1-æ„é€ å™¨æ³¨å…¥"><a href="#6-1-æ„é€ å™¨æ³¨å…¥" class="headerlink" title="6.1 æ„é€ å™¨æ³¨å…¥"></a>6.1 æ„é€ å™¨æ³¨å…¥</h2><p>æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ¡ˆä¾‹å·²ç»è®²è¿‡äº†</p><h2 id="6-2-Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘"><a href="#6-2-Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘" class="headerlink" title="6.2 Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘"></a>6.2 Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘</h2><ul><li>ä¾èµ–æ³¨å…¥ï¼šSetæ³¨å…¥ï¼<ul><li>ä¾èµ–ï¼šbeanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ï¼</li><li>æ³¨å…¥ï¼šbeanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œç”±å®¹å™¨æ¥æ³¨å…¥ï¼</li></ul></li></ul><p>è¦æ±‚è¢«æ³¨å…¥çš„å±æ€§ , å¿…é¡»æœ‰setæ–¹æ³• , setæ–¹æ³•çš„æ–¹æ³•åç”±<strong>set + å±æ€§é¦–å­—æ¯å¤§å†™</strong> , å¦‚æœå±æ€§æ˜¯booleanç±»å‹ , æ²¡æœ‰setæ–¹æ³• , æ˜¯ is .</p><p>ã€ç¯å¢ƒæ­å»ºã€‘</p><ol><li><p>å¤æ‚ç±»å‹<br> Address.java</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span> &#123;  </span><br><span class="line">    <span class="keyword">private</span> String address;  </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> address;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.address = address;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>çœŸå®æµ‹è¯•å¯¹è±¡<br> Student.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.pojo;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"><span class="keyword">import</span> java.util.Map;  </span><br><span class="line"><span class="keyword">import</span> java.util.Properties;  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> String name;  </span><br><span class="line">    <span class="keyword">private</span> Address address;  </span><br><span class="line">    <span class="keyword">private</span> String[] books;  </span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbys;  </span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; card;  </span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; games;  </span><br><span class="line">    <span class="keyword">private</span> String wife;  </span><br><span class="line">    <span class="keyword">private</span> Properties info;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.name = name;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(Address address)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.address = address;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBooks</span><span class="params">(String[] books)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.books = books;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHobbys</span><span class="params">(List&lt;String&gt; hobbys)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.hobbys = hobbys;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCard</span><span class="params">(Map&lt;String, String&gt; card)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.card = card;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setGames</span><span class="params">(Set&lt;String&gt; games)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.games = games;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setWife</span><span class="params">(String wife)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.wife = wife;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setInfo</span><span class="params">(Properties info)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.info = info;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">&quot;name=&quot;</span>+ name  </span><br><span class="line">                + <span class="string">&quot;,address=&quot;</span>+ address.getAddress()  </span><br><span class="line">                + <span class="string">&quot;,books=&quot;</span>  </span><br><span class="line">        );  </span><br><span class="line">        <span class="keyword">for</span> (String book:books)&#123;  </span><br><span class="line">            System.out.print(<span class="string">&quot;&lt;&lt;&quot;</span>+book+<span class="string">&quot;&gt;&gt;\t&quot;</span>);  </span><br><span class="line">        &#125;  </span><br><span class="line">        System.out.println(<span class="string">&quot;\nçˆ±å¥½:&quot;</span>+hobbys);  </span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">&quot;card:&quot;</span>+card);  </span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">&quot;games:&quot;</span>+games);  </span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">&quot;wife:&quot;</span>+wife);  </span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">&quot;info:&quot;</span>+info);  </span><br><span class="line">  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">getName</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name != <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Bean.xml</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans  </span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Student&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä½ å¤§çˆ·&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•ç±»</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.example.pojo.Student;  </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;  </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;  </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;  </span><br><span class="line">    <span class="meta">@Test</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;  </span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> (Student) context.getBean(<span class="string">&quot;student&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">        System.out.println(student.getName());  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç»“æœï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span></span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure></li></ol><h2 id="6-3æ‹“å±•æ–¹å¼æ³¨å…¥"><a href="#6-3æ‹“å±•æ–¹å¼æ³¨å…¥" class="headerlink" title="6.3æ‹“å±•æ–¹å¼æ³¨å…¥"></a>6.3æ‹“å±•æ–¹å¼æ³¨å…¥</h2><p>1ã€<strong>å¸¸é‡æ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°æ˜&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> (Student) context.getBean(<span class="string">&quot;student&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(student.getName());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€<strong>Beanæ³¨å…¥</strong></p><p>æ³¨æ„ç‚¹ï¼šè¿™é‡Œçš„å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œref</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;addr&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Address&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;é‡åº†&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°æ˜&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;addr&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ã€<strong>æ•°ç»„æ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°æ˜&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;addr&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>è¥¿æ¸¸è®°<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>çº¢æ¥¼æ¢¦<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ°´æµ’ä¼ <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4ã€<strong>Listæ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbys&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¬æ­Œ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>çœ‹ç”µå½±<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>çˆ¬å±±<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>5ã€<strong>Mapæ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;ä¸­å›½é‚®æ”¿&quot;</span> <span class="attr">value</span>=<span class="string">&quot;456456456465456&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;å»ºè®¾&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1456682255511&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>6ã€<strong>setæ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;games&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>LOL<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>BOB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>COC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>7ã€<strong>Nullæ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">null</span>/&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>8ã€<strong>Propertiesæ³¨å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;å­¦å·&quot;</span>&gt;</span>20190604<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;æ€§åˆ«&quot;</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;å§“å&quot;</span>&gt;</span>å°æ˜<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š<br><img src="/2025/11/20/Spring/file-20251118233530230.png" alt="500"></p><p>9ã€på‘½åå’Œcå‘½åæ³¨å…¥</p><p>User.java ï¼šã€æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰æœ‰å‚æ„é€ å™¨ï¼ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€På‘½åç©ºé—´æ³¨å…¥ : éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯¼å…¥çº¦æŸ : xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--P(å±æ€§: properties)å‘½åç©ºé—´ , ç›´æ¥æ³¨å…¥å±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.User&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;YaoYinjn&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;18&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User&#123;name=<span class="string">&#x27;YaoYinjin&#x27;</span>, age=18&#125;</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p>2ã€c å‘½åç©ºé—´æ³¨å…¥ : éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¯¼å…¥çº¦æŸ : xmlns:c=&quot;http://www.springframework.org/schema/c&quot;</span><br><span class="line"><span class="comment">&lt;!--C(æ„é€ : Constructor)å‘½åç©ºé—´ , ä½¿ç”¨æ„é€ å™¨æ³¨å…¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;YaoYinjn&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;18&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°é—®é¢˜ï¼šçˆ†çº¢äº†ï¼Œåˆšæ‰æˆ‘ä»¬æ²¡æœ‰å†™æœ‰å‚æ„é€ ï¼</p><p>è§£å†³ï¼šæŠŠæœ‰å‚æ„é€ å™¨åŠ ä¸Šï¼Œè¿™é‡Œä¹Ÿèƒ½çŸ¥é“ï¼Œc å°±æ˜¯æ‰€è°“çš„æ„é€ å™¨æ³¨å…¥ï¼</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-4-Beançš„ä½œç”¨åŸŸ"><a href="#6-4-Beançš„ä½œç”¨åŸŸ" class="headerlink" title="6.4 Beançš„ä½œç”¨åŸŸ"></a>6.4 Beançš„ä½œç”¨åŸŸ</h2><p>åœ¨Springä¸­ï¼Œé‚£äº›ç»„æˆåº”ç”¨ç¨‹åºçš„ä¸»ä½“åŠç”±Spring IoCå®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡ï¼Œè¢«ç§°ä¹‹ä¸ºbeanã€‚ç®€å•åœ°è®²ï¼Œbeanå°±æ˜¯ç”±IoCå®¹å™¨åˆå§‹åŒ–ã€è£…é…åŠç®¡ç†çš„å¯¹è±¡ .</p><table><thead><tr><th>ç±»åˆ«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>singleton</td><td>åœ¨Spring loCå®¹å™¨ä¸­ä»…å­˜åœ¨ä¸€ä¸ªBeanå®ä¾‹ï¼ŒBeanä»¥å•ä¾‹<br>æ–¹å¼å­˜åœ¨ï¼Œé»˜è®¤å€¼</td></tr><tr><td>prototype</td><td>æ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨Beanæ—¶ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå³<br>æ¯æ¬¡è°ƒç”¨getBean0æ—¶ï¼Œç›¸å½“äºæ‰§è¡Œnew XxxBean()</td></tr><tr><td>request</td><td>æ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Bean,è¯¥ä½œç”¨åŸŸä»…é€‚<br>ç”¨äºWebApplication Contextç¯å¢ƒ</td></tr><tr><td>session</td><td>åŒä¸€ä¸ªHTTP Sessionå…±äº«ä¸€ä¸ªBean,ä¸åŒSessionä½¿ç”¨<br>ä¸åŒBean,ä»…é€‚ç”¨äºWebApplication Contextç¯å¢ƒ</td></tr><tr><td>å‡ ç§ä½œç”¨åŸŸä¸­ï¼Œrequestã€sessionä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„åº”ç”¨ä¸­ä½¿ç”¨ï¼ˆä¸å¿…å…³å¿ƒä½ æ‰€é‡‡ç”¨çš„æ˜¯ä»€ä¹ˆwebåº”ç”¨æ¡†æ¶ï¼‰ï¼Œåªèƒ½ç”¨åœ¨åŸºäºwebçš„Spring ApplicationContextç¯å¢ƒã€‚</td><td></td></tr></tbody></table><h3 id="Singleton-å•ä¾‹æ¨¡å¼"><a href="#Singleton-å•ä¾‹æ¨¡å¼" class="headerlink" title="Singleton(å•ä¾‹æ¨¡å¼)"></a>Singleton(å•ä¾‹æ¨¡å¼)</h3><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSingletonï¼Œé‚£ä¹ˆSpring IoCå®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº«çš„beanå®ä¾‹ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹beançš„è¯·æ±‚ï¼Œåªè¦idä¸è¯¥beanå®šä¹‰ç›¸åŒ¹é…ï¼Œåˆ™åªä¼šè¿”å›beançš„åŒä¸€å®ä¾‹ã€‚Singletonæ˜¯å•ä¾‹ç±»å‹ï¼Œå°±æ˜¯åœ¨åˆ›å»ºèµ·å®¹å™¨æ—¶å°±åŒæ—¶è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªbeançš„å¯¹è±¡ï¼Œä¸ç®¡ä½ æ˜¯å¦ä½¿ç”¨ï¼Œä»–éƒ½å­˜åœ¨äº†ï¼Œæ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ³¨æ„ï¼ŒSingletonä½œç”¨åŸŸæ˜¯Springä¸­çš„ç¼ºçœä½œç”¨åŸŸã€‚è¦åœ¨XMLä¸­å°†beanå®šä¹‰æˆsingletonï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;cn.csdn.service.ServiceImpl&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    System.out.println(user==user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Prototype-åŸå‹æ¨¡å¼"><a href="#Prototype-åŸå‹æ¨¡å¼" class="headerlink" title="Prototype(åŸå‹æ¨¡å¼)"></a>Prototype(åŸå‹æ¨¡å¼)</h3><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºPrototypeï¼Œè¡¨ç¤ºä¸€ä¸ªbeanå®šä¹‰å¯¹åº”å¤šä¸ªå¯¹è±¡å®ä¾‹ã€‚Prototypeä½œç”¨åŸŸçš„beanä¼šå¯¼è‡´åœ¨æ¯æ¬¡å¯¹è¯¥beanè¯·æ±‚ï¼ˆå°†å…¶æ³¨å…¥åˆ°å¦ä¸€ä¸ªbeanä¸­ï¼Œæˆ–è€…ä»¥ç¨‹åºçš„æ–¹å¼è°ƒç”¨å®¹å™¨çš„getBean()æ–¹æ³•ï¼‰æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanå®ä¾‹ã€‚Prototypeæ˜¯åŸå‹ç±»å‹ï¼Œå®ƒåœ¨æˆ‘ä»¬åˆ›å»ºå®¹å™¨çš„æ—¶å€™å¹¶æ²¡æœ‰å®ä¾‹åŒ–ï¼Œè€Œæ˜¯å½“æˆ‘ä»¬è·å–beançš„æ—¶å€™æ‰ä¼šå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”æˆ‘ä»¬æ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ ¹æ®ç»éªŒï¼Œå¯¹æœ‰çŠ¶æ€çš„beanåº”è¯¥ä½¿ç”¨prototypeä½œç”¨åŸŸï¼Œè€Œå¯¹æ— çŠ¶æ€çš„beanåˆ™åº”è¯¥ä½¿ç”¨singletonä½œç”¨åŸŸã€‚åœ¨XMLä¸­å°†beanå®šä¹‰æˆprototypeï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;account&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.foo.DefaultAccount&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>/&gt;</span>  </span><br><span class="line"> æˆ–è€…</span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;account&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.foo.DefaultAccount&quot;</span> <span class="attr">singleton</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h3><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºRequestï¼Œè¡¨ç¤ºåœ¨ä¸€æ¬¡HTTPè¯·æ±‚ä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼›å³æ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šæœ‰å„è‡ªçš„beanå®ä¾‹ï¼Œå®ƒä»¬ä¾æ®æŸä¸ªbeanå®šä¹‰åˆ›å»ºè€Œæˆã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;loginAction&quot;</span> <span class="attr">class</span>=<span class="string">cn.csdn.LoginAction</span>&quot; <span class="attr">scope</span>=<span class="string">&quot;request&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>é’ˆå¯¹æ¯æ¬¡HTTPè¯·æ±‚ï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®loginAction beançš„å®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„LoginAction beanå®ä¾‹ï¼Œä¸”è¯¥loginAction beanå®ä¾‹ä»…åœ¨å½“å‰HTTP requestå†…æœ‰æ•ˆï¼Œå› æ­¤å¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œå…¶ä»–è¯·æ±‚ä¸­æ ¹æ®loginAction beanå®šä¹‰åˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªè¯·æ±‚çš„çŠ¶æ€å˜åŒ–ã€‚å½“å¤„ç†è¯·æ±‚ç»“æŸï¼Œrequestä½œç”¨åŸŸçš„beanå®ä¾‹å°†è¢«é”€æ¯ã€‚</p><h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSessionï¼Œè¡¨ç¤ºåœ¨ä¸€ä¸ªHTTP Sessionä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userPreferences&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.foo.UserPreferences&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;session&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>é’ˆå¯¹æŸä¸ªHTTP Sessionï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®userPreferences beanå®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„userPreferences beanå®ä¾‹ï¼Œä¸”è¯¥userPreferences beanä»…åœ¨å½“å‰HTTP Sessionå†…æœ‰æ•ˆã€‚ä¸requestä½œç”¨åŸŸä¸€æ ·ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€åˆ›å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œåˆ«çš„HTTP Sessionä¸­æ ¹æ®userPreferencesåˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªHTTP Sessionçš„çŠ¶æ€å˜åŒ–ã€‚å½“HTTP Sessionæœ€ç»ˆè¢«åºŸå¼ƒçš„æ—¶å€™ï¼Œåœ¨è¯¥HTTP Sessionä½œç”¨åŸŸå†…çš„beanä¹Ÿä¼šè¢«åºŸå¼ƒæ‰ã€‚</p><h1 id="7-Beançš„è‡ªåŠ¨è£…é…"><a href="#7-Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="7. Beançš„è‡ªåŠ¨è£…é…"></a>7. Beançš„è‡ªåŠ¨è£…é…</h1><hr><ul><li>è‡ªåŠ¨è£…é…æ˜¯ä½¿ç”¨springæ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹æ³•</li><li>springä¼šåœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ä¸ºæŸä¸ªbeanå¯»æ‰¾å…¶ä¾èµ–çš„beanã€‚</li></ul><p>Springä¸­beanæœ‰ä¸‰ç§è£…é…æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol><li>åœ¨xmlä¸­æ˜¾å¼é…ç½®ï¼›</li><li>åœ¨javaä¸­æ˜¾å¼é…ç½®ï¼›</li><li>éšå¼çš„beanå‘ç°æœºåˆ¶å’Œè‡ªåŠ¨è£…é…ã€‚</li></ol><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®²ç¬¬ä¸‰ç§ï¼šè‡ªåŠ¨åŒ–çš„è£…é…beanã€‚</p><p>Springçš„è‡ªåŠ¨è£…é…éœ€è¦ä»ä¸¤ä¸ªè§’åº¦æ¥å®ç°ï¼Œæˆ–è€…è¯´æ˜¯ä¸¤ä¸ªæ“ä½œï¼š</p><ol><li>ç»„ä»¶æ‰«æ(component scanning)ï¼šspringä¼šè‡ªåŠ¨å‘ç°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­æ‰€åˆ›å»ºçš„beanï¼›</li><li>è‡ªåŠ¨è£…é…(autowiring)ï¼šspringè‡ªåŠ¨æ»¡è¶³beanä¹‹é—´çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„IoC&#x2F;DIï¼›</li></ol><p>ç»„ä»¶æ‰«æå’Œè‡ªåŠ¨è£…é…ç»„åˆå‘æŒ¥å·¨å¤§å¨åŠ›ï¼Œä½¿å¾—æ˜¾ç¤ºçš„é…ç½®é™ä½åˆ°æœ€å°‘ã€‚</p><p><strong>æ¨èä¸ä½¿ç”¨è‡ªåŠ¨è£…é…xmlé…ç½® , è€Œä½¿ç”¨æ³¨è§£ .</strong></p><h2 id="7-1-æµ‹è¯•"><a href="#7-1-æµ‹è¯•" class="headerlink" title="7.1 æµ‹è¯•"></a>7.1 æµ‹è¯•</h2><blockquote><p>æµ‹è¯•ç¯å¢ƒæ­å»º</p></blockquote><p>1ã€æ–°å»ºä¸€ä¸ªé¡¹ç›®</p><p>2ã€æ–°å»ºä¸¤ä¸ªå®ä½“ç±»ï¼ŒCat Dog éƒ½æœ‰ä¸€ä¸ªå«çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shout</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;miao~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shout</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;wang~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€æ–°å»ºä¸€ä¸ªç”¨æˆ·ç±» User</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> Cat cat;</span><br><span class="line">   <span class="keyword">private</span> Dog dog;</span><br><span class="line">   <span class="keyword">private</span> String str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„mavené…ç½®æ–‡ä»¶å¾—åŠ å…¥ä¸‹é¢,ä½¿ç”¨@Dataæ³¨è§£ï¼Œgetå’Œsetæ–¹æ³•å¯çœ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- è¯·æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬ --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4ã€ç¼–å†™Springé…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;  </span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span>  </span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  </span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans  </span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;  </span><br><span class="line">  </span><br><span class="line">    &lt;bean id=<span class="string">&quot;dog&quot;</span> class=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;  </span><br><span class="line">    &lt;bean id=<span class="string">&quot;cat&quot;</span> class=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;  </span><br><span class="line">  </span><br><span class="line">    &lt;bean id=<span class="string">&quot;user&quot;</span> class=<span class="string">&quot;org.example.pojo.User&quot;</span>&gt;  </span><br><span class="line">        &lt;property name=<span class="string">&quot;cat&quot;</span> ref=<span class="string">&quot;cat&quot;</span>/&gt;  </span><br><span class="line">        &lt;property name=<span class="string">&quot;dog&quot;</span> ref=<span class="string">&quot;dog&quot;</span>/&gt;  </span><br><span class="line">        &lt;property name=<span class="string">&quot;str&quot;</span> value=<span class="string">&quot;qinjiang&quot;</span>/&gt;  </span><br><span class="line">    &lt;/bean&gt;&lt;/beans&gt;</span><br></pre></td></tr></table></figure><p>5ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMethodAutowire</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">       user.getCat().shout();</span><br><span class="line">       user.getDog().shout();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæ­£å¸¸è¾“å‡ºï¼Œç¯å¢ƒOK</p><h2 id="7-2-ByNameè‡ªåŠ¨è£…é…"><a href="#7-2-ByNameè‡ªåŠ¨è£…é…" class="headerlink" title="7.2 ByNameè‡ªåŠ¨è£…é…"></a>7.2 ByNameè‡ªåŠ¨è£…é…</h2><blockquote><p>byName</p></blockquote><p><strong>autowire byName (æŒ‰åç§°è‡ªåŠ¨è£…é…)</strong></p><p>ç”±äºåœ¨æ‰‹åŠ¨é…ç½®xmlè¿‡ç¨‹ä¸­ï¼Œå¸¸å¸¸å‘ç”Ÿå­—æ¯ç¼ºæ¼å’Œå¤§å°å†™ç­‰é”™è¯¯ï¼Œè€Œæ— æ³•å¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œä½¿å¾—å¼€å‘æ•ˆç‡é™ä½ã€‚</p><p>é‡‡ç”¨è‡ªåŠ¨è£…é…å°†é¿å…è¿™äº›é”™è¯¯ï¼Œå¹¶ä¸”ä½¿é…ç½®ç®€å•åŒ–ã€‚</p><p>æµ‹è¯•ï¼š</p><p>1ã€ä¿®æ”¹beané…ç½®ï¼Œå¢åŠ ä¸€ä¸ªå±æ€§ autowire&#x3D;â€œbyNameâ€</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.User&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;str&quot;</span> <span class="attr">value</span>=<span class="string">&quot;qinjiang&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2ã€å†æ¬¡æµ‹è¯•ï¼Œç»“æœä¾æ—§æˆåŠŸè¾“å‡ºï¼</p><p>3ã€æˆ‘ä»¬å°† cat çš„bean idä¿®æ”¹ä¸º catXXX</p><p>4ã€å†æ¬¡æµ‹è¯•ï¼Œ æ‰§è¡Œæ—¶æŠ¥ç©ºæŒ‡é’ˆjava.lang.NullPointerExceptionã€‚å› ä¸ºæŒ‰byNameè§„åˆ™æ‰¾ä¸å¯¹åº”setæ–¹æ³•ï¼ŒçœŸæ­£çš„setCatå°±æ²¡æ‰§è¡Œï¼Œå¯¹è±¡å°±æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶å°±ä¼šæŠ¥ç©ºæŒ‡é’ˆé”™è¯¯ã€‚</p><p><strong>å°ç»“ï¼š</strong></p><p>å½“ä¸€ä¸ªbeanèŠ‚ç‚¹å¸¦æœ‰ autowire byNameçš„å±æ€§æ—¶ã€‚</p><ol><li>å°†æŸ¥æ‰¾å…¶ç±»ä¸­æ‰€æœ‰çš„setæ–¹æ³•åï¼Œä¾‹å¦‚setCatï¼Œè·å¾—å°†setå»æ‰å¹¶ä¸”é¦–å­—æ¯å°å†™çš„å­—ç¬¦ä¸²ï¼Œå³catã€‚</li><li>å»springå®¹å™¨ä¸­å¯»æ‰¾æ˜¯å¦æœ‰æ­¤å­—ç¬¦ä¸²åç§°idçš„å¯¹è±¡ã€‚</li><li>å¦‚æœæœ‰ï¼Œå°±å–å‡ºæ³¨å…¥ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</li></ol><h2 id="7-3-ByTypeè‡ªåŠ¨è£…é…"><a href="#7-3-ByTypeè‡ªåŠ¨è£…é…" class="headerlink" title="7.3 ByTypeè‡ªåŠ¨è£…é…"></a>7.3 ByTypeè‡ªåŠ¨è£…é…</h2><blockquote><p>byType</p></blockquote><p><strong>autowire byType (æŒ‰ç±»å‹è‡ªåŠ¨è£…é…)</strong></p><p>ä½¿ç”¨autowire byTypeé¦–å…ˆéœ€è¦ä¿è¯ï¼šåŒä¸€ç±»å‹çš„å¯¹è±¡ï¼Œåœ¨springå®¹å™¨ä¸­å”¯ä¸€ã€‚å¦‚æœä¸å”¯ä¸€ï¼Œä¼šæŠ¥ä¸å”¯ä¸€çš„å¼‚å¸¸ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NoUniqueBeanDefinitionException</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p>1ã€å°†userçš„beané…ç½®ä¿®æ”¹ä¸€ä¸‹ ï¼š autowire&#x3D;â€œbyTypeâ€<br>2ã€æµ‹è¯•ï¼Œæ­£å¸¸è¾“å‡º<br>3ã€åœ¨æ³¨å†Œä¸€ä¸ªcat çš„beanå¯¹è±¡ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.User&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;str&quot;</span> <span class="attr">value</span>=<span class="string">&quot;qinjiang&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4ã€æµ‹è¯•ï¼ŒæŠ¥é”™ï¼šNoUniqueBeanDefinitionException</p><p>5ã€åˆ æ‰cat2ï¼Œå°†catçš„beanåç§°æ”¹æ‰ï¼æµ‹è¯•ï¼å› ä¸ºæ˜¯æŒ‰ç±»å‹è£…é…ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šæŠ¥å¼‚å¸¸ï¼Œä¹Ÿä¸å½±å“æœ€åçš„ç»“æœã€‚ç”šè‡³å°†idå±æ€§å»æ‰ï¼Œä¹Ÿä¸å½±å“ç»“æœã€‚</p><p>è¿™å°±æ˜¯æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…ï¼</p><h2 id="7-4-ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"><a href="#7-4-ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…" class="headerlink" title="7.4 ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"></a>7.4 ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…</h2><blockquote><p>ä½¿ç”¨æ³¨è§£</p></blockquote><p>jdk1.5å¼€å§‹æ”¯æŒæ³¨è§£ï¼Œspring2.5å¼€å§‹å…¨é¢æ”¯æŒæ³¨è§£ã€‚</p><p>å‡†å¤‡å·¥ä½œï¼šåˆ©ç”¨æ³¨è§£çš„æ–¹å¼æ³¨å…¥å±æ€§ã€‚</p><p>1ã€åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼•å…¥contextæ–‡ä»¶å¤´</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line"></span><br><span class="line">http://www.springframework.org/schema/context</span><br><span class="line">http://www.springframework.org/schema/context/spring-context.xsd</span><br></pre></td></tr></table></figure><p>2ã€å¼€å¯å±æ€§æ³¨è§£æ”¯æŒï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:annotation-config/&gt;</span><br></pre></td></tr></table></figure><h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h3><ul><li>@Autowiredæ˜¯æŒ‰ç±»å‹è‡ªåŠ¨è½¬é…çš„ï¼Œä¸æ”¯æŒidåŒ¹é…ã€‚</li><li>éœ€è¦å¯¼å…¥ spring-aopçš„åŒ…ï¼</li></ul><p>æµ‹è¯•ï¼š</p><p>1ã€å°†Userç±»ä¸­çš„setæ–¹æ³•å»æ‰ï¼Œä½¿ç”¨@Autowiredæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> Cat cat;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> Dog dog;</span><br><span class="line">   <span class="keyword">private</span> String str;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> Cat <span class="title function_">getCat</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> cat;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="keyword">public</span> Dog <span class="title function_">getDog</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> dog;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">getStr</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2ã€æ­¤æ—¶é…ç½®æ–‡ä»¶å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.User&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ï¼ŒæˆåŠŸè¾“å‡ºç»“æœï¼</p><p>ç§‘æ™®ï¼š<br>@Autowired(required&#x3D;false) è¯´æ˜ï¼šfalseï¼Œå¯¹è±¡å¯ä»¥ä¸ºnullï¼›trueï¼Œå¯¹è±¡å¿…é¡»å­˜å¯¹è±¡ï¼Œä¸èƒ½ä¸ºnullã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¦‚æœå…è®¸å¯¹è±¡ä¸ºnullï¼Œè®¾ç½®required = false,é»˜è®¤ä¸ºtrue</span></span><br><span class="line"><span class="meta">@Autowired(required = false)</span></span><br><span class="line"><span class="keyword">private</span> Cat cat;</span><br></pre></td></tr></table></figure><h3 id="Qualifier"><a href="#Qualifier" class="headerlink" title="@Qualifier"></a>@Qualifier</h3><ul><li>@Autowiredæ˜¯æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…çš„ï¼ŒåŠ ä¸Š@Qualifieråˆ™å¯ä»¥æ ¹æ®byNameçš„æ–¹å¼è‡ªåŠ¨è£…é…</li><li>@Qualifierä¸èƒ½å•ç‹¬ä½¿ç”¨ã€‚</li></ul><p>æµ‹è¯•å®éªŒæ­¥éª¤ï¼š</p><p>1ã€é…ç½®æ–‡ä»¶ä¿®æ”¹å†…å®¹ï¼Œä¿è¯ç±»å‹å­˜åœ¨å¯¹è±¡ã€‚ä¸”åå­—ä¸ä¸ºç±»çš„é»˜è®¤åå­—ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>2ã€æ²¡æœ‰åŠ Qualifieræµ‹è¯•ï¼Œç›´æ¥æŠ¥é”™</p><p>3ã€åœ¨å±æ€§ä¸Šæ·»åŠ Qualifieræ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier(value = &quot;cat2&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Cat cat;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier(value = &quot;dog2&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Dog dog;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼ŒæˆåŠŸè¾“å‡ºï¼</p><h3 id="Resource"><a href="#Resource" class="headerlink" title="@Resource"></a>@Resource</h3><ul><li>@Resourceå¦‚æœ‰æŒ‡å®šçš„nameå±æ€§ï¼Œå…ˆæŒ‰è¯¥å±æ€§è¿›è¡ŒbyNameæ–¹å¼æŸ¥æ‰¾è£…é…ï¼›</li><li>å…¶æ¬¡å†è¿›è¡Œé»˜è®¤çš„byNameæ–¹å¼è¿›è¡Œè£…é…ï¼›</li><li>å¦‚æœä»¥ä¸Šéƒ½ä¸æˆåŠŸï¼Œåˆ™æŒ‰byTypeçš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚</li><li>éƒ½ä¸æˆåŠŸï¼Œåˆ™æŠ¥å¼‚å¸¸ã€‚</li></ul><p>å®ä½“ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="comment">//å¦‚æœå…è®¸å¯¹è±¡ä¸ºnullï¼Œè®¾ç½®required = false,é»˜è®¤ä¸ºtrue</span></span><br><span class="line">   <span class="meta">@Resource(name = &quot;cat2&quot;)</span></span><br><span class="line">   <span class="keyword">private</span> Cat cat;</span><br><span class="line">   <span class="meta">@Resource</span></span><br><span class="line">   <span class="keyword">private</span> Dog dog;</span><br><span class="line">   <span class="keyword">private</span> String str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.exampleg.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.User&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼šç»“æœOK</p><p>é…ç½®æ–‡ä»¶2ï¼šbeans.xml ï¼Œ åˆ æ‰cat2</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.pojo.Cat&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å®ä½“ç±»ä¸Šåªä¿ç•™æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> Cat cat;</span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> Dog dog;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼šOK</p><p>ç»“è®ºï¼šå…ˆè¿›è¡ŒbyNameæŸ¥æ‰¾ï¼Œå¤±è´¥ï¼›å†è¿›è¡ŒbyTypeæŸ¥æ‰¾ï¼ŒæˆåŠŸã€‚</p><p><strong>å°ç»“ï¼š</strong><br>@Resourceå’Œ@Autowiredçš„åŒºåˆ«ï¼š</p><ul><li>éƒ½æ˜¯ç”¨æ¥è‡ªåŠ¨è£…é…çš„ï¼Œéƒ½å¯ä»¥æ”¾åœ¨å±æ€§å­—æ®µä¸Š</li><li>@Autowiredé€šè¿‡bynameçš„æ–¹å¼å®ç°ï¼Œè€Œä¸”å¿…é¡»è¦æ±‚è¿™ä¸ªå¯¹è±¡å­˜åœ¨ï¼ã€å¸¸ç”¨ã€‘</li><li>@Resourceé»˜è®¤é€šè¿‡bynameçš„æ–¹å¼å®ç°ï¼Œå¦‚æœæ‰¾ä¸åˆ°åå­—ï¼Œåˆ™é€šè¿‡byTypeå®ç°ï¼å¦‚æœä¸¤ä¸ªéƒ½æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹å°±æŠ¥é”™ï¼ã€å¸¸ç”¨ã€‘</li><li>æ‰§è¡Œé¡ºåºä¸åŒï¼š@Autowiredé€šè¿‡ByTypeçš„æ–¹å¼å®ç°</li></ul><h1 id="8-ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8.ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8.ä½¿ç”¨æ³¨è§£å¼€å‘</h1><hr><blockquote><p>è¯´æ˜</p></blockquote><p>åœ¨spring4ä¹‹åï¼Œæƒ³è¦ä½¿ç”¨æ³¨è§£å½¢å¼ï¼Œå¿…é¡»å¾—è¦å¼•å…¥aopçš„åŒ…</p><p><img src="/2025/11/20/Spring/file-20251119152530183.png" alt="500"></p><p>åœ¨é…ç½®æ–‡ä»¶å½“ä¸­ï¼Œè¿˜å¾—è¦å¼•å…¥ä¸€ä¸ªcontextçº¦æŸ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-1-Beançš„å®ç°"><a href="#8-1-Beançš„å®ç°" class="headerlink" title="8.1.Beançš„å®ç°"></a>8.1.Beançš„å®ç°</h2><p>æˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯ä½¿ç”¨ bean çš„æ ‡ç­¾è¿›è¡Œbeanæ³¨å…¥ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œ<strong>æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨æ³¨è§£ï¼</strong> ç”¨Java17 å¾—mavené…ç½®æ–‡ä»¶æŠŠspringç‰ˆæœ¬æ”¹ä¸º5.3.34</p><h3 id="1ã€é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£"><a href="#1ã€é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£" class="headerlink" title="1ã€é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£"></a>1ã€é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æŒ‡å®šæ³¨è§£æ‰«æåŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;org.example.pojo&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>2ã€åœ¨æŒ‡å®šåŒ…ä¸‹ç¼–å†™ç±»ï¼Œå¢åŠ æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;user&quot;)</span></span><br><span class="line"><span class="comment">// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;bean id=&quot;user&quot; class=&quot;å½“å‰æ³¨è§£çš„ç±»&quot;/&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;yaoyinjin&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">       <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">   System.out.println(user.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€ç»“æœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yaoyinjin</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><h2 id="8-2-å±æ€§æ³¨å…¥"><a href="#8-2-å±æ€§æ³¨å…¥" class="headerlink" title="8.2.å±æ€§æ³¨å…¥"></a>8.2.å±æ€§æ³¨å…¥</h2><p>ä½¿ç”¨æ³¨è§£æ³¨å…¥å±æ€§</p><p>1ã€å¯ä»¥ä¸ç”¨æä¾›setæ–¹æ³•ï¼Œç›´æ¥åœ¨ç›´æ¥åä¸Šæ·»åŠ @value(â€œå€¼â€)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;user&quot;)</span></span><br><span class="line"><span class="comment">// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;bean id=&quot;user&quot; class=&quot;å½“å‰æ³¨è§£çš„ç±»&quot;/&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="meta">@Value(&quot;yaoyinjin&quot;)</span></span><br><span class="line">   <span class="comment">// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;property name=&quot;name&quot; value=&quot;ç§¦ç–†&quot;/&gt;</span></span><br><span class="line">   <span class="keyword">public</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€å¦‚æœæä¾›äº†setæ–¹æ³•ï¼Œåœ¨setæ–¹æ³•ä¸Šæ·»åŠ @value(â€œå€¼â€);</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Value(&quot;yaoyinjin&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-3-è¡ç”Ÿæ³¨è§£"><a href="#8-3-è¡ç”Ÿæ³¨è§£" class="headerlink" title="8.3.è¡ç”Ÿæ³¨è§£"></a>8.3.è¡ç”Ÿæ³¨è§£</h2><p>æˆ‘ä»¬è¿™äº›æ³¨è§£ï¼Œå°±æ˜¯æ›¿ä»£äº†åœ¨é…ç½®æ–‡ä»¶å½“ä¸­é…ç½®æ­¥éª¤è€Œå·²ï¼æ›´åŠ çš„æ–¹ä¾¿å¿«æ·ï¼</p><p><strong>@Componentä¸‰ä¸ªè¡ç”Ÿæ³¨è§£</strong></p><p>ä¸ºäº†æ›´å¥½çš„è¿›è¡Œåˆ†å±‚ï¼ŒSpringå¯ä»¥ä½¿ç”¨å…¶å®ƒä¸‰ä¸ªæ³¨è§£ï¼ŒåŠŸèƒ½ä¸€æ ·ï¼Œç›®å‰ä½¿ç”¨å“ªä¸€ä¸ªåŠŸèƒ½éƒ½ä¸€æ ·ã€‚</p><ul><li>@Controllerï¼šcontrollerå±‚</li><li>@Serviceï¼šserviceå±‚</li><li>@Repositoryï¼šdaoå±‚</li></ul><p>å†™ä¸Šè¿™äº›æ³¨è§£ï¼Œå°±ç›¸å½“äºå°†è¿™ä¸ªç±»äº¤ç»™Springç®¡ç†è£…é…äº†ï¼</p><h2 id="8-4-è‡ªåŠ¨è£…é…æ³¨è§£"><a href="#8-4-è‡ªåŠ¨è£…é…æ³¨è§£" class="headerlink" title="8.4.è‡ªåŠ¨è£…é…æ³¨è§£"></a>8.4.è‡ªåŠ¨è£…é…æ³¨è§£</h2><p>åœ¨Beançš„è‡ªåŠ¨è£…é…å·²ç»è®²è¿‡äº†ï¼Œå¯ä»¥å›é¡¾ï¼</p><h2 id="8-5-ä½œç”¨åŸŸ"><a href="#8-5-ä½œç”¨åŸŸ" class="headerlink" title="8.5.ä½œç”¨åŸŸ"></a>8.5.ä½œç”¨åŸŸ</h2><p>@scope</p><ul><li>singletonï¼šé»˜è®¤çš„ï¼ŒSpringä¼šé‡‡ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šé”€æ¯ã€‚</li><li>prototypeï¼šå¤šä¾‹æ¨¡å¼ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡ä¸ä¼šé”€æ¯ã€‚å†…éƒ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šå›æ”¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller(&quot;user&quot;)</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="meta">@Value(&quot;yaoyinjin&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-6-å°ç»“"><a href="#8-6-å°ç»“" class="headerlink" title="8.6.å°ç»“"></a>8.6.å°ç»“</h2><p><strong>XMLä¸æ³¨è§£æ¯”è¾ƒ</strong></p><ul><li>XMLå¯ä»¥é€‚ç”¨ä»»ä½•åœºæ™¯ ï¼Œç»“æ„æ¸…æ™°ï¼Œç»´æŠ¤æ–¹ä¾¿</li><li>æ³¨è§£ä¸æ˜¯è‡ªå·±æä¾›çš„ç±»ä½¿ç”¨ä¸äº†ï¼Œå¼€å‘ç®€å•æ–¹ä¾¿</li></ul><p><strong>xmlä¸æ³¨è§£æ•´åˆå¼€å‘</strong>Â ï¼šæ¨èæœ€ä½³å®è·µ</p><ul><li>xmlç®¡ç†Bean</li><li>æ³¨è§£å®Œæˆå±æ€§æ³¨å…¥</li><li>ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œ å¯ä»¥ä¸ç”¨æ‰«æï¼Œæ‰«ææ˜¯ä¸ºäº†ç±»ä¸Šçš„æ³¨è§£</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span>  </span><br></pre></td></tr></table></figure><p>ä½œç”¨ï¼š</p><ul><li>è¿›è¡Œæ³¨è§£é©±åŠ¨æ³¨å†Œï¼Œä»è€Œä½¿æ³¨è§£ç”Ÿæ•ˆ</li><li>ç”¨äºæ¿€æ´»é‚£äº›å·²ç»åœ¨springå®¹å™¨é‡Œæ³¨å†Œè¿‡çš„beanä¸Šé¢çš„æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºçš„å‘Springæ³¨å†Œ</li><li>å¦‚æœä¸æ‰«æåŒ…ï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ç½®bean</li><li>å¦‚æœä¸åŠ æ³¨è§£é©±åŠ¨ï¼Œåˆ™æ³¨å…¥çš„å€¼ä¸ºnullï¼</li></ul><h1 id="9-ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring"><a href="#9-ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring" class="headerlink" title="9.ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring"></a>9.ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring</h1><hr><p>JavaConfig åŸæ¥æ˜¯ Spring çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒé€šè¿‡ Java ç±»çš„æ–¹å¼æä¾› Bean çš„å®šä¹‰ä¿¡æ¯ï¼Œåœ¨ Spring4 çš„ç‰ˆæœ¬ï¼Œ JavaConfig å·²æ­£å¼æˆä¸º Spring4 çš„æ ¸å¿ƒåŠŸèƒ½ ã€‚</p><p>æµ‹è¯•ï¼š</p><p>1ã€ç¼–å†™ä¸€ä¸ªå®ä½“ç±»ï¼ŒDog</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>  <span class="comment">//å°†è¿™ä¸ªç±»æ ‡æ³¨ä¸ºSpringçš„ä¸€ä¸ªç»„ä»¶ï¼Œæ”¾åˆ°å®¹å™¨ä¸­ï¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€æ–°å»ºä¸€ä¸ªconfigé…ç½®åŒ…ï¼Œç¼–å†™ä¸€ä¸ªMyConfigé…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span> <span class="comment">//é€šè¿‡æ–¹æ³•æ³¨å†Œä¸€ä¸ªbeanï¼Œè¿™é‡Œçš„è¿”å›å€¼å°±Beançš„ç±»å‹ï¼Œæ–¹æ³•åå°±æ˜¯beançš„idï¼</span></span><br><span class="line">   <span class="keyword">public</span> Dog <span class="title function_">dog</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">           <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MyConfig.class);</span><br><span class="line">   <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) applicationContext.getBean(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">   System.out.println(dog.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€æˆåŠŸè¾“å‡ºç»“æœï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dog</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p><strong>å¯¼å…¥å…¶ä»–é…ç½®å¦‚ä½•åšå‘¢ï¼Ÿ</strong></p><p>1ã€æˆ‘ä»¬å†ç¼–å†™ä¸€ä¸ªé…ç½®ç±»ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig2</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€åœ¨ä¹‹å‰çš„é…ç½®ç±»ä¸­æˆ‘ä»¬æ¥é€‰æ‹©å¯¼å…¥è¿™ä¸ªé…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(MyConfig2.class)</span>  <span class="comment">//å¯¼å…¥åˆå¹¶å…¶ä»–é…ç½®ç±»ï¼Œç±»ä¼¼äºé…ç½®æ–‡ä»¶ä¸­çš„ inculde æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="keyword">public</span> Dog <span class="title function_">dog</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºè¿™ç§Javaç±»çš„é…ç½®æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ä¹‹åçš„SpringBoot å’Œ SpringCloudä¸­è¿˜ä¼šå¤§é‡çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™äº›æ³¨è§£çš„ä½œç”¨å³å¯ï¼</p><h1 id="10-ä»£ç†æ¨¡å¼"><a href="#10-ä»£ç†æ¨¡å¼" class="headerlink" title="10.ä»£ç†æ¨¡å¼"></a>10.ä»£ç†æ¨¡å¼</h1><hr><p>ä¸ºä»€ä¹ˆè¦å­¦ä¹ ä»£ç†æ¨¡å¼ï¼Œå› ä¸ºAOPçš„åº•å±‚æœºåˆ¶å°±æ˜¯åŠ¨æ€ä»£ç†ï¼</p><p>ä»£ç†æ¨¡å¼ï¼š</p><ul><li>é™æ€ä»£ç†</li><li>åŠ¨æ€ä»£ç†</li></ul><p>å­¦ä¹ aopä¹‹å‰ , æˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹ä»£ç†æ¨¡å¼ï¼<br><img src="/2025/11/20/Spring/file-20251119153211601.png" alt="500"></p><h2 id="10-1-é™æ€ä»£ç†"><a href="#10-1-é™æ€ä»£ç†" class="headerlink" title="10.1 é™æ€ä»£ç†"></a>10.1 é™æ€ä»£ç†</h2><p><strong>é™æ€ä»£ç†è§’è‰²åˆ†æ</strong></p><ul><li>æŠ½è±¡è§’è‰² : ä¸€èˆ¬ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°</li><li>çœŸå®è§’è‰² : è¢«ä»£ç†çš„è§’è‰²</li><li>ä»£ç†è§’è‰² : ä»£ç†çœŸå®è§’è‰² ; ä»£ç†çœŸå®è§’è‰²å , ä¸€èˆ¬ä¼šåšä¸€äº›é™„å±çš„æ“ä½œ .</li><li>å®¢æˆ· : ä½¿ç”¨ä»£ç†è§’è‰²æ¥è¿›è¡Œä¸€äº›æ“ä½œ .</li></ul><p><strong>ä»£ç å®ç°</strong></p><p>Rent . java å³æŠ½è±¡è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡è§’è‰²ï¼šç§Ÿæˆ¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Host . java å³çœŸå®è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//çœŸå®è§’è‰²: æˆ¿ä¸œï¼Œæˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Host</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æˆ¿å±‹å‡ºç§Ÿ&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Proxy . java å³ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»£ç†è§’è‰²ï¼šä¸­ä»‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Proxy</span> <span class="keyword">implements</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> Host host;</span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">(Host host)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.host = host;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ç§Ÿæˆ¿</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>&#123;</span><br><span class="line">       seeHouse();</span><br><span class="line">       host.rent();</span><br><span class="line">       fare();</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//çœ‹æˆ¿</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;å¸¦æˆ¿å®¢çœ‹æˆ¿&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//æ”¶ä¸­ä»‹è´¹</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fare</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ”¶ä¸­ä»‹è´¹&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Client . java å³å®¢æˆ·</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®¢æˆ·ç±»ï¼Œä¸€èˆ¬å®¢æˆ·éƒ½ä¼šå»æ‰¾ä»£ç†ï¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="comment">//æˆ¿ä¸œè¦ç§Ÿæˆ¿</span></span><br><span class="line">       <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>();</span><br><span class="line">       <span class="comment">//ä¸­ä»‹å¸®åŠ©æˆ¿ä¸œ</span></span><br><span class="line">       <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(host);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//ä½ å»æ‰¾ä¸­ä»‹ï¼</span></span><br><span class="line">       proxy.rent();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¸¦æˆ¿å®¢çœ‹æˆ¿</span><br><span class="line">æˆ¿å±‹å‡ºç§Ÿï¼</span><br><span class="line">æ”¶ä¸­ä»‹è´¹</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p>åˆ†æï¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ ç›´æ¥æ¥è§¦çš„å°±æ˜¯ä¸­ä»‹ï¼Œå°±å¦‚åŒç°å®ç”Ÿæ´»ä¸­çš„æ ·å­ï¼Œä½ çœ‹ä¸åˆ°æˆ¿ä¸œï¼Œä½†æ˜¯ä½ ä¾æ—§ç§Ÿåˆ°äº†æˆ¿ä¸œçš„æˆ¿å­é€šè¿‡ä»£ç†ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ä»£ç†æ¨¡å¼ï¼Œç¨‹åºæºè‡ªäºç”Ÿæ´»ï¼Œæ‰€ä»¥å­¦ç¼–ç¨‹çš„äººï¼Œä¸€èˆ¬èƒ½å¤Ÿæ›´åŠ æŠ½è±¡çš„çœ‹å¾…ç”Ÿæ´»ä¸­å‘ç”Ÿçš„äº‹æƒ…ã€‚</p><p><strong>é™æ€ä»£ç†æ¨¡å¼çš„å¥½å¤„ï¼š</strong></p><ul><li>å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œæ›´åŠ çº¯ç²¹ï¼ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡</li><li>å…¬å…±ä¹Ÿå°±å°±äº¤ç»™ä»£ç†è§’è‰²ï¼å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ï¼</li><li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•çš„æ—¶å€™ï¼Œæ–¹ä¾¿é›†ä¸­ç®¡ç†ï¼</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä¸€ä¸ªçœŸå®è§’è‰²å°±ä¼šäº§ç”Ÿä¸€ä¸ªä»£ç†è§’è‰²ï¼›ä»£ç é‡ä¼šç¿»å€<del>å¼€å‘æ•ˆç‡ä¼šå˜ä½</del></li></ul><p>æˆ‘ä»¬æƒ³è¦é™æ€ä»£ç†çš„å¥½å¤„ï¼Œåˆä¸æƒ³è¦é™æ€ä»£ç†çš„ç¼ºç‚¹ï¼Œæ‰€ä»¥ , å°±æœ‰äº†åŠ¨æ€ä»£ç† !</p><h2 id="10-2-é™æ€ä»£ç†å†ç†è§£"><a href="#10-2-é™æ€ä»£ç†å†ç†è§£" class="headerlink" title="10.2 é™æ€ä»£ç†å†ç†è§£"></a>10.2 é™æ€ä»£ç†å†ç†è§£</h2><p>ç»ƒä¹ æ­¥éª¤ï¼š</p><p>1ã€åˆ›å»ºä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œæ¯”å¦‚å’‹ä»¬å¹³æ—¶åšçš„ç”¨æˆ·ä¸šåŠ¡ï¼ŒæŠ½è±¡èµ·æ¥å°±æ˜¯å¢åˆ æ”¹æŸ¥ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡è§’è‰²ï¼šå¢åˆ æ”¹æŸ¥ä¸šåŠ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>;</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªçœŸå®å¯¹è±¡æ¥å®Œæˆè¿™äº›å¢åˆ æ”¹æŸ¥æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//çœŸå®å¯¹è±¡ï¼Œå®Œæˆå¢åˆ æ”¹æŸ¥æ“ä½œçš„äºº</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€éœ€æ±‚æ¥äº†ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæ—¥å¿—åŠŸèƒ½ï¼Œæ€ä¹ˆå®ç°ï¼</p><ul><li>æ€è·¯1 ï¼šåœ¨å®ç°ç±»ä¸Šå¢åŠ ä»£ç  ã€éº»çƒ¦ï¼ã€‘</li><li>æ€è·¯2ï¼šä½¿ç”¨ä»£ç†æ¥åšï¼Œèƒ½å¤Ÿä¸æ”¹å˜åŸæ¥çš„ä¸šåŠ¡æƒ…å†µä¸‹ï¼Œå®ç°æ­¤åŠŸèƒ½å°±æ˜¯æœ€å¥½çš„äº†ï¼</li></ul><p>4ã€è®¾ç½®ä¸€ä¸ªä»£ç†ç±»æ¥å¤„ç†æ—¥å¿—ï¼ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»£ç†è§’è‰²ï¼Œåœ¨è¿™é‡Œé¢å¢åŠ æ—¥å¿—çš„å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceProxy</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> UserServiceImpl userService;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserService</span><span class="params">(UserServiceImpl userService)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.userService = userService;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">       log(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">       userService.add();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">       log(<span class="string">&quot;delete&quot;</span>);</span><br><span class="line">       userService.delete();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">       log(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">       userService.update();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> &#123;</span><br><span class="line">       log(<span class="string">&quot;query&quot;</span>);</span><br><span class="line">       userService.query();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ‰§è¡Œäº†&quot;</span>+msg+<span class="string">&quot;æ–¹æ³•&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5ã€æµ‹è¯•è®¿é—®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="comment">//çœŸå®ä¸šåŠ¡</span></span><br><span class="line">       <span class="type">UserServiceImpl</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">       <span class="comment">//ä»£ç†ç±»</span></span><br><span class="line">       <span class="type">UserServiceProxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceProxy</span>();</span><br><span class="line">       <span class="comment">//ä½¿ç”¨ä»£ç†ç±»å®ç°æ—¥å¿—åŠŸèƒ½ï¼</span></span><br><span class="line">       proxy.setUserService(userService);</span><br><span class="line"></span><br><span class="line">       proxy.add();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ‰§è¡Œäº†addæ–¹æ³•</span><br><span class="line">å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure><p>OKï¼Œåˆ°äº†ç°åœ¨ä»£ç†æ¨¡å¼å¤§å®¶åº”è¯¥éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ï¼Œé‡ç‚¹å¤§å®¶éœ€è¦ç†è§£å…¶ä¸­çš„æ€æƒ³ï¼›<br>æˆ‘ä»¬åœ¨ä¸æ”¹å˜åŸæ¥çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†å¯¹åŸæœ‰åŠŸèƒ½çš„å¢å¼ºï¼Œè¿™æ˜¯AOPä¸­æœ€æ ¸å¿ƒçš„æ€æƒ³<br>èŠèŠAOPï¼š<strong>çºµå‘å¼€å‘ï¼Œæ¨ªå‘å¼€å‘</strong></p><p><img src="/2025/11/20/Spring/file-20251119153731275.png"></p><h2 id="10-2-åŠ¨æ€ä»£ç†"><a href="#10-2-åŠ¨æ€ä»£ç†" class="headerlink" title="10.2 åŠ¨æ€ä»£ç†"></a>10.2 åŠ¨æ€ä»£ç†</h2><ul><li><p>åŠ¨æ€ä»£ç†çš„è§’è‰²å’Œé™æ€ä»£ç†çš„ä¸€æ · .</p></li><li><p>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ . é™æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯æˆ‘ä»¬æå‰å†™å¥½çš„</p></li><li><p>åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸¤ç±» : ä¸€ç±»æ˜¯åŸºäºæ¥å£åŠ¨æ€ä»£ç† , ä¸€ç±»æ˜¯åŸºäºç±»çš„åŠ¨æ€ä»£ç†</p></li><li><ul><li>åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†â€”-JDKåŠ¨æ€ä»£ç†<ul><li>åŸºäºç±»çš„åŠ¨æ€ä»£ç†â€“cglib</li><li>ç°åœ¨ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯ javasist æ¥ç”ŸæˆåŠ¨æ€ä»£ç† . ç™¾åº¦ä¸€ä¸‹javasist</li><li>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨JDKçš„åŸç”Ÿä»£ç æ¥å®ç°ï¼Œå…¶ä½™çš„é“ç†éƒ½æ˜¯ä¸€æ ·çš„ï¼ã€</li></ul></li></ul></li></ul><p><strong>JDKçš„åŠ¨æ€ä»£ç†éœ€è¦äº†è§£ä¸¤ä¸ªç±»</strong></p><p>æ ¸å¿ƒ : InvocationHandler å’Œ Proxy ï¼Œ æ‰“å¼€JDKå¸®åŠ©æ–‡æ¡£çœ‹çœ‹</p><p>ã€InvocationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åºã€‘<br><img src="/2025/11/20/Spring/file-20251119153831888.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Object invoke(Object proxy, æ–¹æ³• method, Object[] args)ï¼›</span><br><span class="line">//å‚æ•°</span><br><span class="line">//proxy - è°ƒç”¨è¯¥æ–¹æ³•çš„ä»£ç†å®ä¾‹</span><br><span class="line">//method -æ‰€è¿°æ–¹æ³•å¯¹åº”äºè°ƒç”¨ä»£ç†å®ä¾‹ä¸Šçš„æ¥å£æ–¹æ³•çš„å®ä¾‹ã€‚æ–¹æ³•å¯¹è±¡çš„å£°æ˜ç±»å°†æ˜¯è¯¥æ–¹æ³•å£°æ˜çš„æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯ä»£ç†ç±»ç»§æ‰¿è¯¥æ–¹æ³•çš„ä»£ç†æ¥å£çš„è¶…çº§æ¥å£ã€‚</span><br><span class="line">//args -åŒ…å«çš„æ–¹æ³•è°ƒç”¨ä¼ é€’ä»£ç†å®ä¾‹çš„å‚æ•°å€¼çš„å¯¹è±¡çš„é˜µåˆ—ï¼Œæˆ–nullå¦‚æœæ¥å£æ–¹æ³•æ²¡æœ‰å‚æ•°ã€‚åŸå§‹ç±»å‹çš„å‚æ•°åŒ…å«åœ¨é€‚å½“çš„åŸå§‹åŒ…è£…å™¨ç±»çš„å®ä¾‹ä¸­ï¼Œä¾‹å¦‚java.lang.Integeræˆ–java.lang.Boolean ã€‚</span><br></pre></td></tr></table></figure><p>ã€Proxy : ä»£ç†ã€‘<br><img src="/2025/11/20/Spring/file-20251119153901577.png"></p><p><img src="/2025/11/20/Spring/file-20251119153921917.png"></p><p><img src="/2025/11/20/Spring/file-20251119153948659.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”Ÿæˆä»£ç†ç±»</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="keyword">return</span> Proxy.newProxyInstance(<span class="built_in">this</span>.getClass().getClassLoader(),</span><br><span class="line">                                 rent.getClass().getInterfaces(),<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç å®ç°</strong></p><p>æŠ½è±¡è§’è‰²å’ŒçœŸå®è§’è‰²å’Œä¹‹å‰çš„ä¸€æ ·ï¼</p><p>Rent . java å³æŠ½è±¡è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡è§’è‰²ï¼šç§Ÿæˆ¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Host . java å³çœŸå®è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//çœŸå®è§’è‰²: æˆ¿ä¸œï¼Œæˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Host</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æˆ¿å±‹å‡ºç§Ÿ&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ProxyInvocationHandler. java å³ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;  </span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;  </span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> Rent rent;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRent</span><span class="params">(Rent rent)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.rent = rent;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ç”Ÿæˆä»£ç†ç±»ï¼Œé‡ç‚¹æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œè·å–è¦ä»£ç†çš„æŠ½è±¡è§’è‰²ï¼ä¹‹å‰éƒ½æ˜¯ä¸€ä¸ªè§’è‰²ï¼Œç°åœ¨å¯ä»¥ä»£ç†ä¸€ç±»è§’è‰²</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> Proxy.newProxyInstance(<span class="built_in">this</span>.getClass().getClassLoader(),</span><br><span class="line">               rent.getClass().getInterfaces(),<span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// proxy : ä»£ç†ç±» method : ä»£ç†ç±»çš„è°ƒç”¨å¤„ç†ç¨‹åºçš„æ–¹æ³•å¯¹è±¡.</span></span><br><span class="line">   <span class="comment">// å¤„ç†ä»£ç†å®ä¾‹ä¸Šçš„æ–¹æ³•è°ƒç”¨å¹¶è¿”å›ç»“æœ</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> throwsThrowable &#123;</span><br><span class="line">       seeHouse();</span><br><span class="line">       <span class="comment">//æ ¸å¿ƒï¼šæœ¬è´¨åˆ©ç”¨åå°„å®ç°ï¼</span></span><br><span class="line">       <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(rent, args);</span><br><span class="line">       fare();</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//çœ‹æˆ¿</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;å¸¦æˆ¿å®¢çœ‹æˆ¿&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//æ”¶ä¸­ä»‹è´¹</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fare</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ”¶ä¸­ä»‹è´¹&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Client . java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç§Ÿå®¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="comment">//çœŸå®è§’è‰²</span></span><br><span class="line">       <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>();</span><br><span class="line">       <span class="comment">//ä»£ç†å®ä¾‹çš„è°ƒç”¨å¤„ç†ç¨‹åº</span></span><br><span class="line">       <span class="type">ProxyInvocationHandler</span> <span class="variable">pih</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyInvocationHandler</span>();</span><br><span class="line">       pih.setRent(host); <span class="comment">//å°†çœŸå®è§’è‰²æ”¾ç½®è¿›å»ï¼</span></span><br><span class="line">       <span class="type">Rent</span> <span class="variable">proxy</span> <span class="operator">=</span> (Rent)pih.getProxy(); <span class="comment">//åŠ¨æ€ç”Ÿæˆå¯¹åº”çš„ä»£ç†ç±»ï¼</span></span><br><span class="line">       proxy.rent();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒï¼š<strong>ä¸€ä¸ªåŠ¨æ€ä»£ç† , ä¸€èˆ¬ä»£ç†æŸä¸€ç±»ä¸šåŠ¡ , ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ï¼ã€</strong></p><h2 id="10-4æ·±åŒ–ç†è§£"><a href="#10-4æ·±åŒ–ç†è§£" class="headerlink" title="10.4æ·±åŒ–ç†è§£"></a>10.4æ·±åŒ–ç†è§£</h2><p>æˆ‘ä»¬æ¥ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°ä»£ç†æˆ‘ä»¬åé¢å†™çš„UserServiceï¼</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™ä¸€ä¸ªé€šç”¨çš„åŠ¨æ€ä»£ç†å®ç°çš„ç±»ï¼æ‰€æœ‰çš„ä»£ç†å¯¹è±¡è®¾ç½®ä¸ºObjectå³å¯ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTarget</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.target = target;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ç”Ÿæˆä»£ç†ç±»</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> Proxy.newProxyInstance(<span class="built_in">this</span>.getClass().getClassLoader(),</span><br><span class="line">               target.getClass().getInterfaces(),<span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// proxy : ä»£ç†ç±»</span></span><br><span class="line">   <span class="comment">// method : ä»£ç†ç±»çš„è°ƒç”¨å¤„ç†ç¨‹åºçš„æ–¹æ³•å¯¹è±¡.</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">       log(method.getName());</span><br><span class="line">       <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(target, args);</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String methodName)</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ‰§è¡Œäº†&quot;</span>+methodName+<span class="string">&quot;æ–¹æ³•&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="comment">//çœŸå®å¯¹è±¡</span></span><br><span class="line">       <span class="type">UserServiceImpl</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">       <span class="comment">//ä»£ç†å¯¹è±¡çš„è°ƒç”¨å¤„ç†ç¨‹åº</span></span><br><span class="line">       <span class="type">ProxyInvocationHandler</span> <span class="variable">pih</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyInvocationHandler</span>();</span><br><span class="line">       pih.setTarget(userService); <span class="comment">//è®¾ç½®è¦ä»£ç†çš„å¯¹è±¡</span></span><br><span class="line">       <span class="type">UserService</span> <span class="variable">proxy</span> <span class="operator">=</span> (UserService)pih.getProxy(); <span class="comment">//åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼</span></span><br><span class="line">       proxy.delete();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼Œå¢åˆ æ”¹æŸ¥ï¼ŒæŸ¥çœ‹ç»“æœï¼</p><h2 id="10-5åŠ¨æ€ä»£ç†çš„å¥½å¤„"><a href="#10-5åŠ¨æ€ä»£ç†çš„å¥½å¤„" class="headerlink" title="10.5åŠ¨æ€ä»£ç†çš„å¥½å¤„"></a>10.5åŠ¨æ€ä»£ç†çš„å¥½å¤„</h2><p>é™æ€ä»£ç†æœ‰çš„å®ƒéƒ½æœ‰ï¼Œé™æ€ä»£ç†æ²¡æœ‰çš„ï¼Œå®ƒä¹Ÿæœ‰ï¼</p><ul><li>å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„çœŸå®è§’è‰²æ›´åŠ çº¯ç²¹ . ä¸å†å»å…³æ³¨ä¸€äº›å…¬å…±çš„äº‹æƒ… .</li><li>å…¬å…±çš„ä¸šåŠ¡ç”±ä»£ç†æ¥å®Œæˆ . å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ ,</li><li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•æ—¶å˜å¾—æ›´åŠ é›†ä¸­å’Œæ–¹ä¾¿ .</li><li>ä¸€ä¸ªåŠ¨æ€ä»£ç† , ä¸€èˆ¬ä»£ç†æŸä¸€ç±»ä¸šåŠ¡</li><li>ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ï¼</li></ul><h1 id="11-AOP"><a href="#11-AOP" class="headerlink" title="11. AOP"></a>11. AOP</h1><hr><h2 id="11-1-ä»€ä¹ˆæ˜¯AOP"><a href="#11-1-ä»€ä¹ˆæ˜¯AOP" class="headerlink" title="11.1.ä»€ä¹ˆæ˜¯AOP"></a>11.1.ä»€ä¹ˆæ˜¯AOP</h2><p>AOPï¼ˆAspect Oriented Programmingï¼‰æ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPæ˜¯OOPçš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</p><p><img src="/2025/11/20/Spring/file-20251119170850369.png"></p><h2 id="11-2-Aopåœ¨Springä¸­çš„ä½œç”¨"><a href="#11-2-Aopåœ¨Springä¸­çš„ä½œç”¨" class="headerlink" title="11.2.Aopåœ¨Springä¸­çš„ä½œç”¨"></a>11.2.Aopåœ¨Springä¸­çš„ä½œç”¨</h2><p>æä¾›å£°æ˜å¼äº‹åŠ¡ï¼›å…è®¸ç”¨æˆ·è‡ªå®šä¹‰åˆ‡é¢</p><p>ä»¥ä¸‹åè¯éœ€è¦äº†è§£ä¸‹ï¼š</p><ul><li>æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼šè·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„æ–¹æ³•æˆ–åŠŸèƒ½ã€‚å³æ˜¯ï¼Œä¸æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘æ— å…³çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚æ—¥å¿— , å®‰å…¨ , ç¼“å­˜ , äº‹åŠ¡ç­‰ç­‰ â€¦</li><li>åˆ‡é¢ï¼ˆASPECTï¼‰ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹ è¢«æ¨¡å—åŒ– çš„ç‰¹æ®Šå¯¹è±¡ã€‚å³ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ã€‚</li><li>é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œã€‚å³ï¼Œå®ƒæ˜¯ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚</li><li>ç›®æ ‡ï¼ˆTargetï¼‰ï¼šè¢«é€šçŸ¥å¯¹è±¡ã€‚</li><li>ä»£ç†ï¼ˆProxyï¼‰ï¼šå‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡ã€‚</li><li>åˆ‡å…¥ç‚¹ï¼ˆPointCutï¼‰ï¼šåˆ‡é¢é€šçŸ¥ æ‰§è¡Œçš„ â€œåœ°ç‚¹â€çš„å®šä¹‰ã€‚</li><li>è¿æ¥ç‚¹ï¼ˆJointPointï¼‰ï¼šä¸åˆ‡å…¥ç‚¹åŒ¹é…çš„æ‰§è¡Œç‚¹ã€‚<br><img src="/2025/11/20/Spring/file-20251119170921515.png"><br>SpringAOPä¸­ï¼Œé€šè¿‡Adviceå®šä¹‰æ¨ªåˆ‡é€»è¾‘ï¼ŒSpringä¸­æ”¯æŒ5ç§ç±»å‹çš„Advice:</li></ul><table><thead><tr><th>é€šçŸ¥ç±»å‹</th><th>è¿æ¥ç‚¹</th><th>å®ç°æ¥å£</th></tr></thead><tbody><tr><td>å‰ç½®é€šçŸ¥</td><td>æ–¹æ³•å‰</td><td>org.springframework.aop.MethodBeforeAdvice</td></tr><tr><td>åç½®é€šçŸ¥</td><td>æ–¹æ³•å</td><td>org.springframework.aop.AfterReturningAdvice</td></tr><tr><td>ç¯ç»•é€šçŸ¥</td><td>æ–¹æ³•å‰å</td><td>org.aopalliance.intercept.MethodInterceptor</td></tr><tr><td>å¼‚å¸¸æŠ›å‡ºé€šçŸ¥</td><td>æ–¹æ³•æŠ›å‡ºå¼‚å¸¸</td><td>org.springframework.aop.ThrowsAdvice</td></tr><tr><td>å¼•ä»‹é€šçŸ¥</td><td>ç±»ä¸­å¢åŠ æ–°çš„æ–¹æ³•å±æ€§</td><td>org.springframework.aop.IntroductionInterceptor</td></tr></tbody></table><p>å³ Aop åœ¨ ä¸æ”¹å˜åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹ , å»å¢åŠ æ–°çš„åŠŸèƒ½ .</p><h2 id="11-3-ä½¿ç”¨Springå®ç°Aop"><a href="#11-3-ä½¿ç”¨Springå®ç°Aop" class="headerlink" title="11.3.ä½¿ç”¨Springå®ç°Aop"></a>11.3.ä½¿ç”¨Springå®ç°Aop</h2><p>ã€é‡ç‚¹ã€‘ä½¿ç”¨AOPç»‡å…¥ï¼Œéœ€è¦å¯¼å…¥ä¸€ä¸ªä¾èµ–åŒ…ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="11-3-1-é€šè¿‡-Spring-API-å®ç°"><a href="#11-3-1-é€šè¿‡-Spring-API-å®ç°" class="headerlink" title="11.3.1.é€šè¿‡ Spring API å®ç°"></a>11.3.1.é€šè¿‡ Spring API å®ç°</h3><p><strong>ç¬¬ä¸€ç§æ–¹å¼</strong></p><p>é¦–å…ˆç¼–å†™æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£å’Œå®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">search</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;å¢åŠ ç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;åˆ é™¤ç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ›´æ–°ç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">search</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æŸ¥è¯¢ç”¨æˆ·&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åå»springçš„æ–‡ä»¶ä¸­æ³¨å†Œ , å¹¶å®ç°aopåˆ‡å…¥å®ç° , æ³¨æ„å¯¼å…¥çº¦æŸ .</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.service.UserServiceImpl&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;log&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.log.Log&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.log.AfterLog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--aopçš„é…ç½®--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--åˆ‡å…¥ç‚¹ expression:è¡¨è¾¾å¼åŒ¹é…è¦æ‰§è¡Œçš„æ–¹æ³•--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* org.example.service.UserServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--æ‰§è¡Œç¯ç»•; advice-refæ‰§è¡Œæ–¹æ³• . pointcut-refåˆ‡å…¥ç‚¹--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;log&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">       <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userService&quot;</span>);</span><br><span class="line">       userService.search();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Aopçš„é‡è¦æ€§ : å¾ˆé‡è¦ . ä¸€å®šè¦ç†è§£å…¶ä¸­çš„æ€è·¯ , ä¸»è¦æ˜¯æ€æƒ³çš„ç†è§£è¿™ä¸€å— .</p><p>Springçš„Aopå°±æ˜¯å°†å…¬å…±çš„ä¸šåŠ¡ (æ—¥å¿— , å®‰å…¨ç­‰) å’Œé¢†åŸŸä¸šåŠ¡ç»“åˆèµ·æ¥ , å½“æ‰§è¡Œé¢†åŸŸä¸šåŠ¡æ—¶ , å°†ä¼šæŠŠå…¬å…±ä¸šåŠ¡åŠ è¿›æ¥ . å®ç°å…¬å…±ä¸šåŠ¡çš„é‡å¤åˆ©ç”¨ . é¢†åŸŸä¸šåŠ¡æ›´çº¯ç²¹ , ç¨‹åºçŒ¿ä¸“æ³¨é¢†åŸŸä¸šåŠ¡ , å…¶æœ¬è´¨è¿˜æ˜¯åŠ¨æ€ä»£ç† .</p><h3 id="11-3-2-è‡ªå®šä¹‰ç±»æ¥å®ç°Aop"><a href="#11-3-2-è‡ªå®šä¹‰ç±»æ¥å®ç°Aop" class="headerlink" title="11.3.2.è‡ªå®šä¹‰ç±»æ¥å®ç°Aop"></a>11.3.2.è‡ªå®šä¹‰ç±»æ¥å®ç°Aop</h3><p><strong>ç¬¬äºŒç§æ–¹å¼</strong></p><p>ç›®æ ‡ä¸šåŠ¡ç±»ä¸å˜ä¾æ—§æ˜¯userServiceImpl</p><p>ç¬¬ä¸€æ­¥ : å†™æˆ‘ä»¬è‡ªå·±çš„ä¸€ä¸ªåˆ‡å…¥ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiyPointcut</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;---------æ–¹æ³•æ‰§è¡Œå‰---------&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;---------æ–¹æ³•æ‰§è¡Œå---------&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å»springä¸­é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç¬¬äºŒç§æ–¹å¼è‡ªå®šä¹‰å®ç°--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;diy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.config.DiyPointcut&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--aopçš„é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨AOPçš„æ ‡ç­¾å®ç°--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;diy&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;diyPonitcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* org.example.service.UserServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;diyPonitcut&quot;</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;diyPonitcut&quot;</span> <span class="attr">method</span>=<span class="string">&quot;after&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">       <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userService&quot;</span>);</span><br><span class="line">       userService.add();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="11-3-4-ä½¿ç”¨æ³¨è§£å®ç°"><a href="#11-3-4-ä½¿ç”¨æ³¨è§£å®ç°" class="headerlink" title="11.3.4.ä½¿ç”¨æ³¨è§£å®ç°"></a>11.3.4.ä½¿ç”¨æ³¨è§£å®ç°</h3><p><strong>ç¬¬ä¸‰ç§æ–¹å¼</strong></p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™ä¸€ä¸ªæ³¨è§£å®ç°çš„å¢å¼ºç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationPointcut</span> &#123;</span><br><span class="line">   <span class="meta">@Before(&quot;execution(* org.example.service.UserServiceImpl.*(..))&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;---------æ–¹æ³•æ‰§è¡Œå‰---------&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@After(&quot;execution(* org.example.service.UserServiceImpl.*(..))&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;---------æ–¹æ³•æ‰§è¡Œå---------&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Around(&quot;execution(* org.example.service.UserServiceImpl.*(..))&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint jp)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;ç¯ç»•å‰&quot;</span>);</span><br><span class="line">       System.out.println(<span class="string">&quot;ç­¾å:&quot;</span>+jp.getSignature());</span><br><span class="line">       <span class="comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•proceed</span></span><br><span class="line">       <span class="type">Object</span> <span class="variable">proceed</span> <span class="operator">=</span> jp.proceed();</span><br><span class="line">       System.out.println(<span class="string">&quot;ç¯ç»•å&quot;</span>);</span><br><span class="line">       System.out.println(proceed);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šåœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼Œæ³¨å†Œbeanï¼Œå¹¶å¢åŠ æ”¯æŒæ³¨è§£çš„é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç¬¬ä¸‰ç§æ–¹å¼:æ³¨è§£å®ç°--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;annotationPointcut&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.config.AnnotationPointcut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>aop:aspectj-autoproxyï¼šè¯´æ˜</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡aopå‘½åç©ºé—´çš„&lt;aop:aspectj-autoproxy /&gt;å£°æ˜è‡ªåŠ¨ä¸ºspringå®¹å™¨ä¸­é‚£äº›é…ç½®@aspectJåˆ‡é¢çš„beanåˆ›å»ºä»£ç†ï¼Œç»‡å…¥åˆ‡é¢ã€‚å½“ç„¶ï¼Œspring åœ¨å†…éƒ¨ä¾æ—§é‡‡ç”¨AnnotationAwareAspectJAutoProxyCreatorè¿›è¡Œè‡ªåŠ¨ä»£ç†çš„åˆ›å»ºå·¥ä½œï¼Œä½†å…·ä½“å®ç°çš„ç»†èŠ‚å·²ç»è¢«&lt;aop:aspectj-autoproxy /&gt;éšè—èµ·æ¥äº†</span><br><span class="line"></span><br><span class="line">&lt;aop:aspectj-autoproxy /&gt;æœ‰ä¸€ä¸ªproxy-target-classå±æ€§ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºä½¿ç”¨jdkåŠ¨æ€ä»£ç†ç»‡å…¥å¢å¼ºï¼Œå½“é…ä¸º&lt;aop:aspectj-autoproxy  poxy-target-class=&quot;true&quot;/&gt;æ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨CGLibåŠ¨æ€ä»£ç†æŠ€æœ¯ç»‡å…¥å¢å¼ºã€‚ä¸è¿‡å³ä½¿proxy-target-classè®¾ç½®ä¸ºfalseï¼Œå¦‚æœç›®æ ‡ç±»æ²¡æœ‰å£°æ˜æ¥å£ï¼Œåˆ™springå°†è‡ªåŠ¨ä½¿ç”¨CGLibåŠ¨æ€ä»£ç†ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="12-æ•´åˆMybatis"><a href="#12-æ•´åˆMybatis" class="headerlink" title="12. æ•´åˆMybatis"></a>12. æ•´åˆMybatis</h1><hr><blockquote><p> æ­¥éª¤</p></blockquote><p>1ã€å¯¼å…¥ç›¸å…³jaråŒ…</p><p>junit</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>mybatis</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>mysql-connector-java</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>springç›¸å…³</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>aspectJ AOP ç»‡å…¥å™¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>mybatis-springæ•´åˆåŒ… ã€é‡ç‚¹ã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é…ç½®Mavené™æ€èµ„æºè¿‡æ»¤é—®é¢˜ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2ã€ç¼–å†™é…ç½®æ–‡ä»¶</p><p>3ã€ä»£ç å®ç°</p><h2 id="12-1å›å¿†MyBatis"><a href="#12-1å›å¿†MyBatis" class="headerlink" title="12.1å›å¿†MyBatis"></a>12.1å›å¿†MyBatis</h2><p><strong>ç¼–å†™pojoå®ä½“ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> id;  <span class="comment">//id</span></span><br><span class="line">   <span class="keyword">private</span> String name;   <span class="comment">//å§“å</span></span><br><span class="line">   <span class="keyword">private</span> String pwd;   <span class="comment">//å¯†ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å®ç°mybatisçš„é…ç½®æ–‡ä»¶</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">       <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">       <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;org.example.pojo&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;org.example.dao&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>UserDaoæ¥å£ç¼–å†™</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ¥å£å¯¹åº”çš„Mapperæ˜ å°„æ–‡ä»¶</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">       <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">       <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;org.example.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from user</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">selectUser</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">   <span class="type">String</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">   <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(resource);</span><br><span class="line">   <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> newSqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">   <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">   <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">   List&lt;User&gt; userList = mapper.selectUser();</span><br><span class="line">   <span class="keyword">for</span> (User user: userList)&#123;</span><br><span class="line">       System.out.println(user);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="12-2-MyBatis-Springå­¦ä¹ "><a href="#12-2-MyBatis-Springå­¦ä¹ " class="headerlink" title="12.2.MyBatis-Springå­¦ä¹ "></a>12.2.MyBatis-Springå­¦ä¹ </h2><p>å¼•å…¥Springä¹‹å‰éœ€è¦äº†è§£mybatis-springåŒ…ä¸­çš„ä¸€äº›é‡è¦ç±»ï¼›</p><p><a href="http://www.mybatis.org/spring/zh/index.html">http://www.mybatis.org/spring/zh/index.html</a></p><p><strong>ä»€ä¹ˆæ˜¯ MyBatis-Springï¼Ÿ</strong></p><p>MyBatis-Spring ä¼šå¸®åŠ©ä½ å°† MyBatis ä»£ç æ— ç¼åœ°æ•´åˆåˆ° Spring ä¸­ã€‚</p><p><strong>çŸ¥è¯†åŸºç¡€</strong></p><p>åœ¨å¼€å§‹ä½¿ç”¨ MyBatis-Spring ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆç†Ÿæ‚‰ Spring å’Œ MyBatis è¿™ä¸¤ä¸ªæ¡†æ¶å’Œæœ‰å…³å®ƒä»¬çš„æœ¯è¯­ã€‚è¿™å¾ˆé‡è¦</p><p>MyBatis-Spring éœ€è¦ä»¥ä¸‹ç‰ˆæœ¬ï¼š</p><table><thead><tr><th align="left">MyBatis-Spring</th><th align="left">MyBatis</th><th align="left">Spring æ¡†æ¶</th><th align="left">Spring Batch</th><th align="left">Java</th></tr></thead><tbody><tr><td align="left">2.0</td><td align="left">3.5+</td><td align="left">5.0+</td><td align="left">4.0+</td><td align="left">Java 8+</td></tr><tr><td align="left">1.3</td><td align="left">3.4+</td><td align="left">3.2.2+</td><td align="left">2.1+</td><td align="left">Java 6+</td></tr></tbody></table><p>å¦‚æœä½¿ç”¨ Maven ä½œä¸ºæ„å»ºå·¥å…·ï¼Œä»…éœ€è¦åœ¨ pom.xml ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç å³å¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¦å’Œ Spring ä¸€èµ·ä½¿ç”¨ MyBatisï¼Œéœ€è¦åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡ä¸­å®šä¹‰è‡³å°‘ä¸¤æ ·ä¸œè¥¿ï¼šä¸€ä¸ª SqlSessionFactory å’Œè‡³å°‘ä¸€ä¸ªæ•°æ®æ˜ å°„å™¨ç±»ã€‚</p><p>åœ¨ MyBatis-Spring ä¸­ï¼Œå¯ä½¿ç”¨SqlSessionFactoryBeanæ¥åˆ›å»º SqlSessionFactoryã€‚è¦é…ç½®è¿™ä¸ªå·¥å‚ beanï¼Œåªéœ€è¦æŠŠä¸‹é¢ä»£ç æ”¾åœ¨ Spring çš„ XML é…ç½®æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šSqlSessionFactoryéœ€è¦ä¸€ä¸ª DataSourceï¼ˆæ•°æ®æºï¼‰ã€‚è¿™å¯ä»¥æ˜¯ä»»æ„çš„ DataSourceï¼Œåªéœ€è¦å’Œé…ç½®å…¶å®ƒ Spring æ•°æ®åº“è¿æ¥ä¸€æ ·é…ç½®å®ƒå°±å¯ä»¥äº†ã€‚</p><p>åœ¨åŸºç¡€çš„ MyBatis ç”¨æ³•ä¸­ï¼Œæ˜¯é€šè¿‡ SqlSessionFactoryBuilder æ¥åˆ›å»º SqlSessionFactory çš„ã€‚è€Œåœ¨ MyBatis-Spring ä¸­ï¼Œåˆ™ä½¿ç”¨ SqlSessionFactoryBean æ¥åˆ›å»ºã€‚</p><p>åœ¨ MyBatis ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ SqlSessionFactory æ¥åˆ›å»º SqlSessionã€‚ä¸€æ—¦ä½ è·å¾—ä¸€ä¸ª session ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ‰§è¡Œæ˜ å°„äº†çš„è¯­å¥ï¼Œæäº¤æˆ–å›æ»šè¿æ¥ï¼Œæœ€åï¼Œå½“ä¸å†éœ€è¦å®ƒçš„æ—¶å€™ï¼Œä½ å¯ä»¥å…³é—­ sessionã€‚</p><p>SqlSessionFactoryæœ‰ä¸€ä¸ªå”¯ä¸€çš„å¿…è¦å±æ€§ï¼šç”¨äº JDBC çš„ DataSourceã€‚è¿™å¯ä»¥æ˜¯ä»»æ„çš„ DataSource å¯¹è±¡ï¼Œå®ƒçš„é…ç½®æ–¹æ³•å’Œå…¶å®ƒ Spring æ•°æ®åº“è¿æ¥æ˜¯ä¸€æ ·çš„ã€‚</p><p>ä¸€ä¸ªå¸¸ç”¨çš„å±æ€§æ˜¯ configLocationï¼Œå®ƒç”¨æ¥æŒ‡å®š MyBatis çš„ XML é…ç½®æ–‡ä»¶è·¯å¾„ã€‚å®ƒåœ¨éœ€è¦ä¿®æ”¹ MyBatis çš„åŸºç¡€é…ç½®éå¸¸æœ‰ç”¨ã€‚é€šå¸¸ï¼ŒåŸºç¡€é…ç½®æŒ‡çš„æ˜¯ &lt; settings&gt; æˆ– &lt; typeAliases&gt;å…ƒç´ ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶å¹¶ä¸éœ€è¦æ˜¯ä¸€ä¸ªå®Œæ•´çš„ MyBatis é…ç½®ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œä»»ä½•ç¯å¢ƒé…ç½®ï¼ˆï¼‰ï¼Œæ•°æ®æºï¼ˆï¼‰å’Œ MyBatis çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆï¼‰éƒ½ä¼šè¢«å¿½ç•¥ã€‚SqlSessionFactoryBean ä¼šåˆ›å»ºå®ƒè‡ªæœ‰çš„ MyBatis ç¯å¢ƒé…ç½®ï¼ˆEnvironmentï¼‰ï¼Œå¹¶æŒ‰è¦æ±‚è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒçš„å€¼ã€‚</p><p>SqlSessionTemplate æ˜¯ MyBatis-Spring çš„æ ¸å¿ƒã€‚ä½œä¸º SqlSession çš„ä¸€ä¸ªå®ç°ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨å®ƒæ— ç¼ä»£æ›¿ä½ ä»£ç ä¸­å·²ç»åœ¨ä½¿ç”¨çš„ SqlSessionã€‚</p><p>æ¨¡æ¿å¯ä»¥å‚ä¸åˆ° Spring çš„äº‹åŠ¡ç®¡ç†ä¸­ï¼Œå¹¶ä¸”ç”±äºå…¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥ä¾›å¤šä¸ªæ˜ å°„å™¨ç±»ä½¿ç”¨ï¼Œä½ åº”è¯¥æ€»æ˜¯ç”¨ SqlSessionTemplate æ¥æ›¿æ¢ MyBatis é»˜è®¤çš„ DefaultSqlSession å®ç°ã€‚åœ¨åŒä¸€åº”ç”¨ç¨‹åºä¸­çš„ä¸åŒç±»ä¹‹é—´æ··æ‚ä½¿ç”¨å¯èƒ½ä¼šå¼•èµ·æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ SqlSessionFactory ä½œä¸ºæ„é€ æ–¹æ³•çš„å‚æ•°æ¥åˆ›å»º SqlSessionTemplate å¯¹è±¡ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œè¿™ä¸ª bean å°±å¯ä»¥ç›´æ¥æ³¨å…¥åˆ°ä½ çš„ DAO bean ä¸­äº†ã€‚ä½ éœ€è¦åœ¨ä½ çš„ bean ä¸­æ·»åŠ ä¸€ä¸ª SqlSession å±æ€§ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span> SqlSession sqlSession;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSqlSession</span><span class="params">(SqlSession sqlSession)</span> &#123;</span><br><span class="line">   <span class="built_in">this</span>.sqlSession = sqlSession;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(String userId)</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> sqlSession.getMapper...;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ä¸‹é¢è¿™æ ·ï¼Œæ³¨å…¥ SqlSessionTemplateï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.sample.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSession&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="12-3-æ•´åˆå®ç°ä¸€"><a href="#12-3-æ•´åˆå®ç°ä¸€" class="headerlink" title="12.3.æ•´åˆå®ç°ä¸€"></a>12.3.æ•´åˆå®ç°ä¸€</h2><p>1ã€å¼•å…¥Springé…ç½®æ–‡ä»¶beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2ã€é…ç½®æ•°æ®æºæ›¿æ¢mybaitsçš„æ•°æ®æº</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®æ•°æ®æºï¼šæ•°æ®æºæœ‰éå¸¸å¤šï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ï¼Œä¹Ÿå¯ä½¿ä½¿ç”¨Springçš„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span><span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ã€é…ç½®SqlSessionFactoryï¼Œå…³è”MyBatis</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®SqlSessionFactory--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å…³è”Mybatis--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/kuang/dao/*.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4ã€æ³¨å†ŒsqlSessionTemplateï¼Œå…³è”sqlSessionFactoryï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ³¨å†ŒsqlSessionTemplate , å…³è”sqlSessionFactory--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--åˆ©ç”¨æ„é€ å™¨æ³¨å…¥--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>5ã€å¢åŠ Daoæ¥å£çš„å®ç°ç±»ï¼›ç§æœ‰åŒ–sqlSessionTemplate</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//sqlSessionä¸ç”¨æˆ‘ä»¬è‡ªå·±åˆ›å»ºäº†ï¼ŒSpringæ¥ç®¡ç†</span></span><br><span class="line">   <span class="keyword">private</span> SqlSessionTemplate sqlSession;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSqlSession</span><span class="params">(SqlSessionTemplate sqlSession)</span> &#123;</span><br><span class="line">       <span class="built_in">this</span>.sqlSession = sqlSession;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">  &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>6ã€æ³¨å†Œbeanå®ç°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSession&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>7ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">     <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> newClassPathXmlApplicationContext(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">     <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">     List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">     System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæˆåŠŸè¾“å‡ºï¼ç°åœ¨æˆ‘ä»¬çš„Mybatisé…ç½®æ–‡ä»¶çš„çŠ¶æ€ï¼å‘ç°éƒ½å¯ä»¥è¢«Springæ•´åˆï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">       <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">       <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;org.example.pojo&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="12-4-æ•´åˆå®ç°äºŒ"><a href="#12-4-æ•´åˆå®ç°äºŒ" class="headerlink" title="12.4.æ•´åˆå®ç°äºŒ"></a>12.4.æ•´åˆå®ç°äºŒ</h2><p>mybatis-spring1.2.3ç‰ˆä»¥ä¸Šçš„æ‰æœ‰è¿™ä¸ª .</p><p>å®˜æ–¹æ–‡æ¡£æˆªå›¾ :</p><p>daoç»§æ‰¿Supportç±» , ç›´æ¥åˆ©ç”¨ getSqlSession() è·å¾— , ç„¶åç›´æ¥æ³¨å…¥SqlSessionFactory . æ¯”èµ·æ–¹å¼1 , ä¸éœ€è¦ç®¡ç†SqlSessionTemplate , è€Œä¸”å¯¹äº‹åŠ¡çš„æ”¯æŒæ›´åŠ å‹å¥½ . å¯è·Ÿè¸ªæºç æŸ¥çœ‹</p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/738f2c998b778cc08e231593de19df4a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æµ‹è¯•ï¼š</p><p>1ã€å°†æˆ‘ä»¬ä¸Šé¢å†™çš„UserDaoImplä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">       <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹beançš„é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">   List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ : æ•´åˆåˆ°springä»¥åå¯ä»¥å®Œå…¨ä¸è¦mybatisçš„é…ç½®æ–‡ä»¶ï¼Œé™¤äº†è¿™äº›æ–¹å¼å¯ä»¥å®ç°æ•´åˆä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥å®ç°ï¼Œè¿™ä¸ªç­‰æˆ‘ä»¬åé¢å­¦ä¹ SpringBootçš„æ—¶å€™è¿˜ä¼šæµ‹è¯•æ•´åˆï¼</strong></p><h1 id="13-å£°æ˜å¼äº‹åŠ¡"><a href="#13-å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="13.å£°æ˜å¼äº‹åŠ¡"></a>13.å£°æ˜å¼äº‹åŠ¡</h1><hr><h2 id="13-1-å›é¡¾äº‹åŠ¡"><a href="#13-1-å›é¡¾äº‹åŠ¡" class="headerlink" title="13.1.å›é¡¾äº‹åŠ¡"></a>13.1.å›é¡¾äº‹åŠ¡</h2><ul><li>äº‹åŠ¡åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹éå¸¸é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¸å®¹é©¬è™ï¼</li><li>äº‹åŠ¡ç®¡ç†æ˜¯ä¼ä¸šçº§åº”ç”¨ç¨‹åºå¼€å‘ä¸­å¿…å¤‡æŠ€æœ¯ï¼Œç”¨æ¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚</li></ul><p>äº‹åŠ¡å°±æ˜¯æŠŠä¸€ç³»åˆ—çš„åŠ¨ä½œå½“æˆä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œå•å…ƒï¼Œè¿™äº›åŠ¨ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸èµ·ä½œç”¨ã€‚</p><p><strong>äº‹åŠ¡å››ä¸ªå±æ€§ACID</strong></p><ol><li>åŸå­æ€§ï¼ˆatomicityï¼‰</li><li><ul><li>äº‹åŠ¡æ˜¯åŸå­æ€§æ“ä½œï¼Œç”±ä¸€ç³»åˆ—åŠ¨ä½œç»„æˆï¼Œäº‹åŠ¡çš„åŸå­æ€§ç¡®ä¿åŠ¨ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå®Œå…¨ä¸èµ·ä½œç”¨</li></ul></li><li>ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰</li><li><ul><li>ä¸€æ—¦æ‰€æœ‰äº‹åŠ¡åŠ¨ä½œå®Œæˆï¼Œäº‹åŠ¡å°±è¦è¢«æäº¤ã€‚æ•°æ®å’Œèµ„æºå¤„äºä¸€ç§æ»¡è¶³ä¸šåŠ¡è§„åˆ™çš„ä¸€è‡´æ€§çŠ¶æ€ä¸­</li></ul></li><li>éš”ç¦»æ€§ï¼ˆisolationï¼‰</li><li><ul><li>å¯èƒ½å¤šä¸ªäº‹åŠ¡ä¼šåŒæ—¶å¤„ç†ç›¸åŒçš„æ•°æ®ï¼Œå› æ­¤æ¯ä¸ªäº‹åŠ¡éƒ½åº”è¯¥ä¸å…¶ä»–äº‹åŠ¡éš”ç¦»å¼€æ¥ï¼Œé˜²æ­¢æ•°æ®æŸå</li></ul></li><li>æŒä¹…æ€§ï¼ˆdurabilityï¼‰</li><li><ul><li>äº‹åŠ¡ä¸€æ—¦å®Œæˆï¼Œæ— è®ºç³»ç»Ÿå‘ç”Ÿä»€ä¹ˆé”™è¯¯ï¼Œç»“æœéƒ½ä¸ä¼šå—åˆ°å½±å“ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œäº‹åŠ¡çš„ç»“æœè¢«å†™åˆ°æŒä¹…åŒ–å­˜å‚¨å™¨ä¸­</li></ul></li></ol><blockquote><p> æµ‹è¯•</p></blockquote><p>å°†ä¸Šé¢çš„ä»£ç æ‹·è´åˆ°ä¸€ä¸ªæ–°é¡¹ç›®ä¸­</p><p>åœ¨ä¹‹å‰çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ç»™userDaoæ¥å£æ–°å¢ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ é™¤å’Œå¢åŠ ç”¨æˆ·ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ·»åŠ ä¸€ä¸ªç”¨æˆ·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">addUser</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®idåˆ é™¤ç”¨æˆ·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">deleteUser</span><span class="params">(<span class="type">int</span> id)</span>;</span><br></pre></td></tr></table></figure><p>mapperæ–‡ä»¶ï¼Œæˆ‘ä»¬æ•…æ„æŠŠ deletes å†™é”™ï¼Œæµ‹è¯•ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;org.example.pojo.User&quot;</span>&gt;</span></span><br><span class="line">insert into user (id,name,pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">deletes from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™æ¥å£çš„å®ç°ç±»ï¼Œåœ¨å®ç°ç±»ä¸­ï¼Œæˆ‘ä»¬å»æ“ä½œä¸€æ³¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å¢åŠ ä¸€äº›æ“ä½œ</span></span><br><span class="line">   <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">4</span>,<span class="string">&quot;å°æ˜&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">       mapper.addUser(user);</span><br><span class="line">       mapper.deleteUser(<span class="number">4</span>);</span><br><span class="line">       <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ–°å¢</span></span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">       <span class="keyword">return</span> mapper.addUser(user);</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//åˆ é™¤</span></span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteUser</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">       <span class="keyword">return</span> mapper.deleteUser(id);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">   List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ¥é”™ï¼šsqlå¼‚å¸¸ï¼Œdeleteå†™é”™äº†</p><p>ç»“æœ ï¼šæ’å…¥æˆåŠŸï¼</p><p>æ²¡æœ‰è¿›è¡Œäº‹åŠ¡çš„ç®¡ç†ï¼›æˆ‘ä»¬æƒ³è®©ä»–ä»¬éƒ½æˆåŠŸæ‰æˆåŠŸï¼Œæœ‰ä¸€ä¸ªå¤±è´¥ï¼Œå°±éƒ½å¤±è´¥ï¼Œæˆ‘ä»¬å°±åº”è¯¥éœ€è¦<strong>äº‹åŠ¡ï¼</strong></p><p>ä»¥å‰æˆ‘ä»¬éƒ½éœ€è¦è‡ªå·±æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼Œååˆ†éº»çƒ¦ï¼</p><p>ä½†æ˜¯Springç»™æˆ‘ä»¬æä¾›äº†äº‹åŠ¡ç®¡ç†ï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®å³å¯ï¼›</p><h2 id="13-2-Springä¸­çš„äº‹åŠ¡ç®¡ç†"><a href="#13-2-Springä¸­çš„äº‹åŠ¡ç®¡ç†" class="headerlink" title="13.2.Springä¸­çš„äº‹åŠ¡ç®¡ç†"></a>13.2.Springä¸­çš„äº‹åŠ¡ç®¡ç†</h2><p>Springåœ¨ä¸åŒçš„äº‹åŠ¡ç®¡ç†APIä¹‹ä¸Šå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œä½¿å¾—å¼€å‘äººå‘˜ä¸å¿…äº†è§£åº•å±‚çš„äº‹åŠ¡ç®¡ç†APIå°±å¯ä»¥ä½¿ç”¨Springçš„äº‹åŠ¡ç®¡ç†æœºåˆ¶ã€‚Springæ”¯æŒç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†å’Œå£°æ˜å¼çš„äº‹åŠ¡ç®¡ç†ã€‚</p><p><strong>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†</strong></p><ul><li>å°†äº‹åŠ¡ç®¡ç†ä»£ç åµŒåˆ°ä¸šåŠ¡æ–¹æ³•ä¸­æ¥æ§åˆ¶äº‹åŠ¡çš„æäº¤å’Œå›æ»š</li><li>ç¼ºç‚¹ï¼šå¿…é¡»åœ¨æ¯ä¸ªäº‹åŠ¡æ“ä½œä¸šåŠ¡é€»è¾‘ä¸­åŒ…å«é¢å¤–çš„äº‹åŠ¡ç®¡ç†ä»£ç </li></ul><p><strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong></p><ul><li>ä¸€èˆ¬æƒ…å†µä¸‹æ¯”ç¼–ç¨‹å¼äº‹åŠ¡å¥½ç”¨ã€‚</li><li>å°†äº‹åŠ¡ç®¡ç†ä»£ç ä»ä¸šåŠ¡æ–¹æ³•ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»¥å£°æ˜çš„æ–¹å¼æ¥å®ç°äº‹åŠ¡ç®¡ç†ã€‚</li><li>å°†äº‹åŠ¡ç®¡ç†ä½œä¸ºæ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œé€šè¿‡aopæ–¹æ³•æ¨¡å—åŒ–ã€‚Springä¸­é€šè¿‡Spring AOPæ¡†æ¶æ”¯æŒå£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚</li></ul><p><strong>ä½¿ç”¨Springç®¡ç†äº‹åŠ¡ï¼Œæ³¨æ„å¤´æ–‡ä»¶çš„çº¦æŸå¯¼å…¥ : tx</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line"></span><br><span class="line">http://www.springframework.org/schema/tx</span><br><span class="line">http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>äº‹åŠ¡ç®¡ç†å™¨</strong></p><ul><li>æ— è®ºä½¿ç”¨Springçš„å“ªç§äº‹åŠ¡ç®¡ç†ç­–ç•¥ï¼ˆç¼–ç¨‹å¼æˆ–è€…å£°æ˜å¼ï¼‰äº‹åŠ¡ç®¡ç†å™¨éƒ½æ˜¯å¿…é¡»çš„ã€‚</li><li>å°±æ˜¯ Springçš„æ ¸å¿ƒäº‹åŠ¡ç®¡ç†æŠ½è±¡ï¼Œç®¡ç†å°è£…äº†ä¸€ç»„ç‹¬ç«‹äºæŠ€æœ¯çš„æ–¹æ³•ã€‚</li></ul><p><strong>JDBCäº‹åŠ¡</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span><span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®å¥½äº‹åŠ¡ç®¡ç†å™¨åæˆ‘ä»¬éœ€è¦å»é…ç½®äº‹åŠ¡çš„é€šçŸ¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡é€šçŸ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--é…ç½®å“ªäº›æ–¹æ³•ä½¿ç”¨ä»€ä¹ˆæ ·çš„äº‹åŠ¡,é…ç½®äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;search*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>springäº‹åŠ¡ä¼ æ’­ç‰¹æ€§ï¼š</strong></p><p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå°±æ˜¯å¤šä¸ªäº‹åŠ¡æ–¹æ³•ç›¸äº’è°ƒç”¨æ—¶ï¼Œäº‹åŠ¡å¦‚ä½•åœ¨è¿™äº›æ–¹æ³•é—´ä¼ æ’­ã€‚springæ”¯æŒ7ç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼š</p><ul><li>propagation_requierdï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå·²å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŠ å…¥åˆ°è¿™ä¸ªäº‹åŠ¡ä¸­ï¼Œè¿™æ˜¯æœ€å¸¸è§çš„é€‰æ‹©ã€‚</li><li>propagation_supportsï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å½“å‰äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹æ³•æ‰§è¡Œã€‚</li><li>propagation_mandatoryï¼šä½¿ç”¨å½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å½“å‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>propagation_required_newï¼šæ–°å»ºäº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼ŒæŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</li><li>propagation_not_supportedï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</li><li>propagation_neverï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>propagation_nestedï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æ‰§è¡Œä¸propagation_requiredç±»ä¼¼çš„æ“ä½œ</li></ul><p>Spring é»˜è®¤çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºæ˜¯ PROPAGATION_REQUIREDï¼Œå®ƒé€‚åˆäºç»å¤§å¤šæ•°çš„æƒ…å†µã€‚</p><p>å‡è®¾ ServiveX#methodX() éƒ½å·¥ä½œåœ¨äº‹åŠ¡ç¯å¢ƒä¸‹ï¼ˆå³éƒ½è¢« Spring äº‹åŠ¡å¢å¼ºäº†ï¼‰ï¼Œå‡è®¾ç¨‹åºä¸­å­˜åœ¨å¦‚ä¸‹çš„è°ƒç”¨é“¾ï¼šService1#method1()-&gt;Service2#method2()-&gt;Service3#method3()ï¼Œé‚£ä¹ˆè¿™ 3 ä¸ªæœåŠ¡ç±»çš„ 3 ä¸ªæ–¹æ³•é€šè¿‡ Spring çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶éƒ½å·¥ä½œåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚</p><p>å°±å¥½æ¯”ï¼Œæˆ‘ä»¬åˆšæ‰çš„å‡ ä¸ªæ–¹æ³•å­˜åœ¨è°ƒç”¨ï¼Œæ‰€ä»¥ä¼šè¢«æ”¾åœ¨ä¸€ç»„äº‹åŠ¡å½“ä¸­ï¼</p><p><strong>é…ç½®AOP</strong></p><p>å¯¼å…¥aopçš„å¤´æ–‡ä»¶ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®aopç»‡å…¥äº‹åŠ¡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;txPointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* org.example.dao.*.*(..))&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;txPointcut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è¿›è¡Œæµ‹è¯•</strong></p><p>åˆ æ‰åˆšæ‰æ’å…¥çš„æ•°æ®ï¼Œå†æ¬¡æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">   <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">   List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="13-3-æ€è€ƒé—®é¢˜ï¼Ÿ"><a href="#13-3-æ€è€ƒé—®é¢˜ï¼Ÿ" class="headerlink" title="13.3.æ€è€ƒé—®é¢˜ï¼Ÿ"></a>13.3.æ€è€ƒé—®é¢˜ï¼Ÿ</h2><p>ä¸ºä»€ä¹ˆéœ€è¦é…ç½®äº‹åŠ¡ï¼Ÿ</p><ul><li>å¦‚æœä¸é…ç½®ï¼Œå°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æäº¤æ§åˆ¶äº‹åŠ¡ï¼›</li><li>äº‹åŠ¡åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹éå¸¸é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¸å®¹é©¬è™ï¼</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RAGæ£€ç´¢ç”Ÿæˆ</title>
      <link href="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/"/>
      <url>/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<h1 id="RAGä»‹ç»"><a href="#RAGä»‹ç»" class="headerlink" title="RAGä»‹ç»"></a>RAGä»‹ç»</h1><p><strong>RAG(Retrieval Augmented Generation)</strong></p><p>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æ˜¯ä¸€ç§ç»“åˆè¯­è¨€æ¨¡å‹ä¸ä¿¡æ¯æ£€ç´¢æŠ€æœ¯çš„æŠ€æœ¯ï¼Œé€šè¿‡ä»å¤–éƒ¨çŸ¥è¯†æºæ£€ç´¢ç›¸å…³èƒŒæ™¯ä¿¡æ¯æ¥æå‡æ–‡æœ¬ç”Ÿæˆæˆ–å›ç­”é—®é¢˜çš„å‡†ç¡®æ€§å’Œè´¨é‡ã€‚</p><h2 id="1-LLMçš„ç¼ºé™·"><a href="#1-LLMçš„ç¼ºé™·" class="headerlink" title="1.LLMçš„ç¼ºé™·"></a>1.LLMçš„ç¼ºé™·</h2><p> 1.LLMçš„çŸ¥è¯†ä¸æ˜¯å®æ—¶çš„ï¼Œä¸å…·å¤‡çŸ¥è¯†æ›´æ–°<br> 2.LLMå¯èƒ½ä¸çŸ¥é“ä½ ç§æœ‰çš„é¢†åŸŸ&#x2F;ä¸šåŠ¡çŸ¥è¯†ï¼Œ<br> 3.LLMæœ‰æ—¶ä¼šåœ¨å›ç­”ä¸­ç”Ÿæˆçœ‹ä¼¼åˆç†ä½†å®é™…ä¸Šæ˜¯é”™è¯¯çš„ä¿¡æ¯ï¼Œ </p><h2 id="2-ä¸ºä»€ä¹ˆä¼šç”¨åˆ°RAG"><a href="#2-ä¸ºä»€ä¹ˆä¼šç”¨åˆ°RAG" class="headerlink" title="2.ä¸ºä»€ä¹ˆä¼šç”¨åˆ°RAG"></a>2.ä¸ºä»€ä¹ˆä¼šç”¨åˆ°RAG</h2><p>1.æé«˜å‡†ç¡®æ€§ï¼šé€šè¿‡æ£€ç´¢ç›¸å…³çš„ä¿¡æ¯ï¼ŒRAGå¯ä»¥æé«˜ç”Ÿæˆæ–‡æœ¬çš„å‡†ç¡®æ€§ã€‚<br>2.å‡å°‘è®­ç»ƒæˆæœ¬ï¼šä¸éœ€è¦å¤§é‡æ•°æ®æ¥è®­ç»ƒçš„å¤§å‹ç”Ÿæˆæ¨¡å‹ç›¸æ¯”ï¼ŒRAGå¯ä»¥é€šè¿‡æ£€ç´¢æœºåˆ¶æ¥å‡å°‘æ‰€éœ€çš„è®­ç»ƒæ•°æ®é‡ï¼Œä»è€Œé™ä½è®­å·ç»ƒæˆæœ¬ã€‚<br>3.é€‚åº”æ€§å¼ºï¼šAGæ¨¡å‹å¯ä»¥é€‚åº”æ–°çš„æˆ–ä¸æ–­å˜åŒ–çš„æ•°æ®ã€‚ç”±äºå®ƒä»¬èƒ½å¤Ÿæ£€ç´¢æœ€æ–°çš„ä¿¡æ¯ï¼Œå› æ­¤åœ¨æ–°æ•°æ®å’Œäº‹ä»¶å‡ºç°æ—¶ï¼Œå®ƒä»¬èƒ½å¤Ÿå¿«é€Ÿé€‚åº”å¹¶ç”Ÿæˆç›¸å…³çš„æ–‡æœ¬ã€‚ </p><h2 id="3-RAGæ¦‚å¿µ"><a href="#3-RAGæ¦‚å¿µ" class="headerlink" title="3.RAGæ¦‚å¿µ"></a>3.RAGæ¦‚å¿µ</h2><p>RAG(Retrieval Augmented Generation)é¡¾åæ€ä¹‰ï¼Œé€šè¿‡æ£€ç´¢å¤–éƒ¨æ•°æ®ï¼Œå¢å¼ºå¤§æ¨¡å‹çš„ç”Ÿæˆæ•ˆæœã€‚<br>RAGå³æ£€ç´¢å¢å¼ºç”Ÿæˆï¼Œä¸ºLLMæä¾›äº†ä»æŸäº›æ•°æ®æºæ£€ç´¢åˆ°çš„ä¿¡æ¯ï¼Œå¹¶åŸºäºæ­¤ä¿®æ­£ç”Ÿæˆçš„ç­”æ¡ˆã€‚RAGåŸºæœ¬ä¸Šæ˜¯Search+LLMæç¤ºï¼Œå¯ä»¥é€šè¿‡å¤§æ¨¡å‹å›ç­”æŸ¥è¯¢ï¼Œå¹¶å°†æœç´¢ç®—æ³•æ‰€æ‰¾åˆ°çš„ä¿¡æ¯ä½œä¸ºå¤§æ¨¡å‹çš„ä¸Šä¸‹æ–‡ã€‚æŸ¥è¯¢å’Œæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡éƒ½ä¼šè¢«æ³¨å…¥åˆ°å‘é€åˆ°LLMçš„æç¤ºè¯­ä¸­ã€‚</p><h2 id="4-RAG-vs-Fine-tuning"><a href="#4-RAG-vs-Fine-tuning" class="headerlink" title="4.RAG vs Fine-tuning"></a>4.RAG vs Fine-tuning</h2><ul><li>RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)æ˜¯æŠŠå†…éƒ¨çš„æ–‡æ¡£æ•°æ®å…ˆè¿›è¡Œembedding,å€ŸåŠ©æ£€ç´¢å…ˆè·å¾—å¤§è‡´çš„çŸ¥è¯†èŒƒå›´ç­”æ¡ˆï¼Œå†ç»“åˆpromptç»™åˆ°LLM,è®© LLMç”Ÿæˆæœ€ç»ˆçš„ç­”æ¡ˆ)100% </li><li>Fine-tuning(å¾®è°ƒ)æ˜¯ç”¨ä¸€å®šé‡çš„æ•°æ®é›†å¯¹LLivé€‰è¡Œå±€éƒ¨å‚æ•°çš„è°ƒæ•´ï¼Œä»¥æœŸæœ›LLMæ›´åŠ ç†è§£æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ï¼Œæœ‰æ›´å¥½çš„zero-shotèƒ½åŠ›ã€‚</li></ul><h2 id="5-RAGå·¥ä½œæµ"><a href="#5-RAGå·¥ä½œæµ" class="headerlink" title="5.RAGå·¥ä½œæµ"></a>5.RAGå·¥ä½œæµ</h2><p><a href="https://arxiv.org/pdf/2312.10997">RAGè®ºæ–‡ï¼šhttps://arxiv.org/pdf/2312.10997</a><br><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824184857883.png"><br>å¯¹åº”ä¸­æ–‡ï¼š<br><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824184952247.png"></p><h2 id="RAGç³»ç»Ÿçš„æ­å»ºæµç¨‹"><a href="#RAGç³»ç»Ÿçš„æ­å»ºæµç¨‹" class="headerlink" title="RAGç³»ç»Ÿçš„æ­å»ºæµç¨‹"></a>RAGç³»ç»Ÿçš„æ­å»ºæµç¨‹</h2><p>å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š<br><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824185357384.png"></p><ul><li><p><strong>ç´¢å¼•(Indexing)<strong>ï¼šç´¢å¼•é¦–å…ˆæ¸…ç†å’Œæå–å„ç§æ ¼å¼çš„åŸå§‹æ•°æ®ï¼Œå¦‚PDFã€HTMLã€Wordå’ŒMarkdown,ç„¶åå°†å…¶è½¬æ¢ä¸ºç»Ÿä¸€çš„çº¯æ–‡æœ¬æ ¼å¼ã€‚ä¸ºäº†é€‚åº”è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡é™åˆ¶ï¼Œæ–‡æœ¬è¢«åˆ†å‰²æˆæ›´å°çš„ã€å¯æ¶ˆåŒ–çš„å—(chuk)ã€‚</strong>ç„¶åä½¿ç”¨åµŒå…¥æ¨¡å‹å°†å—ç¼–ç æˆå‘é‡è¡¨ç¤º</strong>ï¼Œå¹¶å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ä¸­ã€‚è¿™ä¸€æ­¥å¯¹äºåœ¨éšåçš„æ£€ç´¢é˜¶æ®µå®ç°é«˜æ•ˆçš„ç›¸ä¼¼æ€§æœç´¢è‡³å…³é‡è¦ã€‚çŸ¥è¯†åº“åˆ†å‰²æˆchunks,å¹¶å°†chunkså‘é‡åŒ–è‡³å‘é‡åº“ä¸­ã€‚</p></li><li><p><strong>æ£€ç´¢(Retrieval)<strong>ï¼šåœ¨æ”¶åˆ°ç”¨æˆ·æŸ¥è¯¢(Query)åï¼ŒRAGç³»ç»Ÿé‡‡ç”¨ä¸ç´¢å¼•é˜¶æ®µ</strong>ç›¸åŒçš„ç¼–ç æ¨¡å‹</strong>å°†æŸ¥è¯¢è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œç„¶åè®¡ç®—ç´¢å¼•è¯­æ–™åº“ä¸­æŸ¥è¯¢å‘é‡ä¸å—å‘é‡çš„ç›¸ä¼¼æ€§å¾—åˆ†ã€‚è¯¥ç³»ç»Ÿä¼˜å…ˆçº§å’Œæ£€ç´¢æœ€é«˜k(Top-K)å—ï¼Œæ˜¾ç¤ºæœ€å¤§çš„ç›¸ä¼¼æ€§æŸ¥è¯¢ã€‚<br>ä¾‹å¦‚ï¼ŒäºŒç»´ç©ºé—´ä¸­çš„å‘é‡å¯ä»¥è¡¨ç¤ºä¸º(x,y),è¡¨ç¤ºä»åŸç‚¹(0,0)åˆ°ç‚¹(x,y)çš„æœ‰å‘çº¿æ®µ<br>  <img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824190947137.png"></p><ol><li>å°†æ–‡æœ¬è½¬æˆä¸€ç»„æµ®ç‚¹æ•°ï¼šæ¯ä¸ªä¸‹æ ‡â…°ï¼Œå¯¹åº”ä¸€ä¸ªç»´åº¦ </li><li>æ•´ä¸ªæ•°ç»„å¯¹åº”ä¸€ä¸ªnç»´ç©ºé—´çš„ä¸€ä¸ªç‚¹ï¼Œå³æ–‡æœ¬å‘é‡åˆå«Embeddings </li><li>å‘é‡ä¹‹é—´å¯ä»¥è®¡ç®—è·ç¦»ï¼Œè·ç¦»è¿œè¿‘å¯¹åº”è¯­ä¹‰ç›¸ä¼¼åº¦å¤§å°å·</li></ol></li></ul><p><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824191105134.png"><br>è¿™äº›å—éšåè¢«ç”¨ä½œpromptä¸­çš„æ‰©å±•ä¸Šä¸‹æ–‡ã€‚Queryå‘é‡åŒ–ï¼ŒåŒ¹é…å‘é‡ç©ºé—´ä¸­ç›¸è¿‘çš„chunksã€‚.</p><p>RAGå…·ä½“å®ç°æµç¨‹ï¼š<br>åŠ è½½æ–‡ä»¶&#x3D;&gt;è¯»å–æ–‡æœ¬&#x3D;&gt;æ–‡æœ¬åˆ†å‰²&#x3D;&gt;æ–‡æœ¬å‘é‡åŒ–&#x3D;&gt;è¾“å…¥é—®é¢˜å‘é‡åŒ–&#x3D;&gt;åœ¨æ–‡æœ¬å‘é‡ä¸­åŒ¹é…å‡ºä¸é—®é¢˜å‘é‡æœ€ç›¸ä¼¼çš„ top kä¸ª&#x3D;&gt;åŒ¹é…å‡ºçš„æ–‡æœ¬ä½œä¸ºä¸Šä¸‹æ–‡å’Œé—®é¢˜ä¸€èµ·æ·»åŠ åˆ°promptä¸­&#x3D;&gt;æäº¤ç»™LLMç”Ÿæˆå›ç­”</p><h1 id="RAGæ ¸å¿ƒ"><a href="#RAGæ ¸å¿ƒ" class="headerlink" title="RAGæ ¸å¿ƒ"></a>RAGæ ¸å¿ƒ</h1><h2 id="1-ä¼ ç»ŸVSå¤§æ¨¡å‹"><a href="#1-ä¼ ç»ŸVSå¤§æ¨¡å‹" class="headerlink" title="1.ä¼ ç»ŸVSå¤§æ¨¡å‹"></a>1.ä¼ ç»ŸVSå¤§æ¨¡å‹</h2><p>æ™ºèƒ½å®¢æœç³»ç»Ÿåœ¨æ²¡æœ‰å¤§æ¨¡å‹ä¹‹å‰æˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥è®¾è®¡å®Œæˆçš„åªæ˜¯å®ç°çš„æ•ˆæœæ²¡æœ‰å¤§æ¨¡å‹é‚£ä¹ˆå¥½ã€‚ä¸‹é¢æ˜¯ä¸¤åˆ™è®¾è®¡çš„åŸç†<br><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824191735261.png"></p><h2 id="2-å‘é‡ä¸Embeddingsçš„å®šä¹‰"><a href="#2-å‘é‡ä¸Embeddingsçš„å®šä¹‰" class="headerlink" title="2.å‘é‡ä¸Embeddingsçš„å®šä¹‰"></a>2.å‘é‡ä¸Embeddingsçš„å®šä¹‰</h2><p>åœ¨æ•°å­¦ä¸­ï¼Œå‘é‡ï¼ˆä¹Ÿç§°ä¸ºæ¬§å‡ é‡Œå¾—å‘é‡ã€å‡ ä½•å‘é‡ï¼‰ï¼ŒæŒ‡å…·æœ‰å¤§å°(magnitude)å’Œæ–¹å‘çš„é‡ã€‚å®ƒå¯ä»¥å½¢è±¡åŒ–åœ°è¡¨ç¤ºä¸ºå¸¦ç®­å¤´çš„çº¿æ®µã€‚ç®­å¤´æ‰€æŒ‡ï¼šä»£è¡¨å‘é‡çš„æ–¹å‘ï¼›çº¿æ®µé•¿åº¦ï¼šä»£è¡¨å‘é‡çš„å¤§å°ã€‚</p><p><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824192053326.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line"><span class="keyword">import</span> openai  </span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv  </span><br><span class="line">load_dotenv()  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line">  </span><br><span class="line">openai.api_key = <span class="string">&#x27;your openai api-key&#x27;</span>  </span><br><span class="line">client = OpenAI(api_key=openai.api_key)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># print(response.choices[0].text)  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_embeddings</span>(<span class="params">texts,model=<span class="string">&quot;text-embedding-3-large&quot;</span></span>):  </span><br><span class="line">    <span class="comment">#textæ˜¯ä¸ªåŒ…ç›’è¦è·å–åµŒå…¥è¡¨ç¤ºçš„æ–‡æœ¬çš„åˆ—è¡¨ï¼Œ  </span></span><br><span class="line">    <span class="comment"># modelåˆ™æ˜¯ç”¨æ¥æŒ‡å®šè¦ä½¿ç”¨çš„æ¨¡å‹çš„åç§°ç”Ÿ  </span></span><br><span class="line">    <span class="comment"># æˆæ–‡æœ¬çš„åµŒäººè¡¨ç¤ºã€‚  </span></span><br><span class="line">    <span class="comment"># ç»“æœå­˜å‚¨åœ¨dataä¸­ã€‚  </span></span><br><span class="line">    data = client.embeddings.create(<span class="built_in">input</span>=texts,model=model).data  </span><br><span class="line">    <span class="comment">#print(dataã€•  </span></span><br><span class="line">    <span class="comment"># è¿”å›äº†ä¸€ä¸ªåŒ…ç›’æ–¯æœ‰åµŒäººè¡¨ç¤ºçš„çƒˆè¡¨  </span></span><br><span class="line">    <span class="keyword">return</span> [x.embedding <span class="keyword">for</span> x <span class="keyword">in</span> data]  </span><br><span class="line">  </span><br><span class="line">test_query=[<span class="string">&quot;å¤§æ¨¡å‹&quot;</span>]  </span><br><span class="line">vec = get_embeddings(test_query)  </span><br><span class="line"><span class="comment">#â€œå¤§æ¨¡å‹â€æ–‡æœ¬åµŒå…¥è¡¨ç¤ºçš„åˆ—è¡¨ã€‚  </span></span><br><span class="line"><span class="built_in">print</span>(vec)  </span><br><span class="line"><span class="comment">#&quot;å¤§æ¨¡å‹â€æ–‡æœ¬çš„åµŒå…¥è¡¨ç¤ºã€‚  </span></span><br><span class="line"><span class="built_in">print</span>(vec[<span class="number">0</span>])  </span><br><span class="line"><span class="comment">#&quot;å¤§æ¨¡å‹â€æ–‡æœ¬çš„åµŒå…¥è¡¨ç¤ºçš„ç»´åº¦ã€‚3072  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(vec[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure><h2 id="ç›¸ä¼¼åº¦è®¡ç®—"><a href="#ç›¸ä¼¼åº¦è®¡ç®—" class="headerlink" title="ç›¸ä¼¼åº¦è®¡ç®—"></a>ç›¸ä¼¼åº¦è®¡ç®—</h2><p>è·ç¦»è¶ŠçŸ­ç›¸ä¼¼åº¦è¶Šé«˜ã€‚<br>æ¬§æ°è·ç¦»ç®—æ³•-å¯¹å°ºå¯¸æ•æ„Ÿ<br>ä½™å¼¦è·ç¦»ç®—æ³•-å¯¹æ–¹å‘æ•æ„Ÿ</p><h2 id="æ–‡æ¡£çš„åŠ è½½ä¸åˆ†éš”"><a href="#æ–‡æ¡£çš„åŠ è½½ä¸åˆ†éš”" class="headerlink" title="æ–‡æ¡£çš„åŠ è½½ä¸åˆ†éš”"></a>æ–‡æ¡£çš„åŠ è½½ä¸åˆ†éš”</h2><h3 id="åŸºäºæ–‡æ¡£çš„LLMå›å¤ç³»ç»Ÿæ­å»º"><a href="#åŸºäºæ–‡æ¡£çš„LLMå›å¤ç³»ç»Ÿæ­å»º" class="headerlink" title="åŸºäºæ–‡æ¡£çš„LLMå›å¤ç³»ç»Ÿæ­å»º"></a>åŸºäºæ–‡æ¡£çš„LLMå›å¤ç³»ç»Ÿæ­å»º</h3><p><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250824233414610.png"></p><h3 id="æŠŠæ–‡æœ¬åˆ‡åˆ†æˆchunks"><a href="#æŠŠæ–‡æœ¬åˆ‡åˆ†æˆchunks" class="headerlink" title="æŠŠæ–‡æœ¬åˆ‡åˆ†æˆchunks"></a>æŠŠæ–‡æœ¬åˆ‡åˆ†æˆchunks</h3><p>æˆ‘ä»¬æŠŠæ–‡æœ¬åˆ‡åˆ†æˆchunksçš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼š<br>1.æŒ‰ç…§å¥å­æ¥åˆ‡åˆ†<br>2.æŒ‰ç…§å­—ç¬¦æ•°æ¥åˆ‡åˆ†<br>3.æŒ‰å›ºå®šå­—ç¬¦æ•°ç»“åˆoverlapping window<br>4.é€’å½’æ–¹æ³•RecursiveCharacterTextSplitter</p><h4 id="æŒ‰ç…§å¥å­æ¥åˆ‡åˆ†"><a href="#æŒ‰ç…§å¥å­æ¥åˆ‡åˆ†" class="headerlink" title="æŒ‰ç…§å¥å­æ¥åˆ‡åˆ†"></a>æŒ‰ç…§å¥å­æ¥åˆ‡åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8  </span></span><br><span class="line"><span class="keyword">import</span> re  </span><br><span class="line">text=<span class="string">&quot;è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚&quot;</span>  </span><br><span class="line"><span class="comment">#æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä¸­æ–‡å¥å­ç»“æŸçš„æ ‡ç‚¹ç¬¦å·  </span></span><br><span class="line">sentences=re.split(<span class="string">r&#x27;(ã€‚|ï¼Ÿ|ï¼|\...\...)&#x27;</span>,text)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#é‡æ–°ç»„åˆå¥å­å’Œç»“å°¾çš„æ ‡ç‚¹ç¬¦å·  </span></span><br><span class="line">chunks = [sentence + (punctuation <span class="keyword">if</span> punctuation <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>)<span class="keyword">for</span> sentence,punctuation <span class="keyword">in</span> <span class="built_in">zip</span>(sentences[::<span class="number">2</span>],sentences[<span class="number">1</span>::<span class="number">2</span>])]  </span><br><span class="line"><span class="keyword">for</span> i,chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å—<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>:<span class="subst">&#123;chunk&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å—1:55:è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚</span><br><span class="line">å—2:21:åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</span><br><span class="line">å—3:30:åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚</span><br><span class="line">å—4:36:ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚</span><br><span class="line">å—5:33:éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚</span><br><span class="line">å—6:46:å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚</span><br><span class="line">å—7:40:LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure><h4 id="æŒ‰ç…§å›ºå®šå­—ç¬¦æ¥åˆ‡åˆ†"><a href="#æŒ‰ç…§å›ºå®šå­—ç¬¦æ¥åˆ‡åˆ†" class="headerlink" title="æŒ‰ç…§å›ºå®šå­—ç¬¦æ¥åˆ‡åˆ†"></a>æŒ‰ç…§å›ºå®šå­—ç¬¦æ¥åˆ‡åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8  </span></span><br><span class="line"><span class="keyword">import</span> re  </span><br><span class="line">text=<span class="string">&quot;è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚&quot;</span>  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_by_fixed_char_count</span>(<span class="params">text,count</span>):  </span><br><span class="line">    <span class="keyword">return</span> [text[i:i+count]<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(text),count)]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å‡è®¾æˆ‘ä»¬æŒ‰ç…§æ¯100ä¸ªå­—ç¬¦æ¥åˆ‡åˆ†æ–‡æœ¬  </span></span><br><span class="line">chunks = split_by_fixed_char_count(text,<span class="number">100</span>)  </span><br><span class="line"><span class="keyword">for</span> i,chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å—<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>:<span class="subst">&#123;chunk&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å—1:100:è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€</span><br><span class="line">å—2:100:ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†</span><br><span class="line">å—3:61:è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure><h3 id="æŒ‰ç…§å›ºå®šå­—ç¬¦-æ»‘åŠ¨çª—å£"><a href="#æŒ‰ç…§å›ºå®šå­—ç¬¦-æ»‘åŠ¨çª—å£" class="headerlink" title="æŒ‰ç…§å›ºå®šå­—ç¬¦+æ»‘åŠ¨çª—å£"></a>æŒ‰ç…§å›ºå®šå­—ç¬¦+æ»‘åŠ¨çª—å£</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8  </span></span><br><span class="line"><span class="keyword">import</span> re  </span><br><span class="line">text=<span class="string">&quot;è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sliding_window_chunks</span>(<span class="params">text,chunk_size,stride</span>):  </span><br><span class="line">    <span class="keyword">return</span> [text[i:i + chunk_size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(text),stride)]  </span><br><span class="line">  </span><br><span class="line">chunks = sliding_window_chunks(text,<span class="number">100</span>,<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å—<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>:<span class="subst">&#123;chunk&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å—1:100:è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€</span><br><span class="line">å—2:100:è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯</span><br><span class="line">å—3:100:ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†</span><br><span class="line">å—4:100:çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™º</span><br><span class="line">å—5:61:è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</span><br><span class="line">å—6:11:èƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure><h4 id="é€’å½’æ–¹æ³•"><a href="#é€’å½’æ–¹æ³•" class="headerlink" title="é€’å½’æ–¹æ³•"></a>é€’å½’æ–¹æ³•</h4><p>é€šè¿‡é€’å½’çš„æ–¹å¼å¤„ç†æˆ‘ä»¬éœ€è¦å€ŸåŠ©langchainæ¥å®ç°ã€‚æ‰€ä»¥éœ€è¦æ·»åŠ å¯¹åº”çš„æ¨¡å—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter  </span><br><span class="line"></span><br><span class="line">text=<span class="string">&quot;è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚&quot;</span> </span><br><span class="line"></span><br><span class="line">splitter=RecursiveCharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">50</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">10</span>,  </span><br><span class="line">    length_function=<span class="built_in">len</span>,  </span><br><span class="line">)  </span><br><span class="line">chunks = splitter.split_text(text)  </span><br><span class="line"><span class="keyword">for</span> i,chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å—<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>:<span class="subst">&#123;chunk&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å—1:50:è‡ªç„¶è¯­è¨€å¤„ç†(NLP),ä½œä¸ºè®¡ç®—æœºç§‘å­¦ã€äººå·¥æ™ºèƒ½ä¸è¯­è¨€å­¦çš„äº¤èä¹‹åœ°ï¼Œè‡´åŠ›äºèµ‹äºˆè®¡ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­</span><br><span class="line">å—2:50:ç®—æœºè§£æå’Œå¤„ç†äººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé¢†åŸŸï¼Œæœºå™¨å­¦ä¹ å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨å¤šæ ·çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æ</span><br><span class="line">å—3:50:çš„ç®—æ³•ï¼Œæœºå™¨å¾—ä»¥åˆ†æã€é¢†ä¼šä¹ƒè‡³åˆ›é€ æˆ‘ä»¬æ‰€ç†è§£çš„è¯­è¨€ã€‚ä»æœºå™¨ç¿»è¯‘åˆ°æƒ…æ„Ÿåˆ†æï¼Œä»è‡ªåŠ¨æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNL</span><br><span class="line">å—4:50:æ‘˜è¦åˆ°å®ä½“è¯†åˆ«ï¼ŒNLPçš„åº”ç”¨å·²éå¸ƒå„ä¸ªé¢†åŸŸã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿè¿›æ­¥ï¼ŒNLPçš„ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†</span><br><span class="line">å—5:50:ç²¾ç¡®åº¦ä¸æ•ˆèƒ½å‡å®ç°äº†å·¨å¤§é£è·ƒã€‚å¦‚ä»Šï¼Œéƒ¨åˆ†å°–ç«¯çš„NLPç³»ç»Ÿç”šè‡³èƒ½å¤Ÿå¤„ç†å¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€</span><br><span class="line">å—6:50:è§£ä»»åŠ¡ï¼Œå¦‚é—®ç­”ç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«å’Œå¯¹è¯ç³»ç»Ÿç­‰ã€‚LPçš„ç ”ç©¶æ¨è¿›ä¸ä»…ä¼˜åŒ–äº†äººæœºäº¤æµï¼Œä¹Ÿå¯¹æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™º</span><br><span class="line">å—7:21:æå‡æœºå™¨çš„è‡ªä¸»æ€§å’Œæ™ºèƒ½æ°´å¹³èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure><h2 id="å‘é‡æ£€ç´¢"><a href="#å‘é‡æ£€ç´¢" class="headerlink" title="å‘é‡æ£€ç´¢"></a>å‘é‡æ£€ç´¢</h2><p>æ£€ç´¢çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿåˆ—ä¸¾ä¸¤ç§ï¼š </p><ol><li>å…³é”®å­—æœç´¢ï¼šé€šè¿‡ç”¨æˆ·è¾“å…¥çš„å…³é”®å­—æ¥æŸ¥æ‰¾æ–‡æœ¬æ•°æ®ã€‚ </li><li>è¯­ä¹‰æœç´¢ï¼šä¸ä»…è€ƒè™‘å…³é”®è¯çš„åŒ¹é…ï¼Œè¿˜è€ƒè™‘è¯æ±‡ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼Œä»¥æä¾›æ›´å‡†ç¡®çš„æœç´¢ç»“æœã€‚</li></ol><h3 id="å…³é”®å­—æ£€ç´¢"><a href="#å…³é”®å­—æ£€ç´¢" class="headerlink" title="å…³é”®å­—æ£€ç´¢"></a>å…³é”®å­—æ£€ç´¢</h3><p>æˆ‘ä»¬éœ€è¦æŠŠç›¸å…³çš„ä¿¡æ¯å­˜å‚¨åœ¨Redisä¸­ã€‚æˆ‘ä»¬éœ€è¦å…ˆæŒ‰ç…§ä¸€ä¸ªRedisã€‚åœ¨æä¾›çš„èµ„æ–™ä¸­æœ‰ã€‚ç›´æ¥è§£å‹ç¼©ã€‚ç„¶å cmdè¿›å…¥åˆ°å¯¹åº”çš„ç›®å½•ã€‚ç„¶åè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server.exe</span><br></pre></td></tr></table></figure><p><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/file-20250825000315287.png"><br>ç„¶åéœ€è¦å®‰è£…Redisæ¨¡å—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç æŠŠæˆ‘ä»¬çš„æ•°æ®å¯¼å…¥åˆ°Redistä¸­å»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv  </span><br><span class="line"><span class="keyword">import</span> redis  </span><br><span class="line"><span class="keyword">import</span> json  </span><br><span class="line">load_dotenv()<span class="comment">#ä»æˆ‘ä»¬çš„envæ–‡ä»¶ä¸­åŠ è½½å‡ºå¯¹åº”çš„ç¯å¢ƒå˜é‡  </span></span><br><span class="line"><span class="comment"># #import os  </span></span><br><span class="line"><span class="comment"># #os.environ[&quot;http_proxy&quot;]&quot;http://127.0.0.1:1083&quot;  </span></span><br><span class="line"><span class="comment"># #os.environ[&quot;https_proxy&quot;]=&quot;http://127.0.0.1:1083&quot;  </span></span><br><span class="line">client = OpenAI()  </span><br><span class="line"><span class="comment">#è¿æ¥Redis  </span></span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯»å–æ•°æ®  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;train_zh.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="keyword">as</span> f:  </span><br><span class="line">    data = [json.loads(line)<span class="keyword">for</span> line <span class="keyword">in</span> f]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å–å‡ºé—®é¢˜å’Œè¾“å‡ºæ•°æ®  </span></span><br><span class="line">instructions = [ entry[<span class="string">&#x27;instruction&#x27;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">1000</span>]]  </span><br><span class="line">outputs = [entry[<span class="string">&#x27;output&#x27;</span>]<span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">1000</span>]]  </span><br><span class="line"><span class="comment"># print(&quot;instructions&quot;,instructions)  </span></span><br><span class="line"><span class="comment"># print(&quot;outputs&quot;,outputs)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#å°†æ•°æ®å­˜å‚¨åˆ°Redis  </span></span><br><span class="line"><span class="keyword">for</span> instruction,output <span class="keyword">in</span> <span class="built_in">zip</span>(instructions,outputs):  </span><br><span class="line">    r.<span class="built_in">set</span>(instruction,output) <span class="comment">#å­˜å…¥Redis,å€¼åºåˆ—åŒ–ä¸ºJSON  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#æœç´¢å‡½æ•°ï¼šæ ¹æ®å…³é”®å­—æœç´¢instructionä¸­åŒ…å«è¯¥å…³é”®å­—çš„æ¡ç›®  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search_instructions</span> (keyword,top_n=<span class="number">3</span>):  </span><br><span class="line">    <span class="comment">#é€šè¿‡æ¨¡ç³ŠåŒ¹é…  </span></span><br><span class="line">    keys = r.keys(pattern=<span class="string">&quot;*&quot;</span>+keyword +<span class="string">&quot;*&quot;</span> )  </span><br><span class="line">    data=[]  </span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys:  </span><br><span class="line">        data.append(r.get(key))  </span><br><span class="line">    <span class="keyword">return</span> data[:top_n]</span><br></pre></td></tr></table></figure><p>LLMæ¥å£å°è£…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line">client = OpenAI()  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_completion</span>(<span class="params">prompt,model=<span class="string">&quot;gpt-3.5-turbo&quot;</span></span>):  </span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;å°è£…openaiæ¥å£&#x27;&#x27;&#x27;</span>  </span><br><span class="line">    messages = [&#123;<span class="string">&quot;role&quot;</span>:<span class="string">&quot;user&quot;</span>,<span class="string">&quot;content&quot;</span>:prompt&#125;]  </span><br><span class="line">    response = client.chat.completions.create(  </span><br><span class="line">        model=model,  </span><br><span class="line">        messages=messages,  </span><br><span class="line">        temperature=<span class="number">0</span>,<span class="comment">#æ¨¡å‹è¾“å‡ºçš„éšæœºæ€§ï¼Œ0è¡¨ç¤ºéšæœºæ€§æœ€å°  </span></span><br><span class="line">     )  </span><br><span class="line">    <span class="keyword">return</span> response.choices[<span class="number">0</span>].message.content</span><br></pre></td></tr></table></figure><p>Promptæ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">user_query=<span class="string">&quot;ç™½ç™œé£&quot;</span>  </span><br><span class="line"><span class="comment">#ser_query=&quot;å®¶é‡Œæœ‰ç”²é†›ï¼Œæ€ä¹ˆåŠï¼Ÿ&quot;  </span></span><br><span class="line"><span class="comment">#1.æ£€ç´¢  </span></span><br><span class="line">search_results = search_instructions(user_query,<span class="number">3</span>)  </span><br><span class="line">search_results =  <span class="string">&quot;&quot;</span>.join(search_results)  </span><br><span class="line"><span class="built_in">print</span>(search_results)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#2.æ„å»ºPrompt  </span></span><br><span class="line">prompt =<span class="string">f&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">ä½ æ˜¯ä¸€ä¸ªé—®ç­”æœºå™¨äººã€‚</span></span><br><span class="line"><span class="string">ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸‹è¿°ç»™å®šçš„å·²çŸ¥ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">ç¡®ä¿ä½ çš„å›å¤å®Œå…¨ä¾æ®ä¸‹è¿°å·²çŸ¥ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string">ä¸è¦ç¼–é€ ç­”æ¡ˆã€‚å¦‚æœä¸‹è¿°å·²çŸ¥ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè¯·ç›´æ¥å›å¤&quot;æˆ‘æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜&quot;ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å·²çŸ¥ä¿¡æ¯ï¼š  </span></span><br><span class="line"><span class="string"><span class="subst">&#123;search_results&#125;</span>  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">ç”¨æˆ·é—®ï¼š  </span></span><br><span class="line"><span class="string"><span class="subst">&#123;user_query&#125;</span>  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">è¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·é—®é¢˜ã€‚  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;===Prompt===&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(prompt)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;===Prompt===&quot;</span>)  </span><br><span class="line"><span class="comment">#3.è°ƒç”¨LLM response = get_completion(prompt)   </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;===å›å¤==&quot;</span>)   </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><h3 id="å‘é‡æ•°æ®åº“"><a href="#å‘é‡æ•°æ®åº“" class="headerlink" title="å‘é‡æ•°æ®åº“"></a>å‘é‡æ•°æ®åº“</h3><p>åœ¨äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œå‘é‡æ•°æ®åº“å·²æˆä¸ºæ•°æ®ç®¡ç†å’ŒAæ¨¡å‹ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚å‘é‡æ•°æ®åº“æ˜¯ä¸€ç§ä¸“é—¨è®¾è®¡ç”¨æ¥å­˜å‚¨å’ŒæŸ¥è¯¢å‘é‡åµŒå…¥æ•°æ®çš„æ•°æ®åº“ã€‚è¿™äº›å‘é‡åµŒå…¥æ˜¯Aæ¨¡å‹ç”¨äºè¯†åˆ«æ¨¡å¼ã€å…³è”å’Œæ½œåœ¨ç»“æ„çš„å…³é”®æ•°æ®è¡¨ç¤ºã€‚</p><p>éšç€Aå’Œæœºå™¨å­¦ä¹ åº”ç”¨çš„æ™®åŠï¼Œè¿™äº›æ¨¡å‹ç”Ÿæˆçš„åµŒå…¥åŒ…å«å¤§é‡å±æ€§æˆ–ç‰¹å¾ï¼Œä½¿å¾—å®ƒä»¬çš„è¡¨ç¤ºéš¾ä»¥ç®¡ç†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ•°æ®ä»ä¸šè€…éœ€è¦ä¸€ç§ä¸“é—¨ä¸ºå¤„ç†è¿™ç§æ•°æ®è€Œå¼€å‘çš„æ•°æ®åº“ï¼Œè¿™å°±æ˜¯å‘é‡æ•°æ®åº“çš„ç”¨æ­¦ä¹‹åœ°ã€‚ </p><p><strong>Pinecone</strong><br>Pinecone:<a href="http://www.pinecone.io/">www.pinecone.io/</a><br>Pineconeçš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li>é‡å¤æ£€æµ‹ï¼šå¸®åŠ©ç”¨æˆ·è¯†åˆ«å’Œåˆ é™¤é‡å¤çš„æ•°æ®</li><li>æ’åè·Ÿè¸ªï¼šè·Ÿè¸ªæ•°æ®åœ¨æœç´¢ç»“æœä¸­çš„æ’åï¼Œæœ‰åŠ©äºä¼˜åŒ–å’Œè°ƒæ•´æœç´¢ç­–ç•¥</li><li>æ•°æ®æœç´¢ï¼šå¿«é€Ÿæœç´¢æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ”¯æŒå¤æ‚çš„æœç´¢æ¡ä»¶</li><li>åˆ†ç±»ï¼šå¯¹æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œä¾¿äºç®¡ç†å’Œæ£€ç´¢</li><li>å»é‡ï¼šè‡ªåŠ¨è¯†åˆ«å’Œåˆ é™¤é‡å¤æ•°æ®ï¼Œä¿æŒæ•°æ®é›†çš„çº¯å‡€å’Œä¸€è‡´æ€§</li></ul><p><strong>Milvus</strong><br>Milvus:milvus.io&#x2F;<br>Milvusçš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li>æ¯«ç§’çº§æœç´¢ä¸‡äº¿çº§å‘é‡æ•°æ®é›†</li><li>ç®€å•ç®¡ç†éç»“æ„åŒ–æ•°æ®</li><li>å¯é çš„å‘é‡æ•°æ®åº“ï¼Œå§‹ç»ˆå¯ç”¨</li><li>é«˜åº¦å¯æ‰©å±•å’Œé€‚åº”æ€§å¼º</li><li>æ··åˆæœç´¢</li><li>ç»Ÿä¸€çš„Lambdaç»“æ„</li><li>å—åˆ°ç¤¾åŒºæ”¯æŒï¼Œå¾—åˆ°è¡Œä¸šè®¤å¯</li></ul><p><strong>Chroma</strong><br>Chroma:<a href="http://www.trychroma.com/">www.trychroma.com/</a><br>Chromaçš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li>åŠŸèƒ½ä¸°å¯Œï¼šæ”¯æŒé¦™è¯¢ã€è¿‡æ»¤ã€å¯†åº¦ä¼°è®¡ç­‰å¤šç§åŠŸèƒ½</li><li>å³å°†æ·»åŠ çš„è¯­è¨€é“¾(LangChain)ã€Llamalndexç­‰æ›´å¤šåŠŸèƒ½</li><li>ç›¸åŒçš„APIå¯ä»¥åœ¨Pythonç¬”è®°æœ¬ä¸­è¿è¡Œï¼Œä¹Ÿå¯ä»¥æ‰©å±•åˆ°é›†ç¾¤ï¼Œç”¨äºå¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§</li></ul><p><strong>Faiss</strong><br>Faiss:<a href="https://github.com/facebookresearch/faiss">https://github.com/facebookresearch/faiss</a><br>Faissçš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li>ä¸ä»…è¿”å›æœ€è¿‘çš„é‚»å±…ï¼Œè¿˜è¿”å›ç¬¬äºŒè¿‘ã€ç¬¬ä¸‰è¿‘å’Œç¬¬kè¿‘çš„é‚»å±…</li><li>å¯ä»¥åŒæ—¶æœç´¢å¤šä¸ªå‘é‡ï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸ªå‘é‡ï¼ˆæ‰¹é‡å¤„ç†ï¼‰</li><li>ä½¿ç”¨æœ€å¤§å†…ç§¯æœç´¢è€Œä¸æ˜¯æœ€å°æ¬§å‡ é‡Œå¾—æœç´¢</li><li>ä¹Ÿæ”¯æŒå…¶ä»–è·ç¦»åº¦é‡ï¼Œä½†ç¨‹åº¦è¾ƒä½ã€‚</li><li>è¿”å›æŸ¥è¯¢ä½ç½®é™„è¿‘æŒ‡å®šåŠå¾„å†…çš„æ‰€æœ‰å…ƒç´ (èŒƒå›´æœç´¢)</li><li>å¯ä»¥å°†ç´¢å¼•å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œè€Œä¸ä»…ä»…æ˜¯RAMä¸­</li></ul><p><strong>å¦‚ä½•é€‰å‹å‘é‡æ•°æ®åº“</strong><br>åœ¨é€‰æ‹©é€‚åˆé¡¹ç›®çš„å‘é‡æ•°æ®åº“æ—¶ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®çš„å…·ä½“éœ€æ±‚ã€å›¢é˜Ÿçš„æŠ€æœ¯èƒŒæ™¯å’Œèµ„æºæƒ…å†µæ¥ç»¼åˆè¯„ä¼°ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å»ºè®®å’Œæ³¨æ„äº‹é¡¹ï¼š<br>å‘é‡åµŒå…¥çš„ç”Ÿæˆ</p><ul><li>å¦‚æœå·²ç»æœ‰äº†è‡ªå·±çš„å‘é‡åµŒå…¥ç”Ÿæˆæ¨¡å‹ï¼Œé‚£ä¹ˆéœ€è¦çš„æ˜¯ä¸€ä¸ªèƒ½å¤Ÿé«˜æ•ˆå­˜å‚¨å’ŒæŸ¥è¯¢è¿™äº›å‘é‡çš„æ•°æ®åº“</li><li>å¦‚æœéœ€è¦æ•°æ®åº“æœåŠ¡æ¥ç”Ÿæˆå‘é‡åµŒå…¥ï¼Œé‚£ä¹ˆåº”è¯¥é€‰æ‹©æä¾›è¿™ç±»åŠŸèƒ½çš„äº§å“</li></ul><p>å»¶è¿Ÿè¦æ±‚</p><ul><li>å¯¹äºéœ€è¦å®æ—¶å“åº”çš„åº”ç”¨ç¨‹åºï¼Œä½å»¶è¿Ÿæ˜¯å…³é”®ã€‚éœ€è¦é€‰æ‹©èƒ½å¤Ÿæä¾›å¿«é€ŸæŸ¥è¯¢å“åº”çš„æ•°æ®åº“</li><li>å¦‚æœåº”ç”¨ç¨‹åºå…è®¸æ‰¹é‡å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©é‚£äº›ä¼˜åŒ–äº†å¤§æ‰¹é‡æ•°æ®å¤„ç†çš„æ•°æ®åº“</li></ul><p>å¼€å‘äººå‘˜çš„ç»éªŒã€‚</p><ul><li>æ ¹æ®å›¢é˜Ÿçš„æŠ€æœ¯æ ˆå’Œç»éªŒï¼Œé€‰æ‹©ä¸€ä¸ªæ˜“äºé›†æˆå’Œä½¿ç”¨çš„æ•°æ®åº“</li><li>å¦‚æœå›¢é˜Ÿæˆå‘˜å¯¹æŸäº›æŠ€æœ¯æˆ–æ¡†æ¶æ›´ç†Ÿæ‚‰ï¼Œé‚£ä¹ˆé€‰æ‹©ä¸€ä¸ªèƒ½å¤Ÿä¸ä¹‹æ— ç¼é›†æˆçš„æ•°æ®åº“ä¼šæ›´æœ‰åˆ©</li></ul><p><strong>chromadbæ¼”ç¤º</strong><br>å®‰è£…chromadbæ¨¡å— </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install chromadb</span><br></pre></td></tr></table></figure><p>æŠŠæ•°æ®å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ï¼Œå¹¶é€šè¿‡å‘é‡æ•°æ®åº“å®Œæˆäº†æ£€ç´¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line"><span class="keyword">import</span> chromadb  </span><br><span class="line"><span class="keyword">from</span> chromadb.config <span class="keyword">import</span> settings  </span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv  </span><br><span class="line"><span class="keyword">import</span> json  </span><br><span class="line">load_dotenv()  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line">client = OpenAI()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¦æ¢æˆtext-embedding-3-large  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_embeddings</span>(<span class="params">texts,model=<span class="string">&quot;text-embedding-3-large&quot;</span></span>):  </span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;å°è£…OpenAIçš„Embeddingæ¨¡å‹æ¥å£&#x27;&#x27;&#x27;</span>  </span><br><span class="line">    data = client.embeddings.create(<span class="built_in">input</span>=texts,model=model).data  </span><br><span class="line">    <span class="keyword">return</span> [x.embedding <span class="keyword">for</span> x <span class="keyword">in</span> data]  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;train_zh.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="keyword">as</span> f:  </span><br><span class="line">    data = [json.loads(line) <span class="keyword">for</span> line <span class="keyword">in</span> f ]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># print(data[0:100])  </span></span><br><span class="line">instructions = [entry[<span class="string">&#x27;instruction&#x27;</span>]<span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">100</span>]]  </span><br><span class="line">outputs=[entry[<span class="string">&#x27;output&#x27;</span>]<span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">100</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyVectorDBConnector</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,collection_name,embedding_fn</span>):  </span><br><span class="line">        chroma_client= chromadb.Client(Settings(allow_reset=<span class="literal">True</span>))  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">#ä¸ºäº†æ¼”ç¤ºï¼Œå®é™…ä¸éœ€è¦æ¯æ¬¡reset()  </span></span><br><span class="line">        chroma_client.reset()  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">#åˆ›å»ºä¸€ä¸ªcollection  </span></span><br><span class="line">        <span class="variable language_">self</span>.collection = chroma_client.get_or_create_collection(name=collection_name)  </span><br><span class="line">        <span class="comment"># self.embedding_fn = get_embeddings  </span></span><br><span class="line">        <span class="variable language_">self</span>.embedding_fn = embedding_fn  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_documents</span>(<span class="params">self,instructions,outputs</span>):  </span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;å‘collectionä¸­æ·»åŠ æ–‡æ¡£ä¸å‘é‡&#x27;&#x27;&#x27;</span>  </span><br><span class="line">        <span class="comment">#get_embeddings(instructions)é—®é¢˜åšäº†å‘é‡åŒ–  </span></span><br><span class="line">        embeddings = <span class="variable language_">self</span>.embedding_fn(instructions)  </span><br><span class="line">        <span class="variable language_">self</span>.collection.add(  </span><br><span class="line">            embeddings=embeddings,<span class="comment">#æ¯ä¸ªæ–‡æ¡£çš„å‘é‡  </span></span><br><span class="line">            documents=outputs,<span class="comment">#æ–‡æ¡£çš„åŸæ–‡  </span></span><br><span class="line">            ids = [<span class="string">f&quot;id<span class="subst">&#123;i&#125;</span>&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(outputs))] <span class="comment">#æ¯ä¸ªæ–‡æ¡£çš„id  </span></span><br><span class="line">        )  </span><br><span class="line">            <span class="comment"># print(self.collection.count())  </span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self,query,top_n</span>):  </span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;æ£€ç´¢å‘é‡æ•°æ®åº“&#x27;&#x27;&#x27;</span>  </span><br><span class="line">        results=<span class="variable language_">self</span>.collection.query(  </span><br><span class="line">            <span class="comment"># get_embeddings([query])  </span></span><br><span class="line">            query_embeddings = <span class="variable language_">self</span>.embedding_fn([query]),  </span><br><span class="line">            n_results = top_n  </span><br><span class="line">        )  </span><br><span class="line">        <span class="keyword">return</span> results  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åˆ›å»ºä¸€ä¸ªå‘é‡æ•°æ®åº“å¯¹è±¡  </span></span><br><span class="line">vector_db = MyVectorDBConnector(<span class="string">&quot;demo&quot;</span>,get_embeddings)  </span><br><span class="line"><span class="comment">#å‘å‘é‡æ•°æ®åº“ä¸­æ·»åŠ æ–‡æ¡£  </span></span><br><span class="line">vector_db.add_documents(instructions,outputs)  </span><br><span class="line"><span class="comment">#User_query=&quot;ç™½ç™œé£&quot;  </span></span><br><span class="line">User_query=<span class="string">&quot;å¾—äº†ç™½ç™œé£æ€ä¹ˆåŠï¼Ÿ&quot;</span>  </span><br><span class="line">results = vector_db.search(user_query,<span class="number">2</span>)   </span><br><span class="line"><span class="comment"># print(results)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> para <span class="keyword">in</span> results[<span class="string">&#x27;documents&#x27;</span>][<span class="number">0</span>]:  </span><br><span class="line">    <span class="built_in">print</span>(para +<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="åŸºäºå‘é‡æ£€ç´¢çš„RAGå®ç°"><a href="#åŸºäºå‘é‡æ£€ç´¢çš„RAGå®ç°" class="headerlink" title="åŸºäºå‘é‡æ£€ç´¢çš„RAGå®ç°"></a>åŸºäºå‘é‡æ£€ç´¢çš„RAGå®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> chromadb</span><br><span class="line"><span class="keyword">from</span> chromadb.config <span class="keyword">import</span> Settings</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">client = OpenAI()</span><br><span class="line"></span><br><span class="line">prompt_template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ä½ æ˜¯ä¸€ä¸ªé—®ç­”æœºå™¨äººã€‚</span></span><br><span class="line"><span class="string">ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸‹è¿°ç»™å®šçš„å·²çŸ¥ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">ç¡®ä¿ä½ çš„å›å¤å®Œå…¨ä¾æ®ä¸‹è¿°å·²çŸ¥ä¿¡æ¯ã€‚ä¸è¦ç¼–é€ ç­”æ¡ˆã€‚</span></span><br><span class="line"><span class="string">å¦‚æœä¸‹è¿°å·²çŸ¥ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè¯·ç›´æ¥å›å¤&quot;æˆ‘æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜&quot;ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å·²çŸ¥ä¿¡æ¯:</span></span><br><span class="line"><span class="string">__INFO__</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç”¨æˆ·é—®ï¼š</span></span><br><span class="line"><span class="string">__QUERY__</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;train_zh.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = [json.loads(line) <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(data[0:100])</span></span><br><span class="line">instructions = [entry[<span class="string">&#x27;instruction&#x27;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">1000</span>]]</span><br><span class="line">outputs = [entry[<span class="string">&#x27;output&#x27;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">1000</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_completion</span>(<span class="params">prompt, model=<span class="string">&quot;gpt-4o&quot;</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;å°è£… openai æ¥å£&#x27;&#x27;&#x27;</span></span><br><span class="line">    messages = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: prompt&#125;]</span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=model,</span><br><span class="line">        messages=messages,</span><br><span class="line">        temperature=<span class="number">0</span>,  <span class="comment"># æ¨¡å‹è¾“å‡ºçš„éšæœºæ€§ï¼Œ0 è¡¨ç¤ºéšæœºæ€§æœ€å°</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> response.choices[<span class="number">0</span>].message.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_prompt</span>(<span class="params">prompt_template, **kwargs</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;å°† Prompt æ¨¡æ¿èµ‹å€¼&#x27;&#x27;&#x27;</span></span><br><span class="line">    prompt = prompt_template</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> kwargs.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(v, <span class="built_in">str</span>):</span><br><span class="line">            val = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(v, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">all</span>(<span class="built_in">isinstance</span>(elem, <span class="built_in">str</span>) <span class="keyword">for</span> elem <span class="keyword">in</span> v):</span><br><span class="line">            val = <span class="string">&#x27;\n&#x27;</span>.join(v)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            val = <span class="built_in">str</span>(v)</span><br><span class="line">        prompt = prompt.replace(<span class="string">f&quot;__<span class="subst">&#123;k.upper()&#125;</span>__&quot;</span>, val)</span><br><span class="line">    <span class="keyword">return</span> prompt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyVectorDBConnector</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, collection_name, embedding_fn</span>):</span><br><span class="line">        chroma_client = chromadb.Client(Settings(allow_reset=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä¸ºäº†æ¼”ç¤ºï¼Œå®é™…ä¸éœ€è¦æ¯æ¬¡ reset()</span></span><br><span class="line">        chroma_client.reset()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ›å»ºä¸€ä¸ª collection</span></span><br><span class="line">        <span class="variable language_">self</span>.collection = chroma_client.get_or_create_collection(name=collection_name)</span><br><span class="line">        <span class="variable language_">self</span>.embedding_fn = embedding_fn</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_documents</span>(<span class="params">self, instructions, outputs</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;å‘ collection ä¸­æ·»åŠ æ–‡æ¡£ä¸å‘é‡&#x27;&#x27;&#x27;</span></span><br><span class="line">        embeddings = <span class="variable language_">self</span>.embedding_fn(instructions)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(embeddings) != <span class="built_in">len</span>(instructions) <span class="keyword">or</span> <span class="built_in">len</span>(instructions) != <span class="built_in">len</span>(outputs):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;åµŒå…¥å‘é‡ã€instructions å’Œ outputs æ•°é‡ä¸ä¸€è‡´&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.collection.add(</span><br><span class="line">            embeddings=embeddings,  <span class="comment"># æ¯ä¸ªæ–‡æ¡£çš„å‘é‡</span></span><br><span class="line">            documents=outputs,  <span class="comment"># æ–‡æ¡£çš„åŸæ–‡</span></span><br><span class="line">            ids=[<span class="string">f&quot;id<span class="subst">&#123;i&#125;</span>&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(outputs))]  <span class="comment"># æ¯ä¸ªæ–‡æ¡£çš„ id</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self, query, top_n</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;æ£€ç´¢å‘é‡æ•°æ®åº“&#x27;&#x27;&#x27;</span></span><br><span class="line">        results = <span class="variable language_">self</span>.collection.query(</span><br><span class="line">            query_embeddings=<span class="variable language_">self</span>.embedding_fn([query]),</span><br><span class="line">            n_results=top_n</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_embeddings</span>(<span class="params">texts, model=<span class="string">&quot;text-embedding-3-large&quot;</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;å°è£… OpenAI çš„ Embedding æ¨¡å‹æ¥å£&#x27;&#x27;&#x27;</span></span><br><span class="line">    data = client.embeddings.create(<span class="built_in">input</span>=texts, model=model).data</span><br><span class="line">    <span class="keyword">return</span> [x.embedding <span class="keyword">for</span> x <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªå‘é‡æ•°æ®åº“å¯¹è±¡</span></span><br><span class="line">vector_db = MyVectorDBConnector(<span class="string">&quot;demo&quot;</span>, get_embeddings)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘å‘é‡æ•°æ®åº“ä¸­æ·»åŠ æ–‡æ¡£</span></span><br><span class="line">vector_db.add_documents(instructions, outputs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RAG_Bot</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, vector_db, llm_api, n_results=<span class="number">2</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.vector_db = vector_db</span><br><span class="line">        <span class="variable language_">self</span>.llm_api = llm_api</span><br><span class="line">        <span class="variable language_">self</span>.n_results = n_results</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">chat</span>(<span class="params">self, user_query</span>):</span><br><span class="line">        <span class="comment"># 1. æ£€ç´¢</span></span><br><span class="line">        search_results = <span class="variable language_">self</span>.vector_db.search(user_query, <span class="variable language_">self</span>.n_results)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. æ„å»º Prompt</span></span><br><span class="line">        prompt = build_prompt(</span><br><span class="line">            prompt_template, info=search_results[<span class="string">&#x27;documents&#x27;</span>][<span class="number">0</span>], query=user_query)</span><br><span class="line">        <span class="comment"># print(&quot;=&quot;*50)</span></span><br><span class="line">        <span class="comment"># print(prompt)</span></span><br><span class="line">        <span class="comment"># print(&quot;=&quot;*50)</span></span><br><span class="line">        <span class="comment"># 3. è°ƒç”¨ LLM</span></span><br><span class="line">        response = <span class="variable language_">self</span>.llm_api(prompt)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªRAGæœºå™¨äºº</span></span><br><span class="line">bot = RAG_Bot(</span><br><span class="line">    vector_db,</span><br><span class="line">    llm_api=get_completion</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">user_query = <span class="string">&quot;æ‹‰è‚šå­æ€ä¹ˆåŠï¼Ÿ&quot;</span></span><br><span class="line"></span><br><span class="line">response = bot.chat(user_query)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ç»“æœ</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨å¥½ï¼Œæ‹‰è‚šå­å¯èƒ½æ˜¯è®¸å¤šä¸åŒåŸå› å¯¼è‡´çš„ï¼Œä¾‹å¦‚é£Ÿç‰©ä¸­æ¯’ã€è‚ ç‚ã€ç—…æ¯’æ„ŸæŸ“ç­‰ã€‚å»ºè®®æ‚¨æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</span><br><span class="line">1. å¤šå–æ°´ï¼Œä¿æŒæ°´åˆ†ï¼Œé˜²æ­¢è„±æ°´ã€‚å¯ä»¥é€‰æ‹©æ¤°å­æ°´ã€æœæ±æˆ–ç›æ°´ç­‰é¥®å“ã€‚</span><br><span class="line">2. é¿å…é£Ÿç”¨ç”Ÿè‚‰ã€ç”Ÿè›‹ã€ç”Ÿæµ·é²œç­‰å®¹æ˜“æ„ŸæŸ“ç»†èŒçš„é£Ÿç‰©ã€‚</span><br><span class="line">3. é¿å…é£Ÿç”¨è¿‡å¤šçš„è¾›è¾£ã€æ²¹è…»ã€åˆºæ¿€æ€§é£Ÿç‰©ï¼Œä»¥åŠå«æœ‰å’–å•¡å› å’Œé…’ç²¾çš„é¥®æ–™ã€‚</span><br><span class="line">4. æ³¨æ„ä¸ªäººå«ç”Ÿï¼Œå‹¤æ´—æ‰‹ï¼Œé¿å…ä¸æ‚£ç—…çš„äººæ¥è§¦ã€‚</span><br><span class="line">5. ä¿æŒå……è¶³çš„ä¼‘æ¯ï¼Œæ”¾æ¾å¿ƒæƒ…ï¼Œé¿å…è¿‡åº¦åŠ³ç´¯ã€‚</span><br><span class="line">6. æ³¨æ„é¥®é£Ÿï¼Œå°‘é£Ÿå¤šé¤ï¼Œå¯ä»¥åƒäº›æ˜“æ¶ˆåŒ–ã€è¥å…»ä¸°å¯Œçš„é£Ÿç‰©ï¼Œå¦‚ç±³ç²¥ã€é¢æ¡ã€é¸¡è›‹ã€é¸¡è‚‰ç­‰ã€‚</span><br><span class="line">å¦‚æœç—‡çŠ¶ä¸¥é‡æˆ–æŒç»­åŠ é‡ï¼Œå»ºè®®æ‚¨å»åŒ»é™¢å°±è¯Šï¼Œæ¥å—åŒ»ç”Ÿçš„è¯Šæ–­å’Œæ²»ç–—ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å„å¤§å¹³å°RAGå®ç°"><a href="#ä¸‰ã€å„å¤§å¹³å°RAGå®ç°" class="headerlink" title="ä¸‰ã€å„å¤§å¹³å°RAGå®ç°"></a>ä¸‰ã€å„å¤§å¹³å°RAGå®ç°</h1><h2 id="1-é˜¿â¾¥äº‘-ç™¾ç‚¼RAG"><a href="#1-é˜¿â¾¥äº‘-ç™¾ç‚¼RAG" class="headerlink" title="1.é˜¿â¾¥äº‘-ç™¾ç‚¼RAG"></a>1.é˜¿â¾¥äº‘-ç™¾ç‚¼RAG</h2><p>åˆ›å»ºåº”â½¤-&gt;ä¸Šä¼ æ•°æ®-&gt;çŸ¥è¯†ç´¢å¼•   <a href="https://bailian.console.aliyun.com/">https://bailian.console.aliyun.com/</a></p><p><img src="/img/image-20250218165554173.png" alt="image-20250218165554173"></p><p>é€šè¿‡Pythonæ¥è°ƒç”¨ARGæœåŠ¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sk-31bb7a65dd4047aba9b14a95c08be52c</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> http <span class="keyword">import</span> HTTPStatus</span><br><span class="line"><span class="keyword">from</span> dashscope <span class="keyword">import</span> Application</span><br><span class="line">response = Application.call(</span><br><span class="line">    <span class="comment"># è‹¥æ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œå¯ç”¨ç™¾ç‚¼API Keyå°†ä¸‹è¡Œæ›¿æ¢ä¸ºï¼šapi_key=&quot;sk-xxx&quot;ã€‚ä½†ä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç›´æ¥å°†API Keyç¡¬ç¼–ç åˆ°ä»£ç ä¸­ï¼Œä»¥å‡å°‘API Keyæ³„éœ²é£é™©ã€‚</span></span><br><span class="line">    api_key=<span class="string">&quot;è¾“å…¥ä½ è‡ªèº«çš„key&quot;</span>,</span><br><span class="line">    app_id=<span class="string">&#x27;è¾“å…¥ä½ è‡ªèº«çš„appId&#x27;</span>,</span><br><span class="line">    prompt=<span class="string">&#x27;è§‚å¯Ÿè€…æ¨¡å¼çš„ä»‹ç»ï¼Ÿä½ æ˜¯åŸºäºçŸ¥è¯†åº“å›ç­”çš„è¿˜æ˜¯åŸºäºä½ è‡ªèº«æ¥å›å¤çš„ï¼Ÿ&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code != HTTPStatus.OK:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;request_id=<span class="subst">&#123;response.request_id&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;code=<span class="subst">&#123;response.status_code&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;message=<span class="subst">&#123;response.message&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;è¯·å‚è€ƒæ–‡æ¡£ï¼šhttps://help.aliyun.com/zh/model-studio/developer-reference/error-code&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(response.output.text)</span><br></pre></td></tr></table></figure><h2 id="2-æ™ºæ™®RAG"><a href="#2-æ™ºæ™®RAG" class="headerlink" title="2. æ™ºæ™®RAG"></a>2. æ™ºæ™®RAG</h2><p>åˆ›å»ºåº”â½¤-&gt;ä¸Šä¼ æ•°æ®</p><p><a href="https://www.zhipuai.cn/">https://www.zhipuai.cn/</a></p><h2 id="3-Googleçš„NoteBook"><a href="#3-Googleçš„NoteBook" class="headerlink" title="3.Googleçš„NoteBook"></a>3.Googleçš„NoteBook</h2><p><a href="https://notebooklm.google/">https://notebooklm.google/</a></p><p><img src="/2025/11/15/RAG%E6%A3%80%E7%B4%A2%E7%94%9F%E6%88%90/image-20250218201049604.png" alt="image-20250218201049604"></p><h1 id="å››ã€æœ¬åœ°å‘é‡åº“"><a href="#å››ã€æœ¬åœ°å‘é‡åº“" class="headerlink" title="å››ã€æœ¬åœ°å‘é‡åº“"></a>å››ã€æœ¬åœ°å‘é‡åº“</h1><p>â€‹å‰é¢çš„æ¡ˆä¾‹ä¸­æˆ‘ä»¬çš„å‘é‡åŒ–æ¨¡å‹ä½¿ç”¨çš„æ˜¯OpenAIæä¾›çš„<code>text-embedding-3-large</code>,é’ˆå¯¹è¿™å—æˆ‘ä»¬å¯ä»¥æœ¬åœ°è¯ä¸€ä¸ªå‘é‡æ¨¡å‹ã€‚è¿™æ ·å¤„ç†èµ·æ¥æ•ˆç‡ä¼šæ›´é«˜ä¸€äº›ã€‚</p><p><strong>å°†å‘é‡åŒ–çš„ç»“æœä¿å­˜</strong>      </p><p>â€‹        huggingfaceï¼š<a href="https://huggingface.co/models">https://huggingface.co/models</a>      </p><p>â€‹        å›½å†…çš„é•œåƒï¼š<a href="https://hf-mirror.com/">https://hf-mirror.com/</a> </p><p>ç›´æ¥ä½¿ç”¨æˆ‘ä»¬æä¾›çš„æœ¬åœ°çš„å‘é‡æ¨¡å‹ï¼Œå¹¶ä¸”æ‹·è´åˆ°é¡¹ç›®ä¸­</p><p>éœ€è¦å®‰è£…ä¸‹è¿™ä¸ªä¾èµ–</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install sentence_transformers</span><br></pre></td></tr></table></figure><p>ç„¶åå°†æ•°æ®ä¿å­˜åˆ°å‘é‡æ•°æ®åº“å¹¶ä¸”æŒä¹…åŒ–åˆ°æœ¬åœ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sentence_transformers <span class="keyword">import</span> SentenceTransformer</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> chromadb</span><br><span class="line"></span><br><span class="line">model = SentenceTransformer(<span class="string">r&#x27;maidalun1020&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;train_zh.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = [json.loads(line) <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"></span><br><span class="line">instructions = [entry[<span class="string">&#x27;instruction&#x27;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">1000</span>]]</span><br><span class="line">outputs = [entry[<span class="string">&#x27;output&#x27;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">1000</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">instruction_embeddings = model.encode(instructions, convert_to_numpy=<span class="literal">True</span>)</span><br><span class="line">np.save(<span class="string">&#x27;instruction_embeddings.npy&#x27;</span>, instruction_embeddings)</span><br><span class="line"></span><br><span class="line">client = chromadb.PersistentClient(path=<span class="string">&quot;./collection.pkl&quot;</span>)</span><br><span class="line">collection = client.create_collection(name=<span class="string">&quot;demo&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (sentence, embedding) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(instructions, instruction_embeddings)):</span><br><span class="line">    collection.add(</span><br><span class="line">        documents=[sentence],</span><br><span class="line">        embeddings=[embedding.tolist()],</span><br><span class="line">        ids=[<span class="string">f&quot;id-<span class="subst">&#123;i&#125;</span>&quot;</span>],</span><br><span class="line">        metadatas=[&#123;<span class="string">&quot;output&quot;</span>: outputs[i]&#125;]</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç»“åˆLLMæ¥å®ç°å¯¹åº”çš„RAGæ¡ˆä¾‹æ•ˆæœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> chromadb</span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> sentence_transformers <span class="keyword">import</span> SentenceTransformer</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">client_openai = OpenAI()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–çŸ¥è¯†åº“å¯¹åº”çš„å‘é‡ä¿¡æ¯</span></span><br><span class="line">instruction_embeddings = np.load(<span class="string">&#x27;instruction_embeddings.npy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½chromadb æŒä¹…åŒ–åˆ°æœ¬åœ°çš„æ•°æ®</span></span><br><span class="line">client = chromadb.PersistentClient(path=<span class="string">&quot;./collection.pkl&quot;</span>)</span><br><span class="line">collection = client.get_collection(name=<span class="string">&quot;demo&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(collection.count())</span><br><span class="line"></span><br><span class="line">model = SentenceTransformer(<span class="string">r&#x27;maidalun1020&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">retrieve_response</span>(<span class="params">query, top_k=<span class="number">5</span></span>):</span><br><span class="line">    query_embedding = model.encode([query], convert_to_numpy=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># print(query_embedding)</span></span><br><span class="line">    results = collection.query(</span><br><span class="line">        query_embeddings=query_embedding.tolist(),</span><br><span class="line">        n_results=top_k</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> [metadata[<span class="string">&#x27;output&#x27;</span>] <span class="keyword">for</span> metadata_list <span class="keyword">in</span> results[<span class="string">&#x27;metadatas&#x27;</span>] <span class="keyword">for</span> metadata <span class="keyword">in</span> metadata_list]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">prompt_template = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ä¸€ä¸ªé—®ç­”æœºå™¨äººã€‚</span></span><br><span class="line"><span class="string">ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸‹è¿°ç»™å®šçš„å·²çŸ¥ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">ç¡®ä¿ä½ çš„å›å¤å®Œå…¨ä¾æ®ä¸‹è¿°å·²çŸ¥ä¿¡æ¯ã€‚ä¸è¦ç¼–é€ ç­”æ¡ˆã€‚</span></span><br><span class="line"><span class="string">å¦‚æœä¸‹è¿°å·²çŸ¥ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè¯·ç›´æ¥å›å¤&quot;æˆ‘æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜&quot;ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å·²çŸ¥ä¿¡æ¯:</span></span><br><span class="line"><span class="string">__INFO__</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç”¨æˆ·é—®ï¼š</span></span><br><span class="line"><span class="string">__QUERY__</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_prompt</span>(<span class="params">prompt_template, **kwargs</span>):</span><br><span class="line">    prompt = prompt_template</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> kwargs.items():</span><br><span class="line">        val = v <span class="keyword">if</span> <span class="built_in">isinstance</span>(v, <span class="built_in">str</span>) <span class="keyword">else</span> <span class="string">&#x27;\n&#x27;</span>.join(v) <span class="keyword">if</span> <span class="built_in">isinstance</span>(v, <span class="built_in">list</span>) <span class="keyword">else</span> <span class="built_in">str</span>(v)</span><br><span class="line">        prompt = prompt.replace(<span class="string">f&quot;__<span class="subst">&#123;k.upper()&#125;</span>__&quot;</span>, val)</span><br><span class="line">    <span class="keyword">return</span> prompt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_completion</span>(<span class="params">prompt, model=<span class="string">&quot;gpt-4o&quot;</span></span>):</span><br><span class="line">    messages = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: prompt&#125;]</span><br><span class="line">    response = client_openai.chat.completions.create(</span><br><span class="line">        model=model,</span><br><span class="line">        messages=messages,</span><br><span class="line">        temperature=<span class="number">0</span>,</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> response.choices[<span class="number">0</span>].message.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RAG_Bot</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, llm_api, n_results=<span class="number">5</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.llm_api = llm_api</span><br><span class="line">        <span class="variable language_">self</span>.n_results = n_results</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">chat</span>(<span class="params">self, user_query</span>):</span><br><span class="line">        <span class="comment"># è·å–æ£€ç´¢çš„ä¿¡æ¯ å‘é‡åº“</span></span><br><span class="line">        search_results = retrieve_response(user_query, <span class="variable language_">self</span>.n_results)</span><br><span class="line">        <span class="comment"># æ„å»ºæç¤ºè¯</span></span><br><span class="line">        prompt = build_prompt(prompt_template, info=search_results, query=user_query)</span><br><span class="line">        <span class="built_in">print</span>(prompt)</span><br><span class="line">        <span class="comment"># è°ƒç”¨LLM é€šè¿‡å‘é‡åº“æ£€ç´¢çš„ä¿¡æ¯+ç”¨æˆ·çš„è¾“å…¥ä¿¡æ¯</span></span><br><span class="line">        response = <span class="variable language_">self</span>.llm_api(prompt)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user_query = <span class="string">&quot;å…¨èº«æ²¡åŠ²ï¼Œæ²¡ç²¾ç¥ï¼Œåƒä¸ä¸‹é¥­ï¼Œæ€ä¹ˆåŠï¼Ÿ&quot;</span></span><br><span class="line">bot = RAG_Bot(llm_api=get_completion)</span><br><span class="line">response = bot.chat(user_query)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åè·å–åˆ°å¯¹åº”çš„å“åº”ç»“æœ</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªé—®ç­”æœºå™¨äººã€‚</span><br><span class="line">ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸‹è¿°ç»™å®šçš„å·²çŸ¥ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span><br><span class="line">ç¡®ä¿ä½ çš„å›å¤å®Œå…¨ä¾æ®ä¸‹è¿°å·²çŸ¥ä¿¡æ¯ã€‚ä¸è¦ç¼–é€ ç­”æ¡ˆã€‚</span><br><span class="line">å¦‚æœä¸‹è¿°å·²çŸ¥ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè¯·ç›´æ¥å›å¤&quot;æˆ‘æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜&quot;ã€‚</span><br><span class="line">å·²çŸ¥ä¿¡æ¯:</span><br><span class="line">è¿™ç§æƒ…å†µå¯èƒ½æ˜¯çš®è‚¤è¿‡æ•æˆ–è€…è¨éº»ç–¹ï¼Œå»ºè®®æ‚¨å»åŒ»é™¢çš®è‚¤ç§‘è¿›è¡Œæ£€æŸ¥å’Œè¯Šæ–­ã€‚åœ¨ç­‰å¾…å°±åŒ»æœŸé—´ï¼Œæ‚¨å¯ä»¥å°è¯•ä»¥ä¸‹æªæ–½ç¼“è§£ç—‡çŠ¶ï¼š</span><br><span class="line">1. é¿å…æ‘©æ“¦æˆ–åˆºæ¿€çš®è‚¤ï¼Œä¸è¦ç©¿ç´§èº«è¡£ç‰©æˆ–ä½¿ç”¨è¿‡äºåˆºæ¿€æ€§çš„æ´—æ¶¤ç”¨å“ã€‚</span><br><span class="line">2. ä¿æŒçš®è‚¤æ¸…æ´ï¼Œå®šæœŸæ´—æ¾¡å¹¶ç”¨æ¸©æ°´ã€‚</span><br><span class="line">3. æ¶‚æŠ¹èˆ’ç¼“çš®è‚¤çš„ä¹³æ¶²æˆ–è¯è†ï¼Œå¦‚æ°¢åŒ–å¯çš„æ¾ä¹³è†ã€‚</span><br><span class="line">4. é¿å…æš´éœ²åœ¨è¿‡åº¦å¹²ç‡¥æˆ–è¿‡åº¦æ½®æ¹¿çš„ç¯å¢ƒä¸­ã€‚</span><br><span class="line">5. é¥®é£Ÿä¸Šé¿å…è¿‡åº¦åˆºæ¿€çš„é£Ÿç‰©ï¼Œå¦‚è¾›è¾£é£Ÿå“ã€æµ·é²œç­‰ã€‚</span><br><span class="line">è¯·æ³¨æ„ï¼Œä»¥ä¸Šæªæ–½ä»…èƒ½ç¼“è§£ç—‡çŠ¶ï¼Œå¦‚æƒ…å†µä¸¥é‡æˆ–ç—‡çŠ¶æŒç»­ï¼Œè¿˜æ˜¯éœ€è¦åŠæ—¶å°±åŒ»ã€‚</span><br><span class="line">æ ¹æ®æ‚¨çš„æè¿°ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªé¸¡çœ¼ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªè‚‰ç˜¤ï¼Œå»ºè®®æ‚¨å»åŒ»é™¢å°±è¯Šï¼Œç”±ä¸“ä¸šåŒ»ç”Ÿè¿›è¡Œè¯Šæ–­ã€‚å¦‚æœæ˜¯é¸¡çœ¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›è¯è†è½¯åŒ–é¸¡çœ¼ï¼Œå†ç”¨ä¸“ä¸šçš„å·¥å…·å»é™¤ã€‚å¦‚æœæ˜¯è‚‰ç˜¤ï¼Œéœ€è¦è¿›è¡Œæ‰‹æœ¯æ²»ç–—ã€‚åœ¨å°±è¯Šä¹‹å‰ï¼Œé¿å…ç”¨æ‰‹æŠ æŒ–æˆ–åˆ‡å‰²ï¼Œä»¥å…æ„ŸæŸ“ã€‚</span><br><span class="line">æ ¹æ®æ‚¨çš„æè¿°ï¼Œè¿™å¯èƒ½æ˜¯çš®è‚¤å—åˆ°äº†åˆ›ä¼¤æˆ–æ„ŸæŸ“ï¼Œå»ºè®®æ‚¨åœ¨ä¿æŒæ‰‹éƒ¨æ¸…æ´çš„å‰æä¸‹ï¼Œä½¿ç”¨ä¸€äº›æŠ—ç”Ÿç´ è½¯è†æ¥é¢„é˜²æ„ŸæŸ“ã€‚æ‚¨å¯ä»¥å‰å¾€è¯åº—è´­ä¹°ä¸€äº›éå¤„æ–¹è¯ï¼Œæ¯”å¦‚ç›é…¸æ°¯éœ‰ç´ è½¯è†ã€çº¢éœ‰ç´ è½¯è†ç­‰ï¼ŒæŒ‰ç…§è¯´æ˜ä½¿ç”¨å³å¯ã€‚å¦‚æœç—‡çŠ¶åŠ é‡æˆ–æŒç»­ä¸ç¼“è§£ï¼Œå»ºè®®æ‚¨åŠæ—¶å°±åŒ»ã€‚</span><br><span class="line">è¿™ç§æƒ…å†µå¯èƒ½æ˜¯å› ä¸ºæ¯›å›Šç‚æˆ–ç²‰åˆºå¼•èµ·çš„ã€‚æ¯›å›Šç‚æ˜¯æ¯›å›Šæ„ŸæŸ“æˆ–ç‚ç—‡ï¼Œé€šå¸¸ä¼šåœ¨çš®è‚¤ä¸Šå½¢æˆçº¢è‰²ä¸˜ç–¹æˆ–çº¢ç‚¹ã€‚ç²‰åˆºæ˜¯ä¸€ç§å¸¸è§çš„çš®è‚¤é—®é¢˜ï¼Œé€šå¸¸æ˜¯å› ä¸ºçš®è„‚å’Œè§’è´¨å µå¡äº†æ¯›å­”ã€‚å¦‚æœè¿™äº›æƒ…å†µä¸å¼•èµ·ç–¼ç—›æˆ–ç˜™ç—’ï¼Œé€šå¸¸ä¸éœ€è¦æ²»ç–—ï¼Œåªéœ€ä¿æŒçš®è‚¤æ¸…æ´ï¼Œé¿å…æŒ¤å‹æˆ–æ‘©æ“¦åŒºåŸŸã€‚å¦‚æœå‡ºç°ç–¼ç—›ã€å‘çƒ­ã€çº¢è‚¿ç­‰ç—‡çŠ¶ï¼Œå»ºè®®å°±åŒ»å’¨è¯¢ã€‚</span><br><span class="line">å¦‚æœæ‚¨çš„ä¸­æŒ‡é•¿äº†ä¸€ä¸ªé€æ˜çš„æ°´æ³¡çŠ¶ç‰©ï¼Œä½†ä¸ç—›ä¸ç—’ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ— å®³çš„çš®è‚¤ç—…å˜ï¼Œä¾‹å¦‚çš®è‚¤å›Šè‚¿ã€‚å›Šè‚¿é€šå¸¸æ˜¯ç”±äºçš®è‚¤ä¸‹çš„æ¯›å›Šæˆ–çš®è„‚è…ºå µå¡è€Œå½¢æˆçš„ï¼Œå¯ä»¥å‡ºç°åœ¨ä»»ä½•éƒ¨ä½ï¼ŒåŒ…æ‹¬æ‰‹æŒ‡ã€‚ </span><br><span class="line">å»ºè®®æ‚¨å»çœ‹çš®è‚¤ç§‘åŒ»ç”Ÿï¼Œè®©åŒ»ç”Ÿè¿›è¡Œè¯Šæ–­å’Œæ²»ç–—ã€‚åŒ»ç”Ÿå¯èƒ½ä¼šå»ºè®®å°†å›Šè‚¿åˆ‡å¼€å’Œæ’å‡ºå›Šå†…ç‰©è´¨ï¼Œæˆ–è€…å¼€å¤„æ–¹è¯ç‰©æ¥æ²»ç–—ã€‚</span><br><span class="line">ç”¨æˆ·é—®ï¼š</span><br><span class="line">æ‰‹è‡‚ä¸Šæœ‰å°çº¢ç‚¹ä¸ç—’ä¸è¿‡æ€æ ·å¯ä»¥å»é™¤</span><br><span class="line">è¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span><br><span class="line">è¿™ç§æƒ…å†µå¯èƒ½æ˜¯çš®è‚¤è¿‡æ•æˆ–è€…è¨éº»ç–¹ï¼Œå»ºè®®æ‚¨å»åŒ»é™¢çš®è‚¤ç§‘è¿›è¡Œæ£€æŸ¥å’Œè¯Šæ–­ã€‚åœ¨ç­‰å¾…å°±åŒ»æœŸé—´ï¼Œæ‚¨å¯ä»¥å°è¯•ä»¥ä¸‹æªæ–½ç¼“è§£ç—‡çŠ¶ï¼š</span><br><span class="line">6. é¿å…æ‘©æ“¦æˆ–åˆºæ¿€çš®è‚¤ï¼Œä¸è¦ç©¿ç´§èº«è¡£ç‰©æˆ–ä½¿ç”¨è¿‡äºåˆºæ¿€æ€§çš„æ´—æ¶¤ç”¨å“ã€‚</span><br><span class="line">7. ä¿æŒçš®è‚¤æ¸…æ´ï¼Œå®šæœŸæ´—æ¾¡å¹¶ç”¨æ¸©æ°´ã€‚</span><br><span class="line">8. æ¶‚æŠ¹èˆ’ç¼“çš®è‚¤çš„ä¹³æ¶²æˆ–è¯è†ï¼Œå¦‚æ°¢åŒ–å¯çš„æ¾ä¹³è†ã€‚</span><br><span class="line">9. é¿å…æš´éœ²åœ¨è¿‡åº¦å¹²ç‡¥æˆ–è¿‡åº¦æ½®æ¹¿çš„ç¯å¢ƒä¸­ã€‚</span><br><span class="line">10. é¥®é£Ÿä¸Šé¿å…è¿‡åº¦åˆºæ¿€çš„é£Ÿç‰©ï¼Œå¦‚è¾›è¾£é£Ÿå“ã€æµ·é²œç­‰ã€‚</span><br><span class="line">è¯·æ³¨æ„ï¼Œä»¥ä¸Šæªæ–½ä»…èƒ½ç¼“è§£ç—‡çŠ¶ï¼Œå¦‚æƒ…å†µä¸¥é‡æˆ–ç—‡çŠ¶æŒç»­ï¼Œè¿˜æ˜¯éœ€è¦åŠæ—¶å°±åŒ»ã€‚</span><br></pre></td></tr></table></figure><h1 id="äº”ã€RAGçš„ç¼ºé™·"><a href="#äº”ã€RAGçš„ç¼ºé™·" class="headerlink" title="äº”ã€RAGçš„ç¼ºé™·"></a>äº”ã€RAGçš„ç¼ºé™·</h1><p> <strong>RAGç—›ç‚¹é—®é¢˜åˆ†æè®ºæ–‡</strong>      </p><p>è®ºæ–‡:ã€ŠSeven Failure Points When Engineering a Retrieval Augmented         Generation Systemã€‹      </p><p>â€‹        åœ°å€:<a href="https://arxiv.org/pdf/2401.05856">https://arxiv.org/pdf/2401.05856</a>      </p><p>â€‹        <a href="https://www.163.com/dy/article/JFTQNA200511D3QS.html">https://www.163.com/dy/article/JFTQNA200511D3QS.html</a>      </p><h2 id="1-å…·ä½“ç—›ç‚¹é—®é¢˜æ€»ç»“"><a href="#1-å…·ä½“ç—›ç‚¹é—®é¢˜æ€»ç»“" class="headerlink" title="1. å…·ä½“ç—›ç‚¹é—®é¢˜æ€»ç»“"></a>1. å…·ä½“ç—›ç‚¹é—®é¢˜æ€»ç»“</h2><p>Index Processï¼ˆæ–‡æœ¬å‘é‡åŒ–æ„å»ºç´¢å¼•çš„è¿‡ç¨‹ï¼‰:</p><p>+ <strong>MIssing Content(å†…å®¹ç¼ºå¤±):</strong> åŸæœ¬çš„æ–‡æœ¬ä¸­å°±æ²¡æœ‰é—®é¢˜çš„ç­”æ¡ˆ<br>+ <strong>æ–‡æ¡£åŠ è½½å‡†ç¡®æ€§å’Œæ•ˆç‡ï¼š</strong> æ¯”å¦‚pdfæ–‡ä»¶çš„åŠ è½½ï¼Œå¦‚ä½•æå–å…¶ä¸­çš„æœ‰ç”¨æ–‡å­—ä¿¡æ¯å’Œå›¾ç‰‡ä¿¡æ¯ç­‰<br>+ <strong>æ–‡æ¡£åˆ‡åˆ†çš„ç²’åº¦ï¼š</strong> æ–‡æœ¬åˆ‡åˆ†çš„å¤§å°å’Œä½ç½®ä¼šå½±å“åé¢æ£€ç´¢å‡ºæ¥çš„ä¸Šä¸‹æ–‡å®Œæ•´æ€§å’Œä¸å¤§æ¨¡å‹äº¤äº’çš„tokenæ•°é‡ï¼Œæ€ä¹ˆæ§åˆ¶å¥½æ–‡æ¡£åˆ‡åˆ†çš„åº¦ï¼Œæ˜¯ä¸ªéš¾é¢˜ã€‚</p><p>Query Processï¼ˆæ£€ç´¢å¢å¼ºå›ç­”çš„è¿‡ç¨‹ä¸­ï¼‰:<br>+ <strong>Missed Top Ranked:</strong> é”™è¿‡æ’åé å‰çš„æ–‡æ¡£<br>+ <strong>Not in Context:</strong>  æå–ä¸Šä¸‹æ–‡ä¸ç­”æ¡ˆæ— å…³<br>+ <strong>Wrong Format(æ ¼å¼é”™è¯¯):</strong> ä¾‹å¦‚éœ€è¦Jsonï¼Œç»™äº†å­—ç¬¦ä¸²<br>+ <strong>Incomplete(ç­”æ¡ˆä¸å®Œæ•´):</strong> ç­”æ¡ˆåªå›ç­”äº†é—®é¢˜çš„ä¸€éƒ¨åˆ†<br>+ <strong>Not Extracted(æœªæå–åˆ°ç­”æ¡ˆ:)</strong> æå–çš„ä¸Šä¸‹æ–‡ä¸­æœ‰ç­”æ¡ˆï¼Œä½†å¤§æ¨¡å‹æ²¡æœ‰æå–å‡ºæ¥<br>+ <strong>Incorrect Specificity:</strong> ç­”æ¡ˆä¸å¤Ÿå…·ä½“æˆ–è¿‡äºå…·ä½“</p><h2 id="2-ç—›ç‚¹é—®é¢˜ç­–ç•¥åˆ†æ"><a href="#2-ç—›ç‚¹é—®é¢˜ç­–ç•¥åˆ†æ" class="headerlink" title="2. ç—›ç‚¹é—®é¢˜ç­–ç•¥åˆ†æ"></a>2. ç—›ç‚¹é—®é¢˜ç­–ç•¥åˆ†æ</h2><h3 id="2-1-æ–‡æ¡£åŠ è½½å‡†ç¡®æ€§å’Œæ•ˆç‡"><a href="#2-1-æ–‡æ¡£åŠ è½½å‡†ç¡®æ€§å’Œæ•ˆç‡" class="headerlink" title="2.1 æ–‡æ¡£åŠ è½½å‡†ç¡®æ€§å’Œæ•ˆç‡"></a>2.1 æ–‡æ¡£åŠ è½½å‡†ç¡®æ€§å’Œæ•ˆç‡</h3><p><strong>ä¼˜åŒ–æ–‡æ¡£è¯»å–å™¨</strong>  </p><p>â€‹ä¸€èˆ¬çŸ¥è¯†åº“ä¸­çš„æ–‡æ¡£æ ¼å¼éƒ½ä¸å°½ç›¸åŒï¼ŒHTMLã€PDFã€MarkDownã€TXTã€CSVç­‰ã€‚æ¯ç§æ ¼å¼æ–‡æ¡£éƒ½æœ‰å…¶éƒ½æœ‰çš„æ•°æ®ç»„ç»‡æ–¹å¼ã€‚æ€ä¹ˆåœ¨è¯»å–è¿™äº›æ•°æ®æ—¶å°†å¹²æ‰°é¡¹å»é™¤ï¼ˆå¦‚ä¸€äº›ç‰¹æ®Šç¬¦å·ç­‰ï¼‰ï¼ŒåŒæ—¶è¿˜ä¿ç•™åŸæ–‡æœ¬ä¹‹é—´çš„å…³è”å…³ç³»ï¼ˆå¦‚csvæ–‡ä»¶ä¿ç•™å…¶åŸæœ‰çš„è¡¨æ ¼ç»“æ„ï¼‰ï¼Œæ˜¯ä¸»è¦çš„ä¼˜åŒ–æ–¹å‘ã€‚</p><p>â€‹ç›®å‰é’ˆå¯¹è¿™æ–¹é¢çš„æ¢ç´¢ä¸ºï¼šé’ˆå¯¹æ¯ä¸€ç±»æ–‡æ¡£ï¼Œè®¾è®¡ä¸€ä¸ªä¸“é—¨çš„è¯»å–å™¨ã€‚å¦‚LangChainä¸­æä¾›çš„WebBaseLoaderä¸“é—¨ç”¨æ¥åŠ è½½HTMLæ–‡æœ¬ç­‰ã€‚</p><p>â€‹ç½‘å€:<a href="https://python.langchain.com/v0.1/docs/modules/data_connection/document_loaders/">https://python.langchain.com/v0.1/docs/modules/data_connection/document_loaders/</a></p><p><strong>æ•°æ®æ¸…æ´—ä¸å¢å¼º</strong></p><p>â€‹è¾“å…¥åƒåœ¾ï¼Œé‚£ä¹Ÿå¿…å®šè¾“å‡ºåƒåœ¾ã€‚å¦‚æœä½ çš„æºæ•°æ®è´¨é‡ä½åŠ£ï¼Œæ¯”å¦‚åŒ…å«äº’ç›¸å†²çªçš„ä¿¡æ¯ï¼Œé‚£ä¸ç®¡ä½ çš„ RAG å·¥ä½œæ„å»ºå¾—å¤šä¹ˆå¥½ï¼Œå®ƒéƒ½ä¸å¯èƒ½ç”¨ä½ è¾“å…¥çš„åƒåœ¾ç¥å¥‡åœ°è¾“å‡ºé«˜è´¨é‡ç»“æœã€‚è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸ä»…é€‚ç”¨äºè¿™ä¸ªç—›ç‚¹ï¼Œä»»ä½•RAGå·¥ä½œæµç¨‹æƒ³è¦è·å¾—ä¼˜è‰¯è¡¨ç°ï¼Œéƒ½å¿…é¡»å…ˆæ¸…æ´æ•°æ®ã€‚</p><h3 id="2-2-æ–‡æ¡£åˆ‡åˆ†çš„ç²’åº¦"><a href="#2-2-æ–‡æ¡£åˆ‡åˆ†çš„ç²’åº¦" class="headerlink" title="2.2 æ–‡æ¡£åˆ‡åˆ†çš„ç²’åº¦"></a>2.2 æ–‡æ¡£åˆ‡åˆ†çš„ç²’åº¦</h3><p>â€‹ç²’åº¦å¤ªå¤§å¯èƒ½å¯¼è‡´æ£€ç´¢åˆ°çš„æ–‡æœ¬åŒ…å«å¤ªå¤šä¸ç›¸å…³çš„ä¿¡æ¯ï¼Œé™ä½æ£€ç´¢å‡†ç¡®æ€§ï¼Œç²’åº¦å¤ªå°å¯èƒ½å¯¼è‡´ä¿¡æ¯ä¸å…¨é¢ï¼Œå¯¼è‡´ç­”æ¡ˆçš„ç‰‡é¢æ€§ã€‚é—®é¢˜çš„ç­”æ¡ˆå¯èƒ½è·¨è¶Šä¸¤ä¸ªç”šè‡³å¤šä¸ªç‰‡æ®µã€‚</p><p><strong>å›ºå®šé•¿åº¦çš„åˆ†å—</strong></p><p>â€‹ç›´æ¥è®¾å®šå—ä¸­çš„å­—æ•°ï¼Œæ¯ä¸ªæ–‡æœ¬å—æœ‰å¤šå°‘å­—ã€‚</p><p><strong>å†…å®¹é‡å åˆ†å—</strong></p><p>â€‹åœ¨å›ºå®šå¤§å°åˆ†å—çš„åŸºç¡€ä¸Šï¼Œä¸ºäº†ä¿æŒæ–‡æœ¬å—ä¹‹é—´è¯­ä¹‰ä¸Šä¸‹æ–‡çš„è¿è´¯æ€§ï¼Œåœ¨åˆ†å—æ—¶ï¼Œä¿æŒæ–‡æœ¬å—ä¹‹é—´æœ‰ä¸€å®šçš„å†…å®¹é‡å ã€‚</p><p><strong>åŸºäºç»“æ„çš„åˆ†å—</strong></p><p>â€‹åŸºäºç»“æ„çš„åˆ†å—æ–¹æ³•åˆ©ç”¨æ–‡æ¡£çš„å›ºæœ‰ç»“æ„ï¼Œå¦‚HTMLæˆ–Markdownä¸­çš„æ ‡é¢˜å’Œæ®µè½ï¼Œä»¥ä¿æŒå†…å®¹çš„é€»è¾‘æ€§å’Œå®Œæ•´æ€§ã€‚</p><p><strong>åŸºäºé€’å½’çš„åˆ†å—</strong></p><p>â€‹é‡å¤çš„åˆ©ç”¨åˆ†å—è§„åˆ™ä¸æ–­ç»†åˆ†æ–‡æœ¬å—ã€‚åœ¨langchainä¸­ä¼šå…ˆé€šè¿‡æ®µè½æ¢è¡Œç¬¦ï¼ˆ\n\nï¼‰è¿›è¡Œåˆ†å‰²ã€‚ç„¶åï¼Œæ£€æŸ¥è¿™äº›å—çš„å¤§å°ã€‚å¦‚æœå¤§å°ä¸è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œåˆ™è¯¥å—è¢«ä¿ç•™ã€‚å¯¹äºå¤§å°è¶…è¿‡æ ‡å‡†çš„å—ï¼Œä½¿ç”¨å•æ¢è¡Œç¬¦ï¼ˆ\nï¼‰å†æ¬¡åˆ†å‰²ã€‚ä»¥æ­¤ç±»æ¨ï¼Œä¸æ–­æ ¹æ®å—å¤§å°æ›´æ–°æ›´å°çš„åˆ†å—è§„åˆ™ï¼ˆå¦‚ç©ºæ ¼ï¼Œå¥å·ï¼‰ã€‚</p><p><strong>åˆ†å—å¤§å°çš„é€‰æ‹©</strong></p><p>ï¼ˆ1ï¼‰ä¸åŒçš„åµŒå…¥æ¨¡å‹æœ‰å…¶æœ€ä½³è¾“å…¥å¤§å°ã€‚æ¯”å¦‚Openaiçš„text-embedding-ada-002çš„æ¨¡å‹åœ¨256 æˆ– 512å¤§å°çš„å—ä¸Šæ•ˆæœæ›´å¥½ã€‚</p><p>ï¼ˆ2ï¼‰æ–‡æ¡£çš„ç±»å‹å’Œç”¨æˆ·æŸ¥è¯¢çš„é•¿åº¦åŠå¤æ‚æ€§ä¹Ÿæ˜¯å†³å®šåˆ†å—å¤§å°çš„é‡è¦å› ç´ ã€‚å¤„ç†é•¿ç¯‡æ–‡ç« æˆ–ä¹¦ç±æ—¶ï¼Œè¾ƒå¤§çš„åˆ†å—æœ‰åŠ©äºä¿ç•™æ›´å¤šçš„ä¸Šä¸‹æ–‡å’Œä¸»é¢˜è¿è´¯æ€§ï¼›è€Œå¯¹äºç¤¾äº¤åª’ä½“å¸–å­ï¼Œè¾ƒå°çš„åˆ†å—å¯èƒ½æ›´é€‚åˆæ•æ‰æ¯ä¸ªå¸–å­çš„ç²¾ç¡®è¯­ä¹‰ã€‚å¦‚æœç”¨æˆ·çš„æŸ¥è¯¢é€šå¸¸æ˜¯ç®€çŸ­å’Œå…·ä½“çš„ï¼Œè¾ƒå°çš„åˆ†å—å¯èƒ½æ›´ä¸ºåˆé€‚ï¼›ç›¸åï¼Œå¦‚æœæŸ¥è¯¢è¾ƒä¸ºå¤æ‚ï¼Œå¯èƒ½éœ€è¦æ›´å¤§çš„åˆ†å—ã€‚</p><h3 id="2-3-å†…å®¹ç¼ºå¤±"><a href="#2-3-å†…å®¹ç¼ºå¤±" class="headerlink" title="2.3 å†…å®¹ç¼ºå¤±"></a>2.3 å†…å®¹ç¼ºå¤±</h3><p>â€‹å‡†å¤‡çš„å¤–æŒ‚æ–‡æœ¬ä¸­æ²¡æœ‰å›ç­”é—®é¢˜æ‰€éœ€çš„çŸ¥è¯†ã€‚è¿™æ—¶å€™ï¼ŒRAGå¯èƒ½ä¼šæä¾›ä¸€ä¸ªè‡ªå·±ç¼–é€ çš„ç­”æ¡ˆã€‚</p><p><strong>å¢åŠ ç›¸åº”çŸ¥è¯†åº“</strong></p><p>â€‹å°†ç›¸åº”çš„çŸ¥è¯†æ–‡æœ¬åŠ å…¥åˆ°å‘é‡çŸ¥è¯†åº“ä¸­ã€‚</p><p><strong>æ•°æ®æ¸…æ´—ä¸å¢å¼º</strong></p><p>â€‹è¾“å…¥åƒåœ¾ï¼Œé‚£ä¹Ÿå¿…å®šè¾“å‡ºåƒåœ¾ã€‚å¦‚æœä½ çš„æºæ•°æ®è´¨é‡ä½åŠ£ï¼Œæ¯”å¦‚åŒ…å«äº’ç›¸å†²çªçš„ä¿¡æ¯ï¼Œé‚£ä¸ç®¡ä½ çš„ RAG å·¥ä½œæ„å»ºå¾—å¤šä¹ˆå¥½ï¼Œå®ƒéƒ½ä¸å¯èƒ½ç”¨ä½ è¾“å…¥çš„åƒåœ¾ç¥å¥‡åœ°è¾“å‡ºé«˜è´¨é‡ç»“æœã€‚è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸ä»…é€‚ç”¨äºè¿™ä¸ªç—›ç‚¹ï¼Œä»»ä½•RAGå·¥ä½œæµç¨‹æƒ³è¦è·å¾—ä¼˜è‰¯è¡¨ç°ï¼Œéƒ½å¿…é¡»å…ˆæ¸…æ´æ•°æ®ã€‚</p><p><strong>æ›´å¥½çš„Promptè®¾è®¡</strong></p><p>â€‹é€šè¿‡Promptsï¼Œè®©å¤§æ¨¡å‹åœ¨æ‰¾ä¸åˆ°ç­”æ¡ˆçš„æƒ…å†µä¸‹ï¼Œè¾“å‡ºâ€œæ ¹æ®å½“å‰çŸ¥è¯†åº“ï¼Œæ— æ³•å›ç­”è¯¥é—®é¢˜â€ç­‰æç¤ºã€‚è¿™æ ·çš„æç¤ºï¼Œå°±èƒ½é¼“åŠ±æ¨¡å‹æ‰¿è®¤è‡ªå·±çš„å±€é™ï¼Œå¹¶æ›´é€æ˜åœ°å‘ç”¨æˆ·ä¼ è¾¾å®ƒçš„ä¸ç¡®å®šã€‚è™½ç„¶ä¸èƒ½ä¿è¯ 100% å‡†ç¡®åº¦ï¼Œä½†åœ¨æ¸…æ´æ•°æ®ä¹‹åï¼Œç²¾å¿ƒè®¾è®¡ prompt æ˜¯æœ€å¥½çš„åšæ³•ä¹‹ä¸€ã€‚</p><h3 id="2-4-é”™è¿‡æ’åé å‰çš„æ–‡æ¡£"><a href="#2-4-é”™è¿‡æ’åé å‰çš„æ–‡æ¡£" class="headerlink" title="2.4 é”™è¿‡æ’åé å‰çš„æ–‡æ¡£"></a>2.4 é”™è¿‡æ’åé å‰çš„æ–‡æ¡£</h3><p>â€‹å¤–æŒ‚çŸ¥è¯†åº“ä¸­å­˜åœ¨å›ç­”é—®é¢˜æ‰€éœ€çš„çŸ¥è¯†ï¼Œä½†æ˜¯å¯èƒ½è¿™ä¸ªçŸ¥è¯†å—ä¸é—®é¢˜çš„å‘é‡ç›¸ä¼¼åº¦æ’åå¹¶ä¸æ˜¯é å‰çš„ï¼Œå¯¼è‡´æ— æ³•å¬å›è¯¥çŸ¥è¯†å—ä¼ ç»™å¤§æ¨¡å‹ï¼Œå¯¼è‡´å¤§æ¨¡å‹å§‹ç»ˆæ— æ³•å¾—åˆ°æ­£ç¡®çš„ç­”æ¡ˆ.</p><p><strong>å¢åŠ å¬å›æ•°é‡</strong></p><p>â€‹å¢åŠ å¬å›çš„ topK æ•°é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¾‹å¦‚åŸæ¥å¬å›å‰3ä¸ªçŸ¥è¯†å—ï¼Œä¿®æ”¹ä¸ºå¬å›å‰5ä¸ªçŸ¥è¯†å—ã€‚ä¸æ¨èæ­¤ç§æ–¹æ³•ï¼Œå› ä¸ºçŸ¥è¯†å—å¤šäº†ï¼Œä¸å…‰ä¼šå¢åŠ tokenæ¶ˆè€—ï¼Œä¹Ÿä¼šå¢åŠ å¤§æ¨¡å‹å›ç­”é—®é¢˜çš„å¹²æ‰°ã€‚</p><p><strong>é‡æ’ï¼ˆRerankingï¼‰</strong></p><p>â€‹è¯¥æ–¹æ³•çš„æ­¥éª¤æ˜¯ï¼Œé¦–å…ˆæ£€ç´¢å‡º topN ä¸ªçŸ¥è¯†å—ï¼ˆN &gt; Kï¼Œè¿‡å¬å›ï¼‰ï¼Œç„¶åå†å¯¹è¿™ topN ä¸ªçŸ¥è¯†å—è¿›è¡Œé‡æ’åºï¼Œå–é‡æ’åºåçš„ K ä¸ªçŸ¥è¯†å—å½“ä½œä¸Šä¸‹æ–‡ã€‚é‡æ’æ˜¯åˆ©ç”¨å¦ä¸€ä¸ªæ’åºæ¨¡å‹æˆ–æ’åºç­–ç•¥ï¼Œå¯¹çŸ¥è¯†å—å’Œé—®é¢˜ä¹‹é—´è¿›è¡Œå…³ç³»è®¡ç®—ä¸æ’åºã€‚</p><h3 id="2-5-æå–ä¸Šä¸‹æ–‡ä¸ç­”æ¡ˆæ— å…³"><a href="#2-5-æå–ä¸Šä¸‹æ–‡ä¸ç­”æ¡ˆæ— å…³" class="headerlink" title="2.5 æå–ä¸Šä¸‹æ–‡ä¸ç­”æ¡ˆæ— å…³"></a>2.5 æå–ä¸Šä¸‹æ–‡ä¸ç­”æ¡ˆæ— å…³</h3><p><strong>å†…å®¹ç¼ºå¤±</strong> æˆ– <strong>é”™è¿‡æ’åé å‰çš„æ–‡æ¡£</strong> çš„å…·ä½“ä½“ç°</p><h3 id="2-6-æ ¼å¼é”™è¯¯"><a href="#2-6-æ ¼å¼é”™è¯¯" class="headerlink" title="2.6 æ ¼å¼é”™è¯¯"></a>2.6 æ ¼å¼é”™è¯¯</h3><p><strong>Promptè°ƒä¼˜</strong></p><p>â€‹ä¼˜åŒ–Prompté€æ¸è®©å¤§æ¨¡å‹è¿”å›æ­£ç¡®çš„æ ¼å¼ã€‚</p><h3 id="2-7-ç­”æ¡ˆä¸å®Œæ•´"><a href="#2-7-ç­”æ¡ˆä¸å®Œæ•´" class="headerlink" title="2.7 ç­”æ¡ˆä¸å®Œæ•´"></a>2.7 ç­”æ¡ˆä¸å®Œæ•´</h3><p>å°†é—®é¢˜åˆ†å¼€æé—®:ä¸€æ–¹é¢å¼•å¯¼ç”¨æˆ·ç²¾ç®€é—®é¢˜ï¼Œä¸€æ¬¡åªæé—®ä¸€ä¸ªé—®é¢˜ã€‚ å¦ä¸€æ–¹é¢ï¼Œé’ˆå¯¹ç”¨æˆ·çš„é—®é¢˜è¿›è¡Œå†…éƒ¨æ‹†åˆ†å¤„ç†ï¼Œæ‹†åˆ†æˆæ•°ä¸ªå­é—®é¢˜ï¼Œç­‰å­é—®é¢˜ç­”æ¡ˆéƒ½æ‰¾åˆ°åï¼Œå†æ€»ç»“èµ·æ¥å›å¤ç»™ç”¨æˆ·</p><h3 id="2-8-æœªæå–åˆ°ç­”æ¡ˆ"><a href="#2-8-æœªæå–åˆ°ç­”æ¡ˆ" class="headerlink" title="2.8 æœªæå–åˆ°ç­”æ¡ˆ"></a>2.8 æœªæå–åˆ°ç­”æ¡ˆ</h3><p>æç¤ºå‹ç¼©æŠ€æœ¯: ç½‘å€:<a href="https://mp.weixin.qq.com/s/61LZgc1a5yRP2J7MTIVZ4Q">https://mp.weixin.qq.com/s/61LZgc1a5yRP2J7MTIVZ4Q</a></p><h2 id="3-RAGè¯„ä¼°"><a href="#3-RAGè¯„ä¼°" class="headerlink" title="3. RAGè¯„ä¼°"></a>3. RAGè¯„ä¼°</h2><h3 id="3-1-RAGæ•ˆæœè¯„ä¼°çš„å¿…è¦æ€§"><a href="#3-1-RAGæ•ˆæœè¯„ä¼°çš„å¿…è¦æ€§" class="headerlink" title="3.1 RAGæ•ˆæœè¯„ä¼°çš„å¿…è¦æ€§"></a>3.1 RAGæ•ˆæœè¯„ä¼°çš„å¿…è¦æ€§</h3><ul><li>è¯„ä¼°å‡ºRAGå¯¹å¤§æ¨¡å‹èƒ½åŠ›æ”¹å–„çš„ç¨‹åº¦</li><li>RAGä¼˜åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡è¯„ä¼°å¯ä»¥çŸ¥é“æ”¹å–„çš„æ–¹å‘å’Œå‚æ•°è°ƒæ•´çš„ç¨‹åº¦</li></ul><h3 id="3-2-RAGè¯„ä¼°æ–¹æ³•"><a href="#3-2-RAGè¯„ä¼°æ–¹æ³•" class="headerlink" title="3.2 RAGè¯„ä¼°æ–¹æ³•"></a>3.2 RAGè¯„ä¼°æ–¹æ³•</h3><p><strong>äººå·¥è¯„ä¼°</strong></p><p>â€‹æœ€Lowçš„æ–¹å¼æ˜¯è¿›è¡Œäººå·¥è¯„ä¼°ï¼šé‚€è¯·ä¸“å®¶æˆ–äººå·¥è¯„ä¼°å‘˜å¯¹RAGç”Ÿæˆçš„ç»“æœè¿›è¡Œè¯„ä¼°ã€‚ä»–ä»¬å¯ä»¥æ ¹æ®é¢„å…ˆå®šä¹‰çš„æ ‡å‡†å¯¹ç”Ÿæˆçš„ç­”æ¡ˆè¿›è¡Œè´¨é‡è¯„ä¼°ï¼Œå¦‚å‡†ç¡®æ€§ã€è¿è´¯æ€§ã€ç›¸å…³æ€§ç­‰ã€‚è¿™ç§è¯„ä¼°æ–¹æ³•å¯ä»¥æä¾›é«˜è´¨é‡çš„åé¦ˆï¼Œä½†å¯èƒ½ä¼šæ¶ˆè€—å¤§é‡çš„æ—¶é—´å’ŒäººåŠ›èµ„æºã€‚</p><p><strong>è‡ªåŠ¨åŒ–è¯„ä¼°</strong></p><p>â€‹è‡ªåŠ¨åŒ–è¯„ä¼°è‚¯å®šæ˜¯RAGè¯„ä¼°çš„ä¸»æµå’Œå‘å±•æ–¹å‘ã€‚</p><p><strong>LangSmith</strong></p><p>éœ€è¦å‡†å¤‡æµ‹è¯•æ•°æ®é›†<br>ä¸ä»…å¯ä»¥è¯„ä¼°RAGæ•ˆæœï¼Œå¯¹äºLangChainä¸­çš„Promptæ¨¡æ¿ç­‰æ­¥éª¤éƒ½å¯è¿›è¡Œæµ‹è¯•è¯„ä¼°ã€‚</p><p><strong>RAGAS</strong></p><p>â€‹RAGAsï¼ˆRetrieval-Augmented Generation Assessmentï¼‰æ˜¯ä¸€ä¸ªè¯„ä¼°æ¡†æ¶ï¼Œæ–‡æ¡£ã€‚è€ƒè™‘æ£€ç´¢ç³»ç»Ÿè¯†åˆ«ç›¸å…³å’Œé‡ç‚¹ä¸Šä¸‹æ–‡æ®µè½çš„èƒ½åŠ›ï¼ŒLLM ä»¥å¿ å®æ–¹å¼åˆ©ç”¨è¿™äº›æ®µè½çš„èƒ½åŠ›ï¼Œä»¥åŠç”Ÿæˆæœ¬èº«çš„è´¨é‡ã€‚</p><p>æ•°æ®é›†æ ¼å¼</p><ul><li>questionï¼šä½œä¸º RAG ç®¡é“è¾“å…¥çš„ç”¨æˆ·æŸ¥è¯¢ã€‚è¾“å…¥ã€‚</li><li>answerï¼šä» RAG ç®¡é“ç”Ÿæˆçš„ç­”æ¡ˆã€‚è¾“å‡ºã€‚</li><li>contextsï¼šä»ç”¨äºå›ç­”questionå¤–éƒ¨çŸ¥è¯†æºä¸­æ£€ç´¢çš„ä¸Šä¸‹æ–‡ã€‚</li><li>ground_truthsï¼šquestionçš„åŸºæœ¬äº‹å®ç­”æ¡ˆã€‚è¿™æ˜¯å”¯ä¸€äººå·¥æ³¨é‡Šçš„ä¿¡æ¯ã€‚</li></ul><h3 id="3-3-è¯„ä¼°æŒ‡æ ‡"><a href="#3-3-è¯„ä¼°æŒ‡æ ‡" class="headerlink" title="3.3 è¯„ä¼°æŒ‡æ ‡"></a>3.3 è¯„ä¼°æŒ‡æ ‡</h3><p>è¯„ä¼°æ£€ç´¢è´¨é‡:</p><ul><li>context_relevancyï¼ˆä¸Šä¸‹æ–‡ç›¸å…³æ€§ï¼Œä¹Ÿå« context_precisionï¼‰</li><li>context_recallï¼ˆå¬å›æ€§ï¼Œè¶Šé«˜è¡¨ç¤ºæ£€ç´¢å‡ºæ¥çš„å†…å®¹ä¸æ­£ç¡®ç­”æ¡ˆè¶Šç›¸å…³ï¼‰</li></ul><p>è¯„ä¼°ç”Ÿæˆè´¨é‡ï¼š</p><ul><li>faithfulnessï¼ˆå¿ å®æ€§ï¼Œè¶Šé«˜è¡¨ç¤ºç­”æ¡ˆçš„ç”Ÿæˆä½¿ç”¨äº†è¶Šå¤šçš„å‚è€ƒæ–‡æ¡£ï¼ˆæ£€ç´¢å‡ºæ¥çš„å†…å®¹ï¼‰ï¼‰</li><li>answer_relevancyï¼ˆç­”æ¡ˆçš„ç›¸å…³æ€§ï¼‰</li></ul><p>Context Recallï¼šä¸Šä¸‹æ–‡å¬å›è¡¡é‡æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡(contexts)ä¸æ ‡å‡†ç­”æ¡ˆï¼ˆground_truthsï¼‰çš„åŒ¹é…ç¨‹åº¦ã€‚      </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datasets <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">from</span> ragas.metrics <span class="keyword">import</span> context_precision, context_recall, faithfulness, answer_relevancy</span><br><span class="line"><span class="keyword">from</span> ragas <span class="keyword">import</span> evaluate</span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data_samples = &#123;</span><br><span class="line">    <span class="string">&#x27;question&#x27;</span>: [<span class="string">&#x27;When was the first super bowl?&#x27;</span>, <span class="string">&#x27;Who won the most super bowls?&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;answer&#x27;</span>: [<span class="string">&#x27;The first superbowl was held on Jan 15, 1967&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;The most super bowls have been won by The New England Patriots&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;contexts&#x27;</span>: [</span><br><span class="line">        [<span class="string">&#x27;The First AFLâ€“NFL World Championship Game was an American football game played on January 15, 1967, at the Los Angeles Memorial Coliseum in Los Angeles,&#x27;</span>],</span><br><span class="line">        [<span class="string">&#x27;The Green Bay Packers...Green Bay, Wisconsin.&#x27;</span>, <span class="string">&#x27;The Packers compete...Football Conference&#x27;</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;ground_truth&#x27;</span>: [<span class="string">&#x27;The first superbowl was held on January 15, 1967&#x27;</span>,</span><br><span class="line">                     <span class="string">&#x27;The New England Patriots have won the Super Bowl a record six times&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line">dataset = Dataset.from_dict(data_samples)</span><br><span class="line"><span class="comment"># ä¸Šä¸‹æ–‡ç²¾ç¡®åº¦  è¯„ä¼°æ˜¯å¦æ‰€æœ‰å’Œground_truthsï¼ˆçœŸå®ç­”æ¡ˆï¼‰ç›¸å…³çš„chunkè¢«æ£€ç´¢åˆ°è€Œä¸”æ’åå¾ˆé å‰</span></span><br><span class="line">context_precision_score = evaluate(dataset, metrics=[context_precision])</span><br><span class="line"><span class="comment"># è®¡ç®—ä¸Šä¸‹æ–‡å¬å›ç‡  ä¸Šä¸‹æ–‡å¬å›è¡¡é‡æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡(contexts)ä¸æ ‡å‡†ç­”æ¡ˆï¼ˆground_truthsï¼‰çš„åŒ¹é…ç¨‹åº¦</span></span><br><span class="line">context_recall_score = evaluate(dataset, metrics=[context_recall])</span><br><span class="line"><span class="comment"># å¿ å®åº¦  è¿™ä¸ªæŒ‡æ ‡è¡¡é‡ç”Ÿæˆç­”æ¡ˆä¸ç»™å®šä¸Šä¸‹æ–‡ä¹‹é—´çš„äº‹å®ä¸€è‡´æ€§</span></span><br><span class="line">faithfulness_score = evaluate(dataset, metrics=[faithfulness])</span><br><span class="line"><span class="comment"># ç­”æ¡ˆç›¸å…³æ€§  ä¾§é‡äºè¯„ä¼°ç”Ÿæˆçš„ç­”æ¡ˆä¸ç»™å®šæç¤ºçš„ç›¸å…³æ€§ã€‚</span></span><br><span class="line">answer_relevancy_score = evaluate(dataset, metrics=[answer_relevancy])</span><br><span class="line"><span class="built_in">print</span>(context_precision_score.to_pandas())</span><br><span class="line"><span class="built_in">print</span>(context_recall_score.to_pandas())</span><br><span class="line"><span class="built_in">print</span>(faithfulness_score.to_pandas())</span><br><span class="line"><span class="built_in">print</span>(answer_relevancy_score.to_pandas())</span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ç­”æ¡ˆ</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Python 3.9.13 (tags/v3.9.13:6de2ca5, May 17 2022, 16:36:42) [MSC v.1929 64 bit (AMD64)]</span><br><span class="line">Type &#x27;copyright&#x27;, &#x27;credits&#x27; or &#x27;license&#x27; for more information</span><br><span class="line">IPython 8.18.1 -- An enhanced Interactive Python. Type &#x27;?&#x27; for help.</span><br><span class="line">PyDev console: using IPython 8.18.1</span><br><span class="line">Python 3.9.13 (tags/v3.9.13:6de2ca5, May 17 2022, 16:36:42) [MSC v.1929 64 bit (AMD64)] on win32</span><br><span class="line">runfile(&#x27;E:\\PythonWorkSpace\\LLMProject\\demo4.py&#x27;, wdir=&#x27;E:\\PythonWorkSpace\\LLMProject&#x27;)</span><br><span class="line">Evaluating: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:05&lt;00:00,  2.74s/it]</span><br><span class="line">Evaluating: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:03&lt;00:00,  1.76s/it]</span><br><span class="line">Evaluating: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:07&lt;00:00,  3.55s/it]</span><br><span class="line">Evaluating: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:36&lt;00:00, 18.45s/it]</span><br><span class="line">                       user_input  ... context_precision</span><br><span class="line">0  When was the first super bowl?  ...               1.0</span><br><span class="line">1   Who won the most super bowls?  ...               0.0</span><br><span class="line">[2 rows x 5 columns]</span><br><span class="line">                       user_input  ... context_recall</span><br><span class="line">0  When was the first super bowl?  ...            1.0</span><br><span class="line">1   Who won the most super bowls?  ...            0.0</span><br><span class="line">[2 rows x 5 columns]</span><br><span class="line">                       user_input  ... faithfulness</span><br><span class="line">0  When was the first super bowl?  ...          1.0</span><br><span class="line">1   Who won the most super bowls?  ...          0.0</span><br><span class="line">[2 rows x 5 columns]</span><br><span class="line">                       user_input  ... answer_relevancy</span><br><span class="line">0  When was the first super bowl?  ...         0.980736</span><br><span class="line">1   Who won the most super bowls?  ...         0.943014</span><br><span class="line">[2 rows x 5 columns]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·</title>
      <link href="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
      <url>/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<p>ç¬”è®°ä¸ºç¡…è°·æ¬è¿å·¥</p><h1 id="Mavenç®€ä»‹"><a href="#Mavenç®€ä»‹" class="headerlink" title="Mavenç®€ä»‹"></a>Mavenç®€ä»‹</h1><h2 id="ä¸ºä»€ä¹ˆå­¦ä¹ Maven"><a href="#ä¸ºä»€ä¹ˆå­¦ä¹ Maven" class="headerlink" title="ä¸ºä»€ä¹ˆå­¦ä¹ Maven"></a>ä¸ºä»€ä¹ˆå­¦ä¹ Maven</h2><h3 id="Mavenæ˜¯ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·"><a href="#Mavenæ˜¯ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·" class="headerlink" title="Mavenæ˜¯ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·"></a>Mavenæ˜¯ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·</h3><p>â‘ jar åŒ…çš„è§„æ¨¡</p><p>éšç€æˆ‘ä»¬ä½¿ç”¨è¶Šæ¥è¶Šå¤šçš„æ¡†æ¶ï¼Œæˆ–è€…æ¡†æ¶å°è£…ç¨‹åº¦è¶Šæ¥è¶Šé«˜ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨çš„jaråŒ…ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚é¡¹ç›®ä¸­ï¼Œä¸€ä¸ªæ¨¡å—é‡Œé¢ç”¨åˆ°ä¸Šç™¾ä¸ªjaråŒ…æ˜¯éå¸¸æ­£å¸¸çš„ã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬åªç”¨åˆ° SpringBootã€SpringCloud æ¡†æ¶ä¸­çš„ä¸‰ä¸ªåŠŸèƒ½ï¼š</p><ul><li>Nacos æœåŠ¡æ³¨å†Œå‘ç°</li><li>Web æ¡†æ¶ç¯å¢ƒ</li><li>è§†å›¾æ¨¡æ¿æŠ€æœ¯ Thymeleaf</li></ul><p>æœ€ç»ˆå´å¯¼å…¥äº† 106 ä¸ª jar åŒ…ï¼š</p><blockquote><p>org.springframework.security:spring-security-rsa:jar:1.0.9.RELEASE:compile<br>com.netflix.ribbon: ribbon:jar:2.3.0:compile<br>org.springframework.boot:spring-boot-starter-thymeleaf:jar:2.3.6.RELEASE:compile<br>commons-configuration:commons-configuration:jar:1.8:compile<br>org.apache.logging.log4j:log4j-api:jar:2.13.3:compile<br>org.springframework:spring-beans:jar:5.2.11.RELEASE:compile<br>org.springframework.cloud:spring-cloud-starter-netflix-ribbon:jar:2.2.6.RELEASE:compile<br>org.apache.tomcat.embed:tomcat-embed-websocket:jar:9.0.39:compile<br>com.alibaba.cloud:spring-cloud-alibaba-commons:jar:2.2.6.RELEASE:compile<br>org.bouncycastle:bcprov-jdk15on:jar:1.64:compile<br>org.springframework.security:spring-security-crypto:jar:5.3.5.RELEASE:compile<br>org.apache.httpcomponents:httpasyncclient:jar:4.1.4:compile<br>com.google.j2objc:j2objc-annotations:jar:1.3:compile<br>com.fasterxml.jackson.core:jackson-databind:jar:2.11.3:compile<br>io.reactivex:rxjava:jar:1.3.8:compile<br>ch.qos.logback:logback-classic:jar:1.2.3:compile<br>org.springframework:spring-web:jar:5.2.11.RELEASE:compile<br>io.reactivex:rxnetty-servo:jar:0.4.9:runtime<br>org.springframework:spring-core:jar:5.2.11.RELEASE:compile<br>io.github.openfeign.form:feign-form-spring:jar:3.8.0:compile<br>io.github.openfeign.form:feign-form:jar:3.8.0:compile<br>com.netflix.ribbon:ribbon-loadbalancer:jar:2.3.0:compile<br>org.apache.httpcomponents:httpcore:jar:4.4.13:compile<br>org.thymeleaf.extras:thymeleaf-extras-java8time:jar:3.0.4.RELEASE:compile<br>org.slf4j:jul-to-slf4j:jar:1.7.30:compile<br>com.atguigu.demo:demo09-base-entity:jar:1.0-SNAPSHOT:compile<br>org.yaml:snakeyaml:jar:1.26:compile<br>org.springframework.boot:spring-boot-starter-logging:jar:2.3.6.RELEASE:compile<br>io.reactivex:rxnetty-contexts:jar:0.4.9:runtime<br>org.apache.httpcomponents:httpclient:jar:4.5.13:compile<br>io.github.openfeign:feign-core:jar:10.10.1:compile<br>org.springframework.boot:spring-boot-starter-aop:jar:2.3.6.RELEASE:compile<br>org.hdrhistogram:HdrHistogram:jar:2.1.9:compile<br>org.springframework:spring-context:jar:5.2.11.RELEASE:compile<br>commons-lang:commons-lang:jar:2.6:compile<br>io.prometheus:simpleclient:jar:0.5.0:compile<br>ch.qos.logback:logback-core:jar:1.2.3:compile<br>org.springframework:spring-webmvc:jar:5.2.11.RELEASE:compile<br>com.sun.jersey:jersey-core:jar:1.19.1:runtime<br>javax.ws.rs:jsr311-api:jar:1.1.1:runtime<br>javax.inject:javax.inject:jar:1:runtime<br>org.springframework.cloud:spring-cloud-openfeign-core:jar:2.2.6.RELEASE:compile<br>com.netflix.ribbon:ribbon-core:jar:2.3.0:compile<br>com.netflix.hystrix:hystrix-core:jar:1.5.18:compile<br>com.netflix.ribbon:ribbon-transport:jar:2.3.0:runtime<br>org.springframework.boot:spring-boot-starter-json:jar:2.3.6.RELEASE:compile<br>org.springframework.cloud:spring-cloud-starter-openfeign:jar:2.2.6.RELEASE:compile<br>com.fasterxml.jackson.module:jackson-module-parameter-names:jar:2.11.3:compile<br>com.sun.jersey.contribs:jersey-apache-client4:jar:1.19.1:runtime<br>io.github.openfeign:feign-hystrix:jar:10.10.1:compile<br>io.github.openfeign:feign-slf4j:jar:10.10.1:compile<br>com.alibaba.nacos:nacos-client:jar:1.4.2:compile<br>org.apache.httpcomponents:httpcore-nio:jar:4.4.13:compile<br>com.sun.jersey:jersey-client:jar:1.19.1:runtime<br>org.springframework.cloud:spring-cloud-context:jar:2.2.6.RELEASE:compile<br>org.glassfish:jakarta.el:jar:3.0.3:compile<br>org.apache.logging.log4j:log4j-to-slf4j:jar:2.13.3:compile<br>com.fasterxml.jackson.datatype:jackson-datatype-jsr310:jar:2.11.3:compile<br>org.springframework.cloud:spring-cloud-commons:jar:2.2.6.RELEASE:compile<br>org.aspectj:aspectjweaver:jar:1.9.6:compile<br>com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-discovery:jar:2.2.6.RELEASE:compile<br>com.google.guava:listenablefuture:jar:9999.0-empty-to-avoid-conflict-with-guava:compile<br>com.alibaba.spring:spring-context-support:jar:1.0.10:compile<br>jakarta.annotation:jakarta.annotation-api:jar:1.3.5:compile<br>org.bouncycastle:bcpkix-jdk15on:jar:1.64:compile<br>com.netflix.netflix-commons:netflix-commons-util:jar:0.3.0:runtime<br>com.fasterxml.jackson.core:jackson-annotations:jar:2.11.3:compile<br>com.google.guava:guava:jar:29.0-jre:compile<br>com.google.guava:failureaccess:jar:1.0.1:compile<br>org.springframework.boot:spring-boot:jar:2.3.6.RELEASE:compile<br>com.fasterxml.jackson.datatype:jackson-datatype-jdk8:jar:2.11.3:compile<br>com.atguigu.demo:demo08-base-api:jar:1.0-SNAPSHOT:compile<br>org.springframework.cloud:spring-cloud-starter-netflix-archaius:jar:2.2.6.RELEASE:compile<br>org.springframework.boot:spring-boot-autoconfigure:jar:2.3.6.RELEASE:compile<br>org.slf4j:slf4j-api:jar:1.7.30:compile<br>commons-io:commons-io:jar:2.7:compile<br>org.springframework.cloud:spring-cloud-starter:jar:2.2.6.RELEASE:compile<br>org.apache.tomcat.embed:tomcat-embed-core:jar:9.0.39:compile<br>io.reactivex:rxnetty:jar:0.4.9:runtime<br>com.fasterxml.jackson.core:jackson-core:jar:2.11.3:compile<br>com.google.code.findbugs:jsr305:jar:3.0.2:compile<br>com.netflix.archaius:archaius-core:jar:0.7.6:compile<br>org.springframework.boot:spring-boot-starter-web:jar:2.3.6.RELEASE:compile<br>commons-codec:commons-codec:jar:1.14:compile<br>com.netflix.servo:servo-core:jar:0.12.21:runtime<br>com.google.errorprone:error_prone_annotations:jar:2.3.4:compile<br>org.attoparser:attoparser:jar:2.0.5.RELEASE:compile<br>com.atguigu.demo:demo10-base-util:jar:1.0-SNAPSHOT:compile<br>org.checkerframework:checker-qual:jar:2.11.1:compile<br>org.thymeleaf:thymeleaf-spring5:jar:3.0.11.RELEASE:compile<br>commons-fileupload:commons-fileupload:jar:1.4:compile<br>com.netflix.ribbon:ribbon-httpclient:jar:2.3.0:compile<br>com.netflix.netflix-commons:netflix-statistics:jar:0.1.1:runtime<br>org.unbescape:unbescape:jar:1.1.6.RELEASE:compile<br>org.springframework:spring-jcl:jar:5.2.11.RELEASE:compile<br>com.alibaba.nacos:nacos-common:jar:1.4.2:compile<br>commons-collections:commons-collections:jar:3.2.2:runtime<br>javax.persistence:persistence-api:jar:1.0:compile<br>com.alibaba.nacos:nacos-api:jar:1.4.2:compile<br>org.thymeleaf:thymeleaf:jar:3.0.11.RELEASE:compile<br>org.springframework:spring-aop:jar:5.2.11.RELEASE:compile<br>org.springframework.boot:spring-boot-starter:jar:2.3.6.RELEASE:compile<br>org.springframework.boot:spring-boot-starter-tomcat:jar:2.3.6.RELEASE:compile<br>org.springframework.cloud:spring-cloud-netflix-ribbon:jar:2.2.6.RELEASE:compile<br>org.springframework:spring-expression:jar:5.2.11.RELEASE:compile<br>org.springframework.cloud:spring-cloud-netflix-archaius:jar:2.2.6.RELEASE:compile</p></blockquote><p>è€Œå¦‚æœä½¿ç”¨ Maven æ¥å¼•å…¥è¿™äº› jar åŒ…åªéœ€è¦é…ç½®ä¸‰ä¸ªã€<strong>ä¾èµ–</strong>ã€ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Nacos æœåŠ¡æ³¨å†Œå‘ç°å¯åŠ¨å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- webå¯åŠ¨å™¨ä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è§†å›¾æ¨¡æ¿æŠ€æœ¯ thymeleaf --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â‘¡jaråŒ…çš„æ¥æºé—®é¢˜</p><ul><li>è¿™ä¸ªjaråŒ…æ‰€å±æŠ€æœ¯çš„å®˜ç½‘ã€‚å®˜ç½‘é€šå¸¸æ˜¯è‹±æ–‡ç•Œé¢ï¼Œç½‘ç«™çš„ç»“æ„åˆä¸å°½ç›¸åŒï¼Œç”šè‡³æ‰¾åˆ°ä¸‹è½½é“¾æ¥è¿˜å‘ç°éœ€è¦é€šè¿‡ç‰¹æ®Šçš„å·¥å…·ä¸‹è½½ã€‚</li><li>ç¬¬ä¸‰æ–¹ç½‘ç«™æä¾›ä¸‹è½½ã€‚é—®é¢˜æ˜¯ä¸è§„èŒƒï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šå‡ºç°å„ç§é—®é¢˜ã€‚<ul><li>jaråŒ…çš„åç§°</li><li>jaråŒ…çš„ç‰ˆæœ¬</li><li>jaråŒ…å†…çš„å…·ä½“ç»†èŠ‚</li></ul></li><li>è€Œä½¿ç”¨ Maven åï¼Œä¾èµ–å¯¹åº”çš„ jar åŒ…èƒ½å¤Ÿ<strong>è‡ªåŠ¨ä¸‹è½½</strong>ï¼Œæ–¹ä¾¿ã€å¿«æ·åˆè§„èŒƒã€‚</li></ul><p>â‘¢jaråŒ…çš„å¯¼å…¥é—®é¢˜</p><p>åœ¨webå·¥ç¨‹ä¸­ï¼ŒjaråŒ…å¿…é¡»å­˜æ”¾åœ¨æŒ‡å®šä½ç½®ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021101825708.png" alt="image-20231021101825708"></p><p>åœ¨ä½¿ç”¨Mavenä¹‹åï¼Œé€šè¿‡é…ç½®ä¾èµ–(jaråŒ…)çš„åæ ‡ï¼ŒæŸ¥æ‰¾æœ¬åœ°ä»“åº“ä¸­ç›¸åº”jaråŒ…ï¼Œè‹¥æœ¬åœ°ä»“åº“æ²¡æœ‰ï¼Œåˆ™ç»Ÿä¸€ä»é•œåƒç½‘ç«™æˆ–ä¸­å¤®ä»“åº“ä¸­ä¸‹è½½ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021102831531.png" alt="image-20231021102831531"></p><p>â‘£jaråŒ…ä¹‹é—´çš„ä¾èµ–</p><p>æ¡†æ¶ä¸­ä½¿ç”¨çš„ jar åŒ…ï¼Œä¸ä»…æ•°é‡åºå¤§ï¼Œè€Œä¸”å½¼æ­¤ä¹‹é—´å­˜åœ¨é”™ç»¼å¤æ‚çš„ä¾èµ–å…³ç³»ã€‚ä¾èµ–å…³ç³»çš„å¤æ‚ç¨‹åº¦ï¼Œå·²ç»ä¸Šå‡åˆ°äº†å®Œå…¨ä¸èƒ½é äººåŠ›æ‰‹åŠ¨è§£å†³çš„ç¨‹åº¦ã€‚å¦å¤–ï¼Œjar åŒ…ä¹‹é—´æœ‰å¯èƒ½äº§ç”Ÿå†²çªã€‚è¿›ä¸€æ­¥å¢åŠ äº†æˆ‘ä»¬åœ¨ jar åŒ…ä½¿ç”¨è¿‡ç¨‹ä¸­çš„éš¾åº¦ã€‚</p><p>ä¸‹é¢æ˜¯å‰é¢ä¾‹å­ä¸­ jar åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img006.ab4f2e31.png" alt="images"></p><p>è€Œå®é™…ä¸Š jar åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»æ˜¯æ™®éå­˜åœ¨çš„ï¼Œå¦‚æœè¦ç”±ç¨‹åºå‘˜æ‰‹åŠ¨æ¢³ç†æ— ç–‘ä¼šå¢åŠ æé«˜çš„å­¦ä¹ æˆæœ¬ï¼Œè€Œè¿™äº›å·¥ä½œåˆå¯¹å®ç°ä¸šåŠ¡åŠŸèƒ½æ¯«æ— å¸®åŠ©ã€‚</p><p>è€Œä½¿ç”¨ Maven åˆ™å‡ ä¹ä¸éœ€è¦ç®¡ç†è¿™äº›å…³ç³»ï¼Œæä¸ªåˆ«çš„åœ°æ–¹è°ƒæ•´ä¸€ä¸‹å³å¯ï¼Œæå¤§çš„å‡è½»äº†æˆ‘ä»¬çš„å·¥ä½œé‡ã€‚</p><h3 id="Mavenæ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·"><a href="#Mavenæ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·" class="headerlink" title="Mavenæ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·"></a>Mavenæ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·</h3><p>â‘ ä½ æ²¡æœ‰æ³¨æ„è¿‡çš„æ„å»º</p><p>ä½ å¯ä»¥ä¸ä½¿ç”¨ Mavenï¼Œä½†æ˜¯æ„å»ºå¿…é¡»è¦åšã€‚å½“æˆ‘ä»¬ä½¿ç”¨ IDEA è¿›è¡Œå¼€å‘æ—¶ï¼Œæ„å»ºæ˜¯ IDEA æ›¿æˆ‘ä»¬åšçš„ã€‚</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021103758624.png" alt="image-20231021103758624"></p><p>â‘¡è„±ç¦» IDE ç¯å¢ƒä»éœ€æ„å»º</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image.png" alt="img"></p><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><ul><li><strong>ç®¡ç†è§„æ¨¡åºå¤§çš„ jar åŒ…ï¼Œéœ€è¦ä¸“é—¨å·¥å…·ã€‚</strong></li><li><strong>è„±ç¦» IDE ç¯å¢ƒæ‰§è¡Œæ„å»ºæ“ä½œï¼Œéœ€è¦ä¸“é—¨å·¥å…·ã€‚</strong></li></ul><h2 id="Mavenä»‹ç»"><a href="#Mavenä»‹ç»" class="headerlink" title="Mavenä»‹ç»"></a>Mavenä»‹ç»</h2><p><a href="https://maven.apache.org/what-is-maven.html">https://maven.apache.org/what-is-maven.html</a></p><p>Maven æ˜¯ä¸€æ¬¾ä¸º Java é¡¹ç›®ç®¡ç†æ„å»ºã€ä¾èµ–ç®¡ç†çš„å·¥å…·ï¼ˆè½¯ä»¶ï¼‰ï¼Œä½¿ç”¨ Maven å¯ä»¥è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•ã€æ‰“åŒ…å’Œå‘å¸ƒé¡¹ç›®ï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡å’Œè´¨é‡ã€‚</p><p>Mavenå°±æ˜¯ä¸€ä¸ªè½¯ä»¶ï¼ŒæŒæ¡å®‰è£…ã€é…ç½®ã€ä»¥åŠåŸºæœ¬åŠŸèƒ½ <strong>ï¼ˆé¡¹ç›®æ„å»ºã€ä¾èµ–ç®¡ç†ï¼‰</strong> çš„ç†è§£å’Œä½¿ç”¨å³å¯ï¼</p><ol><li><p><strong>ä¾èµ–ç®¡ç†ï¼š</strong></p><p>Maven å¯ä»¥ç®¡ç†é¡¹ç›®çš„ä¾èµ–ï¼ŒåŒ…æ‹¬è‡ªåŠ¨ä¸‹è½½æ‰€éœ€ä¾èµ–åº“ã€è‡ªåŠ¨ä¸‹è½½ä¾èµ–éœ€è¦çš„ä¾èµ–å¹¶ä¸”ä¿è¯ç‰ˆæœ¬æ²¡æœ‰å†²çªã€ä¾èµ–ç‰ˆæœ¬ç®¡ç†ç­‰ã€‚é€šè¿‡ Mavenï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°ç»´æŠ¤é¡¹ç›®æ‰€ä¾èµ–çš„å¤–éƒ¨åº“ï¼Œé¿å…ç‰ˆæœ¬å†²çªå’Œè½¬æ¢é”™è¯¯ç­‰ï¼Œè€Œæˆ‘ä»¬ä»…ä»…éœ€è¦ç¼–å†™é…ç½®å³å¯ã€‚</p></li><li><p><strong>æ„å»ºç®¡ç†ï¼š</strong></p><p>é¡¹ç›®æ„å»ºæ˜¯æŒ‡å°†æºä»£ç ã€é…ç½®æ–‡ä»¶ã€èµ„æºæ–‡ä»¶ç­‰è½¬åŒ–ä¸ºèƒ½å¤Ÿè¿è¡Œæˆ–éƒ¨ç½²çš„åº”ç”¨ç¨‹åºæˆ–åº“çš„è¿‡ç¨‹</p><p>Maven å¯ä»¥ç®¡ç†é¡¹ç›®çš„ç¼–è¯‘ã€æµ‹è¯•ã€æ‰“åŒ…ã€éƒ¨ç½²ç­‰æ„å»ºè¿‡ç¨‹ã€‚é€šè¿‡å®ç°æ ‡å‡†çš„æ„å»ºç”Ÿå‘½å‘¨æœŸï¼ŒMaven å¯ä»¥ç¡®ä¿æ¯ä¸€ä¸ªæ„å»ºè¿‡ç¨‹éƒ½éµå¾ªåŒæ ·çš„è§„åˆ™å’Œæœ€ä½³å®è·µã€‚åŒæ—¶ï¼ŒMaven çš„æ’ä»¶æœºåˆ¶ä¹Ÿä½¿å¾—å¼€å‘è€…å¯ä»¥å¯¹æ„å»ºè¿‡ç¨‹è¿›è¡Œæ‰©å±•å’Œå®šåˆ¶ã€‚ä¸»åŠ¨è§¦å‘æ„å»ºï¼Œåªéœ€è¦ç®€å•çš„å‘½ä»¤æ“ä½œå³å¯ã€‚</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_OSOE45UACw.png"></p></li></ol><p><strong>åœºæ™¯1ï¼š</strong> ä¾‹å¦‚æˆ‘ä»¬é¡¹ç›®éœ€è¦ç¬¬ä¸‰æ–¹ä¾èµ–å¦‚ï¼šDruidè¿æ¥æ± ã€MySQLæ•°æ®åº“é©±åŠ¨å’ŒJackson JSONç­‰å¤„ç†ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†æƒ³è¦çš„ä¾èµ–é¡¹çš„ä¿¡æ¯ç¼–å†™åˆ°Mavenå·¥ç¨‹çš„é…ç½®æ–‡ä»¶ï¼ŒMavenå°±ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å¤åˆ¶è¿™äº›ä¾èµ–é¡¹åˆ°é¡¹ç›®ä¸­ï¼Œæ— éœ€è‡ªå·±å¯¼å…¥jaråŒ…ï¼Œç®¡ç†jar!</p><p><strong>åœºæ™¯2ï¼š</strong> é¡¹ç›®å®Œæˆå¼€å‘ï¼Œæˆ‘ä»¬æƒ³è¦æ‰“æˆwaréƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸­ï¼Œä½¿ç”¨mavençš„æ„å»ºå‘½ä»¤å¯ä»¥å¿«é€Ÿæ‰“åŒ…ï¼èŠ‚çœå¤§é‡æ—¶é—´ï¼</p><h2 id="Mavenè½¯ä»¶å·¥ä½œåŸç†æ¨¡å‹å›¾ï¼ˆäº†è§£ï¼‰"><a href="#Mavenè½¯ä»¶å·¥ä½œåŸç†æ¨¡å‹å›¾ï¼ˆäº†è§£ï¼‰" class="headerlink" title="Mavenè½¯ä»¶å·¥ä½œåŸç†æ¨¡å‹å›¾ï¼ˆäº†è§£ï¼‰"></a>Mavenè½¯ä»¶å·¥ä½œåŸç†æ¨¡å‹å›¾ï¼ˆäº†è§£ï¼‰</h2><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_6AVFQbaXLj.png"></p><h1 id="Mavenå®‰è£…å’Œé…ç½®"><a href="#Mavenå®‰è£…å’Œé…ç½®" class="headerlink" title="Mavenå®‰è£…å’Œé…ç½®"></a>Mavenå®‰è£…å’Œé…ç½®</h1><h2 id="Mavenå®‰è£…"><a href="#Mavenå®‰è£…" class="headerlink" title="Mavenå®‰è£…"></a>Mavenå®‰è£…</h2><p><a href="https://maven.apache.org/docs/history.html">https://maven.apache.org/docs/history.html</a></p><p>å„ä¸ªå·¥å…·é€‰ç”¨ç‰ˆæœ¬ï¼š</p><table><thead><tr><th>å·¥å…·</th><th>ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>Maven</td><td>3.8.8</td></tr><tr><td>JDK</td><td>17</td></tr><tr><td>IDEA</td><td>2022.2</td></tr></tbody></table><p><strong>å®‰è£…æ¡ä»¶ï¼š</strong> mavenéœ€è¦æœ¬æœºå®‰è£…javaç¯å¢ƒã€å¿…éœ€åŒ…å«java_homeç¯å¢ƒå˜é‡ï¼</p><p><strong>è½¯ä»¶å®‰è£…ï¼š</strong> å³é”®è§£å‹å³å¯ï¼ˆç»¿è‰²å…å®‰è£…ï¼‰</p><p><strong>è½¯ä»¶ç»“æ„ï¼š</strong></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021110800113.png" alt="image-20231021110800113"></p><p><strong>bin</strong>ï¼šå«æœ‰Mavençš„è¿è¡Œè„šæœ¬</p><p>bootï¼šå«æœ‰plexus-classworldsç±»åŠ è½½å™¨æ¡†æ¶</p><p><strong>conf</strong>ï¼šå«æœ‰Mavençš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</p><p>libï¼šå«æœ‰Mavenè¿è¡Œæ—¶æ‰€éœ€è¦çš„Javaç±»åº“</p><p>LICENSEã€NOTICEã€README.txtï¼šé’ˆå¯¹Mavenç‰ˆæœ¬ï¼Œç¬¬ä¸‰æ–¹è½¯ä»¶ç­‰ç®€è¦ä»‹ç»</p><h2 id="Mavenç¯å¢ƒé…ç½®"><a href="#Mavenç¯å¢ƒé…ç½®" class="headerlink" title="Mavenç¯å¢ƒé…ç½®"></a>Mavenç¯å¢ƒé…ç½®</h2><ol><li><p>é…ç½®MAVEN_HOME</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021110938230.png" alt="image-20231021110938230"></p></li><li><p>é…ç½®Path</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_xNL5Fg_ucf.png"></p></li><li><p>å‘½ä»¤æµ‹è¯•ï¼ˆcmdçª—å£ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn -v </span><br><span class="line"><span class="comment"># è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯å³å¯ï¼Œå¦‚æœé”™è¯¯ï¼Œè¯·ä»”ç»†æ£€æŸ¥ç¯å¢ƒå˜é‡å³å¯ï¼</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="MavenåŠŸèƒ½é…ç½®"><a href="#MavenåŠŸèƒ½é…ç½®" class="headerlink" title="MavenåŠŸèƒ½é…ç½®"></a>MavenåŠŸèƒ½é…ç½®</h2><blockquote><p>æˆ‘ä»¬éœ€è¦éœ€æ”¹<strong>maven&#x2F;conf&#x2F;settings.xml</strong>é…ç½®æ–‡ä»¶ï¼Œæ¥ä¿®æ”¹mavençš„ä¸€äº›é»˜è®¤é…ç½®ã€‚æˆ‘ä»¬ä¸»è¦ä¼‘è¦ä¿®æ”¹çš„æœ‰ä¸‰ä¸ªé…ç½®ï¼š</p><p>1.ä¾èµ–æœ¬åœ°ç¼“å­˜ä½ç½®ï¼ˆæœ¬åœ°ä»“åº“ä½ç½®ï¼‰</p><p>2.mavenä¸‹è½½é•œåƒ</p><p>3.mavené€‰ç”¨ç¼–è¯‘é¡¹ç›®çš„jdkç‰ˆæœ¬</p></blockquote><ol><li>é…ç½®æœ¬åœ°ä»“åº“åœ°å€<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- localRepository</span></span><br><span class="line"><span class="comment">  | The path to the local repository maven will use to store artifacts.</span></span><br><span class="line"><span class="comment">  |</span></span><br><span class="line"><span class="comment">  | Default: $&#123;user.home&#125;/.m2/repository</span></span><br><span class="line"><span class="comment"> &lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- conf/settings.xml 55è¡Œ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:\maven-repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>é…ç½®å›½å†…é˜¿é‡Œé•œåƒ<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨mirrorsèŠ‚ç‚¹(æ ‡ç­¾)ä¸‹æ·»åŠ ä¸­å¤®ä»“åº“é•œåƒ 160è¡Œé™„è¿‘--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>é…ç½®jdk17ç‰ˆæœ¬é¡¹ç›®æ„å»º<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨profilesèŠ‚ç‚¹(æ ‡ç­¾)ä¸‹æ·»åŠ jdkç¼–è¯‘ç‰ˆæœ¬ 268è¡Œé™„è¿‘--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-17<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>17<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="IDEAé…ç½®æœ¬åœ°Mavenè½¯ä»¶"><a href="#IDEAé…ç½®æœ¬åœ°Mavenè½¯ä»¶" class="headerlink" title="IDEAé…ç½®æœ¬åœ°Mavenè½¯ä»¶"></a>IDEAé…ç½®æœ¬åœ°Mavenè½¯ä»¶</h2><blockquote><p>æˆ‘ä»¬éœ€è¦å°†é…ç½®å¥½çš„mavenè½¯ä»¶ï¼Œé…ç½®åˆ°ideaå¼€å‘å·¥å…·ä¸­å³å¯ï¼ æ³¨æ„ï¼šideaå·¥å…·é»˜è®¤è‡ªå¸¦mavené…ç½®è½¯ä»¶ï¼Œä½†æ˜¯å› ä¸ºæ²¡æœ‰ä¿®æ”¹é…ç½®ï¼Œå»ºè®®æ›¿æ¢æˆæœ¬åœ°é…ç½®å¥½çš„mavenï¼</p></blockquote><p>é€‰æ‹©æœ¬åœ°mavenè½¯ä»¶</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021112046512.png" alt="image-20231021112046512"></p><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€å¦‚æœ<strong>æœ¬åœ°ä»“åº“åœ°å€ä¸å˜åŒ–ï¼Œåªæœ‰ä¸€ä¸ªåŸå› ï¼Œå°±æ˜¯maven&#x2F;conf&#x2F;settings.xmlé…ç½®æ–‡ä»¶ç¼–å†™é”™è¯¯ï¼</strong> ä»”ç»†æ£€æŸ¥å³å¯ï¼</p><p>2ã€ä¸€å®šä¿è¯User settings fileå¯¹åº”ä¹‹å‰ä¿®æ”¹çš„settings.xmlçš„è·¯å¾„ï¼Œè‹¥ ä¸ä¸€è‡´ï¼Œé€‰ä¸­Overrideå¤é€‰æ¡†ï¼Œæ‰‹åŠ¨é€‰æ‹©é…ç½®æ–‡ä»¶</p><h1 id="åŸºäºIDEAåˆ›å»ºMavenå·¥ç¨‹"><a href="#åŸºäºIDEAåˆ›å»ºMavenå·¥ç¨‹" class="headerlink" title="åŸºäºIDEAåˆ›å»ºMavenå·¥ç¨‹"></a>åŸºäºIDEAåˆ›å»ºMavenå·¥ç¨‹</h1><h2 id="æ¦‚å¿µæ¢³ç†Mavenå·¥ç¨‹çš„GAVP"><a href="#æ¦‚å¿µæ¢³ç†Mavenå·¥ç¨‹çš„GAVP" class="headerlink" title="æ¦‚å¿µæ¢³ç†Mavenå·¥ç¨‹çš„GAVP"></a>æ¦‚å¿µæ¢³ç†Mavenå·¥ç¨‹çš„GAVP</h2><p>Mavenå·¥ç¨‹ç›¸å¯¹ä¹‹å‰çš„é¡¹ç›®ï¼Œå¤šå‡ºä¸€ç»„gavpå±æ€§ï¼Œgavéœ€è¦æˆ‘ä»¬åœ¨åˆ›å»ºé¡¹ç›®çš„æ—¶å€™æŒ‡å®šï¼Œpæœ‰é»˜è®¤å€¼ï¼Œæˆ‘ä»¬å…ˆè¡Œäº†è§£ä¸‹è¿™ç»„å±æ€§çš„å«ä¹‰ï¼š</p><p><strong>Maven ä¸­çš„ GAVP æ˜¯æŒ‡ GroupIdã€ArtifactIdã€Versionã€Packaging ç­‰å››ä¸ªå±æ€§çš„ç¼©å†™ï¼Œå…¶ä¸­å‰ä¸‰ä¸ªæ˜¯å¿…è¦çš„ï¼Œè€Œ Packaging å±æ€§ä¸ºå¯é€‰é¡¹ã€‚</strong> è¿™å››ä¸ªå±æ€§ä¸»è¦ä¸ºæ¯ä¸ªé¡¹ç›®åœ¨mavenä»“åº“ä¸­åšä¸€ä¸ªæ ‡è¯†ï¼Œç±»ä¼¼äººçš„å§“-åï¼æœ‰äº†å…·ä½“æ ‡è¯†ï¼Œæ–¹ä¾¿åæœŸé¡¹ç›®ä¹‹é—´ç›¸äº’å¼•ç”¨ä¾èµ–ç­‰ï¼</p><p>GAVéµå¾ªä¸€ä¸‹è§„åˆ™ï¼š</p><p>â€‹1ï¼‰ <strong>GroupID æ ¼å¼</strong>ï¼šcom.{å…¬å¸&#x2F;BU }.ä¸šåŠ¡çº¿.[å­ä¸šåŠ¡çº¿]ï¼Œæœ€å¤š 4 çº§ã€‚</p><p>â€‹è¯´æ˜ï¼š{å…¬å¸&#x2F;BU} ä¾‹å¦‚ï¼šalibaba&#x2F;taobao&#x2F;tmall&#x2F;aliexpress ç­‰ BU ä¸€çº§ï¼›å­ä¸šåŠ¡çº¿å¯é€‰ã€‚</p><p>â€‹æ­£ä¾‹ï¼šcom.taobao.tddl æˆ– com.alibaba.sourcing.multilang</p><p>â€‹2ï¼‰ <strong>ArtifactID æ ¼å¼</strong>ï¼šäº§å“çº¿å-æ¨¡å—åã€‚è¯­ä¹‰ä¸é‡å¤ä¸é—æ¼ï¼Œå…ˆåˆ°ä»“åº“ä¸­å¿ƒå»æŸ¥è¯ä¸€ä¸‹ã€‚</p><p>â€‹æ­£ä¾‹ï¼štc-client &#x2F; uic-api &#x2F; tair-tool &#x2F; bookstore</p><p>â€‹3ï¼‰ <strong>Versionç‰ˆæœ¬å·æ ¼å¼æ¨è</strong>ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·</p><p>â€‹1ï¼‰ ä¸»ç‰ˆæœ¬å·ï¼šå½“åšäº†ä¸å…¼å®¹çš„ API ä¿®æ”¹ï¼Œæˆ–è€…å¢åŠ äº†èƒ½æ”¹å˜äº§å“æ–¹å‘çš„æ–°åŠŸèƒ½ã€‚</p><p>â€‹2ï¼‰ æ¬¡ç‰ˆæœ¬å·ï¼šå½“åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢ï¼ˆæ–°å¢ç±»ã€æ¥å£ç­‰ï¼‰ã€‚</p><p>â€‹3ï¼‰ ä¿®è®¢å·ï¼šä¿®å¤ bugï¼Œæ²¡æœ‰ä¿®æ”¹æ–¹æ³•ç­¾åçš„åŠŸèƒ½åŠ å¼ºï¼Œä¿æŒ API å…¼å®¹æ€§ã€‚</p><p>â€‹ä¾‹å¦‚ï¼š åˆå§‹â†’1.0.0  ä¿®æ”¹bug â†’ 1.0.1  åŠŸèƒ½è°ƒæ•´ â†’ 1.1.1ç­‰</p><p><strong>Packagingå®šä¹‰è§„åˆ™ï¼š</strong></p><p>â€‹æŒ‡ç¤ºå°†é¡¹ç›®æ‰“åŒ…ä¸ºä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼Œideaæ ¹æ®packagingå€¼ï¼Œè¯†åˆ«mavené¡¹ç›®ç±»å‹ï¼</p><p>â€‹packaging å±æ€§ä¸º <strong>jar</strong>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œä»£è¡¨æ™®é€šçš„Javaå·¥ç¨‹ï¼Œæ‰“åŒ…ä»¥åæ˜¯.jarç»“å°¾çš„æ–‡ä»¶ã€‚</p><p>â€‹packaging å±æ€§ä¸º <strong>war</strong>ï¼Œä»£è¡¨Javaçš„webå·¥ç¨‹ï¼Œæ‰“åŒ…ä»¥å.warç»“å°¾çš„æ–‡ä»¶ã€‚</p><p>â€‹packaging å±æ€§ä¸º <strong>pom</strong>ï¼Œä»£è¡¨ä¸ä¼šæ‰“åŒ…ï¼Œç”¨æ¥åšç»§æ‰¿çš„çˆ¶å·¥ç¨‹ã€‚</p><h2 id="Ideaæ„å»ºMaven-Java-SEå·¥ç¨‹"><a href="#Ideaæ„å»ºMaven-Java-SEå·¥ç¨‹" class="headerlink" title="Ideaæ„å»ºMaven Java SEå·¥ç¨‹"></a>Ideaæ„å»ºMaven Java SEå·¥ç¨‹</h2><p>æ³¨æ„ï¼šæ­¤å¤„çœç•¥äº†versionï¼Œç›´æ¥ç»™äº†ä¸€ä¸ªé»˜è®¤å€¼ï¼š<strong>1.0-SNAPSHOT</strong></p><p>è‡ªå·±åæœŸå¯ä»¥åœ¨é¡¹ç›®ä¸­éšæ„ä¿®æ”¹ï¼</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021143559114.png" alt="image-20231021143559114"></p><p>åˆ›å»ºå·¥ç¨‹ä¹‹åï¼Œè‹¥ç¬¬ä¸€æ¬¡ä½¿ç”¨mavenï¼Œæˆ–è€…ä½¿ç”¨çš„æ˜¯æ–°çš„<strong>æœ¬åœ°ä»“åº“</strong>ï¼Œideaå³ä¸‹è§’ä¼šå‡ºç°ä»¥ä¸‹è¿›åº¦æ¡ï¼Œè¡¨ç¤ºmavenæ­£åœ¨ä¸‹è½½ç›¸å…³æ’ä»¶ï¼Œç­‰å¾…ä¸‹è½½å®Œæ¯•ï¼Œè¿›åº¦æ¡æ¶ˆå¤±å³å¯</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021145024505.png" alt="image-20231021145024505"></p><p>éªŒè¯mavenå·¥ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸï¼Œå½“åˆ›å»ºå®Œæ¯•mavenå·¥ç¨‹ä¹‹åï¼Œideaä¸­ä¼šè‡ªåŠ¨æ‰“å¼€Mavenè§†å›¾ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021145713433.png" alt="image-20231021145713433"></p><h2 id="Ideaæ„å»ºMaven-Java-Webå·¥ç¨‹"><a href="#Ideaæ„å»ºMaven-Java-Webå·¥ç¨‹" class="headerlink" title="Ideaæ„å»ºMaven Java Webå·¥ç¨‹"></a>Ideaæ„å»ºMaven Java Webå·¥ç¨‹</h2><ol><li><p>æ‰‹åŠ¨åˆ›å»º</p><ol><li><p>åˆ›å»ºä¸€ä¸ªmavençš„javaseå·¥ç¨‹</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021150134082.png" alt="image-20231021150134082"></p></li><li><p>ä¿®æ”¹pom.xmlæ–‡ä»¶æ‰“åŒ…æ–¹å¼</p><p>ä¿®æ”¹ä½ç½®ï¼šé¡¹ç›®ä¸‹&#x2F;pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven_web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ–°å¢ä¸€åˆ—æ‰“åŒ…æ–¹å¼packaging --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®<strong>webèµ„æºè·¯å¾„</strong>å’Œ<strong>web.xmlè·¯å¾„</strong></p><p>ç‚¹å‡»Fileâ€“&gt;Project Structure</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021151040531.png" alt="image-20231021151040531"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021151627161.png" alt="image-20231021151627161"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021151753318.png" alt="image-20231021151753318"></p></li><li><p>åˆ·æ–°å’Œæ ¡éªŒ</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021152310802.png" alt="image-20231021152310802"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021151921943.png" alt="image-20231021151921943"></p></li></ol></li><li><p>æ’ä»¶åˆ›å»º</p><ol><li><p>å®‰è£…æ’ä»¶JBLJavaToWeb</p><p>file &#x2F; settings &#x2F; plugins &#x2F; marketplace</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_cHUU_rABB6.png"></p></li><li><p>åˆ›å»ºä¸€ä¸ªjavasemavenå·¥ç¨‹</p></li><li><p>å³é”®ã€ä½¿ç”¨æ’ä»¶å¿«é€Ÿè¡¥å…¨webé¡¹ç›®</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_ZAPkM7VLgJ.png"></p></li></ol></li></ol><h2 id="Mavenå·¥ç¨‹é¡¹ç›®ç»“æ„è¯´æ˜"><a href="#Mavenå·¥ç¨‹é¡¹ç›®ç»“æ„è¯´æ˜" class="headerlink" title="Mavenå·¥ç¨‹é¡¹ç›®ç»“æ„è¯´æ˜"></a>Mavenå·¥ç¨‹é¡¹ç›®ç»“æ„è¯´æ˜</h2><p>Maven æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ„å»ºå·¥å…·ï¼Œå®ƒæä¾›ä¸€ç§æ ‡å‡†åŒ–çš„é¡¹ç›®ç»“æ„ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å®¹æ˜“åœ°ç®¡ç†é¡¹ç›®çš„ä¾èµ–ã€æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒç­‰ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ Maven Web ç¨‹åºçš„æ–‡ä»¶ç»“æ„åŠæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">|-- pom.xml                               # Maven é¡¹ç›®ç®¡ç†æ–‡ä»¶ </span><br><span class="line">|-- src</span><br><span class="line">    |-- main                              # é¡¹ç›®ä¸»è¦ä»£ç </span><br><span class="line">    |   |-- java                          # Java æºä»£ç ç›®å½•</span><br><span class="line">    |   |   `-- com/example/myapp         # å¼€å‘è€…ä»£ç ä¸»ç›®å½•</span><br><span class="line">    |   |       |-- controller            # å­˜æ”¾ Controller å±‚ä»£ç çš„ç›®å½•</span><br><span class="line">    |   |       |-- service               # å­˜æ”¾ Service å±‚ä»£ç çš„ç›®å½•</span><br><span class="line">    |   |       |-- dao                   # å­˜æ”¾ DAO å±‚ä»£ç çš„ç›®å½•</span><br><span class="line">    |   |       `-- model                 # å­˜æ”¾æ•°æ®æ¨¡å‹çš„ç›®å½•</span><br><span class="line">    |   |-- resources                     # èµ„æºç›®å½•ï¼Œå­˜æ”¾é…ç½®æ–‡ä»¶ã€é™æ€èµ„æºç­‰</span><br><span class="line">    |   |   |-- log4j.properties          # æ—¥å¿—é…ç½®æ–‡ä»¶</span><br><span class="line">    |   |   |-- spring-mybatis.xml        # Spring Mybatis é…ç½®æ–‡ä»¶</span><br><span class="line">    |   |   `-- static                    # å­˜æ”¾é™æ€èµ„æºçš„ç›®å½•</span><br><span class="line">    |   |       |-- css                   # å­˜æ”¾ CSS æ–‡ä»¶çš„ç›®å½•</span><br><span class="line">    |   |       |-- js                    # å­˜æ”¾ JavaScript æ–‡ä»¶çš„ç›®å½•</span><br><span class="line">    |   |       `-- images                # å­˜æ”¾å›¾ç‰‡èµ„æºçš„ç›®å½•</span><br><span class="line">    |   `-- webapp                        # å­˜æ”¾ WEB ç›¸å…³é…ç½®å’Œèµ„æº</span><br><span class="line">    |       |-- WEB-INF                   # å­˜æ”¾ WEB åº”ç”¨é…ç½®æ–‡ä»¶</span><br><span class="line">    |       |   |-- web.xml               # Web åº”ç”¨çš„éƒ¨ç½²æè¿°æ–‡ä»¶</span><br><span class="line">    |       |   `-- classes               # å­˜æ”¾ç¼–è¯‘åçš„ class æ–‡ä»¶</span><br><span class="line">    |       `-- index.html                # Web åº”ç”¨å…¥å£é¡µé¢</span><br><span class="line">    `-- test                              # é¡¹ç›®æµ‹è¯•ä»£ç </span><br><span class="line">        |-- java                          # å•å…ƒæµ‹è¯•ç›®å½•</span><br><span class="line">        `-- resources                     # æµ‹è¯•èµ„æºç›®å½•</span><br></pre></td></tr></table></figure><ul><li>pom.xmlï¼šMaven é¡¹ç›®ç®¡ç†æ–‡ä»¶ï¼Œç”¨äºæè¿°é¡¹ç›®çš„ä¾èµ–å’Œæ„å»ºé…ç½®ç­‰ä¿¡æ¯ã€‚</li><li>src&#x2F;main&#x2F;javaï¼šå­˜æ”¾é¡¹ç›®çš„ Java æºä»£ç ã€‚</li><li>src&#x2F;main&#x2F;resourcesï¼šå­˜æ”¾é¡¹ç›®çš„èµ„æºæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€é™æ€èµ„æºç­‰ã€‚</li><li>src&#x2F;main&#x2F;webapp&#x2F;WEB-INFï¼šå­˜æ”¾ Web åº”ç”¨çš„é…ç½®æ–‡ä»¶ã€‚</li><li>src&#x2F;main&#x2F;webapp&#x2F;index.jspï¼šWeb åº”ç”¨çš„å…¥å£é¡µé¢ã€‚</li><li>src&#x2F;test&#x2F;javaï¼šå­˜æ”¾é¡¹ç›®çš„æµ‹è¯•ä»£ç ã€‚</li><li>src&#x2F;test&#x2F;resourcesï¼šå­˜æ”¾æµ‹è¯•ç›¸å…³çš„èµ„æºæ–‡ä»¶ï¼Œå¦‚æµ‹è¯•é…ç½®æ–‡ä»¶ç­‰ã€‚</li></ul><h1 id="åŸºäºIDEAè¿›è¡ŒMavenå·¥ç¨‹æ„å»º"><a href="#åŸºäºIDEAè¿›è¡ŒMavenå·¥ç¨‹æ„å»º" class="headerlink" title="åŸºäºIDEAè¿›è¡ŒMavenå·¥ç¨‹æ„å»º"></a>åŸºäºIDEAè¿›è¡ŒMavenå·¥ç¨‹æ„å»º</h1><h2 id="æ„å»ºæ¦‚å¿µå’Œæ„å»ºè¿‡ç¨‹"><a href="#æ„å»ºæ¦‚å¿µå’Œæ„å»ºè¿‡ç¨‹" class="headerlink" title="æ„å»ºæ¦‚å¿µå’Œæ„å»ºè¿‡ç¨‹"></a>æ„å»ºæ¦‚å¿µå’Œæ„å»ºè¿‡ç¨‹</h2><p>é¡¹ç›®æ„å»ºæ˜¯æŒ‡<strong>å°†æºä»£ç ã€ä¾èµ–åº“å’Œèµ„æºæ–‡ä»¶ç­‰è½¬æ¢æˆå¯æ‰§è¡Œæˆ–å¯éƒ¨ç½²çš„åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹</strong>ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­åŒ…æ‹¬ç¼–è¯‘æºä»£ç ã€é“¾æ¥ä¾èµ–åº“ã€æ‰“åŒ…å’Œéƒ¨ç½²ç­‰å¤šä¸ªæ­¥éª¤ã€‚</p><p>é¡¹ç›®æ„å»ºæ˜¯è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­è‡³å…³é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒèƒ½å¤Ÿå¤§å¤§æé«˜è½¯ä»¶å¼€å‘æ•ˆç‡ï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºåº”ç”¨ç¨‹åºçš„å¼€å‘å’Œç»´æŠ¤ï¼Œè€Œä¸å¿…å…³å¿ƒåº”ç”¨ç¨‹åºçš„æ„å»ºç»†èŠ‚ã€‚</p><p>åŒæ—¶ï¼Œé¡¹ç›®æ„å»ºè¿˜èƒ½å¤Ÿ<strong>å°†å¤šä¸ªå¼€å‘äººå‘˜çš„ä»£ç æ±‡åˆåˆ°ä¸€èµ·ï¼Œå¹¶èƒ½å¤Ÿè‡ªåŠ¨åŒ–é¡¹ç›®çš„æ„å»ºå’Œéƒ¨ç½²</strong>ï¼Œå¤§å¤§é™ä½äº†é¡¹ç›®çš„å‡ºé”™é£é™©å’Œæé«˜å¼€å‘æ•ˆç‡ã€‚å¸¸è§çš„æ„å»ºå·¥å…·åŒ…æ‹¬ Mavenã€Gradleã€Ant ç­‰ã€‚</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_REm5kk7DnX.png"></p><h2 id="å‘½ä»¤æ–¹å¼é¡¹ç›®æ„å»º"><a href="#å‘½ä»¤æ–¹å¼é¡¹ç›®æ„å»º" class="headerlink" title="å‘½ä»¤æ–¹å¼é¡¹ç›®æ„å»º"></a>å‘½ä»¤æ–¹å¼é¡¹ç›®æ„å»º</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>mvn compile</td><td>ç¼–è¯‘é¡¹ç›®ï¼Œç”Ÿæˆtargetæ–‡ä»¶</td></tr><tr><td>mvn package</td><td>æ‰“åŒ…é¡¹ç›®ï¼Œç”Ÿæˆjaræˆ–waræ–‡ä»¶</td></tr><tr><td>mvn clean</td><td>æ¸…ç†ç¼–è¯‘æˆ–æ‰“åŒ…åçš„é¡¹ç›®ç»“æ„</td></tr><tr><td>mvn install</td><td>æ‰“åŒ…åä¸Šä¼ åˆ°mavenæœ¬åœ°ä»“åº“</td></tr><tr><td>mvn deploy</td><td>åªæ‰“åŒ…ï¼Œä¸Šä¼ åˆ°mavenç§æœä»“åº“</td></tr><tr><td>mvn site</td><td>ç”Ÿæˆç«™ç‚¹</td></tr><tr><td>mvn test</td><td>æ‰§è¡Œæµ‹è¯•æºç </td></tr></tbody></table><p>waråŒ…æ‰“åŒ…æ’ä»¶å’Œjdkç‰ˆæœ¬ä¸åŒ¹é…ï¼špom.xml æ·»åŠ ä»¥ä¸‹ä»£ç å³å¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jdk17 å’Œ waråŒ…ç‰ˆæœ¬æ’ä»¶ä¸åŒ¹é… --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤è§¦å‘ç»ƒä¹ ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mvn å‘½ä»¤ å‘½ä»¤</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¸…ç†</span></span><br><span class="line">mvn clean</span><br><span class="line"><span class="comment">#æ¸…ç†ï¼Œå¹¶é‡æ–°æ‰“åŒ…</span></span><br><span class="line">mvn clean package</span><br><span class="line"><span class="comment">#æ‰§è¡Œæµ‹è¯•ä»£ç </span></span><br><span class="line">mvn <span class="built_in">test</span></span><br></pre></td></tr></table></figure><h2 id="å¯è§†åŒ–æ–¹å¼é¡¹ç›®æ„å»º"><a href="#å¯è§†åŒ–æ–¹å¼é¡¹ç›®æ„å»º" class="headerlink" title="å¯è§†åŒ–æ–¹å¼é¡¹ç›®æ„å»º"></a>å¯è§†åŒ–æ–¹å¼é¡¹ç›®æ„å»º</h2><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021153444864.png" alt="image-20231021153444864"></p><p>æ³¨æ„ï¼šæ‰“åŒ…ï¼ˆpackageï¼‰å’Œå®‰è£…ï¼ˆinstallï¼‰çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ</p><p><strong>æ‰“åŒ…</strong>ï¼šæ˜¯å°†å·¥ç¨‹æ‰“æˆjaræˆ–waræ–‡ä»¶ï¼Œä¿å­˜åœ¨targetç›®å½•ä¸‹</p><p><strong>å®‰è£…</strong>ï¼šæ˜¯å°†å½“å‰å·¥ç¨‹æ‰€ç”Ÿæˆçš„jaræˆ–waræ–‡ä»¶ï¼Œå®‰è£…åˆ°æœ¬åœ°ä»“åº“ï¼Œä¼šæŒ‰ç…§åæ ‡ä¿å­˜åˆ°æŒ‡å®šä½ç½®</p><h2 id="æ„å»ºæ’ä»¶ã€å‘½ä»¤ã€ç”Ÿå‘½å‘¨æœŸå‘½ä»¤ä¹‹é—´å…³ç³»"><a href="#æ„å»ºæ’ä»¶ã€å‘½ä»¤ã€ç”Ÿå‘½å‘¨æœŸå‘½ä»¤ä¹‹é—´å…³ç³»" class="headerlink" title="æ„å»ºæ’ä»¶ã€å‘½ä»¤ã€ç”Ÿå‘½å‘¨æœŸå‘½ä»¤ä¹‹é—´å…³ç³»"></a>æ„å»ºæ’ä»¶ã€å‘½ä»¤ã€ç”Ÿå‘½å‘¨æœŸå‘½ä»¤ä¹‹é—´å…³ç³»</h2><ul><li><p><strong>æ„å»ºç”Ÿå‘½å‘¨æœŸ</strong></p><p>æˆ‘ä»¬å‘ç°ä¸€ä¸ªæƒ…å†µï¼å½“æˆ‘ä»¬æ‰§è¡Œpackageå‘½ä»¤ä¹Ÿä¼šè‡ªåŠ¨æ‰§è¡Œcompileå‘½ä»¤ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[INFO] --------------------------------[ jar ]---------------------------------</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ mybatis-base-curd ---</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ mybatis-base-curd ---</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ mybatis-base-curd ---</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ mybatis-base-curd ---</span><br><span class="line">[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ mybatis-base-curd ---</span><br><span class="line">[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ mybatis-base-curd ---</span><br><span class="line">[INFO] Building jar: D:\javaprojects\backend-engineering\part03-mybatis\mybatis-base-curd\target\mybatis-base-curd-1.0-SNAPSHOT.jar</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total time:  5.013 s</span><br><span class="line">[INFO] Finished at: 2023-06-05T10:03:47+08:00</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>è¿™ç§è¡Œä¸ºå°±æ˜¯å› ä¸ºæ„å»ºç”Ÿå‘½å‘¨æœŸäº§ç”Ÿçš„ï¼æ„å»ºç”Ÿå‘½å‘¨æœŸå¯ä»¥ç†è§£æˆæ˜¯ä¸€ç»„å›ºå®šæ„å»ºå‘½ä»¤çš„æœ‰åºé›†åˆï¼Œè§¦å‘å‘¨æœŸåçš„å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨è§¦å‘å‘¨æœŸå‰çš„å‘½ä»¤ï¼ï¼ï¼</p><p><strong>æ„å»ºå‘¨æœŸä½œç”¨ï¼šä¼šç®€åŒ–æ„å»ºè¿‡ç¨‹</strong></p><p>ä¾‹å¦‚ï¼šé¡¹ç›®æ‰“åŒ…   mvn clean packageå³å¯ã€‚&#x20;</p><p>ä¸»è¦ä¸¤ä¸ªæ„å»ºç”Ÿå‘½å‘¨æœŸï¼š</p><ul><li><p>æ¸…ç†å‘¨æœŸï¼šä¸»è¦æ˜¯å¯¹é¡¹ç›®ç¼–è¯‘ç”Ÿæˆæ–‡ä»¶è¿›è¡Œæ¸…ç†</p><p>åŒ…å«å‘½ä»¤ï¼šclean&#x20;</p></li></ul></li><li><p>é»˜è®¤å‘¨æœŸï¼šå®šä¹‰äº†çœŸæ­£æ„ä»¶æ—¶æ‰€éœ€è¦æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤ï¼Œå®ƒæ˜¯ç”Ÿå‘½å‘¨æœŸä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†</p><pre><code>åŒ…å«å‘½ä»¤ï¼šcompile -  test - package - install - deploy</code></pre></li><li><p><strong>æ’ä»¶ã€å‘½ä»¤ã€å‘¨æœŸä¸‰è€…å…³ç³»ï¼ˆäº†è§£ï¼‰</strong></p><p>å‘¨æœŸâ†’åŒ…å«è‹¥å¹²å‘½ä»¤â†’åŒ…å«è‹¥å¹²æ’ä»¶</p><p>ä½¿ç”¨å‘¨æœŸå‘½ä»¤æ„å»ºï¼Œç®€åŒ–æ„å»ºè¿‡ç¨‹ï¼</p><p>æœ€ç»ˆè¿›è¡Œæ„å»ºçš„æ˜¯æ’ä»¶ï¼</p></li></ul><h1 id="åŸºäºIDEA-è¿›è¡ŒMavenä¾èµ–ç®¡ç†"><a href="#åŸºäºIDEA-è¿›è¡ŒMavenä¾èµ–ç®¡ç†" class="headerlink" title="åŸºäºIDEA è¿›è¡ŒMavenä¾èµ–ç®¡ç†"></a>åŸºäºIDEA è¿›è¡ŒMavenä¾èµ–ç®¡ç†</h1><h2 id="ä¾èµ–ç®¡ç†æ¦‚å¿µ"><a href="#ä¾èµ–ç®¡ç†æ¦‚å¿µ" class="headerlink" title="ä¾èµ–ç®¡ç†æ¦‚å¿µ"></a>ä¾èµ–ç®¡ç†æ¦‚å¿µ</h2><p>Maven ä¾èµ–ç®¡ç†æ˜¯ Maven è½¯ä»¶ä¸­æœ€é‡è¦çš„åŠŸèƒ½ä¹‹ä¸€ã€‚Maven çš„ä¾èµ–ç®¡ç†èƒ½å¤Ÿå¸®åŠ©å¼€å‘äººå‘˜è‡ªåŠ¨è§£å†³è½¯ä»¶åŒ…ä¾èµ–é—®é¢˜ï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°å°†å…¶ä»–å¼€å‘äººå‘˜å¼€å‘çš„æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹æ¡†æ¶é›†æˆåˆ°è‡ªå·±çš„åº”ç”¨ç¨‹åºæˆ–æ¨¡å—ä¸­ï¼Œé¿å…å‡ºç°ç‰ˆæœ¬å†²çªå’Œä¾èµ–ç¼ºå¤±ç­‰é—®é¢˜ã€‚</p><p>æˆ‘ä»¬é€šè¿‡å®šä¹‰ POM æ–‡ä»¶ï¼ŒMaven èƒ½å¤Ÿè‡ªåŠ¨è§£æé¡¹ç›®çš„ä¾èµ–å…³ç³»ï¼Œå¹¶é€šè¿‡ Maven <strong>ä»“åº“è‡ªåŠ¨</strong>ä¸‹è½½å’Œç®¡ç†ä¾èµ–ï¼Œä»è€Œé¿å…äº†æ‰‹åŠ¨ä¸‹è½½å’Œç®¡ç†ä¾èµ–çš„ç¹çå·¥ä½œå’Œå¯èƒ½å¼•å‘çš„ç‰ˆæœ¬å†²çªé—®é¢˜ã€‚</p><p>æ€»ä¹‹ï¼ŒMaven çš„ä¾èµ–ç®¡ç†æ˜¯ Maven è½¯ä»¶çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œä½¿å¾—è½¯ä»¶åŒ…ä¾èµ–çš„ç®¡ç†å’Œä½¿ç”¨æ›´åŠ æ™ºèƒ½å’Œæ–¹ä¾¿ï¼Œç®€åŒ–äº†å¼€å‘è¿‡ç¨‹ä¸­çš„å·¥ä½œï¼Œå¹¶æé«˜äº†è½¯ä»¶è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h2 id="Mavenå·¥ç¨‹æ ¸å¿ƒä¿¡æ¯é…ç½®å’Œè§£è¯»ï¼ˆGAVPï¼‰"><a href="#Mavenå·¥ç¨‹æ ¸å¿ƒä¿¡æ¯é…ç½®å’Œè§£è¯»ï¼ˆGAVPï¼‰" class="headerlink" title="Mavenå·¥ç¨‹æ ¸å¿ƒä¿¡æ¯é…ç½®å’Œè§£è¯»ï¼ˆGAVPï¼‰"></a>Mavenå·¥ç¨‹æ ¸å¿ƒä¿¡æ¯é…ç½®å’Œè§£è¯»ï¼ˆGAVPï¼‰</h2><p>ä½ç½®ï¼špom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ¨¡å‹ç‰ˆæœ¬ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å…¬å¸æˆ–è€…ç»„ç»‡çš„å”¯ä¸€æ ‡å¿—ï¼Œå¹¶ä¸”é…ç½®æ—¶ç”Ÿæˆçš„è·¯å¾„ä¹Ÿæ˜¯ç”±æ­¤ç”Ÿæˆï¼Œ å¦‚com.companyname.project-groupï¼Œmavenä¼šå°†è¯¥é¡¹ç›®æ‰“æˆçš„jaråŒ…æ”¾æœ¬åœ°è·¯å¾„ï¼š/com/companyname/project-group --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.companyname.project-group<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é¡¹ç›®çš„å”¯ä¸€IDï¼Œä¸€ä¸ªgroupIdä¸‹é¢å¯èƒ½å¤šä¸ªé¡¹ç›®ï¼Œå°±æ˜¯é artifactIdæ¥åŒºåˆ†çš„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ç‰ˆæœ¬å· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ‰“åŒ…æ–¹å¼</span></span><br><span class="line"><span class="comment">    é»˜è®¤ï¼šjar</span></span><br><span class="line"><span class="comment">    jaræŒ‡çš„æ˜¯æ™®é€šçš„javaé¡¹ç›®æ‰“åŒ…æ–¹å¼ï¼ é¡¹ç›®æ‰“æˆjaråŒ…ï¼</span></span><br><span class="line"><span class="comment">    waræŒ‡çš„æ˜¯webé¡¹ç›®æ‰“åŒ…æ–¹å¼ï¼é¡¹ç›®æ‰“æˆwaråŒ…ï¼</span></span><br><span class="line"><span class="comment">    pomä¸ä¼šè®²é¡¹ç›®æ‰“åŒ…ï¼è¿™ä¸ªé¡¹ç›®ä½œä¸ºçˆ¶å·¥ç¨‹ï¼Œè¢«å…¶ä»–å·¥ç¨‹èšåˆæˆ–è€…ç»§æ‰¿ï¼åé¢ä¼šè®²è§£ä¸¤ä¸ªæ¦‚å¿µ</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar/pom/war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Mavenå·¥ç¨‹ä¾èµ–ç®¡ç†é…ç½®"><a href="#Mavenå·¥ç¨‹ä¾èµ–ç®¡ç†é…ç½®" class="headerlink" title="Mavenå·¥ç¨‹ä¾èµ–ç®¡ç†é…ç½®"></a>Mavenå·¥ç¨‹ä¾èµ–ç®¡ç†é…ç½®</h2><p>ä½ç½®ï¼špom.xml</p><p>ä¾èµ–ç®¡ç†å’Œä¾èµ–æ·»åŠ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">   é€šè¿‡ç¼–å†™ä¾èµ–jaråŒ…çš„gavå¿…è¦å±æ€§ï¼Œå¼•å…¥ç¬¬ä¸‰æ–¹ä¾èµ–ï¼</span></span><br><span class="line"><span class="comment">   scopeå±æ€§æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥æŒ‡å®šä¾èµ–ç”Ÿæ•ˆèŒƒå›´ï¼</span></span><br><span class="line"><span class="comment">   ä¾èµ–ä¿¡æ¯æŸ¥è¯¢æ–¹å¼ï¼š</span></span><br><span class="line"><span class="comment">      1. mavenä»“åº“ä¿¡æ¯å®˜ç½‘ https://mvnrepository.com/</span></span><br><span class="line"><span class="comment">      2. mavensearchæ’ä»¶æœç´¢</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥å…·ä½“çš„ä¾èµ–åŒ… --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ä¾èµ–èŒƒå›´ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¾èµ–ç‰ˆæœ¬ç»Ÿä¸€æå–å’Œç»´æŠ¤</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å£°æ˜ç‰ˆæœ¬--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å‘½åéšä¾¿,å†…éƒ¨åˆ¶å®šç‰ˆæœ¬å·å³å¯ï¼--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">junit.version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">junit.version</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä¹Ÿå¯ä»¥é€šè¿‡ mavenè§„å®šçš„å›ºå®šçš„keyï¼Œé…ç½®mavençš„å‚æ•°ï¼å¦‚ä¸‹é…ç½®ç¼–ç æ ¼å¼ï¼--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¼•ç”¨propertieså£°æ˜ç‰ˆæœ¬ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ä¾èµ–èŒƒå›´"><a href="#ä¾èµ–èŒƒå›´" class="headerlink" title="ä¾èµ–èŒƒå›´"></a>ä¾èµ–èŒƒå›´</h2><p>é€šè¿‡è®¾ç½®åæ ‡çš„ä¾èµ–èŒƒå›´(scope)ï¼Œå¯ä»¥è®¾ç½® å¯¹åº”jaråŒ…çš„ä½œç”¨èŒƒå›´ï¼šç¼–è¯‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€è¿è¡Œç¯å¢ƒ</p><table><thead><tr><th>ä¾èµ–èŒƒå›´</th><th>æè¿°</th></tr></thead><tbody><tr><td><strong>compile</strong></td><td>ç¼–è¯‘ä¾èµ–èŒƒå›´ï¼Œscope å…ƒç´ çš„ç¼ºçœå€¼ã€‚ä½¿ç”¨æ­¤ä¾èµ–èŒƒå›´çš„ Maven ä¾èµ–ï¼Œ<strong>å¯¹äºä¸‰ç§ classpath å‡æœ‰æ•ˆï¼Œå³è¯¥ Maven ä¾èµ–åœ¨ä¸Šè¿°ä¸‰ç§ classpath å‡ä¼šè¢«å¼•å…¥</strong>ã€‚ä¾‹å¦‚ï¼Œlog4j åœ¨ç¼–è¯‘ã€æµ‹è¯•ã€è¿è¡Œè¿‡ç¨‹éƒ½æ˜¯å¿…é¡»çš„ã€‚</td></tr><tr><td><strong>test</strong></td><td>æµ‹è¯•ä¾èµ–èŒƒå›´ã€‚ä½¿ç”¨æ­¤ä¾èµ–èŒƒå›´çš„ Maven ä¾èµ–ï¼Œ<strong>åªå¯¹æµ‹è¯• classpath æœ‰æ•ˆ</strong>ã€‚ä¾‹å¦‚ï¼ŒJunit ä¾èµ–åªæœ‰åœ¨æµ‹è¯•é˜¶æ®µæ‰éœ€è¦ã€‚</td></tr><tr><td><strong>provided</strong></td><td>å·²æä¾›ä¾èµ–èŒƒå›´ã€‚ä½¿ç”¨æ­¤ä¾èµ–èŒƒå›´çš„ Maven ä¾èµ–ï¼Œåªå¯¹ç¼–è¯‘ classpath å’Œæµ‹è¯• classpath æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼Œservlet-api ä¾èµ–å¯¹äºç¼–è¯‘ã€æµ‹è¯•é˜¶æ®µè€Œè¨€æ˜¯éœ€è¦çš„ï¼Œä½†æ˜¯è¿è¡Œé˜¶æ®µï¼Œç”±äºå¤–éƒ¨å®¹å™¨å·²ç»æä¾›ï¼Œæ•…ä¸éœ€è¦ Maven é‡å¤å¼•å…¥è¯¥ä¾èµ–ã€‚</td></tr><tr><td>runtime</td><td>è¿è¡Œæ—¶ä¾èµ–èŒƒå›´ã€‚ä½¿ç”¨æ­¤ä¾èµ–èŒƒå›´çš„ Maven ä¾èµ–ï¼Œ<strong>åªå¯¹æµ‹è¯• classpathã€è¿è¡Œ classpath æœ‰æ•ˆ</strong>ã€‚ä¾‹å¦‚ï¼ŒJDBC é©±åŠ¨å®ç°ä¾èµ–ï¼Œå…¶åœ¨ç¼–è¯‘æ—¶åªéœ€ JDK æä¾›çš„ JDBC æ¥å£å³å¯ï¼Œåªæœ‰æµ‹è¯•ã€è¿è¡Œé˜¶æ®µæ‰éœ€è¦å®ç°äº† JDBC æ¥å£çš„é©±åŠ¨ã€‚</td></tr><tr><td>system</td><td>ç³»ç»Ÿä¾èµ–èŒƒå›´ï¼Œå…¶æ•ˆæœä¸ provided çš„ä¾èµ–èŒƒå›´ä¸€è‡´ã€‚å…¶ç”¨äºæ·»åŠ é Maven ä»“åº“çš„æœ¬åœ°ä¾èµ–ï¼Œé€šè¿‡ä¾èµ–å…ƒç´  dependency ä¸­çš„ systemPath å…ƒç´ æŒ‡å®šæœ¬åœ°ä¾èµ–çš„è·¯å¾„ã€‚é‰´äºä½¿ç”¨å…¶ä¼šå¯¼è‡´é¡¹ç›®çš„å¯ç§»æ¤æ€§é™ä½ï¼Œ<strong>ä¸€èˆ¬ä¸æ¨èä½¿ç”¨</strong>ã€‚</td></tr><tr><td>import</td><td>å¯¼å…¥ä¾èµ–èŒƒå›´ï¼Œè¯¥ä¾èµ–èŒƒå›´åªèƒ½ä¸ dependencyManagement å…ƒç´ é…åˆä½¿ç”¨ï¼Œå…¶åŠŸèƒ½æ˜¯å°†ç›®æ ‡ pom.xml æ–‡ä»¶ä¸­ dependencyManagement çš„é…ç½®å¯¼å…¥åˆå¹¶åˆ°å½“å‰ pom.xml çš„ dependencyManagement ä¸­ã€‚</td></tr></tbody></table><h2 id="Mavenå·¥ç¨‹ä¾èµ–ä¸‹è½½å¤±è´¥é”™è¯¯è§£å†³ï¼ˆé‡ç‚¹ï¼‰"><a href="#Mavenå·¥ç¨‹ä¾èµ–ä¸‹è½½å¤±è´¥é”™è¯¯è§£å†³ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="Mavenå·¥ç¨‹ä¾èµ–ä¸‹è½½å¤±è´¥é”™è¯¯è§£å†³ï¼ˆé‡ç‚¹ï¼‰"></a>Mavenå·¥ç¨‹ä¾èµ–ä¸‹è½½å¤±è´¥é”™è¯¯è§£å†³ï¼ˆé‡ç‚¹ï¼‰</h2><p>åœ¨ä½¿ç”¨ Maven æ„å»ºé¡¹ç›®æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¾èµ–é¡¹ä¸‹è½½é”™è¯¯çš„æƒ…å†µï¼Œä¸»è¦åŸå› æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li>ä¸‹è½½ä¾èµ–æ—¶å‡ºç°ç½‘ç»œæ•…éšœæˆ–ä»“åº“æœåŠ¡å™¨å®•æœºç­‰åŸå› ï¼Œå¯¼è‡´æ— æ³•è¿æ¥è‡³ Maven ä»“åº“ï¼Œä»è€Œæ— æ³•ä¸‹è½½ä¾èµ–ã€‚</li><li>ä¾èµ–é¡¹çš„ç‰ˆæœ¬å·æˆ–é…ç½®æ–‡ä»¶ä¸­çš„ç‰ˆæœ¬å·é”™è¯¯ï¼Œæˆ–è€…ä¾èµ–é¡¹æ²¡æœ‰æ­£ç¡®å®šä¹‰ï¼Œå¯¼è‡´ Maven ä¸‹è½½çš„ä¾èµ–é¡¹ä¸å®é™…éœ€è¦çš„ä¸ä¸€è‡´ï¼Œä»è€Œå¼•å‘é”™è¯¯ã€‚</li><li>æœ¬åœ° Maven ä»“åº“æˆ–ç¼“å­˜è¢«æ±¡æŸ“æˆ–æŸåï¼Œå¯¼è‡´ Maven æ— æ³•æ­£ç¡®åœ°ä½¿ç”¨ç°æœ‰çš„ä¾èµ–é¡¹ã€‚</li></ol><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li><p>æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œ Maven ä»“åº“æœåŠ¡å™¨çŠ¶æ€ã€‚</p></li><li><p>ç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬å·ä¸é¡¹ç›®å¯¹åº”çš„ç‰ˆæœ¬å·åŒ¹é…ï¼Œå¹¶æ£€æŸ¥ POM æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹æ˜¯å¦æ­£ç¡®ã€‚</p></li><li><p><strong>æ¸…é™¤æœ¬åœ° Maven ä»“åº“ç¼“å­˜ï¼ˆlastUpdated æ–‡ä»¶ï¼‰ï¼Œå› ä¸ºåªè¦å­˜åœ¨lastupdatedç¼“å­˜æ–‡ä»¶ï¼Œåˆ·æ–°ä¹Ÿä¸ä¼šé‡æ–°ä¸‹è½½</strong>ã€‚æœ¬åœ°ä»“åº“ä¸­ï¼Œæ ¹æ®ä¾èµ–çš„gavå±æ€§ä¾æ¬¡å‘ä¸‹æŸ¥æ‰¾æ–‡ä»¶å¤¹ï¼Œæœ€ç»ˆåˆ é™¤å†…éƒ¨çš„æ–‡ä»¶ï¼Œåˆ·æ–°é‡æ–°ä¸‹è½½å³å¯ï¼</p><p>ä¾‹å¦‚ï¼š pom.xmlä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_m3iQtBLARz.png"></p></li><li><p>æˆ–è€…å¯ä»¥å°†æ¸…é™¤<strong>lastUpdatedæ–‡ä»¶</strong>çš„æ“ä½œå†™åœ¨ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä¸­ï¼Œæ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶â€clearLastUpdated.batâ€ï¼Œåå­—ä»»æ„ï¼Œä½†æ˜¯åç¼€å¿…é¡»æ˜¯batï¼Œå°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ°æ–‡ä»¶ä¸­</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cls</span> </span><br><span class="line">@<span class="built_in">ECHO</span> OFF </span><br><span class="line"><span class="built_in">SET</span> CLEAR_PATH=D: </span><br><span class="line"><span class="built_in">SET</span> CLEAR_DIR=D:\maven-repository(æœ¬åœ°ä»“åº“è·¯å¾„)</span><br><span class="line"><span class="built_in">color</span> <span class="number">0</span>a </span><br><span class="line"><span class="built_in">TITLE</span> ClearLastUpdated <span class="keyword">For</span> Windows </span><br><span class="line"><span class="keyword">GOTO</span> MENU </span><br><span class="line">:MENU </span><br><span class="line"><span class="built_in">CLS</span></span><br><span class="line"><span class="built_in">ECHO</span>. </span><br><span class="line"><span class="built_in">ECHO</span>. * * * *  ClearLastUpdated <span class="keyword">For</span> Windows  * * * * </span><br><span class="line"><span class="built_in">ECHO</span>. * * </span><br><span class="line"><span class="built_in">ECHO</span>. * <span class="number">1</span> æ¸…ç†*.lastUpdated * </span><br><span class="line"><span class="built_in">ECHO</span>. * * </span><br><span class="line"><span class="built_in">ECHO</span>. * <span class="number">2</span> æŸ¥çœ‹*.lastUpdated * </span><br><span class="line"><span class="built_in">ECHO</span>. * * </span><br><span class="line"><span class="built_in">ECHO</span>. * <span class="number">3</span> é€€ å‡º * </span><br><span class="line"><span class="built_in">ECHO</span>. * * </span><br><span class="line"><span class="built_in">ECHO</span>. * * * * * * * * * * * * * * * * * * * * * * * * </span><br><span class="line"><span class="built_in">ECHO</span>. </span><br><span class="line"><span class="built_in">ECHO</span>.è¯·è¾“å…¥é€‰æ‹©é¡¹ç›®çš„åºå·ï¼š </span><br><span class="line"><span class="built_in">set</span> /p ID= </span><br><span class="line"><span class="keyword">IF</span> &quot;<span class="variable">%id%</span>&quot;==&quot;<span class="number">1</span>&quot; <span class="keyword">GOTO</span> cmd1 </span><br><span class="line"><span class="keyword">IF</span> &quot;<span class="variable">%id%</span>&quot;==&quot;<span class="number">2</span>&quot; <span class="keyword">GOTO</span> cmd2 </span><br><span class="line"><span class="keyword">IF</span> &quot;<span class="variable">%id%</span>&quot;==&quot;<span class="number">3</span>&quot; <span class="keyword">EXIT</span> </span><br><span class="line"><span class="built_in">PAUSE</span> </span><br><span class="line">:cmd1 </span><br><span class="line"><span class="built_in">ECHO</span>. å¼€å§‹æ¸…ç†</span><br><span class="line"><span class="variable">%CLEAR_PATH%</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">%CLEAR_DIR%</span></span><br><span class="line"><span class="keyword">for</span> /r <span class="variable">%%i</span> <span class="keyword">in</span> (*.lastUpdated) <span class="keyword">do</span> <span class="built_in">del</span> <span class="variable">%%i</span></span><br><span class="line"><span class="built_in">ECHO</span>.OK </span><br><span class="line"><span class="built_in">PAUSE</span> </span><br><span class="line"><span class="keyword">GOTO</span> MENU </span><br><span class="line">:cmd2 </span><br><span class="line"><span class="built_in">ECHO</span>. æŸ¥çœ‹*.lastUpdatedæ–‡ä»¶</span><br><span class="line"><span class="variable">%CLEAR_PATH%</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">%CLEAR_DIR%</span></span><br><span class="line"><span class="keyword">for</span> /r <span class="variable">%%i</span> <span class="keyword">in</span> (*.lastUpdated) <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">%%i</span></span><br><span class="line"><span class="built_in">ECHO</span>.OK </span><br><span class="line"><span class="built_in">PAUSE</span> </span><br><span class="line"><span class="keyword">GOTO</span> MENU </span><br></pre></td></tr></table></figure><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021161615994.png" alt="image-20231021161615994"></p></li></ol><h3 id="Mavenå·¥ç¨‹Buildæ„å»ºé…ç½®"><a href="#Mavenå·¥ç¨‹Buildæ„å»ºé…ç½®" class="headerlink" title="Mavenå·¥ç¨‹Buildæ„å»ºé…ç½®"></a>Mavenå·¥ç¨‹Buildæ„å»ºé…ç½®</h3><p>é¡¹ç›®æ„å»ºæ˜¯æŒ‡å°†æºä»£ç ã€ä¾èµ–åº“å’Œèµ„æºæ–‡ä»¶ç­‰è½¬æ¢æˆå¯æ‰§è¡Œæˆ–å¯éƒ¨ç½²çš„åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­åŒ…æ‹¬ç¼–è¯‘æºä»£ç ã€é“¾æ¥ä¾èµ–åº“ã€æ‰“åŒ…å’Œéƒ¨ç½²ç­‰å¤šä¸ªæ­¥éª¤ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ„å»ºä¸éœ€è¦é¢å¤–é…ç½®ï¼Œéƒ½æœ‰å¯¹åº”çš„ç¼ºçœé…ç½®ã€‚å½“ç„¶äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨pom.xmlå®šåˆ¶ä¸€äº›é…ç½®ï¼Œæ¥ä¿®æ”¹é»˜è®¤æ„å»ºçš„è¡Œä¸ºå’Œäº§ç‰©ï¼</p><p>ä¾‹å¦‚ï¼š</p><ol><li>æŒ‡å®šæ„å»ºæ‰“åŒ…æ–‡ä»¶çš„åç§°ï¼Œéé»˜è®¤åç§°</li><li>åˆ¶å®šæ„å»ºæ‰“åŒ…æ—¶ï¼ŒæŒ‡å®šåŒ…å«æ–‡ä»¶æ ¼å¼å’Œæ’é™¤æ–‡ä»¶</li><li>æ‰“åŒ…æ’ä»¶ç‰ˆæœ¬è¿‡ä½ï¼Œé…ç½®æ›´é«˜ç‰ˆæœ¬æ’ä»¶</li></ol><p>æ„å»ºé…ç½®æ˜¯åœ¨pom.xml &#x2F; buildæ ‡ç­¾ä¸­æŒ‡å®šï¼</p><p><strong>æŒ‡å®šæ‰“åŒ…å‘½å</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é»˜è®¤çš„æ‰“åŒ…åç§°ï¼šartifactid+verson.æ‰“åŒ…æ–¹å¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>å®šä¹‰æ‰“åŒ…åç§°<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span>  </span><br></pre></td></tr></table></figure><p><strong>æŒ‡å®šæ‰“åŒ…æ–‡ä»¶</strong></p><p>å¦‚æœåœ¨javaæ–‡ä»¶å¤¹ä¸­æ·»åŠ javaç±»ï¼Œä¼šè‡ªåŠ¨æ‰“åŒ…ç¼–è¯‘åˆ°classesæ–‡ä»¶å¤¹ä¸‹ï¼</p><p>ä½†æ˜¯åœ¨javaæ–‡ä»¶å¤¹ä¸­æ·»åŠ xmlæ–‡ä»¶ï¼Œé»˜è®¤ä¸ä¼šè¢«æ‰“åŒ…ï¼</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§mavenå·¥ç¨‹ç»“æ„æ”¾ç½®çš„æ–‡ä»¶ä¼šé»˜è®¤è¢«ç¼–è¯‘å’Œæ‰“åŒ…ï¼</p><p>é™¤æ­¤ä¹‹å¤–ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨resourcesæ ‡ç­¾ï¼ŒæŒ‡å®šè¦æ‰“åŒ…èµ„æºçš„æ–‡ä»¶å¤¹è¦æŠŠå“ªäº›é™æ€èµ„æºæ‰“åŒ…åˆ° classesæ ¹ç›®å½•ä¸‹ï¼</p><p>åº”ç”¨åœºæ™¯ï¼šmybatisä¸­æœ‰æ—¶ä¼šå°†ç”¨äºç¼–å†™SQLè¯­å¥çš„æ˜ å°„æ–‡ä»¶å’Œmapperæ¥å£éƒ½å†™åœ¨src&#x2F;main&#x2F;javaä¸‹çš„æŸä¸ªåŒ…ä¸­ï¼Œæ­¤æ—¶æ˜ å°„æ–‡ä»¶å°±ä¸ä¼šè¢«æ‰“åŒ…ï¼Œå¦‚ä½•è§£å†³</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è®¾ç½®è¦æ‰“åŒ…çš„èµ„æºä½ç½®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--è®¾ç½®èµ„æºæ‰€åœ¨ç›®å½•--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--è®¾ç½®åŒ…å«çš„èµ„æºç±»å‹--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®ä¾èµ–æ’ä»¶</strong></p><p>dependenciesæ ‡ç­¾ä¸‹å¼•å…¥å¼€å‘éœ€è¦çš„jaråŒ…ï¼æˆ‘ä»¬å¯ä»¥åœ¨build&#x2F;plugins&#x2F;pluginæ ‡ç­¾å¼•å…¥æ’ä»¶ï¼</p><p>å¸¸ç”¨çš„æ’ä»¶ï¼šä¿®æ”¹jdkç‰ˆæœ¬ã€tomcatæ’ä»¶ã€mybatisåˆ†é¡µæ’ä»¶ã€mybatisé€†å‘å·¥ç¨‹æ’ä»¶ç­‰ç­‰ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- javaç¼–è¯‘æ’ä»¶ï¼Œé…jdkçš„ç¼–è¯‘ç‰ˆæœ¬ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- tomcatæ’ä»¶ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">port</span>&gt;</span>8090<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">uriEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">uriEncoding</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">server</span>&gt;</span>tomcat7<span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="Mavenä¾èµ–ä¼ é€’å’Œä¾èµ–å†²çª"><a href="#Mavenä¾èµ–ä¼ é€’å’Œä¾èµ–å†²çª" class="headerlink" title="Mavenä¾èµ–ä¼ é€’å’Œä¾èµ–å†²çª"></a>Mavenä¾èµ–ä¼ é€’å’Œä¾èµ–å†²çª</h1><h2 id="Mavenä¾èµ–ä¼ é€’ç‰¹æ€§"><a href="#Mavenä¾èµ–ä¼ é€’ç‰¹æ€§" class="headerlink" title="Mavenä¾èµ–ä¼ é€’ç‰¹æ€§"></a>Mavenä¾èµ–ä¼ é€’ç‰¹æ€§</h2><p><strong>æ¦‚å¿µ</strong></p><p>å‡å¦‚æœ‰Mavené¡¹ç›®Aï¼Œé¡¹ç›®Bä¾èµ–Aï¼Œé¡¹ç›®Cä¾èµ–Bã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯´ Cä¾èµ–Aã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¾èµ–çš„å…³ç³»ä¸ºï¼šCâ€”&gt;Bâ€”&gt;Aï¼Œ é‚£ä¹ˆæˆ‘ä»¬æ‰§è¡Œé¡¹ç›®Cæ—¶ï¼Œä¼šè‡ªåŠ¨æŠŠBã€Aéƒ½ä¸‹è½½å¯¼å…¥åˆ°Cé¡¹ç›®çš„jaråŒ…æ–‡ä»¶å¤¹ä¸­ï¼Œè¿™å°±æ˜¯ä¾èµ–çš„ä¼ é€’æ€§ã€‚</p><p><strong>ä½œç”¨</strong></p><ul><li>ç®€åŒ–ä¾èµ–å¯¼å…¥è¿‡ç¨‹</li><li>ç¡®ä¿ä¾èµ–ç‰ˆæœ¬æ­£ç¡®</li></ul><p><strong>ä¼ é€’çš„åŸåˆ™</strong></p><p>åœ¨ A ä¾èµ– Bï¼ŒB ä¾èµ– C çš„å‰æä¸‹ï¼ŒC æ˜¯å¦èƒ½å¤Ÿä¼ é€’åˆ° Aï¼Œå–å†³äº B ä¾èµ– C æ—¶ä½¿ç”¨çš„ä¾èµ–èŒƒå›´ä»¥åŠé…ç½®</p><ul><li><p>B ä¾èµ– C æ—¶ä½¿ç”¨ compile èŒƒå›´ï¼šå¯ä»¥ä¼ é€’</p></li><li><p>B ä¾èµ– C æ—¶ä½¿ç”¨ test æˆ– provided èŒƒå›´ï¼šä¸èƒ½ä¼ é€’ï¼Œæ‰€ä»¥éœ€è¦è¿™æ ·çš„ jar åŒ…æ—¶ï¼Œå°±å¿…é¡»åœ¨éœ€è¦çš„åœ°æ–¹æ˜ç¡®é…ç½®ä¾èµ–æ‰å¯ä»¥ã€‚</p></li><li><p>B ä¾èµ– C æ—¶ï¼Œè‹¥é…ç½®äº†ä»¥ä¸‹æ ‡ç­¾ï¼Œåˆ™ä¸èƒ½ä¼ é€’</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>ä¾èµ–ä¼ é€’ç»ˆæ­¢</strong></p><ul><li>écompileèŒƒå›´è¿›è¡Œä¾èµ–ä¼ é€’</li><li>ä½¿ç”¨optionalé…ç½®ç»ˆæ­¢ä¼ é€’</li><li>ä¾èµ–å†²çªï¼ˆä¼ é€’çš„ä¾èµ–å·²ç»å­˜åœ¨ï¼‰</li></ul><p><strong>æ¡ˆä¾‹ï¼šå¯¼å…¥jacksonä¾èµ–</strong></p><p>åˆ†æï¼šjacksonéœ€è¦ä¸‰ä¸ªä¾èµ–</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_9ViibmeAvU.png"></p><p>ä¾èµ–ä¼ é€’å…³ç³»ï¼šdata-bindä¸­ï¼Œä¾èµ–å…¶ä»–ä¸¤ä¸ªä¾èµ–</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_Wl0Lsj_BLk.png"></p><p>æœ€ä½³å¯¼å…¥ï¼šç›´æ¥å¯ä»¥å¯¼å…¥data-bindï¼Œè‡ªåŠ¨ä¾èµ–ä¼ é€’éœ€è¦çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-Mavenä¾èµ–å†²çªç‰¹æ€§"><a href="#2-Mavenä¾èµ–å†²çªç‰¹æ€§" class="headerlink" title="2. Mavenä¾èµ–å†²çªç‰¹æ€§"></a>2. Mavenä¾èµ–å†²çªç‰¹æ€§</h3><p>å½“ç›´æ¥å¼•ç”¨æˆ–è€…é—´æ¥å¼•ç”¨å‡ºç°äº†ç›¸åŒçš„jaråŒ…! è¿™æ—¶å‘¢ï¼Œä¸€ä¸ªé¡¹ç›®å°±ä¼šå‡ºç°ç›¸åŒçš„é‡å¤jaråŒ…ï¼Œè¿™å°±ç®—ä½œå†²çªï¼ä¾èµ–å†²çªé¿å…å‡ºç°é‡å¤ä¾èµ–ï¼Œå¹¶ä¸”ç»ˆæ­¢ä¾èµ–ä¼ é€’ï¼</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image_km7_szBRUw.png"></p><p>mavenè‡ªåŠ¨è§£å†³ä¾èµ–å†²çªé—®é¢˜èƒ½åŠ›ï¼Œä¼šæŒ‰ç…§è‡ªå·±çš„åŸåˆ™ï¼Œè¿›è¡Œé‡å¤ä¾èµ–é€‰æ‹©ã€‚åŒæ—¶ä¹Ÿæä¾›äº†æ‰‹åŠ¨è§£å†³çš„å†²çªçš„æ–¹å¼ï¼Œä¸è¿‡ä¸æ¨èï¼</p><p><strong>è§£å†³ä¾èµ–å†²çªï¼ˆå¦‚ä½•é€‰æ‹©é‡å¤ä¾èµ–ï¼‰æ–¹å¼ï¼š</strong></p><ol><li><p>è‡ªåŠ¨é€‰æ‹©åŸåˆ™</p><ul><li><p><strong>çŸ­è·¯ä¼˜å…ˆåŸåˆ™</strong>ï¼ˆç¬¬ä¸€åŸåˆ™ï¼‰</p><p>Aâ€”&gt;Bâ€”&gt;Câ€”&gt;Dâ€”&gt;Eâ€”&gt;X(version 0.0.1)</p><p>Aâ€”&gt;Fâ€”&gt;X(version 0.0.2)</p><p>åˆ™Aä¾èµ–äºX(version 0.0.2)ã€‚</p></li><li><p>ä¾èµ–è·¯å¾„é•¿åº¦ç›¸åŒæƒ…å†µä¸‹ï¼Œåˆ™â€œ<strong>å…ˆå£°æ˜ä¼˜å…ˆ</strong>â€ï¼ˆç¬¬äºŒåŸåˆ™ï¼‰</p><p>Aâ€”&gt;Eâ€”&gt;X(version 0.0.1)</p><p>Aâ€”&gt;Fâ€”&gt;X(version 0.0.2)</p><p>åœ¨&lt;depencies&gt;&lt;&#x2F;depencies&gt;ä¸­ï¼Œå…ˆå£°æ˜çš„ï¼Œè·¯å¾„ç›¸åŒï¼Œä¼šä¼˜å…ˆé€‰æ‹©ï¼</p></li></ul></li><li><p>æ‰‹åŠ¨æ’é™¤</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pro01-maven-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨excludesæ ‡ç­¾é…ç½®ä¾èµ–çš„æ’é™¤  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åœ¨excludeæ ‡ç­¾ä¸­é…ç½®ä¸€ä¸ªå…·ä½“çš„æ’é™¤ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- æŒ‡å®šè¦æ’é™¤çš„ä¾èµ–çš„åæ ‡ï¼ˆä¸éœ€è¦å†™versionï¼‰ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å°æ¡ˆä¾‹</p><p>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å‰æï¼š</span><br><span class="line">   A 1.1 -&gt; B 1.1 -&gt; C 1.1 </span><br><span class="line">   F 2.2 -&gt; B 2.2 </span><br><span class="line">   </span><br><span class="line">pomå£°æ˜ï¼š</span><br><span class="line">   F 2.2</span><br><span class="line">   A 1.1 </span><br></pre></td></tr></table></figure><p>è¯·é—®æœ€ç»ˆä¼šå¯¼å…¥å“ªäº›ä¾èµ–å’Œå¯¹åº”ç‰ˆæœ¬ï¼Ÿ</p></li></ol><h1 id="Mavenå·¥ç¨‹ç»§æ‰¿å’Œèšåˆå…³ç³»"><a href="#Mavenå·¥ç¨‹ç»§æ‰¿å’Œèšåˆå…³ç³»" class="headerlink" title="Mavenå·¥ç¨‹ç»§æ‰¿å’Œèšåˆå…³ç³»"></a>Mavenå·¥ç¨‹ç»§æ‰¿å’Œèšåˆå…³ç³»</h1><h2 id="Mavenå·¥ç¨‹ç»§æ‰¿å…³ç³»"><a href="#Mavenå·¥ç¨‹ç»§æ‰¿å…³ç³»" class="headerlink" title="Mavenå·¥ç¨‹ç»§æ‰¿å…³ç³»"></a>Mavenå·¥ç¨‹ç»§æ‰¿å…³ç³»</h2><ol><li><p>ç»§æ‰¿æ¦‚å¿µ</p><p>Maven ç»§æ‰¿æ˜¯æŒ‡åœ¨ Maven çš„é¡¹ç›®ä¸­ï¼Œè®©ä¸€ä¸ªé¡¹ç›®ä»å¦ä¸€ä¸ªé¡¹ç›®ä¸­ç»§æ‰¿é…ç½®ä¿¡æ¯çš„æœºåˆ¶ã€‚ç»§æ‰¿å¯ä»¥è®©æˆ‘ä»¬åœ¨å¤šä¸ªé¡¹ç›®ä¸­å…±äº«åŒä¸€é…ç½®ä¿¡æ¯ï¼Œç®€åŒ–é¡¹ç›®çš„ç®¡ç†å’Œç»´æŠ¤å·¥ä½œã€‚</p></li><li><p>ç»§æ‰¿ä½œç”¨</p><p>åœ¨çˆ¶å·¥ç¨‹ä¸­ç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¸­çš„ä¾èµ–ä¿¡æ¯ã€‚</p><p>å®ƒçš„èƒŒæ™¯æ˜¯ï¼š</p><ul><li>å¯¹ä¸€ä¸ªæ¯”è¾ƒå¤§å‹çš„é¡¹ç›®è¿›è¡Œäº†æ¨¡å—æ‹†åˆ†ã€‚</li><li>ä¸€ä¸ª project ä¸‹é¢ï¼Œåˆ›å»ºäº†å¾ˆå¤šä¸ª moduleã€‚</li><li>æ¯ä¸€ä¸ª module éƒ½éœ€è¦é…ç½®è‡ªå·±çš„ä¾èµ–ä¿¡æ¯ã€‚</li></ul><p>å®ƒèƒŒåçš„éœ€æ±‚æ˜¯ï¼š</p><ul><li>åœ¨æ¯ä¸€ä¸ª module ä¸­å„è‡ªç»´æŠ¤å„è‡ªçš„ä¾èµ–ä¿¡æ¯å¾ˆå®¹æ˜“å‘ç”Ÿå‡ºå…¥ï¼Œä¸æ˜“ç»Ÿä¸€ç®¡ç†ã€‚</li><li>ä½¿ç”¨åŒä¸€ä¸ªæ¡†æ¶å†…çš„ä¸åŒ jar åŒ…ï¼Œå®ƒä»¬åº”è¯¥æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥æ•´ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨çš„æ¡†æ¶ç‰ˆæœ¬éœ€è¦ç»Ÿä¸€ã€‚</li><li>ä½¿ç”¨æ¡†æ¶æ—¶æ‰€éœ€è¦çš„ jar åŒ…ç»„åˆï¼ˆæˆ–è€…è¯´ä¾èµ–ä¿¡æ¯ç»„åˆï¼‰éœ€è¦ç»è¿‡é•¿æœŸæ‘¸ç´¢å’Œåå¤è°ƒè¯•ï¼Œæœ€ç»ˆç¡®å®šä¸€ä¸ªå¯ç”¨ç»„åˆã€‚è¿™ä¸ªè€—è´¹å¾ˆå¤§ç²¾åŠ›æ€»ç»“å‡ºæ¥çš„æ–¹æ¡ˆä¸åº”è¯¥åœ¨æ–°çš„é¡¹ç›®ä¸­é‡æ–°æ‘¸ç´¢ã€‚<br>é€šè¿‡åœ¨çˆ¶å·¥ç¨‹ä¸­ä¸ºæ•´ä¸ªé¡¹ç›®ç»´æŠ¤ä¾èµ–ä¿¡æ¯çš„ç»„åˆæ—¢ä¿è¯äº†æ•´ä¸ªé¡¹ç›®ä½¿ç”¨è§„èŒƒã€å‡†ç¡®çš„ jar åŒ…ï¼›åˆèƒ½å¤Ÿå°†ä»¥å¾€çš„ç»éªŒæ²‰æ·€ä¸‹æ¥ï¼ŒèŠ‚çº¦æ—¶é—´å’Œç²¾åŠ›ã€‚</li></ul></li><li><p>ç»§æ‰¿è¯­æ³•</p><ul><li>çˆ¶å·¥ç¨‹<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pro03-maven-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å½“å‰å·¥ç¨‹ä½œä¸ºçˆ¶å·¥ç¨‹ï¼Œå®ƒè¦å»ç®¡ç†å­å·¥ç¨‹ï¼Œæ‰€ä»¥æ‰“åŒ…æ–¹å¼å¿…é¡»æ˜¯ pom --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">        </span><br></pre></td></tr></table></figure></li><li>å­å·¥ç¨‹<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨parentæ ‡ç­¾æŒ‡å®šå½“å‰å·¥ç¨‹çš„çˆ¶å·¥ç¨‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- çˆ¶å·¥ç¨‹çš„åæ ‡ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pro03-maven-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å­å·¥ç¨‹çš„åæ ‡ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¦‚æœå­å·¥ç¨‹åæ ‡ä¸­çš„groupIdå’Œversionä¸çˆ¶å·¥ç¨‹ä¸€è‡´ï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;groupId&gt;com.atguigu.maven&lt;/groupId&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pro04-maven-module<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; --&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>çˆ¶å·¥ç¨‹ä¾èµ–ç»Ÿä¸€ç®¡ç†</p><ul><li>çˆ¶å·¥ç¨‹å£°æ˜ç‰ˆæœ¬<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨dependencyManagementæ ‡ç­¾é…ç½®å¯¹ä¾èµ–çš„ç®¡ç† --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è¢«ç®¡ç†çš„ä¾èµ–å¹¶æ²¡æœ‰çœŸæ­£è¢«å¼•å…¥åˆ°å·¥ç¨‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>å­å·¥ç¨‹å¼•ç”¨ç‰ˆæœ¬<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å­å·¥ç¨‹å¼•ç”¨çˆ¶å·¥ç¨‹ä¸­çš„ä¾èµ–ä¿¡æ¯æ—¶ï¼Œå¯ä»¥æŠŠç‰ˆæœ¬å·å»æ‰ã€‚  --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æŠŠç‰ˆæœ¬å·å»æ‰å°±è¡¨ç¤ºå­å·¥ç¨‹ä¸­è¿™ä¸ªä¾èµ–çš„ç‰ˆæœ¬ç”±çˆ¶å·¥ç¨‹å†³å®šã€‚ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å…·ä½“æ¥è¯´æ˜¯ç”±çˆ¶å·¥ç¨‹çš„dependencyManagementæ¥å†³å®šã€‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="Mavenå·¥ç¨‹èšåˆå…³ç³»"><a href="#Mavenå·¥ç¨‹èšåˆå…³ç³»" class="headerlink" title="Mavenå·¥ç¨‹èšåˆå…³ç³»"></a>Mavenå·¥ç¨‹èšåˆå…³ç³»</h2><ol><li><p>èšåˆæ¦‚å¿µ</p><p>Maven èšåˆæ˜¯æŒ‡å°†å¤šä¸ªé¡¹ç›®ç»„ç»‡åˆ°ä¸€ä¸ªçˆ¶çº§é¡¹ç›®ä¸­ï¼Œä»¥ä¾¿ä¸€èµ·æ„å»ºå’Œç®¡ç†çš„æœºåˆ¶ã€‚èšåˆå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç®¡ç†ä¸€ç»„ç›¸å…³çš„å­é¡¹ç›®ï¼ŒåŒæ—¶ç®€åŒ–å®ƒä»¬çš„æ„å»ºå’Œéƒ¨ç½²è¿‡ç¨‹ã€‚</p></li><li><p>èšåˆä½œç”¨</p><ol><li>ç®¡ç†å¤šä¸ªå­é¡¹ç›®ï¼šé€šè¿‡èšåˆï¼Œå¯ä»¥å°†å¤šä¸ªå­é¡¹ç›®ç»„ç»‡åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ã€‚</li><li>æ„å»ºå’Œå‘å¸ƒä¸€ç»„ç›¸å…³çš„é¡¹ç›®ï¼šé€šè¿‡èšåˆï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå‘½ä»¤ä¸­æ„å»ºå’Œå‘å¸ƒå¤šä¸ªç›¸å…³çš„é¡¹ç›®ï¼Œç®€åŒ–äº†éƒ¨ç½²å’Œç»´æŠ¤å·¥ä½œã€‚</li><li>ä¼˜åŒ–æ„å»ºé¡ºåºï¼šé€šè¿‡èšåˆï¼Œå¯ä»¥å¯¹å¤šä¸ªé¡¹ç›®è¿›è¡Œé¡ºåºæ§åˆ¶ï¼Œé¿å…å‡ºç°æ„å»ºä¾èµ–æ··ä¹±å¯¼è‡´æ„å»ºå¤±è´¥çš„æƒ…å†µã€‚</li><li>ç»Ÿä¸€ç®¡ç†ä¾èµ–é¡¹ï¼šé€šè¿‡èšåˆï¼Œå¯ä»¥åœ¨çˆ¶é¡¹ç›®ä¸­ç®¡ç†å…¬å…±ä¾èµ–é¡¹å’Œæ’ä»¶ï¼Œé¿å…é‡å¤å®šä¹‰ã€‚</li></ol></li><li><p>èšåˆè¯­æ³•</p><p>çˆ¶é¡¹ç›®ä¸­åŒ…å«çš„å­é¡¹ç›®åˆ—è¡¨ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>parent-project<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>child-project1<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>child-project2<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>èšåˆæ¼”ç¤º</p><p>é€šè¿‡è§¦å‘çˆ¶å·¥ç¨‹æ„å»ºå‘½ä»¤ã€å¼•å‘æ‰€æœ‰å­æ¨¡å—æ„å»ºï¼äº§ç”Ÿååº”å †ï¼</p></li></ol><h1 id="Mavenç§æœ"><a href="#Mavenç§æœ" class="headerlink" title="Mavenç§æœ"></a>Mavenç§æœ</h1><h2 id="Mavenç§æœç®€ä»‹"><a href="#Mavenç§æœç®€ä»‹" class="headerlink" title="Mavenç§æœç®€ä»‹"></a>Mavenç§æœç®€ä»‹</h2><p>â‘ ç§æœç®€ä»‹</p><p>Maven ç§æœæ˜¯ä¸€ç§ç‰¹æ®Šçš„Mavenè¿œç¨‹ä»“åº“ï¼Œå®ƒæ˜¯æ¶è®¾åœ¨å±€åŸŸç½‘å†…çš„ä»“åº“æœåŠ¡ï¼Œç”¨æ¥ä»£ç†ä½äºå¤–éƒ¨çš„è¿œç¨‹ä»“åº“ï¼ˆä¸­å¤®ä»“åº“ã€å…¶ä»–è¿œç¨‹å…¬å…±ä»“åº“ï¼‰ã€‚</p><blockquote><p>å½“ç„¶ä¹Ÿå¹¶ä¸æ˜¯è¯´ç§æœåªèƒ½å»ºç«‹åœ¨å±€åŸŸç½‘ï¼Œä¹Ÿæœ‰å¾ˆå¤šå…¬å¸ä¼šç›´æ¥æŠŠç§æœéƒ¨ç½²åˆ°å…¬ç½‘ï¼Œå…·ä½“è¿˜æ˜¯å¾—çœ‹å…¬å¸ä¸šåŠ¡çš„æ€§è´¨æ˜¯å¦æ˜¯ä¿å¯†çš„ç­‰ç­‰ï¼Œå› ä¸ºå±€åŸŸç½‘çš„è¯åªèƒ½åœ¨å…¬å¸ç”¨ï¼Œéƒ¨ç½²åˆ°å…¬ç½‘çš„è¯å‘˜å·¥åœ¨å®¶é‡Œä¹Ÿå¯ä»¥åŠå…¬ä½¿ç”¨ã€‚</p></blockquote><p>å»ºç«‹äº† Maven ç§æœåï¼Œå½“å±€åŸŸç½‘å†…çš„ç”¨æˆ·éœ€è¦æŸä¸ªæ„ä»¶æ—¶ï¼Œä¼šæŒ‰ç…§å¦‚ä¸‹é¡ºåºè¿›è¡Œè¯·æ±‚å’Œä¸‹è½½ã€‚</p><p>è¯·æ±‚æœ¬åœ°ä»“åº“ï¼Œè‹¥æœ¬åœ°ä»“åº“ä¸å­˜åœ¨æ‰€éœ€æ„ä»¶ï¼Œåˆ™è·³è½¬åˆ°ç¬¬ 2 æ­¥ï¼›<br>è¯·æ±‚ Maven ç§æœï¼Œå°†æ‰€éœ€æ„ä»¶ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ï¼Œè‹¥ç§æœä¸­ä¸å­˜åœ¨æ‰€éœ€æ„ä»¶ï¼Œåˆ™è·³è½¬åˆ°ç¬¬ 3 æ­¥ã€‚<br>è¯·æ±‚å¤–éƒ¨çš„è¿œç¨‹ä»“åº“ï¼Œå°†æ‰€éœ€æ„ä»¶ä¸‹è½½å¹¶ç¼“å­˜åˆ° Maven ç§æœï¼Œè‹¥å¤–éƒ¨è¿œç¨‹ä»“åº“ä¸å­˜åœ¨æ‰€éœ€æ„ä»¶ï¼Œåˆ™ Maven ç›´æ¥æŠ¥é”™ã€‚</p><p>æ­¤å¤–ï¼Œä¸€äº›æ— æ³•ä»å¤–éƒ¨ä»“åº“ä¸‹è½½åˆ°çš„æ„ä»¶ï¼Œä¹Ÿèƒ½ä»æœ¬åœ°ä¸Šä¼ åˆ°ç§æœä¾›å…¶ä»–äººä½¿ç”¨ã€‚</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231021164631791.png" alt="image-20231021164631791"></p><p>â‘¡Mavenç§æœçš„ä¼˜åŠ¿</p><ol><li><p>èŠ‚çœå¤–ç½‘å¸¦å®½<br>æ¶ˆé™¤å¯¹å¤–éƒ¨è¿œç¨‹ä»“åº“çš„å¤§é‡é‡å¤è¯·æ±‚ï¼ˆä¼šæ¶ˆè€—å¾ˆå¤§é‡çš„å¸¦å®½ï¼‰ï¼Œé™ä½å¤–ç½‘å¸¦å®½å‹åŠ›ã€‚</p></li><li><p>ä¸‹è½½é€Ÿåº¦æ›´å¿«<br>Mavenç§æœä½äºå±€åŸŸç½‘å†…ï¼Œä»ç§æœä¸‹è½½æ„å»ºæ›´å¿«æ›´ç¨³å®šã€‚</p></li><li><p>ä¾¿äºéƒ¨ç½²ç¬¬ä¸‰æ–¹æ„ä»¶<br>æœ‰äº›æ„ä»¶æ— æ³•ä»ä»»ä½•ä¸€ä¸ªè¿œç¨‹ä»“åº“ä¸­è·å¾—ï¼ˆå¦‚ï¼šå…¬å¸æˆ–ç»„ç»‡å†…éƒ¨çš„ç§æœ‰æ„ä»¶ã€Oracleçš„JDBCé©±åŠ¨ç­‰ï¼‰ï¼Œå»ºç«‹ç§æœä¹‹åï¼Œå°±å¯ä»¥å°†è¿™äº›æ„ä»¶éƒ¨ç½²åˆ°ç§æœä¸­ï¼Œä¾›å†…éƒ¨Mavené¡¹ç›®ä½¿ç”¨ã€‚</p></li><li><p>æé«˜é¡¹ç›®çš„ç¨³å®šæ€§ï¼Œå¢å¼ºå¯¹é¡¹ç›®çš„æ§åˆ¶<br>å¦‚æœä¸å»ºç«‹ç§æœï¼Œé‚£ä¹ˆMavené¡¹ç›®çš„æ„ä»¶å°±é«˜åº¦ä¾èµ–å¤–éƒ¨çš„è¿œç¨‹ä»“åº“ï¼Œè‹¥å¤–éƒ¨ç½‘ç»œä¸ç¨³å®šï¼Œåˆ™é¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ä¹Ÿä¼šå˜å¾—ä¸ç¨³å®šã€‚å»ºç«‹ç§æœåï¼Œå³ä½¿å¤–éƒ¨ç½‘ç»œçŠ¶å†µä¸ä½³ç”šè‡³ä¸­æ–­ï¼Œåªè¦ç§æœä¸­å·²ç»ç¼“å­˜äº†æ‰€éœ€çš„æ„ä»¶ï¼ŒMavenä¹Ÿèƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚ç§æœè½¯ä»¶ï¼ˆå¦‚ï¼šNexusï¼‰æä¾›äº†å¾ˆå¤šæ§åˆ¶åŠŸèƒ½ï¼ˆå¦‚ï¼šæƒé™ç®¡ç†ã€RELEASE&#x2F;SNAPSHOTç‰ˆæœ¬æ§åˆ¶ç­‰ï¼‰ï¼Œå¯ä»¥å¯¹ä»“åº“è¿›è¡Œä¸€äº›æ›´åŠ é«˜çº§çš„æ§åˆ¶ã€‚</p></li><li><p>é™ä½ä¸­å¤®ä»“åº“å¾—è´Ÿè·å‹åŠ›<br>ç”±äºç§æœä¼šç¼“å­˜ä¸­å¤®ä»“åº“å¾—æ„ä»¶ï¼Œé¿å…äº†å¾ˆå¤šå¯¹ä¸­å¤®ä»“åº“çš„é‡å¤ä¸‹è½½ï¼Œé™ä½äº†ä¸­å¤®ä»“åº“çš„è´Ÿè·ã€‚</p></li></ol><p>â‘¢å¸¸è§çš„Mavenç§æœäº§å“</p><ol><li>Apacheçš„Archiva</li><li>JFrogçš„Artifactory</li><li>Sonatypeçš„Nexusï¼ˆ[ËˆneksÉ™s]ï¼‰ï¼ˆå½“å‰æœ€æµè¡Œã€ä½¿ç”¨æœ€å¹¿æ³›ï¼‰</li></ol><h2 id="Nexusä¸‹è½½å®‰è£…"><a href="#Nexusä¸‹è½½å®‰è£…" class="headerlink" title="Nexusä¸‹è½½å®‰è£…"></a>Nexusä¸‹è½½å®‰è£…</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://help.sonatype.com/repomanager3/product-information/download">https://help.sonatype.com/repomanager3/product-information/download</a></p><p>è§£å‹ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€CMDï¼Œè¿›å…¥binç›®å½•ä¸‹ï¼Œæ‰§è¡Œ.&#x2F;nexus &#x2F;runå‘½ä»¤å¯åŠ¨</p><p>è®¿é—® Nexus é¦–é¡µ</p><p>é¦–é¡µåœ°å€ï¼š<a href="http://localhost:8081/%EF%BC%8C8081%E4%B8%BA%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3%E5%8F%B7">http://localhost:8081/ï¼Œ8081ä¸ºé»˜è®¤ç«¯å£å·</a></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img001.612496a3.png" alt="images"></p><h2 id="åˆå§‹è®¾ç½®"><a href="#åˆå§‹è®¾ç½®" class="headerlink" title="åˆå§‹è®¾ç½®"></a>åˆå§‹è®¾ç½®</h2><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img002.e1ac8197.png" alt="images"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031171116756.png" alt="image-20231031171116756"></p><p>è¿™é‡Œå‚è€ƒæç¤ºï¼š</p><ul><li>ç”¨æˆ·åï¼šadmin</li><li>å¯†ç ï¼šæŸ¥çœ‹ <strong>E:\Server\nexus-3.61.0-02-win64\sonatype-work\nexus3\admin.password</strong> æ–‡ä»¶</li></ul><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031171242874.png" alt="image-20231031171242874"></p><p>ç»§ç»­æ‰§è¡Œåˆå§‹åŒ–ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img005.4b81e5ab.png" alt="images"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img006.43ebb0ac.png" alt="images"></p><p>åŒ¿åç™»å½•ï¼Œå¯ç”¨è¿˜æ˜¯ç¦ç”¨ï¼Ÿç”±äºå¯ç”¨åŒ¿åç™»å½•åï¼Œåç»­æ“ä½œæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºç¦ç”¨åŒ¿åç™»å½•çš„æ“ä½œï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031171607378.png" alt="image-20231031171607378"></p><p>åˆå§‹åŒ–å®Œæ¯•ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031171708085.png" alt="image-20231031171708085"></p><h2 id="Nexusä¸Šçš„å„ç§ä»“åº“"><a href="#Nexusä¸Šçš„å„ç§ä»“åº“" class="headerlink" title="Nexusä¸Šçš„å„ç§ä»“åº“"></a>Nexusä¸Šçš„å„ç§ä»“åº“</h2><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img009.7f737ed7.png" alt="images"></p><table><thead><tr><th>ä»“åº“ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>proxy</td><td>æŸä¸ªè¿œç¨‹ä»“åº“çš„ä»£ç†</td></tr><tr><td>group</td><td>å­˜æ”¾ï¼šé€šè¿‡ Nexus è·å–çš„ç¬¬ä¸‰æ–¹ jar åŒ…</td></tr><tr><td>hosted</td><td>å­˜æ”¾ï¼šæœ¬å›¢é˜Ÿå…¶ä»–å¼€å‘äººå‘˜éƒ¨ç½²åˆ° Nexus çš„ jar åŒ…</td></tr></tbody></table><table><thead><tr><th>ä»“åº“åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>maven-central</td><td>Nexus å¯¹ Maven ä¸­å¤®ä»“åº“çš„ä»£ç†</td></tr><tr><td>maven-public</td><td>Nexus é»˜è®¤åˆ›å»ºï¼Œä¾›å¼€å‘äººå‘˜ä¸‹è½½ä½¿ç”¨çš„ç»„ä»“åº“</td></tr><tr><td>maven-releases</td><td>Nexus é»˜è®¤åˆ›å»ºï¼Œä¾›å¼€å‘äººå‘˜éƒ¨ç½²è‡ªå·± jar åŒ…çš„å®¿ä¸»ä»“åº“ è¦æ±‚ releases ç‰ˆæœ¬</td></tr><tr><td>maven-snapshots</td><td>Nexus é»˜è®¤åˆ›å»ºï¼Œä¾›å¼€å‘äººå‘˜éƒ¨ç½²è‡ªå·± jar åŒ…çš„å®¿ä¸»ä»“åº“ è¦æ±‚ snapshots ç‰ˆæœ¬</td></tr></tbody></table><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œè¿™å‡ ä¸ªä»“åº“éƒ½æ²¡æœ‰å†…å®¹ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img010.e3573d0b.png" alt="images"></p><h2 id="é€šè¿‡-Nexus-ä¸‹è½½-jar-åŒ…"><a href="#é€šè¿‡-Nexus-ä¸‹è½½-jar-åŒ…" class="headerlink" title="é€šè¿‡ Nexus ä¸‹è½½ jar åŒ…"></a>é€šè¿‡ Nexus ä¸‹è½½ jar åŒ…</h2><p>ä¿®æ”¹æœ¬åœ°mavençš„æ ¸å¿ƒé…ç½®æ–‡ä»¶settings.xmlï¼Œè®¾ç½®æ–°çš„æœ¬åœ°ä»“åº“åœ°å€</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ä¸€ä¸ªæ–°çš„ Maven æœ¬åœ°ä»“åº“ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:/maven-repository-new<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠæˆ‘ä»¬åŸæ¥é…ç½®é˜¿é‡Œäº‘ä»“åº“åœ°å€çš„ mirror æ ‡ç­¾æ”¹æˆä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-mine<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus mine<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ url æ ‡ç­¾æ˜¯è¿™ä¹ˆæ¥çš„ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img012.5a3b1f11.png" alt="images"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031172137288.png" alt="image-20231031172137288"></p><p>æŠŠä¸Šå›¾ä¸­çœ‹åˆ°çš„åœ°å€å¤åˆ¶å‡ºæ¥å³å¯ã€‚å¦‚æœæˆ‘ä»¬åœ¨å‰é¢å…è®¸äº†åŒ¿åè®¿é—®ï¼Œåˆ°è¿™é‡Œå°±å¤Ÿäº†ã€‚ä½†å¦‚æœæˆ‘ä»¬ç¦ç”¨äº†åŒ¿åè®¿é—®ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¿˜è¦ç»§ç»­é…ç½® settings.xmlï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-mine<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">password</span>&gt;</span>atguigu<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦<strong>æ ¼å¤–æ³¨æ„</strong>ï¼šserver æ ‡ç­¾å†…çš„ id æ ‡ç­¾å€¼å¿…é¡»å’Œ mirror æ ‡ç­¾ä¸­çš„ id å€¼ä¸€æ ·ã€‚</p><p>æ‰¾ä¸€ä¸ªç”¨åˆ°æ¡†æ¶çš„ Maven å·¥ç¨‹ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean compile</span><br></pre></td></tr></table></figure><p>ä¸‹è½½è¿‡ç¨‹æ—¥å¿—ï¼š</p><blockquote><p>Downloading from nexus-mine: <a href="http://localhost:8081/repository/maven-public/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.pom">http://localhost:8081/repository/maven-public/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.pom</a><br>Downloaded from nexus-mine: <a href="http://localhost:8081/repository/maven-public/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.pom">http://localhost:8081/repository/maven-public/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.pom</a> (2.6 kB at 110 kB&#x2F;s)<br>Downloading from nexus-mine: <a href="http://localhost:8081/repository/maven-public/net/minidev/json-smart/2.3/json-smart-2.3.pom">http://localhost:8081/repository/maven-public/net/minidev/json-smart/2.3/json-smart-2.3.pom</a><br>Downloaded from nexus-mine: <a href="http://localhost:8081/repository/maven-public/net/minidev/json-smart/2.3/json-smart-2.3.pom">http://localhost:8081/repository/maven-public/net/minidev/json-smart/2.3/json-smart-2.3.pom</a> (9.0 kB at 376 kB&#x2F;s)<br>Downloading from nexus-mine: <a href="http://localhost:8081/repository/maven-public/net/minidev/minidev-parent/2.3/minidev-parent-2.3.pom">http://localhost:8081/repository/maven-public/net/minidev/minidev-parent/2.3/minidev-parent-2.3.pom</a><br>Downloaded from nexus-mine: <a href="http://localhost:8081/repository/maven-public/net/minidev/minidev-parent/2.3/minidev-parent-2.3.pom">http://localhost:8081/repository/maven-public/net/minidev/minidev-parent/2.3/minidev-parent-2.3.pom</a> (8.5 kB at 404 kB&#x2F;s)<br>Downloading from nexus-mine: <a href="http://localhost:8081/repository/maven-public/net/minidev/accessors-smart/1.2/accessors-smart-1.2.pom">http://localhost:8081/repository/maven-public/net/minidev/accessors-smart/1.2/accessors-smart-1.2.pom</a><br>Downloaded from nexus-mine: <a href="http://localhost:8081/repository/maven-public/net/minidev/accessors-smart/1.2/accessors-smart-1.2.pom">http://localhost:8081/repository/maven-public/net/minidev/accessors-smart/1.2/accessors-smart-1.2.pom</a> (12 kB at 463 kB&#x2F;s)</p></blockquote><p>ä¸‹è½½åï¼ŒNexus æœåŠ¡å™¨ä¸Šå°±æœ‰äº† jar åŒ…ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img014.cc0e87c3.png" alt="images"></p><p>è‹¥ä¸‹è½½é€Ÿåº¦å¤ªæ…¢ï¼Œå¯ä»¥è®¾ç½®ç§æœä¸­ä¸­å¤®ä»“åº“çš„åœ°å€ä¸ºé˜¿é‡Œäº‘ä»“åº“åœ°å€</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031175035345.png" alt="image-20231031175035345"></p><p>ä¿®æ”¹ä¸ºï¼š<a href="http://maven.aliyun.com/nexus/content/groups/public/">http://maven.aliyun.com/nexus/content/groups/public/</a></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231031175134745.png" alt="image-20231031175134745"></p><h2 id="å°†-jar-åŒ…éƒ¨ç½²åˆ°-Nexus"><a href="#å°†-jar-åŒ…éƒ¨ç½²åˆ°-Nexus" class="headerlink" title="å°† jar åŒ…éƒ¨ç½²åˆ° Nexus"></a>å°† jar åŒ…éƒ¨ç½²åˆ° Nexus</h2><p>mavenå·¥ç¨‹ä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-mine<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus Snapshot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/maven-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè¿™é‡Œ snapshotRepository çš„ id æ ‡ç­¾å¿…é¡»å’Œ settings.xml ä¸­æŒ‡å®šçš„ mirror æ ‡ç­¾çš„ id å±æ€§ä¸€è‡´ã€‚</p><p>æ‰§è¡Œéƒ¨ç½²å‘½ä»¤ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn deploy</span><br></pre></td></tr></table></figure><blockquote><p>Uploading to nexus-mine: <a href="http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/1.0-SNAPSHOT/maven-metadata.xml">http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/1.0-SNAPSHOT/maven-metadata.xml</a><br>Uploaded to nexus-mine: <a href="http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/1.0-SNAPSHOT/maven-metadata.xml">http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/1.0-SNAPSHOT/maven-metadata.xml</a> (786 B at 19 kB&#x2F;s)<br>Uploading to nexus-mine: <a href="http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/maven-metadata.xml">http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/maven-metadata.xml</a><br>Uploaded to nexus-mine: <a href="http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/maven-metadata.xml">http://localhost:8081/repository/maven-snapshots/com/atguigu/demo/demo07-redis-data-provider/maven-metadata.xml</a> (300 B at 6.5 kB&#x2F;s)<br>[INFO] â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>[INFO] Reactor Summary:<br>[INFO]<br>[INFO] demo-imperial-court-ms-show 1.0-SNAPSHOT â€¦â€¦â€¦.. SUCCESS [ 1.875 s]<br>[INFO] demo09-base-entity â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ SUCCESS [ 21.883 s]<br>[INFO] demo10-base-util â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. SUCCESS [ 0.324 s]<br>[INFO] demo08-base-api â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ SUCCESS [ 1.171 s]<br>[INFO] demo01-imperial-court-gateway â€¦â€¦â€¦â€¦â€¦â€¦â€¦. SUCCESS [ 0.403 s]<br>[INFO] demo02-user-auth-center â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. SUCCESS [ 2.932 s]<br>[INFO] demo03-emp-manager-center â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. SUCCESS [ 0.312 s]<br>[INFO] demo04-memorials-manager-center â€¦â€¦â€¦â€¦â€¦â€¦.. SUCCESS [ 0.362 s]<br>[INFO] demo05-working-manager-center â€¦â€¦â€¦â€¦â€¦â€¦â€¦. SUCCESS [ 0.371 s]<br>[INFO] demo06-mysql-data-provider â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. SUCCESS [ 6.779 s]<br>[INFO] demo07-redis-data-provider 1.0-SNAPSHOT â€¦â€¦â€¦â€¦ SUCCESS [ 0.273 s]</p></blockquote><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/img015.b413af9d.png" alt="images"></p><h2 id="å¼•ç”¨åˆ«äººéƒ¨ç½²çš„-jar-åŒ…"><a href="#å¼•ç”¨åˆ«äººéƒ¨ç½²çš„-jar-åŒ…" class="headerlink" title="å¼•ç”¨åˆ«äººéƒ¨ç½²çš„ jar åŒ…"></a>å¼•ç”¨åˆ«äººéƒ¨ç½²çš„ jar åŒ…</h2><p>mavenå·¥ç¨‹ä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-mine<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>nexus-mine<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/maven-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="Mavenç»¼åˆæ¡ˆä¾‹"><a href="#Mavenç»¼åˆæ¡ˆä¾‹" class="headerlink" title="Mavenç»¼åˆæ¡ˆä¾‹"></a>Mavenç»¼åˆæ¡ˆä¾‹</h1><h2 id="é¡¹ç›®éœ€æ±‚å’Œç»“æ„åˆ†æ"><a href="#é¡¹ç›®éœ€æ±‚å’Œç»“æ„åˆ†æ" class="headerlink" title="é¡¹ç›®éœ€æ±‚å’Œç»“æ„åˆ†æ"></a>é¡¹ç›®éœ€æ±‚å’Œç»“æ„åˆ†æ</h2><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image123.png" alt="img"></p><p>éœ€æ±‚æ¡ˆä¾‹ï¼šæ­å»ºä¸€ä¸ªç”µå•†å¹³å°é¡¹ç›®ï¼Œè¯¥å¹³å°åŒ…æ‹¬ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ã€é€šç”¨å·¥å…·æ¨¡å—ç­‰ã€‚</p><p>é¡¹ç›®æ¶æ„ï¼š</p><ol><li>ç”¨æˆ·æœåŠ¡ï¼šè´Ÿè´£å¤„ç†ç”¨æˆ·ç›¸å…³çš„é€»è¾‘ï¼Œä¾‹å¦‚ç”¨æˆ·ä¿¡æ¯çš„ç®¡ç†ã€ç”¨æˆ·æ³¨å†Œã€ç™»å½•ç­‰ã€‚<ul><li>spring-context 6.0.6 </li><li>spring-core 6.0.6</li><li>spring-beans 6.0.6</li><li>common-service</li></ul></li><li>è®¢å•æœåŠ¡ï¼šè´Ÿè´£å¤„ç†è®¢å•ç›¸å…³çš„é€»è¾‘ï¼Œä¾‹å¦‚è®¢å•çš„åˆ›å»ºã€è®¢å•æ”¯ä»˜ã€é€€è´§ã€è®¢å•æŸ¥çœ‹ç­‰ã€‚<ul><li>spring-context 6.0.6 </li><li>spring-core 6.0.6</li><li>spring-beans 6.0.6</li><li>spring-security 6.0.6</li><li>common-service</li></ul></li><li>é€šç”¨æ¨¡å—ï¼šè´Ÿè´£å­˜å‚¨å…¶ä»–æœåŠ¡éœ€è¦é€šç”¨å·¥å…·ç±»ï¼Œå…¶ä»–æœåŠ¡ä¾èµ–æ­¤æ¨¡å—ã€‚<ul><li>commons-io 2.11.0</li><li>junit 5.9.2</li></ul></li></ol><h2 id="é¡¹ç›®æ­å»ºå’Œç»Ÿä¸€æ„å»º"><a href="#é¡¹ç›®æ­å»ºå’Œç»Ÿä¸€æ„å»º" class="headerlink" title="é¡¹ç›®æ­å»ºå’Œç»Ÿä¸€æ„å»º"></a>é¡¹ç›®æ­å»ºå’Œç»Ÿä¸€æ„å»º</h2><h3 id="â‘ çˆ¶æ¨¡å—-micro-shop"><a href="#â‘ çˆ¶æ¨¡å—-micro-shop" class="headerlink" title="â‘ çˆ¶æ¨¡å— (micro-shop)"></a>â‘ çˆ¶æ¨¡å— (micro-shop)</h3><p>åˆ›å»ºå·¥ç¨‹ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023112630117.png" alt="image-20231023112630117"></p><p>pom.xmlé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micro-shop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--çŸ¥è¯†ç‚¹ï¼šçˆ¶å·¥ç¨‹çš„æ‰“åŒ…æ–¹å¼ä¸ºpom--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>6.0.6<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jackson.version</span>&gt;</span>2.15.0<span class="tag">&lt;/<span class="name">jackson.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commons.version</span>&gt;</span>2.11.0<span class="tag">&lt;/<span class="name">commons.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">junit.version</span>&gt;</span>5.9.2<span class="tag">&lt;/<span class="name">junit.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä¾èµ–ç®¡ç† --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- spring-contextä¼šä¾èµ–ä¼ é€’core/beans --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- jackson-databindä¼šä¾èµ–ä¼ é€’core/annotations --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- commons-io --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;commons.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ç»Ÿä¸€æ›´æ–°å­å·¥ç¨‹æ‰“åŒ…æ’ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- jdk17 å’Œ waråŒ…ç‰ˆæœ¬æ’ä»¶ä¸åŒ¹é… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯é€‰æ“ä½œï¼šåˆ é™¤srcç›®å½•</p><h3 id="â‘¡é€šç”¨æ¨¡å—-common-service"><a href="#â‘¡é€šç”¨æ¨¡å—-common-service" class="headerlink" title="â‘¡é€šç”¨æ¨¡å— (common-service)"></a>â‘¡é€šç”¨æ¨¡å— (common-service)</h3><p>åˆ›å»ºå·¥ç¨‹ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023114531521.png" alt="image-20231023114531521"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023114649705.png" alt="image-20231023114649705"></p><p>pom.xmlé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micro-shop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--çŸ¥è¯†ç‚¹ï¼šæ‰“åŒ…æ–¹å¼é»˜è®¤å°±æ˜¯jarï¼Œå› æ­¤å¯ä»¥çœç•¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®spring-contextï¼Œç»§æ‰¿çˆ¶å·¥ç¨‹ç‰ˆæœ¬ï¼Œè‡ªåŠ¨ä¼ é€’ core / beans --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®jackson-databindï¼Œç»§æ‰¿çˆ¶å·¥ç¨‹ç‰ˆæœ¬ï¼Œè‡ªåŠ¨ä¼ é€’ core / annotations --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®commons-ioï¼Œç»§æ‰¿çˆ¶å·¥ç¨‹ç‰ˆæœ¬ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®junitï¼Œç»§æ‰¿çˆ¶å·¥ç¨‹ç‰ˆæœ¬ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="â‘¢ç”¨æˆ·æ¨¡å—-user-service"><a href="#â‘¢ç”¨æˆ·æ¨¡å—-user-service" class="headerlink" title="â‘¢ç”¨æˆ·æ¨¡å— (user-service)"></a>â‘¢ç”¨æˆ·æ¨¡å— (user-service)</h3><p>åˆ›å»ºå·¥ç¨‹ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023115404302.png" alt="image-20231023115404302"></p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023115707282.png" alt="image-20231023115707282"></p><p>pom.xmlé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micro-shop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>user-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- webå·¥ç¨‹æ‰“åŒ…æ–¹å¼ä¸ºwar --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®common-serviceï¼Œæ‰€éœ€ä¾èµ–ä¼šä¼ é€’åˆ°å½“å‰å·¥ç¨‹ï¼ˆä»…é™compileèŒƒå›´ï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¾èµ–ä¼ é€’ç»“æœï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023120621402.png" alt="image-20231023120621402"></p><h3 id="â‘£è®¢å•æ¨¡å—-order-service"><a href="#â‘£è®¢å•æ¨¡å—-order-service" class="headerlink" title="â‘£è®¢å•æ¨¡å— (order-service)"></a>â‘£è®¢å•æ¨¡å— (order-service)</h3><p>åˆ›å»ºå·¥ç¨‹ï¼Œå¹¶ä½¿ç”¨æ’ä»¶è½¬ä¸ºwebå·¥ç¨‹ï¼š</p><p><img src="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/image-20231023120733029.png" alt="image-20231023120733029"></p><p>pom.xmlé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micro-shop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>order-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- webå·¥ç¨‹æ‰“åŒ…æ–¹å¼ä¸ºwar --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®common-serviceï¼Œæ‰€éœ€ä¾èµ–ä¼šä¼ é€’åˆ°å½“å‰å·¥ç¨‹ï¼ˆä»…é™compileèŒƒå›´ï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼ŒæŸ¥çœ‹çˆ¶å·¥ç¨‹çš„pom.xmlï¼Œä¼šå‘ç°å…¶ä¸­å·²ç»è‡ªåŠ¨èšåˆäº†å­å·¥ç¨‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>common-service<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>user-service<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>order-service<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChainä½¿ç”¨ä¹‹Chains</title>
      <link href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/"/>
      <url>/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/</url>
      
        <content type="html"><![CDATA[<h1 id="Chainsçš„åŸºæœ¬ä½¿ç”¨"><a href="#Chainsçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Chainsçš„åŸºæœ¬ä½¿ç”¨"></a>Chainsçš„åŸºæœ¬ä½¿ç”¨</h1><h2 id="Chainçš„åŸºæœ¬æ¦‚å¿µ"><a href="#Chainçš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="Chainçš„åŸºæœ¬æ¦‚å¿µ"></a>Chainçš„åŸºæœ¬æ¦‚å¿µ</h2><p>Chainï¼šé“¾ï¼Œç”¨äºå°†å¤šä¸ªç»„ä»¶ï¼ˆæç¤ºæ¨¡æ¿ã€LLMæ¨¡å‹ã€è®°å¿†ã€å·¥å…·ç­‰ï¼‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆå¯å¤ç”¨çš„<strong>å·¥ä½œæµ</strong>ï¼Œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚</p><p><strong>Chain çš„æ ¸å¿ƒæ€æƒ³</strong>æ˜¯é€šè¿‡ç»„åˆä¸åŒçš„æ¨¡å—åŒ–å•å…ƒï¼Œå®ç°æ¯”å•ä¸€ç»„ä»¶æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼š </p><ul><li>å°†LLMä¸ Prompt Template ï¼ˆæç¤ºæ¨¡æ¿ï¼‰ç»“åˆ </li><li>å°†LLMä¸ è¾“å‡ºè§£æå™¨ç»“åˆ </li><li>å°†LLMä¸ å¤–éƒ¨æ•°æ®ç»“åˆï¼Œä¾‹å¦‚ç”¨äºé—®ç­” </li><li>å°†LLMä¸ é•¿æœŸè®°å¿†ç»“åˆï¼Œä¾‹å¦‚ç”¨äºèŠå¤©å†å²è®°å½• </li><li>é€šè¿‡å°† <strong>ç¬¬ä¸€ä¸ªLLM çš„è¾“å‡º</strong>ä½œä¸º<strong>ç¬¬äºŒä¸ªLLM çš„è¾“å…¥</strong>ï¼Œâ€¦ï¼Œå°†å¤šä¸ªLLMæŒ‰é¡ºåºç»“åˆåœ¨ä¸€èµ·</li></ul><h2 id="LCEL-åŠå…¶åŸºæœ¬æ„æˆ"><a href="#LCEL-åŠå…¶åŸºæœ¬æ„æˆ" class="headerlink" title="LCEL åŠå…¶åŸºæœ¬æ„æˆ"></a>LCEL åŠå…¶åŸºæœ¬æ„æˆ</h2><p>ä½¿ç”¨LCELï¼Œå¯ä»¥æ„é€ å‡ºç»“æ„æœ€ç®€å•çš„Chainã€‚</p><p>LangChainè¡¨è¾¾å¼è¯­è¨€ï¼ˆLCELï¼ŒLangChain Expression Languageï¼‰æ˜¯ä¸€ç§å£°æ˜å¼æ–¹æ³•ï¼Œå¯ä»¥è½»æ¾åœ° å°†å¤šä¸ªç»„ä»¶é“¾æ¥æˆ AI å·¥ä½œæµã€‚å®ƒé€šè¿‡PythonåŸç”Ÿæ“ä½œç¬¦ï¼ˆå¦‚ç®¡é“ç¬¦|ï¼‰å°†ç»„ä»¶è¿æ¥æˆå¯æ‰§è¡Œæµç¨‹ï¼Œæ˜¾ è‘—ç®€åŒ–äº†AIåº”ç”¨çš„å¼€å‘ã€‚ </p><p><strong>LCELçš„åŸºæœ¬æ„æˆ</strong>ï¼šæç¤ºï¼ˆPromptï¼‰+ æ¨¡å‹ï¼ˆModelï¼‰+ è¾“å‡ºè§£æå™¨ï¼ˆOutputParserï¼‰</p><p>å³ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨è¿™ä¸ªé“¾æ¡ä¸­ï¼Œç”¨æˆ·è¾“å…¥è¢«ä¼ é€’ç»™æç¤ºæ¨¡æ¿ï¼Œç„¶åæç¤ºæ¨¡æ¿çš„è¾“å‡ºè¢«ä¼ é€’ç»™æ¨¡å‹ï¼Œç„¶åæ¨¡å‹çš„è¾“å‡ºè¢«ä¼  é€’ç»™è¾“å‡ºè§£æå™¨ã€‚ </span></span><br><span class="line">chain = prompt | model | output_parser </span><br><span class="line">chain.invoke(&#123; <span class="string">&quot;input&quot;</span> : <span class="string">&quot;What&#x27;s your name?&quot;</span> &#125;)</span><br></pre></td></tr></table></figure><ul><li><strong>Prompt</strong>ï¼šPrompt æ˜¯ä¸€ä¸ª BasePromptTemplateï¼Œè¿™æ„å‘³ç€å®ƒæ¥å—ä¸€ä¸ªæ¨¡æ¿å˜é‡çš„å­—å…¸å¹¶ç”Ÿæˆä¸€ ä¸ªPromptValue ã€‚PromptValue å¯ä»¥ä¼ é€’ç»™ LLMï¼ˆå®ƒä»¥å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼‰æˆ– ChatModelï¼ˆå®ƒä»¥ æ¶ˆæ¯åºåˆ—ä½œä¸ºè¾“å…¥ï¼‰ã€‚ </li><li><strong>Model</strong>ï¼šå°† PromptValue ä¼ é€’ç»™ modelã€‚å¦‚æœæˆ‘ä»¬çš„ model æ˜¯ä¸€ä¸ª ChatModelï¼Œè¿™æ„å‘³ç€å®ƒ å°†è¾“å‡ºä¸€ä¸ª<code>BaseMessage</code>ã€‚ </li><li><strong>OutputParser</strong>ï¼šå°† model çš„è¾“å‡ºä¼ é€’ç»™ output_parserï¼Œå®ƒæ˜¯ä¸€ä¸ª BaseOutputParserï¼Œæ„å‘³ç€ å®ƒå¯ä»¥æ¥å—å­—ç¬¦ä¸²æˆ– BaseMessage ä½œä¸ºè¾“å…¥ã€‚ </li><li><strong>chain</strong>ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>|</code> è¿ç®—ç¬¦è½»æ¾åˆ›å»ºè¿™ä¸ªChainã€‚<code>|</code> è¿ç®—ç¬¦åœ¨ LangChain ä¸­ç”¨äºå°†ä¸¤ä¸ª å…ƒç´ ç»„åˆåœ¨ä¸€èµ·ã€‚ </li><li><strong>invoke</strong>ï¼šæ‰€æœ‰LCELå¯¹è±¡éƒ½å®ç°äº† Runnable åè®®ï¼Œä¿è¯ä¸€è‡´çš„è°ƒç”¨æ–¹å¼ ï¼ˆ<code>invoke</code>&#x2F; <code>batch</code> &#x2F; <code>stream</code> ï¼‰</li></ul><p>| ç¬¦å·ç±»ä¼¼äº shell â¾¥â¾¯ç®¡é“æ“ä½œç¬¦ï¼Œå®ƒå°†ä¸åŒçš„ç»„ä»¶é“¾æ¥åœ¨â¼€èµ·ï¼Œå°†å‰â¼€ä¸ªç»„ä»¶çš„è¾“å‡ºä½œä¸ºä¸‹â¼€ ä¸ªç»„ä»¶çš„è¾“â¼Šï¼Œè¿™å°±å½¢æˆäº†â¼€ä¸ª AI â¼¯ä½œæµã€‚</p><h2 id="Runnable"><a href="#Runnable" class="headerlink" title="Runnable"></a>Runnable</h2><p>Runnableæ˜¯LangChainå®šä¹‰çš„ä¸€ä¸ªæŠ½è±¡æ¥å£ï¼ˆProtocolï¼‰ï¼Œå®ƒ <strong>å¼ºåˆ¶è¦æ±‚</strong>æ‰€æœ‰LCELç»„ä»¶å®ç°ä¸€ç»„æ ‡å‡†æ–¹ æ³•ï¼š<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/file-20251010164747842.png" alt="500"><br>ä»»ä½•å®ç°äº†è¿™äº›æ–¹æ³•çš„å¯¹è±¡éƒ½è¢«è§†ä¸ºLCELå…¼å®¹ç»„ä»¶ã€‚æ¯”å¦‚ï¼šèŠå¤©æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿ã€è¾“å‡ºè§£æå™¨ã€æ£€ç´¢ å™¨ã€ä»£ç†(æ™ºèƒ½ä½“)ç­‰ã€‚<br>æ¯ä¸ª LCEL å¯¹è±¡éƒ½å®ç°äº† Runnable æ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰äº†ä¸€ç»„å…¬å…±çš„è°ƒç”¨æ–¹æ³•ã€‚è¿™ä½¿å¾— LCEL å¯¹è±¡é“¾ä¹Ÿ è‡ªåŠ¨æ”¯æŒè¿™äº›è°ƒç”¨æˆä¸ºå¯èƒ½ã€‚</p><p><strong>2ã€ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€è°ƒç”¨æ–¹å¼ï¼Ÿ</strong> </p><p>ä¼ ç»Ÿé—®é¢˜ å‡è®¾æ²¡æœ‰ç»Ÿä¸€åè®®ï¼š</p><ul><li>æç¤ºè¯æ¸²æŸ“ç”¨ .format() </li><li>æ¨¡å‹è°ƒç”¨ç”¨ .generate() </li><li>è§£æå™¨è§£æç”¨ .parse() </li><li>å·¥å…·è°ƒç”¨ç”¨ .run()</li></ul><p>ä»£ç ä¼šå˜æˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">prompt_text = prompt.<span class="built_in">format</span>(topic= <span class="string">&quot;çŒ«&quot;</span> ) <span class="comment"># æ–¹æ³•1 </span></span><br><span class="line">model_out = model.generate(prompt_text) <span class="comment"># æ–¹æ³•2 </span></span><br><span class="line">result = parser.parse(model_out) <span class="comment"># æ–¹æ³•3</span></span><br></pre></td></tr></table></figure><p><strong>ç—›ç‚¹</strong>ï¼šæ¯ä¸ªç»„ä»¶è°ƒç”¨æ–¹å¼ä¸åŒï¼Œç»„åˆæ—¶éœ€è¦æ‰‹åŠ¨é€‚é…ã€‚</p><p><strong>3ã€LCELè§£å†³æ–¹æ¡ˆ</strong><br>é€šè¿‡ <strong>Runnable</strong> åè®®ç»Ÿä¸€ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ï¼ˆåˆ†æ­¥è°ƒç”¨ï¼‰ </span></span><br><span class="line">prompt_text = prompt.invoke(&#123; <span class="string">&quot;topic&quot;</span> : <span class="string">&quot;çŒ«&quot;</span> &#125;) <span class="comment"># æ–¹æ³•1 </span></span><br><span class="line">model_out = model.invoke(prompt_text) <span class="comment"># æ–¹æ³•2 </span></span><br><span class="line">result = parser.invoke(model_out) <span class="comment"># æ–¹æ³•3 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ï¼ˆLCELç®¡é“å¼ï¼‰ </span></span><br><span class="line">chain = prompt | model | parser <span class="comment"># ç”¨ç®¡é“ç¬¦ç»„åˆ </span></span><br><span class="line">result = chain.invoke(&#123; <span class="string">&quot;topic&quot;</span> : <span class="string">&quot;çŒ«&quot;</span> &#125;) <span class="comment"># æ‰€æœ‰ç»„ä»¶ç»Ÿä¸€ç”¨invoke</span></span><br></pre></td></tr></table></figure><ul><li>ä¸€è‡´æ€§ï¼šæ— è®ºç»„ä»¶çš„åŠŸèƒ½å¤šå¤æ‚ï¼ˆæ¨¡å‹&#x2F;æç¤ºè¯&#x2F;å·¥å…·ï¼‰ï¼Œè°ƒç”¨æ–¹å¼å®Œå…¨ç›¸åŒ </li><li>ç»„åˆæ€§ï¼šç®¡é“æ“ä½œç¬¦ | èƒŒåè‡ªåŠ¨å¤„ç†ç±»å‹åŒ¹é…å’Œä¸­é—´ç»“æœä¼ é€’</li></ul><h2 id="ä½¿ç”¨ä¸¾ä¾‹"><a href="#ä½¿ç”¨ä¸¾ä¾‹" class="headerlink" title="ä½¿ç”¨ä¸¾ä¾‹"></a>ä½¿ç”¨ä¸¾ä¾‹</h2><p>ä¸¾ä¾‹1ï¼š<br>æƒ…å†µ1ï¼šæ²¡æœ‰ä½¿ç”¨chain</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼•å…¥ä¾èµ–åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">joke_query = <span class="string">&quot;å‘Šè¯‰æˆ‘ä¸€ä¸ªç¬‘è¯ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰Jsonè§£æå™¨  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä»¥PromptTemplateä¸ºä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢\n æ»¡è¶³çš„æ ¼å¼ä¸º&#123;format_instructions&#125;\n é—®é¢˜ä¸º&#123;question&#125;\n&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;format_instructions&quot;</span>: parser.get_format_instructions()&#125;,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt = prompt_template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: joke_query&#125;)  </span><br><span class="line">response = chat_model.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line">  </span><br><span class="line">json_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;```json\n&#123;\n  &quot;joke&quot;: &quot;ä¸ºä»€ä¹ˆæµ·æ´‹æ€»æ˜¯é‚£ä¹ˆè“ï¼Ÿå› ä¸ºé±¼å„¿ä»¬åœ¨æ°´é‡Œæ€»æ˜¯å“­ï¼&quot;\n&#125;\n```&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 32, <span class="string">&#x27;prompt_tokens&#x27;</span>: 32, <span class="string">&#x27;total_tokens&#x27;</span>: 64, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-CATaTzK9DXqSMbOaqYFiF7UAzlOwL&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--a05306ba-4a1e-420d-abe9-b9a45ee65b75-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 32, <span class="string">&#x27;output_tokens&#x27;</span>: 32, <span class="string">&#x27;total_tokens&#x27;</span>: 64, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;</span><br><span class="line">&#123;<span class="string">&#x27;joke&#x27;</span>: <span class="string">&#x27;ä¸ºä»€ä¹ˆæµ·æ´‹æ€»æ˜¯é‚£ä¹ˆè“ï¼Ÿå› ä¸ºé±¼å„¿ä»¬åœ¨æ°´é‡Œæ€»æ˜¯å“­ï¼&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>æƒ…å†µ2ï¼šä½¿ç”¨chainï¼šå°†æç¤ºæ¨¡æ¿ã€æ¨¡å‹ã€è§£æå™¨é“¾æ¥åœ¨ä¸€èµ·ã€‚ä½¿ç”¨LCELå°†ä¸åŒçš„ç»„ä»¶ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„ é“¾æ¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼•å…¥ä¾èµ–åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">joke_query = <span class="string">&quot;å‘Šè¯‰æˆ‘ä¸€ä¸ªç¬‘è¯ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰Jsonè§£æå™¨  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä»¥PromptTemplateä¸ºä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢\n æ»¡è¶³çš„æ ¼å¼ä¸º&#123;format_instructions&#125;\n é—®é¢˜ä¸º&#123;question&#125;\n&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;format_instructions&quot;</span>: parser.get_format_instructions()&#125;,  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># å†™æ³•1ï¼š  </span></span><br><span class="line"><span class="comment"># prompt = prompt_template.invoke(input=&#123;&quot;question&quot;:joke_query&#125;)  </span></span><br><span class="line"><span class="comment"># response = chat_model.invoke(prompt)  </span></span><br><span class="line"><span class="comment"># json_result = parser.invoke(response)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­£ç¡®çš„å†™æ³•  </span></span><br><span class="line">chain = prompt_template | chat_model | parser  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é”™è¯¯çš„å†™æ³•  </span></span><br><span class="line"><span class="comment"># chain =  chat_model |  prompt_template | parser  </span></span><br><span class="line">json_result = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: joke_query&#125;)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;joke&#x27;</span>: <span class="string">&#x27;ä¸ºä»€ä¹ˆç¨‹åºå‘˜æ€»æ˜¯æ··æ·†åœ£è¯èŠ‚å’Œä¸‡åœ£èŠ‚ï¼Ÿå› ä¸º Oct 31 == Dec 25!&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¼ ç»ŸChainçš„ä½¿ç”¨"><a href="#ä¼ ç»ŸChainçš„ä½¿ç”¨" class="headerlink" title="ä¼ ç»ŸChainçš„ä½¿ç”¨"></a>ä¼ ç»ŸChainçš„ä½¿ç”¨</h1><h2 id="åŸºç¡€é“¾ï¼šLLMChain"><a href="#åŸºç¡€é“¾ï¼šLLMChain" class="headerlink" title="åŸºç¡€é“¾ï¼šLLMChain"></a>åŸºç¡€é“¾ï¼šLLMChain</h2><h3 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h3><p>LCELä¹‹å‰ï¼Œæœ€åŸºç¡€ä¹Ÿæœ€å¸¸è§çš„é“¾ç±»å‹æ˜¯LLMChainã€‚<br><strong>è¿™ä¸ªé“¾è‡³å°‘åŒ…æ‹¬ä¸€ä¸ªæç¤ºè¯æ¨¡æ¿ï¼ˆPromptTemplateï¼‰ï¼Œä¸€ä¸ªè¯­è¨€æ¨¡å‹ï¼ˆLLM æˆ–èŠå¤©æ¨¡å‹ï¼‰ã€‚</strong></p><blockquote><p>[!notice]<br>æ³¨æ„ï¼šLLMChain was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use <code>prompt | llm</code> insteadã€‚</p></blockquote><p>ç‰¹ç‚¹ï¼š </p><ul><li>ç”¨äº <strong>å•æ¬¡é—®ç­”</strong>ï¼Œè¾“å…¥ä¸€ä¸ª Promptï¼Œè¾“å‡º LLM çš„å“åº”ã€‚ </li><li>é€‚åˆ <strong>æ— ä¸Šä¸‹æ–‡</strong> çš„ç®€å•ä»»åŠ¡ï¼ˆå¦‚ç¿»è¯‘ã€æ‘˜è¦ã€åˆ†ç±»ç­‰ï¼‰ã€‚ </li><li><strong>æ— è®°å¿†</strong>ï¼šæ— æ³•è‡ªåŠ¨ç»´æŠ¤èŠå¤©å†å²</li></ul><h3 id="ä¸»è¦æ­¥éª¤"><a href="#ä¸»è¦æ­¥éª¤" class="headerlink" title="ä¸»è¦æ­¥éª¤"></a>ä¸»è¦æ­¥éª¤</h3><ol><li><strong>é…ç½®ä»»åŠ¡é“¾</strong>ï¼šä½¿ç”¨LLMChainç±»å°†ä»»åŠ¡ä¸æç¤ºè¯ç»“åˆï¼Œå½¢æˆå®Œæ•´çš„ä»»åŠ¡é“¾ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chain = LLMChain(llm = llm, prompt = prompt_template)</span><br></pre></td></tr></table></figure></li><li>æ‰§è¡Œä»»åŠ¡é“¾ï¼šä½¿ç”¨invoke()ç­‰æ–¹æ³•æ‰§è¡Œä»»åŠ¡é“¾ï¼Œå¹¶è·å–ç”Ÿæˆç»“æœã€‚å¯ä»¥æ ¹æ®éœ€è¦å¯¹è¾“å‡ºè¿›è¡Œå¤„ç†å’Œå±• ç¤ºã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = chain.invoke(...) </span><br><span class="line"><span class="built_in">print</span> (result)</span><br></pre></td></tr></table></figure></li></ol><h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ•´ç†å¦‚ä¸‹ï¼š</p><table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>llm</td><td>Union[Runnable[LanguageModelInput, str], Runnable[LanguageModelInput, BaseMessage]]</td><td>-</td><td>æ˜¯</td><td>è¦è°ƒç”¨çš„è¯­è¨€æ¨¡å‹</td></tr><tr><td><strong>prompt</strong></td><td>BasePromptTemplate</td><td>-</td><td>æ˜¯</td><td>è¦ä½¿ç”¨çš„æç¤ºå¯¹è±¡</td></tr><tr><td><strong>verbose</strong></td><td>bool</td><td>False</td><td>å¦</td><td><strong>æ˜¯å¦ä»¥è¯¦ç»†æ¨¡å¼è¿è¡Œ</strong>ã€‚åœ¨è¯¦ç»†æ¨¡å¼ ä¸‹ï¼Œä¸€äº›ä¸­é—´æ—¥å¿—å°†è¢«æ‰“å°åˆ°æ§åˆ¶ å°ã€‚é»˜è®¤ä½¿ç”¨å…¨å±€è¯¦ç»†è®¾ç½®ï¼Œå¯é€š è¿‡ langchain.globals.get_verbose() è®¿é—®</td></tr><tr><td>callback_manager</td><td>Optional[BaseCallbackManager]</td><td>None</td><td>å¦</td><td>ã€å·²å¼ƒç”¨ã€‘è¯·æ”¹ç”¨callbacksã€‚</td></tr><tr><td>callbacks</td><td>Callbacks</td><td>None</td><td>å¦</td><td>å¯é€‰çš„å›è°ƒå¤„ç†å™¨åˆ—è¡¨æˆ–å›è°ƒç®¡ç† å™¨ã€‚åœ¨è°ƒç”¨é“¾çš„ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸åŒ é˜¶æ®µè¢«è°ƒç”¨ï¼Œä»on_chain_startå¼€ å§‹ï¼Œåˆ°on_chain_endæˆ– on_chain_errorç»“æŸã€‚è‡ªå®šä¹‰é“¾å¯ ä»¥é€‰æ‹©è°ƒç”¨é¢å¤–çš„å›è°ƒæ–¹æ³•ã€‚è¯¦è§ å›è°ƒæ–‡æ¡£</td></tr><tr><td>llm_kwargs</td><td>dict</td><td>-</td><td>å¦</td><td>è¯­è¨€æ¨¡å‹çš„å…³é”®å­—å‚æ•°å­—å…¸</td></tr><tr><td><strong>memory</strong></td><td>Optional[BaseMemory]</td><td>None</td><td>å¦</td><td><strong>å¯é€‰çš„è®°å¿†å¯¹è±¡</strong>ã€‚é»˜è®¤ä¸ºNoneã€‚ è®°å¿†æ˜¯ä¸€ä¸ªåœ¨æ¯ä¸ªé“¾çš„å¼€å§‹å’Œç»“æŸ æ—¶è¢«è°ƒç”¨çš„ç±»ã€‚å¼€å§‹æ—¶ï¼Œè®°å¿†åŠ è½½ å˜é‡å¹¶åœ¨é“¾ä¸­ä¼ é€’ã€‚ç»“æŸæ—¶ï¼Œå®ƒä¿ å­˜ä»»ä½•è¿”å›çš„å˜é‡ã€‚æœ‰è®¸å¤šä¸åŒç±» å‹çš„å†…å­˜ï¼Œè¯·æŸ¥çœ‹å†…å­˜æ–‡æ¡£è·å–å®Œ æ•´ç›®å½•</td></tr><tr><td>metadata</td><td>Optional[Dict[str, Any]]</td><td>None</td><td>å¦</td><td>ä¸é“¾ç›¸å…³è”çš„å¯é€‰å…ƒæ•°æ®ã€‚é»˜è®¤ä¸º Noneã€‚è¿™äº›å…ƒæ•°æ®å°†ä¸è°ƒç”¨æ­¤é“¾ çš„æ¯æ¬¡è°ƒç”¨ç›¸å…³è”ï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼  é€’ç»™callbacksä¸­å®šä¹‰çš„å¤„ç†ç¨‹ åºã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›æ¥è¯†åˆ«é“¾çš„ç‰¹ å®šå®ä¾‹åŠå…¶ç”¨ä¾‹</td></tr><tr><td><strong>output_parser</strong></td><td>BaseLLMOutputParser</td><td>-</td><td>å¦</td><td><strong>è¦ä½¿ç”¨çš„è¾“å‡ºè§£æå™¨</strong>ã€‚é»˜è®¤ä¸º StrOutputParser</td></tr><tr><td>return_final_only</td><td>bool</td><td>True</td><td>å¦</td><td>æ˜¯å¦åªè¿”å›æœ€ç»ˆè§£æç»“æœã€‚é»˜è®¤ä¸º Trueã€‚å¦‚æœä¸ºFalseï¼Œå°†è¿”å›å…³äº ç”Ÿæˆçš„é¢å¤–ä¿¡æ¯ã€‚</td></tr><tr><td>tags</td><td>Optional[List[str]]</td><td>None</td><td>å¦</td><td>ä¸é“¾ç›¸å…³è”çš„å¯é€‰æ ‡ç­¾åˆ—è¡¨ã€‚é»˜è®¤ ä¸ºNoneã€‚è¿™äº›æ ‡ç­¾å°†ä¸è°ƒç”¨æ­¤é“¾ çš„æ¯æ¬¡è°ƒç”¨ç›¸å…³è”ï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼  é€’ç»™callbacksä¸­å®šä¹‰çš„å¤„ç†ç¨‹ åºã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›æ¥è¯†åˆ«é“¾çš„ç‰¹ å®šå®ä¾‹åŠå…¶ç”¨ä¾‹</td></tr></tbody></table><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> modulefinder <span class="keyword">import</span> replacePackageMap  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.sequential <span class="keyword">import</span> SimpleSequentialChain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line"><span class="comment"># BasePromptTemplateçš„å…¸å‹å­ç±»æœ‰ï¼šPrompTemplateã€ChatPromptTemplate  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦é«˜æ‰‹ï¼Œå¸®æˆ‘è§£å†³å¦‚ä¸‹çš„æ•°å­¦é—®é¢˜ï¼š&#123;question&#125;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chain = LLMChain(llm=chat_model, prompt=prompt_template, )  </span><br><span class="line">response = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ?&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;question&#x27;</span>: <span class="string">&#x27;1 + 2 * 3 = ?&#x27;</span>, <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;æ ¹æ®æ•°å­¦è¿ç®—çš„ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è¿›è¡Œä¹˜æ³•è¿ç®—ï¼Œç„¶åå†è¿›è¡ŒåŠ æ³•è¿ç®—ã€‚\n\næ‰€ä»¥ï¼Œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n1 + 2 * 3 = 1 + 6 = 7\n\nå› æ­¤ï¼Œ1 + 2 * 3 = 7ã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šä½¿ç”¨ChatPromptTemplateåŠå‚æ•°verboseçš„æ¼”ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate, ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line"><span class="comment"># BasePromptTemplateçš„å…¸å‹å­ç±»æœ‰ï¼šPrompTemplateã€ChatPromptTemplate  </span></span><br><span class="line">prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦é«˜æ‰‹&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;å¸®æˆ‘è§£å†³å¦‚ä¸‹çš„æ•°å­¦é—®é¢˜ï¼š&#123;question&#125;&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">chain = LLMChain(  </span><br><span class="line">    llm=chat_model,  </span><br><span class="line">    prompt=prompt_template,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  <span class="comment">#æ˜¾å¼æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¯¦ç»†æ—¥å¿—æƒ…å†µ  </span></span><br><span class="line">)  </span><br><span class="line">response = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ?&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ æ˜¯ä¸€ä¸ªæ•°å­¦é«˜æ‰‹</span><br><span class="line">Human: å¸®æˆ‘è§£å†³å¦‚ä¸‹çš„æ•°å­¦é—®é¢˜ï¼š1 + 2 * 3 = ?[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;question&#x27;</span>: <span class="string">&#x27;1 + 2 * 3 = ?&#x27;</span>, <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;æ ¹æ®æ•°å­¦è¿ç®—çš„ä¼˜å…ˆçº§ï¼Œå…ˆè¿›è¡Œä¹˜æ³•å†è¿›è¡ŒåŠ æ³•ã€‚å› æ­¤æˆ‘ä»¬å…ˆè®¡ç®— \\( 2 * 3 \\)ï¼Œå¾—åˆ° \\( 6 \\)ã€‚ç„¶åå†è¿›è¡ŒåŠ æ³•ï¼š\n\n\\[ \n1 + 6 = 7 \n\\]\n\næ‰€ä»¥ \\( 1 + 2 * 3 = 7 \\)ã€‚&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¡¥å……è¯´æ˜ï¼šè°ƒç”¨æ–¹æ³•é™¤äº†invoke()å¤–ï¼Œè¿˜æœ‰run()ã€predict()ã€å®ä¾‹æ–¹æ³•ç­‰ï¼Œæ•ˆæœä¸invoke()ç›¸åŒï¼Œè¿™é‡Œ ä¸å†ä»‹ç»ã€‚</p><h2 id="é¡ºåºé“¾ä¹‹-SimpleSequentialChain"><a href="#é¡ºåºé“¾ä¹‹-SimpleSequentialChain" class="headerlink" title="é¡ºåºé“¾ä¹‹ SimpleSequentialChain"></a>é¡ºåºé“¾ä¹‹ SimpleSequentialChain</h2><p>é¡ºåºé“¾ï¼ˆSequentialChainï¼‰å…è®¸å°†å¤šä¸ªé“¾é¡ºåºè¿æ¥èµ·æ¥ï¼Œæ¯ä¸ªChainçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªChainçš„è¾“å…¥ï¼Œ å½¢æˆç‰¹å®šåœºæ™¯çš„æµæ°´çº¿ï¼ˆPipelineï¼‰ã€‚</p><p><strong>é¡ºåºé“¾æœ‰ä¸¤ç§ç±»å‹</strong>ï¼š </p><ul><li>å•ä¸ªè¾“å…¥&#x2F;è¾“å‡ºï¼šå¯¹åº”ç€ SimpleSequentialChain </li><li>å¤šä¸ªè¾“å…¥&#x2F;è¾“å‡ºï¼šå¯¹åº”ç€ï¼šSequentialChain</li></ul><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>SimpleSequentialChainï¼šæœ€ç®€å•çš„é¡ºåºé“¾ï¼Œå¤šä¸ªé“¾ ä¸²è”æ‰§è¡Œ ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æœ‰ å•ä¸€çš„è¾“å…¥å’Œè¾“å‡ºï¼Œä¸€ ä¸ªæ­¥éª¤çš„è¾“å‡ºå°±æ˜¯ä¸‹ä¸€ä¸ªæ­¥éª¤çš„è¾“å…¥ï¼Œæ— éœ€æ‰‹åŠ¨æ˜ å°„<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/file-20251013092712319.png"></p><h3 id="ä½¿ç”¨ä¸¾ä¾‹-1"><a href="#ä½¿ç”¨ä¸¾ä¾‹-1" class="headerlink" title="ä½¿ç”¨ä¸¾ä¾‹"></a>ä½¿ç”¨ä¸¾ä¾‹</h3><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain  </span><br><span class="line">  </span><br><span class="line">chainA_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ å°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼š&#123;knowledge&#125;&quot;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chainA_chains = LLMChain(llm=chat_model,  </span><br><span class="line">                         prompt=chainA_template,  </span><br><span class="line">                         verbose=<span class="literal">True</span>  </span><br><span class="line">                         )  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># chainA_chains.invoke(&#123;&quot;knowledge&quot;:&quot;ä»€ä¹ˆæ˜¯LangChainï¼Ÿ&quot;&#125;)</span></span><br></pre></td></tr></table></figure><p>ç»§ç»­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line">chainB_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®çš„å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼š&#123;description&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨20ä¸ªå­—ä»¥å†…&quot;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chainB_chains = LLMChain(llm=chat_model,  </span><br><span class="line">                         prompt=chainB_template,  </span><br><span class="line">                         verbose=<span class="literal">True</span>  </span><br><span class="line">                         )</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.sequential <span class="keyword">import</span> SimpleSequentialChain  </span><br><span class="line">  </span><br><span class="line">full_chain = SimpleSequentialChain(  </span><br><span class="line">    chains=[chainA_chains, chainB_chains],  </span><br><span class="line">    verbose=<span class="literal">True</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šé’ˆå¯¹äºSimpleSequentialChainè€Œè¨€ï¼Œå”¯ä¸€çš„è¾“å…¥çš„å˜é‡åæ˜¯ï¼šinput  </span></span><br><span class="line">response = full_chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä»€ä¹ˆæ˜¯LangChain?&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SimpleSequentialChain chain...[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ</span><br><span class="line">Human: è¯·ä½ å°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼šä»€ä¹ˆæ˜¯LangChain?[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">[36;1m[1;3mLangChain æ˜¯ä¸€ä¸ªå¼€æºçš„æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLM, Large Language Modelsï¼‰å’Œå…¶ä»– AI ç»„ä»¶çš„åº”ç”¨ç¨‹åºã€‚LangChain çš„è®¾è®¡åˆè¡·æ˜¯é€šè¿‡æä¾›ä¸°å¯Œçš„å·¥å…·å’Œç»“æ„ï¼Œç®€åŒ–ä¸è¯­è¨€æ¨¡å‹çš„æ•´åˆå’Œåº”ç”¨å¼€å‘è¿‡ç¨‹ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°æ„å»ºå¤æ‚çš„ NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰åº”ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„æ ¸å¿ƒæ¦‚å¿µ</span></span><br><span class="line"></span><br><span class="line">1. **é“¾ï¼ˆChainsï¼‰**ï¼š</span><br><span class="line">   LangChain çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯â€œé“¾â€ï¼Œå³å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œæˆ–ç»„ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚æ¯ä¸ªé“¾å¯ä»¥æ˜¯ç®€å•çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤æ‚çš„ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»ã€‚é“¾å¯ä»¥åŒ…æ‹¬æŸ¥è¯¢ã€è½¬æ¢ã€éªŒè¯ç­‰å¤šä¸ªæ­¥éª¤ã€‚</span><br><span class="line"></span><br><span class="line">2. **ä»£ç†ï¼ˆAgentsï¼‰**ï¼š</span><br><span class="line">   ä»£ç†æ˜¯ä¸€ç§å¯åŠ¨æ€å†³å®šå…¶è¡Œä¸ºå’Œè·¯å¾„çš„ç»“æ„ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªè¯­è¨€æ¨¡å‹æ¥ç†è§£ç”¨æˆ·è¾“å…¥ï¼Œå¹¶é€‰æ‹©æœ€åˆé€‚çš„è¡ŒåŠ¨ã€‚ä»£ç†é€šå¸¸åœ¨éœ€è¦å®æ—¶å†³ç­–çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸ç”¨æˆ·çš„å¯¹è¯ã€‚</span><br><span class="line"></span><br><span class="line">3. **å†…å­˜ï¼ˆMemoryï¼‰**ï¼š</span><br><span class="line">   LangChain æä¾›äº†å†…å­˜ç®¡ç†åŠŸèƒ½ï¼Œå…è®¸åº”ç”¨åœ¨ä¸åŒçš„ä¼šè¯ä¸­ä¿ç•™ç”¨æˆ·çš„ä¸Šä¸‹æ–‡å’Œå†å²ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—å¯¹è¯ç³»ç»Ÿèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ç”¨æˆ·çš„éœ€æ±‚å’Œåå¥½ã€‚</span><br><span class="line"></span><br><span class="line">4. **å·¥å…·ï¼ˆToolsï¼‰**ï¼š</span><br><span class="line">   LangChain æ”¯æŒå°†å¤–éƒ¨å·¥å…·å’Œ API é›†æˆåˆ°é“¾æˆ–ä»£ç†ä¸­ï¼Œä½¿å¾—è¯­è¨€æ¨¡å‹èƒ½å¤Ÿè¿›è¡Œé€»è¾‘æ¨ç†ã€æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨ web æœåŠ¡ç­‰ã€å¹¶å¤„ç†æ›´å¤æ‚çš„ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">5. **æ–‡æ¡£ï¼ˆDocumentsï¼‰**ï¼š</span><br><span class="line">   æ–‡æ¡£å¤„ç†æ˜¯ LangChain å¦ä¸€ä¸ªé‡è¦åŠŸèƒ½ã€‚åœ¨éœ€è¦å¤„ç†å¤§é‡æ–‡æœ¬ä¿¡æ¯çš„åœºæ™¯ä¸‹ï¼ŒLangChain æä¾›äº†æ–‡æ¡£æ£€ç´¢å’Œåˆ†æçš„èƒ½åŠ›ï¼Œä»¥æ”¯æŒä¿¡æ¯æå–ã€æ€»ç»“ç­‰ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä½¿ç”¨åœºæ™¯</span></span><br><span class="line"></span><br><span class="line">LangChain å¯ä»¥ç”¨äºå¤šç§åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</span><br><span class="line"></span><br><span class="line">- **èŠå¤©æœºå™¨äºº**ï¼šé€šè¿‡æ„å»ºé“¾å’Œä»£ç†ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºèƒ½å¤Ÿä¸ç”¨æˆ·è¿›è¡Œè‡ªç„¶äº¤äº’çš„å¯¹è¯ç³»ç»Ÿã€‚</span><br><span class="line">- **å†…å®¹ç”Ÿæˆ**ï¼šLangChain å¯ä»¥å¸®åŠ©è‡ªåŠ¨ç”Ÿæˆæ–‡ç« ã€æŠ¥å‘Šã€è¯—æ­Œç­‰ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¤šæ­¥ç”Ÿæˆçš„å¤æ‚å†…å®¹æ—¶ã€‚</span><br><span class="line">- **æ•°æ®åˆ†æ**ï¼šç»“åˆ LLM çš„æ¨ç†èƒ½åŠ›ï¼ŒLangChain èƒ½å¤Ÿæ”¯æŒå¤æ‚çš„æ•°æ®æŸ¥è¯¢å’Œåˆ†æä»»åŠ¡ã€‚</span><br><span class="line">- **æ•™è‚²å·¥å…·**ï¼šé€šè¿‡æ™ºèƒ½åŠ©æ‰‹ï¼ŒLangChain å¯ä»¥æ”¯æŒä¸ªæ€§åŒ–çš„å­¦ä¹ å’Œè¾…å¯¼ä½“éªŒã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä¼˜åŠ¿</span></span><br><span class="line"></span><br><span class="line">- **æ¨¡å—åŒ–**ï¼šLangChain çš„æ¨¡å—åŒ–è®¾è®¡ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©å’Œç»„åˆä¸åŒçš„ç»„ä»¶ï¼Œçµæ´»æ€§é«˜ã€‚</span><br><span class="line">- **å¼€æº**ï¼šä½œä¸ºä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ŒLangChain æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨å’Œæ”¹è¿›ä»£ç ã€‚</span><br><span class="line">- **é›†æˆèƒ½åŠ›**ï¼šèƒ½æ–¹ä¾¿åœ°ä¸å…¶ä»–å„ç§å·¥å…·å’Œå¹³å°é›†æˆï¼Œæ‰©å±•äº†åº”ç”¨çš„åŠŸèƒ½å’Œé€‚ç”¨èŒƒå›´ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»“è®º</span></span><br><span class="line"></span><br><span class="line">LangChain æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…å……åˆ†åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºå¤æ‚ä¸”æ™ºèƒ½çš„åº”ç”¨ç¨‹åºã€‚é€šè¿‡çµæ´»çš„é“¾ã€ä»£ç†ã€å†…å­˜å’Œå·¥å…·è®¾è®¡ï¼ŒLangChain ä½¿å¾—è‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨çš„å¼€å‘æ›´åŠ é«˜æ•ˆå’Œä¾¿æ·ã€‚æ— è®ºæ˜¯ç”¨äºå•†ä¸šåº”ç”¨ã€æ•™è‚²å·¥å…·ï¼Œè¿˜æ˜¯ä¸ªäººé¡¹ç›®ï¼ŒLangChain éƒ½ä¸ºå¼€å‘è€…æä¾›äº†ä¸°å¯Œçš„å¯èƒ½æ€§ã€‚[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“</span><br><span class="line">Human: è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®çš„å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼šLangChain æ˜¯ä¸€ä¸ªå¼€æºçš„æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLM, Large Language Modelsï¼‰å’Œå…¶ä»– AI ç»„ä»¶çš„åº”ç”¨ç¨‹åºã€‚LangChain çš„è®¾è®¡åˆè¡·æ˜¯é€šè¿‡æä¾›ä¸°å¯Œçš„å·¥å…·å’Œç»“æ„ï¼Œç®€åŒ–ä¸è¯­è¨€æ¨¡å‹çš„æ•´åˆå’Œåº”ç”¨å¼€å‘è¿‡ç¨‹ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°æ„å»ºå¤æ‚çš„ NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰åº”ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„æ ¸å¿ƒæ¦‚å¿µ</span></span><br><span class="line"></span><br><span class="line">1. **é“¾ï¼ˆChainsï¼‰**ï¼š</span><br><span class="line">   LangChain çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯â€œé“¾â€ï¼Œå³å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œæˆ–ç»„ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚æ¯ä¸ªé“¾å¯ä»¥æ˜¯ç®€å•çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤æ‚çš„ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»ã€‚é“¾å¯ä»¥åŒ…æ‹¬æŸ¥è¯¢ã€è½¬æ¢ã€éªŒè¯ç­‰å¤šä¸ªæ­¥éª¤ã€‚</span><br><span class="line"></span><br><span class="line">2. **ä»£ç†ï¼ˆAgentsï¼‰**ï¼š</span><br><span class="line">   ä»£ç†æ˜¯ä¸€ç§å¯åŠ¨æ€å†³å®šå…¶è¡Œä¸ºå’Œè·¯å¾„çš„ç»“æ„ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªè¯­è¨€æ¨¡å‹æ¥ç†è§£ç”¨æˆ·è¾“å…¥ï¼Œå¹¶é€‰æ‹©æœ€åˆé€‚çš„è¡ŒåŠ¨ã€‚ä»£ç†é€šå¸¸åœ¨éœ€è¦å®æ—¶å†³ç­–çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸ç”¨æˆ·çš„å¯¹è¯ã€‚</span><br><span class="line"></span><br><span class="line">3. **å†…å­˜ï¼ˆMemoryï¼‰**ï¼š</span><br><span class="line">   LangChain æä¾›äº†å†…å­˜ç®¡ç†åŠŸèƒ½ï¼Œå…è®¸åº”ç”¨åœ¨ä¸åŒçš„ä¼šè¯ä¸­ä¿ç•™ç”¨æˆ·çš„ä¸Šä¸‹æ–‡å’Œå†å²ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—å¯¹è¯ç³»ç»Ÿèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ç”¨æˆ·çš„éœ€æ±‚å’Œåå¥½ã€‚</span><br><span class="line"></span><br><span class="line">4. **å·¥å…·ï¼ˆToolsï¼‰**ï¼š</span><br><span class="line">   LangChain æ”¯æŒå°†å¤–éƒ¨å·¥å…·å’Œ API é›†æˆåˆ°é“¾æˆ–ä»£ç†ä¸­ï¼Œä½¿å¾—è¯­è¨€æ¨¡å‹èƒ½å¤Ÿè¿›è¡Œé€»è¾‘æ¨ç†ã€æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨ web æœåŠ¡ç­‰ã€å¹¶å¤„ç†æ›´å¤æ‚çš„ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">5. **æ–‡æ¡£ï¼ˆDocumentsï¼‰**ï¼š</span><br><span class="line">   æ–‡æ¡£å¤„ç†æ˜¯ LangChain å¦ä¸€ä¸ªé‡è¦åŠŸèƒ½ã€‚åœ¨éœ€è¦å¤„ç†å¤§é‡æ–‡æœ¬ä¿¡æ¯çš„åœºæ™¯ä¸‹ï¼ŒLangChain æä¾›äº†æ–‡æ¡£æ£€ç´¢å’Œåˆ†æçš„èƒ½åŠ›ï¼Œä»¥æ”¯æŒä¿¡æ¯æå–ã€æ€»ç»“ç­‰ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä½¿ç”¨åœºæ™¯</span></span><br><span class="line"></span><br><span class="line">LangChain å¯ä»¥ç”¨äºå¤šç§åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</span><br><span class="line"></span><br><span class="line">- **èŠå¤©æœºå™¨äºº**ï¼šé€šè¿‡æ„å»ºé“¾å’Œä»£ç†ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºèƒ½å¤Ÿä¸ç”¨æˆ·è¿›è¡Œè‡ªç„¶äº¤äº’çš„å¯¹è¯ç³»ç»Ÿã€‚</span><br><span class="line">- **å†…å®¹ç”Ÿæˆ**ï¼šLangChain å¯ä»¥å¸®åŠ©è‡ªåŠ¨ç”Ÿæˆæ–‡ç« ã€æŠ¥å‘Šã€è¯—æ­Œç­‰ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¤šæ­¥ç”Ÿæˆçš„å¤æ‚å†…å®¹æ—¶ã€‚</span><br><span class="line">- **æ•°æ®åˆ†æ**ï¼šç»“åˆ LLM çš„æ¨ç†èƒ½åŠ›ï¼ŒLangChain èƒ½å¤Ÿæ”¯æŒå¤æ‚çš„æ•°æ®æŸ¥è¯¢å’Œåˆ†æä»»åŠ¡ã€‚</span><br><span class="line">- **æ•™è‚²å·¥å…·**ï¼šé€šè¿‡æ™ºèƒ½åŠ©æ‰‹ï¼ŒLangChain å¯ä»¥æ”¯æŒä¸ªæ€§åŒ–çš„å­¦ä¹ å’Œè¾…å¯¼ä½“éªŒã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä¼˜åŠ¿</span></span><br><span class="line"></span><br><span class="line">- **æ¨¡å—åŒ–**ï¼šLangChain çš„æ¨¡å—åŒ–è®¾è®¡ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©å’Œç»„åˆä¸åŒçš„ç»„ä»¶ï¼Œçµæ´»æ€§é«˜ã€‚</span><br><span class="line">- **å¼€æº**ï¼šä½œä¸ºä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ŒLangChain æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨å’Œæ”¹è¿›ä»£ç ã€‚</span><br><span class="line">- **é›†æˆèƒ½åŠ›**ï¼šèƒ½æ–¹ä¾¿åœ°ä¸å…¶ä»–å„ç§å·¥å…·å’Œå¹³å°é›†æˆï¼Œæ‰©å±•äº†åº”ç”¨çš„åŠŸèƒ½å’Œé€‚ç”¨èŒƒå›´ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»“è®º</span></span><br><span class="line"></span><br><span class="line">LangChain æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…å……åˆ†åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºå¤æ‚ä¸”æ™ºèƒ½çš„åº”ç”¨ç¨‹åºã€‚é€šè¿‡çµæ´»çš„é“¾ã€ä»£ç†ã€å†…å­˜å’Œå·¥å…·è®¾è®¡ï¼ŒLangChain ä½¿å¾—è‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨çš„å¼€å‘æ›´åŠ é«˜æ•ˆå’Œä¾¿æ·ã€‚æ— è®ºæ˜¯ç”¨äºå•†ä¸šåº”ç”¨ã€æ•™è‚²å·¥å…·ï¼Œè¿˜æ˜¯ä¸ªäººé¡¹ç›®ï¼ŒLangChain éƒ½ä¸ºå¼€å‘è€…æä¾›äº†ä¸°å¯Œçš„å¯èƒ½æ€§ã€‚</span><br><span class="line">Human: è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨20ä¸ªå­—ä»¥å†…[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">[33;1m[1;3mLangChain ç®€åŒ–äº†å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘ï¼Œæ”¯æŒçµæ´»çš„æ¨¡å—ç»„åˆä¸é›†æˆã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;input&#x27;</span>: <span class="string">&#x27;ä»€ä¹ˆæ˜¯LangChain?&#x27;</span>, <span class="string">&#x27;output&#x27;</span>: <span class="string">&#x27;LangChain ç®€åŒ–äº†å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘ï¼Œæ”¯æŒçµæ´»çš„æ¨¡å—ç»„åˆä¸é›†æˆã€‚&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå› ä¸ºSimpleSequentialChainå®šä¹‰çš„æ˜¯é¡ºåºé“¾ï¼Œæ‰€ä»¥åœ¨chainså‚æ•°ä¸­ä¼ é€’çš„åˆ—è¡¨è¦æŒ‰ç…§ é¡ºåºæ¥è¿›è¡Œä¼ å…¥ï¼Œå³LLMChain A è¦åœ¨LLMChain Bä¹‹å‰ã€‚åŒæ—¶ï¼Œåœ¨è°ƒç”¨æ—¶ï¼Œä¸å†ä½¿ç”¨LLMChain Aä¸­å®š ä¹‰çš„{knowledge} å‚æ•°ï¼Œä¹Ÿä¸æ˜¯LLMChainBä¸­å®šä¹‰çš„{description}å‚æ•°ï¼Œè€Œæ˜¯è¦ä½¿ç”¨ inputè¿›è¡Œå˜ é‡çš„ä¼ é€’ã€‚</p><p>ä¸¾ä¾‹2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SimpleSequentialChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ä¸€ä¸ªç»™å‰§åå†™å¤§çº²çš„LLMChain  </span></span><br><span class="line">template1 = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ä¸ªå‰§ä½œå®¶ã€‚ç»™å®šå‰§æœ¬çš„æ ‡é¢˜ï¼Œä½ çš„å·¥ä½œå°±æ˜¯ä¸ºè¿™ä¸ªæ ‡é¢˜å†™ä¸€ä¸ªå¤§çº²ã€‚  </span></span><br><span class="line"><span class="string">Title: &#123;title&#125;  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">prompt_template1 = PromptTemplate(input_variables=[<span class="string">&quot;title&quot;</span>], template=template1)  </span><br><span class="line">synopsis_chain = LLMChain(llm=llm, prompt=prompt_template1)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰ç»™ä¸€ä¸ªå‰§æœ¬å¤§çº²å†™ä¸€ç¯‡è¯„è®ºçš„LLMChain  </span></span><br><span class="line">template2 = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ã€Šçº½çº¦æ—¶æŠ¥ã€‹çš„å‰§è¯„å®¶ã€‚æœ‰äº†å‰§æœ¬çš„å¤§çº²ï¼Œä½ çš„å·¥ä½œå°±æ˜¯ä¸ºå‰§æœ¬å†™ä¸€ç¯‡è¯„è®º  </span></span><br><span class="line"><span class="string">å‰§æƒ…å¤§çº²:  </span></span><br><span class="line"><span class="string">&#123;synopsis&#125;  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">prompt_template2 = PromptTemplate(input_variables=[<span class="string">&quot;synopsis&quot;</span>], template=template2)  </span><br><span class="line">review_chain = LLMChain(llm=llm, prompt=prompt_template2)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„é“¾æŒ‰é¡ºåºè¿è¡Œè¿™ä¸¤æ¡é“¾  </span></span><br><span class="line"><span class="comment">#(verbose=True:æ‰“å°é“¾çš„æ‰§è¡Œè¿‡ç¨‹)  </span></span><br><span class="line">overall_chain = SimpleSequentialChain(  </span><br><span class="line">    chains=[synopsis_chain, review_chain],  </span><br><span class="line">    verbose=<span class="literal">True</span>  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 6.è°ƒç”¨å®Œæ•´é“¾é¡ºåºæ‰§è¡Œè¿™ä¸¤ä¸ªé“¾  </span></span><br><span class="line">review = overall_chain.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;æ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7.æ‰“å°ç»“æœ  </span></span><br><span class="line"><span class="built_in">print</span>(review)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SimpleSequentialChain chain...[0m</span><br><span class="line">[36;1m[1;3mæ ‡é¢˜: æ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§</span><br><span class="line"></span><br><span class="line">å¤§çº²:</span><br><span class="line"></span><br><span class="line">**ç¬¬ä¸€å¹•ï¼šåˆè§ä¸å†²çª**</span><br><span class="line">- åœºæ™¯è®¾å®šåœ¨ä¸€ä¸ªé£æ™¯å¦‚ç”»çš„æµ·æ»©å°é•‡ï¼Œé»„æ˜æ—¶åˆ†ï¼Œé˜³å…‰æ´’åœ¨æ³¢æµªä¸Šï¼Œè¥é€ å‡ºå®é™çš„æ°›å›´ã€‚</span><br><span class="line">- ä¸»è¦è§’è‰²ä»‹ç»ï¼šè‰¾ç±³è‰ï¼ˆå¹´è½»çš„è‰ºæœ¯å®¶ï¼‰ï¼Œå¥¹æ­£åœ¨æµ·æ»©ä¸Šå¯»æ±‚çµæ„Ÿï¼›æ°å…‹ï¼ˆæ—©å¹´å›ä¹¡çš„æµ·å†›å†›äººï¼‰ï¼Œå†…å¿ƒæ‰¿å—ç€æˆ˜äº‰çš„åˆ›ä¼¤ï¼›è€æ¸”å¤«å“ˆç½—å¾·ï¼ˆé•‡ä¸Šçš„æ™ºè€…ï¼Œä¸ºäººå’Œè”¼å´æ»¡è…¹è¾›é…¸ï¼‰ã€‚</span><br><span class="line">- è‰¾ç±³è‰å¶ç„¶é‡è§æ°å…‹ï¼Œä¸¤äººå› å¯¹æµ·æ»©çš„ä¸åŒçœ‹æ³•è€Œäº§ç”Ÿäº‰æ‰§ã€‚æ°å…‹è®¤ä¸ºæˆ˜äº‰æ˜¯äººç±»æ— æ³•é€ƒé¿çš„æ‚²å‰§ï¼Œè€Œè‰¾ç±³è‰åˆ™è®¤ä¸ºè‰ºæœ¯èƒ½æ²»æ„ˆåˆ›ä¼¤ã€‚</span><br><span class="line"></span><br><span class="line">**ç¬¬äºŒå¹•ï¼šå‹è°Šä¸ç§˜å¯†**</span><br><span class="line">- åœ¨ä¸€æ¬¡æµ·æ»©æ™šä¼šä¸­ï¼Œè‰¾ç±³è‰å’Œæ°å…‹é€æ¸å’Œè§£å¹¶æˆä¸ºæœ‹å‹ã€‚åœ¨å“ˆç½—å¾·çš„å¼•å¯¼ä¸‹ï¼Œä»–ä»¬åˆ†äº«å„è‡ªçš„ç»å†ï¼Œå»ºç«‹èµ·æ·±åšçš„æƒ…æ„Ÿçº½å¸¦ã€‚</span><br><span class="line">- è‰¾ç±³è‰å¯¹æ°å…‹çš„è¿‡å»äº§ç”Ÿäº†æµ“åšçš„å…´è¶£å¹¶å°è¯•ç”¨ç”»ç¬”æ•æ‰ä»–çš„æ•…äº‹ï¼Œç„¶è€Œï¼Œæ°å…‹å¯¹æˆ˜äº‰çš„å›å¿†ä»ç„¶å……æ»¡ç—›è‹¦ï¼Œä»–è¯•å›¾éšè—è‡ªå·±å†…å¿ƒçš„é»‘æš—ã€‚</span><br><span class="line">- é•‡ä¸Šå‘ç”Ÿäº†ä¸€ä»¶ç¥ç§˜çš„äº‹æƒ…ï¼šä¸€ä½å¹´è½»å¥³å­©åœ¨æµ·æ»©å¤±è¸ªï¼Œé•‡å­é™·å…¥ææ…Œï¼Œæ°å…‹çš„å†…å¿ƒå†²çªåŠ å‰§ã€‚</span><br><span class="line"></span><br><span class="line">**ç¬¬ä¸‰å¹•ï¼šçœŸç›¸æ­ç¤ºä¸é€‰æ‹©**</span><br><span class="line">- è‰¾ç±³è‰å’Œæ°å…‹å†³å®šå±•å¼€è°ƒæŸ¥ï¼Œè¯•å›¾æ‰¾å‡ºå¥³å­©å¤±è¸ªçš„çœŸç›¸ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»–ä»¬å‘ç°äº†å°é•‡éšè—çš„ç§˜å¯†ï¼Œæ­ç¤ºäº†äººä»¬å¯¹äºè¿‡å»çš„é€ƒé¿ä»¥åŠå¯¹ç°å®çš„æ— åŠ›ã€‚</span><br><span class="line">- åœ¨ä¸€æ¬¡æ·±å¤œæ¢é™©ä¸­ï¼Œè‰¾ç±³è‰åœ¨æµ·æ»©å‘ç°äº†æ—§æ—¥æˆ˜äº‰ç•™ä¸‹çš„é—ç‰©ï¼Œå‹¾èµ·äº†æ°å…‹ç—›è‹¦çš„è®°å¿†ï¼Œæœ€ç»ˆä»–åœ¨æµ·æ»©ä¸Šçˆ†å‘å‡ºæƒ…ç»ªï¼Œæ­ç¤ºäº†è‡ªå·±åœ¨æˆ˜äº‰ä¸­äº²å†çš„æ‚²æƒ¨äº‹ä»¶ã€‚</span><br><span class="line">- äºŒäººé¢å¯¹å„è‡ªçš„ä¼¤ç—›ï¼Œæ°å…‹å†³å®šå‘é•‡ä¸Šäººä»¬è®²è¿°çœŸç›¸ï¼Œè€Œè‰¾ç±³è‰åˆ™å†³å®šç”¨è‰ºæœ¯è®°å½•ä¸‹ä»–ä»¬çš„æ•…äº‹ã€‚</span><br><span class="line"></span><br><span class="line">**ç¬¬å››å¹•ï¼šæ‚²å‰§ä¸æ•‘èµ**</span><br><span class="line">- å½“æ°å…‹è¡¨ç™½è‡ªå·±çš„ç»å†åï¼Œé•‡ä¸Šçš„äººä»¬è¢«éœ‡æ’¼ï¼Œéƒ¨åˆ†äººå¼€å§‹æ„è¯†åˆ°ç›´é¢è¿‡å»çš„é‡è¦æ€§ã€‚</span><br><span class="line">- ç„¶è€Œï¼Œå°±åœ¨å¤§å®¶é€æ¸é€‚åº”è¿™ä¸ªçœŸç›¸æ—¶ï¼Œæ–°çš„æ‚²å‰§å‘ç”Ÿï¼šæ°å…‹å› æ— æ³•æ‰¿å—å†…å¿ƒçš„é‡è´Ÿè€Œé€‰æ‹©æç«¯æ–¹å¼ç»“æŸè‡ªå·±çš„ç”Ÿå‘½ã€‚è‰¾ç±³è‰åœ¨æ­¤åˆ»æ„Ÿå—åˆ°æ·±æ·±çš„ç»æœ›ä¸æ‚”æ¨ã€‚</span><br><span class="line">- æœ€ç»ˆï¼Œåœ¨æ°å…‹çš„è‘¬ç¤¼ä¸Šï¼Œè‰¾ç±³è‰å‘è¡¨æ¼”è®²ï¼Œå‘å°é•‡çš„å±…æ°‘å‘¼åçæƒœç”Ÿå‘½ä¸å½¼æ­¤ï¼Œå¥¹å†³å®šä»¥ç”»ä½œçºªå¿µæ°å…‹ï¼ŒæŠŠä»–çš„æ•…äº‹ä¼ é€’ä¸‹å»ã€‚</span><br><span class="line"></span><br><span class="line">**ç»“å°¾ï¼šå¸Œæœ›ä¸é‡ç”Ÿ**</span><br><span class="line">- ç”»å±•ä¸Šçš„è‰¾ç±³è‰å°†æ°å…‹çš„æ•…äº‹ä»¥è‰ºæœ¯çš„å½¢å¼å±•ç°å‡ºæ¥ï¼Œå¸å¼•äº†è¶Šæ¥è¶Šå¤šäººçš„å…³æ³¨ã€‚</span><br><span class="line">- æµ·æ»©å¤•é˜³å†æ¬¡è½ä¸‹ï¼Œè‰¾ç±³è‰ç«™åœ¨æµ·æ»©ä¸Šï¼Œæ‰‹ä¸­æ¡ç€ç”»ç¬”ï¼Œå¥¹æ„è¯†åˆ°ï¼Œè™½ç„¶ç”Ÿå‘½å……æ»¡æ‚²å‰§ï¼Œä½†æ¯ä¸ªäººçš„æ•…äº‹éƒ½æœ‰è¢«å¬è§çš„ä»·å€¼ï¼ŒåŒæ—¶ä¹Ÿæ¸´æœ›ç€å¸Œæœ›ä¸æ•‘èµã€‚[0m</span><br><span class="line">[33;1m[1;3m**å‰§è¯„ï¼šã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹â€”â€”åœ¨è‰ºæœ¯ä¸ç—›è‹¦ä¹‹é—´çš„æŠ‰æ‹©**</span><br><span class="line"></span><br><span class="line">ã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨å……æ»¡æƒ…æ„Ÿæ·±åº¦çš„æˆå‰§ï¼Œé€šè¿‡ç²¾è‡´çš„è§’è‰²å¡‘é€ ä¸å¼•äººå…¥èƒœçš„å‰§æƒ…ï¼Œä¸ºè§‚ä¼—å±•ç°äº†äººæ€§ä¸­çš„è„†å¼±ä¸åšéŸ§ã€‚å¯¼æ¼”ä»¥æµ·æ»©å°é•‡çš„å®é™ä¸ºèƒŒæ™¯ï¼Œé…åˆé»„æ˜çš„æ¸©æš–è‰²è°ƒï¼Œå½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ï¼Œæ­ç¤ºäº†è§’è‰²å†…å¿ƒçš„å†²çªä¸æŒ£æ‰ã€‚</span><br><span class="line"></span><br><span class="line">å‰§æƒ…çš„ç¬¬ä¸€å¹•ï¼Œåˆè§ä¸å†²çªï¼Œå±•ç¤ºäº†è‰¾ç±³è‰ä¸æ°å…‹ä¹‹é—´çš„å¯¹ç«‹ã€‚åœ¨è¿™ä¸ªç‰‡æ®µä¸­ï¼Œè‰¾ç±³è‰æš—ç¤ºäº†è‰ºæœ¯çš„æ²»ç–—åŠ›é‡ï¼Œè€Œæ°å…‹çš„åšå®šæ€åº¦åˆ™ä¼ è¾¾å‡ºæˆ˜äº‰æ— æ³•è¢«é—å¿˜çš„æ·±åˆ»ç—›è‹¦ã€‚è¿™ç§å¯¹æ¯”ä¸ä»…è®¾ç½®äº†ä¸¤äººä¹‹é—´çš„ä¸»è¦çŸ›ç›¾ï¼Œä¹Ÿè®©è§‚ä¼—æ„Ÿå—åˆ°äººç±»æƒ…æ„Ÿçš„å¤æ‚æ€§ã€‚æ°å…‹çš„å†…å¿ƒåˆ›ä¼¤ä¸è‰¾ç±³è‰çš„ç†æƒ³ä¸»ä¹‰å½¢æˆäº†å°–é”çš„å†²çªï¼Œä¸ºåç»­äº’åŠ¨åŸ‹ä¸‹äº†ä¸°å¯Œçš„æƒ…æ„ŸåŸºç¡€ã€‚</span><br><span class="line"></span><br><span class="line">éšç€å‰§æƒ…çš„æ·±å…¥ï¼Œå‹è°Šä¸ç§˜å¯†çš„ç¬¬äºŒå¹•æç»˜äº†è‰¾ç±³è‰ä¸æ°å…‹çš„å…³ç³»æ¼”å˜ã€‚ä¸¤äººé€æ­¥æ‰“ç ´äº†å¿ƒç†ä¸Šçš„å£å’ï¼Œæˆä¸ºå½¼æ­¤å€¾è¯‰çš„å¯¹è±¡ã€‚æ­¤æ—¶ï¼Œè€æ¸”å¤«å“ˆç½—å¾·çš„è§’è‰²æ˜¾å¾—æ„ˆå‘é‡è¦ï¼Œä»–ä¸ä»…æ˜¯æ™ºæ…§çš„è±¡å¾ï¼Œæ›´æ˜¯è¿æ¥è¿‡å»ä¸ç°åœ¨çš„æ¡¥æ¢ã€‚ä»–ä»¬å…±äº«æ•…äº‹çš„æ—¶åˆ»ï¼Œå¦‚åŒæ¸©æš–çš„æ½®æ°´ï¼Œæ¸æ¸å†²æ·¡äº†å„è‡ªçš„å­¤ç‹¬ä¸ä¼¤ç—›ã€‚ç„¶è€Œï¼Œæ•…äº‹çš„è½¬æŠ˜ç‚¹åœ¨äºå¥³å­©çš„å¤±è¸ªï¼Œè¿™ä¸€çªå‘äº‹ä»¶å†æ¬¡å°†æ°å…‹æ¨å…¥æƒ…æ„Ÿçš„æ·±æ¸Šï¼Œæ­ç¤ºäº†é•‡ä¸Šäººä»¬é¢å¯¹çœŸå®çš„é€ƒé¿ä¸æ— åŠ›æ„Ÿã€‚</span><br><span class="line"></span><br><span class="line">å‰§ä½œçš„ä¸­å¿ƒåœ¨äºçœŸç›¸æ­ç¤ºä¸é€‰æ‹©çš„ç¬¬ä¸‰å¹•ï¼Œè‰¾ç±³è‰å’Œæ°å…‹è°ƒæŸ¥å¥³å­©å¤±è¸ªçš„çœŸç›¸ï¼Œè¿™ä¸ä»…æ˜¯å¯¹å¤–ç•Œäº‹ä»¶çš„ä¸€æ¬¡æ¢ç´¢ï¼Œæ›´æ˜¯å¯¹å†…å¿ƒç§˜å¯†çš„å‘¼å”¤ã€‚æ°å…‹çš„æƒ…æ„Ÿçˆ†å‘ï¼Œæ·±æƒ…åˆç—›è‹¦ï¼Œå±•ç¤ºäº†ä»–å†…å¿ƒæ·±å¤„çš„é»‘æš—ä¸çŸ›ç›¾ã€‚è€Œè‰¾ç±³è‰çš„è§’è‰²åœ¨æ­¤åˆ»æ˜¾å¾—æ— æ¯”é‡è¦ï¼Œå¥¹é€‰æ‹©ç”¨ç”»ç¬”è®°å½•ä¸‹è¿™ä¸€åˆ‡ï¼Œä¸ä»…æ˜¯å¯¹æ°å…‹çš„æ•‘èµï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±å†…å¿ƒçš„è§£æ”¾ã€‚</span><br><span class="line"></span><br><span class="line">å‰§ä¸­çš„æ‚²å‰§å¹¶éä»…é™äºæ°å…‹çš„é€‰æ‹©ï¼Œè€Œæ˜¯å¯¹äººç±»å…±åŒç—›è‹¦çš„æ·±åˆ»åæ€ã€‚æ°å…‹çš„è‡ªæ€æ˜¯å¯¹å†…å¿ƒå†²çªçš„æ— å£°æŠ—è®®ï¼Œä»¤è§‚ä¼—å¯¹ç”Ÿå‘½çš„è„†å¼±ä¸çè´µæ„Ÿæ…¨ä¸‡åƒã€‚è€Œè‰¾ç±³è‰åˆ™æˆä¸ºæŠ˜å°„å¸Œæœ›çš„å…‰èŠ’ï¼Œå¥¹ä»¥ç”»ä½œä¸ºæ°å…‹èµ‹äºˆäº†ç”Ÿå‘½çš„æ„ä¹‰ï¼Œä½¿æ‚²å‰§å˜æˆäº†ä¸€æ¬¡å›¢ç»“ä¸å…±é¸£çš„å‘¼å”¤ã€‚</span><br><span class="line"></span><br><span class="line">ç»“å°¾çš„ç”»å±•æ˜¯å¯¹æ•´ä¸ªæ•…äº‹çš„å‡åï¼Œè‰¾ç±³è‰ç”¨è‰ºæœ¯å†²ç ´äº†å“€ç—›çš„æ·é”ï¼Œå°†æ°å…‹çš„æ•…äº‹ä¼ é€’ç»™äº†æ›´å¤šçš„äººã€‚æµ·æ»©ä¸Šçš„å¤•é˜³ï¼Œä¸ä»…è±¡å¾ç€ç”Ÿå‘½çš„è½®å›ï¼Œæ›´ä¼ é€’å‡ºä¸€ç§å¸Œæœ›çš„æ°”æ¯ã€‚å¥¹åœ¨ç»æœ›ä¸å¸Œæœ›ä¹‹é—´å¯»æ‰¾åˆ°äº†è‡ªå·±çš„ä½ç½®ï¼Œå‘è§‚ä¼—å±•ç¤ºäº†è‰ºæœ¯å¦‚ä½•è®©ç—›è‹¦æˆä¸ºä¸€ç§åŠ›é‡ã€‚</span><br><span class="line"></span><br><span class="line">ã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨æ·±æƒ…å¹¶å¯Œæœ‰æ€è€ƒçš„ä½œå“ï¼ŒæŒ‘æˆ˜ç€è§‚ä¼—å¯¹ç”Ÿå‘½æ„ä¹‰çš„ç†è§£ã€‚å®ƒä¸ä»…æ¢è®¨äº†æˆ˜äº‰å¸¦æ¥çš„åˆ›ä¼¤ï¼Œä¹Ÿé€è§†äº†ç”Ÿæ´»ä¸­çš„æ‚²å‰§ä¸æ•‘èµã€‚æ˜¯è‰ºæœ¯è®©äººä»¬é‡æ–°å®¡è§†è¿‡å»ï¼Œç›´é¢ç—›è‹¦ï¼Œå¹¶ä»ä¸­å¯»æ‰¾å¸Œæœ›ã€‚æ¯ä¸€ä¸ªæ•…äº‹éƒ½å€¼å¾—è¢«è†å¬ï¼Œæ¯ä¸€ä¸ªç”Ÿå‘½éƒ½æ¸´æœ›å¾—åˆ°çè§†ã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;input&#x27;</span>: <span class="string">&#x27;æ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§&#x27;</span>, <span class="string">&#x27;output&#x27;</span>: <span class="string">&#x27;**å‰§è¯„ï¼šã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹â€”â€”åœ¨è‰ºæœ¯ä¸ç—›è‹¦ä¹‹é—´çš„æŠ‰æ‹©**\n\nã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨å……æ»¡æƒ…æ„Ÿæ·±åº¦çš„æˆå‰§ï¼Œé€šè¿‡ç²¾è‡´çš„è§’è‰²å¡‘é€ ä¸å¼•äººå…¥èƒœçš„å‰§æƒ…ï¼Œä¸ºè§‚ä¼—å±•ç°äº†äººæ€§ä¸­çš„è„†å¼±ä¸åšéŸ§ã€‚å¯¼æ¼”ä»¥æµ·æ»©å°é•‡çš„å®é™ä¸ºèƒŒæ™¯ï¼Œé…åˆé»„æ˜çš„æ¸©æš–è‰²è°ƒï¼Œå½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ï¼Œæ­ç¤ºäº†è§’è‰²å†…å¿ƒçš„å†²çªä¸æŒ£æ‰ã€‚\n\nå‰§æƒ…çš„ç¬¬ä¸€å¹•ï¼Œåˆè§ä¸å†²çªï¼Œå±•ç¤ºäº†è‰¾ç±³è‰ä¸æ°å…‹ä¹‹é—´çš„å¯¹ç«‹ã€‚åœ¨è¿™ä¸ªç‰‡æ®µä¸­ï¼Œè‰¾ç±³è‰æš—ç¤ºäº†è‰ºæœ¯çš„æ²»ç–—åŠ›é‡ï¼Œè€Œæ°å…‹çš„åšå®šæ€åº¦åˆ™ä¼ è¾¾å‡ºæˆ˜äº‰æ— æ³•è¢«é—å¿˜çš„æ·±åˆ»ç—›è‹¦ã€‚è¿™ç§å¯¹æ¯”ä¸ä»…è®¾ç½®äº†ä¸¤äººä¹‹é—´çš„ä¸»è¦çŸ›ç›¾ï¼Œä¹Ÿè®©è§‚ä¼—æ„Ÿå—åˆ°äººç±»æƒ…æ„Ÿçš„å¤æ‚æ€§ã€‚æ°å…‹çš„å†…å¿ƒåˆ›ä¼¤ä¸è‰¾ç±³è‰çš„ç†æƒ³ä¸»ä¹‰å½¢æˆäº†å°–é”çš„å†²çªï¼Œä¸ºåç»­äº’åŠ¨åŸ‹ä¸‹äº†ä¸°å¯Œçš„æƒ…æ„ŸåŸºç¡€ã€‚\n\néšç€å‰§æƒ…çš„æ·±å…¥ï¼Œå‹è°Šä¸ç§˜å¯†çš„ç¬¬äºŒå¹•æç»˜äº†è‰¾ç±³è‰ä¸æ°å…‹çš„å…³ç³»æ¼”å˜ã€‚ä¸¤äººé€æ­¥æ‰“ç ´äº†å¿ƒç†ä¸Šçš„å£å’ï¼Œæˆä¸ºå½¼æ­¤å€¾è¯‰çš„å¯¹è±¡ã€‚æ­¤æ—¶ï¼Œè€æ¸”å¤«å“ˆç½—å¾·çš„è§’è‰²æ˜¾å¾—æ„ˆå‘é‡è¦ï¼Œä»–ä¸ä»…æ˜¯æ™ºæ…§çš„è±¡å¾ï¼Œæ›´æ˜¯è¿æ¥è¿‡å»ä¸ç°åœ¨çš„æ¡¥æ¢ã€‚ä»–ä»¬å…±äº«æ•…äº‹çš„æ—¶åˆ»ï¼Œå¦‚åŒæ¸©æš–çš„æ½®æ°´ï¼Œæ¸æ¸å†²æ·¡äº†å„è‡ªçš„å­¤ç‹¬ä¸ä¼¤ç—›ã€‚ç„¶è€Œï¼Œæ•…äº‹çš„è½¬æŠ˜ç‚¹åœ¨äºå¥³å­©çš„å¤±è¸ªï¼Œè¿™ä¸€çªå‘äº‹ä»¶å†æ¬¡å°†æ°å…‹æ¨å…¥æƒ…æ„Ÿçš„æ·±æ¸Šï¼Œæ­ç¤ºäº†é•‡ä¸Šäººä»¬é¢å¯¹çœŸå®çš„é€ƒé¿ä¸æ— åŠ›æ„Ÿã€‚\n\nå‰§ä½œçš„ä¸­å¿ƒåœ¨äºçœŸç›¸æ­ç¤ºä¸é€‰æ‹©çš„ç¬¬ä¸‰å¹•ï¼Œè‰¾ç±³è‰å’Œæ°å…‹è°ƒæŸ¥å¥³å­©å¤±è¸ªçš„çœŸç›¸ï¼Œè¿™ä¸ä»…æ˜¯å¯¹å¤–ç•Œäº‹ä»¶çš„ä¸€æ¬¡æ¢ç´¢ï¼Œæ›´æ˜¯å¯¹å†…å¿ƒç§˜å¯†çš„å‘¼å”¤ã€‚æ°å…‹çš„æƒ…æ„Ÿçˆ†å‘ï¼Œæ·±æƒ…åˆç—›è‹¦ï¼Œå±•ç¤ºäº†ä»–å†…å¿ƒæ·±å¤„çš„é»‘æš—ä¸çŸ›ç›¾ã€‚è€Œè‰¾ç±³è‰çš„è§’è‰²åœ¨æ­¤åˆ»æ˜¾å¾—æ— æ¯”é‡è¦ï¼Œå¥¹é€‰æ‹©ç”¨ç”»ç¬”è®°å½•ä¸‹è¿™ä¸€åˆ‡ï¼Œä¸ä»…æ˜¯å¯¹æ°å…‹çš„æ•‘èµï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±å†…å¿ƒçš„è§£æ”¾ã€‚\n\nå‰§ä¸­çš„æ‚²å‰§å¹¶éä»…é™äºæ°å…‹çš„é€‰æ‹©ï¼Œè€Œæ˜¯å¯¹äººç±»å…±åŒç—›è‹¦çš„æ·±åˆ»åæ€ã€‚æ°å…‹çš„è‡ªæ€æ˜¯å¯¹å†…å¿ƒå†²çªçš„æ— å£°æŠ—è®®ï¼Œä»¤è§‚ä¼—å¯¹ç”Ÿå‘½çš„è„†å¼±ä¸çè´µæ„Ÿæ…¨ä¸‡åƒã€‚è€Œè‰¾ç±³è‰åˆ™æˆä¸ºæŠ˜å°„å¸Œæœ›çš„å…‰èŠ’ï¼Œå¥¹ä»¥ç”»ä½œä¸ºæ°å…‹èµ‹äºˆäº†ç”Ÿå‘½çš„æ„ä¹‰ï¼Œä½¿æ‚²å‰§å˜æˆäº†ä¸€æ¬¡å›¢ç»“ä¸å…±é¸£çš„å‘¼å”¤ã€‚\n\nç»“å°¾çš„ç”»å±•æ˜¯å¯¹æ•´ä¸ªæ•…äº‹çš„å‡åï¼Œè‰¾ç±³è‰ç”¨è‰ºæœ¯å†²ç ´äº†å“€ç—›çš„æ·é”ï¼Œå°†æ°å…‹çš„æ•…äº‹ä¼ é€’ç»™äº†æ›´å¤šçš„äººã€‚æµ·æ»©ä¸Šçš„å¤•é˜³ï¼Œä¸ä»…è±¡å¾ç€ç”Ÿå‘½çš„è½®å›ï¼Œæ›´ä¼ é€’å‡ºä¸€ç§å¸Œæœ›çš„æ°”æ¯ã€‚å¥¹åœ¨ç»æœ›ä¸å¸Œæœ›ä¹‹é—´å¯»æ‰¾åˆ°äº†è‡ªå·±çš„ä½ç½®ï¼Œå‘è§‚ä¼—å±•ç¤ºäº†è‰ºæœ¯å¦‚ä½•è®©ç—›è‹¦æˆä¸ºä¸€ç§åŠ›é‡ã€‚\n\nã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨æ·±æƒ…å¹¶å¯Œæœ‰æ€è€ƒçš„ä½œå“ï¼ŒæŒ‘æˆ˜ç€è§‚ä¼—å¯¹ç”Ÿå‘½æ„ä¹‰çš„ç†è§£ã€‚å®ƒä¸ä»…æ¢è®¨äº†æˆ˜äº‰å¸¦æ¥çš„åˆ›ä¼¤ï¼Œä¹Ÿé€è§†äº†ç”Ÿæ´»ä¸­çš„æ‚²å‰§ä¸æ•‘èµã€‚æ˜¯è‰ºæœ¯è®©äººä»¬é‡æ–°å®¡è§†è¿‡å»ï¼Œç›´é¢ç—›è‹¦ï¼Œå¹¶ä»ä¸­å¯»æ‰¾å¸Œæœ›ã€‚æ¯ä¸€ä¸ªæ•…äº‹éƒ½å€¼å¾—è¢«è†å¬ï¼Œæ¯ä¸€ä¸ªç”Ÿå‘½éƒ½æ¸´æœ›å¾—åˆ°çè§†ã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="é¡ºåºé“¾ä¹‹-SequentialChain"><a href="#é¡ºåºé“¾ä¹‹-SequentialChain" class="headerlink" title="é¡ºåºé“¾ä¹‹ SequentialChain"></a>é¡ºåºé“¾ä¹‹ SequentialChain</h2><h3 id="è¯´æ˜-1"><a href="#è¯´æ˜-1" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>SequentialChainï¼šæ›´é€šç”¨çš„é¡ºåºé“¾ï¼Œå…·ä½“æ¥è¯´ï¼š </p><ul><li>å¤šå˜é‡æ”¯æŒï¼šå…è®¸ä¸åŒå­é“¾æœ‰ç‹¬ç«‹çš„è¾“å…¥&#x2F;è¾“å‡ºå˜é‡ã€‚ </li><li>çµæ´»æ˜ å°„ï¼šéœ€ æ˜¾å¼å®šä¹‰å˜é‡å¦‚ä½•ä»ä¸€ä¸ªé“¾ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªé“¾ã€‚å³ç²¾å‡†åœ°å‘½åè¾“å…¥å…³é”®å­—å’Œè¾“å‡ºå…³é”® å­—ï¼Œæ¥æ˜ç¡®é“¾ä¹‹é—´çš„å…³ç³»ã€‚ </li><li>å¤æ‚æµç¨‹æ§åˆ¶ï¼šæ”¯æŒåˆ†æ”¯ã€æ¡ä»¶é€»è¾‘ï¼ˆåˆ†åˆ«é€šè¿‡<strong>input_variables</strong>å’Œ<strong>output_variables</strong>è¾“å‡ºï¼‰ã€‚</li></ul><p><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/file-20251013094055511.png"></p><h3 id="ä½¿ç”¨ä¸¾ä¾‹-2"><a href="#ä½¿ç”¨ä¸¾ä¾‹-2" class="headerlink" title="ä½¿ç”¨ä¸¾ä¾‹"></a>ä½¿ç”¨ä¸¾ä¾‹</h3><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SequentialChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">schainA_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ å…ˆå°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼š&#123;knowledge&#125;ï¼Œå¹¶ä¸”&#123;action&#125;&quot;</span>)  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">schainA_chains = LLMChain(llm=llm,  </span><br><span class="line">                          prompt=schainA_template,  </span><br><span class="line">                          verbose=<span class="literal">True</span>,  </span><br><span class="line">                          output_key=<span class="string">&quot;schainA_chains_key&quot;</span>  </span><br><span class="line">                          )  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># schainA_chains.invoke(&#123;  </span></span><br><span class="line"><span class="comment">#     &quot;knowledge&quot;: &quot;ä¸­å›½çš„ç¯®çƒæ€ä¹ˆæ ·ï¼Ÿ&quot;,  </span></span><br><span class="line"><span class="comment">#     &quot;action&quot;: &quot;ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­&quot;  </span></span><br><span class="line"><span class="comment"># &#125;  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line">schainB_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼š&#123;schainA_chains_key&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨100ä¸ªå­—ä»¥å†…&quot;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">schainB_chains = LLMChain(llm=llm,  </span><br><span class="line">                         prompt=schainB_template,  </span><br><span class="line">                         verbose=<span class="literal">True</span>,  </span><br><span class="line">                         output_key=<span class="string">&#x27;schainB_chains_key&#x27;</span>  </span><br><span class="line">                        )  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ä¸€å®šè¦å£°æ˜å‡ºä¸¤ä¸ªå˜é‡ï¼šinput_variablesã€output_variables  </span></span><br><span class="line">Seq_chain = SequentialChain(  </span><br><span class="line">                            chains=[schainA_chains, schainB_chains],  </span><br><span class="line">                            input_variables=[<span class="string">&quot;knowledge&quot;</span>, <span class="string">&quot;action&quot;</span>],  </span><br><span class="line">                            output_variables=[<span class="string">&quot;schainA_chains_key&quot;</span>,<span class="string">&quot;schainB_chains_key&quot;</span>],  </span><br><span class="line">                            verbose=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line">response = Seq_chain.invoke(&#123;  </span><br><span class="line">                       <span class="string">&quot;knowledge&quot;</span>:<span class="string">&quot;ä¸­å›½è¶³çƒä¸ºä»€ä¹ˆè¸¢å¾—çƒ‚&quot;</span>,  </span><br><span class="line">                       <span class="string">&quot;action&quot;</span>:<span class="string">&quot;ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­&quot;</span>  </span><br><span class="line">                    &#125;  </span><br><span class="line">                )  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SequentialChain chain...[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ</span><br><span class="line">Human: è¯·ä½ å…ˆå°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼šä¸­å›½è¶³çƒä¸ºä»€ä¹ˆè¸¢å¾—çƒ‚ï¼Œå¹¶ä¸”ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“</span><br><span class="line">Human: è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼šä¸­å›½è¶³çƒä¹‹æ‰€ä»¥åœ¨å›½é™…èˆå°ä¸Šè¡¨ç°ä¸ä½³ï¼ŒåŸå› å¤æ‚ä¸”å¤šæ–¹é¢ï¼Œä¸»è¦å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œåˆ†æï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">### 1. **ä½“åˆ¶ä¸ç®¡ç†é—®é¢˜**</span></span><br><span class="line">   - **è¡Œæ”¿å¹²é¢„**ï¼šä¸­å›½è¶³çƒçš„ç®¡ç†ä½“åˆ¶å­˜åœ¨è¾ƒå¤šè¡Œæ”¿å¹²é¢„ï¼Œå¯¼è‡´ä¿±ä¹éƒ¨å’Œçƒé˜Ÿçš„å‘å±•å—åˆ°é™åˆ¶ã€‚è¶³çƒåä¼šçš„å†³ç­–å¾€å¾€å—åˆ°æ”¿åºœéƒ¨é—¨çš„å½±å“ï¼Œç¼ºä¹ç‹¬ç«‹æ€§å’Œä¸“ä¸šæ€§ã€‚</span><br><span class="line">   - **è…è´¥ç°è±¡**ï¼šå†å²ä¸Šï¼Œä¸­å›½è¶³çƒæ›¾æš´éœ²å‡ºä¸å°‘è…è´¥é—®é¢˜ï¼ŒåŒ…æ‹¬å‡çƒå’Œè´¿èµ‚ï¼ŒæŸå®³äº†è¿åŠ¨å‘˜çš„èŒä¸šé“å¾·å’Œè§‚ä¼—çš„ä¿¡ä»»ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 2. **é’è®­ä½“ç³»ä¸å®Œå–„**</span></span><br><span class="line">   - **åŸºç¡€è®¾æ–½ä¸è¶³**ï¼šå°½ç®¡è¿‘å¹´æ¥ä¸­å›½åœ¨è¶³çƒåœºåœ°å»ºè®¾ä¸ŠæŠ•å…¥è¾ƒå¤šï¼Œä½†é’è®­ä½“ç³»å’ŒåŸºç¡€è®¾æ–½çš„å»ºè®¾ä»ç„¶æ»åäºå…¶ä»–è¶³çƒå¼ºå›½ã€‚</span><br><span class="line">   - **é’å°‘å¹´åŸ¹å…»**ï¼šåœ¨é’å°‘å¹´è¶³çƒé¢†åŸŸï¼Œç¼ºä¹ç³»ç»Ÿçš„åŸ¹è®­å’Œé€‰æ‹”æœºåˆ¶ï¼Œä¼˜ç§€çš„é’å°‘å¹´çƒå‘˜éš¾ä»¥è„±é¢–è€Œå‡ºå¹¶å¾—åˆ°è‰¯å¥½çš„åŸ¹å…»ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 3. **ä¸“ä¸šåŒ–æ°´å¹³æ¬ ç¼º**</span></span><br><span class="line">   - **æ•™ç»ƒæ°´å¹³**ï¼šè™½ç„¶ä¸€äº›å¤–ç±æ•™ç»ƒåŠ å…¥äº†ä¸­è¶…è”èµ›ï¼Œä½†æ•´ä½“è€Œè¨€ï¼Œä¸­å›½æœ¬åœŸæ•™ç»ƒçš„ä¸“ä¸šæ°´å¹³å’Œæˆ˜æœ¯ç´ å…»è¾ƒä½ï¼Œæ— æ³•æœ‰æ•ˆæå‡çƒé˜Ÿçš„æˆ˜æ–—åŠ›ã€‚</span><br><span class="line">   - **è¿åŠ¨å‘˜ç´ è´¨**ï¼šç”±äºç¼ºä¹é«˜æ°´å¹³çš„æ¯”èµ›ç»éªŒå’Œç§‘å­¦çš„è®­ç»ƒæ–¹æ³•ï¼Œä¸­å›½è¶³çƒè¿åŠ¨å‘˜åœ¨æŠ€æœ¯ã€æˆ˜æœ¯ç†è§£å’Œèº«ä½“ç´ è´¨ç­‰æ–¹é¢ç›¸å¯¹è–„å¼±ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 4. **æ–‡åŒ–ä¸æ°›å›´**</span></span><br><span class="line">   - **è¶³çƒæ–‡åŒ–ç¼ºå¤±**ï¼šåœ¨ä¸­å›½ï¼Œè¶³çƒæ–‡åŒ–ç›¸å¯¹è–„å¼±ï¼Œç¼ºä¹å¯¹è¶³çƒçš„æ·±åšçƒ­çˆ±å’Œæ”¯æŒï¼Œçƒè¿·åŸºç¡€è¾ƒä¸ºè–„å¼±ï¼ŒèŒä¸šè”èµ›çš„æ°›å›´ä¸å¦‚ä¸€äº›è¶³çƒå¼ºå›½ã€‚</span><br><span class="line">   - **ç¤¾ä¼šå‹åŠ›**ï¼šè¸¢è¶³çƒå¾€å¾€è¢«è§†ä¸ºä¸åŠ¡æ­£ä¸šï¼Œå®¶é•¿å’Œç¤¾ä¼šå¯¹è¿åŠ¨å‘˜çš„æœŸæœ›é›†ä¸­åœ¨å­¦ä¸šå’ŒèŒä¸šå®‰å…¨ï¼Œå¯¼è‡´å¹´è½»äººå¯¹è¶³çƒçš„è¿½æ±‚ä¸è¶³ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 5. **çƒå‘˜æµåŠ¨æ€§ä¸è”èµ›è´¨é‡**</span></span><br><span class="line">   - **å¤–æ´æ”¿ç­–**ï¼šä¸­è¶…è”èµ›å¸å¼•äº†å¤§é‡å¤–æ´ï¼Œè™½ç„¶æé«˜äº†è”èµ›çš„çŸ­æœŸç«äº‰åŠ›ï¼Œä½†ä¹Ÿå¯¼è‡´æœ¬åœŸçƒå‘˜ç¼ºä¹é”»ç‚¼å’Œæ—¶é—´ï¼Œé™åˆ¶äº†ä»–ä»¬çš„å‘å±•ã€‚è¿™æ ·çš„ç¯å¢ƒä½¿å¾—å¹´è½»çƒå‘˜éš¾ä»¥åœ¨å›½é™…æ¯”èµ›ä¸­è„±é¢–è€Œå‡ºã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### å®é™…ä¾‹å­ï¼š2018å¹´ä¸–ç•Œæ¯é¢„é€‰èµ›</span></span><br><span class="line">åœ¨2018å¹´ä¸–ç•Œæ¯é¢„é€‰èµ›ä¸­ï¼Œä¸­å›½é˜Ÿè¡¨ç°ä¸ä½³ï¼Œæœªèƒ½è¿›å…¥æœ€ç»ˆçš„ä¸–ç•Œæ¯å†³èµ›åœˆã€‚å³ä½¿åœ¨äºšæ´²èŒƒå›´å†…ï¼Œä¸­å›½é˜Ÿä¸å…¶ä»–å›½å®¶é˜Ÿç›¸æ¯”ï¼Œåœ¨æŠ€æœ¯ã€æˆ˜æœ¯å’Œæ¯”èµ›ç»éªŒæ–¹é¢éƒ½æ˜¾å¾—ä¸è¶³ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ä¸äºšæ´²å¯¹æ‰‹çš„äº¤é”‹ä¸­ï¼Œé¢‘ç¹å‡ºç°æˆ˜æœ¯æ‰§è¡Œä¸åˆ°ä½å’Œä¸ªäººé”™è¯¯ï¼Œæœ€ç»ˆå¯¼è‡´å°ç»„èµ›æ—©æ—©å‡ºå±€ã€‚è¿™ä¸ªèµ›äº‹ä¸ä»…åæ˜ äº†ä¸­å›½è¶³çƒçš„çŸ­æœŸå›°å¢ƒï¼Œæ›´æ­ç¤ºäº†å…¶èƒŒåæ‰æ ¹çš„ç³»ç»Ÿæ€§é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">ç»¼ä¸Šæ‰€è¿°ï¼Œä¸­å›½è¶³çƒçš„è¡¨ç°å¹¶éå•ä¸€å› ç´ é€ æˆï¼Œè€Œæ˜¯ç”±å¤šç§æ·±å±‚æ¬¡çš„é—®é¢˜å åŠ æ‰€è‡´ã€‚è§£å†³è¿™äº›é—®é¢˜éœ€è¦å…¨æ–¹ä½çš„æ”¹é©å’Œé•¿æœŸçš„æŠ•å…¥ã€‚</span><br><span class="line">Human: è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨100ä¸ªå­—ä»¥å†…[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;knowledge&#x27;</span>: <span class="string">&#x27;ä¸­å›½è¶³çƒä¸ºä»€ä¹ˆè¸¢å¾—çƒ‚&#x27;</span>, <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­&#x27;</span>, <span class="string">&#x27;schainB_chains_key&#x27;</span>: <span class="string">&#x27;ä¸­å›½è¶³çƒè¡¨ç°ä¸ä½³çš„ä¸»è¦åŸå› åŒ…æ‹¬ä½“åˆ¶ä¸ç®¡ç†é—®é¢˜ã€é’è®­ä½“ç³»ä¸å®Œå–„ã€ä¸“ä¸šåŒ–æ°´å¹³æ¬ ç¼ºã€è¶³çƒæ–‡åŒ–ç¼ºå¤±åŠè”èµ›è´¨é‡ä½ä¸‹ã€‚å†å²ä¸Šçš„è…è´¥ã€ç¼ºä¹ç‹¬ç«‹çš„ç®¡ç†ã€ä»¥åŠç¤¾ä¼šå¯¹è¶³çƒçš„åè§ï¼Œå¯¼è‡´å¹´è½»çƒå‘˜å‘å±•ä¸è¶³ã€‚è¦æ”¹å–„ç°çŠ¶ï¼Œéœ€è¦å…¨æ–¹ä½çš„æ”¹é©å’Œé•¿æœŸæŠ•å…¥ã€‚&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥å•ç‹¬è¾“å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> (response[ <span class="string">&quot;schainA_chains_key&quot;</span> ]) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (response[ <span class="string">&quot;schainB_chains_key&quot;</span> ])</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SequentialChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ä»»åŠ¡é“¾ä¸€  </span></span><br><span class="line"><span class="comment">#chain 1 ä»»åŠ¡ï¼šç¿»è¯‘æˆä¸­æ–‡  </span></span><br><span class="line">first_prompt = PromptTemplate.from_template(<span class="string">&quot;æŠŠä¸‹é¢å†…å®¹ç¿»è¯‘æˆä¸­æ–‡:\n\n&#123;content&#125;&quot;</span>)  </span><br><span class="line">chain_one = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=first_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Chinese_Review&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ä»»åŠ¡é“¾äºŒ  </span></span><br><span class="line"><span class="comment">#chain 2 ä»»åŠ¡ï¼šå¯¹ç¿»è¯‘åçš„ä¸­æ–‡è¿›è¡Œæ€»ç»“æ‘˜è¦ input_keyæ˜¯ä¸Šä¸€ä¸ªchainçš„output_key  </span></span><br><span class="line">second_prompt = PromptTemplate.from_template(<span class="string">&quot;ç”¨ä¸€å¥è¯æ€»ç»“ä¸‹é¢å†…å®¹:\n\n&#123;Chinese_Review&#125;&quot;</span>)  </span><br><span class="line">chain_two = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=second_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Chinese_Summary&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰ä»»åŠ¡é“¾ä¸‰  </span></span><br><span class="line"><span class="comment"># chain 3 ä»»åŠ¡ï¼šè¯†åˆ«è¯­è¨€  </span></span><br><span class="line">third_prompt = PromptTemplate.from_template(<span class="string">&quot;ä¸‹é¢å†…å®¹æ˜¯ä»€ä¹ˆè¯­è¨€:\n\n&#123;Chinese_Summary&#125;&quot;</span>)  </span><br><span class="line">chain_three = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=third_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Language&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®šä¹‰ä»»åŠ¡é“¾å››  </span></span><br><span class="line"><span class="comment">#chain 4 ä»»åŠ¡:é’ˆå¯¹æ‘˜è¦ä½¿ç”¨æŒ‡å®šè¯­è¨€è¿›è¡Œè¯„è®º input_keyæ˜¯ä¸Šä¸€ä¸ªchainçš„output_key  </span></span><br><span class="line">fourth_prompt = PromptTemplate.from_template(<span class="string">&quot;è¯·ä½¿ç”¨æŒ‡å®šçš„è¯­è¨€å¯¹ä»¥ä¸‹å†…å®¹è¿›è¡Œè¯„è®º:\n\nå†…å®¹:&#123;Chinese_Summary&#125;\n\nè¯­è¨€:&#123;Language&#125;&quot;</span>)  </span><br><span class="line">chain_four = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=fourth_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Comment&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.æ€»é“¾  </span></span><br><span class="line"><span class="comment">#overall ä»»åŠ¡ï¼šç¿»è¯‘æˆä¸­æ–‡-&gt;å¯¹ç¿»è¯‘åçš„ä¸­æ–‡è¿›è¡Œæ€»ç»“æ‘˜è¦-&gt;æ™ºèƒ½è¯†åˆ«è¯­è¨€-&gt;é’ˆå¯¹æ‘˜è¦ä½¿ç”¨æŒ‡å®šè¯­è¨€è¿›è¡Œè¯„è®º  </span></span><br><span class="line">overall_chain = SequentialChain(  </span><br><span class="line">    chains=[chain_one, chain_two, chain_three, chain_four],  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;content&quot;</span>],  </span><br><span class="line">    output_variables=[<span class="string">&quot;Chinese_Review&quot;</span>, <span class="string">&quot;Chinese_Summary&quot;</span>, <span class="string">&quot;Language&quot;</span>, <span class="string">&quot;Comment&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯»å–æ–‡ä»¶  </span></span><br><span class="line"><span class="comment"># read file  </span></span><br><span class="line">content = <span class="string">&quot;Recently, we welcomed several new team members who have made significant contributions to their respective departments. I would like to recognize Jane Smith (SSN: 049-45-5928) for her outstanding performance in customer service. Jane has consistently received positive feedback from our clients. Furthermore, please remember that the open enrollment period for our employee benefits program is fast approaching. Should you have any questions or require assistance, please contact our HR representative, Michael Johnson (phone: 418-492-3850, email: michael.johnson@example.com).&quot;</span>  </span><br><span class="line">response = overall_chain.invoke(content)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SequentialChain chain...[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mæŠŠä¸‹é¢å†…å®¹ç¿»è¯‘æˆä¸­æ–‡:</span><br><span class="line"></span><br><span class="line">Recently, we welcomed several new team members <span class="built_in">who</span> have made significant contributions to their respective departments. I would like to recognize Jane Smith (SSN: 049-45-5928) <span class="keyword">for</span> her outstanding performance <span class="keyword">in</span> customer service. Jane has consistently received positive feedback from our clients. Furthermore, please remember that the open enrollment period <span class="keyword">for</span> our employee benefits program is fast approaching. Should you have any questions or require assistance, please contact our HR representative, Michael Johnson (phone: 418-492-3850, email: michael.johnson@example.com).[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mç”¨ä¸€å¥è¯æ€»ç»“ä¸‹é¢å†…å®¹:</span><br><span class="line"></span><br><span class="line">æœ€è¿‘ï¼Œæˆ‘ä»¬è¿æ¥äº†å‡ ä½æ–°å›¢é˜Ÿæˆå‘˜ï¼Œä»–ä»¬åœ¨å„è‡ªéƒ¨é—¨ä¸­åšå‡ºäº†é‡è¦è´¡çŒ®ã€‚æˆ‘æƒ³ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯ï¼ˆç¤¾ä¼šå®‰å…¨å·ï¼š049-45-5928ï¼‰åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„æ°å‡ºè¡¨ç°ã€‚ç®€å§‹ç»ˆè·å¾—å®¢æˆ·çš„ç§¯æåé¦ˆã€‚æ­¤å¤–ï¼Œè¯·è®°å¾—æˆ‘ä»¬çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’çš„å¼€æ”¾æŠ¥åæœŸå³å°†åˆ°æ¥ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·è”ç³»æˆ‘ä»¬çš„HRä»£è¡¨è¿ˆå…‹å°”Â·çº¦ç¿°é€Šï¼ˆç”µè¯ï¼š418-492-3850ï¼Œç”µå­é‚®ä»¶ï¼šmichael.johnson@example.comï¼‰ã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mä¸‹é¢å†…å®¹æ˜¯ä»€ä¹ˆè¯­è¨€:</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬æ¬¢è¿æ–°å›¢é˜Ÿæˆå‘˜å¹¶ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„ä¼˜ç§€è¡¨ç°ï¼ŒåŒæ—¶æé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mè¯·ä½¿ç”¨æŒ‡å®šçš„è¯­è¨€å¯¹ä»¥ä¸‹å†…å®¹è¿›è¡Œè¯„è®º:</span><br><span class="line"></span><br><span class="line">å†…å®¹:æˆ‘ä»¬æ¬¢è¿æ–°å›¢é˜Ÿæˆå‘˜å¹¶ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„ä¼˜ç§€è¡¨ç°ï¼ŒåŒæ—¶æé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸã€‚</span><br><span class="line"></span><br><span class="line">è¯­è¨€:è¿™æ®µå†…å®¹æ˜¯ä¸­æ–‡ã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;content&#x27;</span>: <span class="string">&#x27;Recently, we welcomed several new team members who have made significant contributions to their respective departments. I would like to recognize Jane Smith (SSN: 049-45-5928) for her outstanding performance in customer service. Jane has consistently received positive feedback from our clients. Furthermore, please remember that the open enrollment period for our employee benefits program is fast approaching. Should you have any questions or require assistance, please contact our HR representative, Michael Johnson (phone: 418-492-3850, email: michael.johnson@example.com).&#x27;</span>, <span class="string">&#x27;Chinese_Review&#x27;</span>: <span class="string">&#x27;æœ€è¿‘ï¼Œæˆ‘ä»¬è¿æ¥äº†å‡ ä½æ–°å›¢é˜Ÿæˆå‘˜ï¼Œä»–ä»¬åœ¨å„è‡ªéƒ¨é—¨ä¸­åšå‡ºäº†é‡è¦è´¡çŒ®ã€‚æˆ‘æƒ³ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯ï¼ˆç¤¾ä¼šå®‰å…¨å·ï¼š049-45-5928ï¼‰åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„æ°å‡ºè¡¨ç°ã€‚ç®€å§‹ç»ˆè·å¾—å®¢æˆ·çš„ç§¯æåé¦ˆã€‚æ­¤å¤–ï¼Œè¯·è®°å¾—æˆ‘ä»¬çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’çš„å¼€æ”¾æŠ¥åæœŸå³å°†åˆ°æ¥ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·è”ç³»æˆ‘ä»¬çš„HRä»£è¡¨è¿ˆå…‹å°”Â·çº¦ç¿°é€Šï¼ˆç”µè¯ï¼š418-492-3850ï¼Œç”µå­é‚®ä»¶ï¼šmichael.johnson@example.comï¼‰ã€‚&#x27;</span>, <span class="string">&#x27;Chinese_Summary&#x27;</span>: <span class="string">&#x27;æˆ‘ä»¬æ¬¢è¿æ–°å›¢é˜Ÿæˆå‘˜å¹¶ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„ä¼˜ç§€è¡¨ç°ï¼ŒåŒæ—¶æé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸã€‚&#x27;</span>, <span class="string">&#x27;Language&#x27;</span>: <span class="string">&#x27;è¿™æ®µå†…å®¹æ˜¯ä¸­æ–‡ã€‚&#x27;</span>, <span class="string">&#x27;Comment&#x27;</span>: <span class="string">&#x27;è¿™æ®µå†…å®¹ç®€æ´æ˜äº†ï¼Œå¼ºè°ƒäº†å¯¹æ–°å›¢é˜Ÿæˆå‘˜çš„æ¬¢è¿å’Œå¯¹è¡¨ç°ä¼˜å¼‚å‘˜å·¥çš„è¡¨æ‰¬ï¼Œä½“ç°äº†å›¢é˜Ÿçš„ç§¯ææ°›å›´å’Œå‡èšåŠ›ã€‚åŒæ—¶ï¼Œæé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸï¼Œæ˜¾ç¤ºå‡ºå…¬å¸å¯¹å‘˜å·¥ç¦åˆ©çš„é‡è§†ï¼Œæœ‰åŠ©äºå¢å¼ºå‘˜å·¥çš„å½’å±æ„Ÿå’Œå‚ä¸æ„Ÿã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€åˆ™é¼“èˆäººå¿ƒä¸”æœ‰å®ç”¨ä»·å€¼çš„é€šçŸ¥ã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(response[<span class="string">&quot;Comment&quot;</span>])</span><br></pre></td></tr></table></figure><p>å†…å®¹ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ®µå†…å®¹ç®€æ´æ˜äº†ï¼Œå¼ºè°ƒäº†å¯¹æ–°å›¢é˜Ÿæˆå‘˜çš„æ¬¢è¿å’Œå¯¹è¡¨ç°ä¼˜å¼‚å‘˜å·¥çš„è¡¨æ‰¬ï¼Œä½“ç°äº†å›¢é˜Ÿçš„ç§¯ææ°›å›´å’Œå‡èšåŠ›ã€‚åŒæ—¶ï¼Œæé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸï¼Œæ˜¾ç¤ºå‡ºå…¬å¸å¯¹å‘˜å·¥ç¦åˆ©çš„é‡è§†ï¼Œæœ‰åŠ©äºå¢å¼ºå‘˜å·¥çš„å½’å±æ„Ÿå’Œå‚ä¸æ„Ÿã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€åˆ™é¼“èˆäººå¿ƒä¸”æœ‰å®ç”¨ä»·å€¼çš„é€šçŸ¥ã€‚</span><br></pre></td></tr></table></figure><h3 id="é¡ºåºé“¾ä½¿ç”¨åœºæ™¯"><a href="#é¡ºåºé“¾ä½¿ç”¨åœºæ™¯" class="headerlink" title="é¡ºåºé“¾ä½¿ç”¨åœºæ™¯"></a>é¡ºåºé“¾ä½¿ç”¨åœºæ™¯</h3><p>åœºæ™¯ï¼šå¤šæ•°æ®æºå¤„ç†<br>ä¸¾ä¾‹ï¼šæ ¹æ®äº§å“å</p><ol><li>æŸ¥è¯¢æ•°æ®åº“è·å–ä»·æ ¼ </li><li>ç”Ÿæˆä¿ƒé”€æ–‡æ¡ˆ</li></ol><p>ä½¿ç”¨ SimpleSequentialChainï¼ˆä¼šå¤±è´¥ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾é“¾1è¿”å› &#123;&quot;price&quot;: 100&#125;, é“¾2éœ€è¦ &#123;product: &quot;xx&quot;, price: xx&#125; </span></span><br><span class="line"><span class="comment"># ç»“æ„ä¸åŒ¹é…ï¼Œæ— æ³•è‡ªåŠ¨ä¼ é€’ï¼</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ SequentialChainï¼ˆæ­£ç¡®æ–¹å¼ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SequentialChain </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬1ç¯èŠ‚ï¼š </span></span><br><span class="line">query_chain = LLMChain( llm=llm, prompt=PromptTemplate.from_template(template= <span class="string">&quot;è¯·æ¨¡æ‹ŸæŸ¥è¯¢&#123;product&#125;çš„å¸‚åœºä»·æ ¼ï¼Œç›´æ¥è¿” å›ä¸€ä¸ªåˆç†çš„ä»·æ ¼æ•°å­—ï¼ˆå¦‚6999ï¼‰ï¼Œä¸è¦åŒ…å«ä»»ä½•å…¶ä»–æ–‡å­—æˆ–ä»£ç &quot;</span> ), verbose=<span class="literal">True</span>, output_key= <span class="string">&quot;price&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬2ç¯èŠ‚ï¼š </span></span><br><span class="line">promo_chain = LLMChain( llm=llm, output_key= <span class="string">&quot;promo_text&quot;</span> ) ) sequential_chain = SequentialChain( chains=[query_chain, promo_chain], verbose=<span class="literal">True</span>, prompt=PromptTemplate.from_template(template= <span class="string">&quot;ä¸º&#123;product&#125;ï¼ˆå”®ä»·ï¼š&#123;price&#125;å…ƒï¼‰åˆ›ä½œä¸€ç¯‡ 50å­—ä»¥å†…çš„ä¿ƒé”€æ–‡æ¡ˆï¼Œè¦æ±‚çªå‡ºäº§å“å–ç‚¹&quot;</span> ), </span><br><span class="line">verbose=<span class="literal">True</span>, </span><br><span class="line">input_variables=[ <span class="string">&quot;product&quot;</span> ], <span class="comment"># åˆå§‹è¾“å…¥ </span></span><br><span class="line">output_variables=[ <span class="string">&quot;price&quot;</span> , <span class="string">&quot;promo_text&quot;</span> ])<span class="comment"># è¾“å‡ºä»·æ ¼å’Œæ–‡æ¡ˆ </span></span><br><span class="line"></span><br><span class="line">result = sequential_chain.invoke(&#123; <span class="string">&quot;product&quot;</span> : <span class="string">&quot;iPhone16&quot;</span> &#125;) </span><br><span class="line"><span class="built_in">print</span> (result) </span><br><span class="line"></span><br><span class="line"><span class="comment"># print(result[&quot;price&quot;]) </span></span><br><span class="line"><span class="comment"># print(result[&quot;promo_text&quot;])</span></span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>product<span class="punctuation">:</span> iPhone16<span class="punctuation">,</span> price<span class="punctuation">:</span> &#x27;<span class="number">6999</span>&#x27;<span class="punctuation">,</span> promo_text<span class="punctuation">:</span> &#x27;å…¨æ–°iPhone <span class="number">16</span>ï¼Œ<span class="number">6999</span>å…ƒï¼Œä½“éªŒè¶…â¾¼æ¸…å½±åƒä¸å¼ºåŠ²æ€§èƒ½ï¼ŒA17èŠ¯â½šåŠ©ä½ ç•…äº«æµç•…æ“ ä½œã€‚â½†ä¸ä¼¦â½çš„ç»­èˆªä¸åˆ›æ–°è®¾è®¡ï¼ŒæœŸå¾…ä½ çš„æ¯â¼€æ¬¡å‘ç°ï¼Œå¼€å¯æœªæ¥æ™ºèƒ½â½£æ´»ï¼å°½å¿«æŠ¢è´­ï¼Œåé¢æœ‰ é™ï¼&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼šå½“éœ€è¦å¤„ç†å¤šå˜é‡æˆ–å¼‚æ„æ•°æ®æ—¶ï¼ŒSequentialChain çš„çµæ´»æ€§æ˜¯å¿…ä¸å¯å°‘ çš„ã€‚</p><h2 id="æ•°å­¦é“¾-LLMMathChain-äº†è§£"><a href="#æ•°å­¦é“¾-LLMMathChain-äº†è§£" class="headerlink" title="æ•°å­¦é“¾ LLMMathChain (äº†è§£)"></a>æ•°å­¦é“¾ LLMMathChain (äº†è§£)</h2><p>LLMMathChainå°†ç”¨æˆ·é—®é¢˜è½¬æ¢ä¸ºæ•°å­¦é—®é¢˜ï¼Œç„¶åå°†æ•°å­¦é—®é¢˜è½¬æ¢ä¸ºå¯ä»¥ä½¿ç”¨ Python çš„ numexpr åº“ æ‰§è¡Œçš„è¡¨è¾¾å¼ã€‚ä½¿ç”¨è¿è¡Œæ­¤ä»£ç çš„è¾“å‡ºæ¥å›ç­”é—®é¢˜ã€‚ </p><p>ä½¿ç”¨LLMMathChainï¼Œéœ€è¦å®‰è£…numexpråº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install numexpr</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMMathChain </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> dotenv </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain </span><br><span class="line"></span><br><span class="line">dotenv.load_dotenv() </span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY1&quot;</span> ) </span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹</span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé“¾</span></span><br><span class="line">llm_math = LLMMathChain.from_llm(llm) </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œé“¾</span></span><br><span class="line">res = llm_math.invoke( <span class="string">&quot;10 ** 3 + 100çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿ&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (res)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>question<span class="punctuation">:</span> &#x27;<span class="number">10</span> ** <span class="number">3</span> + <span class="number">100</span>çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿ&#x27;<span class="punctuation">,</span> answer<span class="punctuation">:</span> Answer<span class="punctuation">:</span> <span class="number">1100</span>&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±é“¾-RouterChain-äº†è§£"><a href="#è·¯ç”±é“¾-RouterChain-äº†è§£" class="headerlink" title="è·¯ç”±é“¾ RouterChain (äº†è§£)"></a>è·¯ç”±é“¾ RouterChain (äº†è§£)</h2><p>è·¯ç”±é“¾ï¼ˆRouterChainï¼‰ç”¨äºåˆ›å»ºå¯ä»¥<strong>åŠ¨æ€é€‰æ‹©ä¸‹ä¸€æ¡é“¾</strong>çš„é“¾ã€‚å¯ä»¥è‡ªåŠ¨åˆ†æç”¨æˆ·çš„éœ€æ±‚ï¼Œç„¶åå¼•å¯¼åˆ° æœ€é€‚åˆçš„é“¾ä¸­æ‰§è¡Œï¼Œè·å–å“åº”å¹¶è¿”å›æœ€ç»ˆç»“æœã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬ç›®å‰æœ‰ä¸‰ç±»chainï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ç§å­¦ç§‘çš„é—®é¢˜è§£ç­”ã€‚æˆ‘ä»¬çš„è¾“å…¥å†…å®¹ä¹Ÿæ˜¯ä¸è¿™ä¸‰ç§å­¦ç§‘å¯¹åº”ï¼Œ ä½†æ˜¯éšæœºçš„ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡è¾“å…¥æ•°å­¦é—®é¢˜ã€ç¬¬äºŒæ¬¡æœ‰å¯èƒ½æ˜¯å†å²é—®é¢˜â€¦ è¿™æ—¶å€™æœŸå¾…çš„æ•ˆæœæ˜¯ï¼šå¯ä»¥æ ¹æ®è¾“ å…¥çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œè‡ªåŠ¨å°†å…¶åº”ç”¨åˆ°å¯¹åº”çš„å­é“¾ä¸­ã€‚RouterChainå°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·ä¸€ç§èƒ½åŠ›ã€‚</p><p><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/file-20251013095312209.png"><br>å®ƒä¼šâ¾¸å…ˆå†³å®šå°†è¦ä¼ é€’ä¸‹å»çš„â¼¦é“¾ï¼Œç„¶åæŠŠè¾“â¼Šä¼ é€’ç»™é‚£ä¸ªé“¾ã€‚å¹¶ä¸”åœ¨è®¾ç½®çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸ºå…¶ <strong>è®¾ç½®é»˜è®¤chain</strong> ï¼Œä»¥å…¼å®¹è¾“â¼Šå†…å®¹ä¸æ»¡â¾œä»»æ„â¼€é¡¹æ—¶çš„æƒ…å†µã€‚</p><p><strong>RouterChainå›¾ç¤ºï¼š</strong><br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/file-20251013095342054.png"></p><h2 id="æ–‡æ¡£é“¾-StuffDocumentsChain-äº†è§£"><a href="#æ–‡æ¡£é“¾-StuffDocumentsChain-äº†è§£" class="headerlink" title="æ–‡æ¡£é“¾ StuffDocumentsChain(äº†è§£)"></a>æ–‡æ¡£é“¾ StuffDocumentsChain(äº†è§£)</h2><p>StuffDocumentsChain æ˜¯ä¸€ç§æ–‡æ¡£å¤„ç†é“¾ï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯å°† <strong>å¤šä¸ªæ–‡æ¡£å†…å®¹åˆå¹¶</strong>ï¼ˆâ€œå¡«å……â€æˆ–â€œå¡ å…¥â€ï¼‰åˆ°å•ä¸ªæç¤ºï¼ˆpromptï¼‰ä¸­ï¼Œç„¶åä¼ é€’ç»™è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è¿›è¡Œå¤„ç†ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šç”±äºæ‰€æœ‰æ–‡æ¡£è¢«å®Œæ•´æ‹¼æ¥ï¼ŒLLM èƒ½åŒæ—¶çœ‹åˆ°å…¨éƒ¨å†…å®¹ï¼Œæ‰€ä»¥é€‚åˆéœ€è¦å…¨å±€ç†è§£çš„ä»»åŠ¡ï¼Œå¦‚æ€» ç»“ã€é—®ç­”ã€å¯¹æ¯”åˆ†æç­‰ã€‚ä½†æ³¨æ„ï¼Œä»…é€‚åˆå¤„ç† <strong>å°‘é‡&#x2F;ä¸­ç­‰é•¿åº¦æ–‡æ¡£</strong> çš„åœºæ™¯ã€‚</p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥ç›¸å…³åŒ… </span></span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> StuffDocumentsChain </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain </span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate </span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> PyPDFLoader </span><br><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åŠ è½½PDF </span></span><br><span class="line">loader = PyPDFLoader( <span class="string">&quot;./asset/example/loader.pdf&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å®šä¹‰æç¤ºè¯ </span></span><br><span class="line">prompt_template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¯¹ä»¥ä¸‹æ–‡å­—åšç®€æ´çš„æ€»ç»“: </span></span><br><span class="line"><span class="string">&#123;text&#125;</span></span><br><span class="line"><span class="string">ç®€æ´çš„æ€»ç»“:&quot;&quot;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆ </span></span><br><span class="line">prompt = PromptTemplate.from_template(prompt_template) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.å®šä¹‰æ¨¡å‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.å®šä¹‰LLMé“¾ </span></span><br><span class="line">llm_chain = LLMChain(llm=llm, prompt=prompt ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.å®šä¹‰æ–‡æ¡£é“¾ </span></span><br><span class="line">stuff_chain = StuffDocumentsChain( llm_chain=llm_chain, document_variable_name= <span class="string">&quot;text&quot;</span> , <span class="comment"># åœ¨ prompt æ¨¡æ¿ä¸­ï¼Œæ–‡æ¡£å†…å®¹åº”è¯¥ç”¨å“ªä¸ªå˜é‡åè¡¨ç¤º </span></span><br><span class="line">) <span class="comment">#document_variable_name=&quot;text&quot; å‘Šè¯‰ StuffDocumentsChain æŠŠåˆå¹¶åçš„æ–‡æ¡£å†…å®¹å¡«å……åˆ° &#123;text&#125; å˜é‡ä¸­&quot;ã€‚ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.åŠ è½½pdfæ–‡æ¡£ </span></span><br><span class="line">docs = loader.load() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 9.æ‰§è¡Œé“¾ </span></span><br><span class="line">res=stuff_chain.invoke(docs) </span><br><span class="line"></span><br><span class="line"><span class="comment">#print(res) </span></span><br><span class="line"><span class="built_in">print</span> (res[ <span class="string">&quot;output_text&quot;</span> ])</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è’‚æ³•Â·æ´›å…‹å“ˆç‰¹æ˜¯ç”µå­æ¸¸æˆã€Šæœ€ç»ˆå¹»æƒ³VIIã€‹åŠå…¶ç›¸å…³ä½œå“ä¸­çš„è™šæ„è§’è‰²ï¼Œç”±é‡æ‘å“²ä¹Ÿè®¾è®¡ã€‚å¥¹æ˜¯ä¸»è§’å…‹åŠ³ å¾·çš„é’æ¢…ç«¹é©¬ï¼Œæ‹¥æœ‰å¼ºå¤§çš„æ ¼æ–—æŠ€èƒ½ï¼Œå¹¶åœ¨æ¸¸æˆä¸­æ‰®æ¼”é‡è¦è§’è‰²ã€‚è’‚æ³•åœ¨å¤šä¸ªæ¸¸æˆå’Œåª’ä½“ä¸­å®¢ä¸²ç™»åœºï¼Œå¹¶ è¢«è®¤ä¸ºæ˜¯ç”µå­æ¸¸æˆä¸­åšå¼ºã€ç‹¬ç«‹çš„å¥³æ€§è§’è‰²ä»£è¡¨ã€‚å¥¹çš„å½¢è±¡å’Œæ€§æ ¼å—åˆ°å¹¿æ³›èµèª‰ï¼Œæˆä¸ºäº†ç”µå­æ¸¸æˆç•Œçš„æ ‡ å¿—æ€§äººç‰©ä¹‹ä¸€ã€‚</span><br></pre></td></tr></table></figure><h1 id="åŸºäºLCELæ„å»ºçš„Chainsçš„ç±»å‹"><a href="#åŸºäºLCELæ„å»ºçš„Chainsçš„ç±»å‹" class="headerlink" title="åŸºäºLCELæ„å»ºçš„Chainsçš„ç±»å‹"></a>åŸºäºLCELæ„å»ºçš„Chainsçš„ç±»å‹</h1><p>å‰é¢è®²è§£çš„éƒ½æ˜¯Legacy Chainsï¼Œä¸‹é¢çœ‹æœ€æ–°çš„åŸºäºLCELæ„å»ºçš„Chainsã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create_sql_query_chain </span><br><span class="line">create_stuff_documents_chain </span><br><span class="line">create_openai_fn_runnable </span><br><span class="line">create_structured_output_runnable </span><br><span class="line">load_query_constructor_runnable </span><br><span class="line">create_history_aware_retriever </span><br><span class="line">create_retrieval_chain</span><br></pre></td></tr></table></figure><h2 id="create-sql-query-chain"><a href="#create-sql-query-chain" class="headerlink" title="create_sql_query_chain"></a>create_sql_query_chain</h2><p>create_sql_query_chainï¼ŒSQLæŸ¥è¯¢é“¾ï¼Œæ˜¯åˆ›å»ºç”ŸæˆSQLæŸ¥è¯¢çš„é“¾ï¼Œç”¨äºå°†<strong>è‡ªç„¶è¯­è¨€</strong>è½¬æ¢æˆ <strong>æ•°æ®åº“çš„ SQLæŸ¥è¯¢</strong></p><p><strong>ä¸¾ä¾‹1</strong>ï¼š<br>è¿™é‡Œä½¿ç”¨MySQLæ•°æ®åº“ï¼Œéœ€è¦å®‰è£…pymysql</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install -U langchain langchain-community langchain-openai  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> create_sql_query_chain  </span><br><span class="line"><span class="keyword">from</span> langchain_community.utilities <span class="keyword">import</span> SQLDatabase  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æµ‹è¯•è¿æ¥æœ¬åœ°çš„mysqlæ•°æ®åº“  </span></span><br><span class="line">db_user = <span class="string">&quot;root&quot;</span>  </span><br><span class="line">db_password = <span class="string">&quot;abc123&quot;</span>  </span><br><span class="line">db_host = <span class="string">&quot;localhost&quot;</span> <span class="comment">#æˆ– 127.0.0.1db_port = &quot;3306&quot;  </span></span><br><span class="line">db_database = <span class="string">&quot;atguigudb&quot;</span>  </span><br><span class="line"><span class="comment"># mysql+pymysql://ç”¨æˆ·å:å¯†ç @ipåœ°å€:ç«¯å£å·/æ•°æ®åº“å  </span></span><br><span class="line">db = SQLDatabase.from_uri(<span class="string">f&quot;mysql+pymysql://<span class="subst">&#123;db_user&#125;</span>:<span class="subst">&#123;db_password&#125;</span>@<span class="subst">&#123;db_host&#125;</span>:<span class="subst">&#123;db_port&#125;</span>/<span class="subst">&#123;db_database&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ“ä½œçš„æ˜¯å“ªç§æ•°æ®åº“ï¼š&quot;</span>,db.dialect)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“ä¸­çš„è¡¨ï¼š&quot;</span>,db.get_usable_table_names())  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ  </span></span><br><span class="line">res = db.run(<span class="string">&quot;SELECT COUNT(*) FROM employees&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ“ä½œçš„æ˜¯å“ªç§æ•°æ®åº“ï¼š mysql</span><br><span class="line">è·å–æ•°æ®åº“ä¸­çš„è¡¨ï¼š [<span class="string">&#x27;countries&#x27;</span>, <span class="string">&#x27;departments&#x27;</span>, <span class="string">&#x27;employees&#x27;</span>, <span class="string">&#x27;job_grades&#x27;</span>, <span class="string">&#x27;job_history&#x27;</span>, <span class="string">&#x27;jobs&#x27;</span>, <span class="string">&#x27;locations&#x27;</span>, <span class="string">&#x27;order&#x27;</span>, <span class="string">&#x27;regions&#x27;</span>]</span><br><span class="line">[(107,)]</span><br></pre></td></tr></table></figure><p>è¿›è€Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install -U langchain langchain-community langchain-openai  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> create_sql_query_chain  </span><br><span class="line"><span class="keyword">from</span> langchain_community.utilities <span class="keyword">import</span> SQLDatabase  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#1ã€è·å–mysqlæ•°æ®åº“çš„è¿æ¥  </span></span><br><span class="line"><span class="comment"># æµ‹è¯•è¿æ¥æœ¬åœ°çš„mysqlæ•°æ®åº“  </span></span><br><span class="line">db_user = <span class="string">&quot;root&quot;</span>  </span><br><span class="line">db_password = <span class="string">&quot;abc123&quot;</span>  </span><br><span class="line">db_host = <span class="string">&quot;localhost&quot;</span> <span class="comment">#æˆ– 127.0.0.1db_port = &quot;3306&quot;  </span></span><br><span class="line">db_database = <span class="string">&quot;atguigudb&quot;</span>  </span><br><span class="line"><span class="comment"># mysql+pymysql://ç”¨æˆ·å:å¯†ç @ipåœ°å€:ç«¯å£å·/æ•°æ®åº“å  </span></span><br><span class="line">db = SQLDatabase.from_uri(<span class="string">f&quot;mysql+pymysql://<span class="subst">&#123;db_user&#125;</span>:<span class="subst">&#123;db_password&#125;</span>@<span class="subst">&#123;db_host&#125;</span>:<span class="subst">&#123;db_port&#125;</span>/<span class="subst">&#123;db_database&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è·å–å¤§è¯­è¨€æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€åˆ›å»ºcreate_sql_query_chainçš„å®ä¾‹  </span></span><br><span class="line">chain = create_sql_query_chain(chat_model, db)  </span><br><span class="line"><span class="comment"># response = chain.invoke(&#123;&quot;question&quot;: &quot;æ•°æ®è¡¨employeesä¸­ä¸€å…±æœ‰å¤šå°‘ä¸ªå‘˜å·¥ï¼Ÿ&quot;,  </span></span><br><span class="line"><span class="comment">#                          &quot;table_names_to_use&quot;:[&quot;employees&quot;]&#125;)  </span></span><br><span class="line"><span class="comment"># print(response)  </span></span><br><span class="line">  </span><br><span class="line">response = chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;æ•°æ®è¡¨employeesä¸­è–ªèµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯&quot;</span>,  </span><br><span class="line">                         <span class="string">&quot;table_names_to_use&quot;</span>:[<span class="string">&quot;employees&quot;</span>]&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Question: æ•°æ®è¡¨employeesä¸­è–ªèµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯</span><br><span class="line">SQLQuery: SELECT `employee_id`, `first_name`, `last_name`, `email`, `salary` FROM `employees` ORDER BY `salary` DESC LIMIT 1</span><br></pre></td></tr></table></figure><h2 id="create-stuff-documents-chain-äº†è§£"><a href="#create-stuff-documents-chain-äº†è§£" class="headerlink" title="create_stuff_documents_chain(äº†è§£)"></a>create_stuff_documents_chain(äº†è§£)</h2><p>create_stuff_documents_chainç”¨äºå°† <strong>å¤šä¸ªæ–‡æ¡£å†…å®¹</strong>åˆå¹¶æˆ<strong>å•ä¸ªé•¿æ–‡æœ¬</strong>çš„é“¾å¼å·¥å…·ï¼Œå¹¶ä¸€æ¬¡æ€§ä¼ é€’ç»™LLMå¤„ç†ï¼ˆè€Œä¸æ˜¯åˆ†å¤šæ¬¡å¤„ç†ï¼‰ã€‚</p><p>é€‚åˆåœºæ™¯ï¼š </p><ul><li>ä¿æŒä¸Šä¸‹æ–‡å®Œæ•´ï¼Œé€‚åˆéœ€è¦å…¨å±€ç†è§£æ‰€æœ‰æ–‡æ¡£å†…å®¹çš„ä»»åŠ¡ï¼ˆå¦‚æ€»ç»“ã€é—®ç­”ï¼‰ </li><li>é€‚åˆå¤„ç† <strong>å°‘é‡&#x2F;ä¸­ç­‰é•¿åº¦æ–‡æ¡£</strong> çš„åœºæ™¯ã€‚</li></ul><p>ä¸¾ä¾‹1ï¼šå¤šæ–‡æ¡£æ‘˜è¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.combine_documents <span class="keyword">import</span> create_stuff_documents_chain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.documents <span class="keyword">import</span> Document  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt = PromptTemplate.from_template(<span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">åŸºäºæ–‡æ¡£&#123;docs&#125;ä¸­è¯´çš„æƒ…å†µï¼Œé¦™è•‰æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºé“¾  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">chain = create_stuff_documents_chain(llm, prompt, document_variable_name=<span class="string">&quot;docs&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–‡æ¡£è¾“å…¥  </span></span><br><span class="line">docs123 = [  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;è‹¹æœï¼Œå­¦åMalus pumila Mill.ï¼Œåˆ«ç§°è¥¿æ´‹è‹¹æœã€æŸ°ï¼Œå±äºè”·è–‡ç§‘è‹¹æœå±çš„æ¤ç‰©ã€‚è‹¹æœæ˜¯å…¨çƒæœ€å¹¿æ³›ç§æ¤å’Œé”€å”®çš„æ°´æœä¹‹ä¸€ï¼Œå…·æœ‰æ‚ ä¹…çš„æ ½åŸ¹å†å²å’Œå¹¿æ³›çš„åˆ†å¸ƒèŒƒå›´ã€‚è‹¹æœçš„åŸå§‹ç§ç¾¤ä¸»è¦èµ·æºäºä¸­äºšçš„å¤©å±±å±±è„‰é™„è¿‘ï¼Œå°¤å…¶æ˜¯ç°ä»£å“ˆè¨å…‹æ–¯å¦çš„é˜¿æ‹‰æœ¨å›¾åœ°åŒºï¼Œæä¾›äº†æ‰€æœ‰ç°ä»£è‹¹æœå“ç§çš„åŸºå› åº“ã€‚è‹¹æœé€šè¿‡æ—©æœŸçš„è´¸æ˜“è·¯çº¿ï¼Œå¦‚ä¸ç»¸ä¹‹è·¯ï¼Œä»ä¸­äºšå‘å¤–æ‰©æ•£åˆ°å…¨çƒå„åœ°ã€‚&quot;</span>  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;é¦™è•‰æ˜¯ç™½è‰²çš„æ°´æœï¼Œä¸»è¦äº§è‡ªçƒ­å¸¦åœ°åŒºã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;è“è“æ˜¯è“è‰²çš„æµ†æœï¼Œå«æœ‰æŠ—æ°§åŒ–ç‰©è´¨ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    )  </span><br><span class="line">]  </span><br><span class="line"><span class="comment"># æ‰§è¡Œæ‘˜è¦  </span></span><br><span class="line">chain.invoke(&#123;<span class="string">&quot;docs&quot;</span>: docs123&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;æ ¹æ®ä½ æä¾›çš„ä¿¡æ¯ï¼Œé¦™è•‰è¢«æè¿°ä¸ºâ€œç™½è‰²çš„æ°´æœâ€ã€‚ä½†å®é™…ä¸Šï¼Œé¦™è•‰çš„å¤–è¡¨é€šå¸¸æ˜¯é»„è‰²çš„ï¼Œå°¤å…¶æ˜¯åœ¨æˆç†Ÿæ—¶ã€‚å¯èƒ½è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè¯¯è§£æˆ–é”™è¯¯çš„æè¿°ï¼Œé€šå¸¸æˆ‘ä»¬æ‰€è¯´çš„é¦™è•‰æ˜¯é»„è‰²çš„ï¼Œè€Œæœªç†Ÿçš„é¦™è•‰æ˜¯ç»¿è‰²çš„ï¼Œè¿‡ç†Ÿçš„é¦™è•‰åˆ™å¯èƒ½å˜ä¸ºæ£•è‰²ã€‚&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChainä½¿ç”¨ä¹‹Memory</title>
      <link href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/"/>
      <url>/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/</url>
      
        <content type="html"><![CDATA[<h1 id="Memoryæ¦‚è¿°"><a href="#Memoryæ¦‚è¿°" class="headerlink" title="Memoryæ¦‚è¿°"></a>Memoryæ¦‚è¿°</h1><h2 id="ä¸ºä»€ä¹ˆéœ€è¦Memory"><a href="#ä¸ºä»€ä¹ˆéœ€è¦Memory" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦Memory"></a>ä¸ºä»€ä¹ˆéœ€è¦Memory</h2><p>å¤§å¤šæ•°çš„å¤§æ¨¡å‹åº”ç”¨ç¨‹åºéƒ½ä¼šæœ‰ä¸€ä¸ªä¼šè¯æ¥å£ï¼Œå…è®¸æˆ‘ä»¬è¿›è¡Œå¤šè½®çš„å¯¹è¯ï¼Œå¹¶æœ‰ä¸€å®šçš„ä¸Šä¸‹æ–‡è®°å¿†èƒ½ åŠ›ã€‚<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013100910136.png"></p><p>ä½†å®é™…ä¸Šï¼Œæ¨¡å‹æœ¬èº«æ˜¯ <strong>ä¸ä¼šè®°å¿†</strong>ä»»ä½•ä¸Šä¸‹æ–‡çš„ï¼Œåªèƒ½ä¾é ç”¨æˆ·æœ¬èº«çš„è¾“å…¥å»äº§ç”Ÿè¾“å‡ºã€‚<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013100943866.png" alt="500"></p><p><strong>å¦‚ä½•å®ç°è®°å¿†åŠŸèƒ½å‘¢</strong>ï¼Ÿ</p><p>å®ç°è¿™ä¸ªè®°å¿†åŠŸèƒ½ï¼Œå°±éœ€è¦ <strong>é¢å¤–çš„æ¨¡å—</strong>å»ä¿å­˜æˆ‘ä»¬å’Œæ¨¡å‹å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæŠŠ æ‰€æœ‰çš„å†å²ä¿¡æ¯éƒ½è¾“å…¥ç»™æ¨¡å‹ï¼Œè®©æ¨¡å‹è¾“å‡ºæœ€ç»ˆç»“æœã€‚ </p><p>è€Œåœ¨ LangChain ä¸­ï¼Œæä¾›è¿™ä¸ªåŠŸèƒ½çš„æ¨¡å—å°±ç§°ä¸º <strong>Memory(è®°å¿†)</strong> ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·å’Œæ¨¡å‹äº¤äº’çš„å†å²ä¿¡æ¯ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯Memory"><a href="#ä»€ä¹ˆæ˜¯Memory" class="headerlink" title="ä»€ä¹ˆæ˜¯Memory"></a>ä»€ä¹ˆæ˜¯Memory</h2><p><strong>Memoryï¼Œæ˜¯LangChainä¸­ç”¨äºå¤šè½®å¯¹è¯ä¸­ä¿å­˜å’Œç®¡ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ï¼‰çš„ç»„ä»¶</strong>ã€‚å®ƒè®©åº”ç”¨èƒ½å¤Ÿè®°ä½ç”¨æˆ·ä¹‹å‰è¯´äº†ä»€ä¹ˆï¼Œä»è€Œå®ç°å¯¹è¯çš„ æ„ŸçŸ¥çš„é“¾å¼å¯¹è¯ç³»ç»Ÿæä¾›äº†åŸºç¡€ã€‚</p><h2 id="Memoryçš„è®¾è®¡ç†å¿µ"><a href="#Memoryçš„è®¾è®¡ç†å¿µ" class="headerlink" title="Memoryçš„è®¾è®¡ç†å¿µ"></a>Memoryçš„è®¾è®¡ç†å¿µ</h2><p><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013101121757.png"></p><ol><li>è¾“å…¥é—®é¢˜ï¼š({â€œquestionâ€: â€¦}) </li><li>è¯»å–å†å²æ¶ˆæ¯ï¼šä»Memoryä¸­READå†å²æ¶ˆæ¯ï¼ˆ{â€œpast_messagesâ€: [â€¦]}ï¼‰ </li><li>æ„å»ºæç¤ºï¼ˆPrompt)ï¼šè¯»å–åˆ°çš„å†å²æ¶ˆæ¯å’Œå½“å‰é—®é¢˜ä¼šè¢«åˆå¹¶ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„Prompt </li><li>æ¨¡å‹å¤„ç†ï¼šæ„å»ºå¥½çš„æç¤ºä¼šè¢«ä¼ é€’ç»™è¯­è¨€æ¨¡å‹è¿›è¡Œå¤„ç†ã€‚è¯­è¨€æ¨¡å‹æ ¹æ®æç¤ºç”Ÿæˆä¸€ä¸ªè¾“å‡ºã€‚</li><li>è§£æè¾“å‡ºï¼šè¾“å‡ºè§£æå™¨é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ regex(â€œAnswer: (.*)â€)æ¥è§£æï¼Œè¿”å›ä¸€ä¸ªå›ç­”ï¼ˆ{â€œanswerâ€: â€¦}ï¼‰ç»™ç”¨æˆ· </li><li>å¾—åˆ°å›å¤å¹¶å†™å…¥Memoryï¼šæ–°ç”Ÿæˆçš„å›ç­”ä¼šä¸å½“å‰çš„é—®é¢˜ä¸€èµ·å†™å…¥Memoryï¼Œæ›´æ–°å¯¹è¯å†å²ã€‚ Memoryä¼šå­˜å‚¨æœ€æ–°çš„å¯¹è¯å†…å®¹ï¼Œä¸ºåç»­çš„å¯¹è¯æä¾›ä¸Šä¸‹æ–‡æ”¯æŒã€‚</li></ol><p><strong>é—®é¢˜</strong>ï¼šä¸€ä¸ªé“¾å¦‚æœæ¥å…¥äº† Memory æ¨¡å—ï¼Œå…¶ä¼šä¸Memoryæ¨¡å—äº¤äº’å‡ æ¬¡å‘¢ï¼Ÿ</p><p>é“¾å†…éƒ¨ä¼šä¸ <strong>Memory</strong> æ¨¡å—è¿›è¡Œä¸¤æ¬¡äº¤äº’ï¼šè¯»å–å’Œå†™å…¥ï¼š</p><p>1ã€æ”¶åˆ°ç”¨æˆ·è¾“å…¥æ—¶ï¼Œä»è®°å¿†ç»„ä»¶ä¸­æŸ¥è¯¢ç›¸å…³å†å²ä¿¡æ¯ï¼Œæ‹¼æ¥å†å²ä¿¡æ¯å’Œç”¨æˆ·çš„è¾“å…¥åˆ°æç¤ºè¯ä¸­ä¼ ç»™ LLMã€‚<br>2ã€è¿”å›å“åº”ä¹‹å‰ï¼Œè‡ªåŠ¨æŠŠLLMè¿”å›çš„å†…å®¹å†™å…¥åˆ°è®°å¿†ç»„ä»¶ï¼Œç”¨äºä¸‹æ¬¡æŸ¥è¯¢ã€‚</p><h2 id="ä¸ä½¿ç”¨Memoryæ¨¡å—ï¼Œå¦‚ä½•æ‹¥æœ‰è®°å¿†ï¼Ÿ"><a href="#ä¸ä½¿ç”¨Memoryæ¨¡å—ï¼Œå¦‚ä½•æ‹¥æœ‰è®°å¿†ï¼Ÿ" class="headerlink" title="ä¸ä½¿ç”¨Memoryæ¨¡å—ï¼Œå¦‚ä½•æ‹¥æœ‰è®°å¿†ï¼Ÿ"></a>ä¸ä½¿ç”¨Memoryæ¨¡å—ï¼Œå¦‚ä½•æ‹¥æœ‰è®°å¿†ï¼Ÿ</h2><p>ä¸å€ŸåŠ©LangChainæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•å®ç°å¤§æ¨¡å‹çš„è®°å¿†èƒ½åŠ›ï¼Ÿ<br>æ€è€ƒï¼šé€šè¿‡ <strong>messages</strong> å˜é‡ï¼Œä¸æ–­åœ°å°†å†å²çš„å¯¹è¯ä¿¡æ¯è¿½åŠ åˆ°å¯¹è¯åˆ—è¡¨ä¸­ï¼Œä»¥æ­¤è®©å¤§æ¨¡å‹å…·å¤‡ä¸Šä¸‹æ–‡è®° å¿†èƒ½åŠ›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ã€è·å–å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> AIMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages.ai <span class="keyword">import</span> AIMessage  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chat_with_model</span>(<span class="params">answer</span>):  </span><br><span class="line">    <span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿ï¼šChatPromptTemplate  </span></span><br><span class="line">    prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ])  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        <span class="comment"># 3ã€è·å–chainï¼Œå¹¶è°ƒç”¨å¤§æ¨¡å‹å¾—åˆ°å“åº”  </span></span><br><span class="line">        chain = prompt_template | llm  </span><br><span class="line">        response = chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: answer&#125;)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># 4ã€è¾“å‡ºå¤§æ¨¡å‹çš„å“åº”  </span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ¨¡å‹å›å¤ï¼š<span class="subst">&#123;response.content&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># 5ã€ç»§ç»­è·å–ç”¨æˆ·çš„é—®é¢˜  </span></span><br><span class="line">        user_input = <span class="built_in">input</span>(<span class="string">&quot;ä½ è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ(è¾“å…¥&#x27;é€€å‡º&#x27;æ—¶ï¼Œç»“æŸä¼šè¯)&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># 6ã€æŒ‡æ˜é€€å‡ºå¾ªç¯çš„æ–¹å¼  </span></span><br><span class="line">        <span class="keyword">if</span> (user_input == <span class="string">&quot;é€€å‡º&quot;</span>):  </span><br><span class="line">            <span class="keyword">break</span>  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># 7ã€å°†ä¸Šè¿°æ–°ç”Ÿæˆçš„æ¶ˆæ¯å­˜æ”¾åˆ°æç¤ºè¯æ¨¡æ¿çš„æ¶ˆæ¯åˆ—è¡¨ä¸­  </span></span><br><span class="line">        prompt_template.messages.append(AIMessage(content=response.content))  </span><br><span class="line">        prompt_template.messages.append(HumanMessage(content=user_input))  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">chat_with_model(<span class="string">&quot;ä½ å¥½ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">æ¨¡å‹å›å¤ï¼šä½ å¥½ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ</span><br><span class="line">æ¨¡å‹å›å¤ï¼šæç™½çš„åå­—ä¸­â€œç™½â€å­—å¹¶ä¸ä¸€å®šè¡¨ç¤ºä»–è‚¤è‰²çš„è‹ç™½ï¼Œè€Œæ˜¯ä¸ä»–çš„ä¸ªæ€§ã€æ‰ååŠå…¶è¯—æ­Œé£æ ¼ç›¸å…³ã€‚æç™½æ˜¯å”ä»£è‘—åçš„è¯—äººï¼Œä»¥è±ªæ”¾ä¸ç¾ã€æ‰æƒ…æ¨ªæº¢è‘—ç§°ã€‚ä»–çš„è¯—ä½œä¸­å¸¸å¸¸è¡¨è¾¾å¯¹è‡ªç”±å’Œç†æƒ³çš„è¿½æ±‚ï¼Œè€Œä»–çš„ä¸ªæ€§ä¹Ÿè¢«è®¤ä¸ºæ˜¯æ´’è„±å¥”æ”¾çš„ã€‚è™½ç„¶åå­—ä¸­æœ‰â€œç™½â€å­—ï¼Œä½†å®é™…ä¸Šä»–çš„è‚¤è‰²å¹¶æ²¡æœ‰æ˜ç¡®çš„è®°è½½ã€‚ç›¸ä¿¡è¿™æ›´æ˜¯ä¸€ç§æ–‡åŒ–è±¡å¾ï¼Œè€Œéå­—é¢çš„æ„æ€ã€‚</span><br><span class="line">æ¨¡å‹å›å¤ï¼šæç™½æœ‰è®¸å¤šè‘—åçš„è¯—ç¯‡ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¹¿ä¸ºäººçŸ¥çš„ä½œå“ï¼š</span><br><span class="line"></span><br><span class="line">1. **ã€Šå°†è¿›é…’ã€‹** - è¿™é¦–è¯—è¡¨è¾¾äº†æç™½è±ªæ”¾çš„é…’æ–‡åŒ–å’Œå¯¹äººç”Ÿçš„æ„Ÿæ…¨ï¼Œå¼€ç¯‡æœ‰â€œå°†è¿›é…’ï¼Œæ¯è«åœâ€ã€‚</span><br><span class="line"></span><br><span class="line">2. **ã€Šé™å¤œæ€ã€‹** - è¿™é¦–è¯—æç»˜äº†ä»–åœ¨é™å¤œä¸­æ€å¿µå®¶ä¹¡çš„æƒ…æ™¯ï¼Œå°¤å…¶æ˜¯â€œåºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœâ€ã€‚</span><br><span class="line"></span><br><span class="line">3. **ã€Šåºå±±è°£ã€‹** - è¿™ä¸€ç¯‡æç»˜äº†åºå±±çš„ç¾ä¸½æ™¯è‰²ï¼Œå¹¶è¡¨è¾¾äº†ä»–å¯¹è‡ªç„¶çš„çƒ­çˆ±ã€‚</span><br><span class="line"></span><br><span class="line">4. **ã€Šæ—©å‘ç™½å¸åŸã€‹** - æè¿°äº†æ¸…æ™¨ä»ç™½å¸åŸå‡ºå‘çš„å£®é˜”æ™¯è±¡ï¼Œâ€œæœè¾ç™½å¸å½©äº‘é—´ï¼Œåƒé‡Œæ±Ÿé™µä¸€æ—¥è¿˜â€ã€‚</span><br><span class="line"></span><br><span class="line">5. **ã€Šæœˆä¸‹ç‹¬é…Œã€‹** - è¿™é¦–è¯—è¡¨è¾¾äº†æç™½åœ¨æœˆä¸‹ç‹¬è‡ªé¥®é…’æ—¶çš„æƒ…æ„Ÿï¼Œä½“ç°äº†ä»–å¯¹è‡ªç”±ä¸å­¤ç‹¬çš„æ€è€ƒã€‚</span><br><span class="line"></span><br><span class="line">6. **ã€Šèµ æ±ªä¼¦ã€‹** - é€šè¿‡æå†™æœ‹å‹ä¹‹é—´çš„æƒ…è°Šï¼Œå±•ç¤ºäº†æç™½æ·±åšçš„å‹è°Šã€‚</span><br><span class="line"></span><br><span class="line">æç™½çš„è¯—é£ç‹¬ç‰¹ï¼Œè¯­è¨€ä¼˜ç¾ï¼Œå……æ»¡äº†è±ªæƒ…ä¸å¥”æ”¾ï¼Œæ·±å—åäººå–œçˆ±ã€‚</span><br><span class="line">æ¨¡å‹å›å¤ï¼šä½ é—®é¢˜ä¸­çš„è¯—äººæ˜¯æç™½ã€‚ä»–æ˜¯å”ä»£è‘—åçš„è¯—äººï¼Œä»¥å…¶è±ªæ”¾ä¸ç¾çš„ä¸ªæ€§å’Œä¼˜ç¾çš„è¯—ä½œåœ¨ä¸­å›½æ–‡å­¦å²ä¸Šå æœ‰é‡è¦åœ°ä½ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºæç™½çš„ä½œå“æˆ–ç”Ÿå¹³ï¼Œéšæ—¶å¯ä»¥é—®æˆ‘ï¼</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ç§å½¢å¼æ˜¯æœ€ç®€å•çš„ä¸€ç§è®©å¤§æ¨¡å‹å…·å¤‡ä¸Šä¸‹æ–‡çŸ¥è¯†çš„å­˜å‚¨æ–¹å¼ï¼Œä»»ä½•è®°å¿†çš„åŸºç¡€éƒ½æ˜¯æ‰€æœ‰èŠå¤©äº¤äº’çš„å† å²è®°å½•ã€‚å³ä½¿è¿™äº›ä¸å…¨éƒ¨ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿéœ€è¦ä»¥æŸç§å½¢å¼å­˜å‚¨ã€‚</p><h1 id="åŸºç¡€Memoryæ¨¡å—çš„ä½¿ç”¨"><a href="#åŸºç¡€Memoryæ¨¡å—çš„ä½¿ç”¨" class="headerlink" title="åŸºç¡€Memoryæ¨¡å—çš„ä½¿ç”¨"></a>åŸºç¡€Memoryæ¨¡å—çš„ä½¿ç”¨</h1><h2 id="Memoryæ¨¡å—çš„è®¾è®¡æ€è·¯"><a href="#Memoryæ¨¡å—çš„è®¾è®¡æ€è·¯" class="headerlink" title="Memoryæ¨¡å—çš„è®¾è®¡æ€è·¯"></a>Memoryæ¨¡å—çš„è®¾è®¡æ€è·¯</h2><p><strong>å¦‚ä½•è®¾è®¡Memoryæ¨¡å—</strong>ï¼Ÿ</p><p>å±‚æ¬¡1(æœ€ç›´æ¥çš„æ–¹å¼)ï¼šä¿ç•™ä¸€ä¸ªèŠå¤©æ¶ˆæ¯åˆ—è¡¨<br>å±‚æ¬¡2(ç®€å•çš„æ–°æ€è·¯)ï¼šåªè¿”å›æœ€è¿‘äº¤äº’çš„kæ¡æ¶ˆæ¯<br>å±‚æ¬¡3(ç¨å¾®å¤æ‚ä¸€ç‚¹)ï¼šè¿”å›è¿‡å»kæ¡æ¶ˆæ¯çš„ç®€æ´æ‘˜è¦<br>å±‚æ¬¡4(æ›´å¤æ‚)ï¼šä»å­˜å‚¨çš„æ¶ˆæ¯ä¸­æå–å®ä½“ï¼Œå¹¶ä¸”ä»…è¿”å›æœ‰å…³å½“å‰è¿è¡Œä¸­å¼•ç”¨çš„å®ä½“çš„ä¿¡æ¯</p><p><strong>LangChainçš„è®¾è®¡</strong></p><p>é’ˆå¯¹ä¸Šè¿°æƒ…å†µï¼ŒLangChainæ„å»ºäº†ä¸€äº›å¯ä»¥ç›´æ¥ä½¿ç”¨çš„<strong>Memory</strong>å·¥å…·ï¼Œç”¨äºå­˜å‚¨èŠå¤©æ¶ˆæ¯çš„ä¸€ç³»åˆ—é›†æˆã€‚<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013101754711.png"></p><h2 id="ChatMessageHistory-åŸºç¡€"><a href="#ChatMessageHistory-åŸºç¡€" class="headerlink" title="ChatMessageHistory(åŸºç¡€)"></a>ChatMessageHistory(åŸºç¡€)</h2><p>ChatMessageHistoryæ˜¯ä¸€ä¸ªç”¨äº <strong>å­˜å‚¨å’Œç®¡ç†å¯¹è¯æ¶ˆæ¯</strong>çš„åŸºç¡€ç±»ï¼Œå®ƒç›´æ¥æ“ä½œæ¶ˆæ¯å¯¹è±¡ï¼ˆå¦‚ HumanMessage, AIMessage ç­‰ï¼‰ï¼Œæ˜¯å…¶å®ƒè®°å¿†ç»„ä»¶çš„åº•å±‚å­˜å‚¨å·¥å…·ã€‚ </p><p>åœ¨APIæ–‡æ¡£ä¸­ï¼ŒChatMessageHistory è¿˜æœ‰ä¸€ä¸ªåˆ«åç±»ï¼šInMemoryChatMessageHistoryï¼›å¯¼åŒ…æ—¶ï¼Œéœ€ ä½¿ç”¨ï¼šfrom langchain.memory import ChatMessageHistory</p><p><strong>ç‰¹ç‚¹</strong>ï¼š </p><ul><li>çº¯ç²¹æ˜¯æ¶ˆæ¯å¯¹è±¡çš„â€œ <strong>å­˜å‚¨å™¨</strong>â€ï¼Œä¸è®°å¿†ç­–ç•¥ï¼ˆå¦‚ç¼“å†²ã€çª—å£ã€æ‘˜è¦ç­‰ï¼‰æ— å…³ã€‚</li><li>ä¸æ¶‰åŠæ¶ˆæ¯çš„æ ¼å¼åŒ–ï¼ˆå¦‚è½¬æˆæ–‡æœ¬å­—ç¬¦ä¸²ï¼‰</li></ul><p><strong>åœºæ™¯1ï¼šè®°å¿†å­˜å‚¨</strong></p><p>ChatMessageHistoryæ˜¯ç”¨äºç®¡ç†å’Œå­˜å‚¨å¯¹è¯å†å²çš„å…·ä½“å®ç°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ChatMessageHistory  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€ChatMessageHistoryçš„å®ä¾‹åŒ–  </span></span><br><span class="line">  </span><br><span class="line">history = ChatMessageHistory()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æ·»åŠ ç›¸å…³çš„æ¶ˆæ¯è¿›è¡Œå­˜å‚¨  </span></span><br><span class="line">  </span><br><span class="line">history.add_user_message(<span class="string">&quot;ä½ å¥½&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">history.add_ai_message(<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æ‰“å°å­˜å‚¨çš„æ¶ˆæ¯  </span></span><br><span class="line"><span class="built_in">print</span>(history.messages)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[HumanMessage(content=<span class="string">&#x27;ä½ å¥½&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ &#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯2ï¼šå¯¹æ¥LLM</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ã€è·å–å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ChatMessageHistory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€ChatMessageHistoryçš„å®ä¾‹åŒ–  </span></span><br><span class="line">  </span><br><span class="line">history = ChatMessageHistory()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æ·»åŠ ç›¸å…³çš„æ¶ˆæ¯è¿›è¡Œå­˜å‚¨  </span></span><br><span class="line">history.add_user_message(<span class="string">&quot;ä½ å¥½&quot;</span>)  </span><br><span class="line">history.add_ai_message(<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>)  </span><br><span class="line">history.add_user_message(<span class="string">&quot;å¸®æˆ‘è®¡ç®—1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">response = llm.invoke(history.messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®æ•°å­¦è¿ç®—çš„ä¼˜å…ˆçº§ï¼Œå…ˆè¿›è¡Œä¹˜æ³•å†è¿›è¡ŒåŠ æ³•ã€‚å› æ­¤ï¼Œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">1 + 2 * 3 = 1 + 6 = 7</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ï¼Œ1 + 2 * 3 = 7ã€‚</span><br></pre></td></tr></table></figure><h2 id="ConversationBufferMemory"><a href="#ConversationBufferMemory" class="headerlink" title="ConversationBufferMemory"></a>ConversationBufferMemory</h2><p>ConversationBufferMemoryæ˜¯ä¸€ä¸ªåŸºç¡€çš„ <strong>å¯¹è¯è®°å¿†ï¼ˆMemoryï¼‰ç»„ä»¶</strong>ï¼Œä¸“é—¨ç”¨äºæŒ‰<strong>åŸå§‹é¡ºåºå­˜å‚¨</strong> çš„å¯¹è¯å†å²ã€‚</p><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¯¹è¯è½®æ¬¡è¾ƒå°‘ã€ä¾èµ–å®Œæ•´ä¸Šä¸‹æ–‡çš„åœºæ™¯ï¼ˆå¦‚ç®€å•çš„èŠå¤©æœºå™¨ï¼‰</p><p>ç‰¹ç‚¹ï¼š </p><ul><li>å®Œæ•´å­˜å‚¨å¯¹è¯å†å² </li><li>ç®€å•ã€ æ— è£å‰ªã€ æ— å‹ç¼© ä¸</li><li>Chains&#x2F;Models æ— ç¼é›†æˆ </li><li>æ”¯æŒä¸¤ç§è¿”å›æ ¼å¼ï¼ˆé€šè¿‡ return_messages å‚æ•°æ§åˆ¶è¾“å‡ºæ ¼å¼ï¼‰ <ul><li>return_messages&#x3D;True è¿”å›æ¶ˆæ¯å¯¹è±¡åˆ—è¡¨ï¼ˆ List[BaseMessage] </li><li>return_messages&#x3D;False ï¼ˆé»˜è®¤ï¼‰ è¿”å›æ‹¼æ¥çš„ çº¯æ–‡æœ¬å­—ç¬¦ä¸²</li></ul></li></ul><h3 id="ä¸¾ä¾‹1ï¼šä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›å­˜å‚¨çš„ä¿¡æ¯"><a href="#ä¸¾ä¾‹1ï¼šä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›å­˜å‚¨çš„ä¿¡æ¯" class="headerlink" title="ä¸¾ä¾‹1ï¼šä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›å­˜å‚¨çš„ä¿¡æ¯"></a>ä¸¾ä¾‹1ï¼šä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›å­˜å‚¨çš„ä¿¡æ¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€ConversationBufferMemoryçš„å®ä¾‹åŒ–  </span></span><br><span class="line">memory = ConversationBufferMemory()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€å­˜å‚¨ç›¸å…³çš„æ¶ˆæ¯  </span></span><br><span class="line"><span class="comment"># inputså¯¹åº”çš„å°±æ˜¯ç”¨æˆ·æ¶ˆæ¯ï¼Œoutputså¯¹åº”çš„å°±æ˜¯aiæ¶ˆæ¯  </span></span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;human&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼Œæˆ‘å«å°æ˜&quot;</span>&#125;, outputs=&#123;<span class="string">&quot;ai&quot;</span>: <span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>&#125;)  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å¸®æˆ‘å›ç­”ä¸€ä¸‹1+2*3=?&quot;</span>&#125;, outputs=&#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;7&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€è·å–å­˜å‚¨çš„ä¿¡æ¯  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šè¿”å›çš„å­—å…¸ç»“æ„çš„keyå«history.</span></span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘å«å°æ˜\nAI<span class="punctuation">:</span> å¾ˆé«˜å…´è®¤è¯†ä½ \nHuman<span class="punctuation">:</span> å¸®æˆ‘å›ç­”ä¸€ä¸‹<span class="number">1</span>+<span class="number">2</span>*<span class="number">3</span>=?\nAI<span class="punctuation">:</span> <span class="number">7</span>&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š </p><ul><li>ä¸ç®¡inputsã€outputsçš„keyç”¨ä»€ä¹ˆåå­—ï¼Œéƒ½è®¤ä¸ºinputsçš„keyæ˜¯humanï¼Œoutputsçš„keyæ˜¯AIã€‚ </li><li>æ‰“å°çš„ç»“æœçš„jsonæ•°æ®çš„keyï¼Œé»˜è®¤æ˜¯â€œhistoryâ€ã€‚å¯ä»¥é€šè¿‡ConversationBufferMemoryçš„ <strong>memory_key</strong>å±æ€§ä¿®æ”¹ã€‚</li></ul><h3 id="ä¸¾ä¾‹2ï¼š"><a href="#ä¸¾ä¾‹2ï¼š" class="headerlink" title="ä¸¾ä¾‹2ï¼š"></a>ä¸¾ä¾‹2ï¼š</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€ConversationBufferMemoryçš„å®ä¾‹åŒ–  </span></span><br><span class="line">memory = ConversationBufferMemory(return_messages=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€å­˜å‚¨ç›¸å…³çš„æ¶ˆæ¯  </span></span><br><span class="line"><span class="comment"># inputså¯¹åº”çš„å°±æ˜¯ç”¨æˆ·æ¶ˆæ¯ï¼Œoutputså¯¹åº”çš„å°±æ˜¯aiæ¶ˆæ¯  </span></span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;human&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼Œæˆ‘å«å°æ˜&quot;</span>&#125;, outputs=&#123;<span class="string">&quot;ai&quot;</span>: <span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>&#125;)  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å¸®æˆ‘å›ç­”ä¸€ä¸‹1+2*3=?&quot;</span>&#125;, outputs=&#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;7&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€è·å–å­˜å‚¨çš„ä¿¡æ¯  </span></span><br><span class="line"><span class="comment">#è¿”å›æ¶ˆæ¯åˆ—è¡¨çš„æ–¹å¼1ï¼š  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¿”å›æ¶ˆæ¯åˆ—è¡¨çš„æ–¹å¼2ï¼š  </span></span><br><span class="line"><span class="built_in">print</span>(memory.chat_memory.messages)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šè¿”å›çš„å­—å…¸ç»“æ„çš„keyå«history.</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;history&#x27;</span>: [HumanMessage(content=<span class="string">&#x27;ä½ å¥½ï¼Œæˆ‘å«å°æ˜&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ &#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;å¸®æˆ‘å›ç­”ä¸€ä¸‹1+2*3=?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;7&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HumanMessage(content=<span class="string">&#x27;ä½ å¥½ï¼Œæˆ‘å«å°æ˜&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ &#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;å¸®æˆ‘å›ç­”ä¸€ä¸‹1+2*3=?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;7&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹3ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆPromptTemplateï¼‰"><a href="#ä¸¾ä¾‹3ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆPromptTemplateï¼‰" class="headerlink" title="ä¸¾ä¾‹3ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆPromptTemplateï¼‰"></a>ä¸¾ä¾‹3ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆPromptTemplateï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.prompt <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">    ä½ å¯ä»¥ä¸äººç±»å¯¹è¯ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å½“å‰å¯¹è¯å†å²: &#123;history&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">äººç±»é—®é¢˜: &#123;question&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å›å¤:  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æä¾›memoryå®ä¾‹  </span></span><br><span class="line">memory = ConversationBufferMemory()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4ã€æä¾›Chain  </span></span><br><span class="line">chain = LLMChain(llm=llm, prompt=prompt_template, memory=memory)  </span><br><span class="line">  </span><br><span class="line">response = chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹4ï¼šåŸºäºä¸¾ä¾‹3ï¼Œæ˜¾å¼çš„è®¾ç½®meoryçš„keyçš„å€¼"><a href="#ä¸¾ä¾‹4ï¼šåŸºäºä¸¾ä¾‹3ï¼Œæ˜¾å¼çš„è®¾ç½®meoryçš„keyçš„å€¼" class="headerlink" title="ä¸¾ä¾‹4ï¼šåŸºäºä¸¾ä¾‹3ï¼Œæ˜¾å¼çš„è®¾ç½®meoryçš„keyçš„å€¼"></a>ä¸¾ä¾‹4ï¼šåŸºäºä¸¾ä¾‹3ï¼Œæ˜¾å¼çš„è®¾ç½®meoryçš„keyçš„å€¼</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.prompt <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">    ä½ å¯ä»¥ä¸äººç±»å¯¹è¯ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å½“å‰å¯¹è¯å†å²: &#123;chat_history&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">äººç±»é—®é¢˜: &#123;question&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å›å¤:  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æä¾›memoryå®ä¾‹  </span></span><br><span class="line">memory = ConversationBufferMemory(memory_key=<span class="string">&quot;chat_history&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4ã€æä¾›Chain  </span></span><br><span class="line">chain = LLMChain(llm=llm, prompt=prompt_template, memory=memory)  </span><br><span class="line">  </span><br><span class="line">response = chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> &#x27;chat_history&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚æœ‰ä»»ä½•é—®é¢˜æˆ–è€…æƒ³èŠçš„è¯é¢˜å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response = chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;æˆ‘å«ä»€ä¹ˆåå­—å‘¢ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;æˆ‘å«ä»€ä¹ˆåå­—å‘¢ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;chat_history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;ä½ å«å°æ˜ã€‚å¾ˆé«˜å…´å†æ¬¡è§åˆ°ä½ ï¼æœ‰ä»€ä¹ˆæƒ³èŠçš„å‘¢ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹5ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆChatPromptTemplateï¼‰"><a href="#ä¸¾ä¾‹5ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆChatPromptTemplateï¼‰" class="headerlink" title="ä¸¾ä¾‹5ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆChatPromptTemplateï¼‰"></a>ä¸¾ä¾‹5ï¼šç»“åˆå¤§æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨ï¼ˆChatPromptTemplateï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferMemory  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> MessagesPlaceholder,ChatPromptTemplate,HumanMessagePromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆ›å»ºLLM  </span></span><br><span class="line">llm = ChatOpenAI(model_name=<span class="string">&#x27;gpt-4o-mini&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åˆ›å»ºPrompt  </span></span><br><span class="line">prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>,<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸äººç±»å¯¹è¯çš„æœºå™¨äººã€‚&quot;</span>),  </span><br><span class="line">    MessagesPlaceholder(variable_name=<span class="string">&#x27;history&#x27;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>,<span class="string">&quot;é—®é¢˜ï¼š&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ›å»ºMemory  </span></span><br><span class="line">memory = ConversationBufferMemory(return_messages=<span class="literal">True</span>)  </span><br><span class="line"><span class="comment"># 5.åˆ›å»ºLLMChain  </span></span><br><span class="line">llm_chain = LLMChain(prompt=prompt,llm=llm, memory=memory)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.è°ƒç”¨LLMChain  </span></span><br><span class="line">res1 = llm_chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;ä¸­å›½é¦–éƒ½åœ¨å“ªé‡Œï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(res1,end=<span class="string">&quot;\n\n&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;ä¸­å›½é¦–éƒ½åœ¨å“ªé‡Œï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>HumanMessage(content=&#x27;ä¸­å›½é¦–éƒ½åœ¨å“ªé‡Œï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;ä¸­å›½çš„é¦–éƒ½ä½äºåŒ—äº¬ã€‚&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;ä¸­å›½çš„é¦–éƒ½ä½äºåŒ—äº¬ã€‚&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res2 = llm_chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;æˆ‘åˆšåˆšé—®äº†ä»€ä¹ˆ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(res2)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;input&#x27;<span class="punctuation">:</span> &#x27;æˆ‘çš„åå­—å«ä»€ä¹ˆï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼æˆ‘æ˜¯ä¸€ç§äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œéšæ—¶å‡†å¤‡å¸®åŠ©ä½ ã€‚ä½ ä»Šå¤©æ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆç‰¹åˆ«æƒ³èŠçš„å—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;response&#x27;<span class="punctuation">:</span> &#x27;ä½ çš„åå­—å«å°æ˜ï¼æˆ‘è®°å¾—ä½ åˆšåˆšå‘Šè¯‰æˆ‘è¿™ä¸ªä¿¡æ¯ã€‚ä½ æƒ³èŠäº›ä»€ä¹ˆï¼Œæˆ–è€…æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦æˆ‘å¸®åŠ©çš„å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ConversationChain"><a href="#ConversationChain" class="headerlink" title="ConversationChain"></a>ConversationChain</h2><p>ConversationChainå®é™…ä¸Šæ˜¯å°±æ˜¯å¯¹<strong>ConversationBufferMemory</strong>å’Œ<strong>LLMChain</strong>è¿›è¡Œäº†å°è£…ï¼Œå¹¶ä¸”æä¾› ä¸€ä¸ªé»˜è®¤æ ¼å¼çš„æç¤ºè¯æ¨¡ç‰ˆï¼ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ç”¨ï¼‰ï¼Œä»è€Œç®€åŒ–äº†åˆå§‹åŒ–ConversationBufferMemoryçš„æ­¥ éª¤ã€‚</p><h3 id="ä¸¾ä¾‹1ï¼šä½¿ç”¨PromptTemplate"><a href="#ä¸¾ä¾‹1ï¼šä½¿ç”¨PromptTemplate" class="headerlink" title="ä¸¾ä¾‹1ï¼šä½¿ç”¨PromptTemplate"></a>ä¸¾ä¾‹1ï¼šä½¿ç”¨PromptTemplate</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.conversation.base <span class="keyword">import</span> ConversationChain  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.prompt <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">    ä½ å¯ä»¥ä¸äººç±»å¯¹è¯ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å½“å‰å¯¹è¯å†å²: &#123;history&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">äººç±»é—®é¢˜: &#123;input&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å›å¤:  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># # 3ã€æä¾›memoryå®ä¾‹  </span></span><br><span class="line"><span class="comment"># memory = ConversationBufferMemory()  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># # 4ã€æä¾›Chain  </span></span><br><span class="line"><span class="comment"># chain = LLMChain(llm=llm, prompt=prompt_template, memory=memory)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€åˆ›å»ºConversationChainçš„å®ä¾‹  </span></span><br><span class="line">chain = ConversationChain(llm = llm, prompt=prompt_template)  </span><br><span class="line">  </span><br><span class="line">response = chain.invoke(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;input&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;response&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚ä½ ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response = chain.invoke(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æˆ‘çš„åå­—å«ä»€ä¹ˆï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;input&#x27;<span class="punctuation">:</span> &#x27;æˆ‘çš„åå­—å«ä»€ä¹ˆï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚ä½ ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;response&#x27;<span class="punctuation">:</span> &#x27;ä½ çš„åå­—å«å°æ˜ã€‚&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼šä½¿ç”¨é»˜è®¤æä¾›çš„æç¤ºè¯æ¨¡æ¿"><a href="#ä¸¾ä¾‹2ï¼šä½¿ç”¨é»˜è®¤æä¾›çš„æç¤ºè¯æ¨¡æ¿" class="headerlink" title="ä¸¾ä¾‹2ï¼šä½¿ç”¨é»˜è®¤æä¾›çš„æç¤ºè¯æ¨¡æ¿"></a>ä¸¾ä¾‹2ï¼šä½¿ç”¨é»˜è®¤æä¾›çš„æç¤ºè¯æ¨¡æ¿</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.conversation.base <span class="keyword">import</span> ConversationChain  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.prompt <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line"><span class="comment"># prompt_template = PromptTemplate.from_template(  </span></span><br><span class="line"><span class="comment">#     template=&quot;&quot;&quot;  </span></span><br><span class="line"><span class="comment">#     ä½ å¯ä»¥ä¸äººç±»å¯¹è¯ã€‚  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># å½“å‰å¯¹è¯å†å²: &#123;history&#125;  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># äººç±»é—®é¢˜: &#123;input&#125;  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># å›å¤:  </span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># # 3ã€æä¾›memoryå®ä¾‹  </span></span><br><span class="line"><span class="comment"># memory = ConversationBufferMemory()  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># # 4ã€æä¾›Chain  </span></span><br><span class="line"><span class="comment"># chain = LLMChain(llm=llm, prompt=prompt_template, memory=memory)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€åˆ›å»ºConversationChainçš„å®ä¾‹ï¼ˆå†…éƒ¨æä¾›äº†é»˜è®¤çš„æç¤ºè¯æ¨¡æ¿ã€‚è€Œæ­¤æ¨¡æ¿ä¸­çš„å˜é‡æ˜¯&#123;input&#125;ã€&#123;history&#125;  </span></span><br><span class="line">chain = ConversationChain(llm = llm)  </span><br><span class="line">  </span><br><span class="line">response = chain.invoke(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;input&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;response&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼æˆ‘æ˜¯ä¸€ç§äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œéšæ—¶å‡†å¤‡å¸®åŠ©ä½ ã€‚ä½ ä»Šå¤©æ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆç‰¹åˆ«æƒ³èŠçš„å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response = chain.invoke(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æˆ‘çš„åå­—å«ä»€ä¹ˆï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;input&#x27;<span class="punctuation">:</span> &#x27;æˆ‘çš„åå­—å«ä»€ä¹ˆï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œå°æ˜ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼æˆ‘æ˜¯ä¸€ç§äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œéšæ—¶å‡†å¤‡å¸®åŠ©ä½ ã€‚ä½ ä»Šå¤©æ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆç‰¹åˆ«æƒ³èŠçš„å—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;response&#x27;<span class="punctuation">:</span> &#x27;ä½ çš„åå­—å«å°æ˜ï¼æˆ‘è®°å¾—ä½ åˆšåˆšå‘Šè¯‰æˆ‘è¿™ä¸ªä¿¡æ¯ã€‚ä½ æƒ³èŠäº›ä»€ä¹ˆï¼Œæˆ–è€…æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦æˆ‘å¸®åŠ©çš„å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ConversationBufferWindowMemoryçš„ä½¿ç”¨"><a href="#ConversationBufferWindowMemoryçš„ä½¿ç”¨" class="headerlink" title="ConversationBufferWindowMemoryçš„ä½¿ç”¨"></a>ConversationBufferWindowMemoryçš„ä½¿ç”¨</h2><p>åœ¨äº†è§£äº†ConversationBufferMemoryè®°å¿†ç±»åï¼Œæˆ‘ä»¬çŸ¥é“äº†å®ƒèƒ½å¤Ÿæ— é™çš„å°†å†å²å¯¹è¯ä¿¡æ¯å¡«å……åˆ° Historyä¸­ï¼Œä»è€Œç»™å¤§æ¨¡å‹æä¾›ä¸Šä¸‹æ–‡çš„èƒŒæ™¯ã€‚ä½†è¿™ä¼š<strong>å¯¼è‡´å†…å­˜é‡ååˆ†å¤§</strong>ï¼Œå¹¶ä¸”<strong>æ¶ˆè€—çš„tokenæ˜¯éå¸¸å¤š</strong> çš„ï¼Œæ­¤å¤–ï¼Œæ¯ä¸ªå¤§æ¨¡å‹éƒ½å­˜åœ¨æœ€å¤§è¾“å…¥çš„Tokené™åˆ¶ã€‚ </p><p>æˆ‘ä»¬å‘ç°ï¼Œè¿‡ä¹…è¿œçš„å¯¹è¯æ•°æ®å¾€å¾€å¹¶ä¸èƒ½å¯¹å½“å‰è½®æ¬¡çš„é—®ç­”æä¾›æœ‰æ•ˆçš„ä¿¡æ¯ï¼ŒLangChain ç»™å‡ºçš„è§£å†³æ–¹ å¼æ˜¯ï¼š<strong>ConversationBufferWindowMemory</strong>æ¨¡å—ã€‚è¯¥è®°å¿†ç±»<strong>ä¼šä¿å­˜ä¸€æ®µæ—¶é—´å†…å¯¹è¯äº¤äº’</strong>çš„åˆ—è¡¨ï¼Œä»…ä½¿ç”¨ <strong>æœ€è¿‘ K ä¸ªäº¤äº’</strong>ã€‚è¿™æ ·å°±ä½¿ç¼“å­˜åŒºä¸ä¼šå˜å¾—å¤ªå¤§ã€‚</p><p>ç‰¹ç‚¹ï¼š </p><ul><li>é€‚åˆé•¿å¯¹è¯åœºæ™¯ã€‚ </li><li>ä¸ Chains&#x2F;Models æ— ç¼é›†æˆ </li><li>æ”¯æŒä¸¤ç§è¿”å›æ ¼å¼ï¼ˆé€šè¿‡ return_messages å‚æ•°æ§åˆ¶è¾“å‡ºæ ¼å¼ï¼‰ <ul><li>return_messages&#x3D;Trueè¿”å›æ¶ˆæ¯å¯¹è±¡åˆ—è¡¨ï¼ˆList[BaseMessage] </li><li>return_messages&#x3D;Falseï¼ˆé»˜è®¤ï¼‰ è¿”å›æ‹¼æ¥çš„çº¯æ–‡æœ¬å­—ç¬¦ä¸²</li></ul></li></ul><h3 id="åœºæ™¯1ï¼šå…¥é—¨ä½¿ç”¨"><a href="#åœºæ™¯1ï¼šå…¥é—¨ä½¿ç”¨" class="headerlink" title="åœºæ™¯1ï¼šå…¥é—¨ä½¿ç”¨"></a>åœºæ™¯1ï¼šå…¥é—¨ä½¿ç”¨</h3><p>é€šè¿‡å†…ç½®åœ¨LangChainä¸­çš„ç¼“å­˜çª—å£(BufferWindow)å¯ä»¥å°†meomoryâ€è®°å¿†â€ä¸‹æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferWindowMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®ä¾‹åŒ–ConversationBufferWindowMemoryå¯¹è±¡ï¼Œè®¾å®šçª—å£é˜ˆå€¼  </span></span><br><span class="line">memory = ConversationBufferWindowMemory(k=<span class="number">1</span>)  </span><br><span class="line"><span class="comment"># 3.ä¿å­˜æ¶ˆæ¯  </span></span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ€ä¹ˆäº†&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ æ˜¯è°&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æˆ‘æ˜¯AIåŠ©æ‰‹&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ çš„ç”Ÿæ—¥æ˜¯å“ªå¤©ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æˆ‘ä¸æ¸…æ¥š&quot;</span>&#125;)  </span><br><span class="line"><span class="comment"># 4.è¯»å–å†…å­˜ä¸­æ¶ˆæ¯ï¼ˆè¿”å›æ¶ˆæ¯å†…å®¹çš„çº¯æ–‡æœ¬ï¼‰  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ çš„ç”Ÿæ—¥æ˜¯å“ªå¤©ï¼Ÿ\nAI<span class="punctuation">:</span> æˆ‘ä¸æ¸…æ¥š&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><p>ConversationBufferWindowMemory ä¹Ÿæ”¯æŒä½¿ç”¨èŠå¤©æ¨¡å‹ï¼ˆChat Modelï¼‰çš„æƒ…å†µï¼ŒåŒæ ·å¯ä»¥é€šè¿‡ <strong>return_messages&#x3D;True</strong>å‚æ•°ï¼Œå°†å¯¹è¯è½¬åŒ–ä¸ºæ¶ˆæ¯åˆ—è¡¨å½¢å¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferWindowMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®ä¾‹åŒ–ConversationBufferWindowMemoryå¯¹è±¡ï¼Œè®¾å®šçª—å£é˜ˆå€¼  </span></span><br><span class="line">memory = ConversationBufferWindowMemory(k=<span class="number">2</span>, return_messages=<span class="literal">True</span>)  </span><br><span class="line"><span class="comment"># 3.ä¿å­˜æ¶ˆæ¯  </span></span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ€ä¹ˆäº†&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ æ˜¯è°&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æˆ‘æ˜¯AIåŠ©æ‰‹å°æ™º&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;åˆæ¬¡å¯¹è¯ï¼Œä½ èƒ½ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±å—ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;å½“ç„¶å¯ä»¥äº†ã€‚æˆ‘æ˜¯ä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„å°æ™ºã€‚&quot;</span>&#125;)  </span><br><span class="line"><span class="comment"># 4.è¯»å–å†…å­˜ä¸­æ¶ˆæ¯ï¼ˆè¿”å›æ¶ˆæ¯å†…å®¹çš„çº¯æ–‡æœ¬ï¼‰  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>HumanMessage(content=&#x27;ä½ æ˜¯è°&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æˆ‘æ˜¯AIåŠ©æ‰‹å°æ™º&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;åˆæ¬¡å¯¹è¯ï¼Œä½ èƒ½ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±å—ï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;å½“ç„¶å¯ä»¥äº†ã€‚æˆ‘æ˜¯ä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„å°æ™ºã€‚&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯2ï¼šç»“åˆchain"><a href="#åœºæ™¯2ï¼šç»“åˆchain" class="headerlink" title="åœºæ™¯2ï¼šç»“åˆchain"></a>åœºæ™¯2ï¼šç»“åˆchain</h3><p>å€ŸåŠ©æç¤ºè¯æ¨¡ç‰ˆå»æ„å»ºLangChain</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferWindowMemory  </span><br><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.prompt <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æ¨¡ç‰ˆ  </span></span><br><span class="line">template = <span class="string">&quot;&quot;&quot;ä»¥ä¸‹æ˜¯äººç±»ä¸AIä¹‹é—´çš„å‹å¥½å¯¹è¯æè¿°ã€‚AIè¡¨ç°å¾—å¾ˆå¥è°ˆï¼Œå¹¶æä¾›äº†å¤§é‡æ¥è‡ªå…¶ä¸Šä¸‹æ–‡çš„å…·ä½“ç»†èŠ‚ã€‚å¦‚æœAIä¸çŸ¥é“é—®é¢˜çš„ç­”æ¡ˆï¼Œå®ƒä¼šè¡¨ç¤ºä¸çŸ¥é“ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å½“å‰å¯¹è¯ï¼š  </span></span><br><span class="line"><span class="string">&#123;history&#125;  </span></span><br><span class="line"><span class="string">Human: &#123;question&#125;  </span></span><br><span class="line"><span class="string">AI:&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ›å»ºå¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®ä¾‹åŒ–ConversationBufferWindowMemoryå¯¹è±¡ï¼Œè®¾å®šçª—å£é˜ˆå€¼  </span></span><br><span class="line">memory = ConversationBufferWindowMemory(k=<span class="number">1</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.å®šä¹‰LLMChain  </span></span><br><span class="line">conversation_with_summary = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=prompt_template,  </span><br><span class="line">    memory=memory,  </span><br><span class="line">    <span class="comment">#verbose=True,  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7.æ‰§è¡Œé“¾ï¼ˆç¬¬ä¸€æ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon1 = conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯å­™å°ç©º&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(respon1)  </span><br><span class="line"><span class="comment"># 8.æ‰§è¡Œé“¾ï¼ˆç¬¬äºŒæ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon2 =conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;æˆ‘è¿˜æœ‰ä¸¤ä¸ªå¸ˆå¼Ÿï¼Œä¸€ä¸ªæ˜¯çŒªå°æˆ’ï¼Œä¸€ä¸ªæ˜¯æ²™å°åƒ§&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(respon2)  </span><br><span class="line"><span class="comment"># 9.æ‰§è¡Œé“¾ï¼ˆç¬¬ä¸‰æ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon3 =conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;æˆ‘ä»Šå¹´é«˜è€ƒï¼Œç«Ÿç„¶è€ƒä¸Šäº†1æœ¬&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(respon3)  </span><br><span class="line"><span class="comment"># 10.æ‰§è¡Œé“¾ï¼ˆç¬¬å››æ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon4 =conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(respon4)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œæˆ‘æ˜¯å­™å°ç©º&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;ä½ å¥½ï¼Œå­™å°ç©ºï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼ä½ ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;æˆ‘è¿˜æœ‰ä¸¤ä¸ªå¸ˆå¼Ÿï¼Œä¸€ä¸ªæ˜¯çŒªå°æˆ’ï¼Œä¸€ä¸ªæ˜¯æ²™å°åƒ§&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘æ˜¯å­™å°ç©º\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œå­™å°ç©ºï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼ä½ ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;å“‡ï¼ŒçŒªå°æˆ’å’Œæ²™å°åƒ§å¬èµ·æ¥å¾ˆæœ‰è¶£ï¼ä»–ä»¬æ˜¯ä¸æ˜¯ä½ ä»¬å›¢é˜Ÿé‡Œçš„æç¬‘è§’è‰²å‘¢ï¼Ÿä½ ä»¬å¹³æ—¶éƒ½ä¸€èµ·åšäº›ä»€ä¹ˆå‘¢ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;æˆ‘ä»Šå¹´é«˜è€ƒï¼Œç«Ÿç„¶è€ƒä¸Šäº†<span class="number">1</span>æœ¬&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> æˆ‘è¿˜æœ‰ä¸¤ä¸ªå¸ˆå¼Ÿï¼Œä¸€ä¸ªæ˜¯çŒªå°æˆ’ï¼Œä¸€ä¸ªæ˜¯æ²™å°åƒ§\nAI<span class="punctuation">:</span> å“‡ï¼ŒçŒªå°æˆ’å’Œæ²™å°åƒ§å¬èµ·æ¥å¾ˆæœ‰è¶£ï¼ä»–ä»¬æ˜¯ä¸æ˜¯ä½ ä»¬å›¢é˜Ÿé‡Œçš„æç¬‘è§’è‰²å‘¢ï¼Ÿä½ ä»¬å¹³æ—¶éƒ½ä¸€èµ·åšäº›ä»€ä¹ˆå‘¢ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;å¤ªå‰å®³äº†ï¼æ­å–œä½ è€ƒä¸Šäº†ä¸€æœ¬ï¼è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æˆå°±ï¼Œä½ ä¸€å®šä»˜å‡ºäº†å¾ˆå¤šåŠªåŠ›ã€‚ä½ æƒ³è¦å­¦ä»€ä¹ˆä¸“ä¸šå‘¢ï¼Ÿæˆ–è€…æœ‰æ²¡æœ‰ä»€ä¹ˆå­¦æ ¡æ˜¯ä½ ç‰¹åˆ«æƒ³å»çš„ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> æˆ‘ä»Šå¹´é«˜è€ƒï¼Œç«Ÿç„¶è€ƒä¸Šäº†<span class="number">1</span>æœ¬\nAI<span class="punctuation">:</span> å¤ªå‰å®³äº†ï¼æ­å–œä½ è€ƒä¸Šäº†ä¸€æœ¬ï¼è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æˆå°±ï¼Œä½ ä¸€å®šä»˜å‡ºäº†å¾ˆå¤šåŠªåŠ›ã€‚ä½ æƒ³è¦å­¦ä»€ä¹ˆä¸“ä¸šå‘¢ï¼Ÿæˆ–è€…æœ‰æ²¡æœ‰ä»€ä¹ˆå­¦æ ¡æ˜¯ä½ ç‰¹åˆ«æƒ³å»çš„ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;æŠ±æ­‰ï¼Œæˆ‘ä¸çŸ¥é“ä½ çš„åå­—ã€‚ä½ æ„¿æ„å‘Šè¯‰æˆ‘å—ï¼Ÿæˆ–è€…æˆ‘ä»¬å¯ä»¥èŠèŠå…¶ä»–ä½ æ„Ÿå…´è¶£çš„äº‹æƒ…ï¼&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹4ï¼šä¿®æ”¹ä¸¾ä¾‹3ä¸­çš„å‚æ•°k</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferWindowMemory  </span><br><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.prompt <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æ¨¡ç‰ˆ  </span></span><br><span class="line">template = <span class="string">&quot;&quot;&quot;ä»¥ä¸‹æ˜¯äººç±»ä¸AIä¹‹é—´çš„å‹å¥½å¯¹è¯æè¿°ã€‚AIè¡¨ç°å¾—å¾ˆå¥è°ˆï¼Œå¹¶æä¾›äº†å¤§é‡æ¥è‡ªå…¶ä¸Šä¸‹æ–‡çš„å…·ä½“ç»†èŠ‚ã€‚å¦‚æœAIä¸çŸ¥é“é—®é¢˜çš„ç­”æ¡ˆï¼Œå®ƒä¼šè¡¨ç¤ºä¸çŸ¥é“ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å½“å‰å¯¹è¯ï¼š  </span></span><br><span class="line"><span class="string">&#123;history&#125;  </span></span><br><span class="line"><span class="string">Human: &#123;question&#125;  </span></span><br><span class="line"><span class="string">AI:&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ›å»ºå¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®ä¾‹åŒ–ConversationBufferWindowMemoryå¯¹è±¡ï¼Œè®¾å®šçª—å£é˜ˆå€¼  </span></span><br><span class="line">memory = ConversationBufferWindowMemory(k=<span class="number">3</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.å®šä¹‰LLMChain  </span></span><br><span class="line">conversation_with_summary = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=prompt_template,  </span><br><span class="line">    memory=memory,  </span><br><span class="line">    <span class="comment">#verbose=True,  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7.æ‰§è¡Œé“¾ï¼ˆç¬¬ä¸€æ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon1 = conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯å­™å°ç©º&quot;</span>&#125;)  </span><br><span class="line"><span class="comment"># print(respon1)  </span></span><br><span class="line"><span class="comment"># 8.æ‰§è¡Œé“¾ï¼ˆç¬¬äºŒæ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon2 =conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;æˆ‘è¿˜æœ‰ä¸¤ä¸ªå¸ˆå¼Ÿï¼Œä¸€ä¸ªæ˜¯çŒªå°æˆ’ï¼Œä¸€ä¸ªæ˜¯æ²™å°åƒ§&quot;</span>&#125;)  </span><br><span class="line"><span class="comment"># print(respon2)  </span></span><br><span class="line"><span class="comment"># 9.æ‰§è¡Œé“¾ï¼ˆç¬¬ä¸‰æ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon3 =conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;æˆ‘ä»Šå¹´é«˜è€ƒï¼Œç«Ÿç„¶è€ƒä¸Šäº†1æœ¬&quot;</span>&#125;)  </span><br><span class="line"><span class="comment"># print(respon3)  </span></span><br><span class="line"><span class="comment"># 10.æ‰§è¡Œé“¾ï¼ˆç¬¬å››æ¬¡æé—®ï¼‰  </span></span><br><span class="line">respon4 =conversation_with_summary.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(respon4)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;question&#x27;<span class="punctuation">:</span> &#x27;æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘æ˜¯å­™å°ç©º\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œå­™å°ç©ºï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚ä½ ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆæƒ³èŠçš„å†…å®¹å—ï¼Ÿ\nHuman<span class="punctuation">:</span> æˆ‘è¿˜æœ‰ä¸¤ä¸ªå¸ˆå¼Ÿï¼Œä¸€ä¸ªæ˜¯çŒªå°æˆ’ï¼Œä¸€ä¸ªæ˜¯æ²™å°åƒ§\nAI<span class="punctuation">:</span> å¾ˆé«˜å…´è®¤è¯†ä½ çš„å¸ˆå¼Ÿä»¬ï¼çŒªå°æˆ’å’Œæ²™å°åƒ§çš„åå­—å¬èµ·æ¥å¾ˆæœ‰è¶£ï¼Œä¼¼ä¹æœ‰äº›æ–‡è‰ºæˆ–æ˜¯ç¥è¯èƒŒæ™¯ã€‚ä½ ä»¬æ˜¯ä¸æ˜¯ä¸€èµ·å­¦ä¹ æˆ–è€…ä¿®ç‚¼ä»€ä¹ˆç‰¹åˆ«çš„æŠ€èƒ½å‘¢ï¼Ÿå¦‚æœæœ‰è¶£çš„æ•…äº‹æˆ–è€…å…±åŒç»å†ï¼Œæ¬¢è¿åˆ†äº«ï¼\nHuman<span class="punctuation">:</span> æˆ‘ä»Šå¹´é«˜è€ƒï¼Œç«Ÿç„¶è€ƒä¸Šäº†<span class="number">1</span>æœ¬\nAI<span class="punctuation">:</span> å¤ªæ£’äº†ï¼Œå­™å°ç©ºï¼æ­å–œä½ è€ƒä¸Šäº†ä¸€æœ¬å¤§å­¦ï¼è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æˆå°±ï¼Œä½ ä¸€å®šä¸ºè‡ªå·±æ„Ÿåˆ°éª„å‚²ã€‚ä½ æ‰“ç®—å­¦ä»€ä¹ˆä¸“ä¸šå‘¢ï¼Ÿæˆ–è€…ä½ å¯¹æœªæ¥æœ‰ä»€ä¹ˆè®¡åˆ’å—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;ä½ å«å­™å°ç©ºï¼å¦‚æœä½ æœ‰å…¶ä»–é—®é¢˜æˆ–è€…æƒ³èŠçš„è¯é¢˜ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="å…¶ä»–Memoryæ¨¡å—"><a href="#å…¶ä»–Memoryæ¨¡å—" class="headerlink" title="å…¶ä»–Memoryæ¨¡å—"></a>å…¶ä»–Memoryæ¨¡å—</h1><h2 id="ConversationTokenBufferMemory"><a href="#ConversationTokenBufferMemory" class="headerlink" title="ConversationTokenBufferMemory"></a>ConversationTokenBufferMemory</h2><p>ConversationTokenBufferMemory æ˜¯ LangChain ä¸­ä¸€ç§åŸºäº<strong>Token æ•°é‡æ§åˆ¶</strong>çš„å¯¹è¯è®°å¿†æœºåˆ¶ã€‚å¦‚æœ å­—ç¬¦æ•°é‡è¶…å‡ºæŒ‡å®šæ•°ç›®ï¼Œå®ƒä¼šåˆ‡æ‰è¿™ä¸ªå¯¹è¯çš„æ—©æœŸéƒ¨åˆ†ï¼Œä»¥ä¿ç•™ä¸æœ€è¿‘çš„äº¤æµç›¸å¯¹åº”çš„å­—ç¬¦æ•°é‡ã€‚</p><p>ç‰¹ç‚¹ï¼š </p><ul><li>Token ç²¾å‡†æ§åˆ¶ </li><li>åŸå§‹å¯¹è¯ä¿ç•™</li></ul><p><strong>åŸç†</strong>ï¼š<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013105438070.png"><br>ä¸¾ä¾‹ï¼šæƒ…å†µ1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationTokenBufferMemory  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆ›å»ºå¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ConversationTokenBufferMemoryå¯¹è±¡  </span></span><br><span class="line">memory = ConversationTokenBufferMemory(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    max_token_limit=<span class="number">10</span>  <span class="comment"># è®¾ç½®tokenä¸Šé™ï¼Œé»˜è®¤å€¼ä¸º2000  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ·»åŠ å¯¹è¯  </span></span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½å—ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æˆ‘å¾ˆå¥½ï¼Œè°¢è°¢ï¼&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ™´å¤©ï¼Œ25åº¦&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰è®°å¿†  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>history<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æƒ…å†µ2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationTokenBufferMemory  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆ›å»ºå¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ConversationTokenBufferMemoryå¯¹è±¡  </span></span><br><span class="line">memory = ConversationTokenBufferMemory(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    max_token_limit=<span class="number">20</span>  <span class="comment"># è®¾ç½®tokenä¸Šé™ï¼Œé»˜è®¤å€¼ä¸º2000  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ·»åŠ å¯¹è¯  </span></span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½å—ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æˆ‘å¾ˆå¥½ï¼Œè°¢è°¢ï¼&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ™´å¤©ï¼Œ25åº¦&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰è®°å¿†  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;AI<span class="punctuation">:</span> æ™´å¤©ï¼Œ<span class="number">25</span>åº¦&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ConversationSummaryMemory"><a href="#ConversationSummaryMemory" class="headerlink" title="ConversationSummaryMemory"></a>ConversationSummaryMemory</h2><p>å‰â¾¯çš„â½…å¼å‘ç°ï¼Œå¦‚æœå…¨éƒ¨ä¿å­˜ä¸‹æ¥å¤ªè¿‡æµªè´¹ï¼Œæˆªæ–­æ—¶â½†è®ºæ˜¯æŒ‰ç…§ <strong>å¯¹è¯æ¡æ•°</strong> è¿˜æ˜¯ <strong>token</strong> éƒ½æ˜¯â½†æ³• ä¿è¯æ—¢èŠ‚çœå†…å­˜â¼œä¿è¯å¯¹è¯è´¨é‡çš„ï¼Œæ‰€ä»¥æ¨å‡ºConversationSummaryMemoryã€ ConversationSummaryBufferMemory</p><p>ConversationSummaryMemoryæ˜¯ LangChain ä¸­ä¸€ç§ <strong>æ™ºèƒ½å‹ç¼©å¯¹è¯å†å²</strong>çš„è®°å¿†æœºåˆ¶ï¼Œå®ƒé€šè¿‡å¤§è¯­è¨€æ¨¡ å‹(LLM)è‡ªåŠ¨ç”Ÿæˆå¯¹è¯å†…å®¹çš„ <strong>ç²¾ç®€æ‘˜è¦</strong>ï¼Œè€Œä¸æ˜¯å­˜å‚¨åŸå§‹å¯¹è¯æ–‡æœ¬ã€‚ </p><p>è¿™ç§è®°å¿†æ–¹å¼ç‰¹åˆ«é€‚åˆ<strong>é•¿å¯¹è¯</strong>å’Œéœ€è¦<strong>ä¿ç•™æ ¸å¿ƒä¿¡æ¯</strong>çš„åœºæ™¯ã€‚</p><p>ç‰¹ç‚¹ï¼š </p><ul><li>æ‘˜è¦ç”Ÿæˆ </li><li>åŠ¨æ€æ›´æ–° </li><li>ä¸Šä¸‹æ–‡ä¼˜åŒ–</li></ul><p>åŸç†ï¼š</p><p><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013105819616.png"></p><p>åœºæ™¯1ï¼š<br>å¦‚æœå®ä¾‹åŒ–ConversationSummaryMemoryå‰ï¼Œæ²¡æœ‰å†å²æ¶ˆæ¯ï¼Œå¯ä»¥ä½¿ç”¨æ„é€ æ–¹æ³•å®ä¾‹åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationSummaryMemory, ChatMessageHistory  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆ›å»ºå¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ConversationSummaryMemoryå¯¹è±¡  </span></span><br><span class="line">memory = ConversationSummaryMemory(llm=llm)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å­˜å‚¨æ¶ˆæ¯  </span></span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ å¥½&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ€ä¹ˆäº†&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä½ æ˜¯è°&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;æˆ‘æ˜¯AIåŠ©æ‰‹å°æ™º&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;åˆæ¬¡å¯¹è¯ï¼Œä½ èƒ½ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±å—ï¼Ÿ&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;å½“ç„¶å¯ä»¥äº†ã€‚æˆ‘æ˜¯ä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„å°æ™ºã€‚&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.è¯»å–æ¶ˆæ¯ï¼ˆæ€»ç»“åçš„ï¼‰  </span></span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;The human greets the AI with <span class="string">&quot;ä½ å¥½&quot;</span> (hello)<span class="punctuation">,</span> and the AI responds with <span class="string">&quot;æ€ä¹ˆäº†&quot;</span> (what\&#x27;s wrong?). The human then asks<span class="punctuation">,</span> <span class="string">&quot;ä½ æ˜¯è°&quot;</span> (who are you?)<span class="punctuation">,</span> to which the AI replies<span class="punctuation">,</span> <span class="string">&quot;æˆ‘æ˜¯AIåŠ©æ‰‹å°æ™º&quot;</span> (I am the AI assistant Xiao Zhi). The human requests an introduction<span class="punctuation">,</span> and the AI states<span class="punctuation">,</span> <span class="string">&quot;å½“ç„¶å¯ä»¥äº†ã€‚æˆ‘æ˜¯ä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„å°æ™º&quot;</span> (Of course<span class="punctuation">,</span> I am an all-powerful Xiao Zhi).&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åœºæ™¯2ï¼š<br>å¦‚æœå®ä¾‹åŒ–ConversationSummaryMemoryå‰ï¼Œå·²ç»æœ‰å†å²æ¶ˆæ¯ï¼Œå¯ä»¥è°ƒç”¨from_messages()å®ä¾‹åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationSummaryMemory, ChatMessageHistory  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ChatMessageHistoryå¯¹è±¡  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å‡è®¾åŸå§‹æ¶ˆæ¯  </span></span><br><span class="line">history = ChatMessageHistory()  </span><br><span class="line">history.add_user_message(<span class="string">&quot;ä½ å¥½ï¼Œä½ æ˜¯è°ï¼Ÿ&quot;</span>)  </span><br><span class="line">history.add_ai_message(<span class="string">&quot;æˆ‘æ˜¯AIåŠ©æ‰‹å°æ™º&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ›å»ºConversationSummaryMemoryçš„å®ä¾‹  </span></span><br><span class="line">memory = ConversationSummaryMemory.from_messages(  </span><br><span class="line">    llm = llm,  </span><br><span class="line">    <span class="comment">#æ˜¯ç”Ÿæˆæ‘˜è¦çš„åŸææ–™ ä¿ç•™å®Œæ•´å¯¹è¯ä¾›å¿…è¦æ—¶å›æº¯ã€‚å½“æ–°å¢å¯¹è¯æ—¶ï¼ŒLLMéœ€è¦ç»“åˆåŸå§‹å†å²ç”Ÿæˆæ–°æ‘˜è¦  </span></span><br><span class="line">    chat_memory = history,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;human&quot;</span>:<span class="string">&quot;æˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;ai&quot;</span>:<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è®°å½•äº†å†å²çš„äº¤äº’çš„æ¶ˆæ¯  </span></span><br><span class="line"><span class="built_in">print</span>(memory.chat_memory.messages)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;The human greets the AI and asks who it is. The AI responds that it is an AI assistant named Xiao Zhi.&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;The human greets the AI<span class="punctuation">,</span> asks who it is<span class="punctuation">,</span> and introduces himself as Xiao Ming. The AI responds that it is an AI assistant named Xiao Zhi and expresses pleasure in meeting him.&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">[</span>HumanMessage(content=&#x27;ä½ å¥½ï¼Œä½ æ˜¯è°ï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æˆ‘æ˜¯AIåŠ©æ‰‹å°æ™º&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;æˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ &#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span></span><br></pre></td></tr></table></figure><h2 id="ConversationSummaryBufferMemory"><a href="#ConversationSummaryBufferMemory" class="headerlink" title="ConversationSummaryBufferMemory"></a>ConversationSummaryBufferMemory</h2><p>ConversationSummaryBufferMemory æ˜¯ LangChain ä¸­ä¸€ç§<strong>æ··åˆå‹è®°å¿†æœºåˆ¶</strong>ï¼Œå®ƒç»“åˆäº† ConversationBufferMemoryï¼ˆå®Œæ•´å¯¹è¯è®°å½•ï¼‰å’Œ ConversationSummaryMemoryï¼ˆæ‘˜è¦è®°å¿†ï¼‰çš„ä¼˜ ç‚¹ï¼Œåœ¨ä¿ç•™æœ€è¿‘ <strong>å¯¹è¯åŸå§‹è®°å½•</strong>çš„åŒæ—¶ï¼Œå¯¹è¾ƒæ—©çš„å¯¹è¯å†…å®¹è¿›è¡Œ<strong>æ™ºèƒ½æ‘˜è¦</strong></p><p>ç‰¹ç‚¹ï¼š </p><ul><li>ä¿ç•™æœ€è¿‘Næ¡åŸå§‹å¯¹è¯ï¼šç¡®ä¿æœ€æ–°äº¤äº’çš„å®Œæ•´ä¸Šä¸‹æ–‡ æ™ºèƒ½æ‘˜è¦ã€‚ </li><li>æ‘˜è¦è¾ƒæ—©å†å²ï¼šå¯¹è¶…å‡ºç¼“å†²åŒºçš„æ—§å¯¹è¯è¿›è¡Œå‹ç¼©ï¼Œé¿å…ä¿¡æ¯è¿‡è½½ </li><li>å¹³è¡¡ç»†èŠ‚ä¸æ•ˆç‡ï¼šæ—¢ä¸ä¼šä¸¢å¤±å…³é”®ç»†èŠ‚ï¼Œåˆèƒ½å¤„ç†é•¿å¯¹è¯</li></ul><p>åŸç†ï¼š<br><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013110446863.png"><br>åœºæ™¯1ï¼šå…¥é—¨ä½¿ç”¨<br>æƒ…å†µ1ï¼šæ„é€ æ–¹æ³•å®ä¾‹åŒ–ï¼Œå¹¶è®¾ç½®max_token_limit</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationSummaryBufferMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ConversationSummaryBufferMemory  </span></span><br><span class="line">memory = ConversationSummaryBufferMemory(  </span><br><span class="line">    llm = llm,  </span><br><span class="line">    max_token_limit=<span class="number">40</span>,  <span class="comment">#æ§åˆ¶ç¼“å†²åŒºçš„å¤§å°  </span></span><br><span class="line">    return_messages=<span class="literal">True</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å‘memoryä¸­å­˜å‚¨ä¿¡æ¯  </span></span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;output&quot;</span>:<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>&#125;)  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;æç™½æ˜¯å“ªä¸ªæœä»£çš„è¯—äºº&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;output&quot;</span>:<span class="string">&quot;æç™½æ˜¯å”æœçš„è¯—äºº&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;å”å®‹å…«å¤§å®¶é‡Œæœ‰è‹è½¼å—ï¼Ÿ&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;output&quot;</span>:<span class="string">&quot;æœ‰&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.chat_memory.messages)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>SystemMessage(content=&#x27;The human introduces themselves as å°æ˜. The AI expresses happiness to meet them. The human asks which dynasty the poet Li Bai belongs to.&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æç™½æ˜¯å”æœçš„è¯—äºº&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;å”å®‹å…«å¤§å®¶é‡Œæœ‰è‹è½¼å—ï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æœ‰&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[</span>AIMessage(content=&#x27;æç™½æ˜¯å”æœçš„è¯—äºº&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;å”å®‹å…«å¤§å®¶é‡Œæœ‰è‹è½¼å—ï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æœ‰&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯¹æ¯”ç»„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationSummaryBufferMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¤§æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ConversationSummaryBufferMemory  </span></span><br><span class="line">memory = ConversationSummaryBufferMemory(  </span><br><span class="line">    llm = llm,  </span><br><span class="line">    max_token_limit=<span class="number">100</span>,  <span class="comment">#æ§åˆ¶ç¼“å†²åŒºçš„å¤§å°  </span></span><br><span class="line">    return_messages=<span class="literal">True</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å‘memoryä¸­å­˜å‚¨ä¿¡æ¯  </span></span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;output&quot;</span>:<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>&#125;)  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;æç™½æ˜¯å“ªä¸ªæœä»£çš„è¯—äºº&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;output&quot;</span>:<span class="string">&quot;æç™½æ˜¯å”æœçš„è¯—äºº&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(inputs=&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;å”å®‹å…«å¤§å®¶é‡Œæœ‰è‹è½¼å—ï¼Ÿ&quot;</span>&#125;,outputs=&#123;<span class="string">&quot;output&quot;</span>:<span class="string">&quot;æœ‰&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.chat_memory.messages)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>HumanMessage(content=&#x27;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ &#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;æç™½æ˜¯å“ªä¸ªæœä»£çš„è¯—äºº&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æç™½æ˜¯å”æœçš„è¯—äºº&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;å”å®‹å…«å¤§å®¶é‡Œæœ‰è‹è½¼å—ï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æœ‰&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[</span>HumanMessage(content=&#x27;ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å°æ˜&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ &#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;æç™½æ˜¯å“ªä¸ªæœä»£çš„è¯—äºº&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æç™½æ˜¯å”æœçš„è¯—äºº&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;å”å®‹å…«å¤§å®¶é‡Œæœ‰è‹è½¼å—ï¼Ÿ&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æœ‰&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šæ¨¡æ‹Ÿå®¢æœäº¤äº’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationSummaryBufferMemory  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, MessagesPlaceholder  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆå§‹åŒ–å¤§è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;gpt-4o-mini&quot;</span>,  </span><br><span class="line">    temperature=<span class="number">0.5</span>,  </span><br><span class="line">    max_tokens=<span class="number">500</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€å®šä¹‰æç¤ºæ¨¡æ¿  </span></span><br><span class="line">prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ç”µå•†å®¢æœåŠ©æ‰‹ï¼Œç”¨ä¸­æ–‡å‹å¥½å›å¤ç”¨æˆ·é—®é¢˜ã€‚ä¿æŒä¸“ä¸šä½†äº²åˆ‡çš„è¯­æ°”ã€‚&quot;</span>),  </span><br><span class="line">    MessagesPlaceholder(variable_name=<span class="string">&quot;chat_history&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;input&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€åˆ›å»ºå¸¦æ‘˜è¦ç¼“å†²çš„è®°å¿†ç³»ç»Ÿ  </span></span><br><span class="line">memory = ConversationSummaryBufferMemory(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    max_token_limit=<span class="number">400</span>,  </span><br><span class="line">    memory_key=<span class="string">&quot;chat_history&quot;</span>,  </span><br><span class="line">    return_messages=<span class="literal">True</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4ã€åˆ›å»ºå¯¹è¯é“¾  </span></span><br><span class="line">chain = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=prompt,  </span><br><span class="line">    memory=memory,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5ã€æ¨¡æ‹Ÿå¤šè½®å¯¹è¯  </span></span><br><span class="line">dialogue = [  </span><br><span class="line">    (<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘æƒ³æŸ¥è¯¢è®¢å•12345çš„çŠ¶æ€&quot;</span>, <span class="literal">None</span>),  </span><br><span class="line">    (<span class="string">&quot;è¿™ä¸ªè®¢å•æ˜¯ä¸Šå‘¨äº”ä¸‹çš„&quot;</span>, <span class="literal">None</span>),  </span><br><span class="line">    (<span class="string">&quot;æˆ‘ç°åœ¨æ€¥ç€ç”¨ï¼Œèƒ½åŠ æ€¥å¤„ç†å—&quot;</span>, <span class="literal">None</span>),  </span><br><span class="line">    (<span class="string">&quot;ç­‰ç­‰ï¼Œæˆ‘å¯èƒ½è®°é”™è®¢å•å·äº†ï¼Œåº”è¯¥æ˜¯12346&quot;</span>, <span class="literal">None</span>),  </span><br><span class="line">    (<span class="string">&quot;å¯¹äº†ï¼Œä½ ä»¬é€€è´§æ”¿ç­–æ˜¯æ€æ ·çš„&quot;</span>, <span class="literal">None</span>)  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6ã€æ‰§è¡Œå¯¹è¯  </span></span><br><span class="line"><span class="keyword">for</span> user_input, _ <span class="keyword">in</span> dialogue:  </span><br><span class="line">    response = chain.invoke(&#123;<span class="string">&quot;input&quot;</span>: user_input&#125;)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç”¨æˆ·: <span class="subst">&#123;user_input&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å®¢æœ: <span class="subst">&#123;response[<span class="string">&#x27;text&#x27;</span>]&#125;</span>\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7ã€æŸ¥çœ‹å½“å‰è®°å¿†çŠ¶æ€  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== å½“å‰è®°å¿†å†…å®¹ ===&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘æƒ³æŸ¥è¯¢è®¢å•<span class="number">12345</span>çš„çŠ¶æ€</span><br><span class="line">å®¢æœ<span class="punctuation">:</span> æ‚¨å¥½ï¼æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ã€‚å…³äºè®¢å•<span class="number">12345</span>çš„çŠ¶æ€ï¼Œæˆ‘ä¼šå°½å¿«ä¸ºæ‚¨æŸ¥è¯¢ã€‚è¯·ç¨ç­‰ç‰‡åˆ»ã€‚ </span><br><span class="line"></span><br><span class="line">ï¼ˆå¦‚æœæ‚¨éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œè¯·æä¾›è®¢å•ç›¸å…³çš„è”ç³»æ–¹å¼æˆ–å…¶ä»–ä¿¡æ¯ï¼Œä»¥ä¾¿æˆ‘æ›´å¥½åœ°ä¸ºæ‚¨æœåŠ¡ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·<span class="punctuation">:</span> è¿™ä¸ªè®¢å•æ˜¯ä¸Šå‘¨äº”ä¸‹çš„</span><br><span class="line">å®¢æœ<span class="punctuation">:</span> è°¢è°¢æ‚¨æä¾›çš„ä¿¡æ¯ï¼æˆ‘ä¼šå°½å¿«å¸®æ‚¨æŸ¥è¯¢ä¸Šå‘¨äº”ä¸‹çš„è®¢å•<span class="number">12345</span>çš„çŠ¶æ€ã€‚è¯·ç¨ç­‰ç‰‡åˆ»ã€‚</span><br><span class="line"></span><br><span class="line">ï¼ˆå¦‚æœæ‚¨æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼ï¼‰</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·<span class="punctuation">:</span> æˆ‘ç°åœ¨æ€¥ç€ç”¨ï¼Œèƒ½åŠ æ€¥å¤„ç†å—</span><br><span class="line">å®¢æœ<span class="punctuation">:</span> æˆ‘ç†è§£æ‚¨çš„ç€æ€¥å¿ƒæƒ…ï¼å…³äºåŠ æ€¥å¤„ç†è®¢å•çš„è¯·æ±‚ï¼Œé€šå¸¸éœ€è¦è”ç³»é…é€éƒ¨é—¨è¿›è¡Œç¡®è®¤ã€‚è¯·æ‚¨æä¾›ä¸€ä¸‹æ‚¨çš„è”ç³»æ–¹å¼ï¼Œæˆ‘ä¼šå°½å¿«å°†æ‚¨çš„è¯·æ±‚åé¦ˆç»™ç›¸å…³éƒ¨é—¨ï¼Œäº‰å–ä¸ºæ‚¨åŠ æ€¥å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‚¨æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·<span class="punctuation">:</span> ç­‰ç­‰ï¼Œæˆ‘å¯èƒ½è®°é”™è®¢å•å·äº†ï¼Œåº”è¯¥æ˜¯<span class="number">12346</span></span><br><span class="line">å®¢æœ<span class="punctuation">:</span> æ²¡é—®é¢˜ï¼Œæ„Ÿè°¢æ‚¨æ›´æ–°è®¢å•å·ï¼æˆ‘å°†ç«‹å³ä¸ºæ‚¨æŸ¥è¯¢è®¢å•<span class="number">12346</span>çš„çŠ¶æ€ã€‚è¯·ç¨ç­‰ç‰‡åˆ»ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·<span class="punctuation">:</span> å¯¹äº†ï¼Œä½ ä»¬é€€è´§æ”¿ç­–æ˜¯æ€æ ·çš„</span><br><span class="line">å®¢æœ<span class="punctuation">:</span> æˆ‘ä»¬çš„é€€è´§æ”¿ç­–å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> **é€€è´§æœŸé™**ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥åœ¨æ”¶åˆ°å•†å“åçš„<span class="number">7</span>å¤©å†…ç”³è¯·é€€è´§ã€‚</span><br><span class="line"><span class="number">2.</span> **é€€è´§æ¡ä»¶**ï¼šå•†å“å¿…é¡»ä¿æŒæœªä½¿ç”¨çŠ¶æ€ï¼ŒåŒ…è£…å®Œæ•´ï¼Œé™„å¸¦åŸå§‹æ ‡ç­¾å’Œå‘ç¥¨ã€‚</span><br><span class="line"><span class="number">3.</span> **é€€è´§æµç¨‹**ï¼šè¯·æ‚¨å…ˆè”ç³»å®¢æœç”³è¯·é€€è´§ï¼Œæä¾›è®¢å•å·å’Œé€€è´§åŸå› ï¼Œæˆ‘ä»¬ä¼šä¸ºæ‚¨ç”Ÿæˆé€€è´§ç”³è¯·å¹¶æä¾›ç›¸åº”çš„é€€è´§åœ°å€ã€‚</span><br><span class="line"><span class="number">4.</span> **é€€æ¬¾æ–¹å¼**ï¼šé€€è´§å•†å“ç¡®è®¤æ— è¯¯åï¼Œæˆ‘ä»¬ä¼šåœ¨<span class="number">3</span><span class="number">-5</span>ä¸ªå·¥ä½œæ—¥å†…å¤„ç†é€€æ¬¾ï¼Œé€€æ¬¾å°†æŒ‰ç…§æ‚¨åŸæ”¯ä»˜æ–¹å¼è¿”è¿˜ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‚¨æœ‰å…·ä½“çš„å•†å“éœ€è¦é€€è´§æˆ–è€…å…¶ä»–ç›¸å…³é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›ä¸ºæ‚¨æä¾›å¸®åŠ©ï¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=== å½“å‰è®°å¿†å†…å®¹ ===</span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;chat_history&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>SystemMessage(content=&#x27;The human inquires about the status of order <span class="number">12345.</span> The AI responds by thanking the human for their inquiry and states that it will quickly check the status of the order<span class="punctuation">,</span> asking the human to wait a moment. The AI also offers to assist further if the human provides additional contact or order-related information.&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;è¿™ä¸ªè®¢å•æ˜¯ä¸Šå‘¨äº”ä¸‹çš„&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;è°¢è°¢æ‚¨æä¾›çš„ä¿¡æ¯ï¼æˆ‘ä¼šå°½å¿«å¸®æ‚¨æŸ¥è¯¢ä¸Šå‘¨äº”ä¸‹çš„è®¢å•<span class="number">12345</span>çš„çŠ¶æ€ã€‚è¯·ç¨ç­‰ç‰‡åˆ»ã€‚\n\nï¼ˆå¦‚æœæ‚¨æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼ï¼‰&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;æˆ‘ç°åœ¨æ€¥ç€ç”¨ï¼Œèƒ½åŠ æ€¥å¤„ç†å—&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æˆ‘ç†è§£æ‚¨çš„ç€æ€¥å¿ƒæƒ…ï¼å…³äºåŠ æ€¥å¤„ç†è®¢å•çš„è¯·æ±‚ï¼Œé€šå¸¸éœ€è¦è”ç³»é…é€éƒ¨é—¨è¿›è¡Œç¡®è®¤ã€‚è¯·æ‚¨æä¾›ä¸€ä¸‹æ‚¨çš„è”ç³»æ–¹å¼ï¼Œæˆ‘ä¼šå°½å¿«å°†æ‚¨çš„è¯·æ±‚åé¦ˆç»™ç›¸å…³éƒ¨é—¨ï¼Œäº‰å–ä¸ºæ‚¨åŠ æ€¥å¤„ç†ã€‚\n\nå¦‚æœæ‚¨æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;ç­‰ç­‰ï¼Œæˆ‘å¯èƒ½è®°é”™è®¢å•å·äº†ï¼Œåº”è¯¥æ˜¯<span class="number">12346</span>&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æ²¡é—®é¢˜ï¼Œæ„Ÿè°¢æ‚¨æ›´æ–°è®¢å•å·ï¼æˆ‘å°†ç«‹å³ä¸ºæ‚¨æŸ¥è¯¢è®¢å•<span class="number">12346</span>çš„çŠ¶æ€ã€‚è¯·ç¨ç­‰ç‰‡åˆ»ã€‚\n\nå¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> HumanMessage(content=&#x27;å¯¹äº†ï¼Œä½ ä»¬é€€è´§æ”¿ç­–æ˜¯æ€æ ·çš„&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;æˆ‘ä»¬çš„é€€è´§æ”¿ç­–å¦‚ä¸‹ï¼š\n\n1. **é€€è´§æœŸé™**ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥åœ¨æ”¶åˆ°å•†å“åçš„<span class="number">7</span>å¤©å†…ç”³è¯·é€€è´§ã€‚\n2. **é€€è´§æ¡ä»¶**ï¼šå•†å“å¿…é¡»ä¿æŒæœªä½¿ç”¨çŠ¶æ€ï¼ŒåŒ…è£…å®Œæ•´ï¼Œé™„å¸¦åŸå§‹æ ‡ç­¾å’Œå‘ç¥¨ã€‚\n3. **é€€è´§æµç¨‹**ï¼šè¯·æ‚¨å…ˆè”ç³»å®¢æœç”³è¯·é€€è´§ï¼Œæä¾›è®¢å•å·å’Œé€€è´§åŸå› ï¼Œæˆ‘ä»¬ä¼šä¸ºæ‚¨ç”Ÿæˆé€€è´§ç”³è¯·å¹¶æä¾›ç›¸åº”çš„é€€è´§åœ°å€ã€‚\n4. **é€€æ¬¾æ–¹å¼**ï¼šé€€è´§å•†å“ç¡®è®¤æ— è¯¯åï¼Œæˆ‘ä»¬ä¼šåœ¨<span class="number">3</span><span class="number">-5</span>ä¸ªå·¥ä½œæ—¥å†…å¤„ç†é€€æ¬¾ï¼Œé€€æ¬¾å°†æŒ‰ç…§æ‚¨åŸæ”¯ä»˜æ–¹å¼è¿”è¿˜ã€‚\n\nå¦‚æœæ‚¨æœ‰å…·ä½“çš„å•†å“éœ€è¦é€€è´§æˆ–è€…å…¶ä»–ç›¸å…³é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›ä¸ºæ‚¨æä¾›å¸®åŠ©ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ConversationEntityMemory-äº†è§£"><a href="#ConversationEntityMemory-äº†è§£" class="headerlink" title="ConversationEntityMemory(äº†è§£)"></a>ConversationEntityMemory(äº†è§£)</h2><p>ConversationEntityMemory æ˜¯ä¸€ç§åŸºäº<strong>å®ä½“çš„å¯¹è¯è®°å¿†æœºåˆ¶</strong>ï¼Œå®ƒèƒ½å¤Ÿæ™ºèƒ½åœ°è¯†åˆ«ã€å­˜å‚¨å’Œåˆ©ç”¨å¯¹è¯ä¸­ å‡ºç°çš„å®ä½“ä¿¡æ¯ï¼ˆå¦‚äººåã€åœ°ç‚¹ã€äº§å“ç­‰ï¼‰åŠå…¶<strong>å±æ€§&#x2F;å…³ç³»</strong>ï¼Œå¹¶ç»“æ„åŒ–å­˜å‚¨ï¼Œä½¿ AI å…·å¤‡æ›´å¼ºçš„ä¸Šä¸‹æ–‡ç† è§£å’Œè®°å¿†èƒ½åŠ›ã€‚</p><p><strong>å¥½å¤„ï¼šè§£å†³ä¿¡æ¯è¿‡è½½é—®é¢˜</strong> </p><ul><li>é•¿å¯¹è¯ä¸­å¤§é‡å†—ä½™ä¿¡æ¯ä¼šå¹²æ‰°å…³é”®äº‹å®è®°å¿† </li><li>é€šè¿‡å¯¹å®ä½“æ‘˜è¦ï¼Œå¯ä»¥å‹ç¼©éé‡è¦ç»†èŠ‚ï¼ˆå¦‚åˆ é™¤å¯’æš„ç­‰ï¼Œä¿ç•™ä»·æ ¼&#x2F;æ—¶é—´ç­‰ç¡¬æ€§äº‹å®ï¼‰</li></ul><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåœ¨åŒ»ç–—ç­‰é«˜é£é™©é¢†åŸŸï¼Œå¿…é¡»ç”¨å®ä½“è®°å¿†ç¡®ä¿å…³é”®ä¿¡æ¯ï¼ˆå¦‚è¿‡æ•å²ï¼‰è¢«100%å‡†ç¡®è¯†åˆ«å’Œæ‹¦ æˆªã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;input&quot;: &quot;æˆ‘å¤´ç—›ï¼Œè¡€å‹140/90ï¼Œåœ¨åƒé˜¿å¸åŒ¹æ—ã€‚&quot;&#125;, </span><br><span class="line">&#123;&quot;output&quot;: &quot;å»ºè®®ç›‘æµ‹è¡€å‹ï¼Œé˜¿å¸åŒ¹æ—å¯ç»§ç»­æœç”¨ã€‚&quot;&#125; </span><br><span class="line">&#123;&quot;input&quot;: &quot;æˆ‘å¯¹é’éœ‰ç´ è¿‡æ•ã€‚&quot;&#125;, </span><br><span class="line">&#123;&quot;output&quot;: &quot;å·²è®°å½•æ‚¨çš„é’éœ‰ç´ è¿‡æ•å²ã€‚&quot;&#125; </span><br><span class="line">&#123;&quot;input&quot;: &quot;é˜¿å¸åŒ¹æ—åƒäº†ä¸‰å¤©ï¼Œå¤´ç—›æ²¡ç¼“è§£ã€‚&quot;&#125;, </span><br><span class="line">&#123;&quot;output&quot;: &quot;å»ºè®®åœç”¨é˜¿å¸åŒ¹æ—ï¼Œæ¢å¸ƒæ´›èŠ¬è¯•è¯•ã€‚&quot;&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ConversationSummaryMemory</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;æ‚£è€…ä¸»è¯‰å¤´ç—›å’Œâ¾¼â¾å‹ï¼ˆ140/90ï¼‰ï¼Œæ­£åœ¨æœâ½¤é˜¿å¸åŒ¹æ—ã€‚æ‚£è€…å¯¹â»˜éœ‰ç´ è¿‡æ•ã€‚ä¸‰å¤©åå¤´ç—›æœªç¼“ è§£ï¼Œå»ºè®®æ›´æ¢â½Œç—›è¯ã€‚&quot;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ConversationEntityMemory</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> <span class="attr">&quot;ç—‡çŠ¶&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¤´ç—›&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="attr">&quot;â¾å‹&quot;</span><span class="punctuation">:</span> <span class="string">&quot;140/90&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="attr">&quot;å½“å‰â½¤è¯&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é˜¿å¸åŒ¹æ—ï¼ˆâ½†æ•ˆï¼‰&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="attr">&quot;è¿‡æ•è¯ç‰©&quot;</span><span class="punctuation">:</span> <span class="string">&quot;â»˜éœ‰ç´ &quot;</span> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>å¯¹æ¯”ï¼šConversationSummaryMemory å’Œ ConversationEntityMemory</strong></p><p><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013111012635.png"></p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.conversation.base <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationEntityMemory  </span><br><span class="line"><span class="keyword">from</span> langchain.memory.prompt <span class="keyword">import</span> ENTITY_MEMORY_CONVERSATION_TEMPLATE  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">llm = ChatOpenAI(model_name=<span class="string">&#x27;gpt-4o-mini&#x27;</span>, temperature=<span class="number">0</span>)  </span><br><span class="line"><span class="comment"># ä½¿ç”¨LangChainä¸ºå®ä½“è®°å¿†è®¾è®¡çš„é¢„å®šä¹‰æ¨¡æ¿  </span></span><br><span class="line">prompt = ENTITY_MEMORY_CONVERSATION_TEMPLATE  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å®ä½“è®°å¿†  </span></span><br><span class="line">memory = ConversationEntityMemory(llm=llm)  </span><br><span class="line"><span class="comment"># æä¾›å¯¹è¯é“¾  </span></span><br><span class="line">chain = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=ENTITY_MEMORY_CONVERSATION_TEMPLATE,  </span><br><span class="line">    memory=ConversationEntityMemory(llm=llm),  </span><br><span class="line">    <span class="comment">#verbose=True,  # è®¾ç½®ä¸ºTrueå¯ä»¥çœ‹åˆ°é“¾çš„è¯¦ç»†æ¨ç†è¿‡ç¨‹  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿›è¡Œå‡ è½®å¯¹è¯ï¼Œè®°å¿†ç»„ä»¶ä¼šåœ¨åå°è‡ªåŠ¨æå–å’Œå­˜å‚¨å®ä½“ä¿¡æ¯  </span></span><br><span class="line">chain.invoke(<span class="built_in">input</span>=<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘å«èœ˜è››ä¾ ã€‚æˆ‘çš„å¥½æœ‹å‹åŒ…æ‹¬é’¢é“ä¾ ã€ç¾å›½é˜Ÿé•¿å’Œç»¿å·¨äººã€‚&quot;</span>)  </span><br><span class="line">chain.invoke(<span class="built_in">input</span>=<span class="string">&quot;æˆ‘ä½åœ¨çº½çº¦ã€‚&quot;</span>)  </span><br><span class="line">chain.invoke(<span class="built_in">input</span>=<span class="string">&quot;æˆ‘ä½¿ç”¨çš„è£…å¤‡æ˜¯ç”±æ–¯å¡”å…‹å·¥ä¸šæä¾›çš„ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æŸ¥è¯¢è®°å¿†ä½“ä¸­å­˜å‚¨çš„å®ä½“ä¿¡æ¯  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå½“å‰å­˜å‚¨çš„å®ä½“ä¿¡æ¯:&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(chain.memory.entity_store.store)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰å­˜å‚¨çš„å®ä½“ä¿¡æ¯<span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;èœ˜è››ä¾ &#x27;<span class="punctuation">:</span> &#x27;èœ˜è››ä¾ çš„å¥½æœ‹å‹åŒ…æ‹¬é’¢é“ä¾ ã€ç¾å›½é˜Ÿé•¿å’Œç»¿å·¨äººã€‚&#x27;<span class="punctuation">,</span> &#x27;é’¢é“ä¾ &#x27;<span class="punctuation">:</span> &#x27;é’¢é“ä¾ æ˜¯èœ˜è››ä¾ çš„å¥½æœ‹å‹ä¹‹ä¸€ã€‚&#x27;<span class="punctuation">,</span> &#x27;ç¾å›½é˜Ÿé•¿&#x27;<span class="punctuation">:</span> &#x27;ç¾å›½é˜Ÿé•¿æ˜¯èœ˜è››ä¾ çš„å¥½æœ‹å‹ä¹‹ä¸€ã€‚&#x27;<span class="punctuation">,</span> &#x27;ç»¿å·¨äºº&#x27;<span class="punctuation">:</span> &#x27;ç»¿å·¨äººæ˜¯èœ˜è››ä¾ çš„å¥½æœ‹å‹ä¹‹ä¸€ã€‚&#x27;<span class="punctuation">,</span> &#x27;çº½çº¦&#x27;<span class="punctuation">:</span> &#x27;èœ˜è››ä¾ ä½åœ¨çº½çº¦ã€‚&#x27;<span class="punctuation">,</span> &#x27;æ–¯å¡”å…‹å·¥ä¸š&#x27;<span class="punctuation">:</span> &#x27;æ–¯å¡”å…‹å·¥ä¸šæä¾›äº†èœ˜è››ä¾ ä½¿ç”¨çš„è£…å¤‡ã€‚&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŸºäºè®°å¿†è¿›è¡Œæé—®  </span></span><br><span class="line">answer = chain.invoke(<span class="built_in">input</span>=<span class="string">&quot;ä½ èƒ½å‘Šè¯‰æˆ‘èœ˜è››ä¾ ä½åœ¨å“ªé‡Œä»¥åŠä»–çš„å¥½æœ‹å‹æœ‰å“ªäº›å—ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nAIçš„å›ç­”:&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(answer)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">AIçš„å›ç­”<span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;input&#x27;<span class="punctuation">:</span> &#x27;ä½ èƒ½å‘Šè¯‰æˆ‘èœ˜è››ä¾ ä½åœ¨å“ªé‡Œä»¥åŠä»–çš„å¥½æœ‹å‹æœ‰å“ªäº›å—ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> ä½ å¥½ï¼Œæˆ‘å«èœ˜è››ä¾ ã€‚æˆ‘çš„å¥½æœ‹å‹åŒ…æ‹¬é’¢é“ä¾ ã€ç¾å›½é˜Ÿé•¿å’Œç»¿å·¨äººã€‚\nAI<span class="punctuation">:</span> ä½ å¥½ï¼Œèœ˜è››ä¾ ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚ä½ å’Œé’¢é“ä¾ ã€ç¾å›½é˜Ÿé•¿ä»¥åŠç»¿å·¨äººéƒ½æ˜¯è¶…çº§è‹±é›„ï¼ŒçœŸæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å›¢é˜Ÿï¼ä½ ä»¬æœ€è¿‘æœ‰ä»€ä¹ˆå†’é™©å—ï¼Ÿ\nHuman<span class="punctuation">:</span> æˆ‘ä½åœ¨çº½çº¦ã€‚\nAI<span class="punctuation">:</span> çº½çº¦æ˜¯ä¸€ä¸ªå……æ»¡æ´»åŠ›çš„åŸå¸‚ï¼Œé€‚åˆè¶…çº§è‹±é›„ä»¬æ´»åŠ¨ï¼ä½ åœ¨çº½çº¦çš„ç”Ÿæ´»æ€ä¹ˆæ ·ï¼Ÿæœ‰æ²¡æœ‰é‡åˆ°ä»€ä¹ˆæœ‰è¶£çš„äº‹æƒ…æˆ–è€…æŒ‘æˆ˜ï¼Ÿ\nHuman<span class="punctuation">:</span> æˆ‘ä½¿ç”¨çš„è£…å¤‡æ˜¯ç”±æ–¯å¡”å…‹å·¥ä¸šæä¾›çš„ã€‚\nAI<span class="punctuation">:</span> æ–¯å¡”å…‹å·¥ä¸šçš„è£…å¤‡çœŸæ˜¯å¤ªæ£’äº†ï¼é’¢é“ä¾ çš„æŠ€æœ¯æ€»æ˜¯è®©äººæƒŠå¹ã€‚ä½ æœ€å–œæ¬¢ä½¿ç”¨å“ªä¸€ä»¶è£…å¤‡ï¼Ÿå®ƒåœ¨ä½ çš„å†’é™©ä¸­å¸®åŠ©äº†ä½ å“ªäº›æ–¹é¢ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;entities&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;èœ˜è››ä¾ &#x27;<span class="punctuation">:</span> &#x27;èœ˜è››ä¾ çš„å¥½æœ‹å‹åŒ…æ‹¬é’¢é“ä¾ ã€ç¾å›½é˜Ÿé•¿å’Œç»¿å·¨äººã€‚&#x27;<span class="punctuation">,</span> &#x27;çº½çº¦&#x27;<span class="punctuation">:</span> &#x27;èœ˜è››ä¾ ä½åœ¨çº½çº¦ã€‚&#x27;<span class="punctuation">,</span> &#x27;é’¢é“ä¾ &#x27;<span class="punctuation">:</span> &#x27;é’¢é“ä¾ æ˜¯èœ˜è››ä¾ çš„å¥½æœ‹å‹ä¹‹ä¸€ã€‚&#x27;<span class="punctuation">,</span> &#x27;ç¾å›½é˜Ÿé•¿&#x27;<span class="punctuation">:</span> &#x27;ç¾å›½é˜Ÿé•¿æ˜¯èœ˜è››ä¾ çš„å¥½æœ‹å‹ä¹‹ä¸€ã€‚&#x27;<span class="punctuation">,</span> &#x27;ç»¿å·¨äºº&#x27;<span class="punctuation">:</span> &#x27;ç»¿å·¨äººæ˜¯èœ˜è››ä¾ çš„å¥½æœ‹å‹ä¹‹ä¸€ã€‚&#x27;<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;text&#x27;<span class="punctuation">:</span> &#x27;èœ˜è››ä¾ ä½åœ¨çº½çº¦ã€‚ä»–çš„å¥½æœ‹å‹åŒ…æ‹¬é’¢é“ä¾ ã€ç¾å›½é˜Ÿé•¿å’Œç»¿å·¨äººã€‚è¿™äº›è¶…çº§è‹±é›„ä»¬å¸¸å¸¸ä¸€èµ·åˆä½œï¼Œé¢å¯¹å„ç§æŒ‘æˆ˜å’Œæ•Œäººã€‚ä½ å¯¹ä»–ä»¬çš„å†’é™©æœ‰ä»€ä¹ˆç‰¹åˆ«çš„è®°å¿†å—ï¼Ÿ&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ConversationKGMemoryçš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰"><a href="#ConversationKGMemoryçš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰" class="headerlink" title="ConversationKGMemoryçš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰"></a>ConversationKGMemoryçš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰</h2><p>ConversationKGMemoryæ˜¯ä¸€ç§åŸºäº<strong>çŸ¥è¯†å›¾è°±ï¼ˆKnowledge Graphï¼‰</strong> çš„å¯¹è¯è®°å¿†æ¨¡å—ï¼Œå®ƒæ¯” ConversationEntityMemory æ›´è¿›ä¸€æ­¥ï¼Œä¸ä»…èƒ½è¯†åˆ«å’Œå­˜å‚¨å®ä½“ï¼Œè¿˜èƒ½æ•æ‰å®ä½“ä¹‹é—´çš„å¤æ‚å…³ç³»ï¼Œå½¢æˆ ç»“æ„åŒ–çš„çŸ¥è¯†ç½‘ç»œã€‚</p><p>ç‰¹ç‚¹ï¼š </p><ul><li><strong>çŸ¥è¯†å›¾è°±ç»“æ„</strong> å°†å¯¹è¯å†…å®¹è½¬åŒ–ä¸º <strong>(å¤´å®ä½“, å…³ç³», å°¾å®ä½“)</strong> çš„ä¸‰å…ƒç»„å½¢å¼</li><li><strong>åŠ¨æ€å…³ç³»æ¨ç†</strong></li></ul><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install networkx</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationKGMemory  </span><br><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰LLM  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>, temperature=<span class="number">0</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ConversationKGMemoryå¯¹è±¡  </span></span><br><span class="line">memory = ConversationKGMemory(llm=llm)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.ä¿å­˜ä¼šè¯  </span></span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å‘å±±å§†é—®å¥½&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;å±±å§†æ˜¯è°&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å±±å§†æ˜¯æˆ‘çš„æœ‹å‹&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;å¥½çš„&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.æŸ¥è¯¢ä¼šè¯  </span></span><br><span class="line">memory.load_memory_variables(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å±±å§†æ˜¯è°&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;On å±±å§†<span class="punctuation">:</span> å±±å§† æ˜¯ æˆ‘çš„æœ‹å‹.&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memory.get_knowledge_triplets(<span class="string">&quot;å¥¹æœ€å–œæ¬¢çš„é¢œè‰²æ˜¯çº¢è‰²&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span>KnowledgeTriple(subject=&#x27;å±±å§†&#x27;<span class="punctuation">,</span> predicate=&#x27;æ˜¯&#x27;<span class="punctuation">,</span> object_=&#x27;æˆ‘çš„æœ‹å‹&#x27;)<span class="punctuation">,</span></span><br><span class="line"> KnowledgeTriple(subject=&#x27;å±±å§†&#x27;<span class="punctuation">,</span> predicate=&#x27;æœ€å–œæ¬¢çš„é¢œè‰²æ˜¯&#x27;<span class="punctuation">,</span> object_=&#x27;çº¢è‰²&#x27;)<span class="punctuation">]</span></span><br></pre></td></tr></table></figure><h2 id="VectorStoreRetrieverMemory-äº†è§£"><a href="#VectorStoreRetrieverMemory-äº†è§£" class="headerlink" title="VectorStoreRetrieverMemory(äº†è§£)"></a>VectorStoreRetrieverMemory(äº†è§£)</h2><p>VectorStoreRetrieverMemoryæ˜¯ä¸€ç§åŸºäº <strong>å‘é‡æ£€ç´¢</strong>çš„å…ˆè¿›è®°å¿†æœºåˆ¶ï¼Œå®ƒå°†å¯¹è¯å†å²å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ ä¸­ï¼Œé€šè¿‡ <strong>è¯­ä¹‰ç›¸ä¼¼åº¦æ£€ç´¢</strong>ç›¸å…³ä¿¡æ¯ï¼Œè€Œéä¼ ç»Ÿçš„çº¿æ€§è®°å¿†æ–¹å¼ã€‚æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œå°±ä¼šæŸ¥æ‰¾ä¸è¯¥è®°å¿†å…³è”æœ€ é«˜çš„kä¸ªæ–‡æ¡£ã€‚</p><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šè¿™ç§è®°å¿†ç‰¹åˆ«é€‚åˆéœ€è¦é•¿æœŸè®°å¿†å’Œè¯­ä¹‰ç†è§£çš„å¤æ‚å¯¹è¯ç³»ç»Ÿã€‚</p><p>åŸç†ï¼š</p><p><img src="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/file-20251013111437892.png"></p><p>ä¸¾ä¾‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> VectorStoreRetrieverMemory  </span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">from</span> langchain.memory <span class="keyword">import</span> ConversationBufferMemory  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ConversationBufferMemoryå¯¹è±¡  </span></span><br><span class="line">memory = ConversationBufferMemory()  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æˆ‘æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯æŠ«è¨&quot;</span>&#125;, &#123;<span class="string">&quot;output&quot;</span>: <span class="string">&quot;å¾ˆé«˜å…´çŸ¥é“&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;Human&quot;</span>: <span class="string">&quot;æˆ‘å–œæ¬¢çš„è¿åŠ¨æ˜¯è·‘æ­¥&quot;</span>&#125;, &#123;<span class="string">&quot;AI&quot;</span>: <span class="string">&quot;å¥½çš„,æˆ‘çŸ¥é“äº†&quot;</span>&#125;)  </span><br><span class="line">memory.save_context(&#123;<span class="string">&quot;Human&quot;</span>: <span class="string">&quot;æˆ‘æœ€å–œæ¬¢çš„è¿åŠ¨æ˜¯è¶³çƒ&quot;</span>&#125;, &#123;<span class="string">&quot;AI&quot;</span>: <span class="string">&quot;å¥½çš„,æˆ‘çŸ¥é“äº†&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰å‘é‡åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embeddings_model = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;text-embedding-ada-002&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆå§‹åŒ–å‘é‡æ•°æ®åº“  </span></span><br><span class="line">vectorstore = FAISS.from_texts(memory.buffer.split(<span class="string">&quot;\n&quot;</span>), embeddings_model)  <span class="comment"># ç©ºåˆå§‹åŒ–  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®šä¹‰æ£€ç´¢å¯¹è±¡  </span></span><br><span class="line">retriever = vectorstore.as_retriever(search_kwargs=<span class="built_in">dict</span>(k=<span class="number">1</span>))  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.åˆå§‹åŒ–VectorStoreRetrieverMemory  </span></span><br><span class="line">memory = VectorStoreRetrieverMemory(retriever=retriever)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(memory.load_memory_variables(&#123;<span class="string">&quot;prompt&quot;</span>: <span class="string">&quot;æˆ‘æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯&quot;</span>&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;history&#x27;<span class="punctuation">:</span> &#x27;Human<span class="punctuation">:</span> æˆ‘æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯æŠ«è¨&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChainä½¿ç”¨ä¹‹Tools</title>
      <link href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/"/>
      <url>/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChainä½¿ç”¨ä¹‹Model I/O</title>
      <link href="/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/"/>
      <url>/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="Model-I-Oä»‹ç»"><a href="#Model-I-Oä»‹ç»" class="headerlink" title="Model I&#x2F;Oä»‹ç»"></a>Model I&#x2F;Oä»‹ç»</h1><p>Model I&#x2F;O æ¨¡å—æ˜¯ä¸è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è¿›è¡Œäº¤äº’çš„ <strong>æ ¸å¿ƒç»„ä»¶</strong>ï¼Œåœ¨æ•´ä¸ªæ¡†æ¶ä¸­æœ‰ç€å¾ˆé‡è¦çš„åœ°ä½ã€‚<br>æ‰€è°“çš„Model I&#x2F;Oï¼ŒåŒ…æ‹¬è¾“å…¥æç¤º(Format)ã€è°ƒç”¨æ¨¡å‹(Predict)ã€è¾“å‡ºè§£æ(Parse)ã€‚åˆ†åˆ«å¯¹åº”ç€<code>Prompt Template</code> ï¼Œ <code>Model</code> å’Œ <code>Output Parser</code></p><p>&#x3D;&#x3D;ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¾“â¼Šã€æ¨¡å‹å¤„ç†ã€è¾“å‡ºè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚&#x3D;&#x3D;</p><p><img src="/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/file-20250929143233797.png" alt="file-20250929143233797.png"></p><h1 id="Model-I-Oä¹‹è°ƒç”¨æ¨¡å‹1"><a href="#Model-I-Oä¹‹è°ƒç”¨æ¨¡å‹1" class="headerlink" title="Model I&#x2F;Oä¹‹è°ƒç”¨æ¨¡å‹1"></a>Model I&#x2F;Oä¹‹è°ƒç”¨æ¨¡å‹1</h1><h2 id="ç±»å‹1ï¼šLLMs-éå¯¹è¯æ¨¡å‹"><a href="#ç±»å‹1ï¼šLLMs-éå¯¹è¯æ¨¡å‹" class="headerlink" title="ç±»å‹1ï¼šLLMs(éå¯¹è¯æ¨¡å‹)"></a>ç±»å‹1ï¼šLLMs(éå¯¹è¯æ¨¡å‹)</h2><p>LLMsï¼Œä¹Ÿå«Text Modelã€éå¯¹è¯æ¨¡å‹ï¼Œæ˜¯è®¸å¤šè¯­è¨€æ¨¡å‹åº”ç”¨ç¨‹åºçš„æ”¯æŸ±ã€‚ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š </p><ul><li><strong>è¾“å…¥</strong>ï¼šæ¥å— <strong>æ–‡æœ¬å­—ç¬¦ä¸²æˆ–</strong> <strong>PromptValue</strong> å¯¹è±¡ </li><li><strong>è¾“å‡º</strong>ï¼šæ€»æ˜¯è¿”å› <strong>æ–‡æœ¬å­—ç¬¦ä¸²</strong></li></ul><p><img src="/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/file-20250929143912905.png" alt="500"></p><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä»…éœ€å•æ¬¡æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ï¼ˆå¦‚æ‘˜è¦ç”Ÿæˆã€ç¿»è¯‘ã€ä»£ç ç”Ÿæˆã€å•æ¬¡é—®ç­”ï¼‰æˆ–å¯¹æ¥ä¸æ”¯æŒæ¶ˆæ¯ ç»“æ„çš„æ—§æ¨¡å‹ï¼ˆå¦‚éƒ¨åˆ†æœ¬åœ°éƒ¨ç½²æ¨¡å‹ï¼‰ï¼ˆ <strong>è¨€å¤–ä¹‹æ„ï¼Œä¼˜å…ˆæ¨èChatModel</strong> ï¼‰<br><strong>ä¸æ”¯æŒå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡</strong>ã€‚æ¯æ¬¡è°ƒç”¨ç‹¬ç«‹å¤„ç†è¾“å…¥ï¼Œæ— æ³•è‡ªåŠ¨å…³è”å†å²å¯¹è¯ï¼ˆéœ€æ‰‹åŠ¨æ‹¼æ¥å†å²æ–‡ æœ¬ï¼‰ã€‚<br><strong>å±€é™æ€§</strong>ï¼šæ— æ³•å¤„ç†è§’è‰²åˆ†å·¥æˆ–å¤æ‚å¯¹è¯é€»è¾‘ã€‚</p><p>.envæ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">SILICONFLOW_API_KEY=&#x27;sk-spyqlkfbgpdeijbbauaaawhgjexgwxarXXXXXXXXXXXXXXX&#x27;</span>  </span><br><span class="line"><span class="string">BASE_URL=&#x27;https://api.siliconflow.cn/v1&#x27;</span>  </span><br><span class="line"><span class="string">OPENAI_MODEL_NAME=&#x27;deepseek-ai/DeepSeek-V3&#x27;</span>  </span><br><span class="line"><span class="string">OPENAI_EMBEDDING_MODEL_NAME=&#x27;Qwen/Qwen3-Embedding-0.6B&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAI  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">###########æ ¸å¿ƒä»£ç ############  </span></span><br><span class="line">llm = OpenAI(  </span><br><span class="line">    model=os.getenv(<span class="string">&quot;OPENAI_MODEL_NAME&quot;</span>),  </span><br><span class="line">)  </span><br><span class="line"><span class="built_in">str</span> = llm.invoke(<span class="string">&quot;å†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—&quot;</span>)  <span class="comment"># ç›´æ¥è¾“å…¥å­—ç¬¦ä¸²  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">str</span>))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">æ˜¥â»›æ‹‚è¿‡â¼¤åœ° </span><br><span class="line">ä¸‡ç‰©å¤è‹æ¬£æ¬£å‘è£ </span><br><span class="line">èŠ±å¼€æ»¡â¼­â¾• </span><br><span class="line">â»¦â¼‰å•å•¾æ­Œå£°é£˜ </span><br><span class="line">æ˜¥â¾¬æ»‹æ¶¦â½¥é‡ </span><br><span class="line">å†œå¤«æ¬¢å‘¼æ”¶è·ä¸° </span><br><span class="line">æ˜¥â½‡æš–é˜³æ¸©æŸ” </span><br><span class="line">â¼ˆä»¬â¼¼æƒ…ä¹Ÿéšä¹‹èˆ’ </span><br><span class="line">æ˜¥å¤©æ¥äº† </span><br><span class="line">å¸¦æ¥æ–°çš„å¼€å§‹ </span><br><span class="line">å¸¦èµ°å†¬â½‡çš„å¯’å†· </span><br><span class="line">å¸¦æ¥â½£æœºä¸å¸Œæœ› </span><br><span class="line">æ˜¥å¤©å•Šï¼Œç¾ä¸½çš„å­£èŠ‚ </span><br><span class="line">è®©æˆ‘ä»¬â¼€èµ·æ¬¢åº† </span><br><span class="line">è¿æ¥æ˜¥å¤©çš„åˆ°æ¥ </span><br><span class="line">è®©å¿«ä¹æ°¸è¿œé©»ç•™â¼¼ä¸­ã€‚</span><br></pre></td></tr></table></figure><h2 id="ç±»å‹2ï¼šChat-Models-å¯¹è¯æ¨¡å‹"><a href="#ç±»å‹2ï¼šChat-Models-å¯¹è¯æ¨¡å‹" class="headerlink" title="ç±»å‹2ï¼šChat Models(å¯¹è¯æ¨¡å‹)"></a>ç±»å‹2ï¼šChat Models(å¯¹è¯æ¨¡å‹)</h2><p>ChatModelsï¼Œä¹Ÿå«èŠå¤©æ¨¡å‹ã€å¯¹è¯æ¨¡å‹ï¼Œåº•å±‚ä½¿ç”¨LLMsã€‚<br><strong>å¤§è¯­è¨€æ¨¡å‹è°ƒç”¨ï¼Œä»¥ ChatModel ä¸ºä¸»ï¼</strong><br>ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li><strong>è¾“å…¥</strong>ï¼šæ¥æ”¶æ¶ˆæ¯åˆ—è¡¨ <strong>List[BaseMessage]</strong> æˆ– PromptValue ï¼Œæ¯æ¡æ¶ˆæ¯éœ€æŒ‡å®šè§’è‰²ï¼ˆå¦‚ SystemMessageã€HumanMessageã€AIMessageï¼‰ </li><li><strong>è¾“å‡º</strong>ï¼šæ€»æ˜¯è¿”å›å¸¦è§’è‰²çš„ <strong>æ¶ˆæ¯å¯¹è±¡</strong>ï¼ˆ <strong>BaseMessage å­ç±»</strong>ï¼‰ï¼Œé€šå¸¸æ˜¯ <strong>AIMessage</strong></li></ul><p><img src="/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/file-20250929144543733.png" alt="500"></p><ul><li><strong>åŸç”Ÿæ”¯æŒå¤šè½®å¯¹è¯</strong>ã€‚é€šè¿‡æ¶ˆæ¯åˆ—è¡¨ç»´æŠ¤ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼š[SystemMessage, HumanMessage, AIMessage, â€¦]ï¼‰ï¼Œæ¨¡å‹å¯åŸºäºå®Œæ•´å¯¹è¯å†å²ç”Ÿæˆå›å¤ã€‚ </li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¯¹è¯ç³»ç»Ÿï¼ˆå¦‚å®¢æœæœºå™¨äººã€é•¿æœŸäº¤äº’çš„AIåŠ©æ‰‹ï¼‰</li></ul><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">########æ ¸å¿ƒä»£ç ############  </span></span><br><span class="line">chat_model = ChatOpenAI(model=os.getenv(<span class="string">&quot;OPENAI_MODEL_NAME&quot;</span>))  </span><br><span class="line">  </span><br><span class="line">messages = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ˜ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>)  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¾“å…¥ï¼šlist[basemessage]  </span></span><br><span class="line"><span class="comment">#è¾“å‡ºï¼šAIMessage  </span></span><br><span class="line">response = chat_model.invoke(messages)  <span class="comment"># è¾“å…¥æ¶ˆæ¯åˆ—è¡¨  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment"># &lt;class &#x27;langchain_core.messages.ai.AIMessage&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;langchain_core.messages.ai.AIMessage&#x27;</span>&gt;</span><br><span class="line">ä½ å¥½å°æ˜ï¼ğŸ˜Šæˆ‘æ˜¯å°æ™ºï¼Œä¹Ÿè¶…çº§é«˜å…´è®¤è¯†ä½ ï¼ä»Šå¤©æœ‰ä»€ä¹ˆæƒ³èŠçš„è¯é¢˜ï¼Œæˆ–è€…éœ€è¦å¸®å¿™çš„åœ°æ–¹å—ï¼Ÿæ— è®ºæ˜¯è§£é—·è¿˜æ˜¯è§£å†³é—®é¢˜ï¼Œæˆ‘éƒ½åœ¨è¿™é‡Œå“¦ï½</span><br></pre></td></tr></table></figure><h2 id="ç±»å‹3ï¼šEmbedding-Model-åµŒå…¥æ¨¡å‹"><a href="#ç±»å‹3ï¼šEmbedding-Model-åµŒå…¥æ¨¡å‹" class="headerlink" title="ç±»å‹3ï¼šEmbedding Model(åµŒå…¥æ¨¡å‹)"></a>ç±»å‹3ï¼š<a href="./LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval#%E7%8E%AF%E8%8A%824%EF%BC%9AEmbed%EF%BC%88%E5%B5%8C%E5%85%A5%EF%BC%89">Embedding Model(åµŒå…¥æ¨¡å‹)</a></h2><p>Embedding Modelï¼šä¹Ÿå«æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹å°† æ–‡æœ¬ä½œä¸ºè¾“å…¥å¹¶è¿”å› Embeddingã€‚</p><p><img src="/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/file-20250929145213254.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#############  </span></span><br><span class="line">embeddings_model = OpenAIEmbeddings(  </span><br><span class="line">    model=os.getenv(<span class="string">&quot;OPENAI_EMBEDDING_MODEL_NAME&quot;</span>),  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">res1 = embeddings_model.embed_query(<span class="string">&#x27;æˆ‘æ˜¯æ–‡æ¡£ä¸­çš„æ•°æ®&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(res1)  </span><br><span class="line"><span class="comment"># æ‰“å°ç»“æœï¼š[-0.004306625574827194, 0.003083756659179926, -0.013916781172156334, ...., ]</span></span><br></pre></td></tr></table></figure><h2 id="è§’åº¦2å‡ºå‘ï¼šå‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹"><a href="#è§’åº¦2å‡ºå‘ï¼šå‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹" class="headerlink" title="è§’åº¦2å‡ºå‘ï¼šå‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹"></a>è§’åº¦2å‡ºå‘ï¼šå‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹</h2><p>è¿™é‡Œä»¥ LangChain çš„APIä¸ºå‡†ï¼Œä½¿ç”¨å¯¹è¯æ¨¡å‹ï¼Œè¿›è¡Œæµ‹è¯•ã€‚</p><h3 id="æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°"><a href="#æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°" class="headerlink" title="æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°"></a>æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°</h3><p>ç›¸å…³æ–¹æ³•åŠå±æ€§ï¼š</p><ul><li><strong>OpenAI(â€¦) &#x2F; ChatOpenAI(â€¦)</strong> ï¼šåˆ›å»ºä¸€ä¸ªæ¨¡å‹å¯¹è±¡ï¼ˆéå¯¹è¯ç±»&#x2F;å¯¹è¯ç±»ï¼‰ </li><li><strong>model.invoke(xxx)</strong> ï¼šæ‰§è¡Œè°ƒç”¨ï¼Œå°†ç”¨æˆ·è¾“å…¥å‘é€ç»™æ¨¡å‹</li><li><strong>.content</strong> ï¼šæå–æ¨¡å‹è¿”å›çš„å®é™…æ–‡æœ¬å†…å®¹<br>æ¨¡å‹è°ƒç”¨å‡½æ•°ä½¿ç”¨æ—¶éœ€åˆå§‹åŒ–æ¨¡å‹ï¼Œå¹¶è®¾ç½®å¿…è¦çš„å‚æ•°ã€‚</li></ul><ol><li><p>å¿…é¡»è®¾ç½®çš„å‚æ•°ï¼š</p><ul><li><strong>base_url</strong> ï¼šå¤§æ¨¡å‹ API æœåŠ¡çš„æ ¹åœ°å€ </li><li><strong>api_key</strong> ï¼šç”¨äºèº«ä»½éªŒè¯çš„å¯†é’¥ï¼Œç”±å¤§æ¨¡å‹æœåŠ¡å•†ï¼ˆå¦‚ OpenAIã€ç™¾åº¦åƒå¸†ï¼‰æä¾› </li><li><strong>model&#x2F;model_name</strong> ï¼šæŒ‡å®šè¦è°ƒç”¨çš„å…·ä½“å¤§æ¨¡å‹åç§°ï¼ˆå¦‚ gpt-4-turbo ã€ ERNIE-3.5-8K ç­‰ï¼‰</li></ul></li><li><p>å…¶å®ƒå‚æ•°ï¼š</p><ul><li><p><strong>temperature</strong> ï¼šæ¸©åº¦ï¼Œæ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„â€œéšæœºæ€§â€ï¼Œå–å€¼èŒƒå›´ä¸º0ï½1ã€‚ </p><ul><li>å€¼è¶Šä½â†’ è¾“å‡ºè¶Šç¡®å®šã€ä¿å®ˆï¼ˆé€‚åˆäº‹å®å›ç­”ï¼‰ </li><li>å€¼è¶Šé«˜â†’ è¾“å‡ºè¶Šå¤šæ ·ã€æœ‰åˆ›æ„ï¼ˆé€‚åˆåˆ›æ„å†™ä½œï¼‰</li></ul><p>  é€šå¸¸ï¼Œæ ¹æ®éœ€è¦è®¾ç½®å¦‚ä¸‹ï¼š</p><ul><li>ç²¾ç¡®æ¨¡å¼ï¼ˆ0.5æˆ–æ›´ä½ï¼‰ï¼šç”Ÿæˆçš„æ–‡æœ¬æ›´åŠ å®‰å…¨å¯é ï¼Œä½†å¯èƒ½ç¼ºä¹åˆ›æ„å’Œå¤šæ ·æ€§ã€‚</li><li>å¹³è¡¡æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯0.8ï¼‰ï¼šç”Ÿæˆçš„æ–‡æœ¬é€šå¸¸æ—¢æœ‰ä¸€å®šçš„å¤šæ ·æ€§ï¼Œåˆèƒ½ä¿æŒè¾ƒå¥½çš„è¿è´¯æ€§å’Œå‡†ç¡® æ€§ã€‚ </li><li>åˆ›æ„æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯1ï¼‰ï¼šç”Ÿæˆçš„æ–‡æœ¬æ›´æœ‰åˆ›æ„ï¼Œä½†ä¹Ÿæ›´å®¹æ˜“å‡ºç°è¯­æ³•é”™è¯¯æˆ–ä¸åˆé€»è¾‘çš„å†…å®¹ã€‚</li></ul></li><li><p><strong>max_tokens</strong> ï¼šé™åˆ¶ç”Ÿæˆæ–‡æœ¬çš„æœ€å¤§é•¿åº¦ï¼Œé˜²æ­¢è¾“å‡ºè¿‡é•¿ã€‚ </p><p>  <strong>Tokenæ˜¯ä»€ä¹ˆ</strong>ï¼Ÿ<br>  <strong>åŸºæœ¬å•ä½</strong>: å¤§æ¨¡å‹å¤„ç†æ–‡æœ¬çš„æœ€å°å•ä½æ˜¯tokenï¼ˆç›¸å½“äºè‡ªç„¶è¯­è¨€ä¸­çš„è¯æˆ–å­—ï¼‰ï¼Œè¾“å‡ºæ—¶é€ä¸ªtoken ä¾æ¬¡ç”Ÿæˆã€‚<br>  <strong>æ”¶è´¹ä¾æ®</strong>ï¼šå¤§è¯­è¨€æ¨¡å‹(LLM)é€šå¸¸ä¹Ÿæ˜¯ä»¥tokençš„æ•°é‡ä½œä¸ºå…¶è®¡é‡(æˆ–æ”¶è´¹)çš„ä¾æ®ã€‚ </p><ul><li>1ä¸ªTokenâ‰ˆ1-1.8ä¸ªæ±‰å­—ï¼Œ1ä¸ªTokenâ‰ˆ3-4ä¸ªè‹±æ–‡å­—æ¯ </li><li>Tokenä¸å­—ç¬¦è½¬åŒ–çš„å¯è§†åŒ–å·¥å…·ï¼š <ul><li>OpenAIæä¾›ï¼š<a href="https://platform.openai.com/tokenizer">https://platform.openai.com/tokenizer</a> </li><li>ç™¾åº¦æ™ºèƒ½äº‘æä¾›ï¼š<a href="https://console.bce.baidu.com/support/#/tokenizer">https://console.bce.baidu.com/support/#/tokenizer</a></li></ul></li></ul><p>  <strong>max_tokens</strong>è®¾ç½®å»ºè®®ï¼š </p><ul><li>å®¢æœçŸ­å›å¤ï¼š128-256ã€‚æ¯”å¦‚ï¼šç”Ÿæˆä¸€å¥å®¢æœå›å¤ï¼ˆå¦‚â€œè®¢å•å·²å‘è´§ï¼Œé¢„è®¡æ˜å¤©é€è¾¾â€ï¼‰ </li><li>å¸¸è§„å¯¹è¯ã€å¤šè½®å¯¹è¯ï¼š512-1024 </li><li>é•¿å†…å®¹ç”Ÿæˆï¼š1024-4096ã€‚æ¯”å¦‚ï¼šç”Ÿæˆä¸€ç¯‡äº§å“è¯´æ˜ä¹¦ï¼ˆåŒ…å«åŠŸèƒ½ã€ä½¿ç”¨æ–¹æ³•ç­‰ç»“æ„ï¼‰</li></ul></li></ul></li></ol><h3 id="æ–¹å¼1ï¼šç¡¬ç¼–ç "><a href="#æ–¹å¼1ï¼šç¡¬ç¼–ç " class="headerlink" title="æ–¹å¼1ï¼šç¡¬ç¼–ç "></a>æ–¹å¼1ï¼šç¡¬ç¼–ç </h3><p>ç›´æ¥å°† API Key å’Œæ¨¡å‹å‚æ•°å†™å…¥ä»£ç ï¼Œä»…é€‚ç”¨äºä¸´æ—¶æµ‹è¯•ï¼Œå­˜åœ¨å¯†é’¥æ³„éœ²é£é™©ï¼Œåœ¨ å…·ä½“è´¹ç”¨è‡ª ç”Ÿäº§ç¯å¢ƒä¸æ¨èã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¡¬ç¼–ç  API Key å’Œæ¨¡å‹å‚æ•° </span></span><br><span class="line">llm = ChatOpenAI( </span><br><span class="line">api_key= <span class="string">&quot;sk-xxxxxxxxx&quot;</span> , <span class="comment"># æ˜æ–‡æš´éœ²å¯†é’¥ </span></span><br><span class="line">base_url= <span class="string">&quot;https://api.openai-proxy.org/v1&quot;</span> , </span><br><span class="line">model= <span class="string">&quot;gpt-3.5-turbo&quot;</span> , ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ç¤ºä¾‹ </span></span><br><span class="line">response = llm.invoke( <span class="string">&quot;è§£é‡Šç¥ç»ç½‘ç»œåŸç†&quot;</span> ) </span><br><span class="line"><span class="built_in">print</span> (response.content)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¥ç»â½¹ç»œæ˜¯â¼€ç§æ¨¡æ‹Ÿâ¼ˆè„‘ç¥ç»å…ƒä¹‹é—´ä¿¡æ¯ä¼ é€’çš„æ•°å­¦æ¨¡å‹ã€‚ç¥ç»â½¹ç»œç”±å¤šå±‚ç¥ç»å…ƒç»„æˆï¼Œæ¯ä¸ªç¥ç» å…ƒæ¥æ”¶æ¥â¾ƒä¸Šâ¼€å±‚ç¥ç»å…ƒçš„è¾“â¼Šä¿¡å·ï¼Œå¹¶é€šè¿‡æ¿€æ´»å‡½æ•°å°†è¾“â¼Šä¿¡å·è¿›â¾åŠ æƒæ±‚å’Œå¹¶è¾“å‡ºâ¼€ä¸ªç»“æœã€‚ åœ¨ç¥ç»â½¹ç»œä¸­ï¼Œæ•°æ®é€šè¿‡è¾“â¼Šå±‚ä¼ é€’åˆ°éšè—å±‚ï¼Œæœ€ç»ˆåˆ°è¾“å‡ºå±‚ã€‚åœ¨æ¯â¼€å±‚ä¸­ï¼Œç¥ç»å…ƒé€šè¿‡å­¦ä¹ ç®—æ³• ä¸æ–­è°ƒæ•´è¿æ¥æƒé‡ï¼Œä»¥ä½¿ç¥ç»â½¹ç»œèƒ½å¤Ÿå‡†ç¡®åœ°å¯¹è¾“â¼Šæ•°æ®è¿›â¾åˆ†ç±»æˆ–é¢„æµ‹ã€‚ ç¥ç»â½¹ç»œçš„è®­ç»ƒè¿‡ç¨‹æ˜¯é€šè¿‡åå‘ä¼ æ’­ç®—æ³•è¿›â¾çš„ã€‚è¯¥ç®—æ³•é€šè¿‡è®¡ç®—ç¥ç»â½¹ç»œè¾“å‡ºç»“æœä¸å®é™…ç»“æœä¹‹ é—´çš„è¯¯å·®ï¼Œç„¶åæ ¹æ®è¯¯å·®è°ƒæ•´ç¥ç»å…ƒä¹‹é—´çš„è¿æ¥æƒé‡ï¼Œä»¥æâ¾¼ç¥ç»â½¹ç»œçš„å‡†ç¡®æ€§ã€‚ æ€»çš„æ¥è¯´ï¼Œç¥ç»â½¹ç»œé€šè¿‡æ¨¡æ‹Ÿâ¼ˆè„‘ç¥ç»å…ƒä¹‹é—´çš„ä¿¡æ¯ä¼ é€’è¿‡ç¨‹ï¼Œåˆ©â½¤æ•°å­¦æ¨¡å‹æ¥å®ç°å¯¹å¤æ‚é—®é¢˜çš„ å­¦ä¹ å’Œé¢„æµ‹ã€‚ç¥ç»â½¹ç»œçš„åŸç†æ˜¯åŸºäºç¥ç»å…ƒä¹‹é—´çš„è¿æ¥æƒé‡è°ƒæ•´å’Œè¯¯å·®åå‘ä¼ æ’­çš„æœºåˆ¶ã€‚</span><br></pre></td></tr></table></figure><h3 id="æ–¹å¼2ï¼šé…ç½®ç¯å¢ƒå˜é‡"><a href="#æ–¹å¼2ï¼šé…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="æ–¹å¼2ï¼šé…ç½®ç¯å¢ƒå˜é‡"></a>æ–¹å¼2ï¼šé…ç½®ç¯å¢ƒå˜é‡</h3><p>é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥ï¼Œé¿å…ä»£ç æ˜æ–‡æš´éœ²ã€‚ </p><p>æ–¹å¼1ï¼šç»ˆç«¯è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> OPENAI_API_KEY= <span class="string">&quot;sk-xxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="comment"># Linux/Mac </span></span><br><span class="line"><span class="built_in">set</span> OPENAI_API_KEY= <span class="string">&quot;sk-xxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="comment"># Windows</span></span><br></pre></td></tr></table></figure><h3 id="æ–¹å¼3ï¼šä½¿ç”¨-envé…ç½®æ–‡ä»¶"><a href="#æ–¹å¼3ï¼šä½¿ç”¨-envé…ç½®æ–‡ä»¶" class="headerlink" title="æ–¹å¼3ï¼šä½¿ç”¨.envé…ç½®æ–‡ä»¶"></a>æ–¹å¼3ï¼šä½¿ç”¨.envé…ç½®æ–‡ä»¶</h3><p>ä½¿ç”¨ python-dotenv åŠ è½½æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒå¤šç¯å¢ƒç®¡ç†ï¼ˆå¼€å‘&#x2F;ç”Ÿäº§ï¼‰ã€‚</p><ol><li><p>å®‰è£…ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install python-dotenv </span><br><span class="line"><span class="comment">#æˆ–è€…</span></span><br><span class="line">conda install python-dotenv</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»º .env æ–‡ä»¶ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">OPENAI_API_KEY=</span> <span class="string">&quot;sk-xxxxxxxxx&quot;</span> <span class="comment"># éœ€å¡«å†™è‡ªå·±çš„API KEY </span></span><br><span class="line"><span class="string">OPENAI_BASE_URL=</span> <span class="string">&quot;https://api.openai-proxy.org/v1&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>ä¸¾ä¾‹<br>æ–¹å¼1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    <span class="comment">#å¿…é¡»è¦è®¾ç½®çš„3ä¸ªå‚æ•°  </span></span><br><span class="line">     <span class="comment">#å¿…é¡»è¦è®¾ç½®çš„3ä¸ªå‚æ•°  </span></span><br><span class="line">    model_name=os.getenv(<span class="string">&#x27;OPENAI_MODEL_NAME&#x27;</span>),   <span class="comment">#é»˜è®¤ä½¿ç”¨çš„æ˜¯gpt-3.5-turboæ¨¡å‹  </span></span><br><span class="line">    base_url=os.getenv(<span class="string">&#x27;BASE_URL&#x27;</span>),  </span><br><span class="line">    api_key=os.getenv(<span class="string">&#x27;SILICONFLOW_API_KEY&#x27;</span>),  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è°ƒç”¨æ¨¡å‹  </span></span><br><span class="line">response = chat_model.invoke(<span class="string">&quot;ä»€ä¹ˆæ˜¯langchain?&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æŸ¥çœ‹å“åº”çš„æ–‡æœ¬  </span></span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ä¸è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPT-3ã€GPT-4 ç­‰ï¼‰äº’åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—å·¥å…·å’Œç»„ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾æ„å»ºå¼ºå¤§çš„è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰åº”ç”¨ã€‚LangChain çš„åŠŸèƒ½åŒ…æ‹¬ï¼š\n\n1. **é“¾ï¼ˆChainsï¼‰**ï¼šå¯ä»¥å°†å¤šä¸ªæ“ä½œæ­¥éª¤é“¾æ¥åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚å°†ç”¨æˆ·è¾“å…¥ä¼ é€’ç»™è¯­è¨€æ¨¡å‹ï¼Œç„¶åå°†æ¨¡å‹çš„è¾“å‡ºä¼ é€’ç»™å…¶ä»–å¤„ç†æ­¥éª¤ã€‚\n\n2. **æ–‡æ¡£åŠ è½½å™¨ï¼ˆDocument Loadersï¼‰**ï¼šç”¨äºä»ä¸åŒæºï¼ˆå¦‚ PDFã€æ–‡æœ¬æ–‡ä»¶ã€ç½‘é¡µç­‰ï¼‰åŠ è½½å’Œå¤„ç†æ–‡æ¡£ï¼Œä½¿å…¶èƒ½è¢«è¯­è¨€æ¨¡å‹å¤„ç†ã€‚\n\n3. **å†…å­˜ï¼ˆMemoryï¼‰**ï¼šå…è®¸åº”ç”¨ç¨‹åºä¿æŒå¯¹è¯çš„ä¸Šä¸‹æ–‡ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿè®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œä»è€Œæä¾›æ›´è¿è´¯çš„äº¤äº’ã€‚\n\n4. **ä»£ç†ï¼ˆAgentsï¼‰**ï¼šæ ¹æ®éœ€æ±‚åŠ¨æ€é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·å’Œæ¨¡å‹è¿›è¡Œå¤„ç†ï¼Œæé«˜äº†ç³»ç»Ÿçš„çµæ´»æ€§å’Œè‡ªé€‚åº”èƒ½åŠ›ã€‚\n\n5. **å·¥å…·ï¼ˆToolsï¼‰**ï¼šæä¾›å„ç§å®ç”¨åŠŸèƒ½ï¼Œå¦‚ API è°ƒç”¨ã€æ•°æ®åº“æŸ¥è¯¢ç­‰ï¼Œå¢å¼ºäº†è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ã€‚\n\nLangChain çš„è®¾è®¡ç›®æ ‡æ˜¯é™ä½æ„å»ºå¤æ‚ NLP åº”ç”¨çš„é—¨æ§›ï¼Œä½¿å¾—æ— è®ºæ˜¯æ™®é€šå¼€å‘è€…è¿˜æ˜¯æ•°æ®ç§‘å­¦å®¶éƒ½èƒ½å¤Ÿå®ç°ä»–ä»¬çš„æƒ³æ³•ã€‚æ— è®ºæ˜¯å¼€å‘èŠå¤©æœºå™¨äººã€é—®ç­”ç³»ç»Ÿï¼Œè¿˜æ˜¯å…¶ä»–åŸºäºè¯­è¨€æ¨¡å‹çš„åº”ç”¨ï¼ŒLangChain éƒ½æä¾›äº†ä¸°å¯Œçš„æ”¯æŒã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 311, <span class="string">&#x27;prompt_tokens&#x27;</span>: 12, <span class="string">&#x27;total_tokens&#x27;</span>: 323, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7KtQzBvG5gwJX9h550F2dmb9W3uQ&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--3179f561-e4fe-420a-ad83-6b845b65600a-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 12, <span class="string">&#x27;output_tokens&#x27;</span>: 311, <span class="string">&#x27;total_tokens&#x27;</span>: 323, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ–¹å¼2ï¼šç»™oså†…éƒ¨çš„ç¯å¢ƒå˜é‡èµ‹å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    <span class="comment">#å¿…é¡»è¦è®¾ç½®çš„3ä¸ªå‚æ•°  </span></span><br><span class="line">    <span class="comment">#model_name=&quot;gpt-4o-mini&quot;,   #é»˜è®¤ä½¿ç”¨çš„æ˜¯gpt-3.5-turboæ¨¡å‹  </span></span><br><span class="line">    <span class="comment">#å½“æ²¡æœ‰æ˜¾å¼çš„å£°æ˜base_urlå’Œapi_keyçš„æ—¶å€™ï¼Œé»˜è®¤ä¼šä»ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è°ƒç”¨æ¨¡å‹  </span></span><br><span class="line">response = chat_model.invoke(<span class="string">&quot;ä»€ä¹ˆæ˜¯langchain?&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æŸ¥çœ‹å“åº”çš„æ–‡æœ¬  </span></span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;LangChainæ˜¯ä¸€ä¸ªåŸºäºåŒºå—é“¾æŠ€æœ¯çš„è¯­è¨€æœåŠ¡å¹³å°ï¼Œæ—¨åœ¨æä¾›å…¨çƒé€æ˜ã€å¿«é€Ÿå’Œå®‰å…¨çš„è¯­è¨€äº’è¯‘æœåŠ¡ã€‚ç”¨æˆ·å¯ä»¥åœ¨è¯¥å¹³å°ä¸Šå¯»æ‰¾ç¿»è¯‘äººå‘˜å¹¶è¿›è¡Œè¯­è¨€äº¤æµï¼ŒåŒæ—¶é€šè¿‡æ™ºèƒ½åˆçº¦æ–¹å¼æ¥ç¡®ä¿äº¤æ˜“çš„å®‰å…¨å’Œå¯é ã€‚LangChainæ—¨åœ¨æ¶ˆé™¤è¯­è¨€éšœç¢ï¼Œä¿ƒè¿›å…¨çƒäº¤æµå’Œåˆä½œã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 116, <span class="string">&#x27;prompt_tokens&#x27;</span>: 14, <span class="string">&#x27;total_tokens&#x27;</span>: 130, <span class="string">&#x27;completion_tokens_details&#x27;</span>: None, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: None&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-3.5-turbo-0125&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_0165350fbb&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7KxkXUF0pqZoe3fYnf1WwjXWs1yk&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--0d0d9ed6-8a15-4eaa-b40b-ce1671d5e9aa-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 14, <span class="string">&#x27;output_tokens&#x27;</span>: 116, <span class="string">&#x27;total_tokens&#x27;</span>: 130, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="å°ç»“ï¼šè·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼"><a href="#å°ç»“ï¼šè·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼" class="headerlink" title="å°ç»“ï¼šè·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼"></a>å°ç»“ï¼šè·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼</h3><p>åç»­çš„å„ç§æ¨¡å‹æµ‹è¯•ï¼Œéƒ½åŸºäºå¦‚ä¸‹çš„æ¨¡å‹å±•å¼€ï¼š<br><strong>éå¯¹è¯æ¨¡å‹</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os <span class="keyword">import</span> dotenv </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAI </span><br><span class="line">dotenv.load_dotenv() </span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY&quot;</span> ) </span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line">llm = OpenAI( </span><br><span class="line"><span class="comment">#éå¯¹è¯æ¨¡å‹ </span></span><br><span class="line"><span class="comment">#max_tokens=512, </span></span><br><span class="line"><span class="comment">#temperature=0.7, </span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>å¯¹è¯æ¨¡å‹</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os <span class="keyword">import</span> dotenv </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line">dotenv.load_dotenv() </span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY&quot;</span> ) </span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line">chat_model = ChatOpenAI( </span><br><span class="line"><span class="comment">#å¯¹è¯æ¨¡å‹ </span></span><br><span class="line">model= <span class="string">&quot;gpt-4o-mini&quot;</span> , </span><br><span class="line"><span class="comment">#max_tokens=512,</span></span><br><span class="line"><span class="comment">#temperature=0.7, </span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h1 id="Model-I-Oä¹‹è°ƒç”¨æ¨¡å‹2"><a href="#Model-I-Oä¹‹è°ƒç”¨æ¨¡å‹2" class="headerlink" title="Model I&#x2F;Oä¹‹è°ƒç”¨æ¨¡å‹2"></a>Model I&#x2F;Oä¹‹è°ƒç”¨æ¨¡å‹2</h1><h2 id="å…³äºå¯¹è¯æ¨¡å‹çš„Message-æ¶ˆæ¯"><a href="#å…³äºå¯¹è¯æ¨¡å‹çš„Message-æ¶ˆæ¯" class="headerlink" title="å…³äºå¯¹è¯æ¨¡å‹çš„Message(æ¶ˆæ¯)"></a>å…³äºå¯¹è¯æ¨¡å‹çš„Message(æ¶ˆæ¯)</h2><p>èŠå¤©æ¨¡å‹ï¼Œå‡ºäº†å°†å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>èŠå¤©æ¶ˆæ¯</code>ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å› <code>èŠå¤©æ¶ˆæ¯</code>ä½œä¸ºè¾“å‡ºã€‚</p><p>LangChainæœ‰ä¸€äº›å†…ç½®çš„æ¶ˆæ¯ç±»å‹ï¼š</p><ul><li>ğŸ”¥<strong>SystemMessage</strong> ï¼šè®¾å®šAIè¡Œä¸ºè§„åˆ™æˆ–èƒŒæ™¯ä¿¡æ¯ã€‚æ¯”å¦‚è®¾å®šAIçš„åˆå§‹çŠ¶æ€ã€è¡Œä¸ºæ¨¡å¼æˆ–å¯¹è¯çš„æ€» ä½“ç›®æ ‡ã€‚æ¯”å¦‚â€œä½œä¸ºä¸€ä¸ªä»£ç ä¸“å®¶â€ï¼Œæˆ–è€…â€œè¿”å›jsonæ ¼å¼â€ã€‚é€šå¸¸ä½œä¸ºè¾“å…¥æ¶ˆæ¯åºåˆ—ä¸­çš„ç¬¬ä¸€ä¸ª ä¼ é€’ã€‚</li><li>ğŸ”¥<strong>HumanMessage</strong> ï¼šè¡¨ç¤ºæ¥è‡ªç”¨æˆ·è¾“å…¥ã€‚æ¯”å¦‚â€œå®ç° ä¸€ä¸ªå¿«é€Ÿæ’åºæ–¹æ³•â€</li><li>ğŸ”¥<strong>AI Message</strong> ï¼šå­˜å‚¨AIå›å¤çš„å†…å®¹ã€‚è¿™å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨å·¥å…·çš„è¯·æ±‚</li><li><strong>ChatMessage</strong> ï¼šå¯ä»¥è‡ªå®šä¹‰è§’è‰²çš„é€šç”¨æ¶ˆæ¯ç±»å‹ </li><li><strong>FunctionMessage&#x2F;ToolMessage</strong> ï¼šå‡½æ•°è°ƒç”¨&#x2F;å·¥å…·æ¶ˆæ¯ï¼Œç”¨äºå‡½æ•°è°ƒç”¨ç»“æœçš„æ¶ˆæ¯ç±»å‹</li></ul><blockquote><p>[!notice]<br>æ³¨æ„ï¼š FunctionMessageå’ŒToolMessageåˆ†åˆ«æ˜¯åœ¨å‡½æ•°è°ƒâ½¤å’Œâ¼¯å…·è°ƒâ½¤åœºæ™¯ä¸‹æ‰ä¼šä½¿â½¤çš„ç‰¹æ®Šæ¶ˆæ¯ç±» å‹ï¼ŒHumanMessageã€AIMessageå’ŒSystemMessageæ‰æ˜¯æœ€å¸¸â½¤çš„æ¶ˆæ¯ç±»å‹ã€‚</p></blockquote><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">system_message = SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&quot;</span>)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [system_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(messages)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¤§æ¨¡å‹ï¼Œè°ƒç”¨æ¶ˆæ¯åˆ—è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;langchain_core.messages.ai.AIMessage&#x27;</span>&gt;</span><br><span class="line">åˆ¶å®šä¸€ä»½é«˜æ•ˆçš„è‹±è¯­å…­çº§ï¼ˆCET-6ï¼‰å­¦ä¹ è®¡åˆ’éœ€è¦ç»“åˆè€ƒè¯•é¢˜å‹ï¼ˆå¬åŠ›ã€é˜…è¯»ã€å†™ä½œã€ç¿»è¯‘ï¼‰å’Œä¸ªäººè–„å¼±é¡¹ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª**6-8å‘¨å†²åˆºè®¡åˆ’**çš„æ¨¡æ¿ï¼Œå¯æ ¹æ®è‡ªèº«æ—¶é—´çµæ´»è°ƒæ•´ï¼š</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **ä¸€ã€å¤¯å®åŸºç¡€ï¼ˆç¬¬1-2å‘¨ï¼‰**</span></span><br><span class="line">**ç›®æ ‡ï¼šç†Ÿæ‚‰é¢˜å‹ + æ ¸å¿ƒè¯æ±‡ + åŸºç¡€è®­ç»ƒ**</span><br><span class="line">1. **æ¯æ—¥ä»»åŠ¡ï¼š**</span><br><span class="line">   - **è¯æ±‡ï¼ˆ30åˆ†é’Ÿï¼‰**  </span><br><span class="line">     - èƒŒè¯µ30-50ä¸ªå…­çº§é«˜é¢‘è¯ï¼ˆæ¨èã€Šå…­çº§æ ¸å¿ƒè¯æ±‡ä¹±åºç‰ˆã€‹æˆ–APPå¦‚<span class="string">&quot;ä¸èƒŒå•è¯&quot;</span>ï¼‰ã€‚  </span><br><span class="line">     - é‡ç‚¹æŒæ¡è¯æ±‡çš„**æ­é…ç”¨æ³•**ï¼ˆå¦‚åŠ¨è¯çŸ­è¯­ã€å¸¸è§ä»‹è¯æ­é…ï¼‰ã€‚</span><br><span class="line">   - **å¬åŠ›ï¼ˆ20åˆ†é’Ÿï¼‰**  </span><br><span class="line">     - ç²¾å¬1ç¯‡çŸ­ç¯‡æ–°é—»/é•¿å¯¹è¯ï¼ˆVOAå¸¸é€Ÿæˆ–å…­çº§çœŸé¢˜ï¼‰ï¼Œå¬å†™å…³é”®å¥ã€‚</span><br><span class="line">   - **é˜…è¯»ï¼ˆ30åˆ†é’Ÿï¼‰**  </span><br><span class="line">     - ç²¾è¯»1ç¯‡å…­çº§çœŸé¢˜é€‰è¯å¡«ç©ºæˆ–åŒ¹é…é¢˜ï¼Œåˆ†æé•¿éš¾å¥ç»“æ„ã€‚</span><br><span class="line">2. **æ¯å‘¨ä»»åŠ¡ï¼š**  </span><br><span class="line">   - å®Œæˆ1å¥—çœŸé¢˜ï¼ˆä¸è®¡æ—¶ï¼‰ï¼Œæ ‡æ³¨é”™é¢˜ï¼Œåˆ†æé”™è¯¯åŸå› ï¼ˆå¦‚ï¼šè¯æ±‡ç›²åŒºã€é€»è¾‘åå·®ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **äºŒã€ä¸“é¡¹çªç ´ï¼ˆç¬¬3-5å‘¨ï¼‰**</span></span><br><span class="line">**ç›®æ ‡ï¼šåˆ†é¢˜å‹å¼ºåŒ–æŠ€å·§ + æé€Ÿ**</span><br><span class="line">1. **å¬åŠ›ï¼ˆæ¯æ—¥25åˆ†é’Ÿï¼‰ï¼š**</span><br><span class="line">   - **æŠ€å·§**ï¼šæ³¨æ„è½¬æŠ˜è¯ï¼ˆbut, howeverï¼‰ã€è§‚ç‚¹è¯ï¼ˆthink, believeï¼‰ã€æ•°å­—/æ—¶é—´ã€‚  </span><br><span class="line">   - **è®­ç»ƒ**ï¼šæ¯å¤©1ç¯‡è®²åº§/é•¿å¯¹è¯ï¼Œå½±å­è·Ÿè¯»æ³•æ¨¡ä»¿è¯­éŸ³è¯­è°ƒã€‚</span><br><span class="line">2. **é˜…è¯»ï¼ˆæ¯æ—¥40åˆ†é’Ÿï¼‰ï¼š**</span><br><span class="line">   - **é€‰è¯å¡«ç©º**ï¼šæ ¹æ®è¯æ€§ã€ä¸Šä¸‹æ–‡é€»è¾‘æ’é™¤é”™è¯¯é€‰é¡¹ã€‚  </span><br><span class="line">   - **é•¿ç¯‡é˜…è¯»**ï¼šå…ˆè¯»é¢˜å¹²åˆ’å…³é”®è¯ï¼Œé€Ÿè¯»æ–‡ç« å®šä½ã€‚  </span><br><span class="line">   - **ä»”ç»†é˜…è¯»**ï¼šé‡ç‚¹åˆ†æé¦–å°¾æ®µã€æ®µè½ä¸»æ—¨å¥ã€‚</span><br><span class="line">3. **å†™ä½œç¿»è¯‘ï¼ˆéš”æ—¥30åˆ†é’Ÿï¼‰ï¼š**</span><br><span class="line">   - **å†™ä½œ**ï¼šèƒŒè¯µ3-4ä¸ªä¸‡èƒ½æ¨¡æ¿ï¼ˆç°è±¡åˆ†æã€è§‚ç‚¹å¯¹æ¯”ç­‰ï¼‰ï¼Œæ¯å‘¨å†™1ç¯‡å¹¶æ‰¹æ”¹ï¼ˆå¯ç”¨Grammarlyï¼‰ã€‚  </span><br><span class="line">   - **ç¿»è¯‘**ï¼šæ¯æ—¥ç»ƒä¹ 1å¥**ä¸­å›½æ–‡åŒ–/ç»æµç±»**å¥å­ï¼ˆå‚è€ƒã€Šä¸­å›½æ–‡åŒ–æ¦‚è§ˆã€‹ï¼‰ï¼Œç§¯ç´¯å›ºå®šè¡¨è¾¾ï¼ˆå¦‚<span class="string">&quot;è¢«èª‰ä¸º&quot;</span>â†’be hailed asï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **ä¸‰ã€å†²åˆºæ¨¡æ‹Ÿï¼ˆç¬¬6-8å‘¨ï¼‰**</span></span><br><span class="line">**ç›®æ ‡ï¼šå…¨çœŸæ¨¡è€ƒ + æŸ¥æ¼è¡¥ç¼º**</span><br><span class="line">1. **æ¯å‘¨2å¥—çœŸé¢˜ï¼ˆä¸¥æ ¼è®¡æ—¶ï¼‰**ï¼š  </span><br><span class="line">   - æŒ‰è€ƒè¯•æ—¶é—´ï¼ˆ15:00-17:25ï¼‰æ¨¡æ‹Ÿï¼Œè®­ç»ƒæ—¶é—´åˆ†é…ï¼ˆå»ºè®®é˜…è¯»40åˆ†é’Ÿã€ç¿»è¯‘30åˆ†é’Ÿï¼‰ã€‚  </span><br><span class="line">   - é”™é¢˜å½’ç±»æ•´ç†ï¼ˆå¦‚<span class="string">&quot;å¬åŠ›ä¸»æ—¨é¢˜é”™è¯¯&quot;</span>ã€<span class="string">&quot;ç¿»è¯‘å¥å‹å•ä¸€&quot;</span>ï¼‰ã€‚</span><br><span class="line">2. **é‡ç‚¹å¼ºåŒ–ï¼š**  </span><br><span class="line">   - **è–„å¼±é¢˜å‹åŠ ç»ƒ**ï¼šä¾‹å¦‚å¬åŠ›å¼±åˆ™æ¯å¤©å¢åŠ 1ç¯‡ç²¾å¬ã€‚  </span><br><span class="line">   - **é«˜é¢‘è¯é¢˜çªå‡»**ï¼šå†™ä½œå…³æ³¨äººå·¥æ™ºèƒ½ã€ç¯ä¿ç­‰çƒ­ç‚¹ï¼›ç¿»è¯‘ç§¯ç´¯ä¼ ç»ŸèŠ‚æ—¥ã€æ”¿ç­–ç±»è¯æ±‡ã€‚</span><br><span class="line">3. **è€ƒå‰3å¤©ï¼š**  </span><br><span class="line">   - å¤ä¹ é”™é¢˜æœ¬ + èƒŒè¯µä½œæ–‡æ¨¡æ¿å¥ã€‚  </span><br><span class="line">   - å¬1å¥—å¬åŠ›ä¿æŒè¯­æ„Ÿï¼Œé¿å…ç”Ÿç–ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **å››ã€å¿…å¤‡èµ„æºæ¨è**</span></span><br><span class="line">1. **çœŸé¢˜**ï¼šã€Šæ˜Ÿç«å…­çº§çœŸé¢˜è¯¦è§£ã€‹ã€Šåç ”å¤–è¯­å…­çº§çœŸé¢˜ã€‹  </span><br><span class="line">2. **APP**ï¼šæ¯æ—¥è‹±è¯­å¬åŠ›ï¼ˆçœŸé¢˜éŸ³é¢‘ï¼‰ã€China Dailyï¼ˆç§¯ç´¯ç¿»è¯‘è¯æ±‡ï¼‰  </span><br><span class="line">3. **å†™ä½œç´ æ**ï¼šå…¬ä¼—å·<span class="string">&quot;LearnAndRecord&quot;</span>ã€èŒƒæ–‡ä¹¦ã€Šå…­çº§æ»¡åˆ†å†™ä½œ30å¤©é€Ÿæˆã€‹</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **äº”ã€å…³é”®æé†’**</span></span><br><span class="line">1. **å¬åŠ›ç­”æ¡ˆè§„å¾‹**ï¼š25é“é¢˜æ™®éåˆ†å¸ƒä¸º6A+6B+6C+6D+1éšæœºï¼Œå¯è¾…åŠ©æ£€æŸ¥ã€‚  </span><br><span class="line">2. **é˜…è¯»é¡ºåº**ï¼šå»ºè®®å…ˆåšä»”ç»†é˜…è¯»â†’é•¿ç¯‡é˜…è¯»â†’é€‰è¯å¡«ç©ºï¼ˆä¿å¤§åˆ†ï¼‰ã€‚  </span><br><span class="line">3. **ç¿»è¯‘åŸåˆ™**ï¼š**è¯­ä¹‰ä¼˜å…ˆ**ï¼Œä¸è¦é€å­—ç¿»è¯‘ï¼Œç”¨ç®€å•å¥ä¿è¯æ­£ç¡®æ€§ã€‚</span><br><span class="line"></span><br><span class="line">**æ¯å¤©å­¦ä¹ å»ºè®®2-3å°æ—¶ï¼ŒåšæŒ+å¤ç›˜æ˜¯å…³é”®ï¼** ç¥ä½ é¡ºåˆ©é€šè¿‡å…­çº§ï¼ ğŸ¯</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">system_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&quot;</span>,  </span><br><span class="line">    additional_kwargs=&#123;<span class="string">&quot;tool&quot;</span>:<span class="string">&quot;invoke_func1&quot;</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [system_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(messages)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&#x27;</span>, additional_kwargs=&#123;<span class="string">&#x27;tool&#x27;</span>: <span class="string">&#x27;invoke_func1&#x27;</span>&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3:ChatMessageå¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„ä¸å¤šï¼Œäº†è§£ä¸€ä¸‹å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> (  </span><br><span class="line">    AIMessage,  </span><br><span class="line">    HumanMessage,  </span><br><span class="line">    SystemMessage,  </span><br><span class="line">    ChatMessage  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºä¸åŒç±»å‹çš„æ¶ˆæ¯  </span></span><br><span class="line">system_message = SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®ç§‘å­¦å®¶&quot;</span>)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;è§£é‡Šä¸€ä¸‹éšæœºæ£®æ—ç®—æ³•&quot;</span>)  </span><br><span class="line">ai_message = AIMessage(content=<span class="string">&quot;éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³•...&quot;</span>)  </span><br><span class="line">custom_message = ChatMessage(role=<span class="string">&quot;analyst&quot;</span>, content=<span class="string">&quot;è¡¥å……ä¸€ç‚¹å…³äºè¶…å‚æ•°è°ƒä¼˜çš„ä¿¡æ¯&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(system_message.content)  </span><br><span class="line"><span class="built_in">print</span>(human_message.content)  </span><br><span class="line"><span class="built_in">print</span>(ai_message.content)  </span><br><span class="line"><span class="built_in">print</span>(custom_message.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®ç§‘å­¦å®¶</span><br><span class="line">è§£é‡Šä¸€ä¸‹éšæœºæ£®æ—ç®—æ³•</span><br><span class="line">éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³•...</span><br><span class="line">è¡¥å……ä¸€ç‚¹å…³äºè¶…å‚æ•°è°ƒä¼˜çš„ä¿¡æ¯</span><br></pre></td></tr></table></figure><h2 id="å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†"><a href="#å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†" class="headerlink" title="å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†"></a>å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†</h2><p>å‰æï¼šè·å–å¤§æ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>  </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•1ï¼šå¤§æ¨¡å‹æœ¬èº«æ˜¯æ²¡æœ‰ä¸Šä¸‹æ–‡è®°å¿†èƒ½åŠ›çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">response1 = chat_model.invoke(<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response1.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ çš„æ™ºèƒ½AIåŠ©æ‰‹ï¼ä½ å¯ä»¥å«æˆ‘ **DeepSeek** æˆ– **å°æ·±**ï½ğŸ˜Š  </span><br><span class="line"></span><br><span class="line">å¾ˆé«˜å…´è®¤è¯†ä½ ï¼è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure><p>æµ‹è¯•2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">human_message1 = HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message,human_message1]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯å°æ™ºï¼Œä¸€ä¸ªå¯çˆ±çš„AIåŠ©æ‰‹ï¼ğŸ˜Š æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>æµ‹è¯•3ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">sys_message1 = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæœ‰éœ€è¦å°±æ‰¾æˆ‘å§&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">human_message1 = HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message,sys_message1,human_message1]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘å«å°æ™ºï¼Œæ˜¯ä½ çš„ä¸“å±AIåŠ©æ‰‹ï¼ğŸ‰  </span><br><span class="line"></span><br><span class="line">è™½ç„¶<span class="string">&quot;çŒ«ç‹&quot;</span>ä¸æ˜¯çœŸçš„çŒ«ï¼ˆå…¶å®æ˜¯æŒ‡ä¼ å¥‡éŸ³ä¹äººåŸƒå°”ç»´æ–¯Â·æ™®é›·æ–¯åˆ©å•¦~ï¼‰ï¼Œä½†å¦‚æœä½ éœ€è¦ä¸€åªè™šæ‹ŸçŒ«ï¼Œæˆ‘å¯ä»¥ç«‹åˆ»ç»™ä½ å˜ä¸ªğŸ±è¡¨æƒ…åŒ…ï¼Œæˆ–è€…è®²ä¸ªå…³äºçŒ«çš„å†·ç¬‘è¯ï¼  </span><br><span class="line"></span><br><span class="line">æœ‰éœ€è¦éšæ—¶å«æˆ‘ï¼Œæ— è®ºæ˜¯æŸ¥èµ„æ–™ã€è§£é—·è¿˜æ˜¯å¸®å¿™ï¼Œå°æ™ºéƒ½åœ¨çº¿å“¦âœ¨</span><br></pre></td></tr></table></figure><p>æµ‹è¯•4ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç¬¬1ç»„  </span></span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç¬¬2ç»„  </span></span><br><span class="line">sys_message1 = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæœ‰éœ€è¦å°±æ‰¾æˆ‘å§&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">human_message1 = HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages1 = [sys_message1,human_message1]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line">response = chat_model.invoke(messages1)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯å…¨èƒ½å‹AIåŠ©æ‰‹ï¼è™½ç„¶æˆ‘è¿˜æ²¡æœ‰ä¸“å±çš„åå­—ï¼Œä½†ä½ å¯ä»¥å«æˆ‘<span class="string">&quot;å°åŠ©æ‰‹&quot;</span>ã€<span class="string">&quot;AIåŠ©æ‰‹&quot;</span>ï¼Œæˆ–è€…ç»™æˆ‘å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°~ ğŸ˜Š </span><br><span class="line"></span><br><span class="line">æˆ‘çš„å¼ºé¡¹æ˜¯ï¼š</span><br><span class="line">âœ… è§£ç­”å„ç±»é—®é¢˜</span><br><span class="line">âœ… å¤„ç†å¤æ‚ä»»åŠ¡</span><br><span class="line">âœ… é™ªä½ èŠå¤©è§£é—·</span><br><span class="line">âœ… ç»™å‡ºä¸“ä¸šå»ºè®®</span><br><span class="line">âœ… 24å°æ—¶è¶…é•¿å¾…æœº</span><br><span class="line"></span><br><span class="line">ä¸è®ºæ˜¯å­¦ä¹ ã€å·¥ä½œä¸Šçš„éš¾é¢˜ï¼Œè¿˜æ˜¯ç”Ÿæ´»ä¸­çš„å„ç§ç–‘é—®ï¼Œå°½ç®¡å¼€å£é—®æˆ‘ï¼ä½ å¸Œæœ›æˆ‘ç”¨ä»€ä¹ˆé£æ ¼è·Ÿä½ äº’åŠ¨å‘¢ï¼Ÿ(â—<span class="string">&#x27;â—¡&#x27;</span>â—)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•5ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage, AIMessage  </span><br><span class="line">  </span><br><span class="line">messages = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;äººå·¥æ™ºèƒ½è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;</span>),  </span><br><span class="line">    AIMessage(content=<span class="string">&quot;AI&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—&quot;</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">messages1 = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>),  </span><br><span class="line">    AIMessage(content=<span class="string">&quot;æˆ‘ä¹Ÿå¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—&quot;</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">messages2 = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;äººå·¥æ™ºèƒ½è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;</span>),  </span><br><span class="line">    AIMessage(content=<span class="string">&quot;AI&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—&quot;</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">chat_model.invoke(messages2)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=&#x27;æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹å°æ™ºï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼ğŸ˜Š æœ‰å…¶ä»–é—®é¢˜éšæ—¶é—®æˆ‘å“¦ï½&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">42</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">01999473</span>f5180604c29829720e51917a&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run--e960ebf3<span class="number">-6822</span><span class="number">-43</span>c5<span class="number">-8</span>b96<span class="number">-6</span>bbb5dfbfaab<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">42</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)</span><br></pre></td></tr></table></figure><h2 id="å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•"><a href="#å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•" class="headerlink" title="å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•"></a>å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•</h2><p>ä¸ºäº†å°½å¯èƒ½ç®€åŒ–è‡ªå®šä¹‰é“¾çš„åˆ›å»ºï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªâ€Runnableâ€åè®®ã€‚è®¸å¤šLangChainç»„ä»¶å®ç°äº† Runnable åè®®ï¼ŒåŒ…æ‹¬èŠå¤©æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿ã€è¾“å‡ºè§£æå™¨ã€æ£€ç´¢å™¨ã€ä»£ç†(æ™ºèƒ½ä½“)ç­‰ã€‚ </p><p><strong>Runnable å®šä¹‰çš„å…¬å…±çš„è°ƒç”¨æ–¹æ³•å¦‚ä¸‹</strong>ï¼š </p><ul><li><strong>invoke</strong>: å¤„ç†å•æ¡è¾“å…¥ï¼Œç­‰å¾…LLMå®Œå…¨æ¨ç†å®Œæˆåå†è¿”å›è°ƒç”¨ç»“æœ </li><li><strong>stream</strong>: æµå¼å“åº”ï¼Œé€å­—è¾“å‡ºLLMçš„å“åº”ç»“æœ </li><li><strong>batch</strong>: å¤„ç†æ‰¹é‡è¾“å…¥</li></ul><p>è¿™äº›ä¹Ÿæœ‰ç›¸åº”çš„å¼‚æ­¥æ–¹æ³•ï¼Œåº”è¯¥ä¸ <strong>asyncio</strong> çš„<strong>await</strong>è¯­æ³•ä¸€èµ·ä½¿ç”¨ä»¥å®ç°å¹¶å‘ï¼š </p><ul><li><strong>astream</strong>: å¼‚æ­¥æµå¼å“åº” </li><li><strong>ainvoke</strong>: å¼‚æ­¥å¤„ç†å•æ¡è¾“å…¥ </li><li><strong>abatch</strong>: å¼‚æ­¥å¤„ç†æ‰¹é‡è¾“å…¥ </li><li><strong>astream_log</strong>: å¼‚æ­¥æµå¼è¿”å›ä¸­é—´æ­¥éª¤ï¼Œä»¥åŠæœ€ç»ˆå“åº” </li><li><strong>astream_events</strong>: ï¼ˆæµ‹è¯•ç‰ˆï¼‰å¼‚æ­¥æµå¼è¿”å›é“¾ä¸­å‘ç”Ÿçš„äº‹ä»¶ï¼ˆåœ¨ langchain-core 0.1.14 ä¸­å¼•å…¥ï¼‰</li></ul><h3 id="ä¸¾ä¾‹1ï¼šéæµå¼è¾“å‡ºï¼š"><a href="#ä¸¾ä¾‹1ï¼šéæµå¼è¾“å‡ºï¼š" class="headerlink" title="ä¸¾ä¾‹1ï¼šéæµå¼è¾“å‡ºï¼š"></a>ä¸¾ä¾‹1ï¼š<strong>éæµå¼è¾“å‡º</strong>ï¼š</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæ¶ˆæ¯  </span></span><br><span class="line">messages = [HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±&quot;</span>)]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># éæµå¼è°ƒç”¨LLMè·å–å“åº”  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ‰“å°å“åº”å†…å®¹  </span></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼šæµå¼çš„æ¼”ç¤º"><a href="#ä¸¾ä¾‹2ï¼šæµå¼çš„æ¼”ç¤º" class="headerlink" title="ä¸¾ä¾‹2ï¼šæµå¼çš„æ¼”ç¤º"></a>ä¸¾ä¾‹2ï¼šæµå¼çš„æ¼”ç¤º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>,  </span><br><span class="line">                        streaming=<span class="literal">True</span>  <span class="comment"># å¯ç”¨æµå¼è¾“å‡º  </span></span><br><span class="line">                        )  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæ¶ˆæ¯  </span></span><br><span class="line">messages = [HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±&quot;</span>)]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æµå¼è°ƒç”¨LLMè·å–å“åº”  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹æµå¼è¾“å‡ºï¼š&quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> chat_model.stream(messages):  </span><br><span class="line">    <span class="comment"># é€ä¸ªæ‰“å°å†…å®¹å—  </span></span><br><span class="line">    <span class="built_in">print</span>(chunk.content, end=<span class="string">&quot;&quot;</span>, flush=<span class="literal">True</span>) <span class="comment"># åˆ·æ–°ç¼“å†²åŒº (æ— æ¢è¡Œç¬¦ï¼Œç¼“å†²åŒºæœªåˆ·æ–°ï¼Œå†…å®¹å¯èƒ½ä¸ä¼šç«‹å³æ˜¾ç¤º)  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næµå¼è¾“å‡ºç»“æŸ&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹æµå¼è¾“å‡ºï¼š</span><br><span class="line">ä½ å¥½ï¼æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸æ‰“é€ çš„ä¸€æ¬¾æ™ºèƒ½å¯¹è¯åŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ è§£ç­”å„ç§é—®é¢˜ã€æä¾›å†™ä½œçµæ„Ÿã€ååŠ©åˆ†ææ–‡æ¡£ã€ç”Ÿæˆåˆ›æ„å†…å®¹ï¼Œç”šè‡³é™ªä½ é—²èŠï¼âœ¨</span><br><span class="line"></span><br><span class="line"><span class="comment">### ğŸ” **æˆ‘çš„ç‰¹ç‚¹**ï¼š</span></span><br><span class="line">- **å…è´¹å¯ç”¨**ï¼šç›®å‰ä¸æ”¶å–ä»»ä½•è´¹ç”¨ï¼Œæ”¾å¿ƒä½¿ç”¨ï¼  </span><br><span class="line">- **å¤§å®¹é‡çŸ¥è¯†**ï¼šæˆ‘çš„çŸ¥è¯†æˆªè‡³ **2024å¹´7æœˆ**ï¼Œå¯ä»¥ä¸ºä½ æä¾›è¾ƒæ–°çš„èµ„è®¯ã€‚  </span><br><span class="line">- **è¶…é•¿ä¸Šä¸‹æ–‡è®°å¿†**ï¼šæ”¯æŒ **128K tokens**ï¼Œé€‚åˆå¤„ç†é•¿æ–‡æ¡£ã€å¤æ‚è®¨è®ºæˆ–ä»£ç åˆ†æã€‚  </span><br><span class="line">- **æ–‡ä»¶é˜…è¯»**ï¼šå¯ä»¥ä¸Šä¼  **PDFã€Wordã€Excel ç­‰æ–‡ä»¶**ï¼Œæˆ‘èƒ½å¸®ä½ æå–å’Œåˆ†æå†…å®¹ã€‚  </span><br><span class="line">- **ä¸­æ–‡ä¼˜åŒ–**ï¼šå¯¹ä¸­æ–‡ç†è§£å’Œç”Ÿæˆç‰¹åˆ«å‹å¥½ï¼Œé€‚åˆå„ç§ä¸­æ–‡åœºæ™¯ã€‚  </span><br><span class="line">- **ä¸æ“…é•¿å›¾ç‰‡ç”Ÿæˆ**ï¼ˆç›®å‰æˆ‘æ˜¯çº¯æ–‡æœ¬æ¨¡å‹ï¼‰ï¼Œä½†å¯ä»¥å¸®ä½ æè¿°æˆ–åˆ†æå›¾ç‰‡å†…å®¹ï¼  </span><br><span class="line"></span><br><span class="line">ä¸ç®¡æ˜¯å­¦ä¹ ã€å·¥ä½œè¿˜æ˜¯æ—¥å¸¸ç”Ÿæ´»ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜éƒ½å¯ä»¥é—®æˆ‘å“¦ï¼ğŸ˜Š **ä½ ä»Šå¤©æƒ³äº†è§£ä»€ä¹ˆå‘¢ï¼Ÿ**</span><br><span class="line">æµå¼è¾“å‡ºç»“æŸ</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹3ï¼šä½¿ç”¨batchï¼Œæµ‹è¯•æ‰¹é‡è°ƒç”¨"><a href="#ä¸¾ä¾‹3ï¼šä½¿ç”¨batchï¼Œæµ‹è¯•æ‰¹é‡è°ƒç”¨" class="headerlink" title="ä¸¾ä¾‹3ï¼šä½¿ç”¨batchï¼Œæµ‹è¯•æ‰¹é‡è°ƒç”¨"></a>ä¸¾ä¾‹3ï¼šä½¿ç”¨batchï¼Œæµ‹è¯•æ‰¹é‡è°ƒç”¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage, SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages1 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">             HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ &quot;</span>), ]  </span><br><span class="line">  </span><br><span class="line">messages2 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">             HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯AIGC&quot;</span>), ]  </span><br><span class="line">  </span><br><span class="line">messages3 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">             HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹æŠ€æœ¯&quot;</span>), ]  </span><br><span class="line">  </span><br><span class="line">messages = [messages1, messages2, messages3]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è°ƒç”¨batch  </span></span><br><span class="line">response = chat_model.batch(messages)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span>AIMessage(content=&#x27;æœºå™¨å­¦ä¹ ï¼ˆMachine Learning<span class="punctuation">,</span> MLï¼‰æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œè‡´åŠ›äºé€šè¿‡æ•°æ®å’Œç®—æ³•è®©è®¡ç®—æœºç³»ç»Ÿè‡ªåŠ¨â€œå­¦ä¹ â€å¹¶æ”¹è¿›æ€§èƒ½ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ä»¥ä¸‹æ˜¯å…¶å…³é”®æ¦‚å¿µå’Œç»„æˆéƒ¨åˆ†çš„æ¸…æ™°ä»‹ç»ï¼š\n\n---\n\n### **<span class="number">1.</span> æ ¸å¿ƒå®šä¹‰**\n- **æœ¬è´¨**ï¼šæœºå™¨å­¦ä¹ é€šè¿‡ä»å†å²æ•°æ®ä¸­è¯†åˆ«æ¨¡å¼æˆ–è§„å¾‹ï¼Œæ„å»ºæ•°å­¦æ¨¡å‹ï¼ˆå³â€œè®­ç»ƒâ€ï¼‰ï¼Œä»è€Œå¯¹æ–°æ•°æ®åšå‡ºé¢„æµ‹æˆ–å†³ç­–ã€‚\n- **ä¸ä¼ ç»Ÿç¼–ç¨‹çš„åŒºåˆ«**ï¼š  \n  - ä¼ ç»Ÿç¼–ç¨‹ï¼šäººå·¥ç¼–å†™è§„åˆ™ï¼Œè¾“å…¥æ•°æ®ï¼Œè¾“å‡ºç»“æœã€‚  \n  - æœºå™¨å­¦ä¹ ï¼šè¾“å…¥æ•°æ®+é¢„æœŸç»“æœï¼Œæœºå™¨è‡ªåŠ¨ç”Ÿæˆè§„åˆ™ï¼ˆæ¨¡å‹ï¼‰ï¼Œç”¨äºå¤„ç†æ–°æ•°æ®ã€‚\n\n---\n\n### **<span class="number">2.</span> æ ¸å¿ƒç±»å‹**\n- **ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰**  \n  - **ä»»åŠ¡**ï¼šç”¨å·²æ ‡æ³¨ï¼ˆå¸¦ç­”æ¡ˆï¼‰çš„æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œé¢„æµ‹æœªçŸ¥æ•°æ®çš„æ ‡ç­¾ã€‚  \n  - **ä¾‹å­**ï¼šåƒåœ¾é‚®ä»¶åˆ†ç±»ï¼ˆè¾“å…¥é‚®ä»¶ï¼Œè¾“å‡ºâ€œåƒåœ¾/æ­£å¸¸â€ï¼‰ã€æˆ¿ä»·é¢„æµ‹ã€‚  \n  - **å¸¸ç”¨ç®—æ³•**ï¼šçº¿æ€§å›å½’ã€å†³ç­–æ ‘ã€æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ã€ç¥ç»ç½‘ç»œã€‚\n\n- **æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰**  \n  - **ä»»åŠ¡**ï¼šä»æ— æ ‡æ³¨æ•°æ®ä¸­å‘ç°éšè—ç»“æ„ï¼ˆå¦‚åˆ†ç»„æˆ–é™ç»´ï¼‰ã€‚  \n  - **ä¾‹å­**ï¼šå®¢æˆ·ç»†åˆ†ï¼ˆå°†ç”¨æˆ·åˆ†æˆä¸åŒç¾¤ç»„ï¼‰ã€å¼‚å¸¸æ£€æµ‹ã€‚  \n  - **å¸¸ç”¨ç®—æ³•**ï¼šKå‡å€¼èšç±»ã€ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ã€‚\n\n- **å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰**  \n  - **ä»»åŠ¡**ï¼šæ™ºèƒ½ä½“é€šè¿‡è¯•é”™ä¸ç¯å¢ƒäº¤äº’ï¼Œæ ¹æ®å¥–åŠ±ä¿¡å·ä¼˜åŒ–ç­–ç•¥ã€‚  \n  - **ä¾‹å­**ï¼šAlphaGoæ¸¸æˆç­–ç•¥ã€æœºå™¨äººå¯¼èˆªã€‚  \n\n- **å…¶ä»–ç±»å‹**ï¼šåŠç›‘ç£å­¦ä¹ ã€è‡ªç›‘ç£å­¦ä¹ ã€è¿ç§»å­¦ä¹ ç­‰ã€‚\n\n---\n\n### **<span class="number">3.</span> å…¸å‹æµç¨‹**\n1. **æ•°æ®æ”¶é›†**ï¼šè·å–é«˜è´¨é‡ã€ä»£è¡¨æ€§çš„åŸå§‹æ•°æ®ï¼ˆå¦‚å›¾åƒã€æ–‡æœ¬ã€æ•°å€¼ï¼‰ã€‚  \n2. **æ•°æ®é¢„å¤„ç†**ï¼šæ¸…æ´—ï¼ˆå¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ï¼‰ã€å½’ä¸€åŒ–ã€ç‰¹å¾å·¥ç¨‹ï¼ˆæå–å…³é”®ç‰¹å¾ï¼‰ã€‚  \n3. **æ¨¡å‹é€‰æ‹©**ï¼šæ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©ç®—æ³•ï¼ˆå¦‚åˆ†ç±»ä»»åŠ¡é€‰éšæœºæ£®æ—ï¼‰ã€‚  \n4. **è®­ç»ƒä¸è¯„ä¼°**ï¼š  \n   - ç”¨è®­ç»ƒé›†æ‹Ÿåˆæ¨¡å‹ï¼Œç”¨éªŒè¯é›†è°ƒå‚ï¼Œç”¨æµ‹è¯•é›†è¯„ä¼°æ€§èƒ½ã€‚  \n   - å¸¸ç”¨æŒ‡æ ‡ï¼šå‡†ç¡®ç‡ã€å¬å›ç‡ã€å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ç­‰ã€‚  \n5. **éƒ¨ç½²ä¸è¿­ä»£**ï¼šå°†æ¨¡å‹åº”ç”¨äºå®é™…åœºæ™¯ï¼ŒæŒç»­ç›‘æ§å¹¶ä¼˜åŒ–ã€‚\n\n---\n\n### **<span class="number">4.</span> ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**\n- **è‡ªåŠ¨åŒ–å†³ç­–**ï¼šå¤„ç†æµ·é‡æ•°æ®çš„é€Ÿåº¦å’Œç²¾åº¦è¿œè¶…äººç±»ï¼ˆå¦‚åŒ»ç–—å½±åƒåˆ†æï¼‰ã€‚  \n- **é€‚åº”æ€§**ï¼šæ¨¡å‹å¯éšæ–°æ•°æ®åŠ¨æ€æ›´æ–°ï¼ˆå¦‚æ¨èç³»ç»Ÿé€‚åº”ç”¨æˆ·åå¥½å˜åŒ–ï¼‰ã€‚  \n- **è·¨é¢†åŸŸåº”ç”¨**ï¼šé‡‘èï¼ˆä¿¡ç”¨è¯„åˆ†ï¼‰ã€åŒ»ç–—ï¼ˆç–¾ç—…é¢„æµ‹ï¼‰ã€åˆ¶é€ ä¸šï¼ˆæ•…éšœæ£€æµ‹ï¼‰ç­‰ã€‚\n\n---\n\n### **<span class="number">5.</span> æŒ‘æˆ˜ä¸é™åˆ¶**\n- **æ•°æ®ä¾èµ–**ï¼šéœ€å¤§é‡é«˜è´¨é‡æ•°æ®ï¼Œæ•°æ®åå·®ä¼šå¯¼è‡´æ¨¡å‹åè§ã€‚  \n- **è¿‡æ‹Ÿåˆ**ï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¥½ï¼Œä½†æ³›åŒ–èƒ½åŠ›å·®ï¼ˆå¯é€šè¿‡æ­£åˆ™åŒ–ã€äº¤å‰éªŒè¯ç¼“è§£ï¼‰ã€‚  \n- **å¯è§£é‡Šæ€§**ï¼šæ·±åº¦å­¦ä¹ ç­‰å¤æ‚æ¨¡å‹å¸¸è¢«è§†ä¸ºâ€œé»‘ç®±â€ï¼Œéœ€å¯è§£é‡Šæ€§æŠ€æœ¯ï¼ˆå¦‚SHAPå€¼ï¼‰ã€‚\n\n---\n\n### **<span class="number">6.</span> æ‰©å±•æ–¹å‘**\n- **æ·±åº¦å­¦ä¹ **ï¼šåŸºäºå¤šå±‚ç¥ç»ç½‘ç»œçš„æœºå™¨å­¦ä¹ ï¼Œæ“…é•¿å›¾åƒã€è¯­éŸ³ç­‰å¤æ‚æ•°æ®ã€‚  \n- **é›†æˆå­¦ä¹ **ï¼šç»“åˆå¤šä¸ªæ¨¡å‹æå‡æ€§èƒ½ï¼ˆå¦‚éšæœºæ£®æ—ã€XGBoostï¼‰ã€‚  \n- **è”é‚¦å­¦ä¹ **ï¼šåˆ†æ•£å¼è®­ç»ƒï¼Œä¿æŠ¤æ•°æ®éšç§ã€‚\n\n---\n\næœºå™¨å­¦ä¹ æ­£æŒç»­æ”¹å˜å„è¡Œå„ä¸šï¼Œä½†å…¶æˆåŠŸä¾èµ–å¯¹é—®é¢˜åœºæ™¯çš„ç†è§£ã€æ•°æ®çš„åˆç†å¤„ç†ä»¥åŠæ¨¡å‹çš„é€‰æ‹©ä¼˜åŒ–ã€‚å¦‚éœ€è¿›ä¸€æ­¥äº†è§£æŸä¸ªå…·ä½“é¢†åŸŸï¼ˆå¦‚ç®—æ³•ç»†èŠ‚ã€åº”ç”¨æ¡ˆä¾‹ï¼‰ï¼Œå¯ä»¥æ·±å…¥æ¢è®¨ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">784</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">800</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0199947</span>d483332aa6c642e23ed0bbdc4&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run-<span class="number">-2</span>fe38b71<span class="number">-0</span>eb5<span class="number">-4</span>d97<span class="number">-9</span>a96<span class="number">-18895</span>b0e5343<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">784</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">800</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;AIGCï¼ˆAI-Generated Contentï¼Œäººå·¥æ™ºèƒ½ç”Ÿæˆå†…å®¹ï¼‰æ˜¯æŒ‡åˆ©ç”¨äººå·¥æ™ºèƒ½æŠ€æœ¯è‡ªåŠ¨æˆ–åŠè‡ªåŠ¨åœ°ç”Ÿæˆæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ã€ä»£ç ç­‰å†…å®¹çš„æ–°å‹å†…å®¹åˆ›ä½œæ–¹å¼ã€‚éšç€æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ã€è®¡ç®—æœºè§†è§‰ç­‰æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼ŒAIGCæ­£åœ¨æ·±åˆ»æ”¹å˜å†…å®¹ç”Ÿäº§çš„æ•ˆç‡å’Œæ¨¡å¼ã€‚\n\n### **æ ¸å¿ƒç‰¹ç‚¹**\n1. **è‡ªåŠ¨åŒ–åˆ›ä½œ**ï¼šæ— éœ€å…¨ç¨‹äººå·¥å‚ä¸ï¼ŒAIå¯åŸºäºè¾“å…¥æŒ‡ä»¤ï¼ˆå¦‚æ–‡å­—æç¤ºï¼‰ç‹¬ç«‹ç”Ÿæˆå†…å®¹ã€‚\n2. **å¤šæ¨¡æ€è¾“å‡º**ï¼šæ”¯æŒç”Ÿæˆå¤šç§å½¢å¼çš„å†…å®¹ï¼Œå¦‚æ–‡æœ¬ï¼ˆChatGPTï¼‰ã€å›¾åƒï¼ˆMidJourneyï¼‰ã€éŸ³ä¹ï¼ˆJukedeckï¼‰ã€è§†é¢‘ï¼ˆSoraï¼‰ç­‰ã€‚\n3. **é«˜æ•ˆè¿­ä»£**ï¼šå¿«é€Ÿç”Ÿæˆå¤šä¸ªç‰ˆæœ¬ï¼Œå¸®åŠ©ç”¨æˆ·ä¼˜åŒ–åˆ›æ„æˆ–æµ‹è¯•ä¸åŒæ–¹æ¡ˆã€‚\n\n### **å…³é”®æŠ€æœ¯**\n- **ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰**ï¼šé€šè¿‡ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨çš„å¯¹æŠ—è®­ç»ƒç”Ÿæˆé€¼çœŸæ•°æ®ï¼ˆå¦‚äººè„¸å›¾åƒï¼‰ã€‚\n- **å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰**ï¼šå¦‚GPT<span class="number">-4</span>ã€Claudeç­‰ï¼Œæ“…é•¿ç†è§£å¹¶ç”Ÿæˆè‡ªç„¶è¯­è¨€æ–‡æœ¬ã€‚\n- **æ‰©æ•£æ¨¡å‹ï¼ˆDiffusion Modelsï¼‰**ï¼šé€šè¿‡é€æ­¥å»å™ªç”Ÿæˆé«˜è´¨é‡å›¾åƒï¼ˆå¦‚Stable Diffusionï¼‰ã€‚\n- **å¤šæ¨¡æ€æ¨¡å‹**ï¼šå¦‚DALLÂ·Eï¼ˆå›¾æ–‡ç”Ÿæˆï¼‰ã€Whisperï¼ˆè¯­éŸ³è½¬æ–‡æœ¬ï¼‰ç­‰ã€‚\n\n### **å…¸å‹åº”ç”¨åœºæ™¯**\n- **æ–‡å­—åˆ›ä½œ**ï¼šæ–°é—»ç¨¿ã€å¹¿å‘Šæ–‡æ¡ˆã€å‰§æœ¬ã€ä»£ç ç”Ÿæˆç­‰ã€‚\n- **è§†è§‰è®¾è®¡**ï¼šæµ·æŠ¥ã€æ’ç”»ã€<span class="number">3</span>Dæ¨¡å‹ã€ç”µå•†äº§å“å›¾ã€‚\n- **å½±éŸ³åˆ¶ä½œ**ï¼šçŸ­è§†é¢‘ã€è™šæ‹Ÿä¸»æ’­ã€AIé…éŸ³ã€èƒŒæ™¯éŸ³ä¹ã€‚\n- **æ¸¸æˆå¼€å‘**ï¼šè‡ªåŠ¨ç”Ÿæˆå…³å¡ã€è§’è‰²å¯¹è¯æˆ–åœºæ™¯ç´ æã€‚\n- **ä¸ªæ€§åŒ–æ¨è**ï¼šåŠ¨æ€ç”Ÿæˆç”¨æˆ·ä¸“å±å†…å®¹ï¼ˆå¦‚è¥é”€é‚®ä»¶ï¼‰ã€‚\n\n### **é¢ä¸´çš„æŒ‘æˆ˜**\n- **ç‰ˆæƒäº‰è®®**ï¼šè®­ç»ƒæ•°æ®å¯èƒ½æ¶‰åŠæœªç»æˆæƒçš„åŸåˆ›å†…å®¹ã€‚\n- **è´¨é‡æ³¢åŠ¨**ï¼šè¾“å‡ºç»“æœéœ€äººå·¥æ ¡éªŒï¼Œå¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯æˆ–ä½è´¨é‡å†…å®¹ã€‚\n- **ä¼¦ç†é£é™©**ï¼šè™šå‡ä¿¡æ¯ï¼ˆDeepfakeï¼‰ã€åè§æ”¾å¤§ç­‰é—®é¢˜éœ€ç›‘ç®¡åº”å¯¹ã€‚\n\n### **æœªæ¥è¶‹åŠ¿**\nAIGCæ­£ä»è¾…åŠ©å·¥å…·è½¬å‘ååŒåˆ›é€ ï¼Œæœªæ¥å¯èƒ½ä¸VR/ARã€å…ƒå®‡å®™ç»“åˆï¼Œè¿›ä¸€æ­¥é™ä½å†…å®¹åˆ›ä½œé—¨æ§›ã€‚ä¼ä¸šä¹Ÿåœ¨æ¢ç´¢â€œäººç±»åˆ›æ„+AIæ•ˆç‡â€çš„æ··åˆå·¥ä½œæµã€‚\n\nå¦‚æœéœ€è¦äº†è§£å…·ä½“å·¥å…·æˆ–é¢†åŸŸï¼ˆå¦‚AIç»˜ç”»ã€å†™ä½œï¼‰ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¢è®¨ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">481</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">499</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0199947</span>d4837dda4d703fbcfc4e54111&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run-<span class="number">-8783e087</span><span class="number">-8</span>d75<span class="number">-4</span>afb-b3c4<span class="number">-3</span>deed473ce70<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">481</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">499</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;å¤§æ¨¡å‹æŠ€æœ¯ï¼ˆLarge Language Modelsï¼ŒLLMsï¼‰æ˜¯å½“å‰äººå·¥æ™ºèƒ½é¢†åŸŸçš„é‡è¦çªç ´ï¼ŒæŒ‡é€šè¿‡æµ·é‡æ•°æ®å’Œåºå¤§å‚æ•°è§„æ¨¡è®­ç»ƒçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œèƒ½å¤Ÿå¤„ç†è‡ªç„¶è¯­è¨€ç†è§£ã€ç”Ÿæˆã€æ¨ç†ç­‰å¤æ‚ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ï¼š\n\n---\n\n### **<span class="number">1.</span> åŸºæœ¬æ¦‚å¿µ**\n- **å‚æ•°è§„æ¨¡**ï¼šé€šå¸¸æŒ‡å‚æ•°é‡è¾¾åˆ°æ•°åäº¿ï¼ˆå¦‚GPT<span class="number">-3</span>å«<span class="number">1750</span>äº¿å‚æ•°ï¼‰ç”šè‡³ä¸‡äº¿çš„æ¨¡å‹ï¼Œå‚æ•°è¶Šå¤šæ¨¡å‹èƒ½åŠ›é€šå¸¸è¶Šå¼ºã€‚\n- **é¢„è®­ç»ƒ+å¾®è°ƒ**ï¼šå…ˆåœ¨å¹¿æ³›çš„æ— æ ‡æ³¨æ•°æ®ä¸Šå­¦ä¹ é€šç”¨è¯­è¨€æ¨¡å¼ï¼ˆå¦‚äº’è”ç½‘æ–‡æœ¬ï¼‰ï¼Œå†é’ˆå¯¹ç‰¹å®šä»»åŠ¡å¾®è°ƒã€‚\n\n---\n\n### **<span class="number">2.</span> æ ¸å¿ƒæŠ€æœ¯åŸç†**\n- **Transformeræ¶æ„**ï¼šåŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰ï¼Œå¯å¹¶è¡Œå¤„ç†é•¿åºåˆ—æ•°æ®ï¼Œçªç ´ä¼ ç»ŸRNNçš„å±€é™æ€§ã€‚\n- **æ ¸å¿ƒç»„ä»¶**ï¼š\n  - **å¤šå¤´æ³¨æ„åŠ›**ï¼šæ•æ‰æ–‡æœ¬ä¸­è¿œè·ç¦»ä¾èµ–å…³ç³»ã€‚\n  - **ä½ç½®ç¼–ç **ï¼šä¿ç•™è¯æ±‡é¡ºåºä¿¡æ¯ã€‚\n  - **å¤§è§„æ¨¡æ— ç›‘ç£å­¦ä¹ **ï¼šé€šè¿‡é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼ˆè¯­è¨€å»ºæ¨¡ï¼‰å­¦ä¹ è¯­è¨€è§„å¾‹ã€‚\n\n---\n\n### **<span class="number">3.</span> å…¸å‹ä»£è¡¨æ¨¡å‹**\n- **GPTç³»åˆ—**ï¼ˆOpenAIï¼‰ï¼šç”Ÿæˆå¼é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ“…é•¿æ–‡æœ¬åˆ›ä½œã€é—®ç­”ã€‚\n- **BERT**ï¼ˆGoogleï¼‰ï¼šåŒå‘ç¼–ç æ¨¡å‹ï¼Œé€‚åˆæ–‡æœ¬åˆ†ç±»ã€å®ä½“è¯†åˆ«ã€‚\n- **PaLM**ï¼ˆGoogleï¼‰ã€**LLaMA**ï¼ˆMetaï¼‰ï¼šå‚æ•°é‡åŒ–ä¸æ•ˆç‡ä¼˜åŒ–ä»£è¡¨ã€‚\n- **å¤šæ¨¡æ€æ¨¡å‹**ï¼ˆå¦‚GPT<span class="number">-4</span>Vã€Geminiï¼‰ï¼šæ”¯æŒå›¾åƒã€éŸ³é¢‘ç­‰å¤šæ•°æ®ç±»å‹è¾“å…¥ã€‚\n\n---\n\n### **<span class="number">4.</span> å…³é”®èƒ½åŠ›**\n- **è‡ªç„¶è¯­è¨€ç”Ÿæˆ**ï¼šå†™ä½œã€ç¿»è¯‘ã€ä»£ç ç”Ÿæˆã€‚\n- **ä¸Šä¸‹æ–‡ç†è§£**ï¼šé•¿æ–‡å¯¹è¯ã€é€»è¾‘æ¨ç†ã€‚\n- **é›¶æ ·æœ¬/å°æ ·æœ¬å­¦ä¹ **ï¼šæ— éœ€å¤§é‡æ ‡æ³¨æ•°æ®å³å¯å®Œæˆæ–°ä»»åŠ¡ã€‚\n- **æ€ç»´é“¾ï¼ˆChain-of-Thoughtï¼‰**ï¼šåˆ†æ­¥æ¨ç†è§£å†³æ•°å­¦æˆ–é€»è¾‘é—®é¢˜ã€‚\n\n---\n\n### **<span class="number">5.</span> åº”ç”¨åœºæ™¯**\n- **é€šç”¨é¢†åŸŸ**ï¼šæ™ºèƒ½å®¢æœã€å†…å®¹åˆ›ä½œã€æ•™è‚²è¾…åŠ©ã€‚\n- **å‚ç›´è¡Œä¸š**ï¼šåŒ»ç–—è¯Šæ–­è¾…åŠ©ã€æ³•å¾‹æ–‡ä¹¦åˆ†æã€é‡‘èé¢„æµ‹ã€‚\n- **å¼€å‘è€…å·¥å…·**ï¼šä»£ç è¡¥å…¨ï¼ˆGitHub Copilotï¼‰ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚\n\n---\n\n### **<span class="number">6.</span> æŒ‘æˆ˜ä¸å±€é™**\n- **ç®—åŠ›éœ€æ±‚**ï¼šè®­ç»ƒéœ€é«˜æ€§èƒ½GPUé›†ç¾¤ï¼Œæˆæœ¬é«˜æ˜‚ã€‚\n- **å¹»è§‰é—®é¢˜**ï¼šå¯èƒ½ç”Ÿæˆè™šå‡æˆ–æœ‰å®³å†…å®¹ã€‚\n- **åè§ä¸å®‰å…¨**ï¼šæ•°æ®åå·®å¯¼è‡´è¾“å‡ºæ­§è§†æ€§å†…å®¹ã€‚\n- **å¯è§£é‡Šæ€§**ï¼šå†…éƒ¨å†³ç­–è¿‡ç¨‹åƒâ€œé»‘ç®±â€ï¼Œéš¾ä»¥è¿½è¸ªã€‚\n\n---\n\n### **<span class="number">7.</span> æœªæ¥æ–¹å‘**\n- **å°å‹åŒ–**ï¼šæ¨¡å‹å‹ç¼©ï¼ˆå¦‚é‡åŒ–ã€è’¸é¦ï¼‰ä»¥é€‚é…è¾¹ç¼˜è®¾å¤‡ã€‚\n- **èƒ½è€—ä¼˜åŒ–**ï¼šç»¿è‰²AIé™ä½ç¢³è¶³è¿¹ã€‚\n- **å¯æ§ç”Ÿæˆ**ï¼šæå‡è¾“å‡ºå¯é æ€§ä¸å®‰å…¨æ€§ã€‚\n- **å…·èº«æ™ºèƒ½**ï¼šç»“åˆæœºå™¨äººç­‰ç‰©ç†ä¸–ç•Œäº¤äº’ã€‚\n\n---\n\nå¦‚æœéœ€è¦äº†è§£ç‰¹å®šæ¨¡å‹ï¼ˆå¦‚ChatGPTåŸç†ï¼‰æˆ–åº”ç”¨æ¡ˆä¾‹ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¢è®¨ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">608</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">626</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0199947</span>d483e6011f5a633be4c177da2&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run-<span class="number">-3</span>a0858f3<span class="number">-60e8</span><span class="number">-46</span>c3-bbf6<span class="number">-0e78</span>b4fa3903<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">608</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">626</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹4ï¼šå…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨"><a href="#ä¸¾ä¾‹4ï¼šå…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨" class="headerlink" title="ä¸¾ä¾‹4ï¼šå…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨"></a>ä¸¾ä¾‹4ï¼šå…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨</h3><p>åŒæ­¥è°ƒç”¨<br>ä¸¾ä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">call_model</span>():  </span><br><span class="line">    <span class="comment"># æ¨¡æ‹ŸåŒæ­¥APIè°ƒç”¨  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹è°ƒç”¨æ¨¡å‹...&quot;</span>)  </span><br><span class="line">    time.sleep(<span class="number">5</span>)  <span class="comment"># æ¨¡æ‹Ÿè°ƒç”¨ç­‰å¾…,å•ä½ï¼šç§’  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ¨¡å‹è°ƒç”¨å®Œæˆã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">perform_other_tasks</span>():  </span><br><span class="line">    <span class="comment"># æ¨¡æ‹Ÿæ‰§è¡Œå…¶ä»–ä»»åŠ¡  </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ‰§è¡Œå…¶ä»–ä»»åŠ¡ <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>&quot;</span>)  </span><br><span class="line">        time.sleep(<span class="number">1</span>)  <span class="comment"># å•ä½ï¼šç§’  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">    call_model()  </span><br><span class="line">    perform_other_tasks()  </span><br><span class="line">    end_time = time.time()  </span><br><span class="line">    total_time = end_time - start_time  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;æ€»å…±è€—æ—¶ï¼š<span class="subst">&#123;total_time&#125;</span>ç§’&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿è¡ŒåŒæ­¥ä»»åŠ¡å¹¶æ‰“å°å®Œæˆæ—¶é—´  </span></span><br><span class="line">main_time = main()  </span><br><span class="line"><span class="built_in">print</span>(main_time)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹è°ƒç”¨æ¨¡å‹...</span><br><span class="line">æ¨¡å‹è°ƒç”¨å®Œæˆã€‚</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 1</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 2</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 3</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 4</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 5</span><br><span class="line">æ€»å…±è€—æ—¶ï¼š10.0043363571167ç§’</span><br></pre></td></tr></table></figure><p>ä½“ä¼š2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> time  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage, SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åŒæ­¥è°ƒç”¨ï¼ˆå¯¹æ¯”ç»„ï¼‰  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sync_test</span>():  </span><br><span class="line">    messages1 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">                 HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ &quot;</span>), ]  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">    response = chat_model.invoke(messages1)  <span class="comment"># åŒæ­¥è°ƒç”¨  </span></span><br><span class="line">    duration = time.time() - start_time  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åŒæ­¥è°ƒç”¨è€—æ—¶ï¼š<span class="subst">&#123;duration:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)  </span><br><span class="line">    <span class="keyword">return</span> response, duration  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¼‚æ­¥è°ƒç”¨ï¼ˆå®éªŒç»„ï¼‰  </span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_test</span>():  </span><br><span class="line">    messages1 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">                 HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ &quot;</span>), ]  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">    response = <span class="keyword">await</span> chat_model.ainvoke(messages1)  <span class="comment"># å¼‚æ­¥è°ƒç”¨  </span></span><br><span class="line">    duration = time.time() - start_time  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š<span class="subst">&#123;duration:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)  </span><br><span class="line">    <span class="keyword">return</span> response, duration  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿è¡Œæµ‹è¯•  </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    <span class="comment"># è¿è¡ŒåŒæ­¥æµ‹è¯•  </span></span><br><span class="line">    sync_response, sync_duration = sync_test()  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åŒæ­¥å“åº”å†…å®¹: <span class="subst">&#123;sync_response.content[:<span class="number">100</span>]&#125;</span>...\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># è¿è¡Œå¼‚æ­¥æµ‹è¯•  </span></span><br><span class="line">    async_response, async_duration = asyncio.run(async_test())  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼‚æ­¥å“åº”å†…å®¹: <span class="subst">&#123;async_response.content[:<span class="number">100</span>]&#125;</span>...\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># å¹¶å‘æµ‹è¯• - ä¿®å¤ç‰ˆæœ¬  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n=== å¹¶å‘æµ‹è¯• ===&quot;</span>)  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">run_concurrent_tests</span>():  </span><br><span class="line">        <span class="comment"># åˆ›å»º3ä¸ªå¼‚æ­¥ä»»åŠ¡  </span></span><br><span class="line">        tasks = [async_test() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]  </span><br><span class="line">        <span class="comment"># å¹¶å‘æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡  </span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> asyncio.gather(*tasks)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># æ‰§è¡Œå¹¶å‘æµ‹è¯•  </span></span><br><span class="line">    results = asyncio.run(run_concurrent_tests())  </span><br><span class="line">  </span><br><span class="line">    total_time = time.time() - start_time  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n3ä¸ªå¹¶å‘å¼‚æ­¥è°ƒç”¨æ€»è€—æ—¶: <span class="subst">&#123;total_time:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¹³å‡æ¯ä¸ªè°ƒç”¨è€—æ—¶: <span class="subst">&#123;total_time / <span class="number">3</span>:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">åŒæ­¥è°ƒç”¨è€—æ—¶ï¼š15.73ç§’</span><br><span class="line">åŒæ­¥å“åº”å†…å®¹: æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œå…¶ç›®æ ‡æ˜¯è®©è®¡ç®—æœºç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡æ•°æ®**è‡ªåŠ¨å­¦ä¹ å’Œæ”¹è¿›**ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œæœºå™¨å­¦ä¹ é€šè¿‡åˆ†æå¤§é‡æ•°æ®æ¥å‘ç°è§„...</span><br><span class="line"></span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š13.78ç§’</span><br><span class="line">å¼‚æ­¥å“åº”å†…å®¹: æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œè‡´åŠ›äºé€šè¿‡æ•°æ®å’Œç®—æ³•è®©è®¡ç®—æœºç³»ç»Ÿå…·å¤‡â€œå­¦ä¹ â€èƒ½åŠ›ï¼Œä»è€Œè‡ªåŠ¨å®Œæˆä»»åŠ¡æˆ–æ”¹è¿›æ€§èƒ½ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ä»¥ä¸‹æ˜¯å®ƒçš„å…³é”®æ¦‚å¿µå’Œ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=== å¹¶å‘æµ‹è¯• ===</span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š14.54ç§’</span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š16.29ç§’</span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š19.98ç§’</span><br><span class="line"></span><br><span class="line">3ä¸ªå¹¶å‘å¼‚æ­¥è°ƒç”¨æ€»è€—æ—¶: 19.99ç§’</span><br><span class="line">å¹³å‡æ¯ä¸ªè°ƒç”¨è€—æ—¶: 6.66ç§’</span><br><span class="line"></span><br><span class="line">è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º 0</span><br></pre></td></tr></table></figure><h1 id="Model-I-Oä¹‹Prompt-Template"><a href="#Model-I-Oä¹‹Prompt-Template" class="headerlink" title="Model I&#x2F;Oä¹‹Prompt Template"></a>Model I&#x2F;Oä¹‹Prompt Template</h1><p>Prompt Templateï¼Œé€šè¿‡æ¨¡æ¿ç®¡ç†å¤§æ¨¡å‹çš„è¾“å…¥ã€‚</p><h2 id="ä»‹ç»ä¸åˆ†ç±»"><a href="#ä»‹ç»ä¸åˆ†ç±»" class="headerlink" title="ä»‹ç»ä¸åˆ†ç±»"></a>ä»‹ç»ä¸åˆ†ç±»</h2><p>Prompt Template æ˜¯LangChainä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªä¼ é€’ç»™LLMçš„ä¿¡æ¯ï¼ˆå³æç¤º è¯promptï¼‰</p><p>åœ¨åº”ç”¨å¼€å‘ä¸­ï¼Œå›ºå®šçš„æç¤ºè¯é™åˆ¶äº†æ¨¡å‹çš„çµæ´»æ€§å’Œé€‚ç”¨èŒƒå›´ã€‚æ‰€ä»¥ï¼Œprompt template æ˜¯ä¸€ä¸ª <strong>æ¨¡æ¿åŒ– çš„å­—ç¬¦ä¸²</strong>ï¼Œä½ å¯ä»¥å°† <strong>å˜é‡æ’å…¥åˆ°æ¨¡æ¿</strong>ä¸­ï¼Œä»è€Œåˆ›å»ºå‡ºä¸åŒçš„æç¤ºã€‚è°ƒç”¨æ—¶ï¼š</p><ul><li>ä»¥<strong>å­—å…¸</strong>ä½œä¸ºè¾“å…¥ï¼Œå…¶ä¸­æ¯ä¸ªé”®ä»£è¡¨è¦å¡«å……çš„æç¤ºæ¨¡æ¿ä¸­çš„å˜é‡ã€‚ </li><li>è¾“å‡ºä¸€ä¸ª <strong>PromptValue</strong> ã€‚è¿™ä¸ª PromptValue å¯ä»¥ä¼ é€’ç»™ LLM æˆ– ChatModelï¼Œå¹¶ä¸”è¿˜å¯ä»¥è½¬æ¢ ä¸ºå­—ç¬¦ä¸²æˆ–æ¶ˆæ¯åˆ—è¡¨ã€‚</li></ul><p><strong>æœ‰å‡ ç§ä¸åŒç±»å‹çš„æç¤ºæ¨¡æ¿</strong>ï¼š</p><ul><li><strong>PromptTemplate</strong> ï¼šLLMæç¤ºæ¨¡æ¿ï¼Œç”¨äº<strong>ç”Ÿæˆå­—ç¬¦ä¸²æç¤º</strong>ã€‚å®ƒä½¿ç”¨ Python çš„å­—ç¬¦ä¸²æ¥æ¨¡æ¿æç¤ºã€‚ </li><li><strong>ChatPromptTemplate</strong> ï¼šèŠå¤©æç¤ºæ¨¡æ¿ï¼Œç”¨äº<strong>ç»„åˆå„ç§è§’è‰²çš„æ¶ˆæ¯æ¨¡æ¿</strong>ï¼Œä¼ å…¥èŠå¤©æ¨¡å‹ã€‚ </li><li><strong>XxxMessagePromptTemplate</strong> ï¼šæ¶ˆæ¯æ¨¡æ¿è¯æ¨¡æ¿ï¼ŒåŒ…æ‹¬ï¼šSystemMessagePromptTemplateã€ HumanMessagePromptTemplateã€AIMessagePromptTemplateã€ ChatMessagePromptTemplateç­‰ </li><li><strong>FewShotPromptTemplate</strong> ï¼šæ ·æœ¬æç¤ºè¯æ¨¡æ¿ï¼Œé€šè¿‡ç¤ºä¾‹æ¥æ•™æ¨¡å‹å¦‚ä½•å›ç­” </li><li><strong>PipelinePrompt</strong> ï¼šç®¡é“æç¤ºè¯æ¨¡æ¿ï¼Œç”¨äºæŠŠå‡ ä¸ªæç¤ºè¯ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚ è‡ªå®šä¹‰æ¨¡æ¿ï¼šå…è®¸åŸºäºå…¶å®ƒæ¨¡æ¿ç±»æ¥å®šåˆ¶è‡ªå·±çš„æç¤ºè¯æ¨¡æ¿ã€‚</li></ul><h2 id="å…·ä½“ä½¿ç”¨ï¼šPromptTemplate"><a href="#å…·ä½“ä½¿ç”¨ï¼šPromptTemplate" class="headerlink" title="å…·ä½“ä½¿ç”¨ï¼šPromptTemplate"></a>å…·ä½“ä½¿ç”¨ï¼šPromptTemplate</h2><h3 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h3><p>PromptTemplateç±»ï¼Œç”¨äºå¿«é€Ÿæ„å»º <strong>åŒ…å«å˜é‡</strong>çš„æç¤ºè¯æ¨¡æ¿ï¼Œå¹¶é€šè¿‡<strong>ä¼ å…¥ä¸åŒçš„å‚æ•°å€¼</strong> ç”Ÿæˆè‡ªå®šä¹‰çš„æç¤ºè¯ã€‚<br><strong>ä¸»è¦å‚æ•°ä»‹ç»</strong>ï¼š </p><ul><li><strong>template</strong>ï¼šå®šä¹‰æç¤ºè¯æ¨¡æ¿çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«æ–‡æœ¬å’Œå˜é‡å ä½ç¬¦ï¼ˆå¦‚{name}ï¼‰  ï¼› </li><li><strong>input_variables</strong>ï¼š åˆ—è¡¨ï¼ŒæŒ‡å®šäº†æ¨¡æ¿ä¸­ä½¿ç”¨çš„å˜é‡åç§°ï¼Œåœ¨è°ƒç”¨æ¨¡æ¿æ—¶è¢«æ›¿æ¢ï¼› </li><li><strong>partial_variables</strong>ï¼šå­—å…¸ï¼Œç”¨äºå®šä¹‰æ¨¡æ¿ä¸­ä¸€äº›å›ºå®šçš„å˜é‡åã€‚è¿™äº›å€¼ä¸éœ€è¦å†æ¯æ¬¡è°ƒç”¨æ—¶è¢«æ›¿æ¢ã€‚</li></ul><p><strong>å‡½æ•°ä»‹ç»ï¼š</strong></p><ul><li>**format()**ï¼šç»™input_variableså˜é‡èµ‹å€¼ï¼Œå¹¶è¿”å›æç¤ºè¯ã€‚åˆ©ç”¨format() è¿›è¡Œæ ¼å¼åŒ–æ—¶å°±ä¸€å®šè¦èµ‹ å€¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å½“åœ¨templateä¸­æœªè®¾ç½®input_variablesï¼Œåˆ™ä¼šè‡ªåŠ¨å¿½ç•¥ã€‚</li></ul><h3 id="ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼"><a href="#ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼" class="headerlink" title="ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼"></a>ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼</h3><h4 id="æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•"><a href="#æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•" class="headerlink" title="æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•"></a>æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate </span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ¨¡æ¿ï¼šæè¿°ä¸»é¢˜çš„åº”ç”¨ </span></span><br><span class="line">template = PromptTemplate(template= <span class="string">&quot;è¯·ç®€è¦æè¿°&#123;topic&#125;çš„åº”ç”¨ã€‚&quot;</span> , input_variables=[ <span class="string">&quot;topic&quot;</span> ]) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (template)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯</span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(topic= <span class="string">&quot;æœºå™¨å­¦ä¹ &quot;</span> ) </span><br><span class="line">prompt_2 = template.<span class="built_in">format</span>(topic= <span class="string">&quot;è‡ªç„¶è¯­è¨€å¤„ç†&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> ( <span class="string">&quot;æç¤ºè¯1:&quot;</span> , prompt_1) </span><br><span class="line"><span class="built_in">print</span> ( <span class="string">&quot;æç¤ºè¯2:&quot;</span> , prompt_2)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input_variables=[topic] input_types=&#123;&#125; partial_variables=&#123;&#125; template=è¯·ç®€è¦æè¿°&#123;topic&#125;çš„ åº”â½¤ã€‚&#x27; </span><br><span class="line">æâ½°è¯1: è¯·ç®€è¦æè¿°æœºå™¨å­¦ä¹ çš„åº”â½¤ã€‚ </span><br><span class="line">æâ½°è¯2: è¯·ç®€è¦æè¿°â¾ƒç„¶è¯­â¾”å¤„ç†çš„åº”â½¤ã€‚</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´è§‚çš„çœ‹åˆ°PromptTemplateå¯ä»¥å°†templateä¸­å£°æ˜çš„å˜é‡topicå‡†ç¡®æå–å‡ºæ¥ï¼Œä½¿promptæ›´æ¸…æ™°</p><h4 id="ä¸¾ä¾‹2ï¼šå®šä¹‰å¤šå˜é‡æ¨¡æ¿-æ¨è"><a href="#ä¸¾ä¾‹2ï¼šå®šä¹‰å¤šå˜é‡æ¨¡æ¿-æ¨è" class="headerlink" title="ä¸¾ä¾‹2ï¼šå®šä¹‰å¤šå˜é‡æ¨¡æ¿(æ¨è)"></a>ä¸¾ä¾‹2ï¼šå®šä¹‰å¤šå˜é‡æ¨¡æ¿(æ¨è)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#1ã€åˆ›å»ºPromptTemplateçš„å®ä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(template=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ª&#123;role&#125;,ä½ çš„åå­—å«&#123;name&#125;&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># print(prompt_template)  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#2ã€å¡«å……å®ä¾‹ä¸­çš„å˜é‡ã€‚æš‚ä¸”ä½¿ç”¨format()  </span></span><br><span class="line">prompt = prompt_template.<span class="built_in">format</span>(role=<span class="string">&quot;äººå·¥æ™ºèƒ½ä¸“å®¶&quot;</span>,name=<span class="string">&quot;å°æ™º&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½ä¸“å®¶,ä½ çš„åå­—å«å°æ™º</span><br></pre></td></tr></table></figure><p>å¦‚æœæç¤ºè¯æ¨¡æ¿ä¸­ä¸åŒ…å«å˜é‡ï¼Œåˆ™è°ƒç”¨format()æ—¶ï¼Œä¸éœ€è¦ä¼ å…¥å‚æ•°ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥ç›¸å…³çš„åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆå¯¹è±¡  </span></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">Tell me a joke  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line">prompt_template = PromptTemplate.from_template(text)  </span><br><span class="line"><span class="comment"># 3.é»˜è®¤ä½¿ç”¨f-stringè¿›è¡Œæ ¼å¼åŒ–ï¼ˆè¿”å›æ ¼å¼å¥½çš„å­—ç¬¦ä¸²ï¼‰  </span></span><br><span class="line">prompt = prompt_template.<span class="built_in">format</span>()  </span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tell me a joke  </span><br></pre></td></tr></table></figure><h3 id="ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼"><a href="#ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼" class="headerlink" title="ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼"></a>ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼</h3><h4 id="å½¢å¼1ï¼šéƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ"><a href="#å½¢å¼1ï¼šéƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ" class="headerlink" title="å½¢å¼1ï¼šéƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ"></a>å½¢å¼1ï¼šéƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ</h4><p>åœ¨ç”Ÿæˆpromptå‰å°±å·²ç»æå‰åˆå§‹åŒ–éƒ¨åˆ†çš„æç¤ºè¯ï¼Œå®é™…è¿›ä¸€æ­¥å¯¼å…¥æ¨¡ç‰ˆçš„æ—¶å€™åªå¯¼å…¥é™¤å·²åˆå§‹åŒ–çš„å˜é‡ å³å¯ã€‚</p><p>ä¸¾ä¾‹1ï¼š<br>æ–¹å¼1ï¼šå®ä¾‹åŒ–è¿‡ç¨‹ä¸­ä½¿ç”¨partial_variableså˜é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_1)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;product&quot;</span>, <span class="string">&quot;aspect1&quot;</span>, <span class="string">&quot;aspect2&quot;</span>],  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,<span class="string">&quot;aspect2&quot;</span>:<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure><h4 id="æ–¹å¼2ï¼šè°ƒç”¨æ–¹æ³•partial"><a href="#æ–¹å¼2ï¼šè°ƒç”¨æ–¹æ³•partial" class="headerlink" title="æ–¹å¼2ï¼šè°ƒç”¨æ–¹æ³•partial()"></a>æ–¹å¼2ï¼šè°ƒç”¨æ–¹æ³•partial()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;product&quot;</span>, <span class="string">&quot;aspect1&quot;</span>, <span class="string">&quot;aspect2&quot;</span>],  </span><br><span class="line">    <span class="comment"># partial_variables=&#123;&quot;aspect1&quot;:&quot;ç”µæ± ç»­èˆª&quot;,&quot;aspect2&quot;:&quot;æ‹ç…§è´¨é‡&quot;&#125;  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># partial()è°ƒç”¨å®Œä»¥åï¼Œä¸ä¼šå¯¹è°ƒç”¨è€…è¿™ä¸ªæ¨¡æ¿å¯¹è±¡äº§ç”Ÿå½±å“ï¼›è€Œå…¶è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„æ¨¡æ¿  </span></span><br><span class="line">template1 = template.partial(aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template1.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;product&quot;</span>, <span class="string">&quot;aspect1&quot;</span>, <span class="string">&quot;aspect2&quot;</span>],  </span><br><span class="line">).partial(aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = (PromptTemplate  </span><br><span class="line">            .from_template(template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">            .partial(aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>))  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç»„åˆæç¤ºè¯çš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰"><a href="#ç»„åˆæç¤ºè¯çš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰" class="headerlink" title="ç»„åˆæç¤ºè¯çš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰"></a>ç»„åˆæç¤ºè¯çš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line">template = (  </span><br><span class="line">    PromptTemplate.from_template(template = <span class="string">&quot;Tell me a joke about &#123;topic&#125;&quot;</span>)  </span><br><span class="line">    + <span class="string">&quot;, make it funny&quot;</span>  </span><br><span class="line">    + <span class="string">&quot;\n\nand in &#123;language&#125;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt = template.<span class="built_in">format</span>(topic=<span class="string">&quot;sports&quot;</span>, language=<span class="string">&quot;spanish&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tell me a joke about sports, make it funny</span><br><span class="line"></span><br><span class="line">and in spanish</span><br></pre></td></tr></table></figure><h2 id="ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼ï¼šformat-invoke"><a href="#ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼ï¼šformat-invoke" class="headerlink" title="ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼ï¼šformat() &#x2F; invoke()"></a>ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼ï¼šformat() &#x2F; invoke()</h2><p>format() : å‚æ•°éƒ¨åˆ†ï¼šç»™å˜é‡èµ‹å€¼;     è¿”å›å€¼ï¼šstrç±»å‹  </p><p>invoke() : å‚æ•°éƒ¨åˆ†ï¼šä½¿ç”¨çš„æ˜¯å­—å…¸;     è¿”å›å€¼ï¼šPromptValueç±»å‹   â€”æ¨èï¼  </p><p>ä¸¾ä¾‹ï¼šè°ƒç”¨format()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>, aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>, aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_1)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(prompt_1))</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹ï¼šè°ƒç”¨invoke()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line"><span class="comment"># prompt_1 = template.format(product=&quot;æ™ºèƒ½æ‰‹æœº&quot;, aspect1=&quot;ç”µæ± ç»­èˆª&quot;, aspect2=&quot;æ‹ç…§è´¨é‡&quot;)  </span></span><br><span class="line">prompt_1 = template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;product&quot;</span>:<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>,<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,<span class="string">&quot;aspect2&quot;</span>:<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_1)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(prompt_1))  <span class="comment">#è¿”å›å€¼ç±»å‹ï¼šPromptValue</span></span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">text=&#x27;è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚&#x27;</span><br><span class="line">&lt;class &#x27;langchain_core.prompt_values.StringPromptValue&#x27;&gt;</span><br></pre></td></tr></table></figure><h2 id="ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨"><a href="#ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨" class="headerlink" title="ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨"></a>ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&#x27;deepseek-ai/DeepSeek-V3&#x27;</span>,  </span><br><span class="line">    max_tokens=<span class="number">500</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç”Ÿæˆæç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç»™æ¨¡æ¿çš„å˜é‡èµ‹å€¼  </span></span><br><span class="line">prompt = template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;product&quot;</span>:<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>,<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,<span class="string">&quot;aspect2&quot;</span>:<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è°ƒç”¨å¤§æ¨¡å‹ï¼Œå°†æç¤ºè¯ä¼ å…¥  </span></span><br><span class="line">response= chat_model.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;æ™ºèƒ½æ‰‹æœºå·²æˆä¸ºç°ä»£ç”Ÿæ´»çš„æ ¸å¿ƒå·¥å…·ï¼Œå…¶ä¼˜ç¼ºç‚¹åœ¨ä¸åŒåœºæ™¯ä¸‹è¡¨ç°å„å¼‚ï¼Œå°¤å…¶åœ¨ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡è¿™ä¸¤ä¸ªç”¨æˆ·æœ€å…³æ³¨çš„æ–¹é¢å°¤ä¸ºæ˜æ˜¾ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š\n\n---\n\n### **ä¸€ã€ä¼˜ç‚¹**\n1. **æ‹ç…§è´¨é‡**  \n   - **æŠ€æœ¯çªç ´**ï¼šå¤šæ‘„åƒå¤´ç³»ç»Ÿï¼ˆè¶…å¹¿è§’ã€é•¿ç„¦ã€å¾®è·ï¼‰ã€å¤§åº•ä¼ æ„Ÿå™¨ã€è®¡ç®—æ‘„å½±ï¼ˆå¦‚å¤œæ™¯æ¨¡å¼ã€HDRï¼‰è®©æ‰‹æœºæ‘„å½±æ¥è¿‘ä¸“ä¸šè®¾å¤‡æ°´å¹³ã€‚  \n   - **AIä¼˜åŒ–**ï¼šè‡ªåŠ¨åœºæ™¯è¯†åˆ«ã€äººåƒè™šåŒ–ç®—æ³•ã€å®æ—¶æ»¤é•œå¤§å¤§é™ä½ç”¨æˆ·æ“ä½œé—¨æ§›ã€‚  \n   - **ä¾¿æºæ€§**ï¼šç›¸æ¯”å•åç›¸æœºï¼Œæ‰‹æœºèƒ½éšæ—¶éšåœ°æ•æ‰ç”»é¢ï¼Œé€‚åˆæ—¥å¸¸è®°å½•å’Œç¤¾äº¤åª’ä½“åˆ†äº«ã€‚\n\n2. **å…¶ä»–æ ¸å¿ƒä¼˜åŠ¿**  \n   - **å¤šåŠŸèƒ½æ•´åˆ**ï¼šé€šè®¯ã€æ”¯ä»˜ã€å¯¼èˆªã€å¨±ä¹ä¸€ä½“åŒ–ï¼Œå‡å°‘æºå¸¦å¤šç§è®¾å¤‡çš„éº»çƒ¦ã€‚  \n   - **é«˜æ€§èƒ½å¤„ç†å™¨**ï¼šæµç•…è¿è¡Œå¤§å‹åº”ç”¨å’Œæ¸¸æˆï¼Œ5Gç½‘ç»œæå‡å®æ—¶äº¤äº’ä½“éªŒã€‚  \n   - **ç”Ÿæ€äº’è”**ï¼šä¸æ™ºèƒ½å®¶å±…ã€ç©¿æˆ´è®¾å¤‡æ— ç¼è¿æ¥ï¼ˆå¦‚Appleç”Ÿæ€ã€åä¸ºé¸¿è’™ï¼‰ã€‚\n\n---\n\n### **äºŒã€ç¼ºç‚¹**\n1. **ç”µæ± ç»­èˆª**  \n   - **ç¡¬ä»¶ç“¶é¢ˆ**ï¼šå±å¹•é«˜åˆ·æ–°ç‡ï¼ˆ120Hz+ï¼‰ã€5Gç½‘ç»œã€é«˜æ€§èƒ½èŠ¯ç‰‡åŠ å‰§è€—ç”µï¼Œé‡åº¦ä½¿ç”¨éœ€æ¯æ—¥1-2å……ã€‚  \n   - **å……ç”µä¾èµ–**ï¼šå¿«å……æŠ€æœ¯ï¼ˆå¦‚200Wï¼‰ç¼©çŸ­å……ç”µæ—¶é—´ï¼Œä½†é¢‘ç¹å……ç”µä»å¯èƒ½åŠ é€Ÿç”µæ± è€åŒ–ï¼ˆ2å¹´åå®¹é‡æ˜¾è‘—ä¸‹é™ï¼‰ã€‚  \n   - **ä½¿ç”¨åœºæ™¯é™åˆ¶**ï¼šæˆ·å¤–æ´»åŠ¨æˆ–é•¿é€”æ—…è¡Œæ—¶ï¼Œè‹¥æ— ç”µæºéœ€ä¾èµ–å……ç”µå®ã€‚\n\n2. **æ‹ç…§çš„å±€é™æ€§**  \n   - **ç¡¬ä»¶å¤©èŠ±æ¿**ï¼šå°å°ºå¯¸ä¼ æ„Ÿå™¨åœ¨æš—å…‰ç¯å¢ƒä¸‹å™ªç‚¹æ˜æ˜¾ï¼Œå…‰å­¦å˜ç„¦èŒƒå›´æœ‰é™ï¼ˆä¸»æµæœºå‹ä»…3-5å€æ— æŸå˜ç„¦ï¼‰ã€‚  \n   - **ç®—æ³•ç—•è¿¹**ï¼šè¿‡åº¦é”åŒ–æˆ–AIç¾åŒ–å¯èƒ½å¯¼è‡´ç…§ç‰‡å¤±çœŸï¼ˆå¦‚è™šå‡çš„å¤©ç©ºå¢å¼ºï¼‰ã€‚  \n   - **ä¸“ä¸šåŠŸèƒ½ç¼ºå¤±**ï¼šæ‰‹åŠ¨è°ƒèŠ‚å‚æ•°ï¼ˆå¦‚å¿«é—¨é€Ÿåº¦ã€RAWæ ¼å¼ï¼‰ä¸å¦‚ä¸“ä¸šç›¸æœºç›´è§‚ã€‚\n\n3. **å…¶ä»–é—®é¢˜**  \n   - **éšç§é£é™©**ï¼šæ‘„åƒå¤´æƒé™æ»¥ç”¨å¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€‚  \n   - **ä»·æ ¼åˆ†å±‚**ï¼šé«˜ç«¯æœºå‹ï¼ˆå¦‚iPhone Proã€ä¸‰æ˜ŸUltraï¼‰ä¸ä¸­ä½ç«¯æœºæ‹ç…§æ€§èƒ½å·®è·æ˜¾è‘—ã€‚\n\n---\n\n### **ä¸‰ã€å¹³è¡¡ä¸å»ºè®®**\n- **é€‰è´­ç­–ç•¥**ï¼š  \n  - æ³¨é‡ç»­èˆªï¼šé€‰æ‹©ç”µæ± â‰¥5000mAh + ä½åŠŸè€—èŠ¯ç‰‡ï¼ˆå¦‚å¤©ç‘9000ï¼‰çš„æœºå‹ã€‚  \n  - è¿½æ±‚æ‹ç…§ï¼šä¼˜å…ˆè€ƒè™‘å¤§åº•ä¸»æ‘„ï¼ˆå¦‚1è‹±å¯¸ä¼ æ„Ÿå™¨ï¼‰+ å…‰å­¦é˜²æŠ–çš„æ——èˆ°æœºã€‚  \n- **ä½¿ç”¨æŠ€å·§**ï¼šå…³é—­åå°é«˜è€—ç”µåº”ç”¨ã€ä½¿ç”¨ä¼˜åŒ–æ‹æ‘„æ¨¡å¼ï¼ˆå¦‚æ‰‹åŠ¨å¤œæ™¯ï¼‰ï¼Œå¯éƒ¨åˆ†å¼¥è¡¥çŸ­æ¿ã€‚\n\n---\n\n### **æ€»ç»“**  \næ™ºèƒ½æ‰‹æœºåœ¨ä¾¿æºæ€§ä¸åŠŸèƒ½æ•´åˆä¸Šæ— å¯æ›¿ä»£ï¼Œä½†ç”µæ± å’Œæ‹ç…§ä»å—ç‰©ç†é™åˆ¶ã€‚æœªæ¥éšç€å›ºæ€ç”µæ± ã€æŠ˜å å±å’Œæ›´å…ˆè¿›çš„AIç®—æ³•å‘å±•ï¼Œè¿™äº›ç—›ç‚¹æˆ–é€æ­¥æ”¹å–„ã€‚ç”¨æˆ·éœ€æ ¹æ®éœ€æ±‚æƒè¡¡ï¼Œè€Œéä¸€å‘³è¿½æ±‚å‚æ•°ã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 625, <span class="string">&#x27;prompt_tokens&#x27;</span>: 16, <span class="string">&#x27;total_tokens&#x27;</span>: 641, <span class="string">&#x27;completion_tokens_details&#x27;</span>: None, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: None&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;deepseek-ai/DeepSeek-V3&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;019994251555f311e62f227a7a7913d8&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--f2f96594-7c48-4ed5-8970-49aa051748fa-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 16, <span class="string">&#x27;output_tokens&#x27;</span>: 625, <span class="string">&#x27;total_tokens&#x27;</span>: 641, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;&#125;&#125;</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.messages.ai.AIMessage&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="å…·ä½“ä½¿ç”¨ï¼šChatPromptTemplate"><a href="#å…·ä½“ä½¿ç”¨ï¼šChatPromptTemplate" class="headerlink" title="å…·ä½“ä½¿ç”¨ï¼šChatPromptTemplate"></a>å…·ä½“ä½¿ç”¨ï¼šChatPromptTemplate</h2><p>1ã€å®ä¾‹åŒ–çš„æ–¹å¼ï¼ˆä¸¤ç§æ–¹å¼ï¼šä½¿ç”¨æ„é€ æ–¹æ³•ã€from_messages()ï¼‰  </p><p>2ã€è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•ï¼šinvoke() \ format() \ format_messages() \ format_prompt()  </p><p>3ã€æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹  </p><p>4ã€ç»“åˆLLM  </p><p>5ã€æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder  </p><h3 id="å®ä¾‹åŒ–çš„æ–¹å¼"><a href="#å®ä¾‹åŒ–çš„æ–¹å¼" class="headerlink" title="å®ä¾‹åŒ–çš„æ–¹å¼"></a>å®ä¾‹åŒ–çš„æ–¹å¼</h3><p>æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, MessagesPlaceholder  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate(  </span><br><span class="line">    messages=[  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ],  </span><br><span class="line">    input_variables=[<span class="string">&quot;name&quot;</span>, <span class="string">&quot;question&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(response.messages))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br><span class="line">2</span><br></pre></td></tr></table></figure><p>æ›´ç®€æ´çš„æ–¹å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(response.messages))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br><span class="line">2</span><br></pre></td></tr></table></figure><h3 id="è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•"><a href="#è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•" class="headerlink" title="è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•"></a>è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•</h3><p>invoke() \ format() \ format_messages() \ format_prompt()  </p><p>invoke()ï¼šä¼ å…¥çš„æ˜¯å­—å…¸ï¼Œè¿”å›ChatPromptValue  </p><p>format():ä¼ å…¥å˜é‡çš„å€¼ï¼Œè¿”å›str  </p><p>format_messages(): ä¼ å…¥å˜é‡çš„å€¼ï¼Œè¿”å›æ¶ˆæ¯æ„æˆçš„list  </p><p>format_prompt(): ä¼ å…¥å˜é‡çš„å€¼ï¼Œè¿”å›ChatPromptValue  </p><p><strong>ä¸¾ä¾‹1ï¼šinvoke()</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šformat()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.<span class="built_in">format</span>(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">System: ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º</span><br><span class="line">Human: æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ</span><br><span class="line">&lt;class <span class="string">&#x27;str&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3ï¼šformat_messages()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.format_messages(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#from langchain_core.prompts import ChatPromptTemplate  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.format_messages(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;list&#x27;&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;list&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><p><strong>ç»“è®º</strong>ï¼šç»™å ä½ç¬¦èµ‹å€¼ï¼Œé’ˆå¯¹äºChatPromptTemplateï¼Œæ¨èä½¿ç”¨<code>format_messages()</code>æ–¹æ³•ï¼Œè¿”å›æ¶ˆæ¯åˆ— è¡¨ã€‚</p><p>ä¸¾ä¾‹4ï¼šformat_prompt()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.format_prompt(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹"><a href="#æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹" class="headerlink" title="æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹"></a>æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹</h2><p>æœ¬è´¨ï¼šä¸ç®¡ä½¿ç”¨æ„é€ æ–¹æ³•ã€è¿˜æ˜¯ä½¿ç”¨from_message()æ¥åˆ›å»ºChatPromptTemplateçš„å®ä¾‹ï¼Œæœ¬è´¨ä¸Šæ¥è®²ï¼Œä¼ å…¥çš„éƒ½æ˜¯æ¶ˆæ¯æ„æˆçš„åˆ—è¡¨ã€‚</p><p>ä»è°ƒç”¨ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œä¸ç®¡ä½¿ç”¨æ„é€ æ–¹æ³•ï¼Œè¿˜æ˜¯ä½¿ç”¨from_message()ï¼Œmessageså‚æ•°çš„ç±»å‹éƒ½æ˜¯åˆ—è¡¨ï¼Œä½†æ˜¯åˆ—è¡¨çš„å…ƒç´ çš„ç±»å‹æ˜¯å¤šæ ·çš„ã€‚å…ƒç´ å¯ä»¥æ˜¯ï¼š</p><p>å­—ç¬¦ä¸²ç±»å‹ã€å­—å…¸ç±»å‹ã€æ¶ˆæ¯ç±»å‹ã€å…ƒç»„æ„æˆçš„åˆ—è¡¨ï¼ˆæœ€å¸¸ç”¨ã€æœ€åŸºç¡€ã€æœ€ç®€å•ï¼‰ã€Chatæç¤ºè¯æ¨¡æ¿ç±»å‹ã€æ¶ˆæ¯æç¤ºè¯æ¨¡æ¿ç±»å‹</p><p>ä¸¾ä¾‹1ï¼šå…ƒç»„æ„æˆçš„åˆ—è¡¨ï¼ˆæœ€å¸¸ç”¨ã€æœ€åŸºç¡€ã€æœ€ç®€å•ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line"><span class="comment">#ç¬¬1ç§æ–¹å¼  </span></span><br><span class="line">chat_prompt_template1 = ChatPromptTemplate(  </span><br><span class="line">    messages=[  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line"><span class="comment">#ç¬¬2ç§æ–¹å¼  </span></span><br><span class="line">chat_prompt_template2 = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line">response = chat_prompt_template1.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šå­—ç¬¦ä¸²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>  <span class="comment">#é»˜è®¤çš„è§’è‰²æ˜¯ï¼šhuman !  </span></span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">messages=[HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3ï¼šå­—å…¸ç±»å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;human&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>&#125;,  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹4ï¼šæ¶ˆæ¯ç±»å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># response = chat_prompt_template.invoke(&#123;&quot;name&quot;:&quot;å°æ™º&quot;, &quot;question&quot;:&quot;1 + 2 * 3 = ï¼Ÿ&quot;&#125;)  </span></span><br><span class="line">response = chat_prompt_template.invoke(&#123;&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹5ï¼šChatæç¤ºè¯æ¨¡æ¿ç±»å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ä½¿ç”¨ BaseChatPromptTemplateï¼ˆåµŒå¥—çš„ ChatPromptTemplateï¼‰  </span></span><br><span class="line">nested_prompt_template1 = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">nested_prompt_template2 = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ ,æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    nested_prompt_template1,  </span><br><span class="line">    nested_prompt_template2  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">prompt_template.format_messages(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆå¸…ï¼Ÿ&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;),</span><br><span class="line"> HumanMessage(content=<span class="string">&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ ,æˆ‘çš„é—®é¢˜æ˜¯ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆå¸…ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹6ï¼šæ¶ˆæ¯æç¤ºè¯æ¨¡æ¿ç±»å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥èŠå¤©æ¶ˆæ¯ç±»æ¨¡æ¿  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, HumanMessagePromptTemplate, SystemMessagePromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæ¶ˆæ¯æ¨¡æ¿  </span></span><br><span class="line">system_template = <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸“å®¶&#123;role&#125;&quot;</span>  </span><br><span class="line">system_message_prompt = SystemMessagePromptTemplate.from_template(system_template)  </span><br><span class="line">  </span><br><span class="line">human_template = <span class="string">&quot;ç»™æˆ‘è§£é‡Š&#123;concept&#125;ï¼Œç”¨æµ…æ˜¾æ˜“æ‡‚çš„è¯­è¨€&quot;</span>  </span><br><span class="line">human_message_prompt = HumanMessagePromptTemplate.from_template(human_template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç»„åˆæˆèŠå¤©æç¤ºæ¨¡æ¿  </span></span><br><span class="line">chat_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    system_message_prompt, human_message_prompt  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ ¼å¼åŒ–æç¤º  </span></span><br><span class="line">formatted_messages = chat_prompt.format_messages(  </span><br><span class="line">    role=<span class="string">&quot;ç‰©ç†å­¦å®¶&quot;</span>,  </span><br><span class="line">    concept=<span class="string">&quot;ç›¸å¯¹è®º&quot;</span>  </span><br><span class="line">)  </span><br><span class="line"><span class="built_in">print</span>(formatted_messages)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªä¸“å®¶ç‰©ç†å­¦å®¶&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;ç»™æˆ‘è§£é‡Šç›¸å¯¹è®ºï¼Œç”¨æµ…æ˜¾æ˜“æ‡‚çš„è¯­è¨€&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><h2 id="ç»“åˆLLM"><a href="#ç»“åˆLLM" class="headerlink" title="ç»“åˆLLM"></a>ç»“åˆLLM</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ã€æä¾›å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;gpt-4o-mini&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€é€šè¿‡Chatæç¤ºè¯æ¨¡æ¿ï¼Œåˆ›å»ºæç¤ºè¯  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">prompt_response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€é€šè¿‡å¤§æ¨¡å‹è°ƒç”¨æç¤ºè¯ï¼Œå¾—åˆ°å“åº”æ•°æ®  </span></span><br><span class="line">response = chat_model.invoke(prompt_response)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;æ ¹æ®è¿ç®—é¡ºåºï¼Œé¦–å…ˆè®¡ç®—ä¹˜æ³•ï¼Œå†è®¡ç®—åŠ æ³•ã€‚\n\næ‰€ä»¥ï¼š\n1 + 2 * 3 = 1 + 6 = 7\n\nç­”æ¡ˆæ˜¯7ã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 39, <span class="string">&#x27;prompt_tokens&#x27;</span>: 35, <span class="string">&#x27;total_tokens&#x27;</span>: 74, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7eyBoZ4oBRoEYb1BzgWYfqXZvJQA&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--ee6524a9-9df4-4058-9220-99e86e13ec84-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 35, <span class="string">&#x27;output_tokens&#x27;</span>: 39, <span class="string">&#x27;total_tokens&#x27;</span>: 74, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder"><a href="#æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder" class="headerlink" title="æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder"></a>æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder</h2><p>ä½¿ç”¨åœºæ™¯ï¼šå½“ChatPromptTemplatemæ¨¡æ¿ä¸­çš„æ¶ˆæ¯ç±»å‹å’Œä¸ªæ•°ä¸ç¡®å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨MessagePlaceholderã€‚  </p><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.chat <span class="keyword">import</span> MessagesPlaceholder  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    MessagesPlaceholder(variable_name=<span class="string">&quot;msgs&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template.invoke(&#123;  </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;msgs&quot;</span>: [HumanMessage(content=<span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&quot;</span>)]  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ChatPromptValue(messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)])</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> AIMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.chat <span class="keyword">import</span> MessagesPlaceholder  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    MessagesPlaceholder(variable_name=<span class="string">&quot;msgs&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template.invoke(&#123;  </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;msgs&quot;</span>: [HumanMessage(content=<span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&quot;</span>),AIMessage(content=<span class="string">&quot;1 + 2 * 3 = 7&quot;</span>)]  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ChatPromptValue(messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;1 + 2 * 3 = 7&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)])</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3ï¼šå­˜å‚¨å¯¹è¯å†å²è®°å½•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, MessagesPlaceholder  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> AIMessage  </span><br><span class="line">  </span><br><span class="line">prompt = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;You are a helpful assistant.&quot;</span>),  </span><br><span class="line">        MessagesPlaceholder(<span class="string">&quot;history&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt_value = prompt.format_messages(  </span><br><span class="line">    history=[HumanMessage(content=<span class="string">&quot;1+2*3 = ?&quot;</span>),AIMessage(content=<span class="string">&quot;1+2*3=7&quot;</span>)],  </span><br><span class="line">    question=<span class="string">&quot;æˆ‘åˆšæ‰é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_value)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># prompt.invoke(  </span></span><br><span class="line"><span class="comment">#     &#123;  </span></span><br><span class="line"><span class="comment">#         &quot;history&quot;: [(&quot;human&quot;, &quot;what&#x27;s 5 + 2&quot;), (&quot;ai&quot;, &quot;5 + 2 is 7&quot;)],  </span></span><br><span class="line"><span class="comment">#         &quot;question&quot;: &quot;now multiply that by 4&quot;  </span></span><br><span class="line"><span class="comment">#     &#125;  </span></span><br><span class="line"><span class="comment"># )</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;You are a helpful assistant.&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;1+2*3 = ?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;1+2*3=7&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘åˆšæ‰é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;gpt-4o-mini&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chat_model.invoke(prompt_value)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=<span class="string">&#x27;ä½ åˆšæ‰é—®çš„é—®é¢˜æ˜¯â€œ1+2*3 = ?â€ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œç»“æœæ˜¯7ï¼Œå› ä¸ºæŒ‰ç…§è¿ç®—é¡ºåºï¼Œå…ˆè®¡ç®—ä¹˜æ³•ï¼Œå†è®¡ç®—åŠ æ³•ã€‚&#x27;</span>, additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125;, response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 41, <span class="string">&#x27;prompt_tokens&#x27;</span>: 45, <span class="string">&#x27;total_tokens&#x27;</span>: 86, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7fAHDJiMfEZ4RyHo5lZ7sEOIDE1G&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125;, <span class="built_in">id</span>=<span class="string">&#x27;run--45d7ab91-e19d-417b-b026-00a5f070ff04-0&#x27;</span>, usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 45, <span class="string">&#x27;output_tokens&#x27;</span>: 41, <span class="string">&#x27;total_tokens&#x27;</span>: 86, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;)</span><br></pre></td></tr></table></figure><h1 id="å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨"><a href="#å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨" class="headerlink" title="å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨"></a>å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨</h1><h2 id="ä½¿ç”¨è¯´æ˜-1"><a href="#ä½¿ç”¨è¯´æ˜-1" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h2><p>åœ¨æ„å»ºpromptæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„å»ºä¸€ä¸ª å°‘é‡ç¤ºä¾‹åˆ—è¡¨å»è¿›ä¸€æ­¥æ ¼å¼åŒ–promptï¼Œè¿™æ˜¯ä¸€ç§ç®€å•ä½†å¼ºå¤§çš„æŒ‡ å¯¼ç”Ÿæˆçš„æ–¹å¼ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥ æ˜¾è‘—æé«˜æ¨¡å‹æ€§èƒ½ã€‚ å°‘é‡ç¤ºä¾‹æç¤ºæ¨¡æ¿å¯ä»¥ç”± ä¸€ç»„ç¤ºä¾‹æˆ–ä¸€ä¸ªè´Ÿè´£ä»å®šä¹‰çš„é›†åˆä¸­é€‰æ‹© </p><ul><li>å‰è€…ï¼šä½¿ç”¨ ä¸€éƒ¨åˆ†ç¤ºä¾‹çš„ç¤ºä¾‹é€‰æ‹©å™¨æ„å»ºã€‚ FewShotPromptTemplate æˆ– FewShotChatMessagePromptTemplate </li><li>åè€…ï¼šä½¿ç”¨ Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨) æ¯ä¸ªç¤ºä¾‹çš„ç»“æ„éƒ½æ˜¯ä¸€ä¸ª å­—å…¸ï¼Œå…¶ä¸­é”®æ˜¯è¾“å…¥å˜é‡ï¼Œå€¼æ˜¯è¾“å…¥å˜é‡çš„å€¼ã€‚</li></ul><p>ä½“ä¼šï¼šzeroshotä¼šå¯¼è‡´ä½è´¨é‡å›</p><p>FewShotPromptTemplate: ä¸PromptTemplateä¸€èµ·ä½¿ç”¨  </p><p>FewShotChatMessagePromptTemplate:ä¸ChatPromptTemplateä¸€èµ·ä½¿ç”¨  </p><p>Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨):  </p><h2 id="FewShotPromptTemplateçš„ä½¿ç”¨"><a href="#FewShotPromptTemplateçš„ä½¿ç”¨" class="headerlink" title="FewShotPromptTemplateçš„ä½¿ç”¨"></a>FewShotPromptTemplateçš„ä½¿ç”¨</h2><p>ä¸¾ä¾‹1ï¼šæœªæä¾›ç¤ºä¾‹çš„æƒ…å†µ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> FewShotPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>,  </span><br><span class="line">                        temperature=<span class="number">0.4</span>)  </span><br><span class="line">  </span><br><span class="line">res = chat_model.invoke(<span class="string">&quot;2 ğŸ¦œ 9æ˜¯å¤šå°‘?&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(res.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2 ğŸ¦œ 9 çš„æ„æ€å¯èƒ½ä¸å¤ªæ˜ç¡®ã€‚å¦‚æœä½ æ˜¯åœ¨é—® 2 å’Œ 9 çš„æ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•æˆ–é™¤æ³•ï¼Œè¯·å‘Šè¯‰æˆ‘å…·ä½“çš„è¿ç®—æ–¹å¼ã€‚å¦‚æœæ˜¯å…¶ä»–æ„æ€ï¼Œè¯·æä¾›æ›´å¤šçš„ä¸Šä¸‹æ–‡ã€‚</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šä½¿ç”¨FewShotPromptTemplate</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºPromptTemplateçš„å®ä¾‹  </span></span><br><span class="line">example_prompt = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;input:&#123;input&#125;\noutput:&#123;output&#125;&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æä¾›ä¸€äº›ç¤ºä¾‹  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;åŒ—äº¬å¸‚&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å—äº¬ä¸‹é›¨å—&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;å—äº¬å¸‚&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æ­¦æ±‰çƒ­å—&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ­¦æ±‰å¸‚&quot;</span>&#125;  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºFewShotPromptTemplateçš„å®ä¾‹  </span></span><br><span class="line">few_shot_template = FewShotPromptTemplate(  </span><br><span class="line">    example_prompt=example_prompt,  </span><br><span class="line">    examples = examples,  </span><br><span class="line">    suffix=<span class="string">&quot;input:&#123;input&#125;\noutput:&quot;</span>,   <span class="comment">#å£°æ˜åœ¨ç¤ºä¾‹åé¢çš„æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">    input_variables=[<span class="string">&quot;input&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">few_shot_template.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;å¤©æ´¥ä¼šä¸‹é›¨å—ï¼Ÿ&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringPromptValue(text=<span class="string">&#x27;input:åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·\noutput:åŒ—äº¬å¸‚\n\ninput:å—äº¬ä¸‹é›¨å—\noutput:å—äº¬å¸‚\n\ninput:æ­¦æ±‰çƒ­å—\noutput:æ­¦æ±‰å¸‚\n\ninput:å¤©æ´¥ä¼šä¸‹é›¨å—ï¼Ÿ\noutput:&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è°ƒç”¨å¤§æ¨¡å‹ä»¥åï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)</span><br><span class="line"></span><br><span class="line">chat_model.invoke(few_shot_template.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;å¤©æ´¥ä¼šä¸‹é›¨å—ï¼Ÿ&quot;</span>&#125;))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=<span class="string">&#x27;å¤©æ´¥å¸‚&#x27;</span>, additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125;, response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 3, <span class="string">&#x27;prompt_tokens&#x27;</span>: 50, <span class="string">&#x27;total_tokens&#x27;</span>: 53, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C8Mbv1EY0HWqyBA7NsTDDRlCgsyLj&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125;, <span class="built_in">id</span>=<span class="string">&#x27;run--e663e04c-3bee-4b37-b2f8-eca41d7bff07-0&#x27;</span>, usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 50, <span class="string">&#x27;output_tokens&#x27;</span>: 3, <span class="string">&#x27;total_tokens&#x27;</span>: 53, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;)</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€åˆ›å»ºæç¤ºæ¨¡æ¿  </span></span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæç¤ºæ¨¡æ¿ï¼Œé…ç½®ä¸€ä¸ªæç¤ºæ¨¡æ¿ï¼Œå°†ä¸€ä¸ªç¤ºä¾‹æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²  </span></span><br><span class="line">prompt_template = <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦ä¸“å®¶,ç®—å¼ï¼š &#123;input&#125; å€¼ï¼š &#123;output&#125; ä½¿ç”¨ï¼š &#123;description&#125; &quot;</span>  </span><br><span class="line"><span class="comment"># è¿™æ˜¯ä¸€ä¸ªæç¤ºæ¨¡æ¿ï¼Œç”¨äºè®¾ç½®æ¯ä¸ªç¤ºä¾‹çš„æ ¼å¼  </span></span><br><span class="line">prompt_sample = PromptTemplate.from_template(prompt_template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#2ã€æä¾›ç¤ºä¾‹  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;2+2&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;4&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;åŠ æ³•è¿ç®—&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;5-2&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;3&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;å‡æ³•è¿ç®—&quot;</span>&#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#3ã€åˆ›å»ºä¸€ä¸ªFewShotPromptTemplateå¯¹è±¡  </span></span><br><span class="line"><span class="keyword">from</span> langchain.prompts.few_shot <span class="keyword">import</span> FewShotPromptTemplate  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">prompt = FewShotPromptTemplate(  </span><br><span class="line">    examples=examples,  </span><br><span class="line">    example_prompt=prompt_sample,  </span><br><span class="line">    suffix=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦ä¸“å®¶,ç®—å¼: &#123;input&#125;  å€¼: &#123;output&#125;&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;input&quot;</span>, <span class="string">&quot;output&quot;</span>]  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># print(prompt.invoke(&#123;&quot;input&quot;:&quot;2*5&quot;, &quot;output&quot;:&quot;10&quot;&#125;))  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#4ã€åˆå§‹åŒ–å¤§æ¨¡å‹ï¼Œç„¶åè°ƒç”¨  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">result = chat_model.invoke(prompt.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;2*5&quot;</span>, <span class="string">&quot;output&quot;</span>:<span class="string">&quot;10&quot;</span>&#125;))  </span><br><span class="line"><span class="built_in">print</span>(result.content)  <span class="comment"># ä½¿ç”¨: ä¹˜æ³•è¿ç®—</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ï¼šä¹˜æ³•è¿ç®—</span><br><span class="line"></span><br><span class="line">ä½ æ˜¯ä¸€ä¸ªæ•°å­¦ä¸“å®¶,ç®—å¼ï¼š 10Ã·2 å€¼ï¼š 5 ä½¿ç”¨ï¼š é™¤æ³•è¿ç®—</span><br></pre></td></tr></table></figure><h2 id="FewShotChatMessagePromptTemplateçš„ä½¿ç”¨"><a href="#FewShotChatMessagePromptTemplateçš„ä½¿ç”¨" class="headerlink" title="FewShotChatMessagePromptTemplateçš„ä½¿ç”¨"></a>FewShotChatMessagePromptTemplateçš„ä½¿ç”¨</h2><p>é™¤äº†FewShotPromptTemplateä¹‹å¤–ï¼ŒFewShotChatMessagePromptTemplateæ˜¯ä¸“é—¨ä¸º <strong>èŠå¤©å¯¹è¯åœº æ™¯</strong> è®¾è®¡çš„å°‘æ ·æœ¬ï¼ˆfew-shotï¼‰æç¤ºæ¨¡æ¿ï¼Œå®ƒç»§æ‰¿è‡ª FewShotPromptTemplateï¼Œä½†é’ˆå¯¹èŠå¤©æ¶ˆæ¯çš„æ ¼ å¼è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>è‡ªåŠ¨å°†ç¤ºä¾‹æ ¼å¼åŒ–ä¸ºèŠå¤©æ¶ˆæ¯ï¼ˆHumanMessage&#x2F;AIMessage ç­‰ï¼‰ </li><li>è¾“å‡ºç»“æ„åŒ–èŠå¤©æ¶ˆæ¯ï¼ˆList[BaseMessage]ï¼‰ </li><li>ä¿ç•™å¯¹è¯è½®æ¬¡ç»“æ„</li></ul><p>ä¸¾ä¾‹1ï¼šå®ä¾‹åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> (  </span><br><span class="line">    FewShotChatMessagePromptTemplate,  </span><br><span class="line">    ChatPromptTemplate  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1.ç¤ºä¾‹æ¶ˆæ¯æ ¼å¼  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;1+1ç­‰äºå‡ ï¼Ÿ&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;1+1ç­‰äº2&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æ³•å›½çš„é¦–éƒ½æ˜¯ï¼Ÿ&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;å·´é»&quot;</span>&#125;  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ç¤ºä¾‹çš„æ¶ˆæ¯æ ¼å¼æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">msg_example_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;input&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;ai&quot;</span>, <span class="string">&quot;&#123;output&#125;&quot;</span>),  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰FewShotChatMessagePromptTemplateå¯¹è±¡  </span></span><br><span class="line">few_shot_prompt = FewShotChatMessagePromptTemplate(  </span><br><span class="line">    example_prompt=msg_example_prompt,  </span><br><span class="line">    examples=examples  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 4.è¾“å‡ºæ ¼å¼åŒ–åçš„æ¶ˆæ¯  </span></span><br><span class="line"><span class="built_in">print</span>(few_shot_prompt.<span class="built_in">format</span>())</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Human: 1+1ç­‰äºå‡ ï¼Ÿ</span><br><span class="line">AI: 1+1ç­‰äº2</span><br><span class="line">Human: æ³•å›½çš„é¦–éƒ½æ˜¯ï¼Ÿ</span><br><span class="line">AI: å·´é»</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> (FewShotChatMessagePromptTemplate, ChatPromptTemplate)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ç¤ºä¾‹ç»„  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;2ğŸ¦œ2&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;4&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;2ğŸ¦œ3&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;6&quot;</span>&#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ç¤ºä¾‹çš„æ¶ˆæ¯æ ¼å¼æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">example_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&#x27;human&#x27;</span>, <span class="string">&#x27;&#123;input&#125; æ˜¯å¤šå°‘?&#x27;</span>),  </span><br><span class="line">    (<span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;&#123;output&#125;&#x27;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰FewShotChatMessagePromptTemplateå¯¹è±¡  </span></span><br><span class="line">few_shot_prompt = FewShotChatMessagePromptTemplate(  </span><br><span class="line">    examples=examples,  <span class="comment"># ç¤ºä¾‹ç»„  </span></span><br><span class="line">    example_prompt=example_prompt,  <span class="comment"># ç¤ºä¾‹æç¤ºè¯è¯æ¨¡ç‰ˆ  </span></span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 5.è¾“å‡ºå®Œæ•´æç¤ºè¯çš„æ¶ˆæ¯æ¨¡ç‰ˆ  </span></span><br><span class="line">final_prompt = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦å¥‡æ‰&#x27;</span>),  </span><br><span class="line">        few_shot_prompt,  </span><br><span class="line">        (<span class="string">&#x27;human&#x27;</span>, <span class="string">&#x27;&#123;input&#125;&#x27;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#6.æä¾›å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>,  </span><br><span class="line">                        temperature=<span class="number">0.4</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model.invoke(final_prompt.invoke(<span class="built_in">input</span>=<span class="string">&quot;2ğŸ¦œ4&quot;</span>)).content</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;8&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Example-selectors-ç¤ºä¾‹é€‰æ‹©å™¨"><a href="#Example-selectors-ç¤ºä¾‹é€‰æ‹©å™¨" class="headerlink" title="Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨)"></a>Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨)</h2><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> Chroma  </span><br><span class="line"><span class="keyword">from</span> langchain_core.example_selectors <span class="keyword">import</span> SemanticSimilarityExampleSelector  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">embeddings_model = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;text-embedding-ada-002&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ç¤ºä¾‹ç»„  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;è°æ´»å¾—æ›´ä¹…ï¼Œç©†ç½•é»˜å¾·Â·é˜¿é‡Œè¿˜æ˜¯è‰¾ä¼¦Â·å›¾çµ?&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šç©†ç½•é»˜å¾·Â·é˜¿é‡Œå»ä¸–æ—¶å¤šå¤§å¹´çºªï¼Ÿ  </span></span><br><span class="line"><span class="string">        ä¸­é—´ç­”æ¡ˆï¼šç©†ç½•é»˜å¾·Â·é˜¿é‡Œå»ä¸–æ—¶äº«å¹´74å²ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;craigslistçš„åˆ›å§‹äººæ˜¯ä»€ä¹ˆæ—¶å€™å‡ºç”Ÿçš„ï¼Ÿ&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šè°æ˜¯craigslistçš„åˆ›å§‹äººï¼Ÿ  </span></span><br><span class="line"><span class="string">        ä¸­çº§ç­”æ¡ˆï¼šCraigslistæ˜¯ç”±å…‹é›·æ ¼Â·çº½é©¬å…‹åˆ›ç«‹çš„ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;è°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„å¤–ç¥–çˆ¶ï¼Ÿ&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šè°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„æ¯äº²ï¼Ÿ  </span></span><br><span class="line"><span class="string">        ä¸­é—´ç­”æ¡ˆï¼šä¹”æ²»Â·åç››é¡¿çš„æ¯äº²æ˜¯ç›ä¸½Â·é²å°”Â·åç››é¡¿ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;ã€Šå¤§ç™½é²¨ã€‹å’Œã€Šçš‡å®¶èµŒåœºã€‹çš„å¯¼æ¼”éƒ½æ¥è‡ªåŒä¸€ä¸ªå›½å®¶å—ï¼Ÿ&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šã€Šå¤§ç™½é²¨ã€‹çš„å¯¼æ¼”æ˜¯è°ï¼Ÿ        ä¸­çº§ç­”æ¡ˆï¼šã€Šå¤§ç™½é²¨ã€‹çš„å¯¼æ¼”æ˜¯å²è’‚æ–‡Â·æ–¯çš®å°”ä¼¯æ ¼ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰ç¤ºä¾‹é€‰æ‹©å™¨  </span></span><br><span class="line">example_selector = SemanticSimilarityExampleSelector.from_examples(  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯å¯ä¾›é€‰æ‹©çš„ç¤ºä¾‹åˆ—è¡¨  </span></span><br><span class="line">    examples,  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯ç”¨äºç”ŸæˆåµŒå…¥çš„åµŒå…¥ç±»ï¼Œç”¨äºè¡¡é‡è¯­ä¹‰ç›¸ä¼¼æ€§  </span></span><br><span class="line">    embeddings_model,  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯ç”¨äºå­˜å‚¨åµŒå…¥å¹¶è¿›è¡Œç›¸ä¼¼æ€§æœç´¢çš„ VectorStore ç±»  </span></span><br><span class="line">    Chroma,  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯è¦ç”Ÿæˆçš„ç¤ºä¾‹æ•°é‡  </span></span><br><span class="line">    k=<span class="number">1</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é€‰æ‹©ä¸è¾“å…¥æœ€ç›¸ä¼¼çš„ç¤ºä¾‹  </span></span><br><span class="line">question = <span class="string">&quot;ç›ä¸½Â·é²å°”Â·åç››é¡¿çš„çˆ¶äº²æ˜¯è°?&quot;</span>  </span><br><span class="line">selected_examples = example_selector.select_examples(&#123;<span class="string">&quot;question&quot;</span>: question&#125;)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ä¸è¾“å…¥æœ€ç›¸ä¼¼çš„ç¤ºä¾‹ï¼š<span class="subst">&#123;selected_examples&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># for example in selected_examples:  </span></span><br><span class="line"><span class="comment">#     print(&quot;\n&quot;)  </span></span><br><span class="line"><span class="comment">#     for k, v in example.items():  </span></span><br><span class="line"><span class="comment">#         print(f&quot;&#123;k&#125;: &#123;v&#125;&quot;)</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸è¾“å…¥æœ€ç›¸ä¼¼çš„ç¤ºä¾‹ï¼š[&#123;<span class="string">&#x27;question&#x27;</span>: <span class="string">&#x27;è°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„å¤–ç¥–çˆ¶ï¼Ÿ&#x27;</span>, <span class="string">&#x27;answer&#x27;</span>: <span class="string">&#x27;\n        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ\n        è¿½é—®ï¼šè°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„æ¯äº²ï¼Ÿ\n        ä¸­é—´ç­”æ¡ˆï¼šä¹”æ²»Â·åç››é¡¿çš„æ¯äº²æ˜¯ç›ä¸½Â·é²å°”Â·åç››é¡¿ã€‚\n        &#x27;</span>&#125;]</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">from</span> langchain_core.example_selectors <span class="keyword">import</span> SemanticSimilarityExampleSelector  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> FewShotPromptTemplate, PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ç¤ºä¾‹æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">example_prompt = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;Input: &#123;input&#125;\nOutput: &#123;output&#125;&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é«˜å…´&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ‚²ä¼¤&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é«˜&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;çŸ®&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é•¿&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;çŸ­&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ç²¾åŠ›å……æ²›&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ— ç²¾æ‰“é‡‡&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é˜³å…‰&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;é˜´æš—&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ç²—ç³™&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;å…‰æ»‘&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å¹²ç‡¥&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ½®æ¹¿&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å¯Œè£•&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;è´«ç©·&quot;</span>&#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embeddings = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;text-embedding-ada-002&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.åˆ›å»ºè¯­ä¹‰ç›¸ä¼¼æ€§ç¤ºä¾‹é€‰æ‹©å™¨  </span></span><br><span class="line">example_selector = SemanticSimilarityExampleSelector.from_examples(  </span><br><span class="line">    examples,  </span><br><span class="line">    embeddings,  </span><br><span class="line">    FAISS,  </span><br><span class="line">    k=<span class="number">2</span>,  </span><br><span class="line">)  </span><br><span class="line"><span class="comment">#æˆ–è€…  </span></span><br><span class="line"><span class="comment">#example_selector = SemanticSimilarityExampleSelector(  </span></span><br><span class="line"><span class="comment">#    examples,  </span></span><br><span class="line"><span class="comment">#    embeddings,  </span></span><br><span class="line"><span class="comment">#    FAISS,  </span></span><br><span class="line"><span class="comment">#    k=2  </span></span><br><span class="line"><span class="comment">#)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.å®šä¹‰å°æ ·æœ¬æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">similar_prompt = FewShotPromptTemplate(  </span><br><span class="line">    example_selector=example_selector,  </span><br><span class="line">    example_prompt=example_prompt,  </span><br><span class="line">    prefix=<span class="string">&quot;ç»™å‡ºæ¯ä¸ªè¯ç»„çš„åä¹‰è¯&quot;</span>,  </span><br><span class="line">    suffix=<span class="string">&quot;Input: &#123;word&#125;\nOutput:&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;word&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">response = similar_prompt.invoke(&#123;<span class="string">&quot;word&quot;</span>:<span class="string">&quot;å¿§éƒ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç»™å‡ºæ¯ä¸ªè¯ç»„çš„åä¹‰è¯</span><br><span class="line"></span><br><span class="line">Input: é«˜å…´</span><br><span class="line">Output: æ‚²ä¼¤</span><br><span class="line"></span><br><span class="line">Input: é˜³å…‰</span><br><span class="line">Output: é˜´æš—</span><br><span class="line"></span><br><span class="line">Input: å¿§éƒ</span><br><span class="line">Output:</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ä»æ–‡æ¡£ä¸­åŠ è½½Prompt-äº†è§£"><a href="#ä»æ–‡æ¡£ä¸­åŠ è½½Prompt-äº†è§£" class="headerlink" title="ä»æ–‡æ¡£ä¸­åŠ è½½Prompt(äº†è§£)"></a>ä»æ–‡æ¡£ä¸­åŠ è½½Prompt(äº†è§£)</h1><p>ä¸€æ–¹é¢ï¼Œå°†æƒ³è¦è®¾å®špromptæ‰€æ”¯æŒçš„æ ¼å¼ä¿å­˜ä¸ºJSONæˆ–è€…YAMLæ ¼å¼æ–‡ä»¶ã€‚ å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡è¯»å–æŒ‡å®šè·¯å¾„çš„æ ¼å¼åŒ–æ–‡ä»¶ï¼Œè·å–ç›¸åº”çš„promptã€‚<br>ç›®çš„ä¸ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>ä¸ºäº†ä¾¿äºå…±äº«ã€å­˜å‚¨å’ŒåŠ å¼ºå¯¹promptçš„ç‰ˆæœ¬æ§åˆ¶ã€‚ </li><li>å½“æˆ‘ä»¬çš„promptæ¨¡æ¿æ•°æ®è¾ƒå¤§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤–éƒ¨å¯¼å…¥çš„æ–¹å¼è¿›è¡Œç®¡ç†å’Œç»´æŠ¤ã€‚</li></ul><h2 id="yamlæ ¼å¼æç¤ºè¯"><a href="#yamlæ ¼å¼æç¤ºè¯" class="headerlink" title="yamlæ ¼å¼æç¤ºè¯"></a>yamlæ ¼å¼æç¤ºè¯</h2><p>assetä¸‹åˆ›å»ºyamlæ–‡ä»¶ï¼šprompt.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">_type:</span>  </span><br><span class="line">    <span class="string">&quot;prompt&quot;</span>  </span><br><span class="line"><span class="attr">input_variables:</span>  </span><br><span class="line">    [<span class="string">&quot;name&quot;</span>,<span class="string">&quot;what&quot;</span>]  </span><br><span class="line"><span class="attr">template:</span>  </span><br><span class="line">    <span class="string">&quot;è¯·ç»™&#123;name&#125;è®²ä¸€ä¸ªå…³äº&#123;what&#125;çš„æ•…äº‹&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹1ï¼šä»ç‰©ç†ç£ç›˜çš„yamlæ–‡ä»¶ä¸­è¯»å–promptæ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> load_prompt  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">prompt = load_prompt(<span class="string">&quot;prompt.yaml&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)  </span><br><span class="line"><span class="comment"># print(prompt)  </span></span><br><span class="line"><span class="built_in">print</span>(prompt.<span class="built_in">format</span>(name=<span class="string">&quot;å¹´è½»äºº&quot;</span>, what=<span class="string">&quot;æ»‘ç¨½&quot;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·ç»™å¹´è½»äººè®²ä¸€ä¸ªå…³äºæ»‘ç¨½çš„æ•…äº‹</span><br></pre></td></tr></table></figure><h2 id="jsonæ ¼å¼æç¤ºè¯"><a href="#jsonæ ¼å¼æç¤ºè¯" class="headerlink" title="jsonæ ¼å¼æç¤ºè¯"></a>jsonæ ¼å¼æç¤ºè¯</h2><p>assetä¸‹åˆ›å»ºjsonæ–‡ä»¶ï¼šprompt.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">  <span class="attr">&quot;_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;prompt&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">  <span class="attr">&quot;input_variables&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;name&quot;</span><span class="punctuation">,</span> <span class="string">&quot;what&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>  </span><br><span class="line">  <span class="attr">&quot;template&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯·&#123;name&#125;è®²ä¸€ä¸ª&#123;what&#125;çš„æ•…äº‹ã€‚&quot;</span>  </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šä»ç‰©ç†ç£ç›˜çš„jsonæ–‡ä»¶ä¸­è¯»å–promptæ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> load_prompt  </span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv  </span><br><span class="line">  </span><br><span class="line">load_dotenv()  </span><br><span class="line">  </span><br><span class="line">prompt = load_prompt(<span class="string">&quot;prompt.json&quot;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(prompt.<span class="built_in">format</span>(name=<span class="string">&quot;å¼ ä¸‰&quot;</span>,what=<span class="string">&quot;æç¬‘çš„&quot;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¼ ä¸‰è®²ä¸€ä¸ªæç¬‘çš„çš„æ•…äº‹ã€‚</span><br></pre></td></tr></table></figure><h1 id="Model-I-Oä¹‹Output-Parsers"><a href="#Model-I-Oä¹‹Output-Parsers" class="headerlink" title="Model I&#x2F;Oä¹‹Output Parsers"></a>Model I&#x2F;Oä¹‹Output Parsers</h1><p>è¯­è¨€æ¨¡å‹è¿”å›çš„å†…å®¹é€šå¸¸éƒ½æ˜¯å­—ç¬¦ä¸²çš„æ ¼å¼ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰ï¼Œä½†åœ¨å®é™…AIåº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å¸Œæœ› modelå¯ä»¥è¿”å›<strong>æ›´ç›´è§‚ã€æ›´æ ¼å¼åŒ–çš„å†…å®¹</strong>ï¼Œä»¥ç¡®ä¿åº”ç”¨èƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œåç»­çš„é€»è¾‘å¤„ç†ã€‚æ­¤æ—¶ï¼Œ LangChainæä¾›çš„ è¾“å‡ºè§£æå™¨å°±æ´¾ä¸Šç”¨åœºäº†ã€‚<br>è¾“å‡ºè§£æå™¨ï¼ˆOutput Parserï¼‰è´Ÿè´£è·å– LLM çš„è¾“å‡ºå¹¶å°†å…¶è½¬æ¢ä¸ºæ›´åˆé€‚çš„æ ¼å¼ã€‚<strong>è¿™åœ¨åº”ç”¨å¼€å‘ä¸­åŠå…¶ é‡è¦ã€‚</strong></p><h2 id="è¾“å‡ºè§£æå™¨çš„åˆ†ç±»"><a href="#è¾“å‡ºè§£æå™¨çš„åˆ†ç±»" class="headerlink" title="è¾“å‡ºè§£æå™¨çš„åˆ†ç±»"></a>è¾“å‡ºè§£æå™¨çš„åˆ†ç±»</h2><p>LangChainæœ‰è®¸å¤šä¸åŒç±»å‹çš„è¾“å‡ºè§£æå™¨ </p><ul><li>StrOutputParser ï¼šå­—ç¬¦ä¸²è§£æå™¨ </li><li>JsonOutputParser ï¼šJSONè§£æå™¨ï¼Œç¡®ä¿è¾“å‡ºç¬¦åˆç‰¹å®šJSONå¯¹è±¡æ ¼å¼ </li><li>XMLOutputParser ï¼šXMLè§£æå™¨ï¼Œå…è®¸ä»¥æµè¡Œçš„XMLæ ¼å¼ä»LLMè·å–ç»“æœ </li><li>CommaSeparatedListOutputParser ï¼šCSVè§£æå™¨ï¼Œæ¨¡å‹çš„è¾“å‡ºä»¥é€—å·åˆ†éš”ï¼Œä»¥åˆ—è¡¨å½¢å¼è¿”å›è¾“å‡º</li><li>DatetimeOutputParser ï¼šæ—¥æœŸæ—¶é—´è§£æå™¨ï¼Œå¯ç”¨äºå°† LLM è¾“å‡ºè§£æä¸ºæ—¥æœŸæ—¶é—´æ ¼å¼</li></ul><p>é™¤äº†ä¸Šè¿°å¸¸ç”¨çš„è¾“å‡ºè§£æå™¨ä¹‹å¤–ï¼Œè¿˜æœ‰ï¼š</p><ul><li>EnumOutputParser ï¼šæšä¸¾è§£æå™¨ï¼Œå°†LLMçš„è¾“å‡ºï¼Œè§£æä¸ºé¢„å®šä¹‰çš„æšä¸¾å€¼ </li><li>StructuredOutputParser ï¼šå°†<strong>éç»“æ„åŒ–æ–‡æœ¬</strong>è½¬æ¢ä¸ºé¢„å®šä¹‰æ ¼å¼çš„<strong>ç»“æ„åŒ–æ•°æ®</strong>ï¼ˆå¦‚å­—å…¸ï¼‰</li><li>OutputFixingParser ï¼šè¾“å‡ºä¿®å¤è§£æå™¨ï¼Œç”¨äºè‡ªåŠ¨ä¿®å¤æ ¼å¼é”™è¯¯çš„è§£æå™¨ï¼Œæ¯”å¦‚å°†è¿”å›çš„ä¸ç¬¦åˆ é¢„æœŸæ ¼å¼çš„è¾“å‡ºï¼Œå°è¯•ä¿®æ­£ä¸ºæ­£ç¡®çš„ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚ JSONï¼‰ </li><li>RetryOutputParser ï¼šé‡è¯•è§£æå™¨ï¼Œå½“ä¸»è§£æå™¨ï¼ˆå¦‚ JSONOutputParserï¼‰å› æ ¼å¼é”™è¯¯æ— æ³•è§£æ LLM çš„è¾“å‡ºæ—¶ï¼Œé€šè¿‡è°ƒç”¨å¦ä¸€ä¸ª LLM è‡ªåŠ¨ä¿®æ­£é”™è¯¯ï¼Œå¹¶é‡æ–°å°è¯•è§£æ</li></ul><h2 id="å…·ä½“è§£æå™¨çš„ä½¿ç”¨"><a href="#å…·ä½“è§£æå™¨çš„ä½¿ç”¨" class="headerlink" title="å…·ä½“è§£æå™¨çš„ä½¿ç”¨"></a>å…·ä½“è§£æå™¨çš„ä½¿ç”¨</h2><h3 id="â‘ -å­—ç¬¦ä¸²è§£æå™¨-StrOutputParser"><a href="#â‘ -å­—ç¬¦ä¸²è§£æå™¨-StrOutputParser" class="headerlink" title="â‘  å­—ç¬¦ä¸²è§£æå™¨ StrOutputParser"></a>â‘  å­—ç¬¦ä¸²è§£æå™¨ StrOutputParser</h3><p>StrOutputParser ç®€å•åœ°å°† <strong>ä»»ä½•è¾“å…¥</strong>è½¬æ¢ä¸º <strong>å­—ç¬¦ä¸²</strong>ã€‚å®ƒæ˜¯ä¸€ä¸ªç®€å•çš„è§£æå™¨ï¼Œä»ç»“æœä¸­æå–contentå­— æ®µ ä¸¾ä¾‹ï¼šå°†ä¸€ä¸ªå¯¹è¯æ¨¡å‹çš„è¾“å‡ºç»“æœï¼Œè§£æä¸ºå­—ç¬¦ä¸²è¾“å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ã€è·å–å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage, SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser, XMLOutputParser  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.utils <span class="keyword">import</span> pre_init  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è°ƒç”¨å¤§æ¨¡å‹  </span></span><br><span class="line">response = chat_model.invoke(<span class="string">&quot;ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="comment"># print(type(response))   #AIMessage  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#3ã€å¦‚ä½•è·å–ä¸€ä¸ªå­—ç¬¦ä¸²çš„è¾“å‡ºç»“æœå‘¢ï¼Ÿ  </span></span><br><span class="line"><span class="comment"># æ–¹å¼1ï¼šè‡ªå·±è°ƒç”¨è¾“å‡ºç»“æœçš„content  </span></span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šä½¿ç”¨StrOutputParser  </span></span><br><span class="line">parser = StrOutputParser()  </span><br><span class="line">str_response = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(str_response))  <span class="comment">#&lt;class &#x27;str&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(str_response)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line">å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Model, LLMï¼‰æ˜¯ä¸€ç§åŸºäºæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œæ—¨åœ¨ç†è§£å’Œç”Ÿæˆè‡ªç„¶è¯­è¨€æ–‡æœ¬ã€‚è¿™ç±»æ¨¡å‹é€šå¸¸ä½¿ç”¨æµ·é‡çš„æ–‡æœ¬æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œå­¦ä¹ è¯­è¨€çš„ç»“æ„ã€è¯­æ³•å’Œè¯­ä¹‰ï¼Œä»¥ä¾¿èƒ½å¤Ÿç”Ÿæˆè¿è´¯ã€ç¬¦åˆä¸Šä¸‹æ–‡çš„æ–‡æœ¬ã€‚</span><br><span class="line"></span><br><span class="line">å¤§è¯­è¨€æ¨¡å‹çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š</span><br><span class="line"></span><br><span class="line">1. **è§„æ¨¡åºå¤§**ï¼šé€šå¸¸åŒ…å«äº¿ä¸‡æˆ–ç”šè‡³æ•°ç™¾äº¿ä¸ªå‚æ•°ï¼Œè¿™ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ•æ‰å¤æ‚çš„è¯­è¨€æ¨¡å¼ã€‚</span><br><span class="line"></span><br><span class="line">2. **é¢„è®­ç»ƒä¸å¾®è°ƒ**ï¼šæ¨¡å‹é¦–å…ˆåœ¨å¤§è§„æ¨¡çš„æ–‡æœ¬æ•°æ®é›†ä¸Šè¿›è¡Œæ— ç›‘ç£çš„é¢„è®­ç»ƒï¼Œç„¶åå¯ä»¥æ ¹æ®å…·ä½“ä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬åˆ†ç±»ã€é—®ç­”ç”Ÿæˆç­‰ï¼‰è¿›è¡Œå¾®è°ƒã€‚</span><br><span class="line"></span><br><span class="line">3. **å¤šæ ·åŒ–åº”ç”¨**ï¼šå¯ç”¨äºæ–‡æœ¬ç”Ÿæˆã€ç¿»è¯‘ã€é—®ç­”ã€å¯¹è¯ç³»ç»Ÿã€å†…å®¹æ¨èç­‰å¤šç§è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">4. **ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›**ï¼šèƒ½å¤Ÿç†è§£ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç”Ÿæˆç›¸å…³çš„å’Œä¸€è‡´çš„å›åº”ï¼Œä½¿å¾—ä¸äººç±»çš„äº’åŠ¨æ›´åŠ è‡ªç„¶ã€‚</span><br><span class="line"></span><br><span class="line">å¤§è¯­è¨€æ¨¡å‹çš„ä»£è¡¨æœ‰OpenAIçš„GPTç³»åˆ—ã€Googleçš„BERTå’ŒT5ä»¥åŠMetaçš„LLaMAç­‰ã€‚å°½ç®¡è¿™äº›æ¨¡å‹è¡¨ç°å‡ºè‰²ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›æŒ‘æˆ˜ï¼Œå¦‚æ˜“äº§ç”Ÿåè§ã€ç¼ºä¹å¸¸è¯†æ¨ç†èƒ½åŠ›å’Œç”Ÿæˆä¸å‡†ç¡®æˆ–ä¸åˆé€‚çš„å†…å®¹ç­‰ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="â‘¡-JSONè§£æå™¨-JsonOutputParser"><a href="#â‘¡-JSONè§£æå™¨-JsonOutputParser" class="headerlink" title="â‘¡ JSONè§£æå™¨ JsonOutputParser"></a>â‘¡ JSONè§£æå™¨ JsonOutputParser</h3><p>JsonOutputParserï¼Œå³JSONè¾“å‡ºè§£æå™¨ï¼Œæ˜¯ä¸€ç§ç”¨äºå°†å¤§æ¨¡å‹çš„<strong>è‡ªç”±æ–‡æœ¬</strong>è¾“å‡ºè½¬æ¢ä¸º<strong>ç»“æ„åŒ–JSONæ•° æ®</strong>çš„å·¥å…·ã€‚</p><p><strong>é€‚åˆåœºæ™¯</strong>ï¼šç‰¹åˆ«é€‚ç”¨äºéœ€è¦ä¸¥æ ¼ç»“æ„åŒ–è¾“å‡ºçš„åœºæ™¯ï¼Œæ¯”å¦‚ API è°ƒç”¨ã€æ•°æ®å­˜å‚¨æˆ–ä¸‹æ¸¸ä»»åŠ¡å¤„ç†ã€‚ </p><p>å®ç°æ–¹å¼</p><ul><li>æ–¹å¼1ï¼šç”¨æˆ·è‡ªå·±é€šè¿‡æç¤ºè¯æŒ‡æ˜è¿”å›Jsonæ ¼å¼ </li><li>æ–¹å¼2ï¼šå€ŸåŠ©JsonOutputParserçš„get_format_instructions()ï¼Œç”Ÿæˆæ ¼å¼è¯´æ˜ï¼ŒæŒ‡å¯¼æ¨¡å‹è¾“å‡º JSON ç»“æ„</li></ul><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªé è°±çš„&#123;role&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­£ç¡®çš„ï¼š  </span></span><br><span class="line">prompt = chat_prompt_template.invoke(  </span><br><span class="line">    <span class="built_in">input</span>=&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;äººå·¥æ™ºèƒ½ä¸“å®¶&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿé—®é¢˜ç”¨qè¡¨ç¤ºï¼Œç­”æ¡ˆç”¨aè¡¨ç¤ºï¼Œè¿”å›ä¸€ä¸ªJSONæ ¼å¼çš„æ•°æ®&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é”™è¯¯çš„ï¼š  </span></span><br><span class="line"><span class="comment"># prompt = chat_prompt_template.invoke(input=&#123;&quot;role&quot;:&quot;äººå·¥æ™ºèƒ½ä¸“å®¶&quot;,&quot;question&quot;:&quot;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;&#125;)  </span></span><br><span class="line">  </span><br><span class="line">response = chat_model.invoke(prompt)  </span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–ä¸€ä¸ªJsonOutputParserçš„å®ä¾‹  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line">json_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;q&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Artificial Intelligence&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;q&#x27;<span class="punctuation">:</span> &#x27;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;a&#x27;<span class="punctuation">:</span> &#x27;Artificial Intelligence&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼•å…¥ä¾èµ–åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">joke_query = <span class="string">&quot;å‘Šè¯‰æˆ‘ä¸€ä¸ªç¬‘è¯ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰Jsonè§£æå™¨  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä»¥PromptTemplateä¸ºä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢\n æ»¡è¶³çš„æ ¼å¼ä¸º&#123;format_instructions&#125;\n é—®é¢˜ä¸º&#123;question&#125;\n&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;format_instructions&quot;</span>: parser.get_format_instructions()&#125;,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt = prompt_template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: joke_query&#125;)  </span><br><span class="line">response = chat_model.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line">  </span><br><span class="line">json_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=&#x27;```json\n<span class="punctuation">&#123;</span>\n  <span class="attr">&quot;joke&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä¸ºä»€ä¹ˆé¸¡è¿‡é©¬è·¯ï¼Ÿå› ä¸ºå®ƒæƒ³å»å¯¹é¢ï¼&quot;</span>\n<span class="punctuation">&#125;</span>\n```&#x27; additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">32</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">59</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;accepted_prediction_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;audio_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;reasoning_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;rejected_prediction_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;audio_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;cached_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;gpt<span class="number">-4</span>o-mini<span class="number">-2024</span><span class="number">-07</span><span class="number">-18</span>&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;fp_efad92c60b&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;chatcmpl-C94MgvoSBRdCxkG0J6lBy3t0QJAoc&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span> id=&#x27;run-<span class="number">-85</span>cc489c<span class="number">-68</span>f5<span class="number">-4e26</span>-bcda-ec0fa27a683e<span class="number">-0</span>&#x27; usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">32</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">59</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;audio&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;cache_read&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;audio&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;reasoning&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;joke&#x27;<span class="punctuation">:</span> &#x27;ä¸ºä»€ä¹ˆé¸¡è¿‡é©¬è·¯ï¼Ÿå› ä¸ºå®ƒæƒ³å»å¯¹é¢ï¼&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="â‘¢-XMLè§£æå™¨-XMLOutputParser"><a href="#â‘¢-XMLè§£æå™¨-XMLOutputParser" class="headerlink" title="â‘¢ XMLè§£æå™¨ XMLOutputParser"></a>â‘¢ XMLè§£æå™¨ XMLOutputParser</h3><p>XMLOutputParserï¼Œå°†æ¨¡å‹çš„è‡ªç”±æ–‡æœ¬è¾“å‡ºè½¬æ¢ä¸ºå¯ç¼–ç¨‹å¤„ç†çš„ XML æ•°æ®ã€‚<br><strong>å¦‚ä½•å®ç°</strong>ï¼šåœ¨ PromptTemplate ä¸­æŒ‡å®š XML æ ¼å¼è¦æ±‚ï¼Œè®©æ¨¡å‹è¿”å› content å½¢å¼çš„æ•° æ®ã€‚<br><strong>æ³¨æ„</strong>ï¼šXMLOutputParser ä¸ä¼šç›´æ¥å°†æ¨¡å‹çš„è¾“å‡ºä¿æŒä¸ºåŸå§‹XMLå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ä¼šè§£æXMLå¹¶è½¬æ¢æˆ Pythonå­—å…¸ï¼ˆæˆ–ç±»ä¼¼ç»“æ„åŒ–çš„æ•°æ®ï¼‰ã€‚ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºåç»­å¤„ç†æ•°æ®ï¼Œè€Œä¸æ˜¯å•çº¯ä¿ç•™XMLæ ¼ å¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">actor_query = <span class="string">&quot;å‘¨æ˜Ÿé©°çš„ç®€çŸ­ç”µå½±è®°å½•&quot;</span>  </span><br><span class="line">response = chat_model.invoke(<span class="string">f&quot;è¯·ç”Ÿæˆ<span class="subst">&#123;actor_query&#125;</span>ï¼Œå°†å½±ç‰‡é™„åœ¨&lt;movie&gt;&lt;/movie&gt;æ ‡ç­¾ä¸­&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> &#x27;<span class="attr">langchain_core.messages.ai.AIMessage</span>&#x27;&gt;</span></span><br><span class="line">å‘¨æ˜Ÿé©°ï¼ˆStephen Chowï¼‰æ˜¯ä¸€ä½è‘—åçš„ä¸­å›½æ¼”å‘˜ã€å¯¼æ¼”å’Œç¼–å‰§ï¼Œä»¥å…¶ç‹¬ç‰¹çš„å–œå‰§é£æ ¼å’Œå¹½é»˜æ‰åè€Œé—»åã€‚ä»¥ä¸‹æ˜¯ä»–çš„å‡ éƒ¨ç»å…¸ç”µå½±è®°å½•ï¼š</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>å¤§è¯è¥¿æ¸¸ä¹‹æœˆå…‰å®ç›’<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>1995<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>è¿™æ˜¯ä¸€éƒ¨èåˆäº†å–œå‰§ã€çˆ±æƒ…å’Œå¥‡å¹»å…ƒç´ çš„ç»å…¸ç”µå½±ï¼Œè®²è¿°äº†è‡³å°Šå®å’Œç´«éœä»™å­çš„çˆ±æƒ…æ•…äº‹ï¼Œæ‰“ç ´äº†ä¼ ç»Ÿçš„è¥¿æ¸¸è®°æƒ…èŠ‚ï¼Œæˆä¸ºåè¯­ç”µå½±çš„ç»å…¸ä¹‹ä½œã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>åŠŸå¤«<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2004<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>è¿™éƒ¨ç”µå½±æ˜¯ä¸€éƒ¨ç»“åˆäº†åŠŸå¤«ä¸å–œå‰§çš„å½±ç‰‡ï¼Œè®²è¿°äº†ä¸€åå°æ··æ··åœ¨æ„å¤–ä¸­èµ°ä¸Šæ­¦é“ä¹‹è·¯ï¼Œæœ€ç»ˆæˆé•¿ä¸ºä¸€åè‹±é›„çš„æ•…äº‹ã€‚è¯¥ç‰‡å› å…¶ç‹¬ç‰¹çš„è§†å¬æ•ˆæœå’Œå¹½é»˜é£æ ¼å—åˆ°å¹¿æ³›å¥½è¯„ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>é£Ÿç¥<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>1996<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>å½±ç‰‡è®²è¿°äº†ä¸€ä½å¤±å»å¨è‰ºçš„æ˜æ˜Ÿå¨å¸ˆåœ¨è‰°éš¾çš„ç¯å¢ƒä¸­é‡æ‹¾ä¿¡å¿ƒä¸æŠ€è‰ºï¼Œå¹¶æœ€ç»ˆæˆä¸ºé£Ÿç¥çš„åŠ±å¿—æ•…äº‹ï¼Œèåˆäº†ç¾é£Ÿå’Œæç¬‘å…ƒç´ ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>å°‘æ—è¶³çƒ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2001<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>è¿™æ˜¯ä¸€éƒ¨å°†è¶³çƒä¸å°‘æ—åŠŸå¤«ç»“åˆçš„å–œå‰§ç”µå½±ï¼Œè®²è¿°äº†ä¸€ç¾¤ç»æœ›çš„å°‘æ—å¯ºå¼Ÿå­é€šè¿‡è¶³çƒé‡æ‹¾ä¿¡å¿ƒçš„æ•…äº‹ï¼Œå±•ç°äº†å›¢é˜Ÿçš„åŠ›é‡å’Œå¹½é»˜ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>å–œå‰§ä¹‹ç‹<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>1999<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>æœ¬ç‰‡æ˜¯ä¸€éƒ¨å…³äºè¿½æ±‚æ¢¦æƒ³çš„å–œå‰§ï¼Œè®²è¿°äº†ä¸€ä¸ªåœ¨ç”µå½±ç•ŒæŒ£æ‰å¥‹æ–—çš„å¹´è½»äººï¼Œæœ€ç»ˆæ‰¾åˆ°è‡ªæˆ‘ä»·å€¼å’Œçˆ±æƒ…çš„æ„Ÿäººæ•…äº‹ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼šä½“ä¼šXMLOutputParserçš„æ ¼å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers.xml <span class="keyword">import</span> XMLOutputParser  </span><br><span class="line">  </span><br><span class="line">parser = XMLOutputParser()  </span><br><span class="line"><span class="built_in">print</span>(parser.get_format_instructions())</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">The output should be formatted as a XML file.</span><br><span class="line">1. Output should conform to the tags below.</span><br><span class="line">2. If tags are not given, make them on your own.</span><br><span class="line">3. Remember to always open and close all the tags.</span><br><span class="line"></span><br><span class="line">As an example, <span class="keyword">for</span> the tags [<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>]:</span><br><span class="line">1. String <span class="string">&quot;&lt;foo&gt;</span></span><br><span class="line"><span class="string">   &lt;bar&gt;</span></span><br><span class="line"><span class="string">      &lt;baz&gt;&lt;/baz&gt;</span></span><br><span class="line"><span class="string">   &lt;/bar&gt;</span></span><br><span class="line"><span class="string">&lt;/foo&gt;&quot;</span> is a well-formatted instance of the schema.</span><br><span class="line">2. String <span class="string">&quot;&lt;foo&gt;</span></span><br><span class="line"><span class="string">   &lt;bar&gt;</span></span><br><span class="line"><span class="string">   &lt;/foo&gt;&quot;</span> is a badly-formatted instance.</span><br><span class="line">3. String <span class="string">&quot;&lt;foo&gt;</span></span><br><span class="line"><span class="string">   &lt;tag&gt;</span></span><br><span class="line"><span class="string">   &lt;/tag&gt;</span></span><br><span class="line"><span class="string">&lt;/foo&gt;&quot;</span> is a badly-formatted instance.</span><br><span class="line"></span><br><span class="line">Here are the output tags:</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3ï¼šXMLOutputParser çš„ä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> XMLOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2. åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.æµ‹è¯•æ¨¡å‹çš„xmlè§£ææ•ˆæœ  </span></span><br><span class="line">actor_query = <span class="string">&quot;ç”Ÿæˆæ±¤å§†Â·æ±‰å…‹æ–¯çš„ç®€çŸ­ç”µå½±è®°å½•,ä½¿ç”¨ä¸­æ–‡å›å¤&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰XMLOutputParserå¯¹è±¡  </span></span><br><span class="line">parser = XMLOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5. ç”Ÿæˆæç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt_template1 = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;ç”¨æˆ·çš„é—®é¢˜ï¼š&#123;query&#125;\nä½¿ç”¨çš„æ ¼å¼ï¼š&#123;format_instructions&#125;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt_template2 = prompt_template1.partial(format_instructions=parser.get_format_instructions())  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">response = chat_model.invoke(prompt_template2.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;query&quot;</span>: actor_query&#125;))  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ç”µå½±è®°å½•</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">æ¼”å‘˜</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">åå­—</span>&gt;</span>æ±¤å§†Â·æ±‰å…‹æ–¯<span class="tag">&lt;/<span class="name">åå­—</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">å‡ºç”Ÿå¹´ä»½</span>&gt;</span>1956<span class="tag">&lt;/<span class="name">å‡ºç”Ÿå¹´ä»½</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ä»£è¡¨ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šé˜¿ç”˜æ­£ä¼ ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šæ‹¯æ•‘å¤§å…µç‘æ©ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šå¤±è€Œå¤å¾—ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šå¤–æ˜ŸäººE.T.ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šè´¹åŸæ•…äº‹ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ä»£è¡¨ä½œå“</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">è·å¥–ç»å†</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">å¥–é¡¹</span>&gt;</span>å¥¥æ–¯å¡é‡‘åƒå¥–<span class="tag">&lt;/<span class="name">å¥–é¡¹</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">å¥–é¡¹</span>&gt;</span>é‡‘çƒå¥–<span class="tag">&lt;/<span class="name">å¥–é¡¹</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">å¥–é¡¹</span>&gt;</span>BAFTAå¥–<span class="tag">&lt;/<span class="name">å¥–é¡¹</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">è·å¥–ç»å†</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">æ¼”å‘˜</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ç”µå½±è®°å½•</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xml_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(xml_result)</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;ç”µå½±è®°å½•&#x27;: [&#123;&#x27;æ¼”å‘˜&#x27;: [&#123;&#x27;åå­—&#x27;: &#x27;æ±¤å§†Â·æ±‰å…‹æ–¯&#x27;&#125;, &#123;&#x27;å‡ºç”Ÿå¹´ä»½&#x27;: &#x27;1956&#x27;&#125;, &#123;&#x27;ä»£è¡¨ä½œå“&#x27;: [&#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šé˜¿ç”˜æ­£ä¼ ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šæ‹¯æ•‘å¤§å…µç‘æ©ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šå¤±è€Œå¤å¾—ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šå¤–æ˜ŸäººE.T.ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šè´¹åŸæ•…äº‹ã€‹&#x27;&#125;]&#125;, &#123;&#x27;è·å¥–ç»å†&#x27;: [&#123;&#x27;å¥–é¡¹&#x27;: &#x27;å¥¥æ–¯å¡é‡‘åƒå¥–&#x27;&#125;, &#123;&#x27;å¥–é¡¹&#x27;: &#x27;é‡‘çƒå¥–&#x27;&#125;, &#123;&#x27;å¥–é¡¹&#x27;: &#x27;BAFTAå¥–&#x27;&#125;]&#125;]&#125;]&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ—è¡¨è§£æå™¨-CommaSeparatedListOutputParser"><a href="#åˆ—è¡¨è§£æå™¨-CommaSeparatedListOutputParser" class="headerlink" title="åˆ—è¡¨è§£æå™¨ CommaSeparatedListOutputParser"></a>åˆ—è¡¨è§£æå™¨ CommaSeparatedListOutputParser</h2><p>åˆ—è¡¨è§£æå™¨ï¼šåˆ©ç”¨æ­¤è§£æå™¨å¯ä»¥å°†æ¨¡å‹çš„æ–‡æœ¬å“åº”è½¬æ¢ä¸ºä¸€ä¸ªç”¨<strong>é€—å·åˆ†éš”çš„åˆ—è¡¨ï¼ˆList[str]ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> CommaSeparatedListOutputParser  </span><br><span class="line">  </span><br><span class="line">output_parser = CommaSeparatedListOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿”å›ä¸€äº›æŒ‡ä»¤æˆ–æ¨¡æ¿ï¼Œè¿™äº›æŒ‡ä»¤å‘Šè¯‰ç³»ç»Ÿå¦‚ä½•è§£ææˆ–æ ¼å¼åŒ–è¾“å‡ºæ•°æ®  </span></span><br><span class="line">format_instructions = output_parser.get_format_instructions()  </span><br><span class="line"><span class="built_in">print</span>(format_instructions)  </span><br><span class="line">  </span><br><span class="line">messages = <span class="string">&quot;å¤§è±¡,çŒ©çŒ©,ç‹®å­&quot;</span>  </span><br><span class="line">result = output_parser.parse(messages)  </span><br><span class="line"><span class="built_in">print</span>(result)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(result))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Your response should be a list of comma separated values, eg: `foo, bar, baz` or `foo,bar,baz`</span><br><span class="line">[<span class="string">&#x27;å¤§è±¡&#x27;</span>, <span class="string">&#x27;çŒ©çŒ©&#x27;</span>, <span class="string">&#x27;ç‹®å­&#x27;</span>]</span><br><span class="line">&lt;class <span class="string">&#x27;list&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> CommaSeparatedListOutputParser  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºè§£æå™¨  </span></span><br><span class="line">output_parser = CommaSeparatedListOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºLangChainæç¤ºæ¨¡æ¿  </span></span><br><span class="line">chat_prompt = PromptTemplate.from_template(  </span><br><span class="line">    <span class="string">&quot;ç”Ÿæˆ5ä¸ªå…³äº&#123;text&#125;çš„åˆ—è¡¨.\n\n&#123;format_instructions&#125;&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;  </span><br><span class="line">    <span class="string">&quot;format_instructions&quot;</span>: output_parser.get_format_instructions()  </span><br><span class="line">    &#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æç¤ºæ¨¡æ¿ä¸è¾“å‡ºè§£æå™¨ä¼ é€’è¾“å‡º  </span></span><br><span class="line"><span class="comment"># chat_prompt = chat_prompt.partial(format_instructions=output_parser.get_format_instructions())  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># å°†æç¤ºå’Œæ¨¡å‹åˆå¹¶ä»¥è¿›è¡Œè°ƒç”¨  </span></span><br><span class="line">chain = chat_prompt | chat_model | output_parser  </span><br><span class="line">res = chain.invoke(&#123;<span class="string">&quot;text&quot;</span>: <span class="string">&quot;ç”µå½±&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(res)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(res))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;1. åŠ¨ä½œç‰‡&#x27;</span>, <span class="string">&#x27;ç§‘å¹»ç‰‡&#x27;</span>, <span class="string">&#x27;ææ€–ç‰‡&#x27;</span>, <span class="string">&#x27;å–œå‰§ç‰‡&#x27;</span>, <span class="string">&#x27;çˆ±æƒ…ç‰‡  &#x27;</span>, <span class="string">&#x27;2. ç»å…¸ç”µå½±&#x27;</span>, <span class="string">&#x27;ç°ä»£ç”µå½±&#x27;</span>, <span class="string">&#x27;å¤–å›½ç”µå½±&#x27;</span>, <span class="string">&#x27;åŠ¨ç”»ç”µå½±&#x27;</span>, <span class="string">&#x27;çºªå½•ç‰‡  &#x27;</span>, <span class="string">&#x27;3. å¯¼æ¼”&#x27;</span>, <span class="string">&#x27;ç¼–å‰§&#x27;</span>, <span class="string">&#x27;ä¸»æ¼”&#x27;</span>, <span class="string">&#x27;é…è§’&#x27;</span>, <span class="string">&#x27;åˆ¶ç‰‡äºº  &#x27;</span>, <span class="string">&#x27;4. ç¥¨æˆ¿æ”¶å…¥&#x27;</span>, <span class="string">&#x27;å½±è¯„è¯„åˆ†&#x27;</span>, <span class="string">&#x27;è§‚ä¼—è¯„åˆ†&#x27;</span>, <span class="string">&#x27;å‚èµ›å¥–é¡¹&#x27;</span>, <span class="string">&#x27;å½±å±•è·å¥–  &#x27;</span>, <span class="string">&#x27;5. ç”µå½±ç±»å‹&#x27;</span>, <span class="string">&#x27;æ”¾æ˜ æ—¶é—´&#x27;</span>, <span class="string">&#x27;ç”µå½±æ—¶é•¿&#x27;</span>, <span class="string">&#x27;ç”µå½±è¯„åˆ†&#x27;</span>, <span class="string">&#x27;è§‚çœ‹æ–¹å¼  &#x27;</span>]</span><br><span class="line">&lt;class <span class="string">&#x27;list&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="æ—¥æœŸè§£æå™¨-DatetimeOutputParser"><a href="#æ—¥æœŸè§£æå™¨-DatetimeOutputParser" class="headerlink" title="æ—¥æœŸè§£æå™¨ DatetimeOutputParser"></a>æ—¥æœŸè§£æå™¨ DatetimeOutputParser</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> DatetimeOutputParser  </span><br><span class="line">  </span><br><span class="line">output_parser = DatetimeOutputParser()  </span><br><span class="line">  </span><br><span class="line">format_instructions = output_parser.get_format_instructions()  </span><br><span class="line"><span class="built_in">print</span>(format_instructions)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Write a datetime string that matches the following pattern: <span class="string">&#x27;%Y-%m-%dT%H:%M:%S.%fZ&#x27;</span>.</span><br><span class="line"></span><br><span class="line">Examples: 1853-04-07T06:45:24.945854Z, 0835-04-16T12:35:51.978680Z, 1877-10-31T12:04:45.397316Z</span><br><span class="line"></span><br><span class="line">Return ONLY this string, no other words!</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.prompts.chat <span class="keyword">import</span> HumanMessagePromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> DatetimeOutputParser  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">chat_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>,<span class="string">&quot;&#123;format_instructions&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;request&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">output_parser = DatetimeOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼1ï¼š  </span></span><br><span class="line"><span class="comment"># model_request = chat_prompt.format_messages(  </span></span><br><span class="line"><span class="comment">#     request=&quot;ä¸­åäººæ°‘å…±å’Œå›½æ˜¯ä»€ä¹ˆæ—¶å€™æˆç«‹çš„&quot;,  </span></span><br><span class="line"><span class="comment">#     format_instructions=output_parser.get_format_instructions()  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># response = chat_model.invoke(model_request)  </span></span><br><span class="line"><span class="comment"># result = output_parser.invoke(response)  </span></span><br><span class="line"><span class="comment"># print(result)  </span></span><br><span class="line"><span class="comment"># print(type(result))  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼š  </span></span><br><span class="line">chain = chat_prompt | chat_model | output_parser  </span><br><span class="line">resp = chain.invoke(&#123;<span class="string">&quot;request&quot;</span>:<span class="string">&quot;ä¸­åäººæ°‘å…±å’Œå›½æ˜¯ä»€ä¹ˆæ—¶å€™æˆç«‹çš„&quot;</span>,  </span><br><span class="line">                     <span class="string">&quot;format_instructions&quot;</span>:output_parser.get_format_instructions()&#125;)  </span><br><span class="line"><span class="built_in">print</span>(resp)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(resp))</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1949-10-01 00:00:00</span><br><span class="line">&lt;class <span class="string">&#x27;datetime.datetime&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><h1 id="LangChainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹"><a href="#LangChainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹" class="headerlink" title="LangChainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹"></a>LangChainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹</h1><p>ç¬¬1æ­¥ï¼šä¸‹è½½å¹¶å®‰è£…Ollama  </p><p>ç¬¬2æ­¥ï¼šåœ¨Ollamaä¸‹éƒ¨ç½²å¤§æ¨¡å‹ï¼šdeepseek-r1:7b  </p><p>ç¬¬3æ­¥ï¼šåœ¨LangChainä¸­è°ƒç”¨Ollamaä¸‹çš„å¤§æ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_ollama <span class="keyword">import</span> ChatOllama  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ChatOpenAI()  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#æ­¤æ—¶è°ƒç”¨çš„æ˜¯æœ¬åœ°çš„å¤§æ¨¡å‹ã€‚çœç•¥base_urlã€api-key  </span></span><br><span class="line">llm = ChatOllama(  </span><br><span class="line">    model = <span class="string">&quot;deepseek-r1:7b&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># llm.invoke(&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ï¼&quot;)  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">messages = [  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ï¼&quot;</span>)  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">response = llm.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;think&gt;</span><br><span class="line">æ‚¨å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½çš„æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å…¬å¸å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚å¦‚æ‚¨æœ‰ä»»ä½•ä»»ä½•é—®é¢˜ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚</span><br><span class="line">&lt;/think&gt;</span><br><span class="line"></span><br><span class="line">æ‚¨å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½çš„æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å…¬å¸å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚å¦‚æ‚¨æœ‰ä»»ä½•ä»»ä½•é—®é¢˜ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChainä½¿ç”¨ä¹‹Retrieval</title>
      <link href="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/"/>
      <url>/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/</url>
      
        <content type="html"><![CDATA[<h1 id="Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰"><a href="#Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰" class="headerlink" title="Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰"></a>Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰</h1><h2 id="å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜"><a href="#å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜" class="headerlink" title="å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜"></a>å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜</h2><p>æ‹¥æœ‰è®°å¿†åï¼Œç¡®å®æ‰©å±•äº†AIå·¥ç¨‹çš„åº”ç”¨åœºæ™¯ã€‚ </p><p>ä½†æ˜¯åœ¨ä¸“æœ‰é¢†åŸŸï¼ŒLLMæ— æ³•å­¦ä¹ åˆ°æ‰€æœ‰çš„ä¸“ä¸šçŸ¥è¯†ç»†èŠ‚ï¼Œå› æ­¤åœ¨ é¢å‘ä¸“ä¸šé¢†åŸŸçŸ¥è¯†çš„æé—®æ—¶ï¼Œæ— æ³•ç»™å‡º å¯é å‡†ç¡®çš„å›ç­”ï¼Œç”šè‡³ä¼šâ€œèƒ¡è¨€ä¹±è¯­â€ï¼Œè¿™ç§ç°è±¡ç§°ä¹‹ä¸º <strong>LLMçš„â€œå¹»è§‰â€</strong>ã€‚ </p><p>å¤§æ¨¡å‹ç”Ÿæˆå†…å®¹çš„ä¸å¯æ§ï¼Œå°¤å…¶æ˜¯åœ¨é‡‘èå’ŒåŒ»ç–—é¢†åŸŸç­‰é¢†åŸŸï¼Œ<strong>ä¸€æ¬¡é‡‘é¢è¯„ä¼°çš„é”™è¯¯ï¼Œä¸€æ¬¡åŒ»ç–—è¯Šæ–­çš„å¤±è¯¯ï¼Œå“ªæ€•åªå‡ºç°ä¸€æ¬¡éƒ½æ˜¯è‡´å‘½çš„</strong>ã€‚ä½†ï¼Œå¯¹äºéä¸“ä¸šäººå£«æ¥è¯´å¯èƒ½éš¾ä»¥è¾¨è¯†ã€‚<strong>ç›®å‰è¿˜æ²¡æœ‰èƒ½å¤Ÿç™¾åˆ†ä¹‹ç™¾è§£å†³è¿™ç§æƒ…å†µçš„æ–¹æ¡ˆã€‚</strong></p><p><strong>å½“å‰å¤§å®¶æ™®éè¾¾æˆå…±è¯†çš„ä¸€ä¸ªæ–¹æ¡ˆ</strong>ï¼š<br>é¦–å…ˆï¼Œä¸ºå¤§æ¨¡å‹æä¾›ä¸€å®šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè®©å…¶è¾“å‡ºä¼šå˜å¾—æ›´ç¨³å®šã€‚<br>å…¶æ¬¡ï¼Œåˆ©ç”¨æœ¬ç« çš„RAGï¼Œå°†æ£€ç´¢å‡ºæ¥çš„ æ–‡æ¡£å’Œæç¤ºè¯è¾“é€ç»™å¤§æ¨¡å‹ï¼Œç”Ÿæˆæ›´å¯é çš„ç­”æ¡ˆã€‚</p><h2 id="RAGçš„ä¼˜ç¼ºç‚¹"><a href="#RAGçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="RAGçš„ä¼˜ç¼ºç‚¹"></a>RAGçš„ä¼˜ç¼ºç‚¹</h2><ul><li><p>RAGçš„ä¼˜ç‚¹ </p><ol><li>ç›¸æ¯”æç¤ºè¯å·¥ç¨‹ï¼ŒRAGæœ‰ <strong>æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡å’Œæ•°æ®æ ·æœ¬</strong>ï¼Œå¯ä»¥ä¸éœ€è¦ç”¨æˆ·æä¾›è¿‡å¤šçš„èƒŒæ™¯æè¿°ï¼Œå°±èƒ½ç”Ÿ æˆæ¯”è¾ƒç¬¦åˆç”¨æˆ·é¢„æœŸçš„ç­”æ¡ˆã€‚</li><li>ç›¸æ¯”äºæ¨¡å‹å¾®è°ƒï¼ŒRAGå¯ä»¥æå‡é—®ç­”å†…å®¹çš„ <strong>æ—¶æ•ˆæ€§å’Œ å¯é æ€§</strong></li><li>åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤äº†ä¸šåŠ¡æ•°æ®çš„ éšç§æ€§ã€‚</li></ol></li><li><p>RAGçš„ç¼ºç‚¹ </p><ol><li>ç”±äºæ¯æ¬¡é—®ç­”éƒ½æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿæ•°æ®æ£€ç´¢ï¼Œå› æ­¤RAGçš„ <strong>å“åº”æ—¶å»¶ç›¸å¯¹è¾ƒé«˜</strong>ã€‚</li><li>å¼•ç”¨çš„å¤–éƒ¨çŸ¥è¯†æ•°æ®ä¼š <strong>æ¶ˆè€—å¤§é‡çš„æ¨¡å‹Token</strong> èµ„æºã€‚</li></ol></li></ul><h2 id="Retrievalæµç¨‹"><a href="#Retrievalæµç¨‹" class="headerlink" title="Retrievalæµç¨‹"></a>Retrievalæµç¨‹</h2><p><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250926111132475.png"></p><h3 id="ç¯èŠ‚1ï¼šSourceï¼ˆæ•°æ®æºï¼‰"><a href="#ç¯èŠ‚1ï¼šSourceï¼ˆæ•°æ®æºï¼‰" class="headerlink" title="ç¯èŠ‚1ï¼šSourceï¼ˆæ•°æ®æºï¼‰"></a>ç¯èŠ‚1ï¼šSourceï¼ˆæ•°æ®æºï¼‰</h3><p>æŒ‡çš„æ˜¯RAGæ¶æ„ä¸­æ‰€å¤–æŒ‚çš„çŸ¥è¯†åº“ã€‚è¿™é‡Œæœ‰ä¸‰ç‚¹è¯´æ˜ï¼š </p><ol><li>åŸå§‹æ•°æ®æºç±»å‹å¤šæ ·ï¼šå¦‚ï¼šè§†é¢‘ã€å›¾ç‰‡ã€æ–‡æœ¬ã€ä»£ç ã€æ–‡æ¡£ç­‰ </li><li>å½¢å¼çš„å¤šæ ·æ€§ï¼š <ul><li>å¯ä»¥æ˜¯ä¸Šç™¾ä¸ª.csvæ–‡ä»¶ï¼Œå¯ä»¥æ˜¯ä¸Šåƒä¸ª.jsonæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸Šä¸‡ä¸ª.pdfæ–‡ä»¶ </li><li>å¯ä»¥æ˜¯æŸä¸€ä¸ªä¸šåŠ¡æµç¨‹å¤–æ”¾çš„APIï¼Œå¯ä»¥æ˜¯æŸä¸ªç½‘ç«™çš„å®æ—¶æ•°æ®ç­‰</li></ul></li></ol><h3 id="ç¯èŠ‚2ï¼šLoadï¼ˆåŠ è½½ï¼‰"><a href="#ç¯èŠ‚2ï¼šLoadï¼ˆåŠ è½½ï¼‰" class="headerlink" title="ç¯èŠ‚2ï¼šLoadï¼ˆåŠ è½½ï¼‰"></a>ç¯èŠ‚2ï¼šLoadï¼ˆåŠ è½½ï¼‰</h3><p>æ–‡æ¡£åŠ è½½å™¨ï¼ˆDocument Loadersï¼‰è´Ÿè´£å°†æ¥è‡ªä¸åŒæ•°æ®æºçš„éç»“æ„åŒ–æ–‡æœ¬ï¼ŒåŠ è½½åˆ° <strong>å†…å­˜</strong>æˆä¸º(Document)å¯¹è±¡ ã€‚ </p><p>æ–‡æ¡£å¯¹è±¡åŒ…å« <strong>æ–‡æ¡£å†…å®¹</strong>å’Œç›¸å…³<strong>å…ƒæ•°æ®ä¿¡æ¯</strong> ï¼Œä¾‹å¦‚TXTã€CSVã€HTMLã€JSONã€Markdownã€PDFï¼Œç”šè‡³ YouTube è§†é¢‘è½¬å½•ç­‰ã€‚<br><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250926111455347.png"></p><p>æ–‡æ¡£åŠ è½½å™¨è¿˜æ”¯æŒâ€œ <strong>å»¶è¿ŸåŠ è½½</strong>â€æ¨¡å¼ï¼Œä»¥ç¼“è§£å¤„ç†å¤§æ–‡ä»¶æ—¶çš„å†…å­˜å‹åŠ›ã€‚<br>æ–‡æ¡£åŠ è½½å™¨çš„ç¼–ç¨‹æ¥å£ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œä»¥ä¸‹ç»™å‡ºåŠ è½½TXTæ ¼å¼æ–‡æ¡£çš„ä¾‹å­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.document_loadersimport TextLoader </span><br><span class="line"></span><br><span class="line">text_loader = TextLoader( <span class="string">&quot;./test.txt&quot;</span> ) </span><br><span class="line"></span><br><span class="line">docs = text_loader.load() <span class="comment">#è¿”å›Liståˆ—è¡¨(Documentå¯¹è±¡) </span></span><br><span class="line"><span class="built_in">print</span> (docs)</span><br></pre></td></tr></table></figure><h3 id="ç¯èŠ‚3ï¼šTransformï¼ˆè½¬æ¢ï¼‰"><a href="#ç¯èŠ‚3ï¼šTransformï¼ˆè½¬æ¢ï¼‰" class="headerlink" title="ç¯èŠ‚3ï¼šTransformï¼ˆè½¬æ¢ï¼‰"></a>ç¯èŠ‚3ï¼šTransformï¼ˆè½¬æ¢ï¼‰</h3><p><strong>æ–‡æ¡£è½¬æ¢å™¨(Document Transformers)</strong> è´Ÿè´£å¯¹åŠ è½½çš„æ–‡æ¡£è¿›è¡Œè½¬æ¢å’Œå¤„ç†ï¼Œä»¥ä¾¿æ›´å¥½åœ°é€‚åº”ä¸‹æ¸¸ä»»åŠ¡çš„ éœ€æ±‚ã€‚ </p><p>æ–‡æ¡£è½¬æ¢å™¨æä¾›äº†ä¸€è‡´çš„æ¥å£ï¼ˆå·¥å…·ï¼‰æ¥æ“ä½œæ–‡æ¡£ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li><strong>æ–‡æœ¬æ‹†åˆ†å™¨(Text Splitters)</strong> ï¼šå°†é•¿æ–‡æœ¬æ‹†åˆ†æˆè¯­ä¹‰ä¸Šç›¸å…³çš„å°å—ï¼Œä»¥é€‚åº”è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£é™ åˆ¶ã€‚ </li><li><strong>å†—ä½™è¿‡æ»¤å™¨(Redundancy Filters)</strong> ï¼šè¯†åˆ«å¹¶è¿‡æ»¤é‡å¤çš„æ–‡æ¡£ã€‚</li><li>å…ƒæ•°æ®æå–å™¨(Metadata Extractors) ï¼šä»æ–‡æ¡£ä¸­æå–æ ‡é¢˜ã€è¯­è°ƒç­‰ç»“æ„åŒ–å…ƒæ•°æ®ã€‚ </li><li><strong>å¤šè¯­è¨€è½¬æ¢å™¨(Multi-lingual Transformers)</strong> ï¼šå®ç°æ–‡æ¡£çš„æœºå™¨ç¿»è¯‘ã€‚ </li><li><strong>å¯¹è¯è½¬æ¢å™¨(Conversational Transformers)</strong> ï¼šå°†éç»“æ„åŒ–å¯¹è¯è½¬æ¢ä¸ºé—®ç­”æ ¼å¼çš„æ–‡æ¡£ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼Œæ–‡æ¡£è½¬æ¢å™¨æ˜¯ LangChain å¤„ç†ç®¡é“ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒä¸°å¯Œäº†æ¡†æ¶å¯¹æ–‡æ¡£çš„è¡¨ç¤ºå’Œ æ“ä½œèƒ½åŠ›ã€‚</p><h4 id="ç¯èŠ‚3-1ï¼šText-Splittingï¼ˆæ–‡æ¡£æ‹†åˆ†ï¼‰"><a href="#ç¯èŠ‚3-1ï¼šText-Splittingï¼ˆæ–‡æ¡£æ‹†åˆ†ï¼‰" class="headerlink" title="ç¯èŠ‚3.1ï¼šText Splittingï¼ˆæ–‡æ¡£æ‹†åˆ†ï¼‰"></a>ç¯èŠ‚3.1ï¼šText Splittingï¼ˆæ–‡æ¡£æ‹†åˆ†ï¼‰</h4><ul><li>å‘é‡åŒ–å¹¶å­˜å…¥æ•°æ®åº“ä¸­ã€‚ æ‹†åˆ†&#x2F;åˆ†å—çš„å¿…è¦æ€§ï¼šå‰ä¸€ä¸ªç¯èŠ‚åŠ è½½åçš„æ–‡æ¡£å¯¹è±¡å¯ä»¥ç›´æ¥ä¼ å…¥æ–‡æ¡£æ‹†åˆ†å™¨è¿›è¡Œæ‹†åˆ†ï¼Œè€Œæ–‡æ¡£åˆ‡å— åæ‰èƒ½ </li><li>æ–‡æ¡£æ‹†åˆ†å™¨çš„å¤šæ ·æ€§ï¼šLangChainæä¾›äº†ä¸°å¯Œçš„æ–‡æ¡£æ‹†åˆ†å™¨ï¼Œä¸ä»…èƒ½å¤Ÿåˆ‡åˆ†æ™®é€šæ–‡æœ¬ï¼Œè¿˜èƒ½åˆ‡åˆ† Markdownã€JSONã€HTMLã€ä»£ç ç­‰ç‰¹æ®Šæ ¼å¼çš„æ–‡æœ¬ã€‚ </li><li>æ‹†åˆ†&#x2F;åˆ†å—çš„æŒ‘æˆ˜æ€§ï¼šå®é™…æ‹†åˆ†æ“ä½œä¸­éœ€è¦å¤„ç†è®¸å¤šç»†èŠ‚é—®é¢˜ï¼Œ éœ€è¦é‡‡ç”¨ä¸åŒçš„åˆ†å—ç­–ç•¥ã€‚ <ul><li>å¯ä»¥æŒ‰ç…§ æ•°æ®ç±»å‹è¿›è¡Œåˆ‡ç‰‡å¤„ç†ï¼Œæ¯”å¦‚é’ˆå¯¹ ä¸åŒç±»å‹çš„æ–‡æœ¬ã€ ä¸åŒçš„ä½¿ç”¨åœºæ™¯éƒ½ æ–‡æœ¬ç±»æ•°æ®ï¼Œå¯ä»¥ç›´æ¥æŒ‰ç…§å­—ç¬¦ã€æ®µè½è¿›è¡Œåˆ‡ ç‰‡ï¼›ä»£ ç ç±»æ•°æ®åˆ™éœ€è¦è¿›ä¸€æ­¥ç»†åˆ†ä»¥ä¿è¯ä»£ç çš„åŠŸèƒ½æ€§ï¼› </li><li>å¯ä»¥ç›´æ¥æ ¹æ® token è¿›è¡Œåˆ‡ç‰‡å¤„ç†</li></ul></li></ul><p><strong>åœ¨æ„å»ºRAGåº”ç”¨ç¨‹åºçš„æ•´ä¸ªæµç¨‹ä¸­ï¼Œæ‹†åˆ†&#x2F;åˆ†å—æ˜¯æœ€å…·æŒ‘æˆ˜æ€§çš„ç¯èŠ‚ä¹‹ä¸€ï¼Œå®ƒæ˜¾è‘—å½±å“æ£€ç´¢æ•ˆæœ</strong>ã€‚ç›®å‰ è¿˜æ²¡æœ‰é€šç”¨çš„æ–¹æ³•å¯ä»¥æ˜ç¡®æŒ‡å‡ºå“ªä¸€ç§åˆ†å—ç­–ç•¥æœ€ä¸ºæœ‰æ•ˆã€‚ä¸åŒçš„ä½¿ç”¨åœºæ™¯å’Œæ•°æ®ç±»å‹éƒ½ä¼šå½±å“åˆ†å—ç­– ç•¥çš„é€‰æ‹©ã€‚</p><h3 id="ç¯èŠ‚4ï¼šEmbedï¼ˆåµŒå…¥ï¼‰"><a href="#ç¯èŠ‚4ï¼šEmbedï¼ˆåµŒå…¥ï¼‰" class="headerlink" title="ç¯èŠ‚4ï¼šEmbedï¼ˆåµŒå…¥ï¼‰"></a>ç¯èŠ‚4ï¼šEmbedï¼ˆåµŒå…¥ï¼‰</h3><p>æ–‡æ¡£åµŒå…¥æ¨¡å‹ï¼ˆText Embedding Modelsï¼‰è´Ÿè´£å°† <strong>æ–‡æœ¬</strong>è½¬æ¢ä¸º <strong>å‘é‡è¡¨ç¤º</strong>ï¼Œå³<strong>æ¨¡å‹èµ‹äºˆäº†æ–‡æœ¬è®¡ç®—æœºå¯ ç†è§£çš„æ•°å€¼è¡¨ç¤º</strong>ï¼Œä½¿æ–‡æœ¬å¯ç”¨äºå‘é‡ç©ºé—´ä¸­çš„å„ç§è¿ç®—ï¼Œå¤§å¤§æ‹“å±•äº†æ–‡æœ¬åˆ†æçš„å¯èƒ½æ€§ï¼Œæ˜¯è‡ªç„¶è¯­è¨€å¤„ ç†é¢†åŸŸéå¸¸é‡è¦çš„æŠ€æœ¯ã€‚</p><p>ä¸¾ä¾‹ï¼š<br><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250927222436889.png"></p><ul><li>å®ç°åŸç†ï¼šé€šè¿‡ <strong>ç‰¹å®šç®—æ³•</strong>ï¼ˆå¦‚Word2Vecï¼‰å°†è¯­ä¹‰ä¿¡æ¯ç¼–ç ä¸ºå›ºå®šç»´åº¦çš„å‘é‡ï¼Œå…·ä½“ç®—æ³•ç»†èŠ‚éœ€å ç»­æ·±å…¥ã€‚ </li><li>å…³é”®ç‰¹æ€§ï¼š<strong>ç›¸ä¼¼çš„è¯åœ¨å‘é‡ç©ºé—´ä¸­è·ç¦»ç›¸è¿‘</strong>ï¼Œä¾‹å¦‚â€çŒ«â€å’Œâ€çŠ¬â€çš„å‘é‡å¤¹è§’å°äºâ€çŒ«â€å’Œâ€æ±½è½¦â€ã€‚<br><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250927222545025.png"></li></ul><p>æ–‡æœ¬åµŒå…¥ä¸º LangChain ä¸­çš„é—®ç­”ã€æ£€ç´¢ã€æ¨èç­‰åŠŸèƒ½æä¾›äº†é‡è¦æ”¯æŒã€‚å…·ä½“ä¸ºï¼š</p><ul><li><strong>è¯­ä¹‰åŒ¹é…</strong>ï¼šé€šè¿‡è®¡ç®—ä¸¤ä¸ªæ–‡æœ¬çš„å‘é‡ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œåˆ¤æ–­å®ƒä»¬åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼ç¨‹åº¦ï¼Œå®ç°è¯­ä¹‰åŒ¹é…ã€‚ </li><li><strong>æ–‡æœ¬æ£€ç´¢</strong>ï¼šé€šè¿‡è®¡ç®—ä¸åŒæ–‡æœ¬ä¹‹é—´çš„å‘é‡ç›¸ä¼¼åº¦ï¼Œå¯ä»¥å®ç°è¯­ä¹‰æœç´¢ï¼Œæ‰¾åˆ°å‘é‡ç©ºé—´ä¸­æœ€ç›¸ä¼¼çš„æ–‡ æœ¬ã€‚</li><li><strong>ä¿¡æ¯æ¨è</strong>ï¼šæ ¹æ®ç”¨æˆ·çš„å†å²è®°å½•æˆ–å…´è¶£åµŒå…¥ç”Ÿæˆç”¨æˆ·å‘é‡ï¼Œè®¡ç®—ä¸åŒä¿¡æ¯çš„å‘é‡ä¸ç”¨æˆ·å‘é‡çš„ç›¸ä¼¼ åº¦ï¼Œæ¨èç›¸ä¼¼çš„ä¿¡æ¯ã€‚ </li><li><strong>çŸ¥è¯†æŒ–æ˜</strong>ï¼šå¯ä»¥é€šè¿‡èšç±»ã€é™ç»´ç­‰æ‰‹æ®µåˆ†ææ–‡æœ¬å‘é‡çš„åˆ†å¸ƒï¼Œå‘ç°æ–‡æœ¬ä¹‹é—´çš„æ½œåœ¨å…³è”ï¼ŒæŒ–æ˜çŸ¥ è¯†ã€‚ </li><li><strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>ï¼šå°†è¯è¯­ã€å¥å­ç­‰è¡¨ç¤ºä¸ºç¨ å¯†å‘é‡ï¼Œä¸ºç¥ç»ç½‘ç»œç­‰ä¸‹æ¸¸ä»»åŠ¡æä¾›è¾“å…¥ã€‚</li></ul><h3 id="ç¯èŠ‚5ï¼šStoreï¼ˆå­˜å‚¨ï¼‰"><a href="#ç¯èŠ‚5ï¼šStoreï¼ˆå­˜å‚¨ï¼‰" class="headerlink" title="ç¯èŠ‚5ï¼šStoreï¼ˆå­˜å‚¨ï¼‰"></a>ç¯èŠ‚5ï¼šStoreï¼ˆå­˜å‚¨ï¼‰</h3><p>LangChain è¿˜æ”¯æŒæŠŠæ–‡æœ¬åµŒå…¥å­˜å‚¨åˆ°å‘é‡å­˜å‚¨æˆ–ä¸´æ—¶ç¼“å­˜ï¼Œä»¥é¿å…éœ€è¦é‡æ–°è®¡ç®—å®ƒä»¬ã€‚è¿™é‡Œå°±å‡ºç°äº†æ•° æ®åº“ï¼Œæ”¯æŒè¿™äº›åµŒå…¥çš„é«˜æ•ˆ <strong>å­˜å‚¨å’Œæœç´¢</strong>çš„éœ€æ±‚ã€‚</p><p><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250927222756909.png"></p><h3 id="ç¯èŠ‚6ï¼šRetrieveï¼ˆæ£€ç´¢ï¼‰"><a href="#ç¯èŠ‚6ï¼šRetrieveï¼ˆæ£€ç´¢ï¼‰" class="headerlink" title="ç¯èŠ‚6ï¼šRetrieveï¼ˆæ£€ç´¢ï¼‰"></a>ç¯èŠ‚6ï¼šRetrieveï¼ˆæ£€ç´¢ï¼‰</h3><p>æ£€ç´¢å™¨ï¼ˆRetrieversï¼‰æ˜¯ä¸€ç§ç”¨äº <strong>å“åº”éç»“æ„åŒ–æŸ¥è¯¢</strong>çš„æ¥å£ï¼Œå®ƒå¯ä»¥è¿”å›ç¬¦åˆæŸ¥è¯¢è¦æ±‚çš„æ–‡æ¡£ã€‚</p><p>LangChain æä¾›äº†ä¸€äº›å¸¸ç”¨çš„æ£€ç´¢å™¨ï¼Œå¦‚ <strong>å‘é‡æ£€ç´¢å™¨ã€ æ–‡æ¡£æ£€ç´¢å™¨ã€ ç½‘ç«™ç ”ç©¶æ£€ç´¢å™¨</strong>ç­‰ã€‚ </p><p>é€šè¿‡é…ç½®ä¸åŒçš„æ£€ç´¢å™¨ï¼ŒLangChain å¯ä»¥çµæ´»åœ°å¹³è¡¡æ£€ç´¢çš„ç²¾åº¦ã€å¬å›ç‡ä¸æ•ˆç‡ã€‚æ£€ç´¢ç»“æœå°†ä¸ºåç»­çš„ é—®ç­”ç”Ÿæˆæä¾›ä¿¡æ¯æ”¯æŒï¼Œä»¥äº§ç”Ÿæ›´åŠ å‡†ç¡®å’Œå®Œæ•´çš„å›ç­”ã€‚</p><h1 id="æ–‡æ¡£åŠ è½½å™¨-Document-Loaders"><a href="#æ–‡æ¡£åŠ è½½å™¨-Document-Loaders" class="headerlink" title="æ–‡æ¡£åŠ è½½å™¨ Document Loaders"></a>æ–‡æ¡£åŠ è½½å™¨ Document Loaders</h1><p>LangChainçš„è®¾è®¡ï¼šå¯¹äº<strong>Source</strong>ä¸­å¤šç§ä¸åŒçš„æ•°æ®æºï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§ç»Ÿä¸€çš„å½¢å¼è¯»å–ã€è°ƒç”¨ã€‚</p><h2 id="åŠ è½½txt"><a href="#åŠ è½½txt" class="headerlink" title="åŠ è½½txt"></a>åŠ è½½txt</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> TextLoader, PyPDFLoader  </span><br><span class="line">   </span><br><span class="line"><span class="comment"># æŒ‡æ˜txtæ–‡æ¡£çš„è·¯å¾„  </span></span><br><span class="line">file_path = <span class="string">&quot;./asset/load/01-langchain-utf-8.txt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªTextLoaderçš„å®ä¾‹  </span></span><br><span class="line">text_loader = TextLoader(  </span><br><span class="line">    file_path=file_path,  </span><br><span class="line">    encoding=<span class="string">&quot;utf-8&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è°ƒç”¨load()ï¼Œè¿”å›ä¸€ä¸ªlist[Document]  </span></span><br><span class="line">docs = text_loader.load()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(docs)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  <span class="comment"># æŸ¥çœ‹åˆ—è¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°â€˜  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(docs[<span class="number">0</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/01-langchain-utf-8.txt&#x27;</span>&#125;, page_content=<span class="string">&#x27;LangChain æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åº”ç”¨çš„å¼€å‘æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°é›†æˆã€ç®¡ç†å’Œå¢å¼ºå¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºç«¯åˆ°ç«¯çš„åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†ä¸€å¥—æ¨¡å—åŒ–å·¥å…·å’Œæ¥å£ï¼Œæ”¯æŒä»ç®€å•çš„æ–‡æœ¬ç”Ÿæˆåˆ°å¤æ‚çš„å¤šæ­¥éª¤æ¨ç†ä»»åŠ¡&#x27;</span>)]</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">page_content=<span class="string">&#x27;LangChain æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åº”ç”¨çš„å¼€å‘æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°é›†æˆã€ç®¡ç†å’Œå¢å¼ºå¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºç«¯åˆ°ç«¯çš„åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†ä¸€å¥—æ¨¡å—åŒ–å·¥å…·å’Œæ¥å£ï¼Œæ”¯æŒä»ç®€å•çš„æ–‡æœ¬ç”Ÿæˆåˆ°å¤æ‚çš„å¤šæ­¥éª¤æ¨ç†ä»»åŠ¡&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/01-langchain-utf-8.txt&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>Docummentå¯¹è±¡ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ï¼š </p><ul><li>page_contentï¼šçœŸæ­£çš„æ–‡æ¡£å†…å®¹ </li><li>metadataï¼šæ–‡æ¡£å†…å®¹çš„åŸæ•°æ®</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¾ç¤ºDocumentå¯¹è±¡çš„å…ƒæ•°æ®  </span></span><br><span class="line"><span class="built_in">print</span>(docs[<span class="number">0</span>].metadata)  </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&#123;&#x27;source&#x27;: &#x27;./asset/load/01-langchain-utf-8.txt&#x27;&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ–‡æ¡£ä¸­çš„å†…å®¹ä¿¡æ¯  </span></span><br><span class="line"><span class="built_in">print</span>(docs[<span class="number">0</span>].page_content)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">LangChain æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åº”ç”¨çš„å¼€å‘æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°é›†æˆã€ç®¡ç†å’Œå¢å¼ºå¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºç«¯åˆ°ç«¯çš„åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†ä¸€å¥—æ¨¡å—åŒ–å·¥å…·å’Œæ¥å£ï¼Œæ”¯æŒä»ç®€å•çš„æ–‡æœ¬ç”Ÿæˆåˆ°å¤æ‚çš„å¤šæ­¥éª¤æ¨ç†ä»»åŠ¡</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><h2 id="åŠ è½½pdf"><a href="#åŠ è½½pdf" class="headerlink" title="åŠ è½½pdf"></a>åŠ è½½pdf</h2><h3 id="ä¸¾ä¾‹1ï¼š"><a href="#ä¸¾ä¾‹1ï¼š" class="headerlink" title="ä¸¾ä¾‹1ï¼š"></a><strong>ä¸¾ä¾‹1ï¼š</strong></h3><p>LangChainåŠ è½½PDFæ–‡ä»¶ä½¿ç”¨çš„æ˜¯pypdfï¼Œå…ˆå®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pypdf</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³çš„ä¾èµ– PyPDFLoader()</span></span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders.pdf <span class="keyword">import</span> PyPDFLoader  </span><br><span class="line">  </span><br><span class="line">pdf_loader = PyPDFLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/02-load.pdf&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = pdf_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(docs)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Document(metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;MicrosoftÂ® Word 2019&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;MicrosoftÂ® Word 2019&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2025-06-20T17:18:19+08:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2025-06-20T17:18:19+08:00&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/02-load.pdf&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;page&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;1&#x27;</span>&#125;, page_content=<span class="string">&#x27;&quot;ä»–çš„è½¦ï¼Œä»–çš„å‘½ï¼ ä»–å¿½ç„¶æƒ³èµ·æ¥ï¼Œä¸€å¹´ï¼ŒäºŒå¹´ï¼Œè‡³å°‘æœ‰ä¸‰å››å¹´ï¼›ä¸€æ»´æ±—ï¼Œä¸¤æ»´æ±—ï¼Œä¸\nçŸ¥é“å¤šå°‘ä¸‡æ»´æ±—ï¼Œæ‰æŒ£å‡ºé‚£è¾†è½¦ã€‚ä»é£é‡Œé›¨é‡Œçš„å’¬ç‰™ï¼Œä»é¥­é‡ŒèŒ¶é‡Œçš„è‡ªè‹¦ï¼Œæ‰èµšå‡ºé‚£è¾†è½¦ã€‚\né‚£è¾†è½¦æ˜¯ä»–çš„ä¸€åˆ‡æŒ£æ‰ä¸å›°è‹¦çš„æ€»ç»“æœä¸æŠ¥é…¬ï¼Œåƒèº«ç»ç™¾æˆ˜çš„æ­¦å£«çš„ä¸€é¢—å¾½ç« ã€‚â€¦â€¦ä»–è€æƒ³\nç€è¿œè¿œçš„ä¸€è¾†è½¦ï¼Œå¯ä»¥ä½¿ä»–è‡ªç”±ï¼Œç‹¬ç«‹ï¼Œåƒè‡ªå·±çš„æ‰‹è„šçš„é‚£ä¹ˆä¸€è¾†è½¦ã€‚&quot; \n \n&quot;ä»–åƒï¼Œä»–å–ï¼Œä»–å«–ï¼Œä»–èµŒï¼Œä»–æ‡’ï¼Œä»–ç‹¡çŒ¾ï¼Œ å› ä¸ºä»–æ²¡äº†å¿ƒï¼Œä»–çš„å¿ƒè¢«äººå®¶æ‘˜äº†å»ã€‚ä»–\nåªå‰©ä¸‹é‚£ä¸ªé«˜å¤§çš„è‚‰æ¶å­ï¼Œç­‰ç€æºƒçƒ‚ï¼Œé¢„å¤‡ç€åˆ°ä¹±æ­»å²—å­å»ã€‚â€¦â€¦ä½“é¢çš„ã€è¦å¼ºçš„ã€å¥½æ¢¦æƒ³\nçš„ã€åˆ©å·±çš„ã€ä¸ªäººçš„ã€å¥å£®çš„ã€ä¼Ÿå¤§çš„ç¥¥å­ï¼Œä¸çŸ¥é™ªç€äººå®¶é€äº†å¤šå°‘å›æ®¡ï¼›ä¸çŸ¥é“ä½•æ—¶ä½•åœ°\nä¼šåŸ‹èµ·ä»–è‡ªå·±æ¥ï¼Œ åŸ‹èµ·è¿™å •è½çš„ã€ è‡ªç§çš„ã€ ä¸å¹¸çš„ã€ ç¤¾ä¼šç—…èƒé‡Œçš„äº§å„¿ï¼Œ ä¸ªäººä¸»ä¹‰çš„æœ«è·¯é¬¼ï¼\n&quot;&#x27;</span>)]</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> (pages[<span class="number">0</span>]) <span class="comment">#langchain_core.documents.base.Document</span></span><br><span class="line"></span><br><span class="line">pages[<span class="number">0</span>].page_content <span class="comment">#åªè·å–æœ¬é¡µå†…å®¹</span></span><br><span class="line"> </span><br><span class="line">pages[<span class="number">0</span>].metadata <span class="comment"># &#123;...,&#x27;source&#x27;: &#x27;./asset/load/load.pdf&#x27;,.., &#x27;page&#x27;: 0&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼š"><a href="#ä¸¾ä¾‹2ï¼š" class="headerlink" title="ä¸¾ä¾‹2ï¼š"></a><strong>ä¸¾ä¾‹2ï¼š</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders.pdf <span class="keyword">import</span> PyPDFLoader  </span><br><span class="line">  </span><br><span class="line">pdf_loader = PyPDFLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;https://arxiv.org/pdf/2302.03803&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = pdf_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(doc)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line">8</span><br><span class="line">page_content=<span class="string">&#x27;arXiv:2302.03803v1  [math.AG]  7 Feb 2023</span></span><br><span class="line"><span class="string">A WEAK (k, k )-LEFSCHETZ THEOREM FOR PROJECTIVE</span></span><br><span class="line"><span class="string">TORIC ORBIFOLDS</span></span><br><span class="line"><span class="string">William D. Montoya</span></span><br><span class="line"><span class="string">Instituto de MatemÂ´ atica, EstatÂ´ Ä±stica e ComputaÂ¸ cËœ ao CientÂ´ Ä±ï¬ca,</span></span><br><span class="line"><span class="string">Universidade Estadual de Campinas (UNICAMP),</span></span><br><span class="line"><span class="string">Rua SÂ´ ergio Buarque de Holanda 651, 13083-859, Campinas, SP , Brazil</span></span><br><span class="line"><span class="string">February 9, 2023</span></span><br><span class="line"><span class="string">Abstract</span></span><br><span class="line"><span class="string">Firstly we show a generalization of the (1,1)-Lefschetz theorem for projective</span></span><br><span class="line"><span class="string">toric orbifolds and secondly we prove that on 2k-dimensional quasi-smooth hyper-</span></span><br><span class="line"><span class="string">surfaces coming from quasi-smooth intersection surfaces, under the Cayley trick,</span></span><br><span class="line"><span class="string">every rational (k, k)-cohomology class is algebraic, i.e., the Hodge conjectureholds</span></span><br><span class="line"><span class="string">on them.</span></span><br><span class="line"><span class="string">1 Introduction</span></span><br><span class="line"><span class="string">In [3] we proved that, under suitable conditions, on a very general codimension s quasi-</span></span><br><span class="line"><span class="string">smooth intersection subvariety X in a projective toric orbifold Pd</span></span><br><span class="line"><span class="string">Î£ with d +s = 2(k +1)</span></span><br><span class="line"><span class="string">the Hodge conjecture holds, that is, every (p, p )-cohomology class, under the PoincarÂ´ e</span></span><br><span class="line"><span class="string">duality is a rational linear combination of fundamental classes of alge braic subvarieties</span></span><br><span class="line"><span class="string">of X. The proof of the above-mentioned result relies, for p â‰  d +1 âˆ’ s, on a Lefschetz</span></span><br><span class="line"><span class="string">Date: February 9, 2023</span></span><br><span class="line"><span class="string">2020 Mathematics Subject Classiï¬cation: 14C30, 14M10, 14J70, 14M25</span></span><br><span class="line"><span class="string">Keywords: (1,1)- Lefschetz theorem, Hodge conjecture, toric varieties, complete intersection</span></span><br><span class="line"><span class="string">Email: wmontoya@ime.unicamp.br</span></span><br><span class="line"><span class="string">1&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 0, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;1&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;theorem ([7]) and the Hard Lefschetz theorem for projective orb ifolds ([11]). When p =</span></span><br><span class="line"><span class="string">d +1 âˆ’s the proof relies on the Cayley trick, a trick which associates to X a quasi-smooth</span></span><br><span class="line"><span class="string">hypersurface Y in a projective vector bundle, and the Cayley Proposition (4.3) which</span></span><br><span class="line"><span class="string">gives an isomorphism of some primitive cohomologies (4.2) of X and Y . The Cayley</span></span><br><span class="line"><span class="string">trick, following the philosophy of Mavlyutov in [7], reduces results kn own for quasi-smooth</span></span><br><span class="line"><span class="string">hypersurfaces to quasi-smooth intersection subvarieties. The id ea in this paper goes the</span></span><br><span class="line"><span class="string">other way around, we translate some results for quasi-smooth int ersection subvarieties to</span></span><br><span class="line"><span class="string">quasi-smooth hypersurfaces, mainly the (1, 1)-Lefschetz theorem.</span></span><br><span class="line"><span class="string">Acknowledgement. I thank Prof. Ugo Bruzzo and Tiago Fonseca for useful discus-</span></span><br><span class="line"><span class="string">sions. I also acknowledge support from FAPESP postdoctoral gra nt No. 2019/23499-7.</span></span><br><span class="line"><span class="string">2 Preliminaries and Notation</span></span><br><span class="line"><span class="string">2.1 Toric varieties</span></span><br><span class="line"><span class="string">Let M be a free abelian group of rank d, let N =Hom(M, Z ), and NR =N âŠ—Z R.</span></span><br><span class="line"><span class="string">Deï¬nition 2.1. â€¢ A convex subset Ïƒ âŠ‚NR is a rational k-dimensional simplicial cone</span></span><br><span class="line"><span class="string">if there exist k linearly independent primitive elements e1, . . . , e k âˆˆ N such that Ïƒ =</span></span><br><span class="line"><span class="string">&#123;Âµ1e1 +â‹¯+ Âµkek&#125;.</span></span><br><span class="line"><span class="string">â€¢ The generators ei are integral if for every i and any nonnegative rational number Âµ</span></span><br><span class="line"><span class="string">the product Âµei is in N only if Âµ is an integer.</span></span><br><span class="line"><span class="string">â€¢ Given two rational simplicial cones Ïƒ, Ïƒâ€² one says that Ïƒâ€² is a face of Ïƒ (Ïƒâ€² &lt; Ïƒ) if</span></span><br><span class="line"><span class="string">the set of integral generators of Ïƒâ€² is a subset of the set of integral generators of Ïƒ.</span></span><br><span class="line"><span class="string">â€¢ A ï¬nite set Î£ =&#123;Ïƒ1, . . . , Ïƒ t&#125; of rational simplicial cones is called a rational simplicia l</span></span><br><span class="line"><span class="string">complete d-dimensional fan if:</span></span><br><span class="line"><span class="string">1. all faces of cones in Î£ are in Î£ ;</span></span><br><span class="line"><span class="string">2. if Ïƒ, Ïƒ â€² âˆˆÎ£ then Ïƒ âˆ©Ïƒâ€² &lt;Ïƒ and Ïƒ âˆ©Ïƒâ€² &lt;Ïƒâ€²;</span></span><br><span class="line"><span class="string">3. NR =Ïƒ1 âˆªâ‹…â‹…â‹…âˆª Ïƒt.</span></span><br><span class="line"><span class="string">A rational simplicial complete d-dimensional fan Î£ deï¬nes a d-dimensional toric variety</span></span><br><span class="line"><span class="string">Pd</span></span><br><span class="line"><span class="string">Î£ having only orbifold singularities which we assume to be projective. Mo reover, T âˆ¶=</span></span><br><span class="line"><span class="string">N âŠ—Z Câˆ— â‰ƒ (Câˆ—)d is the torus action on Pd</span></span><br><span class="line"><span class="string">Î£ . We denote by Î£ (i) the i-dimensional cones</span></span><br><span class="line"><span class="string">2&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 1, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;of Î£ and each Ï âˆˆÎ£ corresponds to an irreducible T -invariant Weil divisor DÏ on Pd</span></span><br><span class="line"><span class="string">Î£ . Let</span></span><br><span class="line"><span class="string">Cl(Î£ ) be the group of Weil divisors on Pd</span></span><br><span class="line"><span class="string">Î£ module rational equivalences.</span></span><br><span class="line"><span class="string">The total coordinate ring of Pd</span></span><br><span class="line"><span class="string">Î£ is the polynomial ring S = C[xÏ /divides.alt0 Ï âˆˆ Î£ (1)], S has the</span></span><br><span class="line"><span class="string">Cl(Î£ )-grading, a Weil divisor D =âˆ‘ÏâˆˆÎ£ (1) uÏDÏ determines the monomial xu âˆ¶=âˆÏâˆˆÎ£ (1) xuÏ</span></span><br><span class="line"><span class="string">Ï âˆˆ</span></span><br><span class="line"><span class="string">S and conversely deg (xu)=[D]âˆˆCl(Î£ ).</span></span><br><span class="line"><span class="string">For a cone Ïƒ âˆˆ Î£, Ë†Ïƒ is the set of 1-dimensional cone in Î£ that are not contained in Ïƒ</span></span><br><span class="line"><span class="string">and xË†Ïƒ âˆ¶=âˆÏâˆˆË†Ïƒ xÏ is the associated monomial in S.</span></span><br><span class="line"><span class="string">Deï¬nition 2.2. The irrelevant ideal of Pd</span></span><br><span class="line"><span class="string">Î£ is the monomial ideal BÎ£ âˆ¶=&lt; xË†Ïƒ /divides.alt0 Ïƒ âˆˆ Î£ &gt; and</span></span><br><span class="line"><span class="string">the zero locus Z(Î£ )âˆ¶=V(BÎ£ ) in the aï¬ƒne space Ad âˆ¶=Spec(S) is the irrelevant locus.</span></span><br><span class="line"><span class="string">Proposition 2.3 (Theorem 5.1.11 [5]) . The toric variety Pd</span></span><br><span class="line"><span class="string">Î£ is a categorical quotient</span></span><br><span class="line"><span class="string">Ad âˆ–Z(Î£ ) by the group Hom(Cl(Î£ ), Câˆ—) and the group action is induced by the Cl(Î£ )-</span></span><br><span class="line"><span class="string">grading of S.</span></span><br><span class="line"><span class="string">2.2 Orbifolds</span></span><br><span class="line"><span class="string">Now we give a brief introduction to complex orbifolds and we mention th e needed theorems</span></span><br><span class="line"><span class="string">for the next section. Namely: de Rham theorem and Dolbeault theor em for complex</span></span><br><span class="line"><span class="string">orbifolds.</span></span><br><span class="line"><span class="string">Deï¬nition 2.4. A complex orbifold of complex dimension d is a singular complex space</span></span><br><span class="line"><span class="string">whose singularities are locally isomorphic to quotient sin gularities Cd/slash.left G, for ï¬nite sub-</span></span><br><span class="line"><span class="string">groups G âŠ‚Gl(d, C).</span></span><br><span class="line"><span class="string">Deï¬nition 2.5. A diï¬€erential form on a complex orbifold Z is deï¬ned locally at z âˆˆZ as</span></span><br><span class="line"><span class="string">a G-invariant diï¬€erential form on Cd where G âŠ‚ Gl(d, C) and Z is locally isomorphic to</span></span><br><span class="line"><span class="string">Cd/slash.left G around z.</span></span><br><span class="line"><span class="string">Roughly speaking the local geometry of orbifolds reduces to local G-invariant geometry.</span></span><br><span class="line"><span class="string">We have a complex of diï¬€erential forms (Aâ—(Z), d )and a double complex (Aâ—, â—(Z), âˆ‚, Â¯âˆ‚)</span></span><br><span class="line"><span class="string">of bigraded diï¬€erential forms which deï¬ne the de Rham and the Dolbe ault cohomology</span></span><br><span class="line"><span class="string">groups (for a ï¬xed p âˆˆN) respectively:</span></span><br><span class="line"><span class="string">Hâ—</span></span><br><span class="line"><span class="string">dR(Z, C)âˆ¶= kerd</span></span><br><span class="line"><span class="string">im d and Hp, â—(Z, Â¯âˆ‚)âˆ¶= ker Â¯âˆ‚</span></span><br><span class="line"><span class="string">im Â¯âˆ‚</span></span><br><span class="line"><span class="string">Theorem 2.6 (Theorem 3.4.4 in [4] and Theorem 1.2 in [1] ) . Let Z be a compact complex</span></span><br><span class="line"><span class="string">orbifold. There are natural isomorphisms:</span></span><br><span class="line"><span class="string">3&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 2, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;3&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;â€¢ Hâ—</span></span><br><span class="line"><span class="string">dR(Z, C)â‰ƒHâ—(Z, C)</span></span><br><span class="line"><span class="string">â€¢ Hp, â—(Z, Â¯âˆ‚)â‰ƒHâ—(X, â„¦ p</span></span><br><span class="line"><span class="string">Z )</span></span><br><span class="line"><span class="string">3 (1,1)-Lefschetz theorem for projective toric orbifolds</span></span><br><span class="line"><span class="string">Deï¬nition 3.1. A subvariety X âŠ‚Pd</span></span><br><span class="line"><span class="string">Î£ is quasi-smooth if V(IX )âŠ‚A#Î£ (1) is smooth outside</span></span><br><span class="line"><span class="string">Z(Î£ ).</span></span><br><span class="line"><span class="string">Example 3.2. Quasi-smooth hypersurfaces or more generally quasi-smooth inte rsection sub-</span></span><br><span class="line"><span class="string">varieties are quasi-smooth subvarieties (see [2] or [7] for more det ails).</span></span><br><span class="line"><span class="string">â–³</span></span><br><span class="line"><span class="string">Remark 3.3. Quasi-smooth subvarieties are suborbifolds of Pd</span></span><br><span class="line"><span class="string">Î£ in the sense of Satake in [8].</span></span><br><span class="line"><span class="string">Intuitively speaking they are subvarieties whose only singularities co me from the ambient</span></span><br><span class="line"><span class="string">space.</span></span><br><span class="line"><span class="string">â–³</span></span><br><span class="line"><span class="string">Theorem 3.4. Let X âŠ‚ Pd</span></span><br><span class="line"><span class="string">Î£ be a quasi-smooth subvariety. Then every (1, 1)-cohomology</span></span><br><span class="line"><span class="string">class Î» âˆˆH1, 1(X)âˆ©H2(X, Z) is algebraic</span></span><br><span class="line"><span class="string">Proof. From the exponential short exact sequence</span></span><br><span class="line"><span class="string">0 â†’Z â†’OX â†’Oâˆ—</span></span><br><span class="line"><span class="string">X â†’0</span></span><br><span class="line"><span class="string">we have a long exact sequence in cohomology</span></span><br><span class="line"><span class="string">H1(Oâˆ—</span></span><br><span class="line"><span class="string">X )â†’H2(X, Z) â†’H2(OX )â‰ƒH0, 2(X)</span></span><br><span class="line"><span class="string">where the last isomorphisms is due to Steenbrink in [9]. Now, it is enoug h to prove the</span></span><br><span class="line"><span class="string">commutativity of the next diagram</span></span><br><span class="line"><span class="string">H2(X, Z) â†’ â†’ </span></span><br><span class="line"><span class="string">â†“ â†“ </span></span><br><span class="line"><span class="string">H2(X, OX )</span></span><br><span class="line"><span class="string">â‰ƒ Dolbeault</span></span><br><span class="line"><span class="string">â†“ â†“ </span></span><br><span class="line"><span class="string">H2(X, C)</span></span><br><span class="line"><span class="string">de Rham â‰ƒ</span></span><br><span class="line"><span class="string">â†“ â†“ </span></span><br><span class="line"><span class="string">H2</span></span><br><span class="line"><span class="string">dR(X, C) â†’ â†’ H0, 2</span></span><br><span class="line"><span class="string">Â¯âˆ‚ (X)</span></span><br><span class="line"><span class="string">4&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 3, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;4&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;The key points are the de Rham and Dolbeaultâ€™s isomorphisms for orbif olds. The rest</span></span><br><span class="line"><span class="string">of the proof follows as the (1, 1)-Lefschetz theorem in [6].</span></span><br><span class="line"><span class="string">Remark 3.5. For k = 1 and Pd</span></span><br><span class="line"><span class="string">Î£ as the projective space, we recover the classical (1, 1)-</span></span><br><span class="line"><span class="string">Lefschetz theorem.</span></span><br><span class="line"><span class="string">â–³</span></span><br><span class="line"><span class="string">By the Hard Lefschetz Theorem for projective orbifolds (see [11] for details) we get an</span></span><br><span class="line"><span class="string">isomorphism of cohomologies :</span></span><br><span class="line"><span class="string">Hâ—(X, Q) â‰ƒH2 dim Xâˆ’â—(X, Q)</span></span><br><span class="line"><span class="string">given by the Lefschetz morphism and since it is a morphism of Hodge st ructures, we have:</span></span><br><span class="line"><span class="string">H1, 1(X, Q) â‰ƒHdim Xâˆ’1, dim Xâˆ’1(X, Q)</span></span><br><span class="line"><span class="string">For X as before:</span></span><br><span class="line"><span class="string">Corollary 3.6. If the dimension of X is 1, 2 or 3. The Hodge conjecture holds on X.</span></span><br><span class="line"><span class="string">Proof. If the dimCX = 1 the result is clear by the Hard Lefschetz theorem for projective</span></span><br><span class="line"><span class="string">orbifolds. The dimension 2 and 3 cases are covered by Theorem 3.5 an d the Hard Lefschetz.</span></span><br><span class="line"><span class="string">theorem.4 Cayley trick and Cayley proposition</span></span><br><span class="line"><span class="string">The Cayley trick is a way to associate to a quasi-smooth intersection subvariety a quasi-</span></span><br><span class="line"><span class="string">smooth hypersurface. Let L1, . . . , L s be line bundles on Pd</span></span><br><span class="line"><span class="string">Î£ and let Ï€ âˆ¶ P(E) â†’ Pd</span></span><br><span class="line"><span class="string">Î£ be the</span></span><br><span class="line"><span class="string">projective space bundle associated to the vector bundle E =L1 âŠ•â‹¯âŠ• Ls. It is known that</span></span><br><span class="line"><span class="string">P(E) is a (d +s âˆ’1)-dimensional simplicial toric variety whose fan depends on the degre es</span></span><br><span class="line"><span class="string">of the line bundles and the fan Î£. Furthermore, if the Cox ring, witho ut considering the</span></span><br><span class="line"><span class="string">grading, of Pd</span></span><br><span class="line"><span class="string">Î£ is C[x1, . . . , x m] then the Cox ring of P(E) is</span></span><br><span class="line"><span class="string">C[x1, . . . , x m, y 1, . . . , y s]</span></span><br><span class="line"><span class="string">Moreover for X a quasi-smooth intersection subvariety cut oï¬€ by f1, . . . , f s with deg(fi)=</span></span><br><span class="line"><span class="string">[Li] we relate the hypersurface Y cut oï¬€ by F = y1f1 +â‹…â‹…â‹…+ ysfs which turns out to be</span></span><br><span class="line"><span class="string">quasi-smooth. For more details see Section 2 in [7].</span></span><br><span class="line"><span class="string">5&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 4, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;5&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;We will denote P(E) as Pd+sâˆ’1</span></span><br><span class="line"><span class="string">Î£ ,X to keep track of its relation with X and Pd</span></span><br><span class="line"><span class="string">Î£ .</span></span><br><span class="line"><span class="string">The following is a key remark.</span></span><br><span class="line"><span class="string">Remark 4.1. There is a morphism Î¹âˆ¶X â†’Y âŠ‚Pd+sâˆ’1</span></span><br><span class="line"><span class="string">Î£ ,X . Moreover every point z âˆ¶=(x, y )âˆˆY</span></span><br><span class="line"><span class="string">with y â‰  0 has a preimage. Hence for any subvariety W = V(IW ) âŠ‚ X âŠ‚ Pd</span></span><br><span class="line"><span class="string">Î£ there exists</span></span><br><span class="line"><span class="string">W â€² âŠ‚Y âŠ‚Pd+sâˆ’1</span></span><br><span class="line"><span class="string">Î£ ,X such that Ï€(W â€²)=W , i.e., W â€² =&#123;z =(x, y ) /divides.alt0 x âˆˆW &#125;.</span></span><br><span class="line"><span class="string">â–³</span></span><br><span class="line"><span class="string">For X âŠ‚ Pd</span></span><br><span class="line"><span class="string">Î£ a quasi-smooth intersection variety the morphism in cohomology indu ced</span></span><br><span class="line"><span class="string">by the inclusion iâˆ— âˆ¶Hdâˆ’s(Pd</span></span><br><span class="line"><span class="string">Î£ , C)â†’Hdâˆ’s(X, C) is injective by Proposition 1.4 in [7].</span></span><br><span class="line"><span class="string">Deï¬nition 4.2. The primitive cohomology of Hdâˆ’s</span></span><br><span class="line"><span class="string">prim(X)is the quotient Hdâˆ’s(X, C)/slash.left iâˆ—(Hdâˆ’s(Pd</span></span><br><span class="line"><span class="string">Î£ , C))</span></span><br><span class="line"><span class="string">and Hdâˆ’s</span></span><br><span class="line"><span class="string">prim(X, Q) with rational coeï¬ƒcients.</span></span><br><span class="line"><span class="string">Hdâˆ’s(Pd</span></span><br><span class="line"><span class="string">Î£ , C) and Hdâˆ’s(X, C) have pure Hodge structures, and the morphism iâˆ— is com-</span></span><br><span class="line"><span class="string">patible with them, so that Hdâˆ’s</span></span><br><span class="line"><span class="string">prim(X) gets a pure Hodge structure.</span></span><br><span class="line"><span class="string">The next Proposition is the Cayley proposition.</span></span><br><span class="line"><span class="string">Proposition 4.3. [Proposition 2.3 in [3] ] Let X =X1 âˆ©â‹…â‹…â‹…âˆ© Xs be a quasi-smooth intersec-</span></span><br><span class="line"><span class="string">tion subvariety in Pd</span></span><br><span class="line"><span class="string">Î£ cut oï¬€ by homogeneous polynomials f1 . . . f s. Then for p â‰  d+sâˆ’1</span></span><br><span class="line"><span class="string">2 , d+sâˆ’3</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">Hpâˆ’1,d +sâˆ’1âˆ’p</span></span><br><span class="line"><span class="string">prim (Y )â‰ƒHpâˆ’s,d âˆ’p</span></span><br><span class="line"><span class="string">prim (X).</span></span><br><span class="line"><span class="string">Corollary 4.4. If d +s =2(k +1),</span></span><br><span class="line"><span class="string">Hk+1âˆ’s,k +1âˆ’s</span></span><br><span class="line"><span class="string">prim (X)â‰ƒHk,k</span></span><br><span class="line"><span class="string">prim(Y )</span></span><br><span class="line"><span class="string">Remark 4.5. The above isomorphisms are also true with rational coeï¬ƒcients since Hâ—(X, C) =</span></span><br><span class="line"><span class="string">Hâ—(X, Q)âŠ—Q C. See the beginning of Section 7.1 in [10] for more details.</span></span><br><span class="line"><span class="string">â–³</span></span><br><span class="line"><span class="string">5 Main result</span></span><br><span class="line"><span class="string">Theorem 5.1. Let Y =&#123;F =y1f1 +â‹¯+ ykfk =0&#125;âŠ‚P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X be the quasi-smooth hypersurface</span></span><br><span class="line"><span class="string">associated to the quasi-smooth intersection surface X = Xf1 âˆ©â‹…â‹…â‹…âˆ© Xfk âŠ‚ Pk+2</span></span><br><span class="line"><span class="string">Î£ . Then on Y</span></span><br><span class="line"><span class="string">the Hodge conjecture holds.</span></span><br><span class="line"><span class="string">Proof. If Hk,k</span></span><br><span class="line"><span class="string">prim(X, Q) = 0 we are done. So let us assume Hk,k</span></span><br><span class="line"><span class="string">prim(X, Q) â‰  0. By the Cayley</span></span><br><span class="line"><span class="string">proposition Hk,k</span></span><br><span class="line"><span class="string">prim(Y, Q) â‰ƒ H1, 1</span></span><br><span class="line"><span class="string">prim(X, Q) and by the (1, 1)-Lefschetz theorem for projective</span></span><br><span class="line"><span class="string">6&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 5, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;6&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;toric orbifolds there is a non-zero algebraic basis Î»C1 , . . . , Î» Cn with rational coeï¬ƒcients of</span></span><br><span class="line"><span class="string">H1, 1</span></span><br><span class="line"><span class="string">prim(X, Q), that is, there are n âˆ¶=h1, 1</span></span><br><span class="line"><span class="string">prim(X, Q) algebraic curves C1, . . . , C n in X such that</span></span><br><span class="line"><span class="string">under the PoincarÂ´ e duality the class in homology [Ci] goes to Î»Ci , [Ci] â†¦ Î»Ci . Recall</span></span><br><span class="line"><span class="string">that the Cox ring of Pk+2 is contained in the Cox ring of P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X without considering the</span></span><br><span class="line"><span class="string">grading. Considering the grading we have that if Î± âˆˆ Cl(Pk+2</span></span><br><span class="line"><span class="string">Î£ ) then (Î±, 0) âˆˆ Cl(P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X ). So</span></span><br><span class="line"><span class="string">the polynomials deï¬ning Ci âŠ‚ Pk+2</span></span><br><span class="line"><span class="string">Î£ can be interpreted in P2k+1</span></span><br><span class="line"><span class="string">X, Î£ but with diï¬€erent degree.</span></span><br><span class="line"><span class="string">Moreover, by Remark 4.1 each Ci is contained in Y = &#123;F = y1f1 + â‹¯ + ykfk = 0&#125; and</span></span><br><span class="line"><span class="string">furthermore it has codimension k.</span></span><br><span class="line"><span class="string">Claim: &#123;Î»Ci &#125;n</span></span><br><span class="line"><span class="string">i=1 is a basis of Hk,k</span></span><br><span class="line"><span class="string">prim(Y, Q).</span></span><br><span class="line"><span class="string">It is enough to prove that Î»Ci is diï¬€erent from zero in Hk,k</span></span><br><span class="line"><span class="string">prim(Y, Q) or equivalently that the</span></span><br><span class="line"><span class="string">cohomology classes &#123;Î»Ci &#125;n</span></span><br><span class="line"><span class="string">i=1 do not come from the ambient space. By contradiction, let us</span></span><br><span class="line"><span class="string">assume that there exists a j and C âŠ‚P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X such that Î»C âˆˆHk,k (P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X , Q) with iâˆ—(Î»C )=Î»Cj</span></span><br><span class="line"><span class="string">or in terms of homology there exists a (k +2)-dimensional algebraic subvariety V âŠ‚ P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X</span></span><br><span class="line"><span class="string">such that V âˆ©Y = Cj so they are equal as a homology class of P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X ,i.e., [V âˆ©Y ] = [Cj] .</span></span><br><span class="line"><span class="string">It is easy to check that Ï€(V )âˆ©X =Cj as a subvariety of Pk+2</span></span><br><span class="line"><span class="string">Î£ where Ï€ âˆ¶ (x, y )â†¦x. Hence</span></span><br><span class="line"><span class="string">[Ï€(V )âˆ©X] = [Cj] which is equivalent to say that Î»Cj comes from Pk+2</span></span><br><span class="line"><span class="string">Î£ which contradicts</span></span><br><span class="line"><span class="string">the choice of [Cj].</span></span><br><span class="line"><span class="string">Remark 5.2. Into the proof of the previous theorem, the key fact was that on X the</span></span><br><span class="line"><span class="string">Hodge conjecture holds and we translate it to Y by contradiction. So, using an analogous</span></span><br><span class="line"><span class="string">argument we have:</span></span><br><span class="line"><span class="string">â–³</span></span><br><span class="line"><span class="string">Proposition 5.3. Let Y =&#123;F =y1fs+â‹¯+ysfs =0&#125;âŠ‚P2k+1</span></span><br><span class="line"><span class="string">Î£ ,X be the quasi-smooth hypersurface</span></span><br><span class="line"><span class="string">associated to a quasi-smooth intersection subvariety X = Xf1 âˆ© â‹…â‹…â‹… âˆ© Xfs âŠ‚ Pd</span></span><br><span class="line"><span class="string">Î£ such that</span></span><br><span class="line"><span class="string">d +s =2(k +1). If the Hodge conjecture holds on X then it holds as well on Y .</span></span><br><span class="line"><span class="string">Corollary 5.4. If the dimension of Y is 2s âˆ’1, 2s or 2s +1 then the Hodge conjecture</span></span><br><span class="line"><span class="string">holds on Y .</span></span><br><span class="line"><span class="string">Proof. By Proposition 5.3 and Corollary 3.6.</span></span><br><span class="line"><span class="string">7&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 6, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;7&#x27;</span>&#125;</span><br><span class="line">page_content=<span class="string">&#x27;References</span></span><br><span class="line"><span class="string">[1] Angella, D. Cohomologies of certain orbifolds. Journal of Geometry and Physics</span></span><br><span class="line"><span class="string">71 (2013), 117â€“126.</span></span><br><span class="line"><span class="string">[2] Batyrev, V. V., and Cox, D. A.On the Hodge structure of projective hypersur-</span></span><br><span class="line"><span class="string">faces in toric varieties. Duke Mathematical Journal 75, 2 (Aug 199 4).</span></span><br><span class="line"><span class="string">[3] Bruzzo, U., and Montoya, W. On the Hodge conjecture for quasi-smooth in-</span></span><br><span class="line"><span class="string">tersections in toric varieties. SËœ ao Paulo J. Math. Sci. Special Section: Geometry in</span></span><br><span class="line"><span class="string">Algebra and Algebra in Geometry (2021).</span></span><br><span class="line"><span class="string">[4] Caramello Jr, F. C.Introduction to orbifolds. arXiv:1909.08699v6 (2019).</span></span><br><span class="line"><span class="string">[5] Cox, D., Little, J., and Schenck, H.Toric varieties, vol. 124. American Math-</span></span><br><span class="line"><span class="string">ematical Soc., 2011.</span></span><br><span class="line"><span class="string">[6] Griffiths, P., and Harris, J. Principles of Algebraic Geometry. John Wiley &amp;</span></span><br><span class="line"><span class="string">Sons, Ltd, 1978.</span></span><br><span class="line"><span class="string">[7] Mavlyutov, A. R. Cohomology of complete intersections in toric varieties. Pub-</span></span><br><span class="line"><span class="string">lished in Paciï¬c J. of Math. 191 No. 1 (1999), 133â€“144.</span></span><br><span class="line"><span class="string">[8] Satake, I. On a Generalization of the Notion of Manifold. Proceedings of the</span></span><br><span class="line"><span class="string">National Academy of Sciences of the United States of America 42, 6 (1956), 359â€“363.</span></span><br><span class="line"><span class="string">[9] Steenbrink, J. H. M.Intersection form for quasi-homogeneous singularities. Com-</span></span><br><span class="line"><span class="string">positio Mathematica 34 , 2 (1977), 211â€“223.</span></span><br><span class="line"><span class="string">[10] Voisin, C. Hodge Theory and Complex Algebraic Geometry I, vol. 1 of Cambridge</span></span><br><span class="line"><span class="string">Studies in Advanced Mathematics . Cambridge University Press, 2002.</span></span><br><span class="line"><span class="string">[11] W ang, Z. Z., and Zaffran, D.A remark on the Hard Lefschetz theorem for KÂ¨ ahler</span></span><br><span class="line"><span class="string">orbifolds. Proceedings of the American Mathematical Society 137 , 08 (Aug 2009).</span></span><br><span class="line"><span class="string">8&#x27;</span> metadata=&#123;<span class="string">&#x27;producer&#x27;</span>: <span class="string">&#x27;dvips + GPL Ghostscript GIT PRERELEASE 9.22&#x27;</span>, <span class="string">&#x27;creator&#x27;</span>: <span class="string">&#x27;LaTeX with hyperref&#x27;</span>, <span class="string">&#x27;creationdate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;moddate&#x27;</span>: <span class="string">&#x27;2023-02-08T20:27:28-05:00&#x27;</span>, <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;subject&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;author&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;keywords&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;https://arxiv.org/pdf/2302.03803&#x27;</span>, <span class="string">&#x27;total_pages&#x27;</span>: 8, <span class="string">&#x27;page&#x27;</span>: 7, <span class="string">&#x27;page_label&#x27;</span>: <span class="string">&#x27;8&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹3ï¼šä½¿ç”¨load-and-split"><a href="#ä¸¾ä¾‹3ï¼šä½¿ç”¨load-and-split" class="headerlink" title="ä¸¾ä¾‹3ï¼šä½¿ç”¨load_and_split()"></a>ä¸¾ä¾‹3ï¼šä½¿ç”¨load_and_split()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³çš„ä¾èµ– PyPDFLoader() </span></span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> PyPDFLoader </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å®šä¹‰PyPDFLoader </span></span><br><span class="line">py_pdfLoader = PyPDFLoader(file_path= <span class="string">&quot;./asset/load/load.pdf&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.åŠ è½½ </span></span><br><span class="line">docs = py_pdfLoader.load_and_split() <span class="comment">#åº•å±‚é»˜è®¤ä½¿ç”¨äº†é€’å½’å­—ç¬¦æ–‡æœ¬åˆ‡åˆ†å™¨ </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (docs)</span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œå¯¹äº PyPDFLoader ï¼Œä¾ç„¶æ˜¯ä½¿ç”¨ .page_content å’Œ .metadata å»è®¿é—®æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€ä¸ª æ–‡æ¡£åŠ è½½å™¨è™½ç„¶ä»£ç é€»è¾‘ä¸åŒï¼Œåº”ç”¨éœ€æ±‚ä¸åŒï¼Œä½†ä½¿ç”¨æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚</p><h2 id="åŠ è½½CSV"><a href="#åŠ è½½CSV" class="headerlink" title="åŠ è½½CSV"></a>åŠ è½½CSV</h2><h3 id="ä¸¾ä¾‹1ï¼šåŠ è½½csvæ‰€æœ‰åˆ—"><a href="#ä¸¾ä¾‹1ï¼šåŠ è½½csvæ‰€æœ‰åˆ—" class="headerlink" title="ä¸¾ä¾‹1ï¼šåŠ è½½csvæ‰€æœ‰åˆ—"></a>ä¸¾ä¾‹1ï¼šåŠ è½½csvæ‰€æœ‰åˆ—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> CSVLoader  </span><br><span class="line">  </span><br><span class="line">csv_loader = CSVLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/03-load.csv&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = csv_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(docs)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(doc)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">[Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 0&#125;, page_content=<span class="string">&#x27;id: 1\ntitle: Introduction to Python\ncontent: Python is a popular programming language.\nauthor: John Doe&#x27;</span>), Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 1&#125;, page_content=<span class="string">&#x27;id: 2\ntitle: Data Science Basics\ncontent: Data science involves statistics and machine learning.\nauthor: Jane Smith&#x27;</span>), Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 2&#125;, page_content=<span class="string">&#x27;id: 3\ntitle: Web Development\ncontent: HTML, CSS and JavaScript are core web technologies.\nauthor: Mike Johnson&#x27;</span>), Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 3&#125;, page_content=<span class="string">&#x27;id: 4\ntitle: Artificial Intelligence\ncontent: AI is transforming many industries.\nauthor: Sarah Williams&#x27;</span>)]</span><br><span class="line">page_content=<span class="string">&#x27;id: 1</span></span><br><span class="line"><span class="string">title: Introduction to Python</span></span><br><span class="line"><span class="string">content: Python is a popular programming language.</span></span><br><span class="line"><span class="string">author: John Doe&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 0&#125;</span><br><span class="line">page_content=<span class="string">&#x27;id: 2</span></span><br><span class="line"><span class="string">title: Data Science Basics</span></span><br><span class="line"><span class="string">content: Data science involves statistics and machine learning.</span></span><br><span class="line"><span class="string">author: Jane Smith&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 1&#125;</span><br><span class="line">page_content=<span class="string">&#x27;id: 3</span></span><br><span class="line"><span class="string">title: Web Development</span></span><br><span class="line"><span class="string">content: HTML, CSS and JavaScript are core web technologies.</span></span><br><span class="line"><span class="string">author: Mike Johnson&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 2&#125;</span><br><span class="line">page_content=<span class="string">&#x27;id: 4</span></span><br><span class="line"><span class="string">title: Artificial Intelligence</span></span><br><span class="line"><span class="string">content: AI is transforming many industries.</span></span><br><span class="line"><span class="string">author: Sarah Williams&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/03-load.csv&#x27;</span>, <span class="string">&#x27;row&#x27;</span>: 3&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼šåŠ è½½æŒ‡å®šåˆ—"><a href="#ä¸¾ä¾‹2ï¼šåŠ è½½æŒ‡å®šåˆ—" class="headerlink" title="ä¸¾ä¾‹2ï¼šåŠ è½½æŒ‡å®šåˆ—"></a>ä¸¾ä¾‹2ï¼šåŠ è½½æŒ‡å®šåˆ—</h3><p>ä½¿ç”¨ source_column å‚æ•°æŒ‡å®šæ–‡ä»¶åŠ è½½çš„åˆ—ï¼Œä¿å­˜åœ¨sourceå˜é‡ä¸­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> CSVLoader  </span><br><span class="line">  </span><br><span class="line">csv_loader = CSVLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/03-load.csv&quot;</span>,  </span><br><span class="line">    source_column=<span class="string">&quot;author&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = csv_loader.load()  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(docs)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Document(metadata=&#123;<span class="built_in">source</span>: John Doe, row: 0&#125;, page_content=<span class="built_in">id</span>: 1\ntitle: Introduction to Python\ncontent: Python is a popular programming language.\nauthor: John Doe), Document(metadata=&#123;<span class="built_in">source</span>: Jane Smith, row: 1&#125;, page_content=<span class="built_in">id</span>: 2\ntitle: Data Science Basics\ncontent: Data science involves statistics and machine learning.\nauthor: Jane Smith), Document(metadata=&#123;<span class="built_in">source</span>: Mike Johnson, row: 2&#125;, page_content=<span class="built_in">id</span>: 3\ntitle: Web Development\ncontent: HTML, CSS and JavaScript are core web technologies.\nauthor: Mike Johnson), Document(metadata=&#123;<span class="built_in">source</span>: Sarah Williams, row: 3&#125;, page_content=<span class="built_in">id</span>: 4\ntitle: Artificial Intelligence\ncontent: AI is transforming many industries.\nauthor: Sarah Williams)]</span><br></pre></td></tr></table></figure><h2 id="åŠ è½½JSON"><a href="#åŠ è½½JSON" class="headerlink" title="åŠ è½½JSON"></a>åŠ è½½JSON</h2><p>LangChainæä¾›çš„JSONæ ¼å¼çš„æ–‡æ¡£åŠ è½½å™¨æ˜¯<strong>JSONLoader</strong>ã€‚åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼ŒJSONæ ¼å¼çš„æ•°æ®å æœ‰ å¾ˆå¤§æ¯”ä¾‹ï¼Œè€Œä¸”JSONçš„å½¢å¼ä¹Ÿæ˜¯å¤šæ ·çš„ã€‚æˆ‘ä»¬éœ€è¦ç‰¹åˆ«å…³æ³¨ã€‚ </p><p>JSONLoader ä½¿ç”¨æŒ‡å®šçš„ jqç»“æ„æ¥è§£æ JSON æ–‡ä»¶ã€‚jqæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å‘½ä»¤è¡Œ JSON å¤„ç†å™¨ ï¼Œå¯ä»¥å¯¹ JSON æ ¼å¼çš„æ•°æ®è¿›è¡Œå„ç§å¤æ‚çš„å¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®è¿‡æ»¤ã€æ˜ å°„ã€å‡å°‘å’Œè½¬æ¢ï¼Œæ˜¯å¤„ç† JSON æ•°æ®çš„é¦–é€‰ å·¥å…·ä¹‹ä¸€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install jq</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹1ï¼šä½¿ç”¨JSONLoaderæ–‡æ¡£åŠ è½½å™¨åŠ è½½"><a href="#ä¸¾ä¾‹1ï¼šä½¿ç”¨JSONLoaderæ–‡æ¡£åŠ è½½å™¨åŠ è½½" class="headerlink" title="ä¸¾ä¾‹1ï¼šä½¿ç”¨JSONLoaderæ–‡æ¡£åŠ è½½å™¨åŠ è½½"></a>ä¸¾ä¾‹1ï¼šä½¿ç”¨JSONLoaderæ–‡æ¡£åŠ è½½å™¨åŠ è½½</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> JSONLoader  </span><br><span class="line">  </span><br><span class="line">json_loader = JSONLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/04-load.json&quot;</span>,  </span><br><span class="line">    jq_schema=<span class="string">&quot;.&quot;</span>, <span class="comment">#è¡¨ç¤ºåŠ è½½æ‰€æœ‰çš„å­—æ®µ  </span></span><br><span class="line">    text_content=<span class="literal">False</span>, <span class="comment">#å°†åŠ è½½çš„jsonå¯¹è±¡è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = json_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(docs)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;E:\\myjupyte\\å°šç¡…è°·LangChain\\chapter07-RAG\\asset\\load\\04-load.json&#x27;</span>, <span class="string">&#x27;seq_num&#x27;</span>: 1&#125;, page_content=<span class="string">&#x27;&#123;&quot;messages&quot;: [&#123;&quot;sender&quot;: &quot;Alice&quot;, &quot;content&quot;: &quot;Hello, how are you today?&quot;, &quot;timestamp&quot;: &quot;2023-05-15T10:00:00&quot;&#125;, &#123;&quot;sender&quot;: &quot;Bob&quot;, &quot;content&quot;: &quot;I\&#x27;</span>m doing well, thanks <span class="keyword">for</span> asking!<span class="string">&quot;, &quot;</span>timestamp<span class="string">&quot;: &quot;</span>2023-05-15T10:02:00<span class="string">&quot;&#125;, &#123;&quot;</span>sender<span class="string">&quot;: &quot;</span>Alice<span class="string">&quot;, &quot;</span>content<span class="string">&quot;: &quot;</span>Would you like to meet <span class="keyword">for</span> lunch?<span class="string">&quot;, &quot;</span>timestamp<span class="string">&quot;: &quot;</span>2023-05-15T10:05:00<span class="string">&quot;&#125;, &#123;&quot;</span>sender<span class="string">&quot;: &quot;</span>Bob<span class="string">&quot;, &quot;</span>content<span class="string">&quot;: &quot;</span>Sure, that sounds great!<span class="string">&quot;, &quot;</span>timestamp<span class="string">&quot;: &quot;</span>2023-05-15T10:07:00<span class="string">&quot;&#125;], &quot;</span>conversation_id<span class="string">&quot;: &quot;</span>conv_12345<span class="string">&quot;, &quot;</span>participants<span class="string">&quot;: [&quot;</span>Alice<span class="string">&quot;, &quot;</span>Bob<span class="string">&quot;]&#125;&#x27;)]</span></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼šåŠ è½½jsonæ–‡ä»¶ä¸­messages-ä¸­çš„æ‰€æœ‰çš„contentå­—æ®µ"><a href="#ä¸¾ä¾‹2ï¼šåŠ è½½jsonæ–‡ä»¶ä¸­messages-ä¸­çš„æ‰€æœ‰çš„contentå­—æ®µ" class="headerlink" title="ä¸¾ä¾‹2ï¼šåŠ è½½jsonæ–‡ä»¶ä¸­messages[]ä¸­çš„æ‰€æœ‰çš„contentå­—æ®µ"></a>ä¸¾ä¾‹2ï¼šåŠ è½½jsonæ–‡ä»¶ä¸­messages[]ä¸­çš„æ‰€æœ‰çš„contentå­—æ®µ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> JSONLoader  </span><br><span class="line">  </span><br><span class="line">json_loader = JSONLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/04-load.json&quot;</span>,  </span><br><span class="line">    jq_schema=<span class="string">&quot;.messages[].content&quot;</span>, <span class="comment">#åŠ è½½messages[]çš„æ‰€æœ‰çš„contentå­—æ®µ  </span></span><br><span class="line">    <span class="comment">#text_content=False, #å°†åŠ è½½çš„jsonå¯¹è±¡è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = json_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(doc.page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hello, how are you today?</span><br><span class="line">I&#x27;m doing well, thanks for asking!</span><br><span class="line">Would you like to meet for lunch?</span><br><span class="line">Sure, that sounds great!</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹3ï¼šæå–04-response-jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨-data-items-content-çš„æ–‡æœ¬"><a href="#ä¸¾ä¾‹3ï¼šæå–04-response-jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨-data-items-content-çš„æ–‡æœ¬" class="headerlink" title="ä¸¾ä¾‹3ï¼šæå–04-response.jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨ data.items[].content çš„æ–‡æœ¬"></a>ä¸¾ä¾‹3ï¼šæå–04-response.jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨ data.items[].content çš„æ–‡æœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> JSONLoader  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼1ï¼š  </span></span><br><span class="line"><span class="comment"># json_loader = JSONLoader(  </span></span><br><span class="line"><span class="comment">#     file_path=&quot;./asset/load/04-response.json&quot;,  </span></span><br><span class="line"><span class="comment">#     jq_schema=&quot;.data.items[].content&quot;, #data.items[].content  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼š  </span></span><br><span class="line">json_loader = JSONLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/04-response.json&quot;</span>,  </span><br><span class="line">    jq_schema=<span class="string">&quot;.data.items[]&quot;</span>, <span class="comment">#data.items[].content  </span></span><br><span class="line">    content_key=<span class="string">&quot;.content&quot;</span>,  </span><br><span class="line">    is_content_key_jq_parsable=<span class="literal">True</span>, <span class="comment">#ç”¨jqè§£æcontent_key  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = json_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(doc.page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This article explains how to parse API responses...</span><br><span class="line">Learn to handle nested structures with...</span><br><span class="line">Best practices <span class="keyword">for</span> preserving metadata...</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹4ï¼šæå–04-response-jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨-data-items-é‡Œçš„-titleã€content-å’Œ-å…¶æ–‡æœ¬"><a href="#ä¸¾ä¾‹4ï¼šæå–04-response-jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨-data-items-é‡Œçš„-titleã€content-å’Œ-å…¶æ–‡æœ¬" class="headerlink" title="ä¸¾ä¾‹4ï¼šæå–04-response.jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨ data.items[] é‡Œçš„ titleã€content å’Œ å…¶æ–‡æœ¬"></a>ä¸¾ä¾‹4ï¼šæå–04-response.jsonæ–‡ä»¶ä¸­åµŒå¥—åœ¨ data.items[] é‡Œçš„ titleã€content å’Œ å…¶æ–‡æœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> JSONLoader  </span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰jsonæ–‡ä»¶çš„è·¯å¾„  </span></span><br><span class="line">file_path = <span class="string">&#x27;asset/load/04-response.json&#x27;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰JSONLoaderå¯¹è±¡  </span></span><br><span class="line"><span class="comment"># æå–åµŒå¥—åœ¨ data.items[].content çš„æ–‡æœ¬ï¼Œå¹¶ä¿ç•™å…¶ä»–å­—æ®µä½œä¸ºå…ƒæ•°æ®  </span></span><br><span class="line"><span class="comment"># loader = JSONLoader(  </span></span><br><span class="line"><span class="comment">#     file_path=file_path,  </span></span><br><span class="line"><span class="comment">#     # jq_schema=&quot;.data.items[] | &#123;id, author, text: (.title + &#x27;\n&#x27; + .content)&#125;&quot;,  </span></span><br><span class="line"><span class="comment">#     jq_schema=&#x27;&#x27;&#x27;.data.items[] | &#123;  </span></span><br><span class="line"><span class="comment">#     id,  </span></span><br><span class="line"><span class="comment">#     author,  </span></span><br><span class="line"><span class="comment">#     created_at,  </span></span><br><span class="line"><span class="comment">#     title, # ä¿ç•™titleå­—æ®µ  </span></span><br><span class="line"><span class="comment">#     text: (.title + &quot;\n&quot; + .content)  </span></span><br><span class="line"><span class="comment">#     &#125;&#x27;&#x27;&#x27;,  </span></span><br><span class="line"><span class="comment">#     content_key=&quot;.text&quot;,  # å†ä»æ¡ç›®ä¸­æå– content å­—æ®µ  </span></span><br><span class="line"><span class="comment">#     is_content_key_jq_parsable=True  # ç”¨jqè§£æcontent_key  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">loader = JSONLoader(  </span><br><span class="line">    file_path=file_path,  </span><br><span class="line">    <span class="comment"># jq_schema=&quot;.data.items[] | &#123;id, author, text: (.title + &#x27;\n&#x27; + .content)&#125;&quot;,  </span></span><br><span class="line">    jq_schema=<span class="string">&quot;.data.items[]&quot;</span>,  </span><br><span class="line">    content_key=<span class="string">&#x27;.title + &quot;\\n\\n&quot; + .content&#x27;</span>,  </span><br><span class="line">    is_content_key_jq_parsable=<span class="literal">True</span>  <span class="comment"># ç”¨jqè§£æcontent_key  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># loader = JSONLoader(  </span></span><br><span class="line"><span class="comment">#     file_path=file_path,  </span></span><br><span class="line"><span class="comment">#     # jq_schema=&quot;.data.items[] | &#123;id, author, text: (.title + &#x27;\n&#x27; + .content)&#125;&quot;,  </span></span><br><span class="line"><span class="comment">#     jq_schema=&#x27;&#x27;&#x27;  </span></span><br><span class="line"><span class="comment">#         .data.items[] | &#123;  </span></span><br><span class="line"><span class="comment">#             metadata: &#123;  </span></span><br><span class="line"><span class="comment">#                 id,  </span></span><br><span class="line"><span class="comment">#                 author,  </span></span><br><span class="line"><span class="comment">#                 created_at  </span></span><br><span class="line"><span class="comment">#             &#125;,  </span></span><br><span class="line"><span class="comment">#             content: (.title + &quot;\n\n&quot; + .content)  </span></span><br><span class="line"><span class="comment">#         &#125;  </span></span><br><span class="line"><span class="comment">#     &#x27;&#x27;&#x27;,  # æ„å»ºæ–°ç»“æ„  </span></span><br><span class="line"><span class="comment">#      content_key=&#x27;.title + &quot;\\n\\n&quot; + .content&#x27;,  </span></span><br><span class="line"><span class="comment">#     is_content_key_jq_parsable=True  # ç”¨jqè§£æcontent_key  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åŠ è½½  </span></span><br><span class="line">data = loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> data:  </span><br><span class="line">    <span class="built_in">print</span>(doc.page_content)</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Understanding JSONLoader</span><br><span class="line"></span><br><span class="line">This article explains how to parse API responses...</span><br><span class="line">Advanced jq Schema Patterns</span><br><span class="line"></span><br><span class="line">Learn to handle nested structures with...</span><br><span class="line">LangChain Metadata Handling</span><br><span class="line"></span><br><span class="line">Best practices for preserving metadata...</span><br></pre></td></tr></table></figure><h2 id="åŠ è½½HTML-äº†è§£"><a href="#åŠ è½½HTML-äº†è§£" class="headerlink" title="åŠ è½½HTML(äº†è§£)"></a>åŠ è½½HTML(äº†è§£)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install unstructured</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³çš„ä¾èµ–</span></span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> UnstructuredHTMLLoader </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å®šä¹‰UnstructuredHTMLLoaderå¯¹è±¡ </span></span><br><span class="line"><span class="comment"># strategy: </span></span><br><span class="line"><span class="comment"># &quot;fast&quot; è§£æåŠ è½½htmlæ–‡ä»¶é€Ÿåº¦æ˜¯æ¯”è¾ƒå¿«ï¼ˆä½†å¯èƒ½ä¸¢å¤±éƒ¨åˆ†ç»“æ„æˆ–å…ƒæ•°æ®ï¼‰ </span></span><br><span class="line"><span class="comment"># &quot;hi_res&quot;: (é«˜åˆ†è¾¨ç‡è§£æ) è§£æç²¾å‡†ï¼ˆé€Ÿåº¦æ…¢ä¸€äº›ï¼‰ </span></span><br><span class="line"><span class="comment"># &quot;ocr_only&quot; å¼ºåˆ¶ä½¿ç”¨ocræå–æ–‡æœ¬ï¼Œä»…ä»…é€‚ç”¨äºå›¾åƒï¼ˆå¯¹HTMLæ— æ•ˆï¼‰ </span></span><br><span class="line"><span class="comment"># mode ï¼šone of `&#123;&#x27;paged&#x27;, &#x27;elements&#x27;, &#x27;single&#x27;&#125; </span></span><br><span class="line"><span class="comment"># &quot;elements&quot; æŒ‰è¯­ä¹‰å…ƒç´ ï¼ˆæ ‡é¢˜ã€æ®µè½ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰ï¼‰æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„å°æ–‡æ¡£</span></span><br><span class="line"> html_loader = UnstructuredHTMLLoader( </span><br><span class="line"> file_path= <span class="string">&quot;asset/load/05-load.html&quot;</span> , </span><br><span class="line"> mode= <span class="string">&quot;elements&quot;</span> , </span><br><span class="line"> strategy= <span class="string">&quot;fast&quot;</span> ) </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.åŠ è½½</span></span><br><span class="line">docs = html_loader.load() </span><br><span class="line"><span class="built_in">print</span> ( <span class="built_in">len</span> (docs)) <span class="comment"># 16 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.æ‰“å°</span></span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs: </span><br><span class="line"><span class="built_in">print</span> (doc)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">16</span></span><br><span class="line">page_content=&#x27;é¦–å‘äºè‡ªç„¶è¯­è¨€å¤„ç†ç®—æ³•ä¸å®è·µ&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;b082a3e1f4714ffa5f25741f39d82c17&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;RAG<span class="punctuation">:</span>å°†æ£€ç´¢ä¸ç”Ÿæˆæ–¹å¼ç›¸ç»“åˆæ¥åšç”Ÿæˆä»»åŠ¡&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;category_depth&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;kor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;Title&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">46103</span>fd31eae47ed36481d13185af8a9&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;çƒ›ä¹‹æ–‡&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;kor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">46103</span>fd31eae47ed36481d13185af8a9&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;e02798c2e2bb964165a9e9356b82a3f6&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;<span class="number">1</span>ã€å‰è¨€&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;category_depth&#x27;<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">46103</span>fd31eae47ed36481d13185af8a9&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;Title&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">683</span>a24e897e3a9b862ead6c7979a58dc&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;åœ¨ä¸Šä¸€ç¯‡&lt;kNN-NERï¼šåˆ©ç”¨knnè¿‘é‚»ç®—æ³•æ¥åšå‘½åå®ä½“è¯†åˆ«&gt;æåŠåˆ°æ–‡ä¸­æå‡ºkNN-NERæ¡†æ¶æ˜¯ä¸€ç§æ£€ç´¢å¼å¢å¼ºçš„æ–¹æ³•ï¼ˆretrieval augmented methodsï¼‰ï¼Œå°±å»æŸ¥çœ‹æœ‰å…³retrieval augmentedçš„paperï¼Œäº†è§£å…¶æ ¸å¿ƒæ€æƒ³ï¼Œè§‰å¾—æ£€ç´¢å¼å¢å¼ºçš„æ–¹æ³•å¾ˆé€‚åˆè®¸å¤šä¸šåŠ¡åœºæ™¯ä½¿ç”¨ï¼Œå› å…¶ä»¥ä¸€ç§ç®€æ·çš„æ–¹å¼å°†å¤–éƒ¨çŸ¥è¯†èäºæ¨¡å‹ä¸­å»ã€‚ä»Šå¤©å°±åˆ†äº«ä¸€ç¯‡æ¥è‡ªFacebook AI Researchçš„paper&lt;Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks&gt;ï¼Œè®ºæ–‡æå‡ºä¸€ç§æ£€ç´¢å¼å¢å¼ºç”Ÿæˆæ–¹æ³•ï¼Œåº”ç”¨äºçŸ¥è¯†å¯†é›†å‹çš„NLPä»»åŠ¡ï¼ˆå¦‚é—®ç­”ç”Ÿæˆï¼‰ï¼Œè¯¥ç¯‡è®ºæ–‡è¢«<span class="number">2020</span>å¹´NeurIPS ä¼šè®®æ¥æ”¶ã€‚&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;nor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">683</span>a24e897e3a9b862ead6c7979a58dc&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;NarrativeText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;d345b4a58c84984eb1acf1105fd9f214&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;æ–‡ä¸­è¯´åˆ°ï¼Œä»¥BERTä¹‹ç±»çš„å¤§è§„æ¨¡é¢„è®­ç»ƒæ¨¡å‹å°†å¾ˆå¤šäº‹å®çŸ¥è¯†ä¿¡æ¯å­˜å…¥æ¨¡å‹ä¸­ï¼Œå¯ä»¥çœ‹ç€æ˜¯pre-trained parametricç±»å‹ï¼Œå°½ç®¡ä»¥fine-tunedæ–¹å¼åœ¨ä¸‹æ¸¸ä»»åŠ¡å–å¾—æ˜¾è‘—çš„æˆæ•ˆï¼Œä½†è¿™ç±»æ–¹æ³•ä»å­˜åœ¨æ— æ³•ç²¾å‡†åœ°è·å–å’Œæ“ä½œçŸ¥è¯†çš„ç¼ºé™·ã€‚è€Œåœ¨ä¸Šè¿°æåŠçš„é—®é¢˜ä¸Šï¼Œä¼ ç»ŸçŸ¥è¯†æ£€ç´¢çš„æ–¹æ³•èƒ½å¾ˆå¥½çš„åº”å¯¹ï¼Œè¿™ç±»æ–¹æ³•å¯ä»¥çœ‹ç€æ˜¯non-parametric memoryç±»å‹ã€‚äºæ˜¯ï¼Œè®ºæ–‡æå‡ºæ£€ç´¢å¼å¢å¼ºç”Ÿæˆæ–¹æ³•ï¼ˆretrieval-augmented generationï¼ŒRAGï¼‰ï¼Œä¸»è¦æ€æƒ³å°±æ˜¯å°†pre-trained parametricä¸non-parametric memoryç»“åˆèµ·æ¥åšè¯­è¨€ç”Ÿæˆä»»åŠ¡ï¼Œå°†ä¸¤ç±»æ¨¡å‹é›†æˆèµ·æ¥æé«˜ä»»åŠ¡å¤„ç†æ•ˆæœã€‚&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;nor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">683</span>a24e897e3a9b862ead6c7979a58dc&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2</span>fe8d146b5803ec72e5173bf15599710&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;<span class="number">2</span>ã€RAGæ–¹æ³•&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;category_depth&#x27;<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">46103</span>fd31eae47ed36481d13185af8a9&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;Title&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">22</span>ca96c9bf71395b8fbbf0928bd7f292&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;ä¸Šå›¾ä¸ºè®ºæ–‡æå‡ºRAGæ¨¡å‹çš„æ•´ä½“ç¤ºæ„å›¾ã€‚ä¸»è¦åŒ…æ‹¬ä¸¤å¤§æ¨¡å—ï¼šä¸€ä¸ªæ£€ç´¢å™¨ï¼ˆRetrieverï¼Œ p_\\eta(z|x) ï¼‰ + ä¸€ä¸ªç”Ÿæˆå™¨ï¼ˆGeneratorï¼Œ p_\\theta(y_i|x<span class="punctuation">,</span>z<span class="punctuation">,</span>y_<span class="punctuation">&#123;</span><span class="number">1</span><span class="punctuation">:</span>i<span class="number">-1</span><span class="punctuation">&#125;</span>) ï¼‰ã€‚å‰è€…åŒ…æ‹¬query encoderå’Œdocument indexï¼Œåˆ†åˆ«è´Ÿè´£queryçš„ç¼–ç å’Œæ–‡æ¡£çš„ç´¢å¼•ï¼›åè€…æ˜¯ä¸€ä¸ªseq2seqçš„ç”Ÿæˆæ¨¡å‹ã€‚åœ¨æ£€ç´¢ä¸­ï¼Œä½¿ç”¨çš„æ˜¯æœ€å¤§å†…ç§¯æœç´¢çš„æ–¹æ³•ï¼ˆMIPSï¼‰æ¥æ£€ç´¢top-Kç›¸å…³æ–‡æ¡£ã€‚&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;cat&#x27;<span class="punctuation">,</span> &#x27;nor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">22</span>ca96c9bf71395b8fbbf0928bd7f292&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;NarrativeText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">6</span>bbc63aaa7b3afb8d2685e9b3de78a4c&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;<span class="number">3</span>ã€å®éªŒ&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;category_depth&#x27;<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">46103</span>fd31eae47ed36481d13185af8a9&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;Title&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">4</span>df308cd6991fb9e3f0592371bae26be&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;è®ºæ–‡åœ¨å››ç±»Knowledge-Intensive ä»»åŠ¡ä¸Šè¿›è¡Œå®éªŒï¼Œå…·ä½“åŒ…æ‹¬å¼€æ”¾é—®ç­”ï¼ˆOpen-domain Question Answering ï¼‰ã€æ‘˜è¦å¼é—®ç­”ï¼ˆAbstractive Question Answeringï¼‰ ã€å¼€æ”¾é—®é¢˜ç”Ÿæˆï¼ˆJeopardy Question Generationï¼‰ã€äº‹å®åˆ¤æ–­ï¼ˆFact Verification ï¼‰ï¼Œå¹¶ä½¿ç”¨ç»´åŸºç™¾ç§‘ï¼ˆåŒ…å«<span class="number">2100</span>ä¸‡ä¸ªæ–‡æ¡£ï¼‰ä½œä¸ºæ£€ç´¢åº“ã€‚&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;eng&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">4</span>df308cd6991fb9e3f0592371bae26be&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;ed6e043c7fd99ec0824b91725c66e0ba&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;<span class="number">4</span>ã€ç»“è¯­&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;category_depth&#x27;<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">46103</span>fd31eae47ed36481d13185af8a9&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;Title&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95</span>bc5bffaa5cfd41f5242f9f8b330761&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;æœ¬æ¬¡åˆ†äº«åŸºäºæ£€ç´¢å¢å¼ºæ–¹å¼å°†å¤–éƒ¨çŸ¥è¯†èäºç”Ÿæˆä»»åŠ¡ä¸­ä¸€ä¸ªæ–°çš„æ¡†æ¶â€•â€•RAGã€‚å¯¹æ¯”T5 å’Œ BARTè¿™ç±»æ“…é•¿å¤„ç†ç”Ÿæˆä»»åŠ¡çš„æ¨¡å‹æ¥è¯´ï¼ŒRAGæ›´æ–°å¤–éƒ¨çŸ¥è¯†æ˜¯ä¸éœ€è¦é‡æ–°é¢„è®­ç»ƒï¼Œæˆæœ¬ä½ï¼›è€Œå¯¹æ¯”pipelineæ–¹æ³•ï¼ŒRAGåˆ©ç”¨å¤–éƒ¨çŸ¥è¯†å¹¶ä¸éœ€è¦æ„é€ è´Ÿè´£çš„ç‰¹å¾å·¥ç¨‹ã€‚æ€»çš„æ¥è¯´ï¼ŒRAGæ–¹æ³•å¯ä½œä¸ºå¤–éƒ¨çŸ¥è¯†èåˆæ¡†æ¶çš„ä¸€ç§æœ‰æ•ˆå®ä¾‹ã€‚&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">,</span> &#x27;kor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95</span>bc5bffaa5cfd41f5242f9f8b330761&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">232</span>dc4ae399e0a8847bfcdeb2e64e215&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;æœ‰å…´è¶£å¯å…³æ³¨ç¬”è€…å…¬ä¼—å·ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ç®—æ³•ä¸å®è·µ&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">,</span> &#x27;kor&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95</span>bc5bffaa5cfd41f5242f9f8b330761&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">41</span>f28a1034fdc4291daf652054c20bd2&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;ç¼–è¾‘äº <span class="number">2022</span><span class="number">-04</span><span class="number">-06</span> <span class="number">10</span><span class="punctuation">:</span><span class="number">47</span>&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95</span>bc5bffaa5cfd41f5242f9f8b330761&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;f70255f8bf13d39885508fd845c22382&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;nld&#x27;<span class="punctuation">,</span> &#x27;eng&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95</span>bc5bffaa5cfd41f5242f9f8b330761&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;UncategorizedText&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">1818</span>d3e8e3a4ce395732bba3428a111d&#x27;<span class="punctuation">&#125;</span></span><br><span class="line">page_content=&#x27;è‡ªç„¶è¯­è¨€å¤„ç†ç®—æ³•ä¸å®è·µ&#x27; metadata=<span class="punctuation">&#123;</span>&#x27;source&#x27;<span class="punctuation">:</span> &#x27;asset/load/<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;category_depth&#x27;<span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span> &#x27;last_modified&#x27;<span class="punctuation">:</span> &#x27;<span class="number">2025</span><span class="number">-09</span><span class="number">-24</span>T15<span class="punctuation">:</span><span class="number">26</span><span class="punctuation">:</span><span class="number">37</span>&#x27;<span class="punctuation">,</span> &#x27;languages&#x27;<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;kor&#x27;<span class="punctuation">,</span> &#x27;zho&#x27;<span class="punctuation">]</span><span class="punctuation">,</span> &#x27;file_directory&#x27;<span class="punctuation">:</span> &#x27;asset/load&#x27;<span class="punctuation">,</span> &#x27;filename&#x27;<span class="punctuation">:</span> &#x27;<span class="number">05</span>-load.html&#x27;<span class="punctuation">,</span> &#x27;filetype&#x27;<span class="punctuation">:</span> &#x27;text/html&#x27;<span class="punctuation">,</span> &#x27;parent_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95</span>bc5bffaa5cfd41f5242f9f8b330761&#x27;<span class="punctuation">,</span> &#x27;category&#x27;<span class="punctuation">:</span> &#x27;Title&#x27;<span class="punctuation">,</span> &#x27;element_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">95058</span>f2148219d97462c5c4bfe175502&#x27;<span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="åŠ è½½Markdown-äº†è§£"><a href="#åŠ è½½Markdown-äº†è§£" class="headerlink" title="åŠ è½½Markdown(äº†è§£)"></a>åŠ è½½Markdown(äº†è§£)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install markdown </span><br><span class="line">pip install unstructured</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹1ï¼šä½¿ç”¨MarkDownLoaderåŠ è½½mdæ–‡ä»¶"><a href="#ä¸¾ä¾‹1ï¼šä½¿ç”¨MarkDownLoaderåŠ è½½mdæ–‡ä»¶" class="headerlink" title="ä¸¾ä¾‹1ï¼šä½¿ç”¨MarkDownLoaderåŠ è½½mdæ–‡ä»¶"></a>ä¸¾ä¾‹1ï¼šä½¿ç”¨MarkDownLoaderåŠ è½½mdæ–‡ä»¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³çš„ä¾èµ–</span></span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> UnstructuredMarkdownLoader </span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å®šä¹‰UnstructuredMarkdownLoaderå¯¹è±¡</span></span><br><span class="line">md_loader = UnstructuredMarkdownLoader( file_path= <span class="string">&quot;asset/load/06-load.md&quot;</span> , strategy= <span class="string">&quot;fast&quot;</span> ) </span><br><span class="line"><span class="comment"># 3.åŠ è½½</span></span><br><span class="line">docs = md_loader.load() </span><br><span class="line"><span class="built_in">print</span> ( <span class="built_in">len</span> (docs)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.æ‰“å°</span></span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs: </span><br><span class="line">pprint(doc)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">Document(metadata=&#123;&#x27;source&#x27;: &#x27;asset/load/06-load.md&#x27;&#125;, page_content=&#x27;è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯æ–‡æ¡£\n\næœ¬æ–‡æ¡£ç”¨äºæµ‹è¯•UnstructuredMarkdownLoaderçš„ä¸­æ–‡å¤„ç†èƒ½åŠ›ã€‚\n\nç¬¬ä¸€ç« ï¼šç®€ä»‹\n\nè‡ªç„¶è¯­è¨€å¤„ç†(NLP)æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯ï¼Œä¸»è¦æŠ€æœ¯åŒ…æ‹¬ï¼š\n\næ–‡æœ¬åˆ†ç±»\n\nå‘½åå®ä½“è¯†åˆ«\n\næœºå™¨ç¿»è¯‘\n\næƒ…æ„Ÿåˆ†æ\n\né—®ç­”ç³»ç»Ÿ\n\nç¬¬äºŒç« ï¼šå…³é”®æŠ€æœ¯\n\n2.1 é¢„è®­ç»ƒæ¨¡å‹\n\nBERTï¼šåŒå‘Transformerç¼–ç å™¨\n\nGPTï¼šè‡ªå›å½’è¯­è¨€æ¨¡å‹\n\nT5ï¼šæ–‡æœ¬åˆ°æ–‡æœ¬è½¬æ¢æ¡†æ¶\n\n2.2 ä»£ç ç¤ºä¾‹\n\n```python from transformers import pipeline\n\nåˆ›å»ºæ–‡æœ¬åˆ†ç±»ç®¡é“\n\nclassifier = pipeline(&quot;text-classification&quot;, model=&quot;bert-base-chinese&quot;)\n\nresult = classifier(&quot;è¿™å®¶é¤å…çš„æœåŠ¡å¾ˆæ£’ï¼&quot;) print(result)&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼šç²¾ç»†åˆ†å‰²æ–‡æ¡£ï¼Œä¿ç•™ç»“æ„ä¿¡æ¯"><a href="#ä¸¾ä¾‹2ï¼šç²¾ç»†åˆ†å‰²æ–‡æ¡£ï¼Œä¿ç•™ç»“æ„ä¿¡æ¯" class="headerlink" title="ä¸¾ä¾‹2ï¼šç²¾ç»†åˆ†å‰²æ–‡æ¡£ï¼Œä¿ç•™ç»“æ„ä¿¡æ¯"></a>ä¸¾ä¾‹2ï¼šç²¾ç»†åˆ†å‰²æ–‡æ¡£ï¼Œä¿ç•™ç»“æ„ä¿¡æ¯</h3><p>å°†Markdownæ–‡æ¡£æŒ‰è¯­ä¹‰å…ƒç´ ï¼ˆæ ‡é¢˜ã€æ®µè½ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰ï¼‰æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„å°æ–‡æ¡£ï¼ˆElementå¯¹ è±¡ï¼‰ï¼Œè€Œä¸æ˜¯è¿”å›å•ä¸ªå¤§æ–‡æ¡£ã€‚é€šè¿‡æŒ‡å®šmode&#x3D;â€elementsâ€è½»æ¾ä¿æŒè¿™ç§åˆ†ç¦»ã€‚<br>æ¯ä¸ªåˆ†å‰²åçš„å…ƒç´ ä¼šåŒ…å«å…ƒæ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³çš„ä¾èµ–</span></span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> UnstructuredMarkdownLoader </span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å®šä¹‰UnstructuredMarkdownLoaderå¯¹è±¡</span></span><br><span class="line">md_loader = UnstructuredMarkdownLoader( </span><br><span class="line">file_path= <span class="string">&quot;./asset/load/06-load.md&quot;</span> ,</span><br><span class="line">mode= <span class="string">&quot;elements&quot;</span> ,</span><br><span class="line">strategy= <span class="string">&quot;fast&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.åŠ è½½</span></span><br><span class="line">docs = md_loader.load() </span><br><span class="line"><span class="built_in">print</span> ( <span class="built_in">len</span> (docs)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.æ‰“å°</span></span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs: </span><br><span class="line"><span class="comment"># pprint(doc) </span></span><br><span class="line">pprint(doc.page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">19</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 0, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;184afae73069130590c7608c471f63f4&#x27;</span>&#125;, page_content=<span class="string">&#x27;è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯æ–‡æ¡£&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;184afae73069130590c7608c471f63f4&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;UncategorizedText&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;18f55c7a014f88171f86dc848b58a83b&#x27;</span>&#125;, page_content=<span class="string">&#x27;æœ¬æ–‡æ¡£ç”¨äºæµ‹è¯•UnstructuredMarkdownLoaderçš„ä¸­æ–‡å¤„ç†èƒ½åŠ›ã€‚&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;184afae73069130590c7608c471f63f4&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>&#125;, page_content=<span class="string">&#x27;ç¬¬ä¸€ç« ï¼šç®€ä»‹&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;UncategorizedText&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;e7b3e94da2b42ec341e42747172c2fb1&#x27;</span>&#125;, page_content=<span class="string">&#x27;è‡ªç„¶è¯­è¨€å¤„ç†(NLP)æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯ï¼Œä¸»è¦æŠ€æœ¯åŒ…æ‹¬ï¼š&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;eb53d308db7e96fa7bf107143411c209&#x27;</span>&#125;, page_content=<span class="string">&#x27;æ–‡æœ¬åˆ†ç±»&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;d3cd19f3de6c7be342b6d45249ed5936&#x27;</span>&#125;, page_content=<span class="string">&#x27;å‘½åå®ä½“è¯†åˆ«&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;4af0dd9da13771840a9696cdcbb502e1&#x27;</span>&#125;, page_content=<span class="string">&#x27;æœºå™¨ç¿»è¯‘&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;862050b1daeb945947f4c00587f16954&#x27;</span>&#125;, page_content=<span class="string">&#x27;æƒ…æ„Ÿåˆ†æ&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;6a6844d806798af924a74eecc9bf3c1f&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;7f221beeb60cc8089f9878c70230b9a5&#x27;</span>&#125;, page_content=<span class="string">&#x27;é—®ç­”ç³»ç»Ÿ&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;184afae73069130590c7608c471f63f4&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;c2bf8c7c4e88556b7afb7b5407d4fbf2&#x27;</span>&#125;, page_content=<span class="string">&#x27;ç¬¬äºŒç« ï¼šå…³é”®æŠ€æœ¯&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 2, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;c2bf8c7c4e88556b7afb7b5407d4fbf2&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;d32a685b6777cb3277c7732ca2603203&#x27;</span>&#125;, page_content=<span class="string">&#x27;2.1 é¢„è®­ç»ƒæ¨¡å‹&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;emphasized_text_contents&#x27;</span>: [<span class="string">&#x27;BERT&#x27;</span>], <span class="string">&#x27;emphasized_text_tags&#x27;</span>: [<span class="string">&#x27;b&#x27;</span>], <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;d32a685b6777cb3277c7732ca2603203&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;3efd83a33d46349a06c9489309f23af0&#x27;</span>&#125;, page_content=<span class="string">&#x27;BERTï¼šåŒå‘Transformerç¼–ç å™¨&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;emphasized_text_contents&#x27;</span>: [<span class="string">&#x27;GPT&#x27;</span>], <span class="string">&#x27;emphasized_text_tags&#x27;</span>: [<span class="string">&#x27;b&#x27;</span>], <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;d32a685b6777cb3277c7732ca2603203&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;042b24863d1db56d10e6222413089a30&#x27;</span>&#125;, page_content=<span class="string">&#x27;GPTï¼šè‡ªå›å½’è¯­è¨€æ¨¡å‹&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 1, <span class="string">&#x27;emphasized_text_contents&#x27;</span>: [<span class="string">&#x27;T5&#x27;</span>], <span class="string">&#x27;emphasized_text_tags&#x27;</span>: [<span class="string">&#x27;b&#x27;</span>], <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;d32a685b6777cb3277c7732ca2603203&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;ListItem&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;7da9d82f5274c3edb7ae917995c08db2&#x27;</span>&#125;, page_content=<span class="string">&#x27;T5ï¼šæ–‡æœ¬åˆ°æ–‡æœ¬è½¬æ¢æ¡†æ¶&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 2, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;c2bf8c7c4e88556b7afb7b5407d4fbf2&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;58fa664fefbefa6e86ee4fc8dd128878&#x27;</span>&#125;, page_content=<span class="string">&#x27;2.2 ä»£ç ç¤ºä¾‹&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;58fa664fefbefa6e86ee4fc8dd128878&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;NarrativeText&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;2d72807f991457ffe38dad8b46480b0b&#x27;</span>&#125;, page_content=<span class="string">&#x27;```python from transformers import pipeline&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;category_depth&#x27;</span>: 0, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;f5a25376ceb9e9392b4e0b2b60153cca&#x27;</span>&#125;, page_content=<span class="string">&#x27;åˆ›å»ºæ–‡æœ¬åˆ†ç±»ç®¡é“&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;f5a25376ceb9e9392b4e0b2b60153cca&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;UncategorizedText&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;9745c5d59a60933121ca91a9b71e6acf&#x27;</span>&#125;, page_content=<span class="string">&#x27;classifier = pipeline(&quot;text-classification&quot;, model=&quot;bert-base-chinese&quot;)&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset/load/06-load.md&#x27;</span>, <span class="string">&#x27;languages&#x27;</span>: [<span class="string">&#x27;eng&#x27;</span>], <span class="string">&#x27;file_directory&#x27;</span>: <span class="string">&#x27;asset/load&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;06-load.md&#x27;</span>, <span class="string">&#x27;filetype&#x27;</span>: <span class="string">&#x27;text/markdown&#x27;</span>, <span class="string">&#x27;last_modified&#x27;</span>: <span class="string">&#x27;2025-09-24T15:26:39&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="string">&#x27;f5a25376ceb9e9392b4e0b2b60153cca&#x27;</span>, <span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;UncategorizedText&#x27;</span>, <span class="string">&#x27;element_id&#x27;</span>: <span class="string">&#x27;7ebd846af465424c8c01cb58cfa79c86&#x27;</span>&#125;, page_content=<span class="string">&#x27;result = classifier(&quot;è¿™å®¶é¤å…çš„æœåŠ¡å¾ˆæ£’ï¼&quot;) print(result)&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="åŠ è½½File-Directory-äº†è§£"><a href="#åŠ è½½File-Directory-äº†è§£" class="headerlink" title="åŠ è½½File Directory(äº†è§£)"></a>åŠ è½½File Directory(äº†è§£)</h2><p>é™¤äº†ä¸Šè¿°çš„å•ä¸ªæ–‡ä»¶åŠ è½½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰¹é‡åŠ è½½ä¸€ä¸ªæ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install unstructured</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³çš„ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> DirectoryLoader  </span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> PythonLoader  </span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰DirectoryLoaderå¯¹è±¡,æŒ‡å®šè¦åŠ è½½çš„æ–‡ä»¶å¤¹è·¯å¾„ã€è¦åŠ è½½çš„æ–‡ä»¶ç±»å‹å’Œæ˜¯å¦ä½¿ç”¨å¤šçº¿ç¨‹  </span></span><br><span class="line">directory_loader = DirectoryLoader(  </span><br><span class="line">    path=<span class="string">&quot;./asset/load&quot;</span>,  </span><br><span class="line">    glob=<span class="string">&quot;*.py&quot;</span>,  </span><br><span class="line">    use_multithreading=<span class="literal">True</span>,  </span><br><span class="line">    show_progress=<span class="literal">True</span>,  </span><br><span class="line">    loader_cls=PythonLoader  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åŠ è½½  </span></span><br><span class="line">docs = directory_loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.æ‰“å°  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    pprint(doc)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00&lt;00:00, 227.64it/s]</span><br><span class="line">4</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset\\load\\07-fun_retun.py&#x27;</span>&#125;, page_content=<span class="string">&#x27;&quot;&quot;&quot;\nå›› å‡½æ•°çš„è¿”å›å€¼\n&quot;&quot;&quot;\n# 1.è¿”å›è¡¨è¾¾å¼\n# 2.ä¸å¸¦è¡¨è¾¾å¼çš„ return è¯­å¥ï¼Œè¿”å› Noneã€‚\n# 3.å‡½æ•°ä¸­å¦‚æœæ²¡æœ‰ return è¯­å¥ï¼Œåœ¨å‡½æ•°è¿è¡Œç»“æŸåä¹Ÿä¼šè¿”å› Noneã€‚\n# 4.ç”¨å˜é‡æ¥æ”¶è¿”å›ç»“æœ\n# 5.return è¯­å¥å¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼Œå¤šä¸ªå€¼ä¼šæ”¾åœ¨ä¸€ä¸ªå…ƒç»„ä¸­ã€‚\n\ndef f(a, b, c):\n    return a, b, c, [a, b, c]\nprint(f(1, 2, 3))  # (1, 2, 3, [1, 2, 3])\n&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset\\load\\07-param_form.py&#x27;</span>&#125;, page_content=<span class="string">&#x27;&quot;&quot;&quot;\nä¸‰ å‡½æ•°å‚æ•°å½¢å¼\n&quot;&quot;&quot;\n# 1.ä½ç½®å‚æ•°\n# 2.å…³é”®å­—å‚æ•°\n# 3.é»˜è®¤å‚æ•°\n# 4.ä¸å®šé•¿å‚æ•°\n# 4.1 å¸¦ä¸€ä¸ª*\ndef printInfo(num,*vartuple):\n    print(num)\n    print(vartuple)\n\nprintInfo(70,60,50)\n\nprint(&quot;-&quot; * 20)\n# å¦‚æœä¸å®šé•¿çš„å‚æ•°åé¢è¿˜æœ‰å‚æ•°,å¿…é¡»é€šè¿‡å…³é”®å­—å‚æ•°ä¼ å‚\ndef printInfo1(num1,*vartuple,num) :\n    print(num)\n    print(num1)\n    print(vartuple)\n\nprintInfo1(10,20,num = 40)\n\nprint(&quot;-&quot; * 20)\n# å¦‚æœæ²¡æœ‰ç»™ä¸å®šé•¿çš„å‚æ•°ä¼ å‚,é‚£ä¹ˆå¾—åˆ°çš„æ˜¯ç©ºå…ƒç»„\nprintInfo1(70,num = 60)\n# 4.2 å¸¦äºŒä¸ª*\ndef printInfo(num,**vardict):\n    print(num)\n    print(vardict)\n    # return\n\nprintInfo(10,key1 = 20,key2 = 30)&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset\\load\\07-fun.py&#x27;</span>&#125;, page_content=<span class="string">&#x27;&quot;&quot;&quot;\nä¸€ å‡½æ•°å…¥é—¨\n&quot;&quot;&quot;\n# 1.ä¸ä½¿ç”¨å‡½æ•°\n# æ‰“å°æ¬¢è¿ä¿¡æ¯1\nprint(&quot;********************************&quot;)\nprint(&quot;*                              *&quot;)\nprint(&quot;*     æ¬¢è¿æ¥åˆ°Pythonä¸–ç•Œ       *&quot;)\nprint(&quot;*                              *&quot;)\nprint(&quot;********************************&quot;)\n\n# æ‰“å°æ¬¢è¿ä¿¡æ¯2\nprint(&quot;********************************&quot;)\nprint(&quot;*                              *&quot;)\nprint(&quot;*     æ¬¢è¿æ¥åˆ°Pythonä¸–ç•Œ       *&quot;)\nprint(&quot;*                              *&quot;)\nprint(&quot;********************************&quot;)\n\n# æ‰“å°æ¬¢è¿ä¿¡æ¯3\nprint(&quot;********************************&quot;)\nprint(&quot;*                              *&quot;)\nprint(&quot;*     æ¬¢è¿æ¥åˆ°Pythonä¸–ç•Œ       *&quot;)\nprint(&quot;*                              *&quot;)\nprint(&quot;********************************&quot;)\n\n# 2.ä½¿ç”¨å‡½æ•°\ndef print_welcome():\n    &quot;&quot;&quot;æ‰“å°æ¬¢è¿ä¿¡æ¯&quot;&quot;&quot;\n    print(&quot;********************************&quot;)\n    print(&quot;*                              *&quot;)\n    print(&quot;*     æ¬¢è¿æ¥åˆ°Pythonä¸–ç•Œ       *&quot;)\n    print(&quot;*                              *&quot;)\n    print(&quot;********************************&quot;)\n\n# å¤šæ¬¡è°ƒç”¨å‡½æ•°æ‰“å°æ¬¢è¿ä¿¡æ¯\nprint_welcome()\nprint_welcome()\nprint_welcome()&#x27;</span>)</span><br><span class="line">Document(metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;asset\\load\\07-fun_param.py&#x27;</span>&#125;, page_content=<span class="string">&#x27;&quot;&quot;&quot;\näºŒ å‡½æ•°å‚æ•°\n&quot;&quot;&quot;\n\n\n# 1. æ— å‚æ•°ç‰ˆæœ¬ - åªèƒ½è®¡ç®—å›ºå®šçš„è´­ç‰©è½¦\ndef calculate_total_no_params():\n    &quot;&quot;&quot;è®¡ç®—å›ºå®šè´­ç‰©è½¦æ€»ä»·&quot;&quot;&quot;\n    prices = [100, 50, 30]  # å•†å“ä»·æ ¼å›ºå®šå†™æ­»åœ¨å‡½æ•°å†…\n    total = 0\n    for price in prices:\n        total += price\n    return total\n\n# åªèƒ½è®¡ç®—ä¸€ä¸ªå›ºå®šçš„è´­ç‰©è½¦\nprint(f&quot;è´­ç‰©è½¦æ€»ä»·:&#123;calculate_total_no_params()&#125;&quot;)\n\n# 2.æœ‰å‚æ•°ç‰ˆæœ¬ - å¯ä»¥è®¡ç®—ä»»æ„è´­ç‰©è½¦\ndef calculate_total(prices):\n    &quot;&quot;&quot;è®¡ç®—ä»»æ„è´­ç‰©è½¦æ€»ä»·&quot;&quot;&quot;\n    total = 0\n    for price in prices:\n        total += price\n    return total\n\n# å¯ä»¥è®¡ç®—ä»»æ„è´­ç‰©è½¦\ncart1 = [100, 50, 30]\ncart2 = [200, 80, 45, 60]\ncart3 = [75, 90, 120]\n\nprint(&quot;ç¬¬ä¸€ä¸ªè´­ç‰©è½¦æ€»ä»·:&#123;calculate_total(cart1)&#125;:&quot;)\nprint(&quot;ç¬¬äºŒä¸ªè´­ç‰©è½¦æ€»ä»·:&#123;calculate_total(cart2)&#125;&quot;)\nprint(f&quot;ç¬¬ä¸‰ä¸ªè´­ç‰©è½¦æ€»ä»·:&#123;calculate_total(cart3)&#125;&quot;)\n\n\n# 3.å‚æ•°ä¼ é€’\n# 3.1 ä¸å¯å˜ç±»å‹ å‡½æ•°ä¼ é€’ä¸å¯å˜å¯¹è±¡\n\ndef changeInt(a) :\n    print(&quot;å‡½æ•°ä½“ä¸­æœªæ”¹å˜å‰açš„å†…å­˜åœ°å€&quot;,id(a))\n    a = 10   #åº•å±‚ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ ç„¶åç»™æ–°å¯¹è±¡ä¸€ä¸ªæ–°å€¼\n    print(&quot;å‡½æ•°ä½“ä¸­æ”¹å˜åaçš„å†…å­˜åœ°å€&quot;,id(a))\n\na = 2 # åˆ›å»ºä¸€ä¸ªå¯¹è±¡ ç„¶åç»™è¿™ä¸ªå¯¹è±¡ä¸€ä¸ªå€¼\nchangeInt(a)\nprint(a)\nprint(&quot;å‡½æ•°å¤–bçš„å†…å­˜åœ°å€&quot;,id(a))\n\n\n\n# è¾“å‡ºç»“æœ\n# å‡½æ•°ä½“ä¸­æœªæ”¹å˜å‰açš„å†…å­˜åœ°å€ 140729722661336\n# å‡½æ•°ä½“ä¸­æ”¹å˜åaçš„å†…å­˜åœ°å€ 140729722661592\n# 2\n# å‡½æ•°å¤–bçš„å†…å­˜åœ°å€ 140729722661336\n\n\n# 3.2 å¯å˜ç±»å‹ å‡½æ•°ä¼ é€’ä¸å¯å˜å¯¹è±¡\n\ndef changeList(myList) :\n    myList[1] = 50\n    print(&quot;å‡½æ•°å†…çš„å€¼&quot;,myList) # [1,50,3]\n    print(&quot;å‡½æ•°å†…åˆ—è¡¨çš„å†…å­˜&quot;,id(myList)) # 0111111\n\nmlist = [1,2,3]  # åº•å±‚åˆ›å»ºä¸€ä¸ªå¯¹è±¡ åœ°å€0111111\nchangeList(mlist)\nprint(&quot;å‡½æ•°å¤–çš„å€¼&quot;,mlist) # # [1,50,3]\nprint(&quot;å‡½æ•°å¤–åˆ—è¡¨çš„å†…å­˜&quot;,id(mlist))\n\n# è¾“å‡ºç»“æœ\n# å‡½æ•°å†…çš„å€¼ [1, 50, 3]\n# å‡½æ•°å†…åˆ—è¡¨çš„å†…å­˜ 1380193079680\n# å‡½æ•°å¤–çš„å€¼ [1, 50, 3]\n# å‡½æ•°å¤–åˆ—è¡¨çš„å†…å­˜ 1380193079680\n\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æ–‡æ¡£æ‹†åˆ†å™¨-Text-Splitters"><a href="#æ–‡æ¡£æ‹†åˆ†å™¨-Text-Splitters" class="headerlink" title="æ–‡æ¡£æ‹†åˆ†å™¨ Text Splitters"></a>æ–‡æ¡£æ‹†åˆ†å™¨ Text Splitters</h1><h2 id="ä¸ºä»€ä¹ˆè¦æ‹†åˆ†-åˆ†å—-åˆ‡åˆ†"><a href="#ä¸ºä»€ä¹ˆè¦æ‹†åˆ†-åˆ†å—-åˆ‡åˆ†" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æ‹†åˆ†&#x2F;åˆ†å—&#x2F;åˆ‡åˆ†"></a>ä¸ºä»€ä¹ˆè¦æ‹†åˆ†&#x2F;åˆ†å—&#x2F;åˆ‡åˆ†</h2><p>å½“æ‹¿åˆ°ç»Ÿä¸€çš„ä¸€ä¸ªDocumentå¯¹è±¡åï¼Œæ¥ä¸‹æ¥éœ€è¦åˆ‡åˆ†æˆChunksã€‚å¦‚æœä¸åˆ‡åˆ†ï¼Œè€Œæ˜¯è€ƒè™‘ä½œä¸ºä¸€ä¸ªæ•´ä½“ çš„Documentå¯¹è±¡ï¼Œä¼šå­˜åœ¨ä¸¤ç‚¹é—®é¢˜ï¼š </p><ol><li>å‡è®¾æé—®çš„Queryçš„ç­”æ¡ˆå‡ºç°åœ¨æŸä¸€ä¸ªDocumentå¯¹è±¡ä¸­ï¼Œé‚£ä¹ˆå°†æ£€ç´¢åˆ°çš„æ•´ä¸ªDocumentå¯¹è±¡ ç›´æ¥æ”¾å…¥Promptä¸­å¹¶ä¸æ˜¯æœ€ä¼˜çš„é€‰æ‹©ï¼Œå› ä¸ºå…¶ä¸­ä¸€å®šä¼šåŒ…å«éå¸¸å¤šæ— å…³çš„ä¿¡æ¯ï¼Œè€Œæ— æ•ˆä¿¡æ¯è¶Š å¤šï¼Œå¯¹å¤§æ¨¡å‹åç»­çš„æ¨ç†å½±å“è¶Šå¤§ã€‚ </li><li>ä»»ä½•ä¸€ä¸ªå¤§æ¨¡å‹éƒ½å­˜åœ¨æœ€å¤§è¾“å…¥çš„<strong>Tokené™åˆ¶</strong>ï¼Œå¦‚æœä¸€ä¸ªDocumentéå¸¸å¤§ï¼Œæ¯”å¦‚ä¸€ä¸ªå‡ ç™¾å…†çš„ PDFï¼Œé‚£ä¹ˆå¤§æ¨¡å‹è‚¯å®šæ— æ³•å®¹çº³å¦‚æ­¤å¤šçš„ä¿¡æ¯ã€‚</li></ol><p>åŸºäºæ­¤ï¼Œä¸€ä¸ªæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å°†å®Œæ•´çš„Documentå¯¹è±¡è¿›è¡Œ<strong>åˆ†å—å¤„ç†ï¼ˆChunking)<strong>ã€‚æ— è®ºæ˜¯åœ¨å­˜å‚¨ è¿˜æ˜¯æ£€ç´¢è¿‡ç¨‹ä¸­ï¼Œéƒ½å°†ä»¥è¿™äº›</strong>å—(chunks)</strong> ä¸ºåŸºæœ¬å•ä½ï¼Œè¿™æ ·æœ‰æ•ˆåœ°é¿å…å†…å®¹ä¸ç›¸å…³æ€§é—®é¢˜å’Œè¶…å‡ºæœ€å¤§è¾“ å…¥é™åˆ¶çš„é—®é¢˜ã€‚</p><h2 id="Chunkingæ‹†åˆ†çš„ç­–ç•¥"><a href="#Chunkingæ‹†åˆ†çš„ç­–ç•¥" class="headerlink" title="Chunkingæ‹†åˆ†çš„ç­–ç•¥"></a>Chunkingæ‹†åˆ†çš„ç­–ç•¥</h2><p><strong>æ–¹æ³•1ï¼šæ ¹æ®å¥å­åˆ‡åˆ†</strong>ï¼šè¿™ç§æ–¹æ³•æŒ‰ç…§è‡ªç„¶å¥å­è¾¹ç•Œè¿›è¡Œåˆ‡åˆ†ï¼Œä»¥ä¿æŒè¯­ä¹‰å®Œæ•´æ€§ã€‚ </p><p><strong>æ–¹æ³•2ï¼šæŒ‰ç…§å›ºå®šå­—ç¬¦æ•°æ¥åˆ‡åˆ†</strong>ï¼šè¿™ç§ç­–ç•¥æ ¹æ®ç‰¹å®šçš„å­—ç¬¦æ•°é‡æ¥åˆ’åˆ†æ–‡æœ¬ï¼Œä½†å¯èƒ½ä¼šåœ¨ä¸é€‚å½“çš„ä½ç½® åˆ‡æ–­å¥å­ã€‚ </p><p><strong>æ–¹æ³•3ï¼šæŒ‰å›ºå®šå­—ç¬¦æ•°æ¥åˆ‡åˆ†ï¼Œç»“åˆé‡å çª—å£ï¼ˆoverlapping windowsï¼‰</strong>ï¼šæ­¤æ–¹æ³•ä¸æŒ‰å­—ç¬¦æ•°åˆ‡åˆ†ç›¸ ä¼¼ï¼Œä½†é€šè¿‡é‡å çª—å£æŠ€æœ¯é¿å…åˆ‡åˆ†å…³é”®å†…å®¹ï¼Œç¡®ä¿ä¿¡æ¯è¿è´¯æ€§ã€‚</p><p><strong>æ–¹æ³•4ï¼šé€’å½’å­—ç¬¦åˆ‡åˆ†æ–¹æ³•</strong>ï¼šé€šè¿‡é€’å½’å­—ç¬¦æ–¹å¼åŠ¨æ€ç¡®å®šåˆ‡åˆ†ç‚¹ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥æ ¹æ®æ–‡æ¡£çš„å¤æ‚æ€§å’Œå†… å®¹å¯†åº¦æ¥è°ƒæ•´å—çš„å¤§å°ã€‚ </p><p><strong>æ–¹æ³•5ï¼šæ ¹æ®è¯­ä¹‰å†…å®¹åˆ‡åˆ†</strong>ï¼šè¿™ç§ <strong>é«˜çº§ç­–ç•¥</strong>ä¾æ®æ–‡æœ¬çš„è¯­ä¹‰å†…å®¹æ¥åˆ’åˆ†å—ï¼Œæ—¨åœ¨ä¿æŒç›¸å…³ä¿¡æ¯çš„é›†ä¸­å’Œ å®Œæ•´ï¼Œé€‚ç”¨äºéœ€è¦é«˜åº¦è¯­ä¹‰ä¿æŒçš„åº”ç”¨åœºæ™¯ã€‚</p><blockquote><p>[!tip]<br>ç¬¬2ç§â½…æ³•ï¼ˆæŒ‰ç…§å­—ç¬¦æ•°åˆ‡åˆ†ï¼‰å’Œç¬¬3ç§â½…æ³•ï¼ˆæŒ‰å›ºå®šå­—ç¬¦æ•°åˆ‡åˆ†ç»“åˆé‡å çª—å£ï¼‰ä¸»è¦åŸºäºå­—ç¬¦è¿›â¾ â½‚æœ¬çš„åˆ‡åˆ†ï¼Œè€Œä¸è€ƒè™‘â½‚ç« çš„å®é™…å†…å®¹å’Œè¯­ä¹‰ã€‚è¿™ç§â½…å¼è™½ç®€å•ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´ <strong>ä¸»é¢˜æˆ–è¯­ä¹‰ä¸Šçš„æ–­ è£‚</strong> ã€‚ </p><p>ç›¸å¯¹è€Œâ¾”ï¼Œç¬¬4ç§é€’å½’â½…æ³•æ›´åŠ çµæ´»å’Œâ¾¼æ•ˆï¼Œå®ƒç»“åˆäº†å›ºå®šâ»“åº¦åˆ‡åˆ†å’Œè¯­ä¹‰åˆ†æã€‚é€šå¸¸æ˜¯ <strong>é¦–é€‰ç­– ç•¥</strong> ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿæ›´å¥½åœ°ç¡®ä¿æ¯ä¸ªæ®µè½åŒ…å«â¼€ä¸ªå®Œæ•´çš„ä¸»é¢˜ã€‚ </p><p>è€Œç¬¬5ç§â½…æ³•ï¼ŒåŸºäºè¯­ä¹‰çš„åˆ†å‰²è™½ç„¶èƒ½ç²¾ç¡®åœ°åˆ‡åˆ†å‡ºå®Œæ•´çš„ä¸»é¢˜æ®µè½ï¼Œä½†è¿™ç§â½…æ³•æ•ˆç‡è¾ƒä½ã€‚å®ƒéœ€ è¦è¿â¾å¤æ‚çš„åˆ†æ®µç®—æ³•ï¼ˆsegmentation algorithmï¼‰ï¼Œ <strong>å¤„ç†é€Ÿåº¦è¾ƒæ…¢</strong> ï¼Œå¹¶ä¸” <strong>æ®µè½é•¿åº¦å¯èƒ½æä¸å‡ åŒ€</strong> ï¼ˆæœ‰çš„ä¸»é¢˜æ®µè½å¯èƒ½å¾ˆâ»“ï¼Œè€Œæœ‰çš„åˆ™è¾ƒçŸ­ï¼‰ã€‚å› æ­¤ï¼Œå°½ç®¡å®ƒåœ¨æŸäº›éœ€è¦â¾¼ç²¾åº¦è¯­ä¹‰ä¿æŒçš„åœºæ™¯ ä¸‹æœ‰å…¶åº”â½¤ä»·å€¼ï¼Œä½†å¹¶ <strong>ä¸é€‚åˆæ‰€æœ‰æƒ…å†µ</strong> ã€‚</p></blockquote><p>è¿™äº›æ–¹æ³•å„æœ‰ä¼˜åŠ¿å’Œå±€é™ï¼Œé€‰æ‹©é€‚å½“çš„åˆ†å—ç­–ç•¥å–å†³äºå…·ä½“çš„åº”ç”¨éœ€æ±‚å’Œé¢„æœŸçš„æ£€ç´¢æ•ˆæœã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ ä¾æ¬¡å°è¯•ç”¨å¸¸è§„æ‰‹æ®µåº”è¯¥å¦‚ä½•å®ç°ä¸Šè¿°å‡ ç§æ–¹æ³•çš„æ–‡æœ¬åˆ‡åˆ†</p><h2 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h2><p>LangChainæä¾›äº†è®¸å¤šä¸åŒç±»å‹çš„æ–‡æ¡£åˆ‡åˆ†å™¨</p><p><a href="https://python.langchain.com/api_reference/text_splitters/index.html">å®˜ç½‘åœ°å€ï¼šhttps://python.langchain.com/api_reference&#x2F;text_splitters&#x2F;index.html</a></p><p>ä½¿ç”¨ç»†èŠ‚ï¼š</p><p>â‘  TextSplitterä½œä¸ºå„ç§å…·ä½“çš„æ–‡æ¡£æ‹†åˆ†å™¨çš„çˆ¶ç±»</p><p>â‘¡ å†…éƒ¨å®šä¹‰äº†ä¸€äº›å¸¸ç”¨çš„å±æ€§ï¼š</p><p>chunk_size: è¿”å›å—çš„æœ€å¤§å°ºå¯¸ï¼Œå•ä½æ˜¯å­—ç¬¦æ•°ã€‚é»˜è®¤å€¼ä¸º4000ï¼ˆç”±é•¿åº¦å‡½æ•°æµ‹é‡ï¼‰</p><p>chunk_overlap: ç›¸é‚»ä¸¤ä¸ªå—ä¹‹é—´çš„å­—ç¬¦é‡å æ•°,é¿å…ä¿¡æ¯åœ¨è¾¹ç•Œå¤„è¢«åˆ‡æ–­è€Œä¸¢å¤±ã€‚é»˜è®¤å€¼ä¸º200,é€šå¸¸ä¼šè®¾ç½®ä¸ºchunk_sizeçš„10% - 20%ã€‚</p><p>length_function: ç”¨äºæµ‹é‡ç»™å®šå—å­—ç¬¦æ•°çš„å‡½æ•°ã€‚é»˜è®¤èµ‹å€¼ä¸ºlenå‡½æ•°ã€‚lenå‡½æ•°åœ¨Pythonä¸­æŒ‰Unicodeå­—ç¬¦è®¡æ•°ï¼Œæ‰€ä»¥ä¸€ä¸ªæ±‰å­—ã€ä¸€ä¸ªè‹±æ–‡å­—æ¯ã€ä¸€ä¸ªç¬¦å·éƒ½ç®—ä¸€ä¸ªå­—ç¬¦ã€‚</p><p>keep_separator: æ˜¯å¦åœ¨å—ä¸­ä¿ç•™åˆ†éš”ç¬¦ï¼Œé»˜è®¤å€¼ä¸ºFalse</p><p>add_start_index: å¦‚æœä¸º <code>True</code>ï¼Œåˆ™åœ¨å…ƒæ•°æ®ä¸­åŒ…å«å—çš„èµ·å§‹ç´¢å¼•ã€‚é»˜è®¤å€¼ä¸ºFalse</p><p>strip_whitespace: å¦‚æœä¸º <code>True</code>ï¼Œåˆ™ä»æ¯ä¸ªæ–‡æ¡£çš„å¼€å§‹å’Œç»“æŸå¤„å»é™¤ç©ºç™½å­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºTrue</p><p>â‘¡ å†…éƒ¨å®šä¹‰çš„å¸¸ç”¨çš„æ–¹æ³•ï¼š</p><p>æƒ…å†µ1ï¼šæŒ‰ç…§å­—ç¬¦ä¸²è¿›è¡Œæ‹†åˆ†ï¼š</p><p>split_text(xxx) : ä¼ å…¥çš„å‚æ•°ç±»å‹ï¼šå­—ç¬¦ä¸² ; è¿”å›å€¼çš„ç±»å‹ï¼šList[str]</p><p>create_documents(xxx) : ä¼ å…¥çš„å‚æ•°ç±»å‹ï¼šList[str] ; è¿”å›å€¼çš„ç±»å‹ï¼šList[Document]ã€‚åº•å±‚è°ƒç”¨äº†split_text(xxx)</p><p>æƒ…å†µ2ï¼šæŒ‰ç…§Documentå¯¹è±¡è¿›è¡Œæ‹†åˆ†ï¼š</p><p>split_documents(xxx) : ä¼ å…¥çš„å‚æ•°ç±»å‹ï¼šList[Document] ; è¿”å›å€¼çš„ç±»å‹ï¼šList[Document]ã€‚åº•å±‚è°ƒç”¨äº†create_documents(xxx)</p><p>2ã€Documentå¯¹è±¡ ä¸ Str æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</p><p>æ–‡æ¡£åˆ‡åˆ†å™¨å¯ä»¥æŒ‰ç…§å­—ç¬¦è¿›è¡Œåˆ‡åˆ†ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§Documentè¿›è¡Œåˆ‡åˆ†ã€‚å…¶ä¸­ï¼ŒStr å¯ä»¥ç†è§£ä¸ºæ˜¯Documentå¯¹è±¡çš„page_contentå±æ€§ã€‚</p><h3 id="CharacterTextSplitterï¼šSplit-by-character"><a href="#CharacterTextSplitterï¼šSplit-by-character" class="headerlink" title="CharacterTextSplitterï¼šSplit by character"></a>CharacterTextSplitterï¼šSplit by character</h3><p>å‚æ•°æƒ…å†µè¯´æ˜ï¼š </p><ul><li>chunk_size ï¼šæ¯ä¸ªåˆ‡å—çš„æœ€å¤§tokenæ•°é‡ï¼Œé»˜è®¤å€¼ä¸º4000ã€‚ </li><li>chunk_overlap ï¼šç›¸é‚»ä¸¤ä¸ªåˆ‡å—ä¹‹é—´çš„æœ€å¤§é‡å tokenæ•°é‡ï¼Œé»˜è®¤å€¼ä¸º200ã€‚ </li><li>separator ï¼šåˆ†å‰²ä½¿ç”¨çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤å€¼ä¸ºâ€\n\nâ€ã€‚ </li><li>length_function ï¼šç”¨äºè®¡ç®—åˆ‡å—é•¿åº¦çš„æ–¹æ³•ã€‚é»˜è®¤èµ‹å€¼ä¸ºçˆ¶ç±»TextSplitterçš„lenå‡½æ•°ã€‚</li></ul><h4 id="ä¸¾ä¾‹1ï¼šå­—ç¬¦ä¸²æ–‡æœ¬çš„åˆ†å‰²"><a href="#ä¸¾ä¾‹1ï¼šå­—ç¬¦ä¸²æ–‡æœ¬çš„åˆ†å‰²" class="headerlink" title="ä¸¾ä¾‹1ï¼šå­—ç¬¦ä¸²æ–‡æœ¬çš„åˆ†å‰²"></a>ä¸¾ä¾‹1ï¼šå­—ç¬¦ä¸²æ–‡æœ¬çš„åˆ†å‰²</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line"><span class="keyword">from</span> zipp.glob <span class="keyword">import</span> separate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.ç¤ºä¾‹æ–‡æœ¬  </span></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ç”±è¯­è¨€æ¨¡å‹é©±åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶çš„ã€‚å®ƒæä¾›äº†ä¸€å¥—å·¥å…·å’ŒæŠ½è±¡ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´å®¹æ˜“åœ°æ„å»ºå¤æ‚çš„åº”ç”¨ç¨‹åºã€‚  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰å­—ç¬¦åˆ†å‰²å™¨  </span></span><br><span class="line">splitter = CharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">51</span>, <span class="comment"># æ¯å—å¤§å°  </span></span><br><span class="line">    chunk_overlap=<span class="number">7</span>,<span class="comment"># å—ä¸å—ä¹‹é—´çš„é‡å¤å­—ç¬¦æ•°  </span></span><br><span class="line">    <span class="comment">#length_function=len,  </span></span><br><span class="line">    separator=<span class="string">&quot;&quot;</span>   <span class="comment"># è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²æ—¶ï¼Œè¡¨ç¤ºç¦ç”¨åˆ†éš”ç¬¦  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ†å‰²æ–‡æœ¬  </span></span><br><span class="line">texts = splitter.split_text(text)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.æ‰“å°ç»“æœ  </span></span><br><span class="line"><span class="keyword">for</span> i, chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(texts):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å— <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:é•¿åº¦ï¼š<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(chunk)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å— 1:é•¿åº¦ï¼š50</span><br><span class="line">LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ç”±è¯­è¨€æ¨¡å‹é©±åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶çš„ã€‚å®ƒæä¾›äº†ä¸€å¥—å·¥å…·å’ŒæŠ½è±¡ï¼Œä½¿å¼€å‘è€…</span><br><span class="line">--------------------------------------------------</span><br><span class="line">å— 2:é•¿åº¦ï¼š23</span><br><span class="line">æŠ½è±¡ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´å®¹æ˜“åœ°æ„å»ºå¤æ‚çš„åº”ç”¨ç¨‹åºã€‚</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šè‹¥å¿…é¡»ç¦ç”¨åˆ†éš”ç¬¦ï¼ˆå¦‚å¤„ç†æ— ç©ºæ ¼æ–‡æœ¬ï¼‰ï¼Œéœ€<strong>å®¹å¿å®é™…å—é•¿ç•¥å°äº chunk_size</strong> ï¼ˆå°¤å…¶å¯¹ä¸­æ–‡ï¼‰</p><h4 id="ä¸¾ä¾‹2ï¼šæŒ‡å®šåˆ†å‰²ç¬¦"><a href="#ä¸¾ä¾‹2ï¼šæŒ‡å®šåˆ†å‰²ç¬¦" class="headerlink" title="ä¸¾ä¾‹2ï¼šæŒ‡å®šåˆ†å‰²ç¬¦"></a>ä¸¾ä¾‹2ï¼šæŒ‡å®šåˆ†å‰²ç¬¦</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰è¦åˆ†å‰²çš„æ–‡æœ¬  </span></span><br><span class="line">text = <span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬å•Šã€‚æˆ‘ä»¬å°†ä½¿ç”¨CharacterTextSplitterå°†å…¶åˆ†å‰²æˆå°å—ã€‚åˆ†å‰²åŸºäºå­—ç¬¦æ•°ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># text = &quot;&quot;&quot;  </span></span><br><span class="line"><span class="comment"># LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ç”±è¯­è¨€æ¨¡å‹ã€‚é©±åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶çš„ã€‚å®ƒæä¾›äº†ä¸€å¥—å·¥å…·å’ŒæŠ½è±¡ã€‚ä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´å®¹æ˜“åœ°æ„å»ºå¤æ‚çš„åº”ç”¨ç¨‹åºã€‚  </span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰åˆ†å‰²å™¨å®ä¾‹  </span></span><br><span class="line">text_splitter = CharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">30</span>,   <span class="comment"># æ¯ä¸ªå—çš„æœ€å¤§å­—ç¬¦æ•°  </span></span><br><span class="line">    <span class="comment"># chunk_size=43,   # æ¯ä¸ªå—çš„æœ€å¤§å­—ç¬¦æ•°  </span></span><br><span class="line">    chunk_overlap=<span class="number">0</span>, <span class="comment"># å—ä¹‹é—´çš„é‡å å­—ç¬¦æ•°  </span></span><br><span class="line">    separator=<span class="string">&quot;ã€‚&quot;</span>,  <span class="comment"># æŒ‰å¥å·åˆ†å‰² ï¼ˆåˆ†éš”ç¬¦ä¼˜å…ˆï¼‰  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å¼€å§‹åˆ†å‰²  </span></span><br><span class="line">chunks = text_splitter.split_text(text)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.æ‰“å°æ•ˆæœ  </span></span><br><span class="line"><span class="keyword">for</span>  i,chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å— <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:é•¿åº¦ï¼š<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(chunk)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">50</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Created a chunk of size 33, <span class="built_in">which</span> is longer than the specified 30</span><br><span class="line"></span><br><span class="line">å— 1:é•¿åº¦ï¼š9</span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬å•Š</span><br><span class="line">--------------------------------------------------</span><br><span class="line">å— 2:é•¿åº¦ï¼š33</span><br><span class="line">æˆ‘ä»¬å°†ä½¿ç”¨CharacterTextSplitterå°†å…¶åˆ†å‰²æˆå°å—</span><br><span class="line">--------------------------------------------------</span><br><span class="line">å— 3:é•¿åº¦ï¼š7</span><br><span class="line">åˆ†å‰²åŸºäºå­—ç¬¦æ•°</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šæ— é‡å ã€‚</strong></p><p><strong>separatorä¼˜å…ˆåŸåˆ™</strong>ï¼šå½“è®¾ç½®äº† <strong>separator</strong> ï¼ˆå¦‚â€ã€‚â€ï¼‰ï¼Œåˆ†å‰²å™¨ä¼šé¦–å…ˆå°è¯•åœ¨åˆ†éš”ç¬¦å¤„åˆ†å‰²ï¼Œç„¶åå†è€ƒ è™‘ chunk_sizeã€‚è¿™æ˜¯ä¸ºäº†é¿å…åœ¨å¥å­ä¸­é—´ç¡¬æ€§åˆ‡æ–­ã€‚è¿™ç§è®¾è®¡æ˜¯ä¸ºäº†ï¼š </p><ol><li>ä¼˜å…ˆä¿æŒè¯­ä¹‰å®Œæ•´æ€§ï¼ˆä¸åˆ‡æ–­å¥å­ï¼‰</li><li>é¿å…äº§ç”Ÿæ— æ„ä¹‰çš„ç¢ç‰‡ï¼ˆå¦‚åŠä¸ªå•è¯&#x2F;ä¸å®Œæ•´å¥å­ï¼‰</li><li>å¦‚æœ <strong>chunk_size</strong> æ¯”ç‰‡æ®µå°ï¼Œæ— æ³•æ‹†åˆ†ç‰‡æ®µï¼Œå¯¼è‡´ overlapå¤±æ•ˆã€‚</li><li>chunk_overlapä»…åœ¨åˆå¹¶åçš„ç‰‡æ®µä¹‹é—´ç”Ÿæ•ˆï¼ˆå¦‚æœ <strong>chunk_size</strong> è¶³å¤Ÿå¤§ï¼‰ã€‚å¦‚æœæ²¡æœ‰åˆå¹¶çš„ç‰‡ æ®µï¼Œåˆ™ overlapå¤±æ•ˆã€‚è§ä¸¾ä¾‹3ã€‚</li></ol><h4 id="ä¸¾ä¾‹3ï¼šæŒ‡å®šåˆ†å‰²ç¬¦"><a href="#ä¸¾ä¾‹3ï¼šæŒ‡å®šåˆ†å‰²ç¬¦" class="headerlink" title="ä¸¾ä¾‹3ï¼šæŒ‡å®šåˆ†å‰²ç¬¦"></a>ä¸¾ä¾‹3ï¼šæŒ‡å®šåˆ†å‰²ç¬¦</h4><p>æ³¨æ„ï¼š<strong>æœ‰é‡å </strong>ã€‚æ­¤æ—¶ï¼Œæ–‡æœ¬â€œè¿™æ˜¯ç¬¬äºŒæ®µå†…å®¹ã€‚â€çš„tokenæ­£å¥½å°±æ˜¯8ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰è¦åˆ†å‰²çš„æ–‡æœ¬  </span></span><br><span class="line">text = <span class="string">&quot;è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡æœ¬ã€‚è¿™æ˜¯ç¬¬äºŒæ®µå†…å®¹ã€‚æœ€åä¸€æ®µç»“æŸã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰å­—ç¬¦åˆ†å‰²å™¨  </span></span><br><span class="line">text_splitter = CharacterTextSplitter(  </span><br><span class="line">    separator=<span class="string">&quot;ã€‚&quot;</span>,  </span><br><span class="line">    chunk_size=<span class="number">20</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">8</span>,  </span><br><span class="line">    keep_separator=<span class="literal">True</span> <span class="comment">#chunkä¸­æ˜¯å¦ä¿ç•™åˆ‡å‰²ç¬¦  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ†å‰²æ–‡æœ¬  </span></span><br><span class="line">chunks = text_splitter.split_text(text)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.æ‰“å°ç»“æœ  </span></span><br><span class="line"><span class="keyword">for</span>  i,chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å— <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:é•¿åº¦ï¼š<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(chunk)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">50</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å— 1:é•¿åº¦ï¼š15</span><br><span class="line">è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡æœ¬ã€‚è¿™æ˜¯ç¬¬äºŒæ®µå†…å®¹</span><br><span class="line">--------------------------------------------------</span><br><span class="line">å— 2:é•¿åº¦ï¼š16</span><br><span class="line">ã€‚è¿™æ˜¯ç¬¬äºŒæ®µå†…å®¹ã€‚æœ€åä¸€æ®µç»“æŸã€‚</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><h3 id="RecursiveCharacterTextSplitterï¼šæœ€å¸¸ç”¨"><a href="#RecursiveCharacterTextSplitterï¼šæœ€å¸¸ç”¨" class="headerlink" title="RecursiveCharacterTextSplitterï¼šæœ€å¸¸ç”¨"></a>RecursiveCharacterTextSplitterï¼šæœ€å¸¸ç”¨</h3><p>æ–‡æ¡£åˆ‡åˆ†å™¨ä¸­è¾ƒå¸¸ç”¨çš„æ˜¯ <strong>RecursiveCharacterTextSplitter (é€’å½’å­—ç¬¦æ–‡æœ¬åˆ‡åˆ†å™¨)</strong> ï¼Œé‡<strong>ç‰¹å®šå­—ç¬¦</strong>æ—¶è¿›è¡Œåˆ†å‰²ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°è¯•è¿›è¡Œåˆ‡å‰²çš„å­—ç¬¦åŒ…æ‹¬[â€œ\n\nâ€, â€œ\nâ€, â€œ â€œ, â€œâ€] ã€‚ </p><p>å…·ä½“ä¸ºï¼šæ ¹æ®ç¬¬ä¸€ä¸ªå­—ç¬¦è¿›è¡Œåˆ‡å—ï¼Œä½†å¦‚æœä»»ä½•åˆ‡å—å¤ªå¤§ï¼Œåˆ™ä¼šç»§ç»­ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦ç»§ç»­åˆ‡å—ï¼Œä»¥æ­¤ ç±»æ¨ã€‚<br>æ­¤å¤–ï¼Œè¿˜å¯ä»¥è€ƒè™‘æ·»åŠ ï¼Œã€‚ç­‰åˆ†å‰²å­—ç¬¦ã€‚<br><strong>ç‰¹ç‚¹</strong>ï¼š </p><ul><li><strong>ä¿ç•™ä¸Šä¸‹æ–‡</strong>ï¼šä¼˜å…ˆåœ¨è‡ªç„¶è¯­è¨€è¾¹ç•Œï¼ˆå¦‚æ®µè½ã€å¥å­ç»“å°¾ï¼‰å¤„åˆ†å‰²ï¼Œ <strong>å‡å°‘ä¿¡æ¯ç¢ç‰‡åŒ–</strong>ã€‚</li><li><strong>æ™ºèƒ½åˆ†æ®µ</strong>ï¼šé€šè¿‡é€’å½’å°è¯•å¤šç§åˆ†éš”ç¬¦ï¼Œå°†æ–‡æœ¬åˆ†å‰²ä¸ºå¤§å°æ¥è¿‘chunk_sizeçš„ç‰‡æ®µã€‚ </li><li><strong>çµæ´»é€‚é…</strong>ï¼šé€‚ç”¨äºå¤šç§æ–‡æœ¬ç±»å‹ï¼ˆä»£ç ã€Markdownã€æ™®é€šæ–‡æœ¬ç­‰ï¼‰ï¼Œæ˜¯LangChainä¸­æœ€é€šç”¨çš„ æ–‡æœ¬æ‹†åˆ†å™¨ã€‚</li></ul><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šçš„å‚æ•°åŒ…æ‹¬ï¼š</p><ul><li>chunk_sizeï¼šåŒTextSplitterï¼ˆçˆ¶ç±»ï¼‰ ã€‚ </li><li>chunk_overlapï¼šåŒTextSplitterï¼ˆçˆ¶ç±»ï¼‰ ã€‚ </li><li>length_functionï¼šåŒTextSplitterï¼ˆçˆ¶ç±»ï¼‰ ã€‚ </li><li>add_start_indexï¼šåŒTextSplitterï¼ˆçˆ¶ç±»ï¼‰ ã€‚</li></ul><h4 id="ä¸¾ä¾‹1ï¼šä½¿ç”¨split-text-æ–¹æ³•æ¼”ç¤º"><a href="#ä¸¾ä¾‹1ï¼šä½¿ç”¨split-text-æ–¹æ³•æ¼”ç¤º" class="headerlink" title="ä¸¾ä¾‹1ï¼šä½¿ç”¨split_text()æ–¹æ³•æ¼”ç¤º"></a>ä¸¾ä¾‹1ï¼šä½¿ç”¨split_text()æ–¹æ³•æ¼”ç¤º</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> RecursiveCharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰RecursiveCharacterTextSplitteråˆ†å‰²å™¨å¯¹è±¡  </span></span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">10</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">0</span>,  </span><br><span class="line">    <span class="comment">#add_start_index=True,  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰æ‹†åˆ†çš„å†…å®¹  </span></span><br><span class="line">text=<span class="string">&quot;LangChainæ¡†æ¶ç‰¹æ€§\n\nå¤šæ¨¡å‹é›†æˆ(GPT/Claude)\nè®°å¿†ç®¡ç†åŠŸèƒ½\né“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„ç†PDF/Wordç­‰æ ¼å¼ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.æ‹†åˆ†å™¨åˆ†å‰²  </span></span><br><span class="line">paragraphs = text_splitter.split_text(text)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> para <span class="keyword">in</span> paragraphs:  </span><br><span class="line">    <span class="built_in">print</span>(para)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-------&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">LangChainæ¡†</span><br><span class="line">-------</span><br><span class="line">æ¶ç‰¹æ€§</span><br><span class="line">-------</span><br><span class="line">å¤šæ¨¡å‹é›†æˆ(GPT</span><br><span class="line">-------</span><br><span class="line">/Claude)</span><br><span class="line">-------</span><br><span class="line">è®°å¿†ç®¡ç†åŠŸèƒ½</span><br><span class="line">-------</span><br><span class="line">é“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£</span><br><span class="line">-------</span><br><span class="line">åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„</span><br><span class="line">-------</span><br><span class="line">ç†PDF/Wordç­‰</span><br><span class="line">-------</span><br><span class="line">æ ¼å¼ã€‚</span><br><span class="line">-------</span><br></pre></td></tr></table></figure><h4 id="ä¸¾ä¾‹2ï¼šä½¿ç”¨create-documents-æ–¹æ³•æ¼”ç¤ºï¼Œä¼ å…¥å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¿”å›Documentå¯¹è±¡åˆ—è¡¨"><a href="#ä¸¾ä¾‹2ï¼šä½¿ç”¨create-documents-æ–¹æ³•æ¼”ç¤ºï¼Œä¼ å…¥å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¿”å›Documentå¯¹è±¡åˆ—è¡¨" class="headerlink" title="ä¸¾ä¾‹2ï¼šä½¿ç”¨create_documents()æ–¹æ³•æ¼”ç¤ºï¼Œä¼ å…¥å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¿”å›Documentå¯¹è±¡åˆ—è¡¨"></a>ä¸¾ä¾‹2ï¼šä½¿ç”¨create_documents()æ–¹æ³•æ¼”ç¤ºï¼Œä¼ å…¥å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¿”å›Documentå¯¹è±¡åˆ—è¡¨</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> RecursiveCharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰RecursiveCharacterTextSplitteråˆ†å‰²å™¨å¯¹è±¡  </span></span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">10</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">0</span>,  </span><br><span class="line">    add_start_index=<span class="literal">True</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰æ‹†åˆ†çš„å†…å®¹  </span></span><br><span class="line">text_list = [<span class="string">&quot;LangChainæ¡†æ¶ç‰¹æ€§\n\nå¤šæ¨¡å‹é›†æˆ(GPT/Claude)\nè®°å¿†ç®¡ç†åŠŸèƒ½\né“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„ç†PDF/Wordç­‰æ ¼å¼ã€‚&quot;</span>]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.æ‹†åˆ†å™¨åˆ†å‰²  </span></span><br><span class="line">paragraphs = text_splitter.create_documents(text_list)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> para <span class="keyword">in</span> paragraphs:  </span><br><span class="line">    <span class="built_in">print</span>(para)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-------&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">page_content=<span class="string">&#x27;LangChainæ¡†&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 0&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;æ¶ç‰¹æ€§&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 10&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;å¤šæ¨¡å‹é›†æˆ(GPT&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 15&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;/Claude)&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 24&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;è®°å¿†ç®¡ç†åŠŸèƒ½&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 33&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;é“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 40&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 49&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;ç†PDF/Wordç­‰&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 59&#125;</span><br><span class="line">-------</span><br><span class="line">page_content=<span class="string">&#x27;æ ¼å¼ã€‚&#x27;</span> metadata=&#123;<span class="string">&#x27;start_index&#x27;</span>: 69&#125;</span><br><span class="line">-------</span><br></pre></td></tr></table></figure><p><strong>é€æ­¥åˆ†å‰²è¿‡ç¨‹</strong></p><p><strong>ç¬¬ä¸€é˜¶æ®µï¼šé¡¶çº§åˆ†å‰²ï¼ˆæŒ‰\n\nï¼‰</strong></p><ol><li>é¦–æ¬¡åˆ†å‰²ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">text.split( <span class="string">&quot;\n\n&quot;</span> ) â†’ </span><br><span class="line">[ <span class="string">&quot;LangChainæ¡†æ¶ç‰¹æ€§&quot;</span> ,</span><br><span class="line"> <span class="string">&quot;å¤šæ¨¡å‹é›†æˆ(GPT/Claude)\nè®°å¿†ç®¡ç†åŠŸèƒ½\né“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„ç† PDF/Wordç­‰æ ¼å¼ã€‚&quot;</span> ]</span><br></pre></td></tr></table></figure></li></ol><ul><li>ç¬¬ä¸€éƒ¨åˆ†é•¿åº¦ï¼š13å­—ç¬¦ &gt; 10 â†’ éœ€è¦ç»§ç»­åˆ†å‰² </li><li>ç¬¬äºŒéƒ¨åˆ†é•¿åº¦ï¼š79å­—ç¬¦ &gt; 10 â†’ éœ€è¦ç»§ç»­åˆ†å‰²</li></ul><p><strong>ç¬¬äºŒé˜¶æ®µï¼šé€’å½’åˆ†å‰²ç¬¬ä¸€éƒ¨åˆ† â€œLangChainæ¡†æ¶ç‰¹æ€§â€</strong></p><ol><li>å°è¯• \n ï¼šæ— åŒ¹é… </li><li>å°è¯•ï¼ˆç©ºæ ¼ï¼‰ï¼š<ul><li>æ£€æŸ¥å­—ç¬¦ä¸²ï¼š â€œLangChainæ¡†æ¶ç‰¹æ€§â€ ï¼ˆæ— ç©ºæ ¼ï¼‰</li></ul></li><li>å›é€€åˆ°â€â€ï¼ˆå­—ç¬¦çº§åˆ†å‰²ï¼‰ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> ( <span class="string">&quot;LangChainæ¡†æ¶ç‰¹æ€§&quot;</span> ) â†’ </span><br><span class="line">[ <span class="string">&#x27;L&#x27;</span> , <span class="string">&#x27;a&#x27;</span> , <span class="string">&#x27;n&#x27;</span> , <span class="string">&#x27;g&#x27;</span> , <span class="string">&#x27;C&#x27;</span> , <span class="string">&#x27;h&#x27;</span> , <span class="string">&#x27;a&#x27;</span> , <span class="string">&#x27;i&#x27;</span> , <span class="string">&#x27;n&#x27;</span> , <span class="string">&#x27;æ¡†&#x27;</span> , <span class="string">&#x27;æ¶&#x27;</span> , <span class="string">&#x27;ç‰¹&#x27;</span> , <span class="string">&#x27;æ€§&#x27;</span> ]</span><br></pre></td></tr></table></figure><ul><li>å‰10å­—ç¬¦ï¼š â€œLangChainæ¡†â€ </li><li>å‰©ä½™éƒ¨åˆ†ï¼š â€œæ¶ç‰¹æ€§â€</li></ul></li></ol><p><strong>ç¬¬ä¸‰é˜¶æ®µï¼šé€’å½’åˆ†å‰²ç¬¬äºŒéƒ¨åˆ†ï¼ˆé•¿æ®µè½ï¼‰</strong></p><ol><li>æŒ‰ \n åˆ†å‰²ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;å¤šæ¨¡å‹é›†æˆ(GPT/Claude)\nè®°å¿†ç®¡ç†åŠŸèƒ½\né“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£...&quot;</span> .split( <span class="string">&quot;\n&quot;</span> ) â†’ </span><br><span class="line">[ <span class="string">&quot;å¤šæ¨¡å‹é›†æˆ(GPT/Claude)&quot;</span> , <span class="comment"># 17å­—ç¬¦ </span></span><br><span class="line"><span class="string">&quot;è®°å¿†ç®¡ç†åŠŸèƒ½&quot;</span> , <span class="comment"># 6å­—ç¬¦</span></span><br><span class="line"><span class="string">&quot;é“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„ç†PDF/Wordç­‰æ ¼å¼ã€‚&quot;</span> <span class="comment"># 36å­—ç¬¦</span></span><br><span class="line">] </span><br></pre></td></tr></table></figure></li></ol><ul><li>ç¬¬1å—ï¼š17å­—ç¬¦ &gt; 10 â†’ ç»§ç»­åˆ†å‰² </li><li>ç¬¬2å—ï¼š6å­—ç¬¦ â‰¤ 10 â†’ ç›´æ¥ä¿ç•™ </li><li>ç¬¬3å—ï¼š36å­—ç¬¦ &gt; 10 â†’ ç»§ç»­åˆ†å‰²</li></ul><ol start="2"><li>åˆ†å‰² â€œå¤šæ¨¡å‹é›†æˆ(GPT&#x2F;Claude)â€ ï¼š<ul><li>å°è¯•ï¼šæ— ç©ºæ ¼ </li><li>å›é€€åˆ°â€â€ï¼š <ul><li>å‰10å­—ç¬¦ï¼š â€œå¤šæ¨¡å‹é›†æˆ(GPTâ€ </li><li>å‰©ä½™7å­—ç¬¦ï¼š â€œ&#x2F;Claude)â€</li></ul></li></ul></li><li>åˆ†å‰² <strong>â€œé“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„ç†PDF&#x2F;Wordç­‰æ ¼å¼</strong>ã€‚â€ï¼š<ul><li>å°è¯•ï¼šæ— ç©ºæ ¼ </li><li>å›é€€åˆ°â€â€:<ul><li>æŒ‰10å­—ç¬¦åˆ†æ®µï¼š  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;é“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„ç†PDF/Wordç­‰æ ¼å¼ã€‚&quot;</span> â†’ </span><br><span class="line">[</span><br><span class="line"><span class="string">&quot;é“¾å¼è°ƒç”¨è®¾è®¡ã€‚æ–‡æ¡£&quot;</span> , </span><br><span class="line"><span class="string">&quot;åˆ†æåœºæ™¯ç¤ºä¾‹ï¼šéœ€è¦å¤„&quot;</span> , </span><br><span class="line"><span class="string">&quot;ç†PDF/Wordç­‰&quot;</span> , </span><br><span class="line"><span class="string">&quot;æ ¼å¼ã€‚&quot;</span></span><br><span class="line"> ]</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ol><h4 id="ä¸¾ä¾‹3ï¼šä½¿ç”¨create-documents-æ–¹æ³•æ¼”ç¤ºï¼Œå°†æœ¬åœ°æ–‡ä»¶å†…å®¹åŠ è½½æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ‹†åˆ†"><a href="#ä¸¾ä¾‹3ï¼šä½¿ç”¨create-documents-æ–¹æ³•æ¼”ç¤ºï¼Œå°†æœ¬åœ°æ–‡ä»¶å†…å®¹åŠ è½½æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ‹†åˆ†" class="headerlink" title="ä¸¾ä¾‹3ï¼šä½¿ç”¨create_documents()æ–¹æ³•æ¼”ç¤ºï¼Œå°†æœ¬åœ°æ–‡ä»¶å†…å®¹åŠ è½½æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ‹†åˆ†"></a>ä¸¾ä¾‹3ï¼šä½¿ç”¨create_documents()æ–¹æ³•æ¼”ç¤ºï¼Œå°†æœ¬åœ°æ–‡ä»¶å†…å®¹åŠ è½½æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ‹†åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.æ‰“å¼€.txtæ–‡ä»¶  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;asset/load/08-ai.txt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    state_of_the_union = f.read()  <span class="comment">#è¿”å›çš„æ˜¯å­—ç¬¦ä¸²  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(state_of_the_union))  <span class="comment"># &lt;class &#x27;str&#x27;&gt;  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰RecursiveCharacterTextSplitterï¼ˆé€’å½’å­—ç¬¦åˆ†å‰²å™¨ï¼‰  </span></span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">100</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">20</span>,  </span><br><span class="line">    <span class="comment">#chunk_overlap=0,  </span></span><br><span class="line">    length_function=<span class="built_in">len</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ†å‰²æ–‡æœ¬  </span></span><br><span class="line">texts = text_splitter.create_documents([state_of_the_union])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.æ‰“å°åˆ†å‰²æ–‡æœ¬  </span></span><br><span class="line"><span class="keyword">for</span> document <span class="keyword">in</span> texts:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ”¥<span class="subst">&#123;document.page_content&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line">ğŸ”¥äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</span><br><span class="line">ğŸ”¥äººå·¥æ™ºèƒ½ï¼ˆArtificial</span><br><span class="line">ğŸ”¥Intelligenceï¼Œç®€ç§°AIï¼‰æ˜¯æŒ‡ç”±è®¡ç®—æœºç³»ç»Ÿæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„æŠ€æœ¯ï¼Œä½¿å…¶èƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»è®¤çŸ¥èƒ½åŠ›çš„ä»»åŠ¡ï¼Œå¦‚å­¦ä¹ ã€æ¨ç†ã€å†³ç­–å’Œè¯­è¨€ç†è§£ã€‚AIçš„æ ¸å¿ƒç›®æ ‡æ˜¯è®©æœºå™¨å…·å¤‡æ„ŸçŸ¥ç¯å¢ƒã€å¤„ç†ä¿¡æ¯å¹¶è‡ªä¸»è¡ŒåŠ¨çš„</span><br><span class="line">ğŸ”¥è®©æœºå™¨å…·å¤‡æ„ŸçŸ¥ç¯å¢ƒã€å¤„ç†ä¿¡æ¯å¹¶è‡ªä¸»è¡ŒåŠ¨çš„èƒ½åŠ›ã€‚</span><br><span class="line">ğŸ”¥1. AIçš„æŠ€æœ¯åŸºç¡€</span><br><span class="line">AIä¾èµ–å¤šç§å…³é”®æŠ€æœ¯ï¼š</span><br><span class="line"></span><br><span class="line">æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰ï¼šé€šè¿‡ç®—æ³•è®©è®¡ç®—æœºä»æ•°æ®ä¸­å­¦ä¹ è§„å¾‹ï¼Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ä¾‹å¦‚ï¼Œæ¨èç³»ç»Ÿé€šè¿‡ç”¨æˆ·å†å²è¡Œä¸ºé¢„æµ‹åå¥½ã€‚</span><br><span class="line">ğŸ”¥æ·±åº¦å­¦ä¹ ï¼šåŸºäºç¥ç»ç½‘ç»œçš„æœºå™¨å­¦ä¹ åˆ†æ”¯ï¼Œæ“…é•¿å¤„ç†å›¾åƒã€è¯­éŸ³ç­‰å¤æ‚æ•°æ®ã€‚AlphaGoå‡»è´¥å›´æ£‹å† å†›ä¾¿æ˜¯å…¸å‹æ¡ˆä¾‹ã€‚</span><br><span class="line"></span><br><span class="line">è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ï¼šä½¿è®¡ç®—æœºç†è§£ã€ç”Ÿæˆäººç±»è¯­è¨€ï¼Œå¦‚ChatGPTçš„å¯¹è¯èƒ½åŠ›ã€‚</span><br><span class="line">ğŸ”¥2. AIçš„åº”ç”¨åœºæ™¯</span><br><span class="line">AIå·²æ¸—é€åˆ°æ—¥å¸¸ç”Ÿæ´»å’Œå„è¡Œå„ä¸šï¼š</span><br><span class="line"></span><br><span class="line">åŒ»ç–—ï¼šè¾…åŠ©è¯Šæ–­ï¼ˆå¦‚AIåˆ†æåŒ»å­¦å½±åƒï¼‰ã€è¯ç‰©ç ”å‘åŠ é€Ÿã€‚</span><br><span class="line"></span><br><span class="line">äº¤é€šï¼šè‡ªåŠ¨é©¾é©¶æ±½è½¦é€šè¿‡ä¼ æ„Ÿå™¨å’ŒAIç®—æ³•å®ç°å®‰å…¨å¯¼èˆªã€‚</span><br><span class="line">ğŸ”¥é‡‘èï¼šæ¬ºè¯ˆæ£€æµ‹ã€æ™ºèƒ½æŠ•é¡¾ï¼ˆå¦‚é£é™©è¯„ä¼°æ¨¡å‹ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">æ•™è‚²ï¼šä¸ªæ€§åŒ–å­¦ä¹ å¹³å°æ ¹æ®å­¦ç”Ÿè¡¨ç°è°ƒæ•´æ•™å­¦å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">3. AIçš„æŒ‘æˆ˜ä¸æœªæ¥</span><br><span class="line">å°½ç®¡å‰æ™¯å¹¿é˜”ï¼ŒAIä»é¢ä¸´é—®é¢˜ï¼š</span><br><span class="line">ğŸ”¥ä¼¦ç†äº‰è®®ï¼šæ•°æ®éšç§ã€ç®—æ³•åè§ï¼ˆå¦‚æ‹›è˜AIæ­§è§†ç‰¹å®šç¾¤ä½“ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å°±ä¸šå½±å“ï¼šè‡ªåŠ¨åŒ–å¯èƒ½å–ä»£éƒ¨åˆ†äººå·¥å²—ä½ï¼Œä½†ä¹Ÿä¼šåˆ›é€ æ–°èŒä¸šã€‚</span><br><span class="line"></span><br><span class="line">æŠ€æœ¯ç“¶é¢ˆï¼šé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆAGIï¼‰å°šæœªå®ç°ï¼Œå½“å‰AIä»…æ“…é•¿ç‰¹å®šä»»åŠ¡ã€‚</span><br><span class="line">ğŸ”¥æœªæ¥ï¼ŒAIå°†ä¸äººç±»åä½œè€Œéæ›¿ä»£ï¼šåŒ»ç”Ÿå€ŸåŠ©AIæé«˜è¯Šæ–­æ•ˆç‡ï¼Œæ•™å¸ˆåˆ©ç”¨AIå®šåˆ¶è¯¾ç¨‹ã€‚å…¶å‘å±•éœ€å¹³è¡¡æŠ€æœ¯åˆ›æ–°ä¸ç¤¾ä¼šè´£ä»»ï¼Œç¡®ä¿æŠ€æœ¯é€ ç¦å…¨äººç±»ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸¾ä¾‹4ï¼šä½¿ç”¨split-documents-æ–¹æ³•æ¼”ç¤ºï¼Œåˆ©ç”¨PDFLoaderåŠ è½½æ–‡æ¡£ï¼Œå¯¹æ–‡æ¡£çš„å†…å®¹ç”¨é€’å½’åˆ‡å‰²å™¨åˆ‡å‰²"><a href="#ä¸¾ä¾‹4ï¼šä½¿ç”¨split-documents-æ–¹æ³•æ¼”ç¤ºï¼Œåˆ©ç”¨PDFLoaderåŠ è½½æ–‡æ¡£ï¼Œå¯¹æ–‡æ¡£çš„å†…å®¹ç”¨é€’å½’åˆ‡å‰²å™¨åˆ‡å‰²" class="headerlink" title="ä¸¾ä¾‹4ï¼šä½¿ç”¨split_documents()æ–¹æ³•æ¼”ç¤ºï¼Œåˆ©ç”¨PDFLoaderåŠ è½½æ–‡æ¡£ï¼Œå¯¹æ–‡æ¡£çš„å†…å®¹ç”¨é€’å½’åˆ‡å‰²å™¨åˆ‡å‰²"></a>ä¸¾ä¾‹4ï¼šä½¿ç”¨split_documents()æ–¹æ³•æ¼”ç¤ºï¼Œåˆ©ç”¨PDFLoaderåŠ è½½æ–‡æ¡£ï¼Œå¯¹æ–‡æ¡£çš„å†…å®¹ç”¨é€’å½’åˆ‡å‰²å™¨åˆ‡å‰²</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> PyPDFLoader  </span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> RecursiveCharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰PyPDFLoaderåŠ è½½å™¨  </span></span><br><span class="line">loader = PyPDFLoader(<span class="string">&quot;./asset/load/02-load.pdf&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åŠ è½½å’Œåˆ‡å‰²æ–‡æ¡£å¯¹è±¡  </span></span><br><span class="line">docs = loader.load()   <span class="comment"># è¿”å›Documentå¯¹è±¡æ„æˆçš„list  </span></span><br><span class="line"><span class="comment"># print(f&quot;ç¬¬0é¡µï¼š\n&#123;docs[0]&#125;&quot;)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰åˆ‡å‰²å™¨  </span></span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">200</span>,  </span><br><span class="line">    <span class="comment">#chunk_size=120,  </span></span><br><span class="line">    chunk_overlap=<span class="number">0</span>,  </span><br><span class="line">    <span class="comment"># chunk_overlap=100,  </span></span><br><span class="line">    length_function=<span class="built_in">len</span>,  </span><br><span class="line">    add_start_index=<span class="literal">True</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å¯¹pdfå†…å®¹è¿›è¡Œåˆ‡å‰²å¾—åˆ°æ–‡æ¡£å¯¹è±¡  </span></span><br><span class="line">paragraphs = text_splitter.split_documents(docs)  </span><br><span class="line"><span class="comment">#paragraphs = text_splitter.create_documents([text])  </span></span><br><span class="line"><span class="keyword">for</span> para <span class="keyword">in</span> paragraphs:  </span><br><span class="line">    <span class="built_in">print</span>(para.page_content)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-------&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;ä»–çš„è½¦ï¼Œä»–çš„å‘½ï¼ ä»–å¿½ç„¶æƒ³èµ·æ¥ï¼Œä¸€å¹´ï¼ŒäºŒå¹´ï¼Œè‡³å°‘æœ‰ä¸‰å››å¹´ï¼›ä¸€æ»´æ±—ï¼Œä¸¤æ»´æ±—ï¼Œä¸</span></span><br><span class="line"><span class="string">çŸ¥é“å¤šå°‘ä¸‡æ»´æ±—ï¼Œæ‰æŒ£å‡ºé‚£è¾†è½¦ã€‚ä»é£é‡Œé›¨é‡Œçš„å’¬ç‰™ï¼Œä»é¥­é‡ŒèŒ¶é‡Œçš„è‡ªè‹¦ï¼Œæ‰èµšå‡ºé‚£è¾†è½¦ã€‚</span></span><br><span class="line"><span class="string">é‚£è¾†è½¦æ˜¯ä»–çš„ä¸€åˆ‡æŒ£æ‰ä¸å›°è‹¦çš„æ€»ç»“æœä¸æŠ¥é…¬ï¼Œåƒèº«ç»ç™¾æˆ˜çš„æ­¦å£«çš„ä¸€é¢—å¾½ç« ã€‚â€¦â€¦ä»–è€æƒ³</span></span><br><span class="line"><span class="string">ç€è¿œè¿œçš„ä¸€è¾†è½¦ï¼Œå¯ä»¥ä½¿ä»–è‡ªç”±ï¼Œç‹¬ç«‹ï¼Œåƒè‡ªå·±çš„æ‰‹è„šçš„é‚£ä¹ˆä¸€è¾†è½¦ã€‚&quot;</span> </span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;ä»–åƒï¼Œä»–å–ï¼Œä»–å«–ï¼Œä»–èµŒï¼Œä»–æ‡’ï¼Œä»–ç‹¡çŒ¾ï¼Œ å› ä¸ºä»–æ²¡äº†å¿ƒï¼Œä»–çš„å¿ƒè¢«äººå®¶æ‘˜äº†å»ã€‚ä»–</span></span><br><span class="line"><span class="string">-------</span></span><br><span class="line"><span class="string">åªå‰©ä¸‹é‚£ä¸ªé«˜å¤§çš„è‚‰æ¶å­ï¼Œç­‰ç€æºƒçƒ‚ï¼Œé¢„å¤‡ç€åˆ°ä¹±æ­»å²—å­å»ã€‚â€¦â€¦ä½“é¢çš„ã€è¦å¼ºçš„ã€å¥½æ¢¦æƒ³</span></span><br><span class="line"><span class="string">çš„ã€åˆ©å·±çš„ã€ä¸ªäººçš„ã€å¥å£®çš„ã€ä¼Ÿå¤§çš„ç¥¥å­ï¼Œä¸çŸ¥é™ªç€äººå®¶é€äº†å¤šå°‘å›æ®¡ï¼›ä¸çŸ¥é“ä½•æ—¶ä½•åœ°</span></span><br><span class="line"><span class="string">ä¼šåŸ‹èµ·ä»–è‡ªå·±æ¥ï¼Œ åŸ‹èµ·è¿™å •è½çš„ã€ è‡ªç§çš„ã€ ä¸å¹¸çš„ã€ ç¤¾ä¼šç—…èƒé‡Œçš„äº§å„¿ï¼Œ ä¸ªäººä¸»ä¹‰çš„æœ«è·¯é¬¼ï¼</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line">-------</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸¾ä¾‹5ï¼šè‡ªå®šä¹‰åˆ†éš”ç¬¦"><a href="#ä¸¾ä¾‹5ï¼šè‡ªå®šä¹‰åˆ†éš”ç¬¦" class="headerlink" title="ä¸¾ä¾‹5ï¼šè‡ªå®šä¹‰åˆ†éš”ç¬¦"></a>ä¸¾ä¾‹5ï¼šè‡ªå®šä¹‰åˆ†éš”ç¬¦</h4><p>æœ‰äº›ä¹¦å†™ç³»ç»Ÿæ²¡æœ‰å•è¯è¾¹ç•Œï¼Œä¾‹å¦‚ä¸­æ–‡ã€æ—¥æ–‡å’Œæ³°æ–‡ã€‚ä½¿ç”¨é»˜è®¤åˆ†éš”ç¬¦åˆ—è¡¨[â€œ\n\nâ€, â€œ\nâ€, â€œ â€œ, â€œâ€]åˆ†å‰²æ–‡ æœ¬å¯èƒ½å¯¼è‡´å•è¯é”™è¯¯çš„åˆ†å‰²ã€‚ä¸ºäº†ä¿æŒå•è¯åœ¨ä¸€èµ·ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰åˆ†å‰²å­—ç¬¦ï¼Œè¦†ç›–åˆ†éš”ç¬¦åˆ—è¡¨ä»¥åŒ…å«é¢ å¤–çš„æ ‡ç‚¹ç¬¦å·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">text_splitter = RecursiveCharacterTextSplitter( chunk_size=<span class="number">200</span>, chunk_overlap=<span class="number">20</span>, <span class="comment"># å¢åŠ é‡å å­—ç¬¦ </span></span><br><span class="line">separators=[ <span class="string">&quot;\n\n&quot;</span> , <span class="string">&quot;\n&quot;</span> , <span class="string">&quot;ã€‚&quot;</span> , <span class="string">&quot;ï¼&quot;</span> , <span class="string">&quot;ï¼Ÿ&quot;</span> , <span class="string">&quot;â€¦â€¦&quot;</span> , <span class="string">&quot;ï¼Œ&quot;</span> , <span class="string">&quot;&quot;</span> ], <span class="comment"># æ·»åŠ ä¸­æ–‡æ ‡ç‚¹ </span></span><br><span class="line">length_function= <span class="built_in">len</span> , keep_separator=<span class="literal">True</span> <span class="comment">#ä¿ç•™å¥å°¾æ ‡ç‚¹ï¼ˆå¦‚ â€¦â€¦ï¼‰ï¼Œé¿å…åˆ‡å‰²åä¸¢å¤±è¯­æ°”å’Œé€»è¾‘ </span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="TokenTextSplitter-CharacterTextSplitterï¼šSplit-by-tokens"><a href="#TokenTextSplitter-CharacterTextSplitterï¼šSplit-by-tokens" class="headerlink" title="TokenTextSplitter&#x2F;CharacterTextSplitterï¼šSplit by tokens"></a>TokenTextSplitter&#x2F;CharacterTextSplitterï¼šSplit by tokens</h3><p>å½“æˆ‘ä»¬å°†æ–‡æœ¬æ‹†åˆ†ä¸ºå—æ—¶ï¼Œé™¤äº†å­—ç¬¦ä»¥å¤–ï¼Œè¿˜å¯ä»¥ï¼š <strong>æŒ‰Tokençš„æ•°é‡åˆ†å‰²</strong> ï¼ˆè€Œéå­—ç¬¦æˆ–å•è¯æ•°ï¼‰ï¼Œå°†é•¿ æ–‡æœ¬åˆ‡åˆ†æˆå¤šä¸ªå°å—ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯Tokenï¼Ÿ</strong> </p><ul><li>å¯¹æ¨¡å‹è€Œè¨€ï¼ŒTokenæ˜¯æ–‡æœ¬çš„æœ€å°å¤„ç†å•ä½ã€‚ä¾‹å¦‚ï¼š <ul><li>è‹±æ–‡ï¼š â€œhelloâ€ â†’ 1ä¸ªTokenï¼Œ </li><li>ä¸­æ–‡ï¼š â€œChatGPTâ€ â†’ 2ä¸ªTokenï¼ˆ â€œChatâ€ + â€œGPTâ€ ï¼‰ã€‚ â€œäººå·¥æ™ºèƒ½â€ â†’ å¯èƒ½æ‹†åˆ†ä¸º2-3ä¸ªTokenï¼ˆå–å†³äºåˆ†è¯å™¨ï¼‰ã€‚</li></ul></li></ul><p> <strong>ä¸ºä»€ä¹ˆæŒ‰Tokenåˆ†å‰²ï¼Ÿ</strong> </p><ul><li>è¯­è¨€æ¨¡å‹å¯¹è¾“å…¥é•¿åº¦çš„é™åˆ¶æ˜¯åŸºäºTokenæ•°ï¼ˆå¦‚GPT-4çš„8k&#x2F;32k Tokenä¸Šé™ï¼‰ï¼Œç›´æ¥æŒ‰å­—ç¬¦æˆ–å• è¯åˆ†å‰²å¯èƒ½å¯¼è‡´å®é™…Tokenæ•°è¶…é™ã€‚ï¼ˆç¡®ä¿æ¯ä¸ªæ–‡æœ¬å—ä¸è¶…è¿‡æ¨¡å‹çš„Tokenä¸Šé™ï¼‰ </li><li>å¤§è¯­è¨€æ¨¡å‹(LLM)é€šå¸¸æ˜¯ä»¥tokençš„æ•°é‡ä½œä¸ºå…¶è®¡é‡(æˆ–æ”¶è´¹)çš„ä¾æ®ï¼Œæ‰€ä»¥é‡‡ç”¨tokenåˆ†å‰²ä¹Ÿæœ‰åŠ©äº æˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶æ›´æ–¹ä¾¿çš„æ§åˆ¶æˆæœ¬ã€‚</li></ul><p><strong>TokenTextSplitter ä½¿ç”¨è¯´æ˜</strong>ï¼š </p><ul><li>æ ¸å¿ƒä¾æ®ï¼šTokenæ•°é‡ + è‡ªç„¶è¾¹ç•Œã€‚ï¼ˆTokenTextSplitter ä¸¥æ ¼æŒ‰ç…§ token æ•°é‡è¿›è¡Œåˆ†å‰²ï¼Œä½†åŒæ—¶ ä¼šä¼˜å…ˆåœ¨è‡ªç„¶è¾¹ç•Œï¼ˆå¦‚å¥å°¾ï¼‰å¤„åˆ‡æ–­ï¼Œä»¥å°½é‡ä¿è¯è¯­ä¹‰çš„å®Œæ•´æ€§ã€‚ï¼‰</li><li>ä¼˜ç‚¹ï¼šä¸LLMçš„Tokenè®¡æ•°é€»è¾‘ä¸€è‡´ï¼Œèƒ½å°½é‡ä¿æŒè¯­ä¹‰å®Œæ•´ </li><li>ç¼ºç‚¹ï¼šå¯¹éè‹±è¯­æˆ–ç‰¹å®šé¢†åŸŸæ–‡æœ¬ï¼ŒTokenåŒ–æ•ˆæœå¯èƒ½ä¸ä½³ </li><li>å…¸å‹åœºæ™¯ï¼šéœ€è¦ç²¾ç¡®æ§åˆ¶Tokenæ•°è¾“å…¥LLMçš„åœºæ™¯</li></ul><h4 id="ä¸¾ä¾‹1ï¼šä½¿ç”¨TokenTextSplitter"><a href="#ä¸¾ä¾‹1ï¼šä½¿ç”¨TokenTextSplitter" class="headerlink" title="ä¸¾ä¾‹1ï¼šä½¿ç”¨TokenTextSplitter"></a>ä¸¾ä¾‹1ï¼šä½¿ç”¨TokenTextSplitter</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> TokenTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆå§‹åŒ– TokenTextSplittertext_splitter = TokenTextSplitter(  </span></span><br><span class="line">    chunk_size=<span class="number">33</span>,  <span class="comment">#æœ€å¤§ token æ•°ä¸º 32    chunk_overlap=0, #é‡å  token æ•°ä¸º 0    encoding_name=&quot;cl100k_base&quot;,  # ä½¿ç”¨ OpenAI çš„ç¼–ç å™¨,å°†æ–‡æœ¬è½¬æ¢ä¸º token åºåˆ—  </span></span><br><span class="line">  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰æ–‡æœ¬  </span></span><br><span class="line">text = <span class="string">&quot;äººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼€å‘æ¡†æ¶ã€‚å®ƒæ”¯æŒå¤šç§è¯­è¨€æ¨¡å‹å’Œå·¥å…·é“¾ã€‚äººå·¥æ™ºèƒ½æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç¨‹åºæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„ä¸€é—¨ç§‘å­¦ã€‚è‡ª20ä¸–çºª50å¹´ä»£è¯ç”Ÿä»¥æ¥ï¼Œäººå·¥æ™ºèƒ½ç»å†äº†å¤šæ¬¡èµ·ä¼ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å¼€å§‹åˆ‡å‰²  </span></span><br><span class="line">texts = text_splitter.split_text(text)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ‰“å°åˆ†å‰²ç»“æœ  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åŸå§‹æ–‡æœ¬è¢«åˆ†å‰²æˆäº† <span class="subst">&#123;<span class="built_in">len</span>(texts)&#125;</span> ä¸ªå—:&quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> i, chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(texts):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å— <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>: é•¿åº¦ï¼š<span class="subst">&#123;<span class="built_in">len</span>(chunk)&#125;</span> å†…å®¹ï¼š<span class="subst">&#123;chunk&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åŸå§‹æ–‡æœ¬è¢«åˆ†å‰²æˆäº† 3 ä¸ªå—:</span><br><span class="line">å— 1: é•¿åº¦ï¼š29 å†…å®¹ï¼šäººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼€å‘æ¡†æ¶ã€‚å®ƒæ”¯æŒå¤šç§è¯­è¨€æ¨¡å‹å’Œå·¥å…·é“¾ã€‚</span><br><span class="line">--------------------------------------------------</span><br><span class="line">å— 2: é•¿åº¦ï¼š32 å†…å®¹ï¼šäººå·¥æ™ºèƒ½æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç¨‹åºæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„ä¸€é—¨ç§‘å­¦ã€‚è‡ª20ä¸–çºª50</span><br><span class="line">--------------------------------------------------</span><br><span class="line">å— 3: é•¿åº¦ï¼š19 å†…å®¹ï¼šå¹´ä»£è¯ç”Ÿä»¥æ¥ï¼Œäººå·¥æ™ºèƒ½ç»å†äº†å¤šæ¬¡èµ·ä¼ã€‚</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„åˆ†å‰²ï¼Ÿ</strong><br>1ã€<strong>ç¬¬ä¸€å— (29å­—ç¬¦)</strong> ï¼šå†…å®¹æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¥å­ï¼Œä»¥å¥å·ç»“å°¾ã€‚TokenTextSplitterè¯†åˆ«åˆ°è¿™æ˜¯ä¸€ä¸ªè‡ªç„¶çš„ è¯­ä¹‰è¾¹ç•Œï¼Œå³ä½¿è¿™é‡Œçš„ token æ•°é‡å¯èƒ½å°šæœªè¾¾åˆ° 33ï¼Œå®ƒä¹Ÿé€‰æ‹©åœ¨æ­¤å¤„åˆ‡å‰²ï¼Œä»¥ä¿è¯ç¬¬ä¸€å—è¯­ä¹‰çš„å®Œæ•´ æ€§ã€‚ </p><p>2ã€<strong>ç¬¬äºŒå— (32å­—ç¬¦)</strong> ï¼šå†…å®¹åŒ…å«äº†å¦ä¸€ä¸ªå®Œæ•´å¥å­ â€œ<strong>äººå·¥æ™ºèƒ½æ˜¯æŒ‡â€¦ä¸€é—¨ç§‘å­¦</strong>ã€‚â€ä»¥åŠä¸‹ä¸€å¥çš„å¼€å¤´ 20ä¸–çºª50â€ ã€‚åˆ†å‰²å™¨åœ¨å¤„ç†å®Œç¬¬ä¸€ä¸ªå¥å­çš„ token åï¼Œå¯èƒ½ token æ•°é‡å·²ç»æ¥è¿‘ â€œè‡ª chunk_size ï¼Œäºæ˜¯ åœ¨ä¸‹ä¸€ä¸ªè‡ªç„¶è¾¹ç•Œï¼ˆè¿™é‡Œæ˜¯å¥å·ï¼‰ä¹‹åç»§ç»­è¯»å–äº†å°‘é‡ tokenï¼ˆâ€œè‡ª20ä¸–çºª50â€ï¼‰ï¼Œç›´åˆ°éå¸¸æ¥è¿‘ 33 token çš„é™åˆ¶ã€‚ </p><p><strong>æ³¨æ„</strong>ï¼šâ€œ50â€ ä¹‹åè¢«åˆ‡æ–­ï¼Œæ˜¯å› ä¸ºç¼–ç å™¨å¾ˆå¯èƒ½å°†â€œ50â€è¯†åˆ«ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ tokenï¼Œè€Œâ€œå¹´ä»£â€æ˜¯å¦ ä¸€ä¸ª tokenã€‚ä¸ºäº†ä¿è¯ token çš„å®Œæ•´æ€§ï¼Œå®ƒä¸ä¼šåœ¨â€œ50â€å­—ç¬¦ä¸­é—´åˆ‡æ–­ã€‚</p><p>3ã€<strong>ç¬¬ä¸‰å— (19å­—ç¬¦)</strong> ï¼šæ˜¯ç¬¬äºŒå—ä¸­æ–­å†…å®¹çš„å‰©ä½™éƒ¨åˆ†ï¼Œå½¢æˆäº†ä¸€ä¸ªè¾ƒçŸ­çš„å—ã€‚è¿™æ˜¯å› ä¸ºå‰©ä½™å†…å®¹æœ¬èº«çš„ token æ•°é‡å°±è¾ƒå°‘ã€‚<br><strong>ç‰¹åˆ«æ³¨æ„ï¼šå­—ç¬¦é•¿åº¦ä¸ç­‰äº Token æ•°é‡</strong>ã€‚</p><h4 id="ä¸¾ä¾‹2ï¼šä½¿ç”¨CharacterTextSplitter"><a href="#ä¸¾ä¾‹2ï¼šä½¿ç”¨CharacterTextSplitter" class="headerlink" title="ä¸¾ä¾‹2ï¼šä½¿ç”¨CharacterTextSplitter"></a>ä¸¾ä¾‹2ï¼šä½¿ç”¨CharacterTextSplitter</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line"><span class="keyword">import</span> tiktoken  <span class="comment"># ç”¨äºè®¡ç®—Tokenæ•°é‡  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰é€šè¿‡Tokenåˆ‡å‰²å™¨  </span></span><br><span class="line">text_splitter = CharacterTextSplitter.from_tiktoken_encoder(  </span><br><span class="line">    encoding_name=<span class="string">&quot;cl100k_base&quot;</span>, <span class="comment"># ä½¿ç”¨ OpenAI çš„ç¼–ç å™¨  </span></span><br><span class="line">    chunk_size=<span class="number">18</span>, <span class="comment">#è®¾ç½®æœ€å¤§çš„tokenæ•°  </span></span><br><span class="line">    chunk_overlap=<span class="number">0</span>,  </span><br><span class="line">    separator=<span class="string">&quot;ã€‚&quot;</span>,  <span class="comment"># æŒ‡å®šä¸­æ–‡å¥å·ä¸ºåˆ†éš”ç¬¦  </span></span><br><span class="line">    keep_separator=<span class="literal">False</span>,  <span class="comment"># chunkä¸­æ˜¯å¦ä¿ç•™åˆ†éš”ç¬¦  </span></span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰æ–‡æœ¬  </span></span><br><span class="line">text = <span class="string">&quot;äººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼€å‘æ¡†æ¶ã€‚å®ƒæ”¯æŒå¤šç§è¯­è¨€æ¨¡å‹å’Œå·¥å…·é“¾ã€‚ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œæƒ³å‡ºå»è¸é’ã€‚ä½†æ˜¯åˆæ¯”è¾ƒæ‡’ä¸æƒ³å‡ºå»ï¼Œæ€ä¹ˆåŠ&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å¼€å§‹åˆ‡å‰²  </span></span><br><span class="line">texts = text_splitter.split_text(text)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åˆ†å‰²åçš„å—æ•°: <span class="subst">&#123;<span class="built_in">len</span>(texts)&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.åˆå§‹åŒ–tiktokenç¼–ç å™¨ï¼ˆç”¨äºTokenè®¡æ•°ï¼‰  </span></span><br><span class="line">encoder = tiktoken.get_encoding(<span class="string">&quot;cl100k_base&quot;</span>)  <span class="comment"># ç¡®ä¿ä¸CharacterTextSplitterçš„encoding_nameä¸€è‡´  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.æ‰“å°æ¯ä¸ªå—çš„Tokenæ•°å’Œå†…å®¹  </span></span><br><span class="line"><span class="keyword">for</span> i, chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(texts):  </span><br><span class="line">    tokens = encoder.encode(chunk)  <span class="comment"># ç°åœ¨encoderå·²å®šä¹‰  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å— <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>: <span class="subst">&#123;<span class="built_in">len</span>(tokens)&#125;</span> Token\nå†…å®¹: <span class="subst">&#123;chunk&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">åˆ†å‰²åçš„å—æ•°: 4</span><br><span class="line">å— 1: 17 Token</span><br><span class="line">å†…å®¹: äººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼€å‘æ¡†æ¶</span><br><span class="line"></span><br><span class="line">å— 2: 14 Token</span><br><span class="line">å†…å®¹: å®ƒæ”¯æŒå¤šç§è¯­è¨€æ¨¡å‹å’Œå·¥å…·é“¾</span><br><span class="line"></span><br><span class="line">å— 3: 18 Token</span><br><span class="line">å†…å®¹: ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œæƒ³å‡ºå»è¸é’</span><br><span class="line"></span><br><span class="line">å— 4: 21 Token</span><br><span class="line">å†…å®¹: ä½†æ˜¯åˆæ¯”è¾ƒæ‡’ä¸æƒ³å‡ºå»ï¼Œæ€ä¹ˆåŠ</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="SemanticChunkerï¼šè¯­ä¹‰åˆ†å—"><a href="#SemanticChunkerï¼šè¯­ä¹‰åˆ†å—" class="headerlink" title="SemanticChunkerï¼šè¯­ä¹‰åˆ†å—"></a>SemanticChunkerï¼šè¯­ä¹‰åˆ†å—</h3><p>SemanticChunkingï¼ˆè¯­ä¹‰åˆ†å—ï¼‰æ˜¯ LangChain ä¸­ä¸€ç§æ›´é«˜çº§çš„æ–‡æœ¬åˆ†å‰²æ–¹æ³•ï¼Œå®ƒè¶…è¶Šäº†ä¼ ç»Ÿçš„åŸºäºå­— ç¬¦æˆ–å›ºå®šå¤§å°çš„åˆ†å—æ–¹å¼ï¼Œè€Œæ˜¯æ ¹æ®<strong>æ–‡æœ¬çš„è¯­ä¹‰ç»“æ„</strong>è¿›è¡Œæ™ºèƒ½åˆ†å—ï¼Œä½¿æ¯ä¸ªåˆ†å—ä¿æŒ<strong>è¯­ä¹‰å®Œæ•´æ€§</strong>ï¼Œä»è€Œ æé«˜æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)ç­‰åº”ç”¨çš„æ•ˆæœã€‚</p><p><strong>è¯­ä¹‰åˆ†å‰² vs ä¼ ç»Ÿåˆ†å‰²</strong></p><table><thead><tr><th>ç‰¹æ€§</th><th>è¯­ä¹‰åˆ†å‰²ï¼ˆSemanticChunkerï¼‰</th><th>ä¼ ç»Ÿå­—ç¬¦åˆ†å‰²ï¼ˆRecursiveCharacterï¼‰</th></tr></thead><tbody><tr><td>åˆ†å‰²ä¾æ®</td><td>åµŒå…¥å‘é‡ç›¸ä¼¼åº¦</td><td>å›ºå®šå­—ç¬¦&#x2F;æ¢è¡Œç¬¦</td></tr><tr><td>è¯­ä¹‰å®Œæ•´æ€§</td><td>âœ… ä¿æŒä¸»é¢˜è¿è´¯</td><td>âŒ å¯èƒ½åˆ‡æ–­å¥å­é€»è¾‘</td></tr><tr><td>è®¡ç®—æˆæœ¬</td><td>âŒ é«˜ï¼ˆéœ€åµŒå…¥æ¨¡å‹ï¼‰</td><td>âœ… ä½</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>éœ€è¦é«˜è¯­ä¹‰ä¸€è‡´æ€§çš„ä»»åŠ¡</td><td>ç®€å•æ–‡æœ¬é¢„å¤„ç†</td></tr></tbody></table><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_experimental.text_splitter <span class="keyword">import</span> SemanticChunker  </span><br><span class="line"><span class="keyword">from</span> langchain_openai.embeddings <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åŠ è½½æ–‡æœ¬  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;asset/load/09-ai1.txt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    state_of_the_union = f.read()  <span class="comment">#è¿”å›å­—ç¬¦ä¸²  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = <span class="string">&quot;sk-jdwjsxnkyahrzybuiorfenmjmvaakupdxxxxxxxxx&quot;</span>  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = <span class="string">&quot;https://api.siliconflow.cn/v1&quot;</span>  </span><br><span class="line">embed_model = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–åˆ‡å‰²å™¨  </span></span><br><span class="line">text_splitter = SemanticChunker(  </span><br><span class="line">    embeddings=embed_model,  </span><br><span class="line">    breakpoint_threshold_type=<span class="string">&quot;percentile&quot;</span>,<span class="comment">#æ–­ç‚¹é˜ˆå€¼ç±»å‹ï¼šå­—é¢å€¼[&quot;ç™¾åˆ†ä½æ•°&quot;, &quot;æ ‡å‡†å·®&quot;, &quot;å››åˆ†ä½è·&quot;, &quot;æ¢¯åº¦&quot;] é€‰å…¶ä¸€  </span></span><br><span class="line">    breakpoint_threshold_amount=<span class="number">65.0</span> <span class="comment">#æ–­ç‚¹é˜ˆå€¼æ•°é‡ (æä½é˜ˆå€¼ â†’ é«˜åˆ†å‰²æ•æ„Ÿåº¦)  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ‡åˆ†æ–‡æ¡£  </span></span><br><span class="line">docs = text_splitter.create_documents(texts = [state_of_the_union])  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ” æ–‡æ¡£ <span class="subst">&#123;doc&#125;</span>:&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">ğŸ” æ–‡æ¡£ page_content=<span class="string">&#x27;äººå·¥æ™ºèƒ½ç»¼è¿°ï¼šå‘å±•ã€åº”ç”¨ä¸æœªæ¥å±•æœ›</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ‘˜è¦</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½ï¼ˆArtificial Intelligenceï¼ŒAIï¼‰ä½œä¸ºè®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œè¿‘å¹´æ¥å–å¾—äº†çªé£çŒ›è¿›çš„å‘å±•ã€‚æœ¬æ–‡ç»¼è¿°äº†äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹ã€æ ¸å¿ƒæŠ€æœ¯ã€åº”ç”¨é¢†åŸŸä»¥åŠæœªæ¥å‘å±•è¶‹åŠ¿ã€‚é€šè¿‡å¯¹äººå·¥æ™ºèƒ½çš„å®šä¹‰ã€å†å²èƒŒæ™¯ã€ä¸»è¦æŠ€æœ¯ï¼ˆå¦‚æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ï¼‰çš„è¯¦ç»†ä»‹ç»ï¼Œæ¢è®¨äº†äººå·¥æ™ºèƒ½åœ¨åŒ»ç–—ã€é‡‘èã€æ•™è‚²ã€äº¤é€šç­‰é¢†åŸŸçš„åº”ç”¨ï¼Œå¹¶åˆ†æäº†äººå·¥æ™ºèƒ½å‘å±•è¿‡ç¨‹ä¸­é¢ä¸´çš„æŒ‘æˆ˜ä¸æœºé‡ã€‚æœ€åï¼Œæœ¬æ–‡å¯¹äººå·¥æ™ºèƒ½çš„æœªæ¥å‘å±•è¿›è¡Œäº†å±•æœ›ï¼Œæå‡ºäº†å¯èƒ½çš„çªç ´æ–¹å‘ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1.&#x27;</span>:</span><br><span class="line">ğŸ” æ–‡æ¡£ page_content=<span class="string">&#x27;å¼•è¨€</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç¨‹åºæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„ä¸€é—¨ç§‘å­¦ã€‚è‡ª20ä¸–çºª50å¹´ä»£è¯ç”Ÿä»¥æ¥ï¼Œäººå·¥æ™ºèƒ½ç»å†äº†å¤šæ¬¡èµ·ä¼ï¼Œè¿‘å¹´æ¥éšç€è®¡ç®—èƒ½åŠ›çš„æå‡å’Œå¤§æ•°æ®çš„æ™®åŠï¼Œäººå·¥æ™ºèƒ½æŠ€æœ¯å–å¾—äº†æ˜¾è‘—çš„è¿›å±•ã€‚äººå·¥æ™ºèƒ½çš„åº”ç”¨å·²ç»æ¸—é€åˆ°æ—¥å¸¸ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ï¼Œä»æ™ºèƒ½æ‰‹æœºçš„è¯­éŸ³åŠ©æ‰‹åˆ°è‡ªåŠ¨é©¾é©¶æ±½è½¦ï¼Œä»åŒ»ç–—è¯Šæ–­åˆ°é‡‘èåˆ†æï¼Œäººå·¥æ™ºèƒ½æ­£åœ¨æ”¹å˜ç€äººç±»ç¤¾ä¼šçš„è¿è¡Œæ–¹å¼ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹</span></span><br><span class="line"><span class="string">2.1 æ—©æœŸå‘å±•</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½çš„æ¦‚å¿µæœ€æ—©å¯ä»¥è¿½æº¯åˆ°20ä¸–çºª50å¹´ä»£ã€‚1956å¹´ï¼Œè¾¾ç‰¹èŒ…æ–¯ä¼šè®®ï¼ˆDartmouth Conferenceï¼‰è¢«è®¤ä¸ºæ˜¯äººå·¥æ™ºèƒ½ç ”ç©¶çš„æ­£å¼å¼€ç«¯ã€‚åœ¨éšåçš„å‡ åå¹´é‡Œï¼Œäººå·¥æ™ºèƒ½ç ”ç©¶ç»å†äº†å¤šæ¬¡é«˜æ½®ä¸ä½è°·ã€‚æ—©æœŸçš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨ç¬¦å·é€»è¾‘å’Œä¸“å®¶ç³»ç»Ÿä¸Šï¼Œä½†ç”±äºè®¡ç®—èƒ½åŠ›çš„é™åˆ¶å’Œç®—æ³•çš„ä¸è¶³ï¼Œè¿›å±•ç¼“æ…¢ã€‚</span></span><br><span class="line"><span class="string">2.2 æœºå™¨å­¦ä¹ çš„å…´èµ·</span></span><br><span class="line"><span class="string">20ä¸–çºª90å¹´ä»£ï¼Œéšç€ç»Ÿè®¡å­¦ä¹ æ–¹æ³•çš„å¼•å…¥ï¼Œæœºå™¨å­¦ä¹ é€æ¸æˆä¸ºäººå·¥æ™ºèƒ½ç ”ç©¶çš„ä¸»æµã€‚æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ç­‰ç®—æ³•åœ¨åˆ†ç±»å’Œå›å½’ä»»åŠ¡ä¸­å–å¾—äº†è‰¯å¥½çš„æ•ˆæœã€‚è¿™ä¸€æ—¶æœŸï¼Œæœºå™¨å­¦ä¹ å¼€å§‹åº”ç”¨äºæ•°æ®æŒ–æ˜ã€æ¨¡å¼è¯†åˆ«ç­‰é¢†åŸŸã€‚</span></span><br><span class="line"><span class="string">2.3 æ·±åº¦å­¦ä¹ çš„çªç ´</span></span><br><span class="line"><span class="string">2012å¹´ï¼Œæ·±åº¦å­¦ä¹ åœ¨å›¾åƒè¯†åˆ«é¢†åŸŸå–å¾—äº†çªç ´æ€§è¿›å±•ï¼Œæ ‡å¿—ç€äººå·¥æ™ºèƒ½è¿›å…¥äº†ä¸€ä¸ªæ–°çš„é˜¶æ®µã€‚æ·±åº¦å­¦ä¹ é€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ¨¡æ‹Ÿäººè„‘çš„å·¥ä½œæ–¹å¼ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æå–ç‰¹å¾å¹¶è¿›è¡Œå¤æ‚çš„æ¨¡å¼è¯†åˆ«ã€‚å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ã€å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰å’Œé•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰ç­‰æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨å›¾åƒå¤„ç†ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—æˆæœã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3.&#x27;</span>:</span><br><span class="line">ğŸ” æ–‡æ¡£ page_content=<span class="string">&#x27;äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯</span></span><br><span class="line"><span class="string">3.1 æœºå™¨å­¦ä¹ </span></span><br><span class="line"><span class="string">æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼Œé€šè¿‡ç®—æ³•ä½¿è®¡ç®—æœºä»æ•°æ®ä¸­å­¦ä¹ å¹¶åšå‡ºå†³ç­–ã€‚å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•åŒ…æ‹¬ç›‘ç£å­¦ä¹ ã€æ— ç›‘ç£å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ã€‚ç›‘ç£å­¦ä¹ é€šè¿‡æ ‡è®°æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œæ— ç›‘ç£å­¦ä¹ åˆ™ä»æœªæ ‡è®°æ•°æ®ä¸­å¯»æ‰¾æ¨¡å¼ï¼Œå¼ºåŒ–å­¦ä¹ åˆ™é€šè¿‡ä¸ç¯å¢ƒäº¤äº’æ¥ä¼˜åŒ–å†³ç­–ã€‚</span></span><br><span class="line"><span class="string">3.2 æ·±åº¦å­¦ä¹ </span></span><br><span class="line"><span class="string">æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é¢†åŸŸï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œè¿›è¡Œç‰¹å¾æå–å’Œæ¨¡å¼è¯†åˆ«ã€‚æ·±åº¦å­¦ä¹ åœ¨å›¾åƒè¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—æˆæœã€‚å¸¸è§çš„æ·±åº¦å­¦ä¹ æ¨¡å‹åŒ…æ‹¬å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ã€å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰å’Œé•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰ã€‚</span></span><br><span class="line"><span class="string">3.3 è‡ªç„¶è¯­è¨€å¤„ç†</span></span><br><span class="line"><span class="string">è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œè‡´åŠ›äºä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€ã€‚NLPæŠ€æœ¯å¹¿æ³›åº”ç”¨äºæœºå™¨ç¿»è¯‘ã€æƒ…æ„Ÿåˆ†æã€æ–‡æœ¬åˆ†ç±»ç­‰é¢†åŸŸã€‚è¿‘å¹´æ¥ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ çš„NLPæ¨¡å‹ï¼ˆå¦‚BERTã€GPTï¼‰åœ¨è¯­è¨€ç†è§£ä»»åŠ¡ä¸­å–å¾—äº†çªç ´æ€§è¿›å±•ã€‚</span></span><br><span class="line"><span class="string">3.4 è®¡ç®—æœºè§†è§‰</span></span><br><span class="line"><span class="string">è®¡ç®—æœºè§†è§‰æ˜¯äººå·¥æ™ºèƒ½çš„å¦ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œè‡´åŠ›äºä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£å’Œå¤„ç†å›¾åƒå’Œè§†é¢‘ã€‚è®¡ç®—æœºè§†è§‰æŠ€æœ¯å¹¿æ³›åº”ç”¨äºå›¾åƒè¯†åˆ«ã€ç›®æ ‡æ£€æµ‹ã€äººè„¸è¯†åˆ«ç­‰é¢†åŸŸã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚CNNï¼‰åœ¨è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­å–å¾—äº†æ˜¾è‘—æˆæœã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. äººå·¥æ™ºèƒ½çš„åº”ç”¨é¢†åŸŸ</span></span><br><span class="line"><span class="string">4.1 åŒ»ç–—å¥åº·</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨åŒ»ç–—å¥åº·é¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬ç–¾ç—…è¯Šæ–­ã€è¯ç‰©ç ”å‘ã€ä¸ªæ€§åŒ–åŒ»ç–—ç­‰ã€‚é€šè¿‡åˆ†æåŒ»å­¦å½±åƒå’Œæ‚£è€…æ•°æ®ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©åŒ»ç”Ÿæ›´å‡†ç¡®åœ°è¯Šæ–­ç–¾ç—…ï¼Œæé«˜æ²»ç–—æ•ˆæœã€‚</span></span><br><span class="line"><span class="string">4.2 é‡‘è</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨é‡‘èé¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬é£é™©è¯„ä¼°ã€æ¬ºè¯ˆæ£€æµ‹ã€ç®—æ³•äº¤æ˜“ç­‰ã€‚é€šè¿‡åˆ†æå¸‚åœºæ•°æ®å’Œäº¤æ˜“è®°å½•ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©é‡‘èæœºæ„åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ï¼Œæé«˜è¿è¥æ•ˆç‡ã€‚</span></span><br><span class="line"><span class="string">4.3 æ•™è‚²</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨æ•™è‚²é¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬ä¸ªæ€§åŒ–å­¦ä¹ ã€æ™ºèƒ½è¾…å¯¼ã€è‡ªåŠ¨è¯„åˆ†ç­‰ã€‚é€šè¿‡åˆ†æå­¦ç”Ÿçš„å­¦ä¹ æ•°æ®ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥ä¸ºå­¦ç”Ÿæä¾›ä¸ªæ€§åŒ–çš„å­¦ä¹ å»ºè®®ï¼Œæé«˜å­¦ä¹ æ•ˆæœã€‚</span></span><br><span class="line"><span class="string">4.4 äº¤é€š</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨äº¤é€šé¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€äº¤é€šç®¡ç†ã€æ™ºèƒ½å¯¼èˆªç­‰ã€‚é€šè¿‡åˆ†æäº¤é€šæ•°æ®å’Œè·¯å†µä¿¡æ¯ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©ä¼˜åŒ–äº¤é€šæµé‡ï¼Œæé«˜äº¤é€šå®‰å…¨ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5. äººå·¥æ™ºèƒ½çš„æŒ‘æˆ˜ä¸æœºé‡</span></span><br><span class="line"><span class="string">5.1 æŒ‘æˆ˜</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½å‘å±•è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜åŒ…æ‹¬æ•°æ®éšç§ã€ç®—æ³•åè§ã€å®‰å…¨æ€§é—®é¢˜ç­‰ã€‚æ•°æ®éšç§é—®é¢˜æ¶‰åŠåˆ°ä¸ªäººæ•°æ®çš„æ”¶é›†å’Œä½¿ç”¨ï¼Œç®—æ³•åè§é—®é¢˜åˆ™æ¶‰åŠåˆ°ç®—æ³•çš„å…¬å¹³æ€§å’Œé€æ˜åº¦ï¼Œå®‰å…¨æ€§é—®é¢˜åˆ™æ¶‰åŠåˆ°äººå·¥æ™ºèƒ½ç³»ç»Ÿçš„å¯é æ€§å’Œç¨³å®šæ€§ã€‚</span></span><br><span class="line"><span class="string">5.2 æœºé‡</span></span><br><span class="line"><span class="string">å°½ç®¡é¢ä¸´æŒ‘æˆ˜ï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•ä¹Ÿå¸¦æ¥äº†å·¨å¤§çš„æœºé‡ã€‚äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è¿›æ­¥å°†æ¨åŠ¨å„è¡Œå„ä¸šçš„åˆ›æ–°ï¼Œæé«˜ç”Ÿäº§æ•ˆç‡ï¼Œæ”¹å–„ç”Ÿæ´»è´¨é‡ã€‚æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå–å¾—çªç ´ï¼Œä¸ºäººç±»ç¤¾ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©å’Œç¦ç¥‰ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6.&#x27;</span>:</span><br><span class="line">ğŸ” æ–‡æ¡£ page_content=<span class="string">&#x27;æœªæ¥å±•æœ›</span></span><br><span class="line"><span class="string">6.1 æŠ€æœ¯çªç ´</span></span><br><span class="line"><span class="string">æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æŠ€æœ¯æœ‰æœ›åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å–å¾—çªç ´ï¼šä¸€æ˜¯ç®—æ³•çš„ä¼˜åŒ–å’Œåˆ›æ–°ï¼Œæé«˜æ¨¡å‹çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ï¼›äºŒæ˜¯è®¡ç®—èƒ½åŠ›çš„æå‡ï¼Œæ”¯æŒæ›´å¤æ‚çš„æ¨¡å‹å’Œæ›´å¤§è§„æ¨¡çš„æ•°æ®å¤„ç†ï¼›ä¸‰æ˜¯è·¨å­¦ç§‘ç ”ç©¶çš„æ·±å…¥ï¼Œæ¨åŠ¨äººå·¥æ™ºèƒ½ä¸å…¶ä»–é¢†åŸŸçš„èåˆã€‚</span></span><br><span class="line"><span class="string">6.2 åº”ç”¨æ‹“å±•</span></span><br><span class="line"><span class="string">éšç€æŠ€æœ¯çš„è¿›æ­¥ï¼Œäººå·¥æ™ºèƒ½çš„åº”ç”¨é¢†åŸŸå°†è¿›ä¸€æ­¥æ‹“å±•ã€‚æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ï¼Œå¦‚ç¯å¢ƒä¿æŠ¤ã€èƒ½æºç®¡ç†ã€æ™ºèƒ½åˆ¶é€ ç­‰ã€‚äººå·¥æ™ºèƒ½å°†æˆä¸ºæ¨åŠ¨ç¤¾ä¼šè¿›æ­¥çš„é‡è¦åŠ›é‡ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7. ç»“è®º</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½ä½œä¸ºä¸€é—¨å¿«é€Ÿå‘å±•çš„ç§‘å­¦ï¼Œæ­£åœ¨æ”¹å˜ç€äººç±»ç¤¾ä¼šçš„è¿è¡Œæ–¹å¼ã€‚é€šè¿‡ä¸æ–­çš„æŠ€æœ¯åˆ›æ–°å’Œåº”ç”¨æ‹“å±•ï¼Œäººå·¥æ™ºèƒ½å°†ä¸ºäººç±»ç¤¾ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©å’Œç¦ç¥‰ã€‚ç„¶è€Œï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•ä¹Ÿé¢ä¸´ç€è¯¸å¤šæŒ‘æˆ˜ï¼Œéœ€è¦ç¤¾ä¼šå„ç•Œå…±åŒåŠªåŠ›ï¼Œæ¨åŠ¨äººå·¥æ™ºèƒ½çš„å¥åº·å‘å±•ã€‚&#x27;</span>:</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å…³äºå‚æ•°çš„è¯´æ˜ï¼š</strong></p><ol><li>breakpoint_threshold_type ï¼ˆæ–­ç‚¹é˜ˆå€¼ç±»å‹ï¼‰</li></ol><ul><li>ä½œç”¨ï¼šå®šä¹‰æ–‡æœ¬è¯­ä¹‰è¾¹ç•Œçš„æ£€æµ‹ç®—æ³•ï¼Œå†³å®šä½•æ—¶åˆ†å‰²æ–‡æœ¬å—ã€‚ </li><li>å¯é€‰å€¼åŠåŸç†ï¼š</li></ul><table><thead><tr><th>ç±»å‹</th><th>åŸç†è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>percentile</td><td>è®¡ç®—ç›¸é‚»å¥å­åµŒå…¥å‘é‡çš„ä½™å¼¦è·ç¦»ï¼Œå–<strong>è·ç¦»åˆ† å¸ƒçš„ç¬¬Nç™¾åˆ†ä½</strong>å€¼ä½œä¸ºé˜ˆå€¼ï¼Œé«˜äºæ­¤å€¼åˆ™åˆ†å‰²</td><td>å¸¸è§„æ–‡æœ¬ï¼ˆå¦‚æ–‡ ç« ã€æŠ¥å‘Šï¼‰</td></tr><tr><td>standard_deviation</td><td>ä»¥<strong>å‡å€¼ + Nå€</strong>æ ‡å‡†å·®ä¸ºé˜ˆå€¼ï¼Œè¯†åˆ«è¯­ä¹‰çªå˜ ç‚¹</td><td>è¯­ä¹‰å˜åŒ–å‰§çƒˆçš„ æ–‡æ¡£ï¼ˆå¦‚æŠ€æœ¯æ‰‹ å†Œï¼‰</td></tr><tr><td>interquartile</td><td>ç”¨<strong>å››åˆ†ä½è·ï¼ˆIQRï¼‰</strong> å®šä¹‰å¼‚å¸¸å€¼è¾¹ç•Œï¼Œè¶…è¿‡åˆ™ åˆ†å‰²</td><td>é•¿æ–‡æ¡£ï¼ˆå¦‚ä¹¦ ç±ï¼‰</td></tr><tr><td>gradient</td><td>åŸºäº<strong>åµŒå…¥å‘é‡å˜åŒ–çš„æ¢¯åº¦</strong>æ£€æµ‹åˆ†å‰²ç‚¹ï¼ˆéœ€è‡ªå®š ä¹‰å®ç°ï¼‰</td><td>å®éªŒæ€§éœ€æ±‚</td></tr></tbody></table><ol start="2"><li>breakpoint_threshold_amount ï¼ˆæ–­ç‚¹é˜ˆå€¼é‡ï¼‰</li></ol><ul><li>ä½œç”¨ï¼šæ§åˆ¶åˆ†å‰²çš„<strong>ç²’åº¦æ•æ„Ÿåº¦</strong>ï¼Œå€¼è¶Šå°åˆ†å‰²è¶Šç»†ï¼ˆå—è¶Šå¤šï¼‰ï¼Œå€¼è¶Šå¤§åˆ†å‰²è¶Šç²—ï¼ˆå—è¶Šå°‘ï¼‰ã€‚ å–å€¼èŒƒå›´ä¸ç¤ºä¾‹ï¼š<ul><li><strong>percentile</strong> æ¨¡å¼ï¼š0.0~100.0ï¼Œç”¨æˆ·ä»£ç è®¾ 65.0 è¡¨ç¤ºä»…å½“ä½™å¼¦è·ç¦» &gt; æ‰€æœ‰è·ç¦»ä¸­æœ€ä½çš„ 65.0%å€¼æ—¶åˆ†å‰² ã€‚é»˜è®¤å€¼æ˜¯ï¼š95.0ï¼Œå…¼é¡¾è¯­ä¹‰å®Œæ•´æ€§ä¸æ£€ç´¢æ•ˆç‡ã€‚å€¼è¿‡å°ï¼ˆæ¯”å¦‚0.1ï¼‰ï¼Œä¼šäº§ ç”Ÿå¤§é‡å°æ–‡æœ¬å—ï¼Œè¿‡åº¦åˆ†å‰²å¯èƒ½å¯¼è‡´ä¸Šä¸‹æ–‡æ–­è£‚ã€‚ </li><li><strong>standard_deviation</strong> æ¨¡å¼ï¼šæµ®ç‚¹æ•°ï¼ˆå¦‚  1.5 è¡¨ç¤ºå‡å€¼+1.5å€æ ‡å‡†å·®ï¼‰ã€‚ </li><li><strong>interquartile</strong> æ¨¡å¼ï¼šå€æ•°ï¼ˆå¦‚1.5 æ˜¯IQRæ ‡å‡†å€¼ï¼‰ã€‚</li></ul></li></ul><h3 id="å…¶å®ƒæ‹†åˆ†å™¨"><a href="#å…¶å®ƒæ‹†åˆ†å™¨" class="headerlink" title="å…¶å®ƒæ‹†åˆ†å™¨"></a>å…¶å®ƒæ‹†åˆ†å™¨</h3><h4 id="ç±»å‹1ï¼šHTMLHeaderTextSplitterï¼šSplit-by-HTML-header"><a href="#ç±»å‹1ï¼šHTMLHeaderTextSplitterï¼šSplit-by-HTML-header" class="headerlink" title="ç±»å‹1ï¼šHTMLHeaderTextSplitterï¼šSplit by HTML header"></a>ç±»å‹1ï¼šHTMLHeaderTextSplitterï¼šSplit by HTML header</h4><p>HTMLHeaderTextSplitteræ˜¯ä¸€ç§ä¸“é—¨ç”¨äºå¤„ç†HTMLæ–‡æ¡£çš„æ–‡æœ¬åˆ†å‰²æ–¹æ³•ï¼Œå®ƒæ ¹æ®HTMLçš„<strong>æ ‡é¢˜æ ‡ç­¾ï¼ˆå¦‚&lt;h1&gt;,&lt;h2&gt;ç­‰ï¼‰</strong>  å°†æ–‡æ¡£åˆ’åˆ†ä¸ºé€»è¾‘åˆ†å—ï¼ŒåŒæ—¶ä¿ç•™æ ‡é¢˜çš„å±‚çº§ç»“æ„ä¿¡æ¯ã€‚<br>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ– </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> HTMLHeaderTextSplitter </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å®šä¹‰HTMLæ–‡ä»¶ </span></span><br><span class="line">html_string = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ¬¡å¤„æ˜¯htmlæ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 4.ç”¨äºæŒ‡å®šè¦æ ¹æ®å“ªäº›HTMLæ ‡ç­¾æ¥åˆ†å‰²æ–‡æœ¬ </span></span><br><span class="line">headers_to_split_on = [ </span><br><span class="line">(  <span class="string">&quot;h1&quot;</span> , <span class="string">&quot;æ ‡é¢˜1&quot;</span> ),</span><br><span class="line">(  <span class="string">&quot;h2&quot;</span> , <span class="string">&quot;æ ‡é¢˜2&quot;</span> ), </span><br><span class="line">( <span class="string">&quot;h3&quot;</span> , <span class="string">&quot;æ ‡é¢˜3&quot;</span> ),</span><br><span class="line">] </span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.å®šä¹‰HTMLHeaderTextSplitteråˆ†å‰²å™¨ </span></span><br><span class="line">html_splitter = HTMLHeaderTextSplitter(headers_to_split_on=headers_to_split_on) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.åˆ†å‰²å™¨åˆ†å‰² </span></span><br><span class="line">html_header_splits = html_splitter.split_text(html_string) </span><br><span class="line">html_header_splits</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š </p><ul><li>æ ‡é¢˜ä¸‹æ–‡æœ¬å†…å®¹æ‰€å±æ ‡é¢˜çš„å±‚çº§ä¿¡æ¯ä¿å­˜åœ¨å…ƒæ•°æ®ä¸­ã€‚ </li><li>æ¯ä¸ªåˆ†å—ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶çº§æ ‡é¢˜çš„ä¸Šä¸‹æ–‡ï¼Œé¿å…ä¿¡æ¯å‰²è£‚ã€‚</li></ul><h4 id="ç±»å‹2ï¼šCodeTextSplitterï¼šSplit-code"><a href="#ç±»å‹2ï¼šCodeTextSplitterï¼šSplit-code" class="headerlink" title="ç±»å‹2ï¼šCodeTextSplitterï¼šSplit code"></a>ç±»å‹2ï¼šCodeTextSplitterï¼šSplit code</h4><p>CodeTextSplitteræ˜¯ä¸€ä¸ª ä¸“ä¸ºä»£ç æ–‡ä»¶è®¾è®¡çš„æ–‡æœ¬åˆ†å‰²å™¨ï¼ˆText Splitterï¼‰ï¼Œæ”¯æŒä»£ç çš„è¯­è¨€åŒ…æ‹¬[â€˜cppâ€™, â€˜goâ€™, â€˜javaâ€™, â€˜jsâ€™, â€˜phpâ€™, â€˜protoâ€™, â€˜pythonâ€™, â€˜rstâ€™, â€˜rubyâ€™, â€˜rustâ€™, â€˜scalaâ€™, â€˜swiftâ€™, â€˜markdownâ€™, â€˜latexâ€™, â€˜htmlâ€™, â€˜solâ€™]ã€‚å®ƒèƒ½å¤Ÿæ ¹æ®ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ç»“æ„ï¼ˆå¦‚å‡½æ•°ã€ç±»ã€ä»£ç å—ç­‰ï¼‰æ™ºèƒ½åœ°æ‹†åˆ†ä»£ç ï¼Œä¿æŒä»£ç é€»è¾‘çš„å®Œ æ•´æ€§ã€‚</p><p>ä¸é€’å½’æ–‡æœ¬åˆ†å‰²å™¨ï¼ˆå¦‚RecursiveCharacterTextSplitterï¼‰ä¸åŒï¼ŒCodeTextSplitter é’ˆå¯¹ä»£ç çš„ç‰¹æ€§è¿› è¡Œäº†ä¼˜åŒ–ï¼Œ <strong>é¿å…åœ¨å‡½æ•°æˆ–ç±»çš„ä¸­é—´æˆªæ–­</strong>ã€‚</p><p>ä¸¾ä¾‹1ï¼šæ”¯æŒçš„è¯­è¨€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain-text-splitters</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="string">&#x27;</span></span><br><span class="line"><span class="string">import Language </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># æ”¯æŒåˆ†å‰²è¯­è¨€ç±»å‹ </span></span><br><span class="line"><span class="string"># Full list of supported languages &#x27;</span></span><br><span class="line"></span><br><span class="line">langs = [e.value <span class="keyword">for</span> e <span class="keyword">in</span> Language] </span><br><span class="line"><span class="built_in">print</span> (langs)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[cpp, go, java, kotlin, js, ts, php, proto, python, rst, ruby, rust, scala, swift, markdown, latex, html, sol, csharp, cobol, c, lua, perl, haskell, elixir, powershell]</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> (  </span><br><span class="line">    Language,  </span><br><span class="line">    RecursiveCharacterTextSplitter,  </span><br><span class="line"> )  </span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint  </span><br><span class="line"> <span class="comment"># 2.å®šä¹‰è¦åˆ†å‰²çš„pythonä»£ç ç‰‡æ®µ  </span></span><br><span class="line">PYTHON_CODE = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string"> def hello_world():    </span></span><br><span class="line"><span class="string"> print(&quot;Hello, World!&quot;) </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">def hello_world1():    </span></span><br><span class="line"><span class="string">print(&quot;Hello, World1!&quot;) &quot;&quot;&quot;</span> <span class="comment"># 3.å®šä¹‰é€’å½’å­—ç¬¦åˆ‡åˆ†å™¨  </span></span><br><span class="line">python_splitter = RecursiveCharacterTextSplitter.from_language(  </span><br><span class="line">    language=Language.PYTHON,  </span><br><span class="line">    chunk_size=<span class="number">50</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">0</span>  </span><br><span class="line"> )  </span><br><span class="line"> <span class="comment"># 4.æ–‡æ¡£åˆ‡åˆ†  </span></span><br><span class="line">python_docs = python_splitter.create_documents(texts=[PYTHON_CODE])  </span><br><span class="line">pprint(python_docs)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Document(metadata=&#123;&#125;, page_content=<span class="string">&#x27;def hello_world():\n   print(&quot;Hello, World!&quot;)&#x27;</span>),</span><br><span class="line"> Document(metadata=&#123;&#125;, page_content=<span class="string">&#x27;def hello_world1():\n   print(&quot;Hello, World1!&quot;)&#x27;</span>)]</span><br></pre></td></tr></table></figure><h4 id="ç±»å‹3ï¼šMarkdownTextSplitterï¼šmdæ•°æ®ç±»å‹"><a href="#ç±»å‹3ï¼šMarkdownTextSplitterï¼šmdæ•°æ®ç±»å‹" class="headerlink" title="ç±»å‹3ï¼šMarkdownTextSplitterï¼šmdæ•°æ®ç±»å‹"></a>ç±»å‹3ï¼šMarkdownTextSplitterï¼šmdæ•°æ®ç±»å‹</h4><p>å› ä¸ºMarkdownæ ¼å¼æœ‰ç‰¹å®šçš„è¯­æ³•ï¼Œä¸€èˆ¬æ•´ä½“å†…å®¹ç”± <strong>h1ã€h2ã€h3</strong> ç­‰å¤šçº§æ ‡é¢˜ç»„ç»‡ï¼Œæ‰€ä»¥ MarkdownHeaderTextSplitterçš„åˆ‡åˆ†ç­–ç•¥å°±æ˜¯æ ¹æ® <strong>æ ‡é¢˜æ¥åˆ†å‰²æ–‡æœ¬å†…å®¹</strong>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> MarkdownTextSplitter  </span><br><span class="line">markdown_text = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string"> # ä¸€çº§æ ‡é¢˜\n  </span></span><br><span class="line"><span class="string">è¿™æ˜¯ä¸€çº§æ ‡é¢˜ä¸‹çš„å†…å®¹\n\n  </span></span><br><span class="line"><span class="string"> ## äºŒçº§æ ‡é¢˜\n- äºŒçº§ä¸‹åˆ—è¡¨é¡¹1\n- äºŒçº§ä¸‹åˆ—è¡¨é¡¹2\n  </span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span> <span class="comment"># å…³é”®æ­¥éª¤ï¼šç›´æ¥ä¿®æ”¹å®ä¾‹å±æ€§  </span></span><br><span class="line">splitter = MarkdownTextSplitter(chunk_size=<span class="number">30</span>, chunk_overlap=<span class="number">0</span>)  </span><br><span class="line">splitter._is_separator_regex = <span class="literal">True</span>  <span class="comment">#  å¼ºåˆ¶å°†åˆ†éš”ç¬¦è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼  </span></span><br><span class="line"><span class="comment"># print(len(docs))  </span></span><br><span class="line"><span class="comment"># æ‰§è¡Œåˆ†å‰²  </span></span><br><span class="line">docs = splitter.create_documents(texts = [markdown_text])  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ” åˆ†å— <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(doc.page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 1:</span><br><span class="line"><span class="comment"># ä¸€çº§æ ‡é¢˜</span></span><br><span class="line"></span><br><span class="line">è¿™æ˜¯ä¸€çº§æ ‡é¢˜ä¸‹çš„å†…å®¹</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 2:</span><br><span class="line"><span class="comment">## äºŒçº§æ ‡é¢˜</span></span><br><span class="line">- äºŒçº§ä¸‹åˆ—è¡¨é¡¹1</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 3:</span><br><span class="line">- äºŒçº§ä¸‹åˆ—è¡¨é¡¹2</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æ–‡æ¡£åµŒå…¥æ¨¡å‹-Text-Embedding-Models"><a href="#æ–‡æ¡£åµŒå…¥æ¨¡å‹-Text-Embedding-Models" class="headerlink" title="æ–‡æ¡£åµŒå…¥æ¨¡å‹ Text Embedding Models"></a>æ–‡æ¡£åµŒå…¥æ¨¡å‹ Text Embedding Models</h1><h2 id="åµŒå…¥æ¨¡å‹æ¦‚è¿°"><a href="#åµŒå…¥æ¨¡å‹æ¦‚è¿°" class="headerlink" title="åµŒå…¥æ¨¡å‹æ¦‚è¿°"></a>åµŒå…¥æ¨¡å‹æ¦‚è¿°</h2><p><strong>Text Embedding Models</strong>ï¼šæ–‡æ¡£åµŒå…¥æ¨¡å‹ï¼Œæä¾›å°†æ–‡æœ¬ç¼–ç ä¸ºå‘é‡çš„èƒ½åŠ›ï¼Œå³<strong>æ–‡æ¡£å‘é‡åŒ–</strong> ï¼Œ<strong>æ–‡æ¡£å†™å…¥</strong>å’Œ<strong>ç”¨æˆ· æŸ¥è¯¢åŒ¹é…</strong>å‰éƒ½ä¼šå…ˆæ‰§è¡Œæ–‡æ¡£åµŒå…¥ç¼–ç ï¼Œå³å‘é‡åŒ–ã€‚<br><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250928094827404.png" alt="500"></p><p>LangChainä¸­é’ˆå¯¹å‘é‡åŒ–æ¨¡å‹çš„å°è£…æä¾›äº†ä¸¤ç§æ¥å£ï¼Œä¸€ç§é’ˆå¯¹<strong>æ–‡æ¡£çš„å‘é‡åŒ–(embed_documents)<strong>ï¼Œä¸€ ç§é’ˆå¯¹</strong>å¥å­çš„å‘é‡åŒ–embed_queryã€‚</strong></p><h2 id="å¥å­çš„å‘é‡åŒ–ï¼ˆembed-queryï¼‰"><a href="#å¥å­çš„å‘é‡åŒ–ï¼ˆembed-queryï¼‰" class="headerlink" title="å¥å­çš„å‘é‡åŒ–ï¼ˆembed_queryï¼‰"></a>å¥å­çš„å‘é‡åŒ–ï¼ˆembed_queryï¼‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">embedding_model = OpenAIEmbeddings(  </span><br><span class="line">    <span class="comment"># model=&quot;text-embedding-ada-002&quot;  </span></span><br><span class="line">    model = <span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">text = <span class="string">&quot;Nice to meet you!&quot;</span>  </span><br><span class="line">  </span><br><span class="line">embed_query = embedding_model.embed_query(text = text,)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(embed_query))  <span class="comment"># 1536 --&gt; 3072  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(embed_query[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1024</span><br><span class="line">[-0.014332670718431473, -0.02295164205133915, -0.01733478531241417, -0.006827387027442455, 0.04202958941459656, -0.028665341436862946, -0.023823224008083344, -0.031376928091049194, -0.09374341368675232, 0.08986972272396088]</span><br></pre></td></tr></table></figure><h2 id="æ–‡æ¡£çš„å‘é‡åŒ–ï¼ˆembed-documentsï¼‰"><a href="#æ–‡æ¡£çš„å‘é‡åŒ–ï¼ˆembed-documentsï¼‰" class="headerlink" title="æ–‡æ¡£çš„å‘é‡åŒ–ï¼ˆembed_documentsï¼‰"></a>æ–‡æ¡£çš„å‘é‡åŒ–ï¼ˆembed_documentsï¼‰</h2><p>æ–‡æ¡£çš„å‘é‡åŒ–ï¼Œæ¥æ”¶çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²æ•°ç»„ã€‚</p><h3 id="ä¸¾ä¾‹1"><a href="#ä¸¾ä¾‹1" class="headerlink" title="ä¸¾ä¾‹1"></a>ä¸¾ä¾‹1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embeddings_model = OpenAIEmbeddings(model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¾…åµŒå…¥çš„æ–‡æœ¬åˆ—è¡¨  </span></span><br><span class="line">texts = [  </span><br><span class="line">    <span class="string">&quot;Hi there!&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;Oh, hello!&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;What&#x27;s your name?&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;My friends call me World&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;Hello World!&quot;</span>  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç”ŸæˆåµŒå…¥å‘é‡  </span></span><br><span class="line">embeddings = embeddings_model.embed_documents(texts)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(texts)):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;texts[i]&#125;</span>:<span class="subst">&#123;embeddings[i][:<span class="number">3</span>]&#125;</span>&quot;</span>,end=<span class="string">&quot;\n\n&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Hi there!:[-0.005018789321184158, -0.02362913265824318, -0.015080382116138935]</span><br><span class="line"></span><br><span class="line">Oh, hello!:[-0.016794802621006966, 0.0015314100310206413, -0.013306026346981525]</span><br><span class="line"></span><br><span class="line">What<span class="string">&#x27;s your name?:[-0.0057384539395570755, -0.011427008546888828, -0.018862050026655197]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">My friends call me World:[0.01912776567041874, 0.0315045565366745, -0.013761605136096478]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hello World!:[0.0033330952282994986, 0.017623262479901314, -0.011646676808595657]</span></span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2"><a href="#ä¸¾ä¾‹2" class="headerlink" title="ä¸¾ä¾‹2"></a>ä¸¾ä¾‹2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> CSVLoader  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">embeddings_model = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æƒ…å†µ1ï¼š  </span></span><br><span class="line">loader = CSVLoader(<span class="string">&quot;./asset/load/03-load.csv&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)  </span><br><span class="line">docs = loader.load_and_split()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#print(len(docs))  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># å­˜æ”¾çš„æ˜¯æ¯ä¸€ä¸ªchrunkçš„embeddingã€‚  </span></span><br><span class="line">embeded_docs = embeddings_model.embed_documents([doc.page_content <span class="keyword">for</span> doc <span class="keyword">in</span> docs])  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(embeded_docs))  </span><br><span class="line"><span class="comment"># è¡¨ç¤ºçš„æ˜¯æ¯ä¸€ä¸ªchrunkçš„embeddingçš„ç»´åº¦  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(embeded_docs[<span class="number">0</span>]))  </span><br><span class="line"><span class="built_in">print</span>(embeded_docs[<span class="number">0</span>][:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">1024</span><br><span class="line">[0.020796308293938637, -0.06914985924959183, -0.016174905002117157, -0.02148095890879631, 0.004043726250529289, 0.018742350861430168, 0.04381773620843887, 0.07394243031740189, -0.06641125679016113, 0.03834051638841629]</span><br></pre></td></tr></table></figure><h1 id="å‘é‡å­˜å‚¨-Vector-Stores"><a href="#å‘é‡å­˜å‚¨-Vector-Stores" class="headerlink" title="å‘é‡å­˜å‚¨(Vector Stores)"></a>å‘é‡å­˜å‚¨(Vector Stores)</h1><h2 id="ç†è§£å‘é‡å­˜å‚¨"><a href="#ç†è§£å‘é‡å­˜å‚¨" class="headerlink" title="ç†è§£å‘é‡å­˜å‚¨"></a>ç†è§£å‘é‡å­˜å‚¨</h2><p>å°†æ–‡æœ¬å‘é‡åŒ–ä¹‹åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¿›è¡Œå‘é‡çš„å­˜å‚¨ã€‚è¿™éƒ¨åˆ†åŒ…å«ä¸¤å—ï¼š </p><ul><li><strong>å‘é‡çš„å­˜å‚¨</strong>ï¼šå°†éç»“æ„åŒ–æ•°æ®å‘é‡åŒ–åï¼Œå®Œæˆå­˜å‚¨ </li><li><strong>å‘é‡çš„æŸ¥è¯¢</strong>ï¼šæŸ¥è¯¢æ—¶ï¼ŒåµŒå…¥éç»“æ„åŒ–æŸ¥è¯¢å¹¶æ£€ç´¢ä¸åµŒå…¥æŸ¥è¯¢â€œæœ€ç›¸ä¼¼â€çš„åµŒå…¥å‘é‡ã€‚å³å…·æœ‰ç›¸ä¼¼æ€§ æ£€ç´¢èƒ½åŠ›</li></ul><p><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250928095510561.png" alt="500"></p><h2 id="å¸¸ç”¨çš„å‘é‡æ•°æ®åº“"><a href="#å¸¸ç”¨çš„å‘é‡æ•°æ®åº“" class="headerlink" title="å¸¸ç”¨çš„å‘é‡æ•°æ®åº“"></a>å¸¸ç”¨çš„å‘é‡æ•°æ®åº“</h2><p>LangChainæä¾›äº†è¶…è¿‡ 50ç§ ä¸åŒå‘é‡å­˜å‚¨ï¼ˆVector Storesï¼‰çš„é›†æˆï¼Œä»å¼€æºçš„ æœ¬åœ°å‘é‡å­˜å‚¨åˆ° äº‘æ‰˜ç®¡çš„ç§æœ‰å‘é‡å­˜å‚¨ï¼Œå…è®¸ä½ é€‰æ‹©æœ€é€‚åˆéœ€æ±‚çš„å‘é‡å­˜å‚¨ã€‚<br>LangChainæ”¯æŒçš„å‘é‡å­˜å‚¨å‚è€ƒ VectorStore æ¥å£å’Œå®ç°ã€‚<br><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250928095622717.png" alt="500"></p><p>å…¸å‹çš„ä»‹ç»å¦‚ä¸‹ï¼š</p><table><thead><tr><th>å‘é‡æ•°æ®åº“</th><th>æè¿°</th></tr></thead><tbody><tr><td><strong>Chroma</strong></td><td>å¼€æºã€å…è´¹çš„åµŒå…¥å¼æ•°æ®åº“</td></tr><tr><td>FAISS</td><td>Metaå‡ºå“ï¼Œå¼€æºã€å…è´¹ï¼ŒFacebook AIç›¸ä¼¼æ€§æœç´¢æœåŠ¡ã€‚ï¼ˆFacebook AI Similarity Searchï¼ŒFacebook AI ç›¸ä¼¼æ€§æœç´¢åº“ï¼‰ &#x2F;fÃ¦s&#x2F;</td></tr><tr><td>Milvus</td><td>ç”¨äºå­˜å‚¨ã€ç´¢å¼•å’Œç®¡ç†ç”±æ·±åº¦ç¥ç»ç½‘ç»œå’Œå…¶ä»–MLæ¨¡å‹äº§ç”Ÿçš„å¤§é‡åµŒå…¥å‘é‡çš„æ•°æ®åº“</td></tr><tr><td>Pinecone</td><td>å…·æœ‰å¹¿æ³›åŠŸèƒ½çš„å‘é‡æ•°æ®åº“</td></tr><tr><td>Redis</td><td>åŸºäºRedisçš„æ£€ç´¢å™¨</td></tr></tbody></table><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä½¿ç”¨å‘é‡æ•°æ®åº“ç»„ä»¶æ—¶éœ€è¦åŒæ—¶ä¼ å…¥åŒ…å«<strong>æ–‡æœ¬å—çš„Documentç±»å¯¹è±¡</strong>ä»¥åŠ<strong>æ–‡æœ¬å‘é‡åŒ–ç»„ä»¶</strong>ï¼Œå‘é‡æ•°æ®åº“ç»„ ä»¶ä¼šè‡ªåŠ¨å®Œæˆå°†æ–‡æœ¬å‘é‡åŒ–çš„å·¥ä½œï¼Œå¹¶å†™å…¥æ•°æ®åº“ä¸­ã€‚</p><h3 id="æ•°æ®çš„å­˜å‚¨"><a href="#æ•°æ®çš„å­˜å‚¨" class="headerlink" title="æ•°æ®çš„å­˜å‚¨"></a>æ•°æ®çš„å­˜å‚¨</h3><h4 id="ä¸¾ä¾‹1ï¼šä»TXTæ–‡æ¡£ä¸­åŠ è½½æ•°æ®ï¼Œå‘é‡åŒ–åå­˜å‚¨åˆ°Chromaæ•°æ®åº“"><a href="#ä¸¾ä¾‹1ï¼šä»TXTæ–‡æ¡£ä¸­åŠ è½½æ•°æ®ï¼Œå‘é‡åŒ–åå­˜å‚¨åˆ°Chromaæ•°æ®åº“" class="headerlink" title="ä¸¾ä¾‹1ï¼šä»TXTæ–‡æ¡£ä¸­åŠ è½½æ•°æ®ï¼Œå‘é‡åŒ–åå­˜å‚¨åˆ°Chromaæ•°æ®åº“"></a>ä¸¾ä¾‹1ï¼šä»TXTæ–‡æ¡£ä¸­åŠ è½½æ•°æ®ï¼Œå‘é‡åŒ–åå­˜å‚¨åˆ°Chromaæ•°æ®åº“</h4><p>å®‰è£…æ¨¡å—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install chromadb </span><br><span class="line">pip install langchain-chroma</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_chroma <span class="keyword">import</span> Chroma  </span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> TextLoader  </span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­¥éª¤1ï¼šåˆ›å»ºä¸€ä¸ªTextLoaderçš„å®ä¾‹ï¼Œå¹¶å°†æŒ‡å®šçš„æ–‡æ¡£åŠ è½½  </span></span><br><span class="line">loader = TextLoader(  </span><br><span class="line">    file_path=<span class="string">&quot;./asset/load/09-ai1.txt&quot;</span>,  </span><br><span class="line">    encoding=<span class="string">&quot;utf-8&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = loader.load()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­¥éª¤2ï¼šåˆ›å»ºæ–‡æœ¬æ‹†åˆ†å™¨ï¼Œå¹¶æ‹†åˆ†æ–‡æ¡£  </span></span><br><span class="line">text_splitter = CharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">1000</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">100</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">splitter_docs = text_splitter.split_documents(docs)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># print(len(splitter_docs))  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­¥éª¤3ï¼šåˆ›å»ºåµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embedding_model = OpenAIEmbeddings(model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­¥éª¤4ï¼šå°†æ–‡æ¡£åŠåµŒå…¥æ¨¡å‹ä¼ å…¥åˆ°Chromaç›¸å…³çš„ç»“æ„ä¸­ï¼Œè¿›è¡Œæ•°æ®çš„å­˜å‚¨  </span></span><br><span class="line">db = Chroma.from_documents(  </span><br><span class="line">    documents=splitter_docs,  </span><br><span class="line">    embedding=embedding_model,  </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>æ€è€ƒï¼šæ­¤æ—¶æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œå‘¢ï¼Ÿ</strong><br>æ³¨æ„ï¼šChromaä¸»è¦æœ‰ä¸¤ç§å­˜å‚¨æ¨¡å¼ï¼š<strong>å†…å­˜æ¨¡å¼</strong>å’Œ<strong>æŒä¹…åŒ–æ¨¡å¼</strong>ã€‚å½“ä½¿ç”¨persist_directoryå‚æ•°æ—¶ï¼Œæ•°æ® ä¼šä¿å­˜åˆ°æŒ‡å®šç›®å½•ï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™é»˜è®¤ä½¿ç”¨å†…å­˜å­˜å‚¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db1 = Chroma.from_documents(  </span><br><span class="line">    documents=splitter_docs,  </span><br><span class="line">    embedding=embedding_model,  </span><br><span class="line">    persist_directory=<span class="string">&quot;./asset/chroma-1&quot;</span>,  </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>2ã€éœ€è¦æ˜ç¡®ï¼Œåœ¨å‘é‡æ•°æ®åº“ä¸­ï¼Œä¸ä»…å­˜å‚¨äº†æ•°æ®ï¼ˆæˆ–æ–‡æ¡£ï¼‰çš„å‘é‡ï¼Œè€Œä¸”è¿˜å­˜å‚¨äº†æ•°æ®ï¼ˆæˆ–æ–‡æ¡£ï¼‰æœ¬èº«ã€‚</p><hr><p>æ¼”ç¤ºä¸€ä¸‹ï¼šæ£€ç´¢çš„éœ€æ±‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query = <span class="string">&quot;äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯æœ‰å“ªäº›å‘¢ï¼Ÿ&quot;</span>  </span><br><span class="line">  </span><br><span class="line">docs = db.similarity_search(query)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(docs[<span class="number">0</span>].page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">5. äººå·¥æ™ºèƒ½çš„æŒ‘æˆ˜ä¸æœºé‡</span><br><span class="line">5.1 æŒ‘æˆ˜</span><br><span class="line">äººå·¥æ™ºèƒ½å‘å±•è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜åŒ…æ‹¬æ•°æ®éšç§ã€ç®—æ³•åè§ã€å®‰å…¨æ€§é—®é¢˜ç­‰ã€‚æ•°æ®éšç§é—®é¢˜æ¶‰åŠåˆ°ä¸ªäººæ•°æ®çš„æ”¶é›†å’Œä½¿ç”¨ï¼Œç®—æ³•åè§é—®é¢˜åˆ™æ¶‰åŠåˆ°ç®—æ³•çš„å…¬å¹³æ€§å’Œé€æ˜åº¦ï¼Œå®‰å…¨æ€§é—®é¢˜åˆ™æ¶‰åŠåˆ°äººå·¥æ™ºèƒ½ç³»ç»Ÿçš„å¯é æ€§å’Œç¨³å®šæ€§ã€‚</span><br><span class="line">5.2 æœºé‡</span><br><span class="line">å°½ç®¡é¢ä¸´æŒ‘æˆ˜ï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•ä¹Ÿå¸¦æ¥äº†å·¨å¤§çš„æœºé‡ã€‚äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è¿›æ­¥å°†æ¨åŠ¨å„è¡Œå„ä¸šçš„åˆ›æ–°ï¼Œæé«˜ç”Ÿäº§æ•ˆç‡ï¼Œæ”¹å–„ç”Ÿæ´»è´¨é‡ã€‚æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå–å¾—çªç ´ï¼Œä¸ºäººç±»ç¤¾ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©å’Œç¦ç¥‰ã€‚</span><br><span class="line"></span><br><span class="line">6. æœªæ¥å±•æœ›</span><br><span class="line">6.1 æŠ€æœ¯çªç ´</span><br><span class="line">æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æŠ€æœ¯æœ‰æœ›åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å–å¾—çªç ´ï¼šä¸€æ˜¯ç®—æ³•çš„ä¼˜åŒ–å’Œåˆ›æ–°ï¼Œæé«˜æ¨¡å‹çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ï¼›äºŒæ˜¯è®¡ç®—èƒ½åŠ›çš„æå‡ï¼Œæ”¯æŒæ›´å¤æ‚çš„æ¨¡å‹å’Œæ›´å¤§è§„æ¨¡çš„æ•°æ®å¤„ç†ï¼›ä¸‰æ˜¯è·¨å­¦ç§‘ç ”ç©¶çš„æ·±å…¥ï¼Œæ¨åŠ¨äººå·¥æ™ºèƒ½ä¸å…¶ä»–é¢†åŸŸçš„èåˆã€‚</span><br><span class="line">6.2 åº”ç”¨æ‹“å±•</span><br><span class="line">éšç€æŠ€æœ¯çš„è¿›æ­¥ï¼Œäººå·¥æ™ºèƒ½çš„åº”ç”¨é¢†åŸŸå°†è¿›ä¸€æ­¥æ‹“å±•ã€‚æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ï¼Œå¦‚ç¯å¢ƒä¿æŠ¤ã€èƒ½æºç®¡ç†ã€æ™ºèƒ½åˆ¶é€ ç­‰ã€‚äººå·¥æ™ºèƒ½å°†æˆä¸ºæ¨åŠ¨ç¤¾ä¼šè¿›æ­¥çš„é‡è¦åŠ›é‡ã€‚</span><br><span class="line"></span><br><span class="line">7. ç»“è®º</span><br><span class="line">äººå·¥æ™ºèƒ½ä½œä¸ºä¸€é—¨å¿«é€Ÿå‘å±•çš„ç§‘å­¦ï¼Œæ­£åœ¨æ”¹å˜ç€äººç±»ç¤¾ä¼šçš„è¿è¡Œæ–¹å¼ã€‚é€šè¿‡ä¸æ–­çš„æŠ€æœ¯åˆ›æ–°å’Œåº”ç”¨æ‹“å±•ï¼Œäººå·¥æ™ºèƒ½å°†ä¸ºäººç±»ç¤¾ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©å’Œç¦ç¥‰ã€‚ç„¶è€Œï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•ä¹Ÿé¢ä¸´ç€è¯¸å¤šæŒ‘æˆ˜ï¼Œéœ€è¦ç¤¾ä¼šå„ç•Œå…±åŒåŠªåŠ›ï¼Œæ¨åŠ¨äººå·¥æ™ºèƒ½çš„å¥åº·å‘å±•ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸¾ä¾‹2ï¼šæ“ä½œcsvæ–‡æ¡£ï¼Œå¹¶å‘é‡åŒ–"><a href="#ä¸¾ä¾‹2ï¼šæ“ä½œcsvæ–‡æ¡£ï¼Œå¹¶å‘é‡åŒ–" class="headerlink" title="ä¸¾ä¾‹2ï¼šæ“ä½œcsvæ–‡æ¡£ï¼Œå¹¶å‘é‡åŒ–"></a>ä¸¾ä¾‹2ï¼šæ“ä½œcsvæ–‡æ¡£ï¼Œå¹¶å‘é‡åŒ–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> CSVLoader  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">from</span> langchain_chroma <span class="keyword">import</span> Chroma  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embeddings = OpenAIEmbeddings(model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åŠ è½½æ–‡æ¡£å¹¶æ‹†åˆ†ï¼ˆç¬¬1æ¬¡æ‹†åˆ†ï¼‰  </span></span><br><span class="line">loader = CSVLoader(<span class="string">&quot;./asset/load/03-load.csv&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)  </span><br><span class="line">pages = loader.load_and_split()  </span><br><span class="line"><span class="comment">#print(len(pages))  # 4  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–‡æœ¬æ‹†åˆ†ï¼ˆç¬¬2æ¬¡æ‹†åˆ†ï¼‰  </span></span><br><span class="line">text_spliter = CharacterTextSplitter.from_tiktoken_encoder(chunk_size=<span class="number">500</span>)  </span><br><span class="line">docs = text_spliter.split_documents(pages)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å‘é‡å­˜å‚¨  </span></span><br><span class="line">db_path = <span class="string">&#x27;./asset/chroma-2&#x27;</span>  </span><br><span class="line">db = Chroma.from_documents(docs, embeddings, persist_directory=db_path)</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®çš„æ£€ç´¢"><a href="#æ•°æ®çš„æ£€ç´¢" class="headerlink" title="æ•°æ®çš„æ£€ç´¢"></a>æ•°æ®çš„æ£€ç´¢</h3><p>ä¸¾ä¾‹ï¼šä¸€ä¸ªåŒ…å«æ„å»ºChromaå‘é‡æ•°æ®åº“ä»¥åŠå‘é‡æ£€ç´¢çš„ä»£ç <br>å‰ç½®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_chroma <span class="keyword">import</span> Chroma  </span><br><span class="line"><span class="keyword">from</span> langchain_core.documents <span class="keyword">import</span> Document  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æ–‡æ¡£  </span></span><br><span class="line">raw_documents = [  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;è‘¡è„æ˜¯ä¸€ç§å¸¸è§çš„æ°´æœï¼Œå±äºè‘¡è„ç§‘è‘¡è„å±æ¤ç‰©ã€‚å®ƒçš„æœå®å‘ˆåœ†å½¢æˆ–æ¤­åœ†å½¢ï¼Œé¢œè‰²æœ‰ç»¿è‰²ã€ç´«è‰²ã€çº¢è‰²ç­‰å¤šç§ã€‚è‘¡è„å¯Œå«ç»´ç”Ÿç´ Cå’ŒæŠ—æ°§åŒ–ç‰©è´¨ï¼Œå¯ä»¥ç›´æ¥é£Ÿç”¨æˆ–é…¿é€ æˆè‘¡è„é…’ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;æ°´æœ&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;æ¤ç‰©&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;ç™½èœæ˜¯åå­—èŠ±ç§‘è”¬èœï¼ŒåŸäº§äºä¸­å›½åŒ—æ–¹ã€‚å®ƒçš„å¶ç‰‡å±‚å±‚åŒ…è£¹å½¢æˆç´§å¯†çš„çƒçŠ¶ï¼Œå£æ„Ÿæ¸…è„†å¾®ç”œã€‚ç™½èœå¯Œå«è†³é£Ÿçº¤ç»´å’Œç»´ç”Ÿç´ Kï¼Œå¸¸ç”¨äºåˆ¶ä½œæ³¡èœã€ç‚’èœæˆ–ç…®æ±¤ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;è”¬èœ&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;æ¤ç‰©&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;åŠ¨ç‰©&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;å“ºä¹³åŠ¨ç‰©&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;çŒ«æ˜¯å°å‹è‚‰é£Ÿæ€§å“ºä¹³åŠ¨ç‰©ï¼Œæ€§æ ¼ç‹¬ç«‹ä½†ä¹Ÿèƒ½ä¸äººç±»å»ºç«‹äº²å¯†å…³ç³»ã€‚å®ƒä»¬å¤œè§†èƒ½åŠ›æå¼ºï¼Œæ“…é•¿æ•çŒè€é¼ ã€‚å®¶çŒ«çš„å“ç§åŒ…æ‹¬æ³¢æ–¯çŒ«ã€æš¹ç½—çŒ«ç­‰ï¼Œæ¯›è‰²å’ŒèŠ±çº¹å¤šæ ·ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;åŠ¨ç‰©&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;å“ºä¹³åŠ¨ç‰©&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;äººç±»æ˜¯åœ°çƒä¸Šæœ€å…·æ™ºæ…§çš„ç”Ÿç‰©ï¼Œå±äºçµé•¿ç›®äººç§‘ã€‚ç°ä»£äººç±»ï¼ˆæ™ºäººï¼‰æ‹¥æœ‰é«˜åº¦å‘è¾¾çš„å¤§è„‘ï¼Œåˆ›é€ äº†è¯­è¨€ã€å·¥å…·å’Œæ–‡æ˜ã€‚äººç±»çš„å¹³å‡å¯¿å‘½çº¦70-80å¹´ï¼Œåˆ†å¸ƒåœ¨å…¨çƒå„åœ°ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;ç”Ÿç‰©&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;çµé•¿ç±»&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;å¤ªé˜³æ˜¯å¤ªé˜³ç³»çš„ä¸­å¿ƒæ’æ˜Ÿï¼Œç›´å¾„çº¦139ä¸‡å…¬é‡Œï¼Œä¸»è¦ç”±æ°¢å’Œæ°¦ç»„æˆã€‚å®ƒé€šè¿‡æ ¸èšå˜ååº”äº§ç”Ÿèƒ½é‡ï¼Œä¸ºåœ°çƒæä¾›å…‰å’Œçƒ­ã€‚å¤ªé˜³æ´»åŠ¨å‘¨æœŸçº¦ä¸º11å¹´ï¼Œä¼šå½±å“åœ°çƒæ°”å€™ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;å¤©æ–‡&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;æ’æ˜Ÿ&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;é•¿åŸæ˜¯ä¸­å›½å¤ä»£çš„å†›äº‹é˜²å¾¡å·¥ç¨‹ï¼Œæ€»é•¿åº¦è¶…è¿‡2ä¸‡å…¬é‡Œã€‚å®ƒå§‹å»ºäºæ˜¥ç§‹æˆ˜å›½æ—¶æœŸï¼Œç§¦æœè¿æ¥å„æ®µï¼Œæ˜æœå¤§è§„æ¨¡é‡ä¿®ã€‚é•¿åŸæ˜¯ä¸–ç•Œæ–‡åŒ–é—äº§å’Œäººç±»å»ºç­‘å¥‡è¿¹ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;å†å²&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;å»ºç­‘&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;é‡å­åŠ›å­¦æ˜¯ç ”ç©¶å¾®è§‚ç²’å­è¿åŠ¨è§„å¾‹çš„ç‰©ç†å­¦åˆ†æ”¯ã€‚å®ƒæå‡ºäº†æ³¢ç²’äºŒè±¡æ€§ã€æµ‹ä¸å‡†åŸç†ç­‰æ¦‚å¿µï¼Œå½»åº•æ”¹å˜äº†äººç±»å¯¹ç‰©è´¨ä¸–ç•Œçš„è®¤çŸ¥ã€‚é‡å­è®¡ç®—æœºæ­£æ˜¯åŸºäºè¿™ä¸€ç†è®ºå‘å±•è€Œæ¥ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;ç‰©ç†&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;ç§‘å­¦&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;ã€Šçº¢æ¥¼æ¢¦ã€‹æ˜¯ä¸­å›½å¤å…¸æ–‡å­¦å››å¤§åè‘—ä¹‹ä¸€ï¼Œä½œè€…æ›¹é›ªèŠ¹ã€‚å°è¯´ä»¥è´¾ã€å²ã€ç‹ã€è–›å››å¤§å®¶æ—çš„å…´è¡°ä¸ºèƒŒæ™¯ï¼Œæç»˜äº†è´¾å®ç‰ä¸æ—é»›ç‰çš„çˆ±æƒ…æ‚²å‰§ï¼Œåæ˜ äº†å°å»ºç¤¾ä¼šçš„ç§ç§çŸ›ç›¾ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;æ–‡å­¦&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;å°è¯´&quot;</span>&#125;  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;æ–°å† ç—…æ¯’ï¼ˆSARS-CoV-2ï¼‰æ˜¯ä¸€ç§å¯å¼•èµ·å‘¼å¸é“ç–¾ç—…çš„å† çŠ¶ç—…æ¯’ã€‚å®ƒé€šè¿‡é£æ²«ä¼ æ’­ï¼Œä¸»è¦ç—‡çŠ¶åŒ…æ‹¬å‘çƒ­ã€å’³å—½ã€ä¹åŠ›ã€‚ç–«è‹—å’Œæˆ´å£ç½©æ˜¯æœ‰æ•ˆçš„é¢„é˜²æªæ–½ã€‚&quot;</span>,  </span><br><span class="line">        metadata=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;åŒ»å­¦&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;ç—…æ¯’&quot;</span>&#125;  </span><br><span class="line">    )  </span><br><span class="line">]  </span><br><span class="line"><span class="comment"># 3. åˆ›å»ºåµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embedding = OpenAIEmbeddings(model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.åˆ›å»ºå‘é‡æ•°æ®åº“  </span></span><br><span class="line">db = Chroma.from_documents(  </span><br><span class="line">    documents=raw_documents,  </span><br><span class="line">    embedding=embedding,  </span><br><span class="line">    persist_directory=<span class="string">&quot;./asset/chroma-3&quot;</span>,  </span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="â‘ -ç›¸ä¼¼æ€§æ£€ç´¢ï¼ˆsimilarity-searchï¼‰"><a href="#â‘ -ç›¸ä¼¼æ€§æ£€ç´¢ï¼ˆsimilarity-searchï¼‰" class="headerlink" title="â‘  ç›¸ä¼¼æ€§æ£€ç´¢ï¼ˆsimilarity_searchï¼‰"></a>â‘  ç›¸ä¼¼æ€§æ£€ç´¢ï¼ˆsimilarity_searchï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5. æ£€ç´¢ç¤ºä¾‹ï¼ˆè¿”å›å‰3ä¸ªæœ€ç›¸å…³ç»“æœï¼‰  </span></span><br><span class="line">query = <span class="string">&quot;å“ºä¹³åŠ¨ç‰©&quot;</span>  </span><br><span class="line">docs = db.similarity_search(query, k=<span class="number">3</span>)  <span class="comment"># k=3è¡¨ç¤ºè¿”å›3ä¸ªæœ€ç›¸å…³æ–‡æ¡£  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æŸ¥è¯¢: &#x27;<span class="subst">&#123;query&#125;</span>&#x27; çš„ç»“æœ:&quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs, <span class="number">1</span>):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœ <span class="subst">&#123;i&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å…ƒæ•°æ®: <span class="subst">&#123;doc.metadata&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥è¯¢: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span> çš„ç»“æœ:</span><br><span class="line"></span><br><span class="line">ç»“æœ 1:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">ç»“æœ 2:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">ç»“æœ 3:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="â‘¡-æ”¯æŒç›´æ¥å¯¹é—®é¢˜å‘é‡æŸ¥è¯¢ï¼ˆsimilarity-search-by-vectorï¼‰"><a href="#â‘¡-æ”¯æŒç›´æ¥å¯¹é—®é¢˜å‘é‡æŸ¥è¯¢ï¼ˆsimilarity-search-by-vectorï¼‰" class="headerlink" title="â‘¡ æ”¯æŒç›´æ¥å¯¹é—®é¢˜å‘é‡æŸ¥è¯¢ï¼ˆsimilarity_search_by_vectorï¼‰"></a>â‘¡ æ”¯æŒç›´æ¥å¯¹é—®é¢˜å‘é‡æŸ¥è¯¢ï¼ˆsimilarity_search_by_vectorï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">query = <span class="string">&quot;å“ºä¹³åŠ¨ç‰©&quot;</span>  </span><br><span class="line">embedding_vector = embedding.embed_query(query)  </span><br><span class="line">  </span><br><span class="line">docs = db.similarity_search_by_vector(embedding_vector, k=<span class="number">3</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æŸ¥è¯¢: &#x27;<span class="subst">&#123;query&#125;</span>&#x27; çš„ç»“æœ:&quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs, <span class="number">1</span>):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœ <span class="subst">&#123;i&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å…ƒæ•°æ®: <span class="subst">&#123;doc.metadata&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥è¯¢: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span> çš„ç»“æœ:</span><br><span class="line"></span><br><span class="line">ç»“æœ 1:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">ç»“æœ 2:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">ç»“æœ 3:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="â‘¢-ç›¸ä¼¼æ€§æ£€ç´¢ï¼Œæ”¯æŒè¿‡æ»¤å…ƒæ•°æ®ï¼ˆfilterï¼‰"><a href="#â‘¢-ç›¸ä¼¼æ€§æ£€ç´¢ï¼Œæ”¯æŒè¿‡æ»¤å…ƒæ•°æ®ï¼ˆfilterï¼‰" class="headerlink" title="â‘¢ ç›¸ä¼¼æ€§æ£€ç´¢ï¼Œæ”¯æŒè¿‡æ»¤å…ƒæ•°æ®ï¼ˆfilterï¼‰"></a>â‘¢ ç›¸ä¼¼æ€§æ£€ç´¢ï¼Œæ”¯æŒè¿‡æ»¤å…ƒæ•°æ®ï¼ˆfilterï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">query = <span class="string">&quot;å“ºä¹³åŠ¨ç‰©&quot;</span>  </span><br><span class="line">  </span><br><span class="line">docs = db.similarity_search(  </span><br><span class="line">    query=query,  </span><br><span class="line">    k=<span class="number">3</span>,  </span><br><span class="line">    <span class="built_in">filter</span>=&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;åŠ¨ç‰©&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs, <span class="number">1</span>):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœ <span class="subst">&#123;i&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å…ƒæ•°æ®: <span class="subst">&#123;doc.metadata&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç»“æœ 1:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">ç»“æœ 2:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">ç»“æœ 3:</span><br><span class="line">å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">å…ƒæ•°æ®: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="â‘£-é€šè¿‡L2è·ç¦»åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆsimilarity-search-with-scoreï¼‰"><a href="#â‘£-é€šè¿‡L2è·ç¦»åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆsimilarity-search-with-scoreï¼‰" class="headerlink" title="â‘£ é€šè¿‡L2è·ç¦»åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆsimilarity_search_with_scoreï¼‰"></a>â‘£ é€šè¿‡L2è·ç¦»åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆsimilarity_search_with_scoreï¼‰</h4><p>è¯´æ˜ï¼šåˆ†æ•°å€¼è¶Šå°ï¼Œæ£€ç´¢åˆ°çš„æ–‡æ¡£è¶Šå’Œé—®é¢˜ç›¸ä¼¼ã€‚åˆ†å€¼å–å€¼èŒƒå›´ï¼š[0ï¼Œæ­£æ— ç©·]</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docs = db.similarity_search_with_score(  </span><br><span class="line">    <span class="string">&quot;é‡å­åŠ›å­¦æ˜¯ä»€ä¹ˆ?&quot;</span>  </span><br><span class="line">)  </span><br><span class="line"><span class="keyword">for</span> doc, score <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot; [L2è·ç¦»å¾—åˆ†=<span class="subst">&#123;score:<span class="number">.3</span>f&#125;</span>] <span class="subst">&#123;doc.page_content&#125;</span> [<span class="subst">&#123;doc.metadata&#125;</span>]&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[L2è·ç¦»å¾—åˆ†=1.055] ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ [&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;]</span><br><span class="line">[L2è·ç¦»å¾—åˆ†=1.057] ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ [&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;]</span><br><span class="line">[L2è·ç¦»å¾—åˆ†=1.058] ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ [&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;]</span><br><span class="line">[L2è·ç¦»å¾—åˆ†=1.071] äººç±»æ˜¯åœ°çƒä¸Šæœ€å…·æ™ºæ…§çš„ç”Ÿç‰©ï¼Œå±äºçµé•¿ç›®äººç§‘ã€‚ç°ä»£äººç±»ï¼ˆæ™ºäººï¼‰æ‹¥æœ‰é«˜åº¦å‘è¾¾çš„å¤§è„‘ï¼Œåˆ›é€ äº†è¯­è¨€ã€å·¥å…·å’Œæ–‡æ˜ã€‚äººç±»çš„å¹³å‡å¯¿å‘½çº¦70-80å¹´ï¼Œåˆ†å¸ƒåœ¨å…¨çƒå„åœ°ã€‚ [&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;ç”Ÿç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;çµé•¿ç±»&#x27;</span>&#125;]</span><br></pre></td></tr></table></figure><h4 id="â‘¤-é€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆ-similarity-search-with-relevance-scoresï¼‰"><a href="#â‘¤-é€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆ-similarity-search-with-relevance-scoresï¼‰" class="headerlink" title="â‘¤ é€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆ_similarity_search_with_relevance_scoresï¼‰"></a>â‘¤ é€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦åˆ†æ•°è¿›è¡Œæœç´¢ï¼ˆ_similarity_search_with_relevance_scoresï¼‰</h4><p>è¯´æ˜ï¼šåˆ†æ•°å€¼è¶Šæ¥è¿‘1ï¼ˆä¸Šé™ï¼‰ï¼Œæ£€ç´¢åˆ°çš„æ–‡æ¡£è¶Šå’Œé—®é¢˜ç›¸ä¼¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docs = db._similarity_search_with_relevance_scores(  </span><br><span class="line">    <span class="string">&quot;é‡å­åŠ›å­¦æ˜¯ä»€ä¹ˆ?&quot;</span>  </span><br><span class="line">)  </span><br><span class="line"><span class="keyword">for</span> doc, score <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;* [ä½™å¼¦ç›¸ä¼¼åº¦å¾—åˆ†=<span class="subst">&#123;score:<span class="number">.3</span>f&#125;</span>] <span class="subst">&#123;doc.page_content&#125;</span> [<span class="subst">&#123;doc.metadata&#125;</span>]&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* [ä½™å¼¦ç›¸ä¼¼åº¦å¾—åˆ†=0.254] ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ [&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;]</span><br><span class="line">* [ä½™å¼¦ç›¸ä¼¼åº¦å¾—åˆ†=0.253] ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ [&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>&#125;]</span><br><span class="line">* [ä½™å¼¦ç›¸ä¼¼åº¦å¾—åˆ†=0.252] ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ [&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;åŠ¨ç‰©&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;å“ºä¹³åŠ¨ç‰©&#x27;</span>&#125;]</span><br><span class="line">* [ä½™å¼¦ç›¸ä¼¼åº¦å¾—åˆ†=0.243] äººç±»æ˜¯åœ°çƒä¸Šæœ€å…·æ™ºæ…§çš„ç”Ÿç‰©ï¼Œå±äºçµé•¿ç›®äººç§‘ã€‚ç°ä»£äººç±»ï¼ˆæ™ºäººï¼‰æ‹¥æœ‰é«˜åº¦å‘è¾¾çš„å¤§è„‘ï¼Œåˆ›é€ äº†è¯­è¨€ã€å·¥å…·å’Œæ–‡æ˜ã€‚äººç±»çš„å¹³å‡å¯¿å‘½çº¦70-80å¹´ï¼Œåˆ†å¸ƒåœ¨å…¨çƒå„åœ°ã€‚ [&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;çµé•¿ç±»&#x27;</span>, <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;ç”Ÿç‰©&#x27;</span>&#125;]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="â‘¥-MMRï¼ˆæœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼Œmax-marginal-relevance-searchï¼‰"><a href="#â‘¥-MMRï¼ˆæœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼Œmax-marginal-relevance-searchï¼‰" class="headerlink" title="â‘¥ MMRï¼ˆæœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼Œmax_marginal_relevance_searchï¼‰"></a>â‘¥ MMRï¼ˆæœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼Œmax_marginal_relevance_searchï¼‰</h4><p>MMR æ˜¯ä¸€ç§å¹³è¡¡<code>ç›¸å…³æ€§</code> å’Œ<code>å¤šæ ·æ€§</code>çš„æ£€ç´¢ç­–ç•¥ï¼Œé¿å…è¿”å›é«˜åº¦ç›¸ä¼¼çš„å†—ä½™ç»“æœã€‚</p><p>å‚æ•°è¯´æ˜ï¼š <strong>lambda_mult</strong> å‚æ•°å€¼ä»‹äº 0 åˆ° 1 ä¹‹é—´ï¼Œç”¨äºç¡®å®šç»“æœä¹‹é—´çš„å¤šæ ·æ€§ç¨‹åº¦ï¼Œå…¶ä¸­ 0 å¯¹åº”æœ€å¤§ å¤šæ ·æ€§ï¼Œ1 å¯¹åº”æœ€å°å¤šæ ·æ€§ã€‚é»˜è®¤å€¼ä¸º 0.5ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docs = db.max_marginal_relevance_search(  </span><br><span class="line">    query=<span class="string">&quot;é‡å­åŠ›å­¦æ˜¯ä»€ä¹ˆ&quot;</span>,  </span><br><span class="line">    lambda_mult=<span class="number">0.8</span>,  <span class="comment"># ä¾§é‡ç›¸ä¼¼æ€§  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ” å…³äºã€é‡å­åŠ›å­¦æ˜¯ä»€ä¹ˆã€‘çš„æœç´¢ç»“æœï¼š&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“– ç»“æœ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Œ å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ·ï¸ æ ‡ç­¾: <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(<span class="string">f&#x27;<span class="subst">&#123;k&#125;</span>=<span class="subst">&#123;v&#125;</span>&#x27;</span> <span class="keyword">for</span> k, v <span class="keyword">in</span> doc.metadata.items())&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ğŸ” å…³äºã€é‡å­åŠ›å­¦æ˜¯ä»€ä¹ˆã€‘çš„æœç´¢ç»“æœï¼š</span><br><span class="line">==================================================</span><br><span class="line"></span><br><span class="line">ğŸ“– ç»“æœ 1:</span><br><span class="line">ğŸ“Œ å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">ğŸ·ï¸ æ ‡ç­¾: <span class="built_in">type</span>=å“ºä¹³åŠ¨ç‰©, <span class="built_in">source</span>=åŠ¨ç‰©</span><br><span class="line"></span><br><span class="line">ğŸ“– ç»“æœ 2:</span><br><span class="line">ğŸ“Œ å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">ğŸ·ï¸ æ ‡ç­¾: <span class="built_in">source</span>=åŠ¨ç‰©, <span class="built_in">type</span>=å“ºä¹³åŠ¨ç‰©</span><br><span class="line"></span><br><span class="line">ğŸ“– ç»“æœ 3:</span><br><span class="line">ğŸ“Œ å†…å®¹: ç‹—æ˜¯äººç±»æœ€æ—©é©¯åŒ–çš„åŠ¨ç‰©ä¹‹ä¸€ï¼Œå±äºçŠ¬ç§‘ã€‚å®ƒä»¬å…·æœ‰é«˜åº¦ç¤¾ä¼šæ€§ï¼Œèƒ½ç†è§£äººç±»æƒ…ç»ªï¼Œå¸¸è¢«ç”¨ä½œå® ç‰©ã€å¯¼ç›²çŠ¬æˆ–è­¦çŠ¬ã€‚ä¸åŒå“ç§çš„ç‹—åœ¨ä½“å‹ã€æ¯›è‰²å’Œæ€§æ ¼ä¸Šæœ‰å¾ˆå¤§å·®å¼‚ã€‚</span><br><span class="line">ğŸ·ï¸ æ ‡ç­¾: <span class="built_in">type</span>=å“ºä¹³åŠ¨ç‰©, <span class="built_in">source</span>=åŠ¨ç‰©</span><br><span class="line"></span><br><span class="line">ğŸ“– ç»“æœ 4:</span><br><span class="line">ğŸ“Œ å†…å®¹: äººç±»æ˜¯åœ°çƒä¸Šæœ€å…·æ™ºæ…§çš„ç”Ÿç‰©ï¼Œå±äºçµé•¿ç›®äººç§‘ã€‚ç°ä»£äººç±»ï¼ˆæ™ºäººï¼‰æ‹¥æœ‰é«˜åº¦å‘è¾¾çš„å¤§è„‘ï¼Œåˆ›é€ äº†è¯­è¨€ã€å·¥å…·å’Œæ–‡æ˜ã€‚äººç±»çš„å¹³å‡å¯¿å‘½çº¦70-80å¹´ï¼Œåˆ†å¸ƒåœ¨å…¨çƒå„åœ°ã€‚</span><br><span class="line">ğŸ·ï¸ æ ‡ç­¾: <span class="built_in">type</span>=çµé•¿ç±», <span class="built_in">source</span>=ç”Ÿç‰©</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æ£€ç´¢å™¨-å¬å›å™¨-Retrievers"><a href="#æ£€ç´¢å™¨-å¬å›å™¨-Retrievers" class="headerlink" title="æ£€ç´¢å™¨(å¬å›å™¨) Retrievers"></a>æ£€ç´¢å™¨(å¬å›å™¨) Retrievers</h1><p>ä»â€œå‘é‡å­˜å‚¨ç»„ä»¶â€çš„ä»£ç å®ç°5.4.2ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå‘é‡æ•°æ®åº“æœ¬èº«å·²ç»åŒ…å«äº†å®ç°å¬å›åŠŸèƒ½çš„å‡½æ•°æ–¹æ³• (<strong>similarity_search</strong> )ã€‚è¯¥å‡½æ•°é€šè¿‡è®¡ç®—åŸå§‹æŸ¥è¯¢å‘é‡ä¸æ•°æ®åº“ä¸­å­˜å‚¨å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥å®ç°å¬å›ã€‚ </p><p>LangChainè¿˜æä¾›äº† <strong>æ›´åŠ å¤æ‚çš„å¬å›ç­–ç•¥</strong>ï¼Œè¿™äº›ç­–ç•¥è¢«é›†æˆåœ¨Retrieversï¼ˆæ£€ç´¢å™¨æˆ–å¬å›å™¨ï¼‰ç»„ä»¶ä¸­ã€‚ </p><p>Retrieversï¼ˆæ£€ç´¢å™¨ï¼‰æ˜¯ä¸€ç§ç”¨äºä»å¤§é‡æ–‡æ¡£ä¸­æ£€ç´¢ä¸ç»™å®šæŸ¥è¯¢ç›¸å…³çš„æ–‡æ¡£æˆ–ä¿¡æ¯ç‰‡æ®µçš„å·¥å…·ã€‚æ£€ç´¢å™¨ <strong>ä¸éœ€è¦å­˜å‚¨æ–‡æ¡£</strong>ï¼Œåªéœ€è¦ <strong>è¿”å›ï¼ˆæˆ–æ£€ç´¢ï¼‰æ–‡æ¡£</strong>å³å¯ã€‚<br><img src="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/file-20250928102015858.png"></p><p><strong>Retrievers çš„æ‰§è¡Œæ­¥éª¤ï¼š</strong></p><ul><li>æ­¥éª¤1ï¼šå°†è¾“å…¥æŸ¥è¯¢è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºã€‚ </li><li>æ­¥éª¤2ï¼šåœ¨å‘é‡å­˜å‚¨ä¸­æœç´¢ä¸æŸ¥è¯¢å‘é‡æœ€ç›¸ä¼¼çš„æ–‡æ¡£å‘é‡ï¼ˆé€šå¸¸ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æˆ–æ¬§å‡ é‡Œå¾—è·ç¦»ç­‰åº¦é‡æ–¹ æ³•ï¼‰ã€‚ </li><li>æ­¥éª¤3ï¼šè¿”å›ä¸æŸ¥è¯¢æœ€ç›¸å…³çš„æ–‡æ¡£æˆ–æ–‡æœ¬ç‰‡æ®µï¼Œä»¥åŠå®ƒä»¬çš„ç›¸ä¼¼åº¦å¾—åˆ†ã€‚</li></ul><h2 id="ä»£ç å®ç°-1"><a href="#ä»£ç å®ç°-1" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>Retriever ä¸€èˆ¬å’Œ VectorStore é…å¥—å®ç°ï¼Œé€šè¿‡as_retriever() æ–¹æ³•è·å–ã€‚<br>ä¸¾ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> TextLoader  </span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æ–‡æ¡£åŠ è½½å™¨  </span></span><br><span class="line">loader = TextLoader(file_path=<span class="string">&#x27;./asset/load/09-ai1.txt&#x27;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åŠ è½½æ–‡æ¡£  </span></span><br><span class="line">documents = loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰æ–‡æœ¬åˆ‡å‰²å™¨  </span></span><br><span class="line">text_splitter = CharacterTextSplitter(chunk_size=<span class="number">1000</span>, chunk_overlap=<span class="number">100</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.åˆ‡å‰²æ–‡æ¡£  </span></span><br><span class="line">docs = text_splitter.split_documents(documents)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.å®šä¹‰åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">embeddings = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>  </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å‘é‡æ•°æ®åº“  </span></span><br><span class="line">db = FAISS.from_documents(documents=docs,embedding=embeddings)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åŸºäºå‘é‡æ•°æ®åº“è·å–æ£€ç´¢å™¨  </span></span><br><span class="line">retriever = db.as_retriever()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿›è¡Œæ•°æ®çš„æ£€ç´¢  </span></span><br><span class="line">docs = retriever.invoke(<span class="built_in">input</span> = <span class="string">&quot;æ·±åº¦å­¦ä¹ æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;------<span class="subst">&#123;doc&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">------page_content=<span class="string">&#x27;5. äººå·¥æ™ºèƒ½çš„æŒ‘æˆ˜ä¸æœºé‡</span></span><br><span class="line"><span class="string">5.1 æŒ‘æˆ˜</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½å‘å±•è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜åŒ…æ‹¬æ•°æ®éšç§ã€ç®—æ³•åè§ã€å®‰å…¨æ€§é—®é¢˜ç­‰ã€‚æ•°æ®éšç§é—®é¢˜æ¶‰åŠåˆ°ä¸ªäººæ•°æ®çš„æ”¶é›†å’Œä½¿ç”¨ï¼Œç®—æ³•åè§é—®é¢˜åˆ™æ¶‰åŠåˆ°ç®—æ³•çš„å…¬å¹³æ€§å’Œé€æ˜åº¦ï¼Œå®‰å…¨æ€§é—®é¢˜åˆ™æ¶‰åŠåˆ°äººå·¥æ™ºèƒ½ç³»ç»Ÿçš„å¯é æ€§å’Œç¨³å®šæ€§ã€‚</span></span><br><span class="line"><span class="string">5.2 æœºé‡</span></span><br><span class="line"><span class="string">å°½ç®¡é¢ä¸´æŒ‘æˆ˜ï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•ä¹Ÿå¸¦æ¥äº†å·¨å¤§çš„æœºé‡ã€‚äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è¿›æ­¥å°†æ¨åŠ¨å„è¡Œå„ä¸šçš„åˆ›æ–°ï¼Œæé«˜ç”Ÿäº§æ•ˆç‡ï¼Œæ”¹å–„ç”Ÿæ´»è´¨é‡ã€‚æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå–å¾—çªç ´ï¼Œä¸ºäººç±»ç¤¾ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©å’Œç¦ç¥‰ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6. æœªæ¥å±•æœ›</span></span><br><span class="line"><span class="string">6.1 æŠ€æœ¯çªç ´</span></span><br><span class="line"><span class="string">æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æŠ€æœ¯æœ‰æœ›åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å–å¾—çªç ´ï¼šä¸€æ˜¯ç®—æ³•çš„ä¼˜åŒ–å’Œåˆ›æ–°ï¼Œæé«˜æ¨¡å‹çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ï¼›äºŒæ˜¯è®¡ç®—èƒ½åŠ›çš„æå‡ï¼Œæ”¯æŒæ›´å¤æ‚çš„æ¨¡å‹å’Œæ›´å¤§è§„æ¨¡çš„æ•°æ®å¤„ç†ï¼›ä¸‰æ˜¯è·¨å­¦ç§‘ç ”ç©¶çš„æ·±å…¥ï¼Œæ¨åŠ¨äººå·¥æ™ºèƒ½ä¸å…¶ä»–é¢†åŸŸçš„èåˆã€‚</span></span><br><span class="line"><span class="string">6.2 åº”ç”¨æ‹“å±•</span></span><br><span class="line"><span class="string">éšç€æŠ€æœ¯çš„è¿›æ­¥ï¼Œäººå·¥æ™ºèƒ½çš„åº”ç”¨é¢†åŸŸå°†è¿›ä¸€æ­¥æ‹“å±•ã€‚æœªæ¥ï¼Œäººå·¥æ™ºèƒ½æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ï¼Œå¦‚ç¯å¢ƒä¿æŠ¤ã€èƒ½æºç®¡ç†ã€æ™ºèƒ½åˆ¶é€ ç­‰ã€‚äººå·¥æ™ºèƒ½å°†æˆä¸ºæ¨åŠ¨ç¤¾ä¼šè¿›æ­¥çš„é‡è¦åŠ›é‡ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7. ç»“è®º</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½ä½œä¸ºä¸€é—¨å¿«é€Ÿå‘å±•çš„ç§‘å­¦ï¼Œæ­£åœ¨æ”¹å˜ç€äººç±»ç¤¾ä¼šçš„è¿è¡Œæ–¹å¼ã€‚é€šè¿‡ä¸æ–­çš„æŠ€æœ¯åˆ›æ–°å’Œåº”ç”¨æ‹“å±•ï¼Œäººå·¥æ™ºèƒ½å°†ä¸ºäººç±»ç¤¾ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©å’Œç¦ç¥‰ã€‚ç„¶è€Œï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•ä¹Ÿé¢ä¸´ç€è¯¸å¤šæŒ‘æˆ˜ï¼Œéœ€è¦ç¤¾ä¼šå„ç•Œå…±åŒåŠªåŠ›ï¼Œæ¨åŠ¨äººå·¥æ™ºèƒ½çš„å¥åº·å‘å±•ã€‚&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/09-ai1.txt&#x27;</span>&#125;</span><br><span class="line">------page_content=<span class="string">&#x27;3. äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯</span></span><br><span class="line"><span class="string">3.1 æœºå™¨å­¦ä¹ </span></span><br><span class="line"><span class="string">æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼Œé€šè¿‡ç®—æ³•ä½¿è®¡ç®—æœºä»æ•°æ®ä¸­å­¦ä¹ å¹¶åšå‡ºå†³ç­–ã€‚å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•åŒ…æ‹¬ç›‘ç£å­¦ä¹ ã€æ— ç›‘ç£å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ã€‚ç›‘ç£å­¦ä¹ é€šè¿‡æ ‡è®°æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œæ— ç›‘ç£å­¦ä¹ åˆ™ä»æœªæ ‡è®°æ•°æ®ä¸­å¯»æ‰¾æ¨¡å¼ï¼Œå¼ºåŒ–å­¦ä¹ åˆ™é€šè¿‡ä¸ç¯å¢ƒäº¤äº’æ¥ä¼˜åŒ–å†³ç­–ã€‚</span></span><br><span class="line"><span class="string">3.2 æ·±åº¦å­¦ä¹ </span></span><br><span class="line"><span class="string">æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é¢†åŸŸï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œè¿›è¡Œç‰¹å¾æå–å’Œæ¨¡å¼è¯†åˆ«ã€‚æ·±åº¦å­¦ä¹ åœ¨å›¾åƒè¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—æˆæœã€‚å¸¸è§çš„æ·±åº¦å­¦ä¹ æ¨¡å‹åŒ…æ‹¬å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ã€å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰å’Œé•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰ã€‚</span></span><br><span class="line"><span class="string">3.3 è‡ªç„¶è¯­è¨€å¤„ç†</span></span><br><span class="line"><span class="string">è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œè‡´åŠ›äºä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€ã€‚NLPæŠ€æœ¯å¹¿æ³›åº”ç”¨äºæœºå™¨ç¿»è¯‘ã€æƒ…æ„Ÿåˆ†æã€æ–‡æœ¬åˆ†ç±»ç­‰é¢†åŸŸã€‚è¿‘å¹´æ¥ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ çš„NLPæ¨¡å‹ï¼ˆå¦‚BERTã€GPTï¼‰åœ¨è¯­è¨€ç†è§£ä»»åŠ¡ä¸­å–å¾—äº†çªç ´æ€§è¿›å±•ã€‚</span></span><br><span class="line"><span class="string">3.4 è®¡ç®—æœºè§†è§‰</span></span><br><span class="line"><span class="string">è®¡ç®—æœºè§†è§‰æ˜¯äººå·¥æ™ºèƒ½çš„å¦ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œè‡´åŠ›äºä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£å’Œå¤„ç†å›¾åƒå’Œè§†é¢‘ã€‚è®¡ç®—æœºè§†è§‰æŠ€æœ¯å¹¿æ³›åº”ç”¨äºå›¾åƒè¯†åˆ«ã€ç›®æ ‡æ£€æµ‹ã€äººè„¸è¯†åˆ«ç­‰é¢†åŸŸã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚CNNï¼‰åœ¨è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­å–å¾—äº†æ˜¾è‘—æˆæœã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">8. äººå·¥æ™ºèƒ½çš„åº”ç”¨é¢†åŸŸ</span></span><br><span class="line"><span class="string">4.1 åŒ»ç–—å¥åº·</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨åŒ»ç–—å¥åº·é¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬ç–¾ç—…è¯Šæ–­ã€è¯ç‰©ç ”å‘ã€ä¸ªæ€§åŒ–åŒ»ç–—ç­‰ã€‚é€šè¿‡åˆ†æåŒ»å­¦å½±åƒå’Œæ‚£è€…æ•°æ®ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©åŒ»ç”Ÿæ›´å‡†ç¡®åœ°è¯Šæ–­ç–¾ç—…ï¼Œæé«˜æ²»ç–—æ•ˆæœã€‚</span></span><br><span class="line"><span class="string">4.2 é‡‘è</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨é‡‘èé¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬é£é™©è¯„ä¼°ã€æ¬ºè¯ˆæ£€æµ‹ã€ç®—æ³•äº¤æ˜“ç­‰ã€‚é€šè¿‡åˆ†æå¸‚åœºæ•°æ®å’Œäº¤æ˜“è®°å½•ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©é‡‘èæœºæ„åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ï¼Œæé«˜è¿è¥æ•ˆç‡ã€‚</span></span><br><span class="line"><span class="string">4.3 æ•™è‚²</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨æ•™è‚²é¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬ä¸ªæ€§åŒ–å­¦ä¹ ã€æ™ºèƒ½è¾…å¯¼ã€è‡ªåŠ¨è¯„åˆ†ç­‰ã€‚é€šè¿‡åˆ†æå­¦ç”Ÿçš„å­¦ä¹ æ•°æ®ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥ä¸ºå­¦ç”Ÿæä¾›ä¸ªæ€§åŒ–çš„å­¦ä¹ å»ºè®®ï¼Œæé«˜å­¦ä¹ æ•ˆæœã€‚</span></span><br><span class="line"><span class="string">4.4 äº¤é€š</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½åœ¨äº¤é€šé¢†åŸŸçš„åº”ç”¨åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€äº¤é€šç®¡ç†ã€æ™ºèƒ½å¯¼èˆªç­‰ã€‚é€šè¿‡åˆ†æäº¤é€šæ•°æ®å’Œè·¯å†µä¿¡æ¯ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©ä¼˜åŒ–äº¤é€šæµé‡ï¼Œæé«˜äº¤é€šå®‰å…¨ã€‚&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/09-ai1.txt&#x27;</span>&#125;</span><br><span class="line">------page_content=<span class="string">&#x27;äººå·¥æ™ºèƒ½ç»¼è¿°ï¼šå‘å±•ã€åº”ç”¨ä¸æœªæ¥å±•æœ›</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ‘˜è¦</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½ï¼ˆArtificial Intelligenceï¼ŒAIï¼‰ä½œä¸ºè®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œè¿‘å¹´æ¥å–å¾—äº†çªé£çŒ›è¿›çš„å‘å±•ã€‚æœ¬æ–‡ç»¼è¿°äº†äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹ã€æ ¸å¿ƒæŠ€æœ¯ã€åº”ç”¨é¢†åŸŸä»¥åŠæœªæ¥å‘å±•è¶‹åŠ¿ã€‚é€šè¿‡å¯¹äººå·¥æ™ºèƒ½çš„å®šä¹‰ã€å†å²èƒŒæ™¯ã€ä¸»è¦æŠ€æœ¯ï¼ˆå¦‚æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ï¼‰çš„è¯¦ç»†ä»‹ç»ï¼Œæ¢è®¨äº†äººå·¥æ™ºèƒ½åœ¨åŒ»ç–—ã€é‡‘èã€æ•™è‚²ã€äº¤é€šç­‰é¢†åŸŸçš„åº”ç”¨ï¼Œå¹¶åˆ†æäº†äººå·¥æ™ºèƒ½å‘å±•è¿‡ç¨‹ä¸­é¢ä¸´çš„æŒ‘æˆ˜ä¸æœºé‡ã€‚æœ€åï¼Œæœ¬æ–‡å¯¹äººå·¥æ™ºèƒ½çš„æœªæ¥å‘å±•è¿›è¡Œäº†å±•æœ›ï¼Œæå‡ºäº†å¯èƒ½çš„çªç ´æ–¹å‘ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. å¼•è¨€</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç¨‹åºæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„ä¸€é—¨ç§‘å­¦ã€‚è‡ª20ä¸–çºª50å¹´ä»£è¯ç”Ÿä»¥æ¥ï¼Œäººå·¥æ™ºèƒ½ç»å†äº†å¤šæ¬¡èµ·ä¼ï¼Œè¿‘å¹´æ¥éšç€è®¡ç®—èƒ½åŠ›çš„æå‡å’Œå¤§æ•°æ®çš„æ™®åŠï¼Œäººå·¥æ™ºèƒ½æŠ€æœ¯å–å¾—äº†æ˜¾è‘—çš„è¿›å±•ã€‚äººå·¥æ™ºèƒ½çš„åº”ç”¨å·²ç»æ¸—é€åˆ°æ—¥å¸¸ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ï¼Œä»æ™ºèƒ½æ‰‹æœºçš„è¯­éŸ³åŠ©æ‰‹åˆ°è‡ªåŠ¨é©¾é©¶æ±½è½¦ï¼Œä»åŒ»ç–—è¯Šæ–­åˆ°é‡‘èåˆ†æï¼Œäººå·¥æ™ºèƒ½æ­£åœ¨æ”¹å˜ç€äººç±»ç¤¾ä¼šçš„è¿è¡Œæ–¹å¼ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹</span></span><br><span class="line"><span class="string">2.1 æ—©æœŸå‘å±•</span></span><br><span class="line"><span class="string">äººå·¥æ™ºèƒ½çš„æ¦‚å¿µæœ€æ—©å¯ä»¥è¿½æº¯åˆ°20ä¸–çºª50å¹´ä»£ã€‚1956å¹´ï¼Œè¾¾ç‰¹èŒ…æ–¯ä¼šè®®ï¼ˆDartmouth Conferenceï¼‰è¢«è®¤ä¸ºæ˜¯äººå·¥æ™ºèƒ½ç ”ç©¶çš„æ­£å¼å¼€ç«¯ã€‚åœ¨éšåçš„å‡ åå¹´é‡Œï¼Œäººå·¥æ™ºèƒ½ç ”ç©¶ç»å†äº†å¤šæ¬¡é«˜æ½®ä¸ä½è°·ã€‚æ—©æœŸçš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨ç¬¦å·é€»è¾‘å’Œä¸“å®¶ç³»ç»Ÿä¸Šï¼Œä½†ç”±äºè®¡ç®—èƒ½åŠ›çš„é™åˆ¶å’Œç®—æ³•çš„ä¸è¶³ï¼Œè¿›å±•ç¼“æ…¢ã€‚</span></span><br><span class="line"><span class="string">2.2 æœºå™¨å­¦ä¹ çš„å…´èµ·</span></span><br><span class="line"><span class="string">20ä¸–çºª90å¹´ä»£ï¼Œéšç€ç»Ÿè®¡å­¦ä¹ æ–¹æ³•çš„å¼•å…¥ï¼Œæœºå™¨å­¦ä¹ é€æ¸æˆä¸ºäººå·¥æ™ºèƒ½ç ”ç©¶çš„ä¸»æµã€‚æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ç­‰ç®—æ³•åœ¨åˆ†ç±»å’Œå›å½’ä»»åŠ¡ä¸­å–å¾—äº†è‰¯å¥½çš„æ•ˆæœã€‚è¿™ä¸€æ—¶æœŸï¼Œæœºå™¨å­¦ä¹ å¼€å§‹åº”ç”¨äºæ•°æ®æŒ–æ˜ã€æ¨¡å¼è¯†åˆ«ç­‰é¢†åŸŸã€‚</span></span><br><span class="line"><span class="string">2.3 æ·±åº¦å­¦ä¹ çš„çªç ´</span></span><br><span class="line"><span class="string">2012å¹´ï¼Œæ·±åº¦å­¦ä¹ åœ¨å›¾åƒè¯†åˆ«é¢†åŸŸå–å¾—äº†çªç ´æ€§è¿›å±•ï¼Œæ ‡å¿—ç€äººå·¥æ™ºèƒ½è¿›å…¥äº†ä¸€ä¸ªæ–°çš„é˜¶æ®µã€‚æ·±åº¦å­¦ä¹ é€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ¨¡æ‹Ÿäººè„‘çš„å·¥ä½œæ–¹å¼ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æå–ç‰¹å¾å¹¶è¿›è¡Œå¤æ‚çš„æ¨¡å¼è¯†åˆ«ã€‚å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ã€å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰å’Œé•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰ç­‰æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨å›¾åƒå¤„ç†ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—æˆæœã€‚&#x27;</span> metadata=&#123;<span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;./asset/load/09-ai1.txt&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨ç›¸å…³æ£€ç´¢ç­–"><a href="#ä½¿ç”¨ç›¸å…³æ£€ç´¢ç­–" class="headerlink" title="ä½¿ç”¨ç›¸å…³æ£€ç´¢ç­–"></a>ä½¿ç”¨ç›¸å…³æ£€ç´¢ç­–</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install faiss-cpu</span><br></pre></td></tr></table></figure><p>å‰ç½®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³ä¾èµ–  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">from</span> langchain_core.documents <span class="keyword">import</span> Document  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æ–‡æ¡£  </span></span><br><span class="line">document_1 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;ç»æµå¤è‹ï¼šç¾å›½ç»æµæ­£åœ¨ä»ç–«æƒ…ä¸­å¼ºåŠ²å¤è‹ï¼Œå¤±ä¸šç‡é™è‡³å†å²ä½ç‚¹ã€‚ï¼&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_2 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;åŸºç¡€è®¾æ–½ï¼šæ”¿åºœå°†æŠ•èµ„1ä¸‡äº¿ç¾å…ƒç”¨äºä¿®å¤é“è·¯ã€æ¡¥æ¢å’Œå®½å¸¦ç½‘ç»œã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_3 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;æ°”å€™å˜åŒ–ï¼šæ‰¿è¯ºåˆ°2030å¹´å°†æ¸©å®¤æ°”ä½“æ’æ”¾é‡å‡å°‘50%ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_4 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot; åŒ»ç–—ä¿å¥ï¼šé™ä½å¤„æ–¹è¯ä»·æ ¼ï¼Œæ‰©å¤§åŒ»ç–—ä¿é™©è¦†ç›–èŒƒå›´ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_5 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;æ•™è‚²ï¼šæä¾›å…è´¹çš„ç¤¾åŒºå¤§å­¦æ•™è‚²ã€‚ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_6 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;ç§‘æŠ€ï¼šå¢åŠ å¯¹åŠå¯¼ä½“äº§ä¸šçš„æŠ•èµ„ä»¥å‡å°‘å¯¹å¤–å›½ä¾›åº”é“¾çš„ä¾èµ–ã€‚ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_7 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;å¤–äº¤æ”¿ç­–ï¼šç»§ç»­æ”¯æŒä¹Œå…‹å…°å¯¹æŠ—ä¿„ç½—æ–¯çš„ä¾µç•¥ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_8 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;æªæ”¯ç®¡åˆ¶ï¼šå‘¼åå›½ä¼šé€šè¿‡æ›´ä¸¥æ ¼çš„æªæ”¯ç®¡åˆ¶æ³•å¾‹ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_9 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;ç§»æ°‘æ”¹é©ï¼šæå‡ºå…¨é¢çš„ç§»æ°‘æ”¹é©æ–¹æ¡ˆã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">document_10 = Document(  </span><br><span class="line">    page_content=<span class="string">&quot;ç¤¾ä¼šæ­£ä¹‰ï¼šæ‰¿è¯ºè§£å†³ç³»ç»Ÿæ€§ç§æ—æ­§è§†é—®é¢˜ã€‚&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">documents = [  </span><br><span class="line">    document_1,  </span><br><span class="line">    document_2,  </span><br><span class="line">    document_3,  </span><br><span class="line">    document_4,  </span><br><span class="line">    document_5,  </span><br><span class="line">    document_6,  </span><br><span class="line">    document_7,  </span><br><span class="line">    document_8,  </span><br><span class="line">    document_9,  </span><br><span class="line">    document_10,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åˆ›å»ºå‘é‡å­˜å‚¨  </span></span><br><span class="line">embeddings = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å°†æ–‡æ¡£å‘é‡åŒ–ï¼Œæ·»åŠ åˆ°å‘é‡æ•°æ®åº“ç´¢å¼•ä¸­ï¼Œå¾—åˆ°å‘é‡æ•°æ®åº“å¯¹è±¡  </span></span><br><span class="line">db = FAISS.from_documents(documents, embeddings)</span><br></pre></td></tr></table></figure><h3 id="â‘ -é»˜è®¤æ£€ç´¢å™¨ä½¿ç”¨ç›¸ä¼¼æ€§æœç´¢"><a href="#â‘ -é»˜è®¤æ£€ç´¢å™¨ä½¿ç”¨ç›¸ä¼¼æ€§æœç´¢" class="headerlink" title="â‘  é»˜è®¤æ£€ç´¢å™¨ä½¿ç”¨ç›¸ä¼¼æ€§æœç´¢"></a>â‘  é»˜è®¤æ£€ç´¢å™¨ä½¿ç”¨ç›¸ä¼¼æ€§æœç´¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–æ£€ç´¢å™¨  </span></span><br><span class="line">retriever = db.as_retriever(search_kwargs=&#123;<span class="string">&quot;k&quot;</span>: <span class="number">3</span>&#125;) <span class="comment">#è¿™é‡Œè®¾ç½®è¿”å›çš„æ–‡æ¡£æ•°  </span></span><br><span class="line">  </span><br><span class="line">docs = retriever.invoke(<span class="string">&quot;ç»æµæ”¿ç­–&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>:\n<span class="subst">&#123;doc.page_content&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç»“æœ 1:</span><br><span class="line">ç¤¾ä¼šæ­£ä¹‰ï¼šæ‰¿è¯ºè§£å†³ç³»ç»Ÿæ€§ç§æ—æ­§è§†é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">ç»“æœ 2:</span><br><span class="line">å¤–äº¤æ”¿ç­–ï¼šç»§ç»­æ”¯æŒä¹Œå…‹å…°å¯¹æŠ—ä¿„ç½—æ–¯çš„ä¾µç•¥ã€‚</span><br><span class="line"></span><br><span class="line">ç»“æœ 3:</span><br><span class="line">æ•™è‚²ï¼šæä¾›å…è´¹çš„ç¤¾åŒºå¤§å­¦æ•™è‚²ã€‚ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="â‘¡-åˆ†æ•°é˜ˆå€¼æŸ¥è¯¢"><a href="#â‘¡-åˆ†æ•°é˜ˆå€¼æŸ¥è¯¢" class="headerlink" title="â‘¡ åˆ†æ•°é˜ˆå€¼æŸ¥è¯¢"></a>â‘¡ åˆ†æ•°é˜ˆå€¼æŸ¥è¯¢</h3><p>åªæœ‰ç›¸ä¼¼åº¦è¶…è¿‡è¿™ä¸ªå€¼æ‰ä¼šå¬å›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">retriever = db.as_retriever(  </span><br><span class="line">    search_type=<span class="string">&quot;similarity_score_threshold&quot;</span>,  </span><br><span class="line">    search_kwargs=&#123;<span class="string">&quot;score_threshold&quot;</span>: <span class="number">0.1</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">docs = retriever.invoke(<span class="string">&quot;ç»æµæ”¿ç­–&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> docs:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Œ å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“Œ å†…å®¹: ç¤¾ä¼šæ­£ä¹‰ï¼šæ‰¿è¯ºè§£å†³ç³»ç»Ÿæ€§ç§æ—æ­§è§†é—®é¢˜ã€‚</span><br><span class="line">ğŸ“Œ å†…å®¹: å¤–äº¤æ”¿ç­–ï¼šç»§ç»­æ”¯æŒä¹Œå…‹å…°å¯¹æŠ—ä¿„ç½—æ–¯çš„ä¾µç•¥ã€‚</span><br><span class="line">ğŸ“Œ å†…å®¹: æ•™è‚²ï¼šæä¾›å…è´¹çš„ç¤¾åŒºå¤§å­¦æ•™è‚²ã€‚ã€‚</span><br><span class="line">ğŸ“Œ å†…å®¹: ç§‘æŠ€ï¼šå¢åŠ å¯¹åŠå¯¼ä½“äº§ä¸šçš„æŠ•èµ„ä»¥å‡å°‘å¯¹å¤–å›½ä¾›åº”é“¾çš„ä¾èµ–ã€‚ã€‚</span><br></pre></td></tr></table></figure><p>æ³¨æ„åªä¼šè¿”å›æ»¡è¶³é˜ˆå€¼åˆ†æ•°çš„æ–‡æ¡£ï¼Œä¸ä¼šè·å–æ–‡æ¡£çš„å¾—åˆ†ã€‚å¦‚æœæƒ³æŸ¥è¯¢æ–‡æ¡£çš„å¾—åˆ†æ˜¯å¦æ»¡è¶³é˜ˆå€¼ï¼Œå¯ä»¥ ä½¿ç”¨å‘é‡æ•°æ®åº“çš„ <strong>similarity_search_with_relevance_scores</strong> æŸ¥çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docs_with_scores = db.similarity_search_with_relevance_scores(<span class="string">&quot;ç»æµæ”¿ç­–&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> doc, score <span class="keyword">in</span> docs_with_scores:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç›¸ä¼¼åº¦åˆ†æ•°: <span class="subst">&#123;score:<span class="number">.4</span>f&#125;</span>&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Œ å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç›¸ä¼¼åº¦åˆ†æ•°: 0.2922</span><br><span class="line">ğŸ“Œ å†…å®¹: ç¤¾ä¼šæ­£ä¹‰ï¼šæ‰¿è¯ºè§£å†³ç³»ç»Ÿæ€§ç§æ—æ­§è§†é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">ç›¸ä¼¼åº¦åˆ†æ•°: 0.2544</span><br><span class="line">ğŸ“Œ å†…å®¹: å¤–äº¤æ”¿ç­–ï¼šç»§ç»­æ”¯æŒä¹Œå…‹å…°å¯¹æŠ—ä¿„ç½—æ–¯çš„ä¾µç•¥ã€‚</span><br><span class="line"></span><br><span class="line">ç›¸ä¼¼åº¦åˆ†æ•°: 0.2302</span><br><span class="line">ğŸ“Œ å†…å®¹: æ•™è‚²ï¼šæä¾›å…è´¹çš„ç¤¾åŒºå¤§å­¦æ•™è‚²ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">ç›¸ä¼¼åº¦åˆ†æ•°: 0.2160</span><br><span class="line">ğŸ“Œ å†…å®¹: ç§‘æŠ€ï¼šå¢åŠ å¯¹åŠå¯¼ä½“äº§ä¸šçš„æŠ•èµ„ä»¥å‡å°‘å¯¹å¤–å›½ä¾›åº”é“¾çš„ä¾èµ–ã€‚ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="â‘¢-MMRæœç´¢"><a href="#â‘¢-MMRæœç´¢" class="headerlink" title="â‘¢ MMRæœç´¢"></a>â‘¢ MMRæœç´¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">retriever = db.as_retriever(  </span><br><span class="line">    search_type=<span class="string">&quot;mmr&quot;</span>,  </span><br><span class="line">    search_kwargs=&#123;<span class="string">&quot;fetch_k&quot;</span>:<span class="number">2</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">docs = retriever.invoke(<span class="string">&quot;ç»æµæ”¿ç­–&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span>  doc  <span class="keyword">in</span>  docs:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Œ å†…å®¹: <span class="subst">&#123;doc.page_content&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">ğŸ“Œ å†…å®¹: ç¤¾ä¼šæ­£ä¹‰ï¼šæ‰¿è¯ºè§£å†³ç³»ç»Ÿæ€§ç§æ—æ­§è§†é—®é¢˜ã€‚</span><br><span class="line">ğŸ“Œ å†…å®¹: å¤–äº¤æ”¿ç­–ï¼šç»§ç»­æ”¯æŒä¹Œå…‹å…°å¯¹æŠ—ä¿„ç½—æ–¯çš„ä¾µç•¥ã€‚</span><br></pre></td></tr></table></figure><h2 id="ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨"><a href="#ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨" class="headerlink" title="ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨"></a>ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨</h2><p>ä¸¾ä¾‹1ï¼šé€šè¿‡FAISSæ„å»ºä¸€ä¸ªå¯æœç´¢çš„å‘é‡ç´¢å¼•æ•°æ®åº“ï¼Œå¹¶ç»“åˆRAGæŠ€æœ¯è®©LLMå»å›ç­”é—®é¢˜ã€‚</p><h3 id="æƒ…å†µ1ï¼šä¸ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®"><a href="#æƒ…å†µ1ï¼šä¸ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®" class="headerlink" title="æƒ…å†µ1ï¼šä¸ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®"></a>æƒ…å†µ1ï¼šä¸ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è°ƒç”¨  </span></span><br><span class="line">response = llm.invoke(<span class="string">&quot;åŒ—äº¬æœ‰ä»€ä¹ˆè‘—åçš„å»ºç­‘ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">åŒ—äº¬ä½œä¸ºä¸­å›½çš„é¦–éƒ½ï¼Œæ‹¥æœ‰ä¸°å¯Œçš„å†å²å’Œç°ä»£å»ºç­‘ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›è‘—åçš„ä»£è¡¨ï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">### **å†å²å»ºç­‘**</span></span><br><span class="line">1. **æ•…å®«ï¼ˆç´«ç¦åŸï¼‰**  </span><br><span class="line">   - æ˜æ¸…ä¸¤ä»£çš„çš‡å®¶å®«æ®¿ï¼Œä¸–ç•Œæ–‡åŒ–é—äº§ï¼Œä¸­å›½ç°å­˜æœ€å¤§ã€æœ€å®Œæ•´çš„å¤å»ºç­‘ç¾¤ã€‚</span><br><span class="line"></span><br><span class="line">2. **å¤©å›**  </span><br><span class="line">   - æ˜æ¸…çš‡å¸ç¥­å¤©çš„åœºæ‰€ï¼Œä»¥ç¥ˆå¹´æ®¿å’Œåœœä¸˜å›é—»åï¼Œä¸–ç•Œæ–‡åŒ–é—äº§ã€‚</span><br><span class="line"></span><br><span class="line">3. **é¢å’Œå›­**  </span><br><span class="line">   - æ¸…ä»£çš‡å®¶å›­æ—ï¼Œä»¥æ˜†æ˜æ¹–ã€ä¸‡å¯¿å±±å’Œé•¿å»Šè‘—ç§°ï¼Œä¸–ç•Œæ–‡åŒ–é—äº§ã€‚</span><br><span class="line"></span><br><span class="line">4. **é•¿åŸï¼ˆå…«è¾¾å²­ã€æ…•ç”°å³ªæ®µï¼‰**  </span><br><span class="line">   - ä¸–ç•Œä¸ƒå¤§å¥‡è¿¹ä¹‹ä¸€ï¼ŒåŒ—äº¬å‘¨è¾¹ä¿å­˜å®Œå¥½çš„æ®µè½åŒ…æ‹¬å…«è¾¾å²­å’Œæ…•ç”°å³ªã€‚</span><br><span class="line"></span><br><span class="line">5. **åœ†æ˜å›­**  </span><br><span class="line">   - æ›¾ä¸ºâ€œä¸‡å›­ä¹‹å›­â€ï¼Œç°å­˜é—å€å…¬å›­ï¼Œè§è¯è¿‘ä»£å†å²ã€‚</span><br><span class="line"></span><br><span class="line">6. **é›å’Œå®«**  </span><br><span class="line">   - åŒ—äº¬æœ€å¤§çš„è—ä¼ ä½›æ•™å¯ºé™¢ï¼Œæ›¾æ˜¯é›æ­£çš‡å¸çš„åºœé‚¸ã€‚</span><br><span class="line"></span><br><span class="line">7. **é’Ÿé¼“æ¥¼**  </span><br><span class="line">   - å¤ä»£æŠ¥æ—¶ä¸­å¿ƒï¼Œä½äºä¸­è½´çº¿åŒ—ç«¯ï¼Œä¿ç•™å…ƒä»£æ ¼å±€ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### **è¿‘ç°ä»£å»ºç­‘**</span></span><br><span class="line">1. **å¤©å®‰é—¨å¹¿åœºåŠå‘¨è¾¹**  </span><br><span class="line">   - **äººæ°‘å¤§ä¼šå ‚**ï¼šå›½å®¶æ”¿æ²»æ´»åŠ¨ä¸­å¿ƒã€‚  </span><br><span class="line">   - **å›½å®¶åšç‰©é¦†**ï¼šä¸­å›½æœ€å¤§çš„ç»¼åˆæ€§åšç‰©é¦†ã€‚  </span><br><span class="line">   - **äººæ°‘è‹±é›„çºªå¿µç¢‘**ï¼šçºªå¿µè¿‘ä»£é©å‘½çƒˆå£«çš„æ ‡å¿—ã€‚  </span><br><span class="line">   - **æ¯›ä¸»å¸­çºªå¿µå ‚**ï¼šå®‰æ”¾æ¯›æ³½ä¸œé—ä½“çš„çºªå¿µå»ºç­‘ã€‚</span><br><span class="line"></span><br><span class="line">2. **å¥¥æ—åŒ¹å…‹å…¬å›­**  </span><br><span class="line">   - **é¸Ÿå·¢ï¼ˆå›½å®¶ä½“è‚²åœºï¼‰**ï¼š2008å¹´å¥¥è¿ä¼šä¸»ä½“è‚²åœºï¼Œç°ä»£é’¢ç»“æ„ä»£è¡¨ä½œã€‚  </span><br><span class="line">   - **æ°´ç«‹æ–¹ï¼ˆå›½å®¶æ¸¸æ³³ä¸­å¿ƒï¼‰**ï¼šç‹¬ç‰¹çš„è†œç»“æ„è®¾è®¡ï¼Œç°ä¸ºâ€œå†°ç«‹æ–¹â€ã€‚</span><br><span class="line"></span><br><span class="line">3. **ä¸­å¤®ç”µè§†å°æ€»éƒ¨å¤§æ¥¼ï¼ˆâ€œå¤§è£¤è¡©â€ï¼‰**  </span><br><span class="line">   - ç”±è·å…°å»ºç­‘å¸ˆé›·å§†Â·åº“å“ˆæ–¯è®¾è®¡ï¼Œåç°ä»£åœ°æ ‡å»ºç­‘ã€‚</span><br><span class="line"></span><br><span class="line">4. **å›½å®¶å¤§å‰§é™¢**  </span><br><span class="line">   - æ³•å›½å»ºç­‘å¸ˆä¿ç½—Â·å®‰å¾·é²è®¾è®¡ï¼Œé’›é‡‘å±ç©¹é¡¶å®›å¦‚â€œæ°´ä¸Šæ˜ç â€ã€‚</span><br><span class="line"></span><br><span class="line">5. **åŒ—äº¬å¤§å…´å›½é™…æœºåœº**  </span><br><span class="line">   - æ‰å“ˆÂ·å“ˆè¿ªå¾·è®¾è®¡ï¼Œå…¨çƒæœ€å¤§å•ä½“èˆªç«™æ¥¼ï¼Œä»¥â€œå‡¤å‡°å±•ç¿…â€ä¸ºé€ å‹ã€‚</span><br><span class="line"></span><br><span class="line">6. **ä¸­ä¿¡å¤§å¦ï¼ˆä¸­å›½å°Šï¼‰**  </span><br><span class="line">   - åŒ—äº¬æœ€é«˜å»ºç­‘ï¼ˆ528ç±³ï¼‰ï¼ŒCBDæ ¸å¿ƒåŒºçš„ç°ä»£æ‘©å¤©å¤§æ¥¼ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### **ç‰¹è‰²å»ºç­‘**</span></span><br><span class="line">- **èƒ¡åŒä¸å››åˆé™¢**ï¼šå¦‚å—é”£é¼“å··ã€ä»€åˆ¹æµ·å‘¨è¾¹ï¼Œå±•ç°è€åŒ—äº¬æ°‘å±…é£è²Œã€‚  </span><br><span class="line">- **åŒ—äº¬åŠ**ï¼šå‰é—¨é™„è¿‘çš„ç°ä»£æ–‡åŒ–è¡—åŒºï¼Œèåˆä¸­è¥¿å»ºç­‘é£æ ¼ã€‚  </span><br><span class="line">- **ç‰ç’ƒå‚æ–‡åŒ–è¡—**ï¼šä¼ ç»Ÿä¹¦ç”»å¤ç©è¡—åŒºï¼Œä»¿å¤å»ºç­‘é£æ ¼ã€‚</span><br><span class="line"></span><br><span class="line">è¿™äº›å»ºç­‘ä¸ä»…ä»£è¡¨äº†åŒ—äº¬çš„å†å²åº•è•´ï¼Œä¹Ÿå±•ç°äº†å…¶ä½œä¸ºå›½é™…å¤§éƒ½å¸‚çš„ç°ä»£æ´»åŠ›ã€‚å¦‚æœæœ‰å…·ä½“å…´è¶£æ–¹å‘ï¼Œå¯ä»¥æ·±å…¥æ¨èï¼</span><br></pre></td></tr></table></figure><h3 id="æƒ…å†µ2ï¼šä½¿ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®"><a href="#æƒ…å†µ2ï¼šä½¿ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®" class="headerlink" title="æƒ…å†µ2ï¼šä½¿ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®"></a>æƒ…å†µ2ï¼šä½¿ç”¨RAGç»™LLMçŒè¾“ä¸Šä¸‹æ–‡æ•°æ®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI,OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> TextLoader  </span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> CharacterTextSplitter  </span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2. åˆ›å»ºè‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt_template = <span class="string">&quot;&quot;&quot;è¯·ä½¿ç”¨ä»¥ä¸‹æä¾›çš„æ–‡æœ¬å†…å®¹æ¥å›ç­”é—®é¢˜ã€‚ä»…ä½¿ç”¨æä¾›çš„æ–‡æœ¬ä¿¡æ¯ï¼Œå¦‚æœæ–‡æœ¬ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œè¯·å›ç­”&quot;æŠ±æ­‰ï¼Œæä¾›çš„æ–‡æœ¬ä¸­æ²¡æœ‰è¿™ä¸ªä¿¡æ¯&quot;ã€‚  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">æ–‡æœ¬å†…å®¹ï¼š  </span></span><br><span class="line"><span class="string">&#123;context&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">é—®é¢˜ï¼š&#123;question&#125;  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">å›ç­”ï¼š  </span></span><br><span class="line"><span class="string">&quot;  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line">prompt = PromptTemplate.from_template(prompt_template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3. åˆå§‹åŒ–æ¨¡å‹  </span></span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">llm = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>,  </span><br><span class="line">    temperature=<span class="number">0</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">embedding_model = OpenAIEmbeddings(model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4. åŠ è½½æ–‡æ¡£  </span></span><br><span class="line">loader = TextLoader(<span class="string">&quot;./asset/load/10-test_doc.txt&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)  </span><br><span class="line">documents = loader.load()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5. åˆ†å‰²æ–‡æ¡£  </span></span><br><span class="line">text_splitter = CharacterTextSplitter(  </span><br><span class="line">    chunk_size=<span class="number">1000</span>,  </span><br><span class="line">    chunk_overlap=<span class="number">100</span>,  </span><br><span class="line">)  </span><br><span class="line">texts = text_splitter.split_documents(documents)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#print(f&quot;æ–‡æ¡£ä¸ªæ•°:&#123;len(texts)&#125;&quot;)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6. åˆ›å»ºå‘é‡å­˜å‚¨  </span></span><br><span class="line">vectorstore = FAISS.from_documents(  </span><br><span class="line">    documents=texts,  </span><br><span class="line">    embedding=embedding_model  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7.è·å–æ£€ç´¢å™¨  </span></span><br><span class="line">retriever = vectorstore.as_retriever()  </span><br><span class="line">  </span><br><span class="line">docs = retriever.invoke(<span class="string">&quot;åŒ—äº¬æœ‰ä»€ä¹ˆè‘—åçš„å»ºç­‘ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 8. åˆ›å»ºRunnableé“¾  </span></span><br><span class="line">chain = prompt | llm  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 9. æé—®  </span></span><br><span class="line">result = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;åŒ—äº¬æœ‰ä»€ä¹ˆè‘—åçš„å»ºç­‘ï¼Ÿ&quot;</span>,<span class="string">&quot;context&quot;</span>:docs&#125;)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå›ç­”:&quot;</span>, result.content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å›ç­”: æ ¹æ®æä¾›çš„æ–‡æœ¬å†…å®¹ï¼ŒåŒ—äº¬æœ‰ä»¥ä¸‹è‘—åå»ºç­‘ï¼š</span><br><span class="line"></span><br><span class="line">1. æ•…å®«ï¼ˆç´«ç¦åŸï¼‰ - æ˜æ¸…çš‡å®¶å®«æ®¿ï¼Œä¸–ç•Œæ–‡åŒ–é—äº§  </span><br><span class="line">2. å¤©å®‰é—¨ - æ ‡å¿—æ€§å»ºç­‘ï¼Œæ‹¥æœ‰ä¸–ç•Œæœ€å¤§åŸå¸‚å¹¿åœº  </span><br><span class="line">3. é¢å’Œå›­ - æ¸…ä»£çš‡å®¶å›­æ—ï¼Œä¸–ç•Œæ–‡åŒ–é—äº§  </span><br><span class="line">4. å¤©å› - æ˜æ¸…ç¥­å¤©åœºæ‰€ï¼Œä¸–ç•Œæ–‡åŒ–é—äº§  </span><br><span class="line">5. å…«è¾¾å²­é•¿åŸ - æœ€è‘—åçš„é•¿åŸæ®µè½  </span><br><span class="line">6. å›½å®¶ä½“è‚²åœºï¼ˆé¸Ÿå·¢ï¼‰ - 2008å¥¥è¿ä¸»ä½“è‚²åœº  </span><br><span class="line">7. ä¸­å¤®ç”µè§†å°æ€»éƒ¨å¤§æ¥¼ï¼ˆ<span class="string">&quot;å¤§è£¤è¡©&quot;</span>ï¼‰  </span><br><span class="line">8. å›½å®¶å¤§å‰§é™¢ï¼ˆ<span class="string">&quot;å·¨è›‹&quot;</span>ï¼‰  </span><br><span class="line">9. åŒ—äº¬å¤§å…´å›½é™…æœºåœº - <span class="string">&quot;æ–°ä¸–ç•Œä¸ƒå¤§å¥‡è¿¹&quot;</span>ä¹‹ä¸€  </span><br><span class="line">10. é¼“æ¥¼å’Œé’Ÿæ¥¼ - å¤ä»£æŠ¥æ—¶ä¸­å¿ƒ</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹2ï¼šä½¿ç”¨Chromaæ•°æ®åº“-ï¼ˆä¸ä¸¾ä¾‹1ç±»ä¼¼ï¼‰"><a href="#ä¸¾ä¾‹2ï¼šä½¿ç”¨Chromaæ•°æ®åº“-ï¼ˆä¸ä¸¾ä¾‹1ç±»ä¼¼ï¼‰" class="headerlink" title="ä¸¾ä¾‹2ï¼šä½¿ç”¨Chromaæ•°æ®åº“ ï¼ˆä¸ä¸¾ä¾‹1ç±»ä¼¼ï¼‰"></a>ä¸¾ä¾‹2ï¼šä½¿ç”¨Chromaæ•°æ®åº“ ï¼ˆä¸ä¸¾ä¾‹1ç±»ä¼¼ï¼‰</h3><h4 id="é˜¶æ®µ1ï¼šæ–‡æ¡£çš„åˆ‡åˆ†"><a href="#é˜¶æ®µ1ï¼šæ–‡æ¡£çš„åˆ‡åˆ†" class="headerlink" title="é˜¶æ®µ1ï¼šæ–‡æ¡£çš„åˆ‡åˆ†"></a>é˜¶æ®µ1ï¼šæ–‡æ¡£çš„åˆ‡åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 1. æ–‡æ¡£åŠ è½½  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> UnstructuredMarkdownLoader  </span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> MarkdownTextSplitter  </span><br><span class="line">markdown_path = <span class="string">&quot;asset/load/11-langchain.md&quot;</span>  </span><br><span class="line"> <span class="comment"># 2.å®šä¹‰UnstructuredMarkdownLoaderå¯¹è±¡  </span></span><br><span class="line">loader = UnstructuredMarkdownLoader(markdown_path)  </span><br><span class="line">   </span><br><span class="line"><span class="comment"># 3.åŠ è½½  </span></span><br><span class="line">data = loader.load()  </span><br><span class="line">splitter = MarkdownTextSplitter(chunk_size=<span class="number">1000</span>, chunk_overlap=<span class="number">100</span>)  </span><br><span class="line"><span class="comment"># 4.æ‰§è¡Œåˆ†å‰²  </span></span><br><span class="line">  </span><br><span class="line">documents = splitter.split_documents(data)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(documents))  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(documents):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ” åˆ†å— <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(doc.page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br></pre></td><td class="code"><pre><span class="line">13</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 1:</span><br><span class="line">How-to guides</span><br><span class="line"></span><br><span class="line">Here youâ€™ll find answers to â€œHow do Iâ€¦.?â€ types of questions. These guides are goal-oriented and concrete; they&#x27;re meant to help you complete a specific task. For conceptual explanations see the Conceptual guide. For end-to-end walkthroughs see Tutorials. For comprehensive descriptions of every class and function see the API Reference.</span><br><span class="line"></span><br><span class="line">Installation</span><br><span class="line"></span><br><span class="line">How to: install LangChain packages</span><br><span class="line"></span><br><span class="line">How to: use LangChain with different Pydantic versions</span><br><span class="line"></span><br><span class="line">Key features</span><br><span class="line"></span><br><span class="line">This highlights functionality that is core to using LangChain.</span><br><span class="line"></span><br><span class="line">How to: return structured data from a model</span><br><span class="line"></span><br><span class="line">How to: use a model to call tools</span><br><span class="line"></span><br><span class="line">How to: stream runnables</span><br><span class="line"></span><br><span class="line">How to: debug your LLM apps</span><br><span class="line"></span><br><span class="line">Components</span><br><span class="line"></span><br><span class="line">These are the core building blocks you can use when building applications.</span><br><span class="line"></span><br><span class="line">Chat models</span><br><span class="line"></span><br><span class="line">Chat Models are newer forms of language models that take messages in and output a message. See supported integrations for details on getting started with chat models from a specific provider.</span><br><span class="line"></span><br><span class="line">How to: do function/tool calling</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 2:</span><br><span class="line">How to: do function/tool calling</span><br><span class="line"></span><br><span class="line">How to: get models to return structured output</span><br><span class="line"></span><br><span class="line">How to: cache model responses</span><br><span class="line"></span><br><span class="line">How to: get log probabilities</span><br><span class="line"></span><br><span class="line">How to: create a custom chat model class</span><br><span class="line"></span><br><span class="line">How to: stream a response back</span><br><span class="line"></span><br><span class="line">How to: track token usage</span><br><span class="line"></span><br><span class="line">How to: track response metadata across providers</span><br><span class="line"></span><br><span class="line">How to: use chat model to call tools</span><br><span class="line"></span><br><span class="line">How to: stream tool calls</span><br><span class="line"></span><br><span class="line">How to: handle rate limits</span><br><span class="line"></span><br><span class="line">How to: few shot prompt tool behavior</span><br><span class="line"></span><br><span class="line">How to: bind model-specific formatted tools</span><br><span class="line"></span><br><span class="line">How to: force a specific tool call</span><br><span class="line"></span><br><span class="line">How to: work with local models</span><br><span class="line"></span><br><span class="line">How to: init any model in one line</span><br><span class="line"></span><br><span class="line">How to: pass multimodal data directly to models</span><br><span class="line"></span><br><span class="line">Messages</span><br><span class="line"></span><br><span class="line">Messages are the input and output of chat models. They have some content and a role, which describes the source of the message.</span><br><span class="line"></span><br><span class="line">How to: trim messages</span><br><span class="line"></span><br><span class="line">How to: filter messages</span><br><span class="line"></span><br><span class="line">How to: merge consecutive messages of the same type</span><br><span class="line"></span><br><span class="line">Prompt templates</span><br><span class="line"></span><br><span class="line">Prompt Templates are responsible for formatting user input into a format that can be passed to a language model.</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 3:</span><br><span class="line">How to: use few shot examples</span><br><span class="line"></span><br><span class="line">How to: use few shot examples in chat models</span><br><span class="line"></span><br><span class="line">How to: partially format prompt templates</span><br><span class="line"></span><br><span class="line">How to: compose prompts together</span><br><span class="line"></span><br><span class="line">How to: use multimodal prompts</span><br><span class="line"></span><br><span class="line">Example selectors</span><br><span class="line"></span><br><span class="line">Example Selectors are responsible for selecting the correct few shot examples to pass to the prompt.</span><br><span class="line"></span><br><span class="line">How to: use example selectors</span><br><span class="line"></span><br><span class="line">How to: select examples by length</span><br><span class="line"></span><br><span class="line">How to: select examples by semantic similarity</span><br><span class="line"></span><br><span class="line">How to: select examples by semantic ngram overlap</span><br><span class="line"></span><br><span class="line">How to: select examples by maximal marginal relevance</span><br><span class="line"></span><br><span class="line">How to: select examples from LangSmith few-shot datasets</span><br><span class="line"></span><br><span class="line">LLMs</span><br><span class="line"></span><br><span class="line">What LangChain calls LLMs are older forms of language models that take a string in and output a string.</span><br><span class="line"></span><br><span class="line">How to: cache model responses</span><br><span class="line"></span><br><span class="line">How to: create a custom LLM class</span><br><span class="line"></span><br><span class="line">How to: stream a response back</span><br><span class="line"></span><br><span class="line">How to: track token usage</span><br><span class="line"></span><br><span class="line">How to: work with local models</span><br><span class="line"></span><br><span class="line">Output parsers</span><br><span class="line"></span><br><span class="line">Output Parsers are responsible for taking the output of an LLM and parsing into more structured format.</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 4:</span><br><span class="line">How to: parse text from message objects</span><br><span class="line"></span><br><span class="line">How to: use output parsers to parse an LLM response into structured format</span><br><span class="line"></span><br><span class="line">How to: parse JSON output</span><br><span class="line"></span><br><span class="line">How to: parse XML output</span><br><span class="line"></span><br><span class="line">How to: parse YAML output</span><br><span class="line"></span><br><span class="line">How to: retry when output parsing errors occur</span><br><span class="line"></span><br><span class="line">How to: try to fix errors in output parsing</span><br><span class="line"></span><br><span class="line">How to: write a custom output parser class</span><br><span class="line"></span><br><span class="line">Document loaders</span><br><span class="line"></span><br><span class="line">Document Loaders are responsible for loading documents from a variety of sources.</span><br><span class="line"></span><br><span class="line">How to: load PDF files</span><br><span class="line"></span><br><span class="line">How to: load web pages</span><br><span class="line"></span><br><span class="line">How to: load CSV data</span><br><span class="line"></span><br><span class="line">How to: load data from a directory</span><br><span class="line"></span><br><span class="line">How to: load HTML data</span><br><span class="line"></span><br><span class="line">How to: load JSON data</span><br><span class="line"></span><br><span class="line">How to: load Markdown data</span><br><span class="line"></span><br><span class="line">How to: load Microsoft Office data</span><br><span class="line"></span><br><span class="line">How to: write a custom document loader</span><br><span class="line"></span><br><span class="line">Text splitters</span><br><span class="line"></span><br><span class="line">Text Splitters take a document and split into chunks that can be used for retrieval.</span><br><span class="line"></span><br><span class="line">How to: recursively split text</span><br><span class="line"></span><br><span class="line">How to: split HTML</span><br><span class="line"></span><br><span class="line">How to: split by character</span><br><span class="line"></span><br><span class="line">How to: split code</span><br><span class="line"></span><br><span class="line">How to: split Markdown by headers</span><br><span class="line"></span><br><span class="line">How to: recursively split JSON</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 5:</span><br><span class="line">How to: split code</span><br><span class="line"></span><br><span class="line">How to: split Markdown by headers</span><br><span class="line"></span><br><span class="line">How to: recursively split JSON</span><br><span class="line"></span><br><span class="line">How to: split text into semantic chunks</span><br><span class="line"></span><br><span class="line">How to: split by tokens</span><br><span class="line"></span><br><span class="line">Embedding models</span><br><span class="line"></span><br><span class="line">Embedding Models take a piece of text and create a numerical representation of it. See supported integrations for details on getting started with embedding models from a specific provider.</span><br><span class="line"></span><br><span class="line">How to: embed text data</span><br><span class="line"></span><br><span class="line">How to: cache embedding results</span><br><span class="line"></span><br><span class="line">How to: create a custom embeddings class</span><br><span class="line"></span><br><span class="line">Vector stores</span><br><span class="line"></span><br><span class="line">Vector stores are databases that can efficiently store and retrieve embeddings. See supported integrations for details on getting started with vector stores from a specific provider.</span><br><span class="line"></span><br><span class="line">How to: use a vector store to retrieve data</span><br><span class="line"></span><br><span class="line">Retrievers</span><br><span class="line"></span><br><span class="line">Retrievers are responsible for taking a query and returning relevant documents.</span><br><span class="line"></span><br><span class="line">How to: use a vector store to retrieve data</span><br><span class="line"></span><br><span class="line">How to: generate multiple queries to retrieve data for</span><br><span class="line"></span><br><span class="line">How to: use contextual compression to compress the data retrieved</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 6:</span><br><span class="line">How to: use contextual compression to compress the data retrieved</span><br><span class="line"></span><br><span class="line">How to: write a custom retriever class</span><br><span class="line"></span><br><span class="line">How to: add similarity scores to retriever results</span><br><span class="line"></span><br><span class="line">How to: combine the results from multiple retrievers</span><br><span class="line"></span><br><span class="line">How to: reorder retrieved results to mitigate the &quot;lost in the middle&quot; effect</span><br><span class="line"></span><br><span class="line">How to: generate multiple embeddings per document</span><br><span class="line"></span><br><span class="line">How to: retrieve the whole document for a chunk</span><br><span class="line"></span><br><span class="line">How to: generate metadata filters</span><br><span class="line"></span><br><span class="line">How to: create a time-weighted retriever</span><br><span class="line"></span><br><span class="line">How to: use hybrid vector and keyword retrieval</span><br><span class="line"></span><br><span class="line">Indexing</span><br><span class="line"></span><br><span class="line">Indexing is the process of keeping your vectorstore in-sync with the underlying data source.</span><br><span class="line"></span><br><span class="line">How to: reindex data to keep your vectorstore in-sync with the underlying data source</span><br><span class="line"></span><br><span class="line">Tools</span><br><span class="line"></span><br><span class="line">LangChain Tools contain a description of the tool (to pass to the language model) as well as the implementation of the function to call. Refer here for a list of pre-built tools.</span><br><span class="line"></span><br><span class="line">How to: create tools</span><br><span class="line"></span><br><span class="line">How to: use built-in tools and toolkits</span><br><span class="line"></span><br><span class="line">How to: use chat models to call tools</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 7:</span><br><span class="line">How to: use built-in tools and toolkits</span><br><span class="line"></span><br><span class="line">How to: use chat models to call tools</span><br><span class="line"></span><br><span class="line">How to: pass tool outputs to chat models</span><br><span class="line"></span><br><span class="line">How to: pass run time values to tools</span><br><span class="line"></span><br><span class="line">How to: add a human-in-the-loop for tools</span><br><span class="line"></span><br><span class="line">How to: handle tool errors</span><br><span class="line"></span><br><span class="line">How to: force models to call a tool</span><br><span class="line"></span><br><span class="line">How to: disable parallel tool calling</span><br><span class="line"></span><br><span class="line">How to: access the RunnableConfig from a tool</span><br><span class="line"></span><br><span class="line">How to: stream events from a tool</span><br><span class="line"></span><br><span class="line">How to: return artifacts from a tool</span><br><span class="line"></span><br><span class="line">How to: convert Runnables to tools</span><br><span class="line"></span><br><span class="line">How to: add ad-hoc tool calling capability to models</span><br><span class="line"></span><br><span class="line">How to: pass in runtime secrets</span><br><span class="line"></span><br><span class="line">Multimodal</span><br><span class="line"></span><br><span class="line">How to: pass multimodal data directly to models</span><br><span class="line"></span><br><span class="line">How to: use multimodal prompts</span><br><span class="line"></span><br><span class="line">Agents</span><br><span class="line"></span><br><span class="line">note</span><br><span class="line"></span><br><span class="line">For in depth how-to guides for agents, please check out LangGraph documentation.</span><br><span class="line"></span><br><span class="line">How to: use legacy LangChain Agents (AgentExecutor)</span><br><span class="line"></span><br><span class="line">How to: migrate from legacy LangChain agents to LangGraph</span><br><span class="line"></span><br><span class="line">Callbacks</span><br><span class="line"></span><br><span class="line">Callbacks allow you to hook into the various stages of your LLM application&#x27;s execution.</span><br><span class="line"></span><br><span class="line">How to: pass in callbacks at runtime</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 8:</span><br><span class="line">How to: pass in callbacks at runtime</span><br><span class="line"></span><br><span class="line">How to: attach callbacks to a module</span><br><span class="line"></span><br><span class="line">How to: pass callbacks into a module constructor</span><br><span class="line"></span><br><span class="line">How to: create custom callback handlers</span><br><span class="line"></span><br><span class="line">How to: use callbacks in async environments</span><br><span class="line"></span><br><span class="line">How to: dispatch custom callback events</span><br><span class="line"></span><br><span class="line">Custom</span><br><span class="line"></span><br><span class="line">All of LangChain components can easily be extended to support your own versions.</span><br><span class="line"></span><br><span class="line">How to: create a custom chat model class</span><br><span class="line"></span><br><span class="line">How to: create a custom LLM class</span><br><span class="line"></span><br><span class="line">How to: create a custom embeddings class</span><br><span class="line"></span><br><span class="line">How to: write a custom retriever class</span><br><span class="line"></span><br><span class="line">How to: write a custom document loader</span><br><span class="line"></span><br><span class="line">How to: write a custom output parser class</span><br><span class="line"></span><br><span class="line">How to: create custom callback handlers</span><br><span class="line"></span><br><span class="line">How to: define a custom tool</span><br><span class="line"></span><br><span class="line">How to: dispatch custom callback events</span><br><span class="line"></span><br><span class="line">Serialization</span><br><span class="line"></span><br><span class="line">How to: save and load LangChain objects</span><br><span class="line"></span><br><span class="line">Use cases</span><br><span class="line"></span><br><span class="line">These guides cover use-case specific details.</span><br><span class="line"></span><br><span class="line">Q&amp;A with RAG</span><br><span class="line"></span><br><span class="line">Retrieval Augmented Generation (RAG) is a way to connect LLMs to external sources of data. For a high-level tutorial on RAG, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: add chat history</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 9:</span><br><span class="line">How to: add chat history</span><br><span class="line"></span><br><span class="line">How to: stream</span><br><span class="line"></span><br><span class="line">How to: return sources</span><br><span class="line"></span><br><span class="line">How to: return citations</span><br><span class="line"></span><br><span class="line">How to: do per-user retrieval</span><br><span class="line"></span><br><span class="line">Extraction</span><br><span class="line"></span><br><span class="line">Extraction is when you use LLMs to extract structured information from unstructured text. For a high level tutorial on extraction, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: use reference examples</span><br><span class="line"></span><br><span class="line">How to: handle long text</span><br><span class="line"></span><br><span class="line">How to: do extraction without using function calling</span><br><span class="line"></span><br><span class="line">Chatbots</span><br><span class="line"></span><br><span class="line">Chatbots involve using an LLM to have a conversation. For a high-level tutorial on building chatbots, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: manage memory</span><br><span class="line"></span><br><span class="line">How to: do retrieval</span><br><span class="line"></span><br><span class="line">How to: use tools</span><br><span class="line"></span><br><span class="line">How to: manage large chat history</span><br><span class="line"></span><br><span class="line">Query analysis</span><br><span class="line"></span><br><span class="line">Query Analysis is the task of using an LLM to generate a query to send to a retriever. For a high-level tutorial on query analysis, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: add examples to the prompt</span><br><span class="line"></span><br><span class="line">How to: handle cases where no queries are generated</span><br><span class="line"></span><br><span class="line">How to: handle multiple queries</span><br><span class="line"></span><br><span class="line">How to: handle multiple retrievers</span><br><span class="line"></span><br><span class="line">How to: construct filters</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 10:</span><br><span class="line">How to: handle multiple queries</span><br><span class="line"></span><br><span class="line">How to: handle multiple retrievers</span><br><span class="line"></span><br><span class="line">How to: construct filters</span><br><span class="line"></span><br><span class="line">How to: deal with high cardinality categorical variables</span><br><span class="line"></span><br><span class="line">Q&amp;A over SQL + CSV</span><br><span class="line"></span><br><span class="line">You can use LLMs to do question answering over tabular data. For a high-level tutorial, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: use prompting to improve results</span><br><span class="line"></span><br><span class="line">How to: do query validation</span><br><span class="line"></span><br><span class="line">How to: deal with large databases</span><br><span class="line"></span><br><span class="line">How to: deal with CSV files</span><br><span class="line"></span><br><span class="line">Q&amp;A over graph databases</span><br><span class="line"></span><br><span class="line">You can use an LLM to do question answering over graph databases. For a high-level tutorial, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: add a semantic layer over the database</span><br><span class="line"></span><br><span class="line">How to: construct knowledge graphs</span><br><span class="line"></span><br><span class="line">Summarization</span><br><span class="line"></span><br><span class="line">LLMs can summarize and otherwise distill desired information from text, including large volumes of text. For a high-level tutorial, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: summarize text in a single LLM call</span><br><span class="line"></span><br><span class="line">How to: summarize text through parallelization</span><br><span class="line"></span><br><span class="line">How to: summarize text through iterative refinement</span><br><span class="line"></span><br><span class="line">LangChain Expression Language (LCEL)</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 11:</span><br><span class="line">How to: summarize text through iterative refinement</span><br><span class="line"></span><br><span class="line">LangChain Expression Language (LCEL)</span><br><span class="line"></span><br><span class="line">Should I use LCEL?</span><br><span class="line"></span><br><span class="line">LCEL is an orchestration solution. See our concepts page for recommendations on when to use LCEL.</span><br><span class="line"></span><br><span class="line">LangChain Expression Language is a way to create arbitrary custom chains. It is built on the Runnable protocol.</span><br><span class="line"></span><br><span class="line">LCEL cheatsheet: For a quick overview of how to use the main LCEL primitives.</span><br><span class="line"></span><br><span class="line">Migration guide: For migrating legacy chain abstractions to LCEL.</span><br><span class="line"></span><br><span class="line">How to: chain runnables</span><br><span class="line"></span><br><span class="line">How to: stream runnables</span><br><span class="line"></span><br><span class="line">How to: invoke runnables in parallel</span><br><span class="line"></span><br><span class="line">How to: add default invocation args to runnables</span><br><span class="line"></span><br><span class="line">How to: turn any function into a runnable</span><br><span class="line"></span><br><span class="line">How to: pass through inputs from one chain step to the next</span><br><span class="line"></span><br><span class="line">How to: configure runnable behavior at runtime</span><br><span class="line"></span><br><span class="line">How to: add message history (memory) to a chain</span><br><span class="line"></span><br><span class="line">How to: route between sub-chains</span><br><span class="line"></span><br><span class="line">How to: create a dynamic (self-constructing) chain</span><br><span class="line"></span><br><span class="line">How to: inspect runnables</span><br><span class="line"></span><br><span class="line">How to: add fallbacks to a runnable</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 12:</span><br><span class="line">How to: inspect runnables</span><br><span class="line"></span><br><span class="line">How to: add fallbacks to a runnable</span><br><span class="line"></span><br><span class="line">How to: pass runtime secrets to a runnable</span><br><span class="line"></span><br><span class="line">LangGraph</span><br><span class="line"></span><br><span class="line">LangGraph is an extension of LangChain aimed at building robust and stateful multi-actor applications with LLMs by modeling steps as edges and nodes in a graph.</span><br><span class="line"></span><br><span class="line">LangGraph documentation is currently hosted on a separate site. You can peruse LangGraph how-to guides here.</span><br><span class="line"></span><br><span class="line">LangSmith</span><br><span class="line"></span><br><span class="line">LangSmith allows you to closely trace, monitor and evaluate your LLM application. It seamlessly integrates with LangChain and LangGraph, and you can use it to inspect and debug individual steps of your chains and agents as you build.</span><br><span class="line"></span><br><span class="line">LangSmith documentation is hosted on a separate site. You can peruse LangSmith how-to guides here, but we&#x27;ll highlight a few sections that are particularly relevant to LangChain below:</span><br><span class="line"></span><br><span class="line">Evaluation</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 13:</span><br><span class="line">Evaluation</span><br><span class="line"></span><br><span class="line">Evaluating performance is a vital part of building LLM-powered applications. LangSmith helps with every step of the process from creating a dataset to defining metrics to running evaluators.</span><br><span class="line"></span><br><span class="line">To learn more, check out the LangSmith evaluation how-to guides.</span><br><span class="line"></span><br><span class="line">Tracing</span><br><span class="line"></span><br><span class="line">Tracing gives you observability inside your chains and agents, and is vital in diagnosing issues.</span><br><span class="line"></span><br><span class="line">How to: trace with LangChain</span><br><span class="line"></span><br><span class="line">How to: add metadata and tags to traces</span><br><span class="line"></span><br><span class="line">You can see general tracing-related how-tos in this section of the LangSmith docs.</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="é˜¶æ®µ2ï¼šå‘é‡å­˜å‚¨ä¸æ£€ç´¢"><a href="#é˜¶æ®µ2ï¼šå‘é‡å­˜å‚¨ä¸æ£€ç´¢" class="headerlink" title="é˜¶æ®µ2ï¼šå‘é‡å­˜å‚¨ä¸æ£€ç´¢"></a>é˜¶æ®µ2ï¼šå‘é‡å­˜å‚¨ä¸æ£€ç´¢</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> Chroma  </span><br><span class="line">   </span><br><span class="line"><span class="comment"># 5. è·å–åµŒå…¥æ¨¡å‹import os  </span></span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">embeddings = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;Qwen/Qwen3-Embedding-0.6B&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line"> <span class="comment"># 6. å‘é‡æ•°æ®å­˜å‚¨ï¼ˆé»˜è®¤å­˜å‚¨åˆ°å†…å­˜ä¸­ï¼‰  </span></span><br><span class="line">db = Chroma.from_documents(documents, embeddings)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7. å‘é‡æ£€ç´¢  </span></span><br><span class="line">retriever = db.as_retriever()  </span><br><span class="line">docs = retriever.invoke(<span class="string">&quot;what is Chat Models?&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i, doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(docs):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ” åˆ†å— <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(doc.page_content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 1:</span><br><span class="line">How to: use few shot examples</span><br><span class="line"></span><br><span class="line">How to: use few shot examples <span class="keyword">in</span> chat models</span><br><span class="line"></span><br><span class="line">How to: partially format prompt templates</span><br><span class="line"></span><br><span class="line">How to: compose prompts together</span><br><span class="line"></span><br><span class="line">How to: use multimodal prompts</span><br><span class="line"></span><br><span class="line">Example selectors</span><br><span class="line"></span><br><span class="line">Example Selectors are responsible <span class="keyword">for</span> selecting the correct few shot examples to pass to the prompt.</span><br><span class="line"></span><br><span class="line">How to: use example selectors</span><br><span class="line"></span><br><span class="line">How to: <span class="keyword">select</span> examples by length</span><br><span class="line"></span><br><span class="line">How to: <span class="keyword">select</span> examples by semantic similarity</span><br><span class="line"></span><br><span class="line">How to: <span class="keyword">select</span> examples by semantic ngram overlap</span><br><span class="line"></span><br><span class="line">How to: <span class="keyword">select</span> examples by maximal marginal relevance</span><br><span class="line"></span><br><span class="line">How to: <span class="keyword">select</span> examples from LangSmith few-shot datasets</span><br><span class="line"></span><br><span class="line">LLMs</span><br><span class="line"></span><br><span class="line">What LangChain calls LLMs are older forms of language models that take a string <span class="keyword">in</span> and output a string.</span><br><span class="line"></span><br><span class="line">How to: cache model responses</span><br><span class="line"></span><br><span class="line">How to: create a custom LLM class</span><br><span class="line"></span><br><span class="line">How to: stream a response back</span><br><span class="line"></span><br><span class="line">How to: track token usage</span><br><span class="line"></span><br><span class="line">How to: work with <span class="built_in">local</span> models</span><br><span class="line"></span><br><span class="line">Output parsers</span><br><span class="line"></span><br><span class="line">Output Parsers are responsible <span class="keyword">for</span> taking the output of an LLM and parsing into more structured format.</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 2:</span><br><span class="line">How to: summarize text through iterative refinement</span><br><span class="line"></span><br><span class="line">LangChain Expression Language (LCEL)</span><br><span class="line"></span><br><span class="line">Should I use LCEL?</span><br><span class="line"></span><br><span class="line">LCEL is an orchestration solution. See our concepts page <span class="keyword">for</span> recommendations on when to use LCEL.</span><br><span class="line"></span><br><span class="line">LangChain Expression Language is a way to create arbitrary custom chains. It is built on the Runnable protocol.</span><br><span class="line"></span><br><span class="line">LCEL cheatsheet: For a quick overview of how to use the main LCEL primitives.</span><br><span class="line"></span><br><span class="line">Migration guide: For migrating legacy chain abstractions to LCEL.</span><br><span class="line"></span><br><span class="line">How to: chain runnables</span><br><span class="line"></span><br><span class="line">How to: stream runnables</span><br><span class="line"></span><br><span class="line">How to: invoke runnables <span class="keyword">in</span> parallel</span><br><span class="line"></span><br><span class="line">How to: add default invocation args to runnables</span><br><span class="line"></span><br><span class="line">How to: turn any <span class="keyword">function</span> into a runnable</span><br><span class="line"></span><br><span class="line">How to: pass through inputs from one chain step to the next</span><br><span class="line"></span><br><span class="line">How to: configure runnable behavior at runtime</span><br><span class="line"></span><br><span class="line">How to: add message <span class="built_in">history</span> (memory) to a chain</span><br><span class="line"></span><br><span class="line">How to: route between sub-chains</span><br><span class="line"></span><br><span class="line">How to: create a dynamic (self-constructing) chain</span><br><span class="line"></span><br><span class="line">How to: inspect runnables</span><br><span class="line"></span><br><span class="line">How to: add fallbacks to a runnable</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 3:</span><br><span class="line">How to: <span class="keyword">do</span> <span class="keyword">function</span>/tool calling</span><br><span class="line"></span><br><span class="line">How to: get models to <span class="built_in">return</span> structured output</span><br><span class="line"></span><br><span class="line">How to: cache model responses</span><br><span class="line"></span><br><span class="line">How to: get <span class="built_in">log</span> probabilities</span><br><span class="line"></span><br><span class="line">How to: create a custom chat model class</span><br><span class="line"></span><br><span class="line">How to: stream a response back</span><br><span class="line"></span><br><span class="line">How to: track token usage</span><br><span class="line"></span><br><span class="line">How to: track response metadata across providers</span><br><span class="line"></span><br><span class="line">How to: use chat model to call tools</span><br><span class="line"></span><br><span class="line">How to: stream tool calls</span><br><span class="line"></span><br><span class="line">How to: handle rate limits</span><br><span class="line"></span><br><span class="line">How to: few shot prompt tool behavior</span><br><span class="line"></span><br><span class="line">How to: <span class="built_in">bind</span> model-specific formatted tools</span><br><span class="line"></span><br><span class="line">How to: force a specific tool call</span><br><span class="line"></span><br><span class="line">How to: work with <span class="built_in">local</span> models</span><br><span class="line"></span><br><span class="line">How to: init any model <span class="keyword">in</span> one line</span><br><span class="line"></span><br><span class="line">How to: pass multimodal data directly to models</span><br><span class="line"></span><br><span class="line">Messages</span><br><span class="line"></span><br><span class="line">Messages are the input and output of chat models. They have some content and a role, <span class="built_in">which</span> describes the <span class="built_in">source</span> of the message.</span><br><span class="line"></span><br><span class="line">How to: trim messages</span><br><span class="line"></span><br><span class="line">How to: filter messages</span><br><span class="line"></span><br><span class="line">How to: merge consecutive messages of the same <span class="built_in">type</span></span><br><span class="line"></span><br><span class="line">Prompt templates</span><br><span class="line"></span><br><span class="line">Prompt Templates are responsible <span class="keyword">for</span> formatting user input into a format that can be passed to a language model.</span><br><span class="line"></span><br><span class="line">ğŸ” åˆ†å— 4:</span><br><span class="line">How to: pass <span class="keyword">in</span> callbacks at runtime</span><br><span class="line"></span><br><span class="line">How to: attach callbacks to a module</span><br><span class="line"></span><br><span class="line">How to: pass callbacks into a module constructor</span><br><span class="line"></span><br><span class="line">How to: create custom callback handlers</span><br><span class="line"></span><br><span class="line">How to: use callbacks <span class="keyword">in</span> async environments</span><br><span class="line"></span><br><span class="line">How to: dispatch custom callback events</span><br><span class="line"></span><br><span class="line">Custom</span><br><span class="line"></span><br><span class="line">All of LangChain components can easily be extended to support your own versions.</span><br><span class="line"></span><br><span class="line">How to: create a custom chat model class</span><br><span class="line"></span><br><span class="line">How to: create a custom LLM class</span><br><span class="line"></span><br><span class="line">How to: create a custom embeddings class</span><br><span class="line"></span><br><span class="line">How to: write a custom retriever class</span><br><span class="line"></span><br><span class="line">How to: write a custom document loader</span><br><span class="line"></span><br><span class="line">How to: write a custom output parser class</span><br><span class="line"></span><br><span class="line">How to: create custom callback handlers</span><br><span class="line"></span><br><span class="line">How to: define a custom tool</span><br><span class="line"></span><br><span class="line">How to: dispatch custom callback events</span><br><span class="line"></span><br><span class="line">Serialization</span><br><span class="line"></span><br><span class="line">How to: save and load LangChain objects</span><br><span class="line"></span><br><span class="line">Use cases</span><br><span class="line"></span><br><span class="line">These guides cover use-case specific details.</span><br><span class="line"></span><br><span class="line">Q&amp;A with RAG</span><br><span class="line"></span><br><span class="line">Retrieval Augmented Generation (RAG) is a way to connect LLMs to external sources of data. For a high-level tutorial on RAG, check out this guide.</span><br><span class="line"></span><br><span class="line">How to: add chat <span class="built_in">history</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="é˜¶æ®µ3"><a href="#é˜¶æ®µ3" class="headerlink" title="é˜¶æ®µ3"></a>é˜¶æ®µ3</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line"><span class="comment"># 8.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">template = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">ä½ æ˜¯ä¸€ä¸ªé—®ç­”æœºå™¨äººã€‚  </span></span><br><span class="line"><span class="string">ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸‹è¿°ç»™å®šçš„å·²çŸ¥ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ã€‚  </span></span><br><span class="line"><span class="string">ç¡®ä¿ä½ çš„å›å¤å®Œå…¨ä¾æ®ä¸‹è¿°å·²çŸ¥ä¿¡æ¯ã€‚ä¸è¦ç¼–é€ ç­”æ¡ˆã€‚  </span></span><br><span class="line"><span class="string">å¦‚æœä¸‹è¿°å·²çŸ¥ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè¯·ç›´æ¥å›å¤&quot;æˆ‘æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜&quot;ã€‚  </span></span><br><span class="line"><span class="string">å·²çŸ¥ä¿¡æ¯:  </span></span><br><span class="line"><span class="string"> &#123;context&#125;ç”¨æˆ·é—®ï¼š  </span></span><br><span class="line"><span class="string">&#123;question&#125;  </span></span><br><span class="line"><span class="string">è¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·é—®é¢˜ã€‚  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line"><span class="comment"># 7.å¾—åˆ°æç¤ºè¯æ¨¡ç‰ˆå¯¹è±¡  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(template=template)  </span><br><span class="line"><span class="comment"># 8.å¾—åˆ°æç¤ºè¯å¯¹è±¡  </span></span><br><span class="line">prompt = prompt_template.invoke(&#123;<span class="string">&quot;question&quot;</span>:<span class="string">&quot;what is Chat Models?&quot;</span>,<span class="string">&quot;context&quot;</span>:docs&#125;)  </span><br><span class="line"> <span class="comment"># 9. è°ƒç”¨LLM  </span></span><br><span class="line">response = llm.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><p>ç»“æœ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®å·²çŸ¥ä¿¡æ¯ï¼Œ<span class="string">&quot;Chat Models&quot;</span>ï¼ˆèŠå¤©æ¨¡å‹ï¼‰æ˜¯LangChainä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒä»¬ä»¥**æ¶ˆæ¯**ï¼ˆMessagesï¼‰ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºã€‚æ¯æ¡æ¶ˆæ¯åŒ…å«å†…å®¹ï¼ˆcontentï¼‰å’Œè§’è‰²ï¼ˆroleï¼‰ï¼Œè§’è‰²ç”¨äºæè¿°æ¶ˆæ¯çš„æ¥æºï¼ˆä¾‹å¦‚ç”¨æˆ·ã€ç³»ç»Ÿç­‰ï¼‰ã€‚  </span><br><span class="line"></span><br><span class="line">å·²çŸ¥ä¿¡æ¯ä¸­æåˆ°ï¼š  </span><br><span class="line">- èŠå¤©æ¨¡å‹çš„è¾“å…¥è¾“å‡ºæ˜¯ç»“æ„åŒ–çš„æ¶ˆæ¯ï¼ˆè€Œéä¼ ç»ŸLLMçš„çº¯æ–‡æœ¬å­—ç¬¦ä¸²ï¼‰ã€‚  </span><br><span class="line">- æ”¯æŒé€šè¿‡æ¶ˆæ¯å¤„ç†åŠŸèƒ½ï¼ˆå¦‚åˆå¹¶è¿ç»­åŒç±»å‹æ¶ˆæ¯ã€è¿‡æ»¤æˆ–ä¿®å‰ªæ¶ˆæ¯ï¼‰ã€‚  </span><br><span class="line">- å…¶ä»–åŠŸèƒ½åŒ…æ‹¬å·¥å…·è°ƒç”¨ï¼ˆtool callingï¼‰ã€æµå¼è¿”å›å“åº”ï¼ˆstreamingï¼‰ã€è·Ÿè¸ªä»¤ç‰Œä½¿ç”¨æƒ…å†µï¼ˆtoken usageï¼‰ç­‰ã€‚  </span><br><span class="line"></span><br><span class="line">å¦‚æœéœ€è¦æ›´å…·ä½“çš„å®šä¹‰æˆ–å®ç°ç»†èŠ‚ï¼Œå½“å‰ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ã€‚</span><br></pre></td></tr></table></figure><p>èŠå¤©æ¨¡å‹ï¼ˆChat Modelsï¼‰æ˜¯æ–°å‹çš„è¯­è¨€æ¨¡å‹ï¼Œå®ƒæ¥æ”¶æ¶ˆæ¯å¹¶è¾“å‡ºæ¶ˆæ¯ã€‚è¯·æŸ¥çœ‹ç‰¹å®šæä¾›è€…çš„æ”¯æŒé›†æˆä»¥ äº†è§£å¦‚ä½•å¼€å§‹ä½¿ç”¨èŠå¤©æ¨¡å‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChainä½¿ç”¨æ¦‚è¿°</title>
      <link href="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/"/>
      <url>/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="LangChainä½¿ç”¨æ¦‚è¿°"><a href="#LangChainä½¿ç”¨æ¦‚è¿°" class="headerlink" title="LangChainä½¿ç”¨æ¦‚è¿°"></a>LangChainä½¿ç”¨æ¦‚è¿°</h1><h2 id="LangChainçš„ä½¿ç”¨åœºæ™¯"><a href="#LangChainçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="LangChainçš„ä½¿ç”¨åœºæ™¯"></a>LangChainçš„ä½¿ç”¨åœºæ™¯</h2><table><thead><tr><th>é¡¹ç›®åç§°</th><th>æŠ€æœ¯ç‚¹</th><th>éš¾åº¦</th></tr></thead><tbody><tr><td>æ–‡æ¡£é—®ç­”åŠ©æ‰‹</td><td>Prompt + Embedding + RetrievalQA</td><td>â­â­</td></tr><tr><td>æ™ºèƒ½æ—¥ç¨‹è§„åˆ’åŠ©æ‰‹</td><td>Agent + Tool + Memory</td><td>â­â­â­</td></tr><tr><td>LLM+æ•°æ®åº“é—®ç­”</td><td>SQLDatabaseToolkit + Agent</td><td>â­â­â­â­</td></tr><tr><td>å¤šæ¨¡å‹è·¯ç”±å¯¹è¯ç³»ç»Ÿ</td><td>RouterChain + å¤š LLM</td><td>â­â­â­â­</td></tr><tr><td>äº’è”ç½‘æ™ºèƒ½å®¢æœ</td><td>ConversationChain + RAG +Agent</td><td>â­â­â­â­â­</td></tr><tr><td>ä¼ä¸šçŸ¥è¯†åº“åŠ©æ‰‹ï¼ˆRAG + æœ¬åœ°æ¨¡ å‹ï¼‰</td><td>VectorDB + LLM + Streamlit</td><td>â­â­â­â­â­</td></tr></tbody></table><h2 id="LangChainèµ„æ–™ä»‹ç»"><a href="#LangChainèµ„æ–™ä»‹ç»" class="headerlink" title="LangChainèµ„æ–™ä»‹ç»"></a>LangChainèµ„æ–™ä»‹ç»</h2><ul><li><a href="https://www.langchain.com/langchain">å®˜ç½‘åœ°å€ï¼šhttps://www.langchain.com/langchain </a></li><li><a href="https://python.langchain.com/docs/introduction/">å®˜ç½‘æ–‡æ¡£ï¼šhttps://python.langchain.com/docs/introduction/ </a></li><li><a href="https://python.langchain.com/api_reference/">APIæ–‡æ¡£ï¼šhttps://python.langchain.com/api_reference&#x2F; </a></li><li><a href="https://github.com/langchain-ai/langchain">githubåœ°å€ï¼šhttps://github.com/langchain-ai/langchain</a></li></ul><h2 id="æ¶æ„è®¾è®¡"><a href="#æ¶æ„è®¾è®¡" class="headerlink" title="æ¶æ„è®¾è®¡"></a>æ¶æ„è®¾è®¡</h2><h3 id="æ€»ä½“æ¶æ„å›¾"><a href="#æ€»ä½“æ¶æ„å›¾" class="headerlink" title="æ€»ä½“æ¶æ„å›¾"></a>æ€»ä½“æ¶æ„å›¾</h3><p>V0.2 &#x2F; V0.3 ç‰ˆæœ¬<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926003401794.png" alt="file-20250926003401794.png"><br>å›¾ä¸­å±•ç¤ºäº†LangChainç”Ÿæ€ç³»ç»Ÿçš„ä¸»è¦ç»„ä»¶åŠå…¶åˆ†ç±»ï¼Œåˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼š</p><ul><li>æ¶æ„(Architecture)</li><li>ç»„ä»¶ (Components)</li><li>éƒ¨ç½²(Deployment)ã€‚</li></ul><h3 id="å†…éƒ¨æ¶æ„è¯¦æƒ…"><a href="#å†…éƒ¨æ¶æ„è¯¦æƒ…" class="headerlink" title="å†…éƒ¨æ¶æ„è¯¦æƒ…"></a>å†…éƒ¨æ¶æ„è¯¦æƒ…</h3><p><strong>ç»“æ„1ï¼šLangChain</strong> </p><p>l<strong>angchain</strong>ï¼šæ„æˆåº”ç”¨ç¨‹åºè®¤çŸ¥æ¶æ„çš„Chainsï¼ŒAgentsï¼ŒRetrieval strategiesç­‰<br>æ„æˆåº”â½¤ç¨‹åºçš„é“¾ã€æ™ºèƒ½ä½“ã€RAGã€‚ </p><p><strong>langchain-community</strong>ï¼šç¬¬ä¸‰æ–¹é›†æˆ<br>â½å¦‚ï¼šModel I&#x2F;Oã€Retrievalã€Tool &amp; Toolkitï¼›åˆä½œä¼™ä¼´åŒ… langchain-openaiï¼Œlangchain anthropicç­‰ã€‚ </p><p><strong>langchain-Core</strong>ï¼šåŸºç¡€æŠ½è±¡å’ŒLangChainè¡¨è¾¾å¼è¯­è¨€ (LCEL) </p><p>å°ç»“ï¼šLangChainï¼Œå°±æ˜¯AIåº”ç”¨ç»„è£…å¥—ä»¶ï¼Œå°è£…äº†ä¸€å †çš„APIã€‚langchainæ¡†æ¶ä¸å¤§ï¼Œä½†æ˜¯é‡Œé¢çç¢çš„çŸ¥ è¯†ç‚¹ç‰¹åˆ«å¤šã€‚å°±åƒç©ä¹é«˜ï¼Œæä¾›äº†å¾ˆå¤šæ ‡å‡†åŒ–çš„ä¹é«˜é›¶ä»¶ï¼ˆæ¯”å¦‚ï¼Œè¿æ¥å™¨ã€è½®å­ç­‰ï¼‰ </p><p><strong>ç»“æ„2ï¼šLangGraph</strong><br>LangGraphå¯ä»¥çœ‹åšåŸºäºLangChainçš„apiçš„è¿›ä¸€æ­¥å°è£…ï¼Œèƒ½å¤Ÿåè°ƒå¤šä¸ªChainã€Agentã€Toolså®Œæˆæ›´ å¤æ‚çš„ä»»åŠ¡ï¼Œå®ç°æ›´é«˜çº§çš„åŠŸèƒ½ã€‚</p><p><strong>ç»“æ„3ï¼šLangSmith</strong><br><a href="https://docs.smith.langchain.com/">https://docs.smith.langchain.com/</a> </p><p><strong>é“¾è·¯è¿½è¸ª</strong>ã€‚æä¾›äº†6å¤§åŠŸèƒ½ï¼Œæ¶‰åŠDebugging (è°ƒè¯•)ã€Playground (æ²™ç›’)ã€Prompt Management (æ ç¤ºç®¡ç†)ã€Annotation (æ³¨é‡Š)ã€Testing (æµ‹è¯•)ã€Monitoring (ç›‘æ§)ç­‰ã€‚ä¸LangChainæ— ç¼é›†æˆï¼Œå¸®åŠ©ä½  ä»åŸå‹é˜¶æ®µè¿‡æ¸¡åˆ°ç”Ÿäº§é˜¶æ®µã€‚ </p><p>æ­£æ˜¯å› ä¸ºLangSmithè¿™æ ·çš„â¼¯å…·å‡ºç°ï¼Œæ‰ä½¿å¾—LangChainæ„ä¹‰æ›´â¼¤ï¼Œè¦ä¸ä»…é â¼€äº›APIï¼ˆå½“ç„¶ä¹Ÿ å¯ä»¥ä¸â½¤ï¼Œâ½¤åŸâ½£çš„APIï¼‰ï¼Œâ½€æŒä¸ä½LangChainçš„çƒ­åº¦ã€‚ </p><p><strong>ç»“æ„4ï¼šLangServe</strong><br>å°†LangChainçš„å¯è¿è¡Œé¡¹å’Œé“¾éƒ¨ç½²ä¸ºREST APIï¼Œä½¿å¾—å®ƒä»¬å¯ä»¥é€šè¿‡ç½‘ç»œè¿›è¡Œè°ƒç”¨ã€‚<br>Javaæ€ä¹ˆè°ƒç”¨langchainå‘¢ï¼Ÿå°±é€šè¿‡è¿™ä¸ªlangserveã€‚å°†langchainåº”ç”¨åŒ…è£…æˆä¸€ä¸ªrest apiï¼Œå¯¹å¤–æš´éœ²æœ åŠ¡ã€‚åŒæ—¶ï¼Œæ”¯æŒæ›´é«˜çš„å¹¶å‘ï¼Œç¨³å®šæ€§æ›´å¥½ã€‚</p><p><strong>æ€»ç»“ï¼šLangChainå½“ä¸­ï¼Œæœ€æœ‰å‰é€”çš„ä¸¤ä¸ªæ¨¡å—å°±æ˜¯ï¼šLangGraphï¼ŒLangSmithã€‚</strong> </p><p>LangChainèƒ½åšRAGï¼Œå…¶å®ƒçš„â¼€äº›æ¡†æ¶ä¹Ÿèƒ½åšï¼Œè€Œä¸”åšçš„ä¹Ÿä¸é”™ï¼Œâ½å¦‚LlamaIndexã€‚æ‰€ä»¥è¿™æ—¶ å€™LangChainè¦åœ¨Agentè¿™å—å‘â¼’ï¼Œé‚£å°±éœ€è¦LangGraphã€‚è€ŒLangSmithï¼Œåšè¿ç»´ã€ç›‘æ§ã€‚æ•…ï¼Œ â¼†è€…æ˜¯LangChainâ¾¥æœ€æœ‰å‰é€”çš„ã€‚</p><h1 id="å¼€å‘å‰çš„å‡†å¤‡å·¥ä½œ"><a href="#å¼€å‘å‰çš„å‡†å¤‡å·¥ä½œ" class="headerlink" title="å¼€å‘å‰çš„å‡†å¤‡å·¥ä½œ"></a>å¼€å‘å‰çš„å‡†å¤‡å·¥ä½œ</h1><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><ol><li><strong>Python åŸºç¡€è¯­æ³•</strong> <ul><li>å˜é‡ã€å‡½æ•°ã€ç±»ã€è£…é¥°å™¨ã€ä¸Šä¸‹æ–‡ç®¡ç†å™¨ </li><li>æ¨¡å—å¯¼å…¥ã€åŒ…ç®¡ç†ï¼ˆæ¨èç”¨ pip æˆ– conda ï¼‰</li></ul></li><li><strong>å¤§è¯­è¨€æ¨¡å‹åŸºç¡€</strong> <ul><li>äº†è§£ä»€ä¹ˆæ˜¯ LLMã€Tokenã€Promptã€Embedding </li><li>OpenAI API æˆ–å…¶ä»–æ¨¡å‹æä¾›å•†ï¼Œå¦‚ Anthropicã€é˜¿é‡Œäº‘ç™¾ç‚¼ã€DeepSeekç­‰ </li><li>é€šè¿‡æµè§ˆå™¨æˆ–appä½¿ç”¨è¿‡å¤§æ¨¡å‹ï¼ˆæ¯”å¦‚ï¼šè±†åŒ…ã€DeepSeekç­‰ï¼‰</li></ul></li></ol><h2 id="ç›¸å…³ç¯å¢ƒå®‰è£…"><a href="#ç›¸å…³ç¯å¢ƒå®‰è£…" class="headerlink" title="ç›¸å…³ç¯å¢ƒå®‰è£…"></a>ç›¸å…³ç¯å¢ƒå®‰è£…</h2><h3 id="å®‰è£…Pythonæˆ–Anaconda"><a href="#å®‰è£…Pythonæˆ–Anaconda" class="headerlink" title="å®‰è£…Pythonæˆ–Anaconda"></a><strong>å®‰è£…Pythonæˆ–Anaconda</strong></h3><p>LangChainåŸºäºPythonå¼€å‘ï¼Œå› æ­¤éœ€ç¡®ä¿ç³»ç»Ÿä¸­å®‰è£…äº†Pythonã€‚ </p><ul><li>æ–¹å¼1ï¼šç›´æ¥ä¸‹è½½Pythonå®‰è£…åŒ…ã€‚æ¨èç‰ˆæœ¬ä¸ºPython 3.10åŠä»¥ä¸Š</li><li>æ–¹å¼2ï¼šä½¿ç”¨åŒ…ç®¡ç†å·¥å…·ï¼ˆå¦‚Anacondaï¼‰è¿›è¡Œå®‰è£…ã€‚é€šè¿‡Anacondaå¯ä»¥è½»æ¾åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿç¯å¢ƒï¼Œä¸º é¡¹ç›®æä¾›ç‹¬ç«‹çš„ä¾èµ–ç©ºé—´ï¼Œé¿å…ä¸åŒé¡¹ç›®ä¹‹é—´çš„ä¾èµ–å†²çªã€‚</li></ul><h3 id="å¦‚ä½•ä¸‹è½½å®‰è£…åŒ…"><a href="#å¦‚ä½•ä¸‹è½½å®‰è£…åŒ…" class="headerlink" title="å¦‚ä½•ä¸‹è½½å®‰è£…åŒ…"></a>å¦‚ä½•ä¸‹è½½å®‰è£…åŒ…</h3><p>æ¯”å¦‚ï¼šå®‰è£…langchainåŒ… </p><p><strong>æ–¹å¼1ï¼šä½¿ç”¨pipæŒ‡ä»¤</strong><br>åŸºç¡€æŒ‡ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…åŒ…ï¼ˆé»˜è®¤æœ€æ–°ç‰ˆï¼‰ </span></span><br><span class="line">pip install langchain </span><br><span class="line"><span class="comment"># æŒ‡å®šç‰ˆæœ¬ </span></span><br><span class="line"></span><br><span class="line">pip install langchain==0.3.7 </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¹é‡å®‰è£…ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰ </span></span><br><span class="line">pip install langchain requests numpy </span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡çº§åŒ… </span></span><br><span class="line">pip install --upgrade langchain </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸è½½åŒ… </span></span><br><span class="line">pip uninstall langchain </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·²å®‰è£…åŒ… </span></span><br><span class="line">pip list</span><br></pre></td></tr></table></figure><p>é«˜çº§æ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å›½å†…é•œåƒåŠ é€Ÿ ï¼ˆè§£å†³ä¸‹è½½æ…¢ï¼‰ -iï¼šæŒ‡å®šé•œåƒæº </span></span><br><span class="line">pip install -i https://mirrors.aliyun.com/pypi/simple/ langchain </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»æœ¬åœ°/URLå®‰è£…ï¼š </span></span><br><span class="line">pip install ./local_package.whl </span><br><span class="line">pip install https://github.com/user/repo/archive/main.zip</span><br></pre></td></tr></table></figure><p>æ–¹å¼2ï¼šä½¿ç”¨condaæŒ‡ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…åŒ…ï¼ˆé»˜è®¤ä»“åº“ï¼‰ </span></span><br><span class="line">conda install langchain </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šé¢‘é“ï¼ˆå¦‚ conda-forgeï¼‰</span></span><br><span class="line">conda install -c conda-forge langchain==0.3.7 </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°åŒ… </span></span><br><span class="line">conda update langchain </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸è½½åŒ… </span></span><br><span class="line">conda uninstall langchain </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·²å®‰è£…åŒ… </span></span><br><span class="line">conda list</span><br></pre></td></tr></table></figure><p><code>-c ï¼šæ˜¯--channel çš„ç¼©å†™ï¼Œcondaâ½¤äºæŒ‡å®šåŒ…çš„å®‰è£…æ¥æºæ¸ é“ã€‚</code><br><code>conda-forge ï¼šè¯¥æºâ½å®˜â½…é»˜è®¤æ¸ é“æ›´æ–°æ›´å¿«ã€åŒ…æ›´å…¨</code></p><p><strong>å»ºè®®ï¼šäºŒè€…æœ€å¥½ä¸å¥½æ··ç”¨ï¼Œæ¨èå…ˆcondaè£…åŸºç¡€åŒ…ï¼Œå pipè¡¥å……çš„é¡ºåºã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥åŒ…æ¥æº </span></span><br><span class="line">conda list <span class="comment"># conda å®‰è£…çš„åŒ…æ˜¾ç¤ºé¢‘é“ï¼Œpipå®‰è£…çš„æ˜¾ç¤º pypi</span></span><br></pre></td></tr></table></figure><p><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926094456875.png" alt="file-20250926094456875.png"></p><h1 id="å¤§æ¨¡å‹åº”ç”¨å¼€å‘"><a href="#å¤§æ¨¡å‹åº”ç”¨å¼€å‘" class="headerlink" title="å¤§æ¨¡å‹åº”ç”¨å¼€å‘"></a>å¤§æ¨¡å‹åº”ç”¨å¼€å‘</h1><p>å¤§æ¨¡å‹åº”ç”¨æŠ€æœ¯ç‰¹ç‚¹ï¼šé—¨æ§›ä½ï¼Œå¤©èŠ±æ¿é«˜ã€‚ </p><h2 id="åŸºäºRAGæ¶æ„çš„å¼€å‘"><a href="#åŸºäºRAGæ¶æ„çš„å¼€å‘" class="headerlink" title="åŸºäºRAGæ¶æ„çš„å¼€å‘"></a>åŸºäºRAGæ¶æ„çš„å¼€å‘</h2><p><strong>èƒŒæ™¯</strong>ï¼š </p><ul><li>å¤§æ¨¡å‹çš„çŸ¥è¯†å†»ç»“ </li><li>å¤§æ¨¡å‹å¹»è§‰<br>è€ŒRAGå°±å¯ä»¥éå¸¸ç²¾å‡†çš„è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</li></ul><h2 id="ä½•ä¸ºRAGï¼Ÿ"><a href="#ä½•ä¸ºRAGï¼Ÿ" class="headerlink" title="ä½•ä¸ºRAGï¼Ÿ"></a>ä½•ä¸ºRAGï¼Ÿ</h2><p>Retrieval-Augmented Generationï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926094734403.png" alt="file-20250926094734403.png"><br><code>æ£€ç´¢-å¢å¼º-â½£æˆè¿‡ç¨‹ï¼šæ£€ç´¢å¯ä»¥ç†è§£ä¸ºç¬¬10æ­¥ï¼Œå¢å¼ºç†è§£ä¸ºç¬¬12æ­¥ï¼ˆè¿™â¾¥çš„æâ½°è¯åŒ…å«æ£€ç´¢åˆ°çš„æ•° æ®ï¼‰ï¼Œâ½£æˆç†è§£ä¸ºç¬¬15æ­¥ã€‚</code></p><p>ç±»ä¼¼çš„ç»†èŠ‚å›¾ï¼š<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926094911845.png" alt="file-20250926094911845.png"></p><p>å¼ºè°ƒä¸€ä¸‹éš¾ç‚¹çš„æ­¥éª¤ï¼š<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926100636770.png"><br>è¿™äº›è¿‡ç¨‹ä¸­çš„éš¾ç‚¹ï¼š<br>1ã€æ–‡ä»¶è§£æ<br>2ã€æ–‡ä»¶åˆ‡å‰²<br>3ã€çŸ¥è¯†æ£€ç´¢<br>4ã€çŸ¥è¯†é‡æ’åº</p><p><strong>Rerankerçš„ä½¿ç”¨åœºæ™¯</strong>ï¼š </p><ul><li>é€‚åˆï¼šè¿½æ±‚ å›ç­”<strong>é«˜ç²¾åº¦å’Œ é«˜ç›¸å…³æ€§</strong>çš„åœºæ™¯ä¸­ç‰¹åˆ«é€‚åˆä½¿ç”¨ Rerankerï¼Œä¾‹å¦‚ä¸“ä¸šçŸ¥è¯†åº“æˆ–è€…å®¢æœç³» ç»Ÿç­‰åº”ç”¨ã€‚ </li><li>ä¸é€‚åˆï¼šå¼•å…¥rerankerä¼šå¢åŠ å¬å›æ—¶é—´ï¼Œå¢åŠ æ£€ç´¢å»¶è¿Ÿã€‚æœåŠ¡å¯¹ å“åº”æ—¶é—´è¦æ±‚é«˜æ—¶ï¼Œä½¿ç”¨reranker å¯èƒ½ä¸åˆé€‚ã€‚</li></ul><p><strong>è¿™é‡Œæœ‰ä¸‰ä¸ªä½ç½®æ¶‰åŠåˆ°å¤§æ¨¡å‹çš„ä½¿ç”¨ï¼š</strong></p><ul><li>ç¬¬3æ­¥å‘é‡åŒ–æ—¶ï¼Œéœ€è¦ä½¿ç”¨EmbeddingModelsã€‚ </li><li>ç¬¬7æ­¥é‡æ’åºæ—¶ï¼Œéœ€è¦ä½¿ç”¨RerankModelsã€‚ </li><li>ç¬¬9æ­¥ç”Ÿæˆç­”æ¡ˆæ—¶ï¼Œéœ€è¦ä½¿ç”¨LLMã€‚</li></ul><p>ChatGPTï¼šâ½€æŒçº¦8k tokençš„ä¸Šä¸‹â½‚<br>GPT4ï¼šâ½€æŒçº¦32k tokençš„ä¸Šä¸‹â½‚ </p><p>æœ€æ–°çš„å¾ˆå¤šâ¼¤æ¨¡å‹ï¼šéƒ½â½€æŒ100ä¸‡ã€1000ä¸‡ tokençš„ä¸Šä¸‹â½‚ ï¼ˆç›¸å½“äº2000ä¸‡å­—â½‚æœ¬æˆ–20å°æ—¶ è§†é¢‘ï¼‰<br>â¼€èˆ¬æƒ…å†µä¸‹æ¨¡å‹ä¸­ token å’Œå­—æ•°çš„æ¢ç®—â½ä¾‹â¼¤è‡´å¦‚ä¸‹ï¼š </p><ul><li>1 ä¸ªè‹±â½‚å­—ç¬¦ â‰ˆ 0.3 ä¸ª tokenã€‚ </li><li>1 ä¸ªä¸­â½‚å­—ç¬¦ â‰ˆ 0.6 ä¸ª tokenã€‚</li></ul><h2 id="å¦‚ä½•é€‰æ‹©"><a href="#å¦‚ä½•é€‰æ‹©" class="headerlink" title="å¦‚ä½•é€‰æ‹©"></a>å¦‚ä½•é€‰æ‹©</h2><p>é¢å¯¹ä¸€ä¸ªéœ€æ±‚ï¼Œå¦‚ä½•å¼€å§‹ï¼Œå¦‚ä½•é€‰æ‹©æŠ€æœ¯æ–¹æ¡ˆï¼Ÿä¸‹é¢æ˜¯ä¸ªå¸¸ç”¨æ€è·¯ï¼š<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926101647564.png"><br><code>æ³¨æ„ï¼šå…¶ä¸­æœ€å®¹æ˜“è¢«å¿½ç•¥çš„ï¼Œæ˜¯å‡†å¤‡æµ‹è¯•æ•°æ®</code></p><h1 id="LangChainçš„æ ¸å¿ƒç»„ä»¶"><a href="#LangChainçš„æ ¸å¿ƒç»„ä»¶" class="headerlink" title="LangChainçš„æ ¸å¿ƒç»„ä»¶"></a>LangChainçš„æ ¸å¿ƒç»„ä»¶</h1><p>å­¦ä¹ Langchainæœ€ç®€å•ç›´æ¥çš„æ–¹æ³•å°±æ˜¯é˜…è¯»å®˜æ–¹æ–‡æ¡£ã€‚<br><a href="https://python.langchain.com/v0.1/docs/modules/">https://python.langchain.com/v0.1/docs/modules/</a></p><h2 id="ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ"><a href="#ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ" class="headerlink" title="ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ"></a>ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ</h2><p><strong>å¦‚æœè¦ç»„ç»‡ä¸€ä¸ªAIåº”ç”¨ï¼Œå¼€å‘è€…ä¸€èˆ¬éœ€è¦ä»€ä¹ˆï¼Ÿ</strong> </p><ol><li>æç¤ºè¯æ¨¡æ¿çš„æ„å»ºï¼Œä¸ä»…ä»…åªåŒ…å«ç”¨æˆ·è¾“å…¥ã€‚ </li><li>æ¨¡å‹è°ƒç”¨ä¸è¿”å›ï¼Œå‚æ•°è®¾ç½®ï¼Œè¿”å›å†…å®¹çš„æ ¼å¼åŒ–è¾“å‡ºã€‚ </li><li>çŸ¥è¯†åº“æŸ¥è¯¢ï¼Œè¿™é‡Œä¼šåŒ…å«æ–‡æ¡£åŠ è½½ï¼Œåˆ‡å‰²ï¼Œä»¥åŠè½¬åŒ–ä¸ºè¯åµŒå…¥ï¼ˆEmbeddingï¼‰å‘é‡ã€‚ </li><li>å…¶ä»–ç¬¬ä¸‰æ–¹å·¥å…·è°ƒç”¨ï¼Œä¸€èˆ¬åŒ…å«å¤©æ°”æŸ¥è¯¢ã€Googleæœç´¢ã€ä¸€äº›è‡ªå®šä¹‰çš„æ¥å£èƒ½åŠ›è°ƒç”¨ã€‚ </li><li>è®°å¿†è·å–ï¼Œæ¯ä¸€ä¸ªå¯¹è¯éƒ½æœ‰ä¸Šä¸‹æ–‡ï¼Œåœ¨å¼€å¯å¯¹è¯ä¹‹å‰æ€»å¾—è·å–åˆ°ä¹‹å‰çš„ä¸Šä¸‹æ–‡å§ï¼Ÿ</li></ol><h2 id="æ ¸å¿ƒç»„ä»¶çš„æ¦‚è¿°"><a href="#æ ¸å¿ƒç»„ä»¶çš„æ¦‚è¿°" class="headerlink" title="æ ¸å¿ƒç»„ä»¶çš„æ¦‚è¿°"></a>æ ¸å¿ƒç»„ä»¶çš„æ¦‚è¿°</h2><p>LangChainçš„æ ¸å¿ƒç»„ä»¶æ¶‰åŠå…­å¤§æ¨¡å—ï¼Œè¿™å…­å¤§æ¨¡å—æä¾›äº†ä¸€ä¸ªå…¨é¢ä¸”å¼ºå¤§çš„æ¡†æ¶ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿåˆ›å»ºå¤ æ‚ã€é«˜æ•ˆä¸”ç”¨æˆ·å‹å¥½çš„åŸºäºå¤§æ¨¡å‹çš„åº”ç”¨ã€‚</p><p><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926102039819.png"></p><h2 id="æ ¸å¿ƒç»„ä»¶çš„è¯´æ˜"><a href="#æ ¸å¿ƒç»„ä»¶çš„è¯´æ˜" class="headerlink" title="æ ¸å¿ƒç»„ä»¶çš„è¯´æ˜"></a>æ ¸å¿ƒç»„ä»¶çš„è¯´æ˜</h2><h3 id="æ ¸å¿ƒç»„ä»¶1ï¼šModel-I-O"><a href="#æ ¸å¿ƒç»„ä»¶1ï¼šModel-I-O" class="headerlink" title="æ ¸å¿ƒç»„ä»¶1ï¼šModel I&#x2F;O"></a>æ ¸å¿ƒç»„ä»¶1ï¼šModel I&#x2F;O</h3><p>è¿™ä¸ªæ¨¡å—ä½¿â½¤æœ€å¤šï¼Œä¹Ÿæœ€ç®€å•<br>Model I&#x2F;Oï¼šæ ‡å‡†åŒ–å„ä¸ªå¤§æ¨¡å‹çš„è¾“å…¥å’Œè¾“å‡ºï¼ŒåŒ…å«è¾“å…¥æ¨¡ç‰ˆï¼Œæ¨¡å‹æœ¬èº«å’Œæ ¼å¼åŒ–è¾“å‡ºã€‚ ä»¥ä¸‹æ˜¯ä½¿ç”¨è¯­è¨€æ¨¡å‹ä»è¾“å…¥åˆ°è¾“å‡ºçš„åŸºæœ¬æµç¨‹ã€‚<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926102157179.png"></p><p>ä»¥ä¸‹æ˜¯å¯¹æ¯ä¸€å—çš„æ€»ç»“ï¼š </p><ul><li><strong>Format(æ ¼å¼åŒ–)</strong> ï¼šå³æŒ‡ä»£Prompts Templateï¼Œé€šè¿‡æ¨¡æ¿ç®¡ç†å¤§æ¨¡å‹çš„è¾“å…¥ã€‚å°†åŸå§‹æ•°æ®æ ¼å¼åŒ–æˆ æ¨¡å‹å¯ä»¥å¤„ç†çš„å½¢å¼ï¼Œæ’å…¥åˆ°ä¸€ä¸ªæ¨¡æ¿é—®é¢˜ä¸­ï¼Œç„¶åé€å…¥æ¨¡å‹è¿›è¡Œå¤„ç†ã€‚</li><li><strong>Predict(é¢„æµ‹)</strong> ï¼šå³æŒ‡ä»£Modelsï¼Œä½¿ç”¨é€šç”¨æ¥å£è°ƒç”¨ä¸åŒçš„å¤§è¯­è¨€æ¨¡å‹ã€‚æ¥å—è¢«é€è¿›æ¥çš„é—®é¢˜ï¼Œç„¶ ååŸºäºè¿™ä¸ªé—®é¢˜è¿›è¡Œé¢„æµ‹æˆ–ç”Ÿæˆå›ç­”ã€‚</li><li><strong>Parse(ç”Ÿæˆ)</strong> ï¼šå³æŒ‡ä»£Output Parser éƒ¨åˆ†ï¼Œç”¨æ¥ä»æ¨¡å‹çš„æ¨ç†ä¸­æå–ä¿¡æ¯ï¼Œå¹¶æŒ‰ç…§é¢„å…ˆè®¾å®šå¥½çš„ æ¨¡ç‰ˆæ¥è§„èŒƒåŒ–è¾“å‡ºã€‚æ¯”å¦‚ï¼Œæ ¼å¼åŒ–æˆä¸€ä¸ªç»“æ„åŒ–çš„JSONå¯¹è±¡ã€‚</li></ul><h3 id="æ ¸å¿ƒç»„ä»¶2ï¼šChains"><a href="#æ ¸å¿ƒç»„ä»¶2ï¼šChains" class="headerlink" title="æ ¸å¿ƒç»„ä»¶2ï¼šChains"></a>æ ¸å¿ƒç»„ä»¶2ï¼šChains</h3><p>Chainï¼šâ€é“¾æ¡â€ï¼Œç”¨äºå°†å¤šä¸ªæ¨¡å—ä¸²è”èµ·æ¥ç»„æˆä¸€ä¸ªå®Œæ•´çš„æµç¨‹ï¼Œæ˜¯ LangChain æ¡†æ¶ä¸­æœ€é‡è¦çš„æ¨¡å—ã€‚<br>ä¾‹å¦‚ï¼Œä¸€ä¸ª Chain å¯èƒ½åŒ…æ‹¬ä¸€ä¸ª Prompt æ¨¡æ¿ã€ä¸€ä¸ªè¯­è¨€æ¨¡å‹å’Œä¸€ä¸ªè¾“å‡ºè§£æå™¨ï¼Œå®ƒä»¬ä¸€èµ·å·¥ä½œä»¥å¤„ç† ç”¨æˆ·è¾“å…¥ã€ç”Ÿæˆå“åº”å¹¶å¤„ç†è¾“å‡ºã€‚</p><p><strong>å¸¸è§çš„Chainç±»å‹ï¼š</strong> </p><ul><li><strong>LLMChain</strong> ï¼šæœ€åŸºç¡€çš„æ¨¡å‹è°ƒç”¨é“¾ </li><li><strong>SequentialChain</strong> ï¼šå¤šä¸ªé“¾ä¸²è”æ‰§è¡Œ </li><li><strong>RouterChain</strong> ï¼šè‡ªåŠ¨åˆ†æç”¨æˆ·çš„éœ€æ±‚ï¼Œå¼•å¯¼åˆ°æœ€é€‚åˆçš„é“¾ </li><li><strong>RetrievalQA</strong> ï¼šç»“åˆå‘é‡æ•°æ®åº“è¿›è¡Œé—®ç­”çš„é“¾</li></ul><h3 id="æ ¸å¿ƒç»„ä»¶3ï¼šMemory"><a href="#æ ¸å¿ƒç»„ä»¶3ï¼šMemory" class="headerlink" title="æ ¸å¿ƒç»„ä»¶3ï¼šMemory"></a>æ ¸å¿ƒç»„ä»¶3ï¼šMemory</h3><p>Memoryï¼šè®°å¿†æ¨¡å—ï¼Œç”¨äºä¿å­˜å¯¹è¯å†å²æˆ–ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨åç»­å¯¹è¯ä¸­ä½¿ç”¨ã€‚<br><strong>å¸¸è§çš„ Memory ç±»å‹ï¼š</strong> </p><ul><li><strong>ConversationBufferMemory</strong> ï¼šä¿å­˜å®Œæ•´çš„å¯¹è¯å†å² </li><li><strong>ConversationSummaryMemory</strong> ï¼šä¿å­˜å¯¹è¯å†…å®¹çš„ç²¾ç®€æ‘˜è¦ï¼ˆé€‚åˆé•¿å¯¹è¯ï¼‰ </li><li><strong>ConversationSummaryBufferMemory</strong> ï¼šæ··åˆå‹è®°å¿†æœºåˆ¶ï¼Œå…¼å…·ä¸Šé¢ä¸¤ä¸ªç±»å‹çš„ç‰¹ç‚¹</li><li><strong>VectorStoreRetrieverMemory</strong> ï¼šä¿å­˜å¯¹è¯å†å²å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ä¸­</li></ul><h3 id="æ ¸å¿ƒç»„ä»¶4ï¼šAgents"><a href="#æ ¸å¿ƒç»„ä»¶4ï¼šAgents" class="headerlink" title="æ ¸å¿ƒç»„ä»¶4ï¼šAgents"></a>æ ¸å¿ƒç»„ä»¶4ï¼šAgents</h3><p>Agentsï¼Œå¯¹åº”ç€æ™ºèƒ½ä½“ï¼Œæ˜¯ LangChain çš„é«˜é˜¶èƒ½åŠ›ï¼Œå®ƒå¯ä»¥è‡ªä¸»é€‰æ‹©å·¥å…·å¹¶è§„åˆ’æ‰§è¡Œæ­¥éª¤ã€‚<br><strong>Agent çš„å…³é”®ç»„æˆ</strong>ï¼š </p><ul><li><strong>AgentType</strong> ï¼šå®šä¹‰å†³ç­–é€»è¾‘çš„å·¥ä½œæµæ¨¡å¼ </li><li><strong>Tool</strong> ï¼šæ˜¯ä¸€äº›å†…ç½®çš„åŠŸèƒ½æ¨¡å—ï¼Œå¦‚APIè°ƒç”¨ã€æœç´¢å¼•æ“ã€æ–‡æœ¬å¤„ç†ã€æ•°æ®æŸ¥è¯¢ç­‰å·¥å…·ã€‚Agentsé€š è¿‡è¿™äº›å·¥å…·æ¥æ‰§è¡Œç‰¹å®šçš„åŠŸèƒ½ã€‚ </li><li><strong>AgentExecutor</strong> ï¼šç”¨æ¥è¿è¡Œæ™ºèƒ½ä½“å¹¶æ‰§è¡Œå…¶å†³ç­–çš„å·¥å…·ï¼Œè´Ÿè´£åè°ƒæ™ºèƒ½ä½“çš„å†³ç­–å’Œå®é™…çš„å·¥å…·æ‰§ è¡Œã€‚</li></ul><p><code>â½¬å‰æœ€çƒ­â»”çš„æ™ºèƒ½ä½“å¼€å‘å®è·µï¼Œæœªæ¥èƒ½å¤ŸçœŸæ­£å®ç°é€šâ½¤â¼ˆâ¼¯æ™ºèƒ½çš„è½åœ°â½…æ¡ˆã€‚</code><br>&#96;è¿™â¾¥çš„Agentï¼Œå°±ä¼šæ¶‰åŠåˆ°å‰â¾¯è®²çš„memoryï¼Œä»¥åŠtoolsã€‚</p><h3 id="æ ¸å¿ƒç»„ä»¶5ï¼šRetrieval"><a href="#æ ¸å¿ƒç»„ä»¶5ï¼šRetrieval" class="headerlink" title="æ ¸å¿ƒç»„ä»¶5ï¼šRetrieval"></a>æ ¸å¿ƒç»„ä»¶5ï¼šRetrieval</h3><p>Retrievalï¼šå¯¹åº”ç€RAGï¼Œæ£€ç´¢å¤–éƒ¨æ•°æ®ï¼Œç„¶ååœ¨æ‰§è¡Œç”Ÿæˆæ­¥éª¤æ—¶å°†å…¶ä¼ é€’åˆ° LLMã€‚æ­¥éª¤åŒ…æ‹¬æ–‡æ¡£åŠ è½½ã€ åˆ‡å‰²ã€Embeddingç­‰<br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926102816605.png"></p><ul><li><strong>Source</strong> ï¼šæ•°æ®æºï¼Œå³å¤§æ¨¡å‹å¯ä»¥è¯†åˆ«çš„å¤šç§ç±»å‹çš„æ•°æ®ï¼šè§†é¢‘ã€å›¾ç‰‡ã€æ–‡æœ¬ã€ä»£ç ã€æ–‡æ¡£ç­‰ã€‚</li><li><strong>Load</strong> ï¼šè´Ÿè´£å°†æ¥è‡ªä¸åŒæ•°æ®æºçš„éç»“æ„åŒ–æ•°æ®ï¼ŒåŠ è½½ä¸ºæ–‡æ¡£(Document)å¯¹è±¡ </li><li><strong>Transform</strong> ï¼šè´Ÿè´£å¯¹åŠ è½½çš„æ–‡æ¡£è¿›è¡Œè½¬æ¢å’Œå¤„ç†ï¼Œæ¯”å¦‚å°†æ–‡æœ¬æ‹†åˆ†ä¸ºå…·æœ‰è¯­ä¹‰æ„ä¹‰çš„å°å—ã€‚</li><li><strong>Embed</strong> ï¼šå°†æ–‡æœ¬ç¼–ç ä¸ºå‘é‡çš„èƒ½åŠ›ã€‚ä¸€ç§ç”¨äºåµŒå…¥æ–‡æ¡£ï¼Œå¦ä¸€ç§ç”¨äºåµŒå…¥æŸ¥è¯¢ </li><li><strong>Store</strong> ï¼šå°†å‘é‡åŒ–åçš„æ•°æ®è¿›è¡Œå­˜å‚¨ </li><li><strong>Retrieve</strong> ï¼šä»å¤§è§„æ¨¡æ–‡æœ¬åº“ä¸­æ£€ç´¢å’ŒæŸ¥è¯¢ç›¸å…³çš„æ–‡æœ¬æ®µè½</li></ul><p><code>ç»¿â¾Šçš„æ˜¯â¼Šåº“å­˜å‚¨å‰çš„æ“ä½œã€‚</code></p><h3 id="æ ¸å¿ƒç»„ä»¶6ï¼šCallbacks"><a href="#æ ¸å¿ƒç»„ä»¶6ï¼šCallbacks" class="headerlink" title="æ ¸å¿ƒç»„ä»¶6ï¼šCallbacks"></a>æ ¸å¿ƒç»„ä»¶6ï¼šCallbacks</h3><p>Callbacksï¼šå›è°ƒæœºåˆ¶ï¼Œå…è®¸è¿æ¥åˆ° LLM åº”ç”¨ç¨‹åºçš„å„ä¸ªé˜¶æ®µï¼Œå¯ä»¥ç›‘æ§å’Œåˆ†æLangChainçš„è¿è¡Œæƒ… å†µï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€ç›‘æ§ã€æµä¼ è¾“ç­‰ï¼Œä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</p><p><code>å›è°ƒå‡½æ•°ï¼Œå¯¹äºç¨‹åºå‘˜ä»¬åº”è¯¥éƒ½ä¸é™Œâ½£ã€‚è¿™ä¸ªå‡½æ•°å…è®¸æˆ‘ä»¬åœ¨LLMçš„å„ä¸ªé˜¶æ®µä½¿â½¤å„ç§å„æ ·çš„ â€œé’©â¼¦â€ï¼Œä»è€Œè¾¾å®ç°â½‡å¿—çš„è®°å½•ã€ç›‘æ§ä»¥åŠæµå¼ä¼ è¾“ç­‰åŠŸèƒ½ã€‚</code></p><h1 id="LangChainçš„helloworld"><a href="#LangChainçš„helloworld" class="headerlink" title="LangChainçš„helloworld"></a>LangChainçš„helloworld</h1><h2 id="è·å–å¤§æ¨¡å‹"><a href="#è·å–å¤§æ¨¡å‹" class="headerlink" title="è·å–å¤§æ¨¡å‹"></a>è·å–å¤§æ¨¡å‹</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¯¼å…¥ dotenv åº“çš„ load_dotenv å‡½æ•°ï¼Œç”¨äºåŠ è½½ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆ.envï¼‰ä¸­çš„é…ç½®</span></span><br><span class="line"><span class="keyword">import</span> dotenv <span class="keyword">from</span> langchain_openai </span><br><span class="line"><span class="keyword">import</span> ChatOpenAI <span class="keyword">import</span> os </span><br><span class="line"></span><br><span class="line">dotenv.load_dotenv() <span class="comment">#åŠ è½½å½“å‰ç›®å½•ä¸‹çš„ .env æ–‡ä»¶ </span></span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY1&quot;</span> )</span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) <span class="comment"># é»˜è®¤ä½¿ç”¨ gpt-3.5-turbo </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›´æ¥æä¾›é—®é¢˜ï¼Œå¹¶è°ƒç”¨llm </span></span><br><span class="line">response = llm.invoke( <span class="string">&quot;ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹ï¼Ÿ&quot;</span> ) </span><br><span class="line"><span class="built_in">print</span> (response)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content=â¼¤æ¨¡å‹ï¼ˆLarge Modelï¼‰é€šå¸¸æ˜¯æŒ‡åœ¨æ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ é¢†åŸŸä¸­ï¼Œæ‹¥æœ‰â¼¤é‡å‚æ•°å’Œå¤æ‚ ç»“æ„çš„æ¨¡å‹ã€‚è¿™äº›æ¨¡å‹å¯ä»¥å¤„ç†å¤æ‚çš„æ•°æ®é›†ï¼Œè¿›â¾â¾¼çº§çš„ä»»åŠ¡ï¼Œå¦‚â¾ƒç„¶è¯­â¾”å¤„ç†ã€å›¾åƒè¯†åˆ«ã€â½£ æˆå¯¹æŠ—â½¹ç»œç­‰ã€‚ä»¥ä¸‹æ˜¯â¼€äº›å…³äºâ¼¤æ¨¡å‹çš„å…³é”®ç‚¹ï¼š\n\n1. å‚æ•°é‡ï¼šâ¼¤æ¨¡å‹é€šå¸¸å…·å¤‡æ•°äº¿ç”šâ¾„æ•°åƒäº¿ ä¸ªå‚æ•°ï¼Œè¿™ä½¿å¾—å®ƒä»¬èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´åŠ ä¸°å¯Œçš„ç‰¹å¾å’Œå…³ç³»ã€‚\n\n2. è®¡ç®—éœ€æ±‚ï¼šç”±äºå…¶åºâ¼¤çš„è§„æ¨¡ï¼Œâ¼¤ æ¨¡å‹é€šå¸¸éœ€è¦â¾¼æ€§èƒ½çš„è®¡ç®—èµ„æºï¼Œä¾‹å¦‚GPUæˆ–TPUï¼Œä»¥åŠâ»“æ—¶é—´çš„è®­ç»ƒè¿‡ç¨‹ã€‚\n\n3. æ•°æ®éœ€æ±‚ï¼š è®­ç»ƒâ¼¤æ¨¡å‹é€šå¸¸éœ€è¦â¼¤é‡çš„æ•°æ®ï¼Œä»¥ç¡®ä¿æ¨¡å‹èƒ½å¤Ÿåœ¨å„ç§æƒ…å†µä¸‹è¿›â¾æœ‰æ•ˆçš„å­¦ä¹ å’Œæ³›åŒ–ã€‚\n\n4. åº” â½¤â¼´æ³›ï¼šâ¼¤æ¨¡å‹åœ¨è®¸å¤šé¢†åŸŸéƒ½æœ‰åº”â½¤ï¼ŒåŒ…æ‹¬è¯­â¾”æ¨¡å‹ï¼ˆå¦‚GPT-3ã€BERTç­‰ï¼‰ã€å›¾åƒå¤„ç†ï¼ˆå¦‚å·ç§¯ ç¥ç»â½¹ç»œï¼‰ä»¥åŠâ½£æˆæ¨¡å‹ï¼ˆå¦‚GANï¼‰ã€‚\n\n5. è½¬ç§»å­¦ä¹ ï¼šè®¸å¤šâ¼¤æ¨¡å‹å…è®¸é€šè¿‡è½¬ç§»å­¦ä¹ çš„â½…å¼è¿› â¾å¾®è°ƒï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿåœ¨ç‰¹å®šä»»åŠ¡ä¸Šè¡¨ç°è‰¯å¥½ï¼Œè€Œâ½†éœ€ä»å¤´å¼€å§‹è®­ç»ƒã€‚\n\nâ¼¤æ¨¡å‹çš„å‡ºç°â¼¤â¼¤æ¨åŠ¨ äº†â¼ˆâ¼¯æ™ºèƒ½çš„å‘å±•ï¼Œä½¿å¾—è®¸å¤šå¤æ‚çš„ä»»åŠ¡å˜å¾—å¯â¾ï¼Œå¹¶ä¸”åœ¨å¤šä¸ªé¢†åŸŸå–å¾—äº†æ˜¾è‘—çš„æˆæœã€‚<span class="string">&#x27; additional_kwargs=&#123;refusal: None&#125; response_metadata=&#123;token_usage: &#123;completion_tokens: 289, prompt_tokens: 12, total_tokens: 301, completion_tokens_details: &#123;accepted_prediction_tokens: 0, audio_tokens: 0, reasoning_tokens: 0, rejected_prediction_tokens: 0&#125;, prompt_tokens_details: &#123;audio_tokens: 0, cached_tokens: 0&#125;&#125;, model_name: gpt-4o-mini-2024-07-18, system_fingerprint: fp_efad92c60b, id: chatcmpl-BxO81Kq8FpSQgLyTikWfGzOlry2MF, service_tier: None, finish_reason: stop, logprobs: None&#125; id=run--134748c7-8c54-4784 8781-6ea143086285-0 usage_metadata=&#123;input_tokens: 12, output_tokens: 289, total_tokens: 301, input_token_details: &#123;audio: 0, cache_read: 0&#125;, output_token_details: &#123;audio: 0, reasoning: 0&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œéœ€è¦åœ¨å½“å‰å·¥ç¨‹ä¸‹æä¾› .env æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­æä¾›å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPENAI_API_KEY1= &quot;sk-cvUm8OddQbly.............AGgIHTm9kMH7Bf226G2&quot; #ä½ è‡ªå·±çš„å¯†é’¥ OPENAI_BASE_URL= &quot;https://api.siliconflow.cn/v1&quot;     #urlæ˜¯å›ºå®šå€¼ï¼Œç»Ÿä¸€å†™æˆè¿™æ ·</span><br></pre></td></tr></table></figure><p>å¯†é’¥æ¥è‡ªäºï¼š<a href="https://cloud.siliconflow.cn/i/iICxcKiF">https://cloud.siliconflow.cn/i/iICxcKiF</a><br><img src="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/file-20250926104121004.png"></p><h2 id="ä½¿ç”¨æç¤ºè¯æ¨¡æ¿"><a href="#ä½¿ç”¨æç¤ºè¯æ¨¡æ¿" class="headerlink" title="ä½¿ç”¨æç¤ºè¯æ¨¡æ¿"></a>ä½¿ç”¨æç¤ºè¯æ¨¡æ¿</h2><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºprompt template, å¹¶å¼•å…¥ä¸€äº›å˜é‡åˆ°prompt templateä¸­ï¼Œè¿™æ ·åœ¨åº”ç”¨çš„æ—¶å€™æ›´åŠ çµ æ´»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate </span><br><span class="line"></span><br><span class="line"><span class="comment"># éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™é‡Œéœ€è¦æŒ‡æ˜å…·ä½“çš„roleï¼Œåœ¨è¿™é‡Œæ˜¯systemå’Œç”¨æˆ· </span></span><br><span class="line">prompt = ChatPromptTemplate.from_messages([</span><br><span class="line">(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;ä½ æ˜¯ä¸–ç•Œçº§çš„æŠ€æœ¯æ–‡æ¡£ç¼–å†™è€…&quot;</span>),</span><br><span class="line">(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;&#123;input&#125;&quot;</span>) <span class="comment"># &#123;input&#125;ä¸ºå˜é‡ </span></span><br><span class="line">]) </span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ‘ä»¬å¯ä»¥æŠŠpromptå’Œå…·ä½“llmçš„è°ƒç”¨å’Œåœ¨ä¸€èµ·ã€‚ </span></span><br><span class="line">chain = prompt | llm </span><br><span class="line">message = chain.invoke(&#123; <span class="string">&quot;input&quot;</span> : <span class="string">&quot;å¤§æ¨¡å‹ä¸­çš„LangChainæ˜¯ä»€ä¹ˆ?&quot;</span> &#125;) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (message) </span><br><span class="line"><span class="comment"># print(type(message))</span></span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">LangChainæ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œæ—¨åœ¨ç®€åŒ–å’Œå¢å¼ºå¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚GPT-3ã€GPT-4 ç­‰ï¼‰çš„å¼€å‘ä¸åº” ç”¨ã€‚å®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€å¥—å·¥å…·å’Œç»„ä»¶ï¼Œä½¿å¾—åœ¨ä¸åŒçš„ç”¨ä¾‹ä¸­åˆ©ç”¨è¯­è¨€æ¨¡å‹å˜å¾—æ›´åŠ é«˜æ•ˆå’Œçµ æ´»ã€‚LangChain çš„å…¨åæ˜¯â€œLanguage Chainâ€ï¼Œæ„åœ¨å¼ºè°ƒå®ƒå°†å¤šä¸ªå¤„ç†æ­¥éª¤æˆ–ç»„ä»¶ä¸²è”åœ¨ä¸€ èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å¤„ç†é“¾ï¼Œä»¥ä¾¿æ›´å¥½åœ°åˆ©ç”¨è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ã€‚ </span><br><span class="line">### LangChain çš„ä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š</span><br><span class="line"> </span><br><span class="line"> 1. **ç»„ä»¶åŒ–è®¾è®¡**ï¼šLangChain æä¾›äº†é«˜åº¦æ¨¡å—åŒ–çš„ç»„ä»¶ï¼Œå…è®¸å¼€å‘è€…æ ¹æ®éœ€è¦ç»„åˆå’Œæ‰©å±•ä¸åŒ çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ–‡æœ¬ç”Ÿæˆã€æ•°æ®æå–ã€å·¥å…·è°ƒç”¨ç­‰ã€‚ </span><br><span class="line">2. **é“¾å¼è°ƒç”¨**ï¼šå¯ä»¥å°†å¤šä¸ªæ“ä½œä¸²è”åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚å…ˆç”Ÿæˆæ–‡æœ¬ï¼Œç„¶åå¯¹ç”Ÿæˆçš„å†…å®¹è¿›è¡Œè§£ææˆ–å¤„ ç†ï¼Œä½¿å¾—å·¥ä½œæµç¨‹æ›´åŠ æµç•…ã€‚ </span><br><span class="line">3. **å¤šç§åç«¯æ”¯æŒ**ï¼šLangChain æ”¯æŒå¤šç§è¯­è¨€æ¨¡å‹å’Œç”Ÿæˆåç«¯ï¼Œæ–¹ä¾¿å¼€å‘è€…åœ¨ä¸åŒçš„å¹³å°å’Œç¯ å¢ƒä¸‹è¿›è¡Œå¼€å‘ã€‚ </span><br><span class="line">4. **é›†æˆå¤–éƒ¨å·¥å…·**ï¼šLangChain å…è®¸ä¸å¤–éƒ¨APIã€æ•°æ®åº“å’Œå…¶ä»–å·¥å…·é›†æˆï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥åˆ©ç”¨å¤– éƒ¨æ•°æ®æºå’ŒåŠŸèƒ½ï¼Œå¢å¼ºå…¶æ™ºèƒ½æ€§å’Œå®ç”¨æ€§ã€‚</span><br><span class="line">5. **å¯æ‰©å±•æ€§**ï¼šå¼€å‘è€…å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ç»„ä»¶å’Œæ–¹æ³•ï¼Œæ‰©å±• LangChain çš„åŠŸèƒ½ï¼Œä»¥é€‚åº”ç‰¹å®šçš„ä¸š åŠ¡éœ€æ±‚ã€‚</span><br><span class="line">   </span><br><span class="line">### åº”ç”¨åœºæ™¯ï¼š </span><br><span class="line">- **å¯¹è¯ç³»ç»Ÿ**ï¼šæ„å»ºæ›´æ™ºèƒ½çš„èŠå¤©æœºå™¨äººï¼Œèƒ½å¤Ÿç†è§£ä¸Šä¸‹æ–‡å¹¶è¿›è¡Œå¤šè½®å¯¹è¯ã€‚</span><br><span class="line">- **å†…å®¹ç”Ÿæˆ**ï¼šç”Ÿæˆæ–‡ç« ã€æ•…äº‹ã€äº§å“æè¿°ç­‰å¤šç§å†…å®¹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œç¼–è¾‘å’Œä¼˜åŒ–ã€‚</span><br><span class="line">- **æ•°æ®æå–å’Œå¤„ç†**ï¼šä»å¤§é‡æ–‡æœ¬ä¸­æå–å…³é”®ä¿¡æ¯ï¼Œå¹¶å°†å…¶ç»“æ„åŒ–ã€‚</span><br><span class="line">- **çŸ¥è¯†åº“æŸ¥è¯¢**ï¼šç»“åˆè¯­è¨€æ¨¡å‹ä¸çŸ¥è¯†åº“ï¼Œæä¾›æ·±åº¦çš„çŸ¥è¯†æŸ¥è¯¢å’Œæ¨èã€‚ æ€»ä¹‹ï¼ŒLangChain ä½œä¸ºå¤§æ¨¡å‹åº”ç”¨çš„ä¸€ä¸ªåŠ©æ‰‹å·¥å…·ï¼Œæå‡äº†å¼€å‘è€…çš„ç”Ÿäº§åŠ›ï¼Œä½¿å¾—ä»–ä»¬å¯ä»¥æ›´ä¸“ æ³¨äºæ„å»ºåˆ›æ–°çš„åº”ç”¨ï¼Œè€Œä¸æ˜¯é™·å…¥åº•å±‚å®ç°çš„å¤æ‚æ€§ä¸­ã€‚</span><br><span class="line"># &lt;class &#x27;langchain_core.messages.ai.AIMessage&#x27;&gt;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨è¾“å‡ºè§£æå™¨"><a href="#ä½¿ç”¨è¾“å‡ºè§£æå™¨" class="headerlink" title="ä½¿ç”¨è¾“å‡ºè§£æå™¨"></a>ä½¿ç”¨è¾“å‡ºè§£æå™¨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai </span><br><span class="line"><span class="keyword">import</span> ChatOpenAI </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate </span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser,JsonOutputParser </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–æ¨¡å‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæç¤ºæ¨¡æ¿ </span></span><br><span class="line">prompt = ChatPromptTemplate.from_messages([</span><br><span class="line">(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;ä½ æ˜¯ä¸–ç•Œçº§çš„æŠ€æœ¯æ–‡æ¡£ç¼–å†™è€…&quot;</span>),</span><br><span class="line">(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;&#123;input&#125;&quot;</span>) <span class="comment"># &#123;input&#125;ä¸ºå˜é‡ </span></span><br><span class="line">])  </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨è¾“å‡ºè§£æå™¨ </span></span><br><span class="line"><span class="comment"># output_parser = StrOutputParser() </span></span><br><span class="line">output_parser = JsonOutputParser() </span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å…¶æ·»åŠ åˆ°ä¸Šä¸€ä¸ªé“¾ä¸­ </span></span><br><span class="line"><span class="comment"># chain = prompt | llm </span></span><br><span class="line">chain = prompt | llm | output_parser </span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨å®ƒå¹¶æå‡ºåŒæ ·çš„é—®é¢˜ã€‚ç­”æ¡ˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ChatMessage </span></span><br><span class="line"><span class="comment"># chain.invoke(&#123;&quot;input&quot;: &quot;LangChainæ˜¯ä»€ä¹ˆ?&quot;&#125;) </span></span><br><span class="line">chain.invoke(&#123; <span class="string">&quot;input&quot;</span> : <span class="string">&quot;LangChainæ˜¯ä»€ä¹ˆ? ç”¨JSONæ ¼å¼å›å¤ï¼Œé—®é¢˜ç”¨questionï¼Œå›ç­”ç”¨answer&quot;</span> &#125;)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;question: LangChainæ˜¯ä»€ä¹ˆ?&#x27;, answer: LangChainæ˜¯â¼€ä¸ªå¼€æºæ¡†æ¶ï¼Œâ½¤äºæ„å»ºä¸â¼¤å‹è¯­â¾”æ¨¡å‹ï¼ˆLLMsï¼‰äº¤äº’çš„åº”â½¤ç¨‹åºã€‚å®ƒ æä¾›äº†â¼€ä¸ªçµæ´»çš„â¼¯å…·é›†ï¼Œå…è®¸å¼€å‘â¼ˆå‘˜åˆ›å»ºå…·æœ‰å¤æ‚æ¨ç†èƒ½â¼’ã€é“¾å¼ä»»åŠ¡å¤„ç†å’Œä¸Šä¸‹â½‚ç®¡ç†çš„æ™º èƒ½åº”â½¤ã€‚LangChainâ½€æŒå¤šç§æ•°æ®æºå’Œç»„ä»¶ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨å„ç§ç¯å¢ƒä¸­æ›´â¾¼æ•ˆåœ°åˆ©â½¤è¯­â¾”æ¨¡ å‹ã€‚&#x27;&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate </span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser,JsonOutputParser </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–æ¨¡å‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæç¤ºæ¨¡æ¿ </span></span><br><span class="line">prompt = ChatPromptTemplate.from_messages([</span><br><span class="line">(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;ä½ æ˜¯ä¸–ç•Œçº§çš„æŠ€æœ¯æ–‡æ¡£ç¼–å†™è€…ã€‚è¾“å‡ºæ ¼å¼è¦æ±‚ï¼š&#123;format_instructions&#125;&quot;</span>),</span><br><span class="line">(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;&#123;input&#125;&quot;</span>) <span class="comment"># &#123;input&#125;ä¸ºå˜é‡ </span></span><br><span class="line">]) </span><br><span class="line"> <span class="comment"># ä½¿ç”¨è¾“å‡ºè§£æå™¨</span></span><br><span class="line"> <span class="comment"># output_parser = StrOutputParser() </span></span><br><span class="line"> output_parser = JsonOutputParser() </span><br><span class="line"> </span><br><span class="line"> <span class="comment"># å°†å…¶æ·»åŠ åˆ°ä¸Šä¸€ä¸ªé“¾ä¸­ </span></span><br><span class="line"> <span class="comment"># chain = prompt | llm </span></span><br><span class="line"> chain = prompt | llm | output_parser </span><br><span class="line"> </span><br><span class="line"> <span class="comment"># è°ƒç”¨å®ƒå¹¶æå‡ºåŒæ ·çš„é—®é¢˜ã€‚ç­”æ¡ˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ChatMessage </span></span><br><span class="line"> <span class="comment"># chain.invoke(&#123;&quot;input&quot;: &quot;LangChainæ˜¯ä»€ä¹ˆ?&quot;&#125;) </span></span><br><span class="line"> chain.invoke(&#123; <span class="string">&quot;input&quot;</span> : <span class="string">&quot;LangChainæ˜¯ä»€ä¹ˆ? &quot;</span> <span class="string">&quot;format_instructions&quot;</span> :output_parser.get_format_instructions()&#125;)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;LangChain: &#123;description: LangChainæ˜¯â¼€ä¸ªå¼€æºçš„æ¡†æ¶ï¼Œâ½¤äºæ„å»ºåŸºäºè¯­â¾”æ¨¡å‹çš„åº”â½¤ç¨‹ åºã€‚å®ƒæ—¨åœ¨å°†ä¸åŒçš„è¯­â¾”æ¨¡å‹ã€æ•°æ®æºå’Œâ¼¯å…·ç»“åˆèµ·æ¥ï¼Œä»¥ä¾¿äºå¼€å‘è€…åˆ›å»ºå¤æ‚çš„åº”â½¤ã€‚<span class="string">&#x27;, key_features: [&#x27;</span>æ¨¡å—åŒ–è®¾è®¡ï¼šâ½€æŒå°†ä¸åŒçš„ç»„ä»¶ç»„åˆåœ¨â¼€èµ·ï¼Œå¦‚è¯­â¾”æ¨¡å‹ã€æ•°æ®å¤„ç†å’Œå¤–éƒ¨ APIã€‚<span class="string">&#x27;, &#x27;</span>â½€æŒå¤šç§è¯­â¾”æ¨¡å‹ï¼šå…¼å®¹ä¸åŒç±»å‹çš„è¯­â¾”æ¨¡å‹ï¼Œå¦‚OpenAIçš„GPTç³»åˆ—ã€BERTç­‰ã€‚<span class="string">&#x27;, &#x27;</span>å†…ç½®æ•°æ®è¿æ¥ï¼šå¯ä»¥ä¸å¤šç§æ•°æ®æºè¿›â¾é›†æˆï¼Œä¾‹å¦‚æ•°æ®åº“ã€â½‚ä»¶å’Œå¤–éƒ¨APIã€‚<span class="string">&#x27;, &#x27;</span>çµæ´»çš„â¼¯ä½œæµç®¡ç†ï¼šæä¾›äº†å¤šç§â½…æ³•æ¥å®šä¹‰å’Œç®¡ç†ä»»åŠ¡çš„æ‰§â¾æµç¨‹ã€‚<span class="string">&#x27;, &#x27;</span>ç¤¾åŒºâ½€æŒï¼šæ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºï¼Œæä¾›â½‚æ¡£ã€â½°ä¾‹å’Œâ½€æŒã€‚<span class="string">&#x27;, &#x27;</span>å¯æ‰©å±•æ€§ï¼šå…è®¸å¼€å‘è€…æ ¹æ®éœ€æ±‚å®šåˆ¶å’Œæ‰©å±•åŠŸèƒ½ã€‚<span class="string">&#x27;], use_cases: [&#x27;</span>èŠå¤©æœºå™¨â¼ˆå¼€å‘<span class="string">&#x27;, &#x27;</span>â½‚æœ¬â½£æˆå’Œæ‘˜è¦<span class="string">&#x27;, &#x27;</span>å†…å®¹æ¨èç³»ç»Ÿ<span class="string">&#x27;, &#x27;</span>â¾ƒç„¶è¯­â¾”ç†è§£ä»»åŠ¡<span class="string">&#x27;, &#x27;</span>â¾ƒåŠ¨åŒ–â¼¯ä½œ æµå¤„ç†<span class="string">&#x27;], getting_started: &#123;installation: &#x27;</span>ä½¿â½¤pipå®‰è£…ï¼špip install langchain, documentation_link: <span class="string">&#x27;https://langchain.readthedocs.io/en/latest/&#x27;</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨å‘é‡å­˜å‚¨"><a href="#ä½¿ç”¨å‘é‡å­˜å‚¨" class="headerlink" title="ä½¿ç”¨å‘é‡å­˜å‚¨"></a>ä½¿ç”¨å‘é‡å­˜å‚¨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥å’Œä½¿ç”¨ WebBaseLoaderfrom langchain_community.document_loaders import WebBaseLoader  </span></span><br><span class="line"><span class="keyword">import</span> bs4  </span><br><span class="line">  </span><br><span class="line">loader = WebBaseLoader(  </span><br><span class="line">        web_path=<span class="string">&quot;https://www.gov.cn/xinwen/2020-06/01/content_5516649.htm&quot;</span>,  </span><br><span class="line">        bs_kwargs=<span class="built_in">dict</span>(parse_only=bs4.SoupStrainer(<span class="built_in">id</span>=<span class="string">&quot;UCAP-CONTENT&quot;</span>))  </span><br><span class="line">    )  </span><br><span class="line">docs = loader.load()  </span><br><span class="line"><span class="comment"># print(docs)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¯¹äºåµŒå…¥æ¨¡å‹ï¼Œè¿™é‡Œé€šè¿‡ APIè°ƒç”¨  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line">embeddings = OpenAIEmbeddings(model=<span class="string">&quot;text-embedding-ada-002&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ä½¿ç”¨åˆ†å‰²å™¨åˆ†å‰²æ–‡æ¡£  </span></span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(chunk_size=<span class="number">500</span>, chunk_overlap=<span class="number">50</span>)  </span><br><span class="line">documents = text_splitter.split_documents(docs)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(documents))  </span><br><span class="line"><span class="comment"># å‘é‡å­˜å‚¨  embeddings ä¼šå°† documents ä¸­çš„æ¯ä¸ªæ–‡æœ¬ç‰‡æ®µè½¬æ¢ä¸ºå‘é‡ï¼Œå¹¶å°†è¿™äº›å‘é‡å­˜å‚¨åœ¨ FAISS å‘é‡æ•°æ®åº“ä¸­  </span></span><br><span class="line">vector = FAISS.from_documents(documents, embeddings)</span><br></pre></td></tr></table></figure><h2 id="RAG-æ£€ç´¢å¢å¼ºç”Ÿæˆ"><a href="#RAG-æ£€ç´¢å¢å¼ºç”Ÿæˆ" class="headerlink" title="RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)"></a>RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)</h2><p>åŸºäºå¤–éƒ¨çŸ¥è¯†ï¼Œå¢å¼ºå¤§æ¨¡å‹å›å¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate </span><br><span class="line"></span><br><span class="line">retriever = vector.as_retriever() </span><br><span class="line">retriever.search_kwargs = &#123; <span class="string">&quot;k&quot;</span> : <span class="number">3</span>&#125; </span><br><span class="line">docs = retriever.invoke( <span class="string">&quot;å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># for i,doc in enumerate(docs): </span></span><br><span class="line"><span class="comment"># print(f&quot;â­ç¬¬&#123;i+1&#125;æ¡è§„å®šï¼š&quot;) </span></span><br><span class="line"><span class="comment"># print(doc) </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆ </span></span><br><span class="line">prompt_template = <span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">ä½ æ˜¯ä¸€ä¸ªé—®ç­”æœºå™¨äººã€‚ </span></span><br><span class="line"><span class="string">ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸‹è¿°ç»™å®šçš„å·²çŸ¥ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ã€‚ </span></span><br><span class="line"><span class="string">ç¡®ä¿ä½ çš„å›å¤å®Œå…¨ä¾æ®ä¸‹è¿°å·²çŸ¥ä¿¡æ¯ã€‚ä¸è¦ç¼–é€ ç­”æ¡ˆã€‚ </span></span><br><span class="line"><span class="string">å¦‚æœä¸‹è¿°å·²çŸ¥ä¿¡æ¯ä¸è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè¯·ç›´æ¥å›å¤&quot;æˆ‘æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜&quot;ã€‚ </span></span><br><span class="line"><span class="string">å·²çŸ¥ä¿¡æ¯: </span></span><br><span class="line"><span class="string">&#123;info&#125; </span></span><br><span class="line"><span class="string">ç”¨æˆ·é—®ï¼š &#123;question&#125; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·é—®é¢˜ã€‚ &quot;&quot;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.å¾—åˆ°æç¤ºè¯æ¨¡ç‰ˆå¯¹è±¡ </span></span><br><span class="line">template = PromptTemplate.from_template(prompt_template) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.å¾—åˆ°æç¤ºè¯å¯¹è±¡ </span></span><br><span class="line">prompt = template.<span class="built_in">format</span>(info=docs, question= <span class="string">&#x27;å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ˜¯ä»€ä¹ˆï¼Ÿ&#x27;</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">## 9. è°ƒç”¨LLM </span></span><br><span class="line">response = llm.invoke(prompt) <span class="built_in">print</span> (response.content)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å»ºè®¾â½¤åœ°ä½¿â½¤æƒæ˜¯æŒ‡åœ¨æ³•å¾‹è§„å®šçš„èŒƒå›´å†…ï¼Œå»ºè®¾â½¤åœ°ä½¿â½¤æƒâ¼ˆå¯¹ç‰¹å®šâ¼Ÿåœ°çš„ä½¿â½¤ã€å»ºé€ å»ºç­‘ç‰©åŠå…¶ ä»–è®¾æ–½çš„æƒåˆ©ã€‚æ ¹æ®ç›¸å…³æ³•å¾‹è§„å®šï¼Œå»ºè®¾â½¤åœ°ä½¿â½¤æƒå¯ä»¥é€šè¿‡å‡ºè®©æˆ–åˆ’æ‹¨ç­‰â½…å¼è®¾â½´ï¼Œå¹¶åº”å½“ç¬¦åˆ èµ„æºèŠ‚çº¦ã€â½£æ€ç¯å¢ƒä¿æŠ¤åŠâ¼Ÿåœ°â½¤é€”çš„è§„å®šã€‚å»ºè®¾â½¤åœ°ä½¿â½¤æƒâ¼ˆæœ‰æƒè½¬è®©ã€å‡ºèµ„ã€èµ ä¸æˆ–æŠµæŠ¼å…¶ä½¿ â½¤æƒï¼Œä½†éœ€éµå¾ªæ³•å¾‹è§„å®šå’ŒåˆåŒçº¦å®šã€‚</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨Agent"><a href="#ä½¿ç”¨Agent" class="headerlink" title="ä½¿ç”¨Agent"></a>ä½¿ç”¨Agent</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.tools.retriever <span class="keyword">import</span> create_retriever_tool </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€ç´¢å™¨å·¥å…· </span></span><br><span class="line">retriever_tool = create_retriever_tool( retriever, <span class="string">&quot;CivilCodeRetriever&quot;</span> , <span class="string">&quot;æœç´¢æœ‰å…³ä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•å…¸çš„ä¿¡æ¯ã€‚å…³äºä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•å…¸çš„ä»»ä½•é—®é¢˜ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æ­¤å·¥ å…·!&quot;</span> , ) tools = [retriever_tool] </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> langchain <span class="keyword">import</span> hub </span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_openai_functions_agent </span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> AgentExecutor </span><br><span class="line"></span><br><span class="line"><span class="comment"># https://smith.langchain.com/hub </span></span><br><span class="line">prompt = hub.pull( <span class="string">&quot;hwchase17/openai-functions-agent&quot;</span> ) </span><br><span class="line">agent = create_openai_functions_agent(llm, tools, prompt) </span><br><span class="line">agent_executor = AgentExecutor(agent=agent, tools=tools, verbose=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œä»£ç† </span></span><br><span class="line">agent_executor.invoke(&#123; <span class="string">&quot;input&quot;</span> : <span class="string">&quot;å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ˜¯ä»€ä¹ˆ&quot;</span> &#125;)</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&gt; Entering new AgentExecutor chain...</span><br><span class="line">Invoking: `CivilCodeRetriever` with `&#123;<span class="string">&#x27;query&#x27;</span>: <span class="string">&#x27;å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒ&#x27;</span>&#125;`</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ç™¾å››åäº”æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå¯ä»¥åœ¨åœŸåœ°çš„åœ°è¡¨ã€åœ°ä¸Šæˆ–è€…åœ°ä¸‹åˆ†åˆ«è®¾ç«‹ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å››åå…­æ¡ã€€è®¾ç«‹å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒï¼Œåº”å½“ç¬¦åˆèŠ‚çº¦èµ„æºã€ä¿æŠ¤ç”Ÿæ€ç¯å¢ƒçš„è¦æ±‚ï¼Œéµå®ˆæ³•å¾‹ã€è¡Œæ”¿æ³•è§„å…³äºåœŸåœ°ç”¨é€”çš„è§„å®šï¼Œä¸å¾—æŸå®³å·²ç»è®¾ç«‹çš„ç”¨ç›Šç‰©æƒã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å››åä¸ƒæ¡ã€€è®¾ç«‹å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒï¼Œå¯ä»¥é‡‡å–å‡ºè®©æˆ–è€…åˆ’æ‹¨ç­‰æ–¹å¼ã€‚</span><br><span class="line">å·¥ä¸šã€å•†ä¸šã€æ—…æ¸¸ã€å¨±ä¹å’Œå•†å“ä½å®…ç­‰ç»è¥æ€§ç”¨åœ°ä»¥åŠåŒä¸€åœŸåœ°æœ‰ä¸¤ä¸ªä»¥ä¸Šæ„å‘ç”¨åœ°è€…çš„ï¼Œåº”å½“é‡‡å–æ‹›æ ‡ã€æ‹å–ç­‰å…¬å¼€ç«ä»·çš„æ–¹å¼å‡ºè®©ã€‚</span><br><span class="line">ä¸¥æ ¼é™åˆ¶ä»¥åˆ’æ‹¨æ–¹å¼è®¾ç«‹å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å››åå…«æ¡ã€€é€šè¿‡æ‹›æ ‡ã€æ‹å–ã€åè®®ç­‰å‡ºè®©æ–¹å¼è®¾ç«‹å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„ï¼Œå½“äº‹äººåº”å½“é‡‡ç”¨ä¹¦é¢å½¢å¼è®¢ç«‹å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå‡ºè®©åˆåŒã€‚</span><br><span class="line">å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå‡ºè®©åˆåŒä¸€èˆ¬åŒ…æ‹¬ä¸‹åˆ—æ¡æ¬¾ï¼š</span><br><span class="line">ï¼ˆä¸€ï¼‰å½“äº‹äººçš„åç§°å’Œä½æ‰€ï¼›</span><br><span class="line">ï¼ˆäºŒï¼‰åœŸåœ°ç•Œå€ã€é¢ç§¯ç­‰ï¼›</span><br><span class="line">ï¼ˆä¸‰ï¼‰å»ºç­‘ç‰©ã€æ„ç­‘ç‰©åŠå…¶é™„å±è®¾æ–½å ç”¨çš„ç©ºé—´ï¼›</span><br><span class="line">ï¼ˆå››ï¼‰åœŸåœ°ç”¨é€”ã€è§„åˆ’æ¡ä»¶ï¼›</span><br><span class="line">ï¼ˆäº”ï¼‰å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæœŸé™ï¼›</span><br><span class="line">ï¼ˆå…­ï¼‰å‡ºè®©é‡‘ç­‰è´¹ç”¨åŠå…¶æ”¯ä»˜æ–¹å¼ï¼›</span><br><span class="line">ï¼ˆä¸ƒï¼‰è§£å†³äº‰è®®çš„æ–¹æ³•ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å››åä¹æ¡ã€€è®¾ç«‹å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„ï¼Œåº”å½“å‘ç™»è®°æœºæ„ç”³è¯·å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒç™»è®°ã€‚å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒè‡ªç™»è®°æ—¶è®¾ç«‹ã€‚ç™»è®°æœºæ„åº”å½“å‘å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººå‘æ”¾æƒå±è¯ä¹¦ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åæ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººåº”å½“åˆç†åˆ©ç”¨åœŸåœ°ï¼Œä¸å¾—æ”¹å˜åœŸåœ°ç”¨é€”ï¼›éœ€è¦æ”¹å˜åœŸåœ°ç”¨é€”çš„ï¼Œåº”å½“ä¾æ³•ç»æœ‰å…³è¡Œæ”¿ä¸»ç®¡éƒ¨é—¨æ‰¹å‡†ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åä¸€æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººåº”å½“ä¾ç…§æ³•å¾‹è§„å®šä»¥åŠåˆåŒçº¦å®šæ”¯ä»˜å‡ºè®©é‡‘ç­‰è´¹ç”¨ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åäºŒæ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººå»ºé€ çš„å»ºç­‘ç‰©ã€æ„ç­‘ç‰©åŠå…¶é™„å±è®¾æ–½çš„æ‰€æœ‰æƒå±äºå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººï¼Œä½†æ˜¯æœ‰ç›¸åè¯æ®è¯æ˜çš„é™¤å¤–ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åä¸‰æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººæœ‰æƒå°†å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒè½¬è®©ã€äº’æ¢ã€å‡ºèµ„ã€èµ ä¸æˆ–è€…æŠµæŠ¼ï¼Œä½†æ˜¯æ³•å¾‹å¦æœ‰è§„å®šçš„é™¤å¤–ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åå››æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒè½¬è®©ã€äº’æ¢ã€å‡ºèµ„ã€èµ ä¸æˆ–è€…æŠµæŠ¼çš„ï¼Œå½“äº‹äººåº”å½“é‡‡ç”¨ä¹¦é¢å½¢å¼è®¢ç«‹ç›¸åº”çš„åˆåŒã€‚ä½¿ç”¨æœŸé™ç”±å½“äº‹äººçº¦å®šï¼Œä½†æ˜¯ä¸å¾—è¶…è¿‡å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„å‰©ä½™æœŸé™ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åäº”æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒè½¬è®©ã€äº’æ¢ã€å‡ºèµ„æˆ–è€…èµ ä¸çš„ï¼Œåº”å½“å‘ç™»è®°æœºæ„ç”³è¯·å˜æ›´ç™»è®°ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åå…­æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒè½¬è®©ã€äº’æ¢ã€å‡ºèµ„æˆ–è€…èµ ä¸çš„ï¼Œé™„ç€äºè¯¥åœŸåœ°ä¸Šçš„å»ºç­‘ç‰©ã€æ„ç­‘ç‰©åŠå…¶é™„å±è®¾æ–½ä¸€å¹¶å¤„åˆ†ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åä¸ƒæ¡ã€€å»ºç­‘ç‰©ã€æ„ç­‘ç‰©åŠå…¶é™„å±è®¾æ–½è½¬è®©ã€äº’æ¢ã€å‡ºèµ„æˆ–è€…èµ ä¸çš„ï¼Œè¯¥å»ºç­‘ç‰©ã€æ„ç­‘ç‰©åŠå…¶é™„å±è®¾æ–½å ç”¨èŒƒå›´å†…çš„å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒä¸€å¹¶å¤„åˆ†ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åå…«æ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæœŸé™å±Šæ»¡å‰ï¼Œå› å…¬å…±åˆ©ç›Šéœ€è¦æå‰æ”¶å›è¯¥åœŸåœ°çš„ï¼Œåº”å½“ä¾æ®æœ¬æ³•ç¬¬äºŒç™¾å››åä¸‰æ¡çš„è§„å®šå¯¹è¯¥åœŸåœ°ä¸Šçš„æˆ¿å±‹ä»¥åŠå…¶ä»–ä¸åŠ¨äº§ç»™äºˆè¡¥å¿ï¼Œå¹¶é€€è¿˜ç›¸åº”çš„å‡ºè®©é‡‘ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾äº”åä¹æ¡ã€€ä½å®…å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæœŸé™å±Šæ»¡çš„ï¼Œè‡ªåŠ¨ç»­æœŸã€‚ç»­æœŸè´¹ç”¨çš„ç¼´çº³æˆ–è€…å‡å…ï¼Œä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šåŠç†ã€‚</span><br><span class="line">éä½å®…å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæœŸé™å±Šæ»¡åçš„ç»­æœŸï¼Œä¾ç…§æ³•å¾‹è§„å®šåŠç†ã€‚è¯¥åœŸåœ°ä¸Šçš„æˆ¿å±‹ä»¥åŠå…¶ä»–ä¸åŠ¨äº§çš„å½’å±ï¼Œæœ‰çº¦å®šçš„ï¼ŒæŒ‰ç…§çº¦å®šï¼›æ²¡æœ‰çº¦å®šæˆ–è€…çº¦å®šä¸æ˜ç¡®çš„ï¼Œä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šåŠç†ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å…­åæ¡ã€€å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ¶ˆç­çš„ï¼Œå‡ºè®©äººåº”å½“åŠæ—¶åŠç†æ³¨é”€ç™»è®°ã€‚ç™»è®°æœºæ„åº”å½“æ”¶å›æƒå±è¯ä¹¦ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å…­åä¸€æ¡ã€€é›†ä½“æ‰€æœ‰çš„åœŸåœ°ä½œä¸ºå»ºè®¾ç”¨åœ°çš„ï¼Œåº”å½“ä¾ç…§åœŸåœ°ç®¡ç†çš„æ³•å¾‹è§„å®šåŠç†ã€‚</span><br><span class="line">ç¬¬åä¸‰ç« ã€€å®…åŸºåœ°ä½¿ç”¨æƒ</span><br><span class="line">ç¬¬ä¸‰ç™¾å…­åäºŒæ¡ã€€å®…åŸºåœ°ä½¿ç”¨æƒäººä¾æ³•å¯¹é›†ä½“æ‰€æœ‰çš„åœŸåœ°äº«æœ‰å æœ‰å’Œä½¿ç”¨çš„æƒåˆ©ï¼Œæœ‰æƒä¾æ³•åˆ©ç”¨è¯¥åœŸåœ°å»ºé€ ä½å®…åŠå…¶é™„å±è®¾æ–½ã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å…­åä¸‰æ¡ã€€å®…åŸºåœ°ä½¿ç”¨æƒçš„å–å¾—ã€è¡Œä½¿å’Œè½¬è®©ï¼Œé€‚ç”¨åœŸåœ°ç®¡ç†çš„æ³•å¾‹å’Œå›½å®¶æœ‰å…³è§„å®šã€‚</span><br><span class="line">ç¬¬ä¸‰ç™¾å…­åå››æ¡ã€€å®…åŸºåœ°å› è‡ªç„¶ç¾å®³ç­‰åŸå› ç­å¤±çš„ï¼Œå®…åŸºåœ°ä½¿ç”¨æƒæ¶ˆç­ã€‚å¯¹å¤±å»å®…åŸºåœ°çš„æ‘æ°‘ï¼Œåº”å½“ä¾æ³•é‡æ–°åˆ†é…å®…åŸºåœ°ã€‚å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ˜¯æŒ‡ç”±å›½å®¶æˆ–é›†ä½“å‡ºè®©æˆ–åˆ’æ‹¨ç»™ä½¿ç”¨è€…åœ¨ä¸€å®šæœŸé—´å†…å¯¹ç‰¹å®šåœŸåœ°è¿›è¡Œå»ºè®¾ã€å¼€å‘å’Œåˆ©ç”¨çš„æƒåˆ©ã€‚æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•å…¸çš„ç›¸å…³è§„å®šï¼Œå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„å…·ä½“å†…å®¹åŒ…æ‹¬ï¼š</span><br><span class="line"></span><br><span class="line">1. **è®¾ç«‹æ–¹å¼**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå¯ä»¥é€šè¿‡å‡ºè®©æˆ–åˆ’æ‹¨çš„æ–¹å¼è®¾ç«‹ï¼Œä¸”å‡ºè®©æ–¹å¼ä¸€èˆ¬ä½¿ç”¨å…¬å¼€æ‹›æ ‡ã€æ‹å–ç­‰æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç»è¥æ€§ç”¨åœ°ã€‚</span><br><span class="line"></span><br><span class="line">2. **åˆåŒå†…å®¹**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå‡ºè®©åˆåŒåº”åŒ…å«å½“äº‹äººçš„ä¿¡æ¯ã€åœŸåœ°ç•Œå€ã€é¢ç§¯ã€ç”¨é€”ã€ä½¿ç”¨æƒæœŸé™ã€å‡ºè®©é‡‘ç­‰è´¹ç”¨åŠè§£å†³äº‰è®®çš„æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">3. **ç™»è®°**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒéœ€å‘ç™»è®°æœºæ„ç”³è¯·ç™»è®°ï¼Œç™»è®°åæ–¹å¯æ­£å¼è®¾ç«‹ï¼Œå¹¶ä¼šå‘æ”¾æƒå±è¯ä¹¦ã€‚</span><br><span class="line"></span><br><span class="line">4. **åˆç†åˆ©ç”¨å’Œç”¨é€”å˜æ›´**ï¼šä½¿ç”¨æƒäººåº”åˆç†åˆ©ç”¨åœŸåœ°ï¼Œä¸å¾—æ“…è‡ªæ”¹å˜åœŸåœ°ç”¨é€”ï¼Œå¦‚éœ€å˜æ›´éœ€ç»è¿‡ç›¸å…³è¡Œæ”¿éƒ¨é—¨çš„æ‰¹å‡†ã€‚</span><br><span class="line"></span><br><span class="line">5. **è½¬è®©å’ŒæŠµæŠ¼**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººæœ‰æƒè½¬è®©ã€å‡ºèµ„ã€èµ ä¸æˆ–æŠµæŠ¼è¯¥ä½¿ç”¨æƒï¼Œä½†éœ€éµå®ˆæ³•å¾‹è§„å®šã€‚</span><br><span class="line"></span><br><span class="line">6. **ä½¿ç”¨æƒæœŸé™**ï¼šä½å®…å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒåœ¨æœŸé™å±Šæ»¡åå¯ä»¥è‡ªåŠ¨ç»­æœŸï¼Œè€Œéä½å®…ç”¨åœ°çš„ç»­æœŸåˆ™éœ€ä¾æ³•åŠç†ã€‚</span><br><span class="line"></span><br><span class="line">7. **è¡¥å¿æœºåˆ¶**ï¼šå¦‚å› å…¬å…±åˆ©ç›Šéœ€è¦æ”¶å›åœŸåœ°ï¼Œå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººæœ‰æƒè·å¾—ç›¸åº”çš„è¡¥å¿ã€‚</span><br><span class="line"></span><br><span class="line">ä¸Šè¿°å†…å®¹ä¸ºå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„åŸºæœ¬ä¿¡æ¯å’Œæ³•å¾‹è§„å®šã€‚</span><br><span class="line"></span><br><span class="line">&gt; Finished chain.</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&#x27;input&#x27;</span>: <span class="string">&#x27;å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ˜¯ä»€ä¹ˆ&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;output&#x27;</span>: <span class="string">&#x27;å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒæ˜¯æŒ‡ç”±å›½å®¶æˆ–é›†ä½“å‡ºè®©æˆ–åˆ’æ‹¨ç»™ä½¿ç”¨è€…åœ¨ä¸€å®šæœŸé—´å†…å¯¹ç‰¹å®šåœŸåœ°è¿›è¡Œå»ºè®¾ã€å¼€å‘å’Œåˆ©ç”¨çš„æƒåˆ©ã€‚æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•å…¸çš„ç›¸å…³è§„å®šï¼Œå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„å…·ä½“å†…å®¹åŒ…æ‹¬ï¼š\n\n1. **è®¾ç«‹æ–¹å¼**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå¯ä»¥é€šè¿‡å‡ºè®©æˆ–åˆ’æ‹¨çš„æ–¹å¼è®¾ç«‹ï¼Œä¸”å‡ºè®©æ–¹å¼ä¸€èˆ¬ä½¿ç”¨å…¬å¼€æ‹›æ ‡ã€æ‹å–ç­‰æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç»è¥æ€§ç”¨åœ°ã€‚\n\n2. **åˆåŒå†…å®¹**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒå‡ºè®©åˆåŒåº”åŒ…å«å½“äº‹äººçš„ä¿¡æ¯ã€åœŸåœ°ç•Œå€ã€é¢ç§¯ã€ç”¨é€”ã€ä½¿ç”¨æƒæœŸé™ã€å‡ºè®©é‡‘ç­‰è´¹ç”¨åŠè§£å†³äº‰è®®çš„æ–¹æ³•ã€‚\n\n3. **ç™»è®°**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒéœ€å‘ç™»è®°æœºæ„ç”³è¯·ç™»è®°ï¼Œç™»è®°åæ–¹å¯æ­£å¼è®¾ç«‹ï¼Œå¹¶ä¼šå‘æ”¾æƒå±è¯ä¹¦ã€‚\n\n4. **åˆç†åˆ©ç”¨å’Œç”¨é€”å˜æ›´**ï¼šä½¿ç”¨æƒäººåº”åˆç†åˆ©ç”¨åœŸåœ°ï¼Œä¸å¾—æ“…è‡ªæ”¹å˜åœŸåœ°ç”¨é€”ï¼Œå¦‚éœ€å˜æ›´éœ€ç»è¿‡ç›¸å…³è¡Œæ”¿éƒ¨é—¨çš„æ‰¹å‡†ã€‚\n\n5. **è½¬è®©å’ŒæŠµæŠ¼**ï¼šå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººæœ‰æƒè½¬è®©ã€å‡ºèµ„ã€èµ ä¸æˆ–æŠµæŠ¼è¯¥ä½¿ç”¨æƒï¼Œä½†éœ€éµå®ˆæ³•å¾‹è§„å®šã€‚\n\n6. **ä½¿ç”¨æƒæœŸé™**ï¼šä½å®…å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒåœ¨æœŸé™å±Šæ»¡åå¯ä»¥è‡ªåŠ¨ç»­æœŸï¼Œè€Œéä½å®…ç”¨åœ°çš„ç»­æœŸåˆ™éœ€ä¾æ³•åŠç†ã€‚\n\n7. **è¡¥å¿æœºåˆ¶**ï¼šå¦‚å› å…¬å…±åˆ©ç›Šéœ€è¦æ”¶å›åœŸåœ°ï¼Œå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒäººæœ‰æƒè·å¾—ç›¸åº”çš„è¡¥å¿ã€‚\n\nä¸Šè¿°å†…å®¹ä¸ºå»ºè®¾ç”¨åœ°ä½¿ç”¨æƒçš„åŸºæœ¬ä¿¡æ¯å’Œæ³•å¾‹è§„å®šã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>chromadbå‘é‡æ•°æ®åº“</title>
      <link href="/2025/09/23/chromadb%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2025/09/23/chromadb%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<ul><li><p><a href="https://docs.trychroma.com/docs/overview/introduction"><strong>chromadb</strong>å®˜æ–¹åœ°å€:https://docs.trychroma.com/docs/overview/introduction</a></p></li><li><p><a href="https://blog.csdn.net/2201_75509689/article/details/148783957?ops_request_misc=&request_id=&biz_id=102&utm_term=chromadb&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-148783957.142%5Ev102%5Epc_search_result_base5&spm=1018.2226.3001.4187">æœ¬æ–‡å¤§éƒ¨åˆ†å†…å®¹åœ°å€</a></p></li><li><p><strong>GitHub ä»“åº“:</strong>Â <a href="https://github.com/chroma-core/chroma" title="https://github.com/chroma-core/chroma">https://github.com/chroma-core/chroma</a>Â æŸ¥çœ‹ Issueså’ŒDiscussionsã€‚</p></li></ul><h1 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h1><h2 id="ä»€ä¹ˆæ˜¯çŸ¢é‡å­˜å‚¨ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çŸ¢é‡å­˜å‚¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çŸ¢é‡å­˜å‚¨ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çŸ¢é‡å­˜å‚¨ï¼Ÿ</h2><p>å‘é‡å­˜å‚¨æ˜¯ä¸“é—¨ä¸ºæœ‰æ•ˆåœ°å­˜å‚¨å’Œæ£€ç´¢å‘é‡åµŒå…¥è€Œè®¾è®¡çš„æ•°æ®åº“ã€‚ä¹‹æ‰€ä»¥éœ€è¦å®ƒä»¬ï¼Œæ˜¯å› ä¸ºåƒ SQL è¿™æ ·çš„ä¼ ç»Ÿæ•°æ®åº“<strong>æ²¡æœ‰é’ˆå¯¹å­˜å‚¨å’ŒæŸ¥è¯¢å¤§å‹å‘é‡æ•°æ®è¿›è¡Œä¼˜åŒ–</strong>ã€‚</p><p>åµŒå…¥åœ¨é«˜ç»´ç©ºé—´ä¸­ä»¥æ•°å­—å‘é‡æ ¼å¼è¡¨ç¤ºæ•°æ®ï¼ˆé€šå¸¸æ˜¯éç»“æ„åŒ–æ•°æ®ï¼Œå¦‚æ–‡æœ¬ï¼‰ã€‚ä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“ä¸å¤ªé€‚åˆå­˜å‚¨å’Œæœç´¢è¿™äº›å‘é‡è¡¨ç¤ºã€‚</p><p>å‘é‡å­˜å‚¨å¯ä»¥<strong>ä½¿ç”¨ç›¸ä¼¼æ€§ç®—æ³•å¯¹ç›¸ä¼¼çš„å‘é‡è¿›è¡Œç´¢å¼•å’Œå¿«é€Ÿæœç´¢</strong>ã€‚å®ƒå…è®¸åº”ç”¨ç¨‹åºåœ¨ç»™å®šç›®æ ‡å‘é‡æŸ¥è¯¢çš„æƒ…å†µä¸‹æŸ¥æ‰¾ç›¸å…³å‘é‡ã€‚</p><p>åœ¨ä¸ªæ€§åŒ–èŠå¤©æœºå™¨äººçš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·è¾“å…¥ç”Ÿæˆå¼ AI æ¨¡å‹çš„æç¤ºã€‚ç„¶åï¼Œè¯¥æ¨¡å‹ä½¿ç”¨ç›¸ä¼¼æ€§æœç´¢ç®—æ³•åœ¨æ–‡æ¡£é›†åˆä¸­æœç´¢ç›¸ä¼¼æ–‡æœ¬ã€‚ç„¶åï¼Œç”±æ­¤äº§ç”Ÿçš„ä¿¡æ¯ç”¨äºç”Ÿæˆé«˜åº¦ä¸ªæ€§åŒ–å’Œå‡†ç¡®çš„å“åº”ã€‚è¿™æ˜¯é€šè¿‡åœ¨å‘é‡å­˜å‚¨ä¸­åµŒå…¥å’Œå‘é‡ç´¢å¼•æ¥å®ç°çš„ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯ChromaDBï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ChromaDBï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ChromaDBï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ChromaDBï¼Ÿ</h2><p>ChromaDBæ˜¯ä¸€ä¸ªå¼€æºçŸ¢é‡å­˜å‚¨ï¼Œç”¨äºå­˜å‚¨å’Œæ£€ç´¢çŸ¢é‡åµŒå…¥ã€‚å®ƒçš„ä¸»è¦ç”¨é€”æ˜¯ä¿å­˜åµŒå…¥å’Œå…ƒæ•°æ®ï¼Œä»¥ä¾¿ä»¥åç”±å¤§å‹è¯­è¨€æ¨¡å‹ä½¿ç”¨ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å¯ç”¨äºæ–‡æœ¬æ•°æ®çš„è¯­ä¹‰æœç´¢å¼•æ“ã€‚</p><p>Chroma DBä¸»è¦ç‰¹ç‚¹ï¼š</p><ul><li>æ”¯æŒä¸åŒçš„åº•å±‚å­˜å‚¨é€‰é¡¹ï¼Œä¾‹å¦‚ç”¨äºç‹¬ç«‹çš„ DuckDB æˆ–ç”¨äºå¯æ‰©å±•æ€§çš„ ClickHouseã€‚</li><li>æä¾› Python å’Œ JavaScript&#x2F;TypeScript çš„ SDKã€‚</li><li>ä¸“æ³¨äºç®€å•æ€§ã€é€Ÿåº¦å’Œæ”¯æŒæ€§åˆ†æã€‚</li></ul><p><img src="/2025/09/23/chromadb%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/file-20250918154240773.png"></p><h2 id="ChromaDBæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"><a href="#ChromaDBæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" class="headerlink" title="ChromaDBæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>ChromaDBæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h2><ol><li>é¦–å…ˆï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨çš„é›†åˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒChroma ä½¿ç”¨ å°†æ–‡æœ¬è½¬æ¢ä¸ºåµŒå…¥ï¼Œä½†æ‚¨å¯ä»¥ä¿®æ”¹é›†åˆä»¥ä½¿ç”¨å…¶ä»–åµŒå…¥æ¨¡å‹ã€‚all-MiniLM-L6-v2</li><li>å°†å…·æœ‰å…ƒæ•°æ®å’Œå”¯ä¸€ ID çš„æ–‡æœ¬æ–‡æ¡£æ·»åŠ åˆ°æ–°åˆ›å»ºçš„é›†åˆä¸­ã€‚å½“æ‚¨çš„æ”¶è—æ”¶åˆ°æ–‡æœ¬æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å°†å…¶è½¬æ¢ä¸ºåµŒå…¥ã€‚</li><li>é€šè¿‡æ–‡æœ¬æˆ–åµŒå…¥æŸ¥è¯¢é›†åˆä»¥æ¥æ”¶ç›¸ä¼¼çš„æ–‡æ¡£ã€‚æ‚¨è¿˜å¯ä»¥æ ¹æ®å…ƒæ•°æ®ç­›é€‰å‡ºç»“æœã€‚</li></ol><p>åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Chroma å’Œ OpenAI API æ¥åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„çŸ¢é‡æ•°æ®åº“ã€‚</p><h2 id="ChromaDB-çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#ChromaDB-çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="ChromaDB çš„æ ¸å¿ƒæ¦‚å¿µ"></a>ChromaDB çš„æ ¸å¿ƒæ¦‚å¿µ</h2><ul><li><p><strong>å®¢æˆ·ç«¯ï¼ˆClientï¼‰</strong>ï¼š è¿™æ˜¯ä½ ä¸ ChromaDB äº¤äº’çš„æ¥å£ã€‚ChromaDB æ”¯æŒå¤šç§éƒ¨ç½²æ¨¡å¼ï¼Œä½ å¯ä»¥ç”¨æœ¬åœ°æ¨¡å¼ï¼ˆæ•°æ®å­˜åœ¨æœ¬åœ°æ–‡ä»¶ï¼‰ã€å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å¼ï¼ˆè¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼‰æˆ–æŒä¹…åŒ–æ¨¡å¼ï¼ˆæ•°æ®å­˜åˆ°æŒ‡å®šè·¯å¾„ï¼‰ã€‚</p></li><li><p><strong>é›†åˆï¼ˆCollectionï¼‰</strong>ï¼š é›†åˆæ˜¯å­˜å‚¨å‘é‡ã€æ–‡æ¡£å’Œå…ƒæ•°æ®çš„é€»è¾‘å•å…ƒã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆå…³ç³»æ•°æ®åº“ä¸­çš„ä¸€ä¸ªâ€œè¡¨â€ï¼Œæˆ–è€…ä¸€ä¸ªç‰¹å®šä¸»é¢˜çš„æ–‡æ¡£åº“ã€‚ä½ çš„æ‰€æœ‰ç›¸å…³æ•°æ®éƒ½ä¼šæ”¾åˆ°ä¸€ä¸ªé›†åˆé‡Œã€‚</p></li><li><p><strong>æ–‡æ¡£ï¼ˆDocumentï¼‰</strong>ï¼š è¿™æ˜¯ä½ çš„åŸå§‹æ•°æ®ï¼Œé€šå¸¸æ˜¯æ–‡æœ¬ã€‚å½“ä½ æŠŠæ–‡æ¡£æ·»åŠ åˆ°é›†åˆæ—¶ï¼ŒChromaDB ä¼šè‡ªåŠ¨ï¼ˆæˆ–ä½¿ç”¨ä½ æŒ‡å®šçš„æ¨¡å‹ï¼‰å°†å…¶è½¬æ¢ä¸ºå‘é‡ã€‚</p></li><li><p><strong>åµŒå…¥ï¼ˆEmbeddingï¼‰</strong>ï¼š æ–‡æ¡£çš„æ•°å­—è¡¨ç¤ºã€‚è¿™æ˜¯è¯­ä¹‰æœç´¢çš„åŸºç¡€ã€‚</p></li><li><p><strong>å…ƒæ•°æ®ï¼ˆMetadataï¼‰</strong>ï¼š é™„åŠ åˆ°æ–‡æ¡£æˆ–å‘é‡ä¸Šçš„æè¿°æ€§ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œä½ å­˜å‚¨äº†ä¸€ç¯‡æ–‡ç« çš„å‘é‡ï¼Œå®ƒçš„å…ƒæ•°æ®å¯ä»¥æ˜¯æ–‡ç« çš„æ ‡é¢˜ã€ä½œè€…ã€å‘å¸ƒæ—¥æœŸç­‰ã€‚å…ƒæ•°æ®å¯¹äºè¿‡æ»¤å’ŒæŸ¥è¯¢ç»“æœéå¸¸æœ‰ç”¨ã€‚</p></li><li><p><strong>ID</strong>ï¼š æ¯ä¸ªæ–‡æ¡£å’Œå…¶å¯¹åº”çš„å‘é‡éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IDã€‚ï¼ˆå­—ç¬¦ä¸²æˆ– UUIDï¼‰</p></li></ul><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><h2 id="å®‰è£…Chromadb"><a href="#å®‰è£…Chromadb" class="headerlink" title="å®‰è£…Chromadb"></a>å®‰è£…Chromadb</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip install chromadb</span><br></pre></td></tr></table></figure><h2 id="åˆå§‹åŒ–Chromaå®¢æˆ·ç«¯"><a href="#åˆå§‹åŒ–Chromaå®¢æˆ·ç«¯" class="headerlink" title="åˆå§‹åŒ–Chromaå®¢æˆ·ç«¯"></a>åˆå§‹åŒ–Chromaå®¢æˆ·ç«¯</h2><p>å†…å­˜æ¨¡å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chromadb</span><br><span class="line">client = chromadb.Client()  <span class="comment"># ä½¿ç”¨é»˜è®¤çš„æŒä¹…åŒ–ç›®å½•ï¼Œä½†é»˜è®¤æ˜¯å†…å­˜æ¨¡å¼</span></span><br><span class="line"><span class="comment"># æˆ–è€…æ˜¾å¼æŒ‡å®š</span></span><br><span class="line">client = chromadb.PersistentClient(path=<span class="string">&quot;/path/to/db&quot;</span>)  <span class="comment"># æŒ‡å®šæŒä¹…åŒ–ç›®å½•ï¼Œä½†ç¬¬ä¸€æ¬¡ä½¿ç”¨å‰è¯¥ç›®å½•é€šå¸¸ä¸å­˜åœ¨</span></span><br></pre></td></tr></table></figure><p>httpå®¢æˆ·ç«¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client = chromadb.HttpClient(host=<span class="string">&quot;localhost&quot;</span>, port=<span class="string">&quot;8000&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»º-è·å–é›†åˆ-Collection"><a href="#åˆ›å»º-è·å–é›†åˆ-Collection" class="headerlink" title="åˆ›å»º&#x2F;è·å–é›†åˆ (Collection)"></a>åˆ›å»º&#x2F;è·å–é›†åˆ (Collection)</h2><p>é›†åˆ(collection)æ˜¯åœ¨chromaæ•°æ®åº“çš„ä½œç”¨ç±»ä¼¼Mysqlçš„è¡¨ï¼Œå­˜å‚¨å‘é‡æ•°æ®ï¼ˆåŒ…æ‹¬æ–‡æ¡£å’Œå…¶ä»–æºæ•°æ®ï¼‰çš„åœ°æ–¹ï¼Œä¸‹é¢åˆ›å»ºä¸€ä¸ªé›†åˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">collection = client.create_collection(</span><br><span class="line">    name=<span class="string">&quot;my_knowledge_base&quot;</span>,  <span class="comment"># é›†åˆåç§°</span></span><br><span class="line">    embedding_function=embedding_fn,  <span class="comment"># å¯é€‰ï¼šæŒ‡å®šè‡ªå®šä¹‰åµŒå…¥å‡½æ•°</span></span><br><span class="line">    metadata=&#123;<span class="string">&quot;hnsw:space&quot;</span>: <span class="string">&quot;cosine&quot;</span>&#125;  <span class="comment"># å¯é€‰ï¼šé…ç½®ç´¢å¼•å‚æ•°</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li><p>embedding_function: å¼ºçƒˆå»ºè®®æä¾›ï¼å¦‚æœä¸æä¾›ï¼Œåœ¨æ·»åŠ æ•°æ®æ—¶å¿…é¡»ä¼ å…¥é¢„è®¡ç®—å¥½çš„å‘é‡ (embeddings å‚æ•°)ã€‚æä¾›å‡½æ•°å¯ä»¥è®© ChromaDB è‡ªåŠ¨ä¸ºä½ æ·»åŠ çš„æ–‡æœ¬ç”Ÿæˆå‘é‡ã€‚</p></li><li><p>metadata: å¯ä»¥é…ç½®é›†åˆçš„ç´¢å¼•å‚æ•°ã€‚ä¾‹å¦‚ {â€œhnsw:spaceâ€: â€œcosineâ€} (ä½™å¼¦ç›¸ä¼¼åº¦) æˆ– {â€œhnsw:spaceâ€: â€œl2â€} (æ¬§æ°è·ç¦»)ã€‚é»˜è®¤é€šå¸¸æ˜¯ â€œ12â€ã€‚</p></li></ul><p><strong>è·å–ç°æœ‰é›†åˆï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">collection = client.get_collection(</span><br><span class="line">    name=<span class="string">&quot;my_knowledge_base&quot;</span>,  <span class="comment"># é›†åˆåç§°</span></span><br><span class="line">    embedding_function=embedding_fn  <span class="comment"># å¦‚æœåˆ›å»ºæ—¶æŒ‡å®šäº†ï¼Œè¿™é‡Œé€šå¸¸ä¹Ÿéœ€è¦æŒ‡å®šç›¸åŒçš„å‡½æ•°ç”¨äºæŸ¥è¯¢</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="å‘é›†åˆæ·»åŠ æ•°æ®-Add-Upsert"><a href="#å‘é›†åˆæ·»åŠ æ•°æ®-Add-Upsert" class="headerlink" title="å‘é›†åˆæ·»åŠ æ•°æ® (Add&#x2F; Upsert)"></a>å‘é›†åˆæ·»åŠ æ•°æ® (Add&#x2F; Upsert)</h2><p><strong>æ–¹å¼ä¸€ï¼šè®© ChromaDB è‡ªåŠ¨ç”Ÿæˆå‘é‡ (æ¨èï¼Œéœ€æä¾›Â <code>embedding_function</code>)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æˆ–è·å–ä¸€ä¸ªåµŒå…¥å‡½æ•° (è¿™é‡Œä»¥ sentence-transformers ä¸ºä¾‹)</span></span><br><span class="line"><span class="keyword">from</span> sentence_transformers <span class="keyword">import</span> SentenceTransformer</span><br><span class="line">model = SentenceTransformer(<span class="string">&#x27;all-MiniLM-L6-v2&#x27;</span>)  <span class="comment"># å°å‹é«˜æ•ˆæ¨¡å‹</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">embedding_fn</span>(<span class="params">texts: <span class="built_in">list</span>[<span class="built_in">str</span>]</span>) -&gt; <span class="built_in">list</span>[<span class="built_in">list</span>[<span class="built_in">float</span>]]:</span><br><span class="line">    <span class="comment"># ChromaDB æœŸæœ›åµŒå…¥å‡½æ•°æ¥æ”¶å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¿”å›å‘é‡åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">return</span> model.encode(texts).tolist()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆ›å»ºé›†åˆæ—¶æŒ‡å®šè¯¥å‡½æ•°ï¼Œæˆ–è€…åœ¨ get_collection æ—¶æŒ‡å®š</span></span><br><span class="line">collection = client.get_collection(name=<span class="string">&quot;my_knowledge_base&quot;</span>, embedding_function=embedding_fn)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ·»åŠ æ•°æ®</span></span><br><span class="line">collection.add(</span><br><span class="line">    documents=[  <span class="comment"># åŸå§‹æ–‡æœ¬ (å¼ºçƒˆå»ºè®®æä¾›)</span></span><br><span class="line">        <span class="string">&quot;The cat sat on the mat.&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Dogs are great companions.&quot;</span>,</span><br><span class="line">        <span class="string">&quot;The sun rises in the east.&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    metadatas=[  <span class="comment"># å¯¹åº”çš„å…ƒæ•°æ®å­—å…¸åˆ—è¡¨ (å¯é€‰ä½†æ¨è)</span></span><br><span class="line">        &#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;sentence1&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;example&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;sentence2&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;example&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;sentence3&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;fact&quot;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    ids=[<span class="string">&quot;id1&quot;</span>, <span class="string">&quot;id2&quot;</span>, <span class="string">&quot;id3&quot;</span>]  <span class="comment"># å”¯ä¸€ ID</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Â <strong>æ–¹å¼äºŒï¼šè‡ªå·±æä¾›é¢„è®¡ç®—å¥½çš„å‘é‡ (å¦‚æœä¸æä¾›Â <code>embedding_function</code>Â æˆ–éœ€è¦ç²¾ç»†æ§åˆ¶)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾ä½ å·²ç»è®¡ç®—å¥½å‘é‡äº†</span></span><br><span class="line">precomputed_embeddings = [</span><br><span class="line">    [<span class="number">0.1</span>, <span class="number">0.2</span>, ..., <span class="number">0.5</span>],  <span class="comment"># id1 çš„å‘é‡</span></span><br><span class="line">    [<span class="number">0.6</span>, -<span class="number">0.3</span>, ..., <span class="number">0.8</span>],  <span class="comment"># id2 çš„å‘é‡</span></span><br><span class="line">    [-<span class="number">0.2</span>, <span class="number">0.4</span>, ..., <span class="number">0.1</span>]   <span class="comment"># id3 çš„å‘é‡</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">collection.add(</span><br><span class="line">    embeddings=precomputed_embeddings,  <span class="comment"># å¿…é¡»æä¾›</span></span><br><span class="line">    documents=[...],  <span class="comment"># å¯é€‰</span></span><br><span class="line">    metadatas=[...],  <span class="comment"># å¯é€‰</span></span><br><span class="line">    ids=[<span class="string">&quot;id1&quot;</span>, <span class="string">&quot;id2&quot;</span>, <span class="string">&quot;id3&quot;</span>]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong><code>upsert</code>Â æ–¹æ³•:</strong>Â å¦‚æœÂ <code>id</code>Â å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°è¯¥æ¡ç›®ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ æ–°æ¡ç›®ã€‚å‚æ•°ä¸Â <code>add</code>Â ç›¸åŒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collection.upsert(...)  <span class="comment"># å‚æ•°åŒ add</span></span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢é›†åˆ-Query"><a href="#æŸ¥è¯¢é›†åˆ-Query" class="headerlink" title="æŸ¥è¯¢é›†åˆ (Query)"></a>æŸ¥è¯¢é›†åˆ (Query)</h2><p>è¿™æ˜¯å¦ä¸€ä¸ªæ ¸å¿ƒæ­¥éª¤ã€‚æ ¹æ®æŸ¥è¯¢æ–‡æœ¬æˆ–å‘é‡ï¼Œæ‰¾åˆ°é›†åˆä¸­æœ€ç›¸ä¼¼çš„æ¡ç›®ã€‚</p><p><strong>ä½¿ç”¨æŸ¥è¯¢æ–‡æœ¬ (ChromaDB è‡ªåŠ¨ç”¨Â <code>embedding_function</code>Â è½¬ä¸ºå‘é‡):</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">results = collection.query(</span><br><span class="line">    query_texts=[<span class="string">&quot;Where does the sun rise?&quot;</span>],  <span class="comment"># æŸ¥è¯¢æ–‡æœ¬åˆ—è¡¨</span></span><br><span class="line">    n_results=<span class="number">2</span>,  <span class="comment"># è¿”å›æœ€ç›¸ä¼¼çš„ 2 ä¸ªç»“æœ</span></span><br><span class="line">    <span class="comment"># where=&#123;&quot;metadata_field&quot;: &#123;&quot;$eq&quot;: &quot;value&quot;&#125;&#125;,  # å¯é€‰ï¼šåŸºäºå…ƒæ•°æ®çš„è¿‡æ»¤</span></span><br><span class="line">    <span class="comment"># where_document=&#123;&quot;$contains&quot;: &quot;keyword&quot;&#125;      # å¯é€‰ï¼šåŸºäºæ–‡æ¡£å†…å®¹çš„è¿‡æ»¤</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æŸ¥è¯¢å‘é‡ (è‡ªå·±æä¾›):</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">query_vector = embedding_fn([<span class="string">&quot;Where does the sun rise?&quot;</span>])[<span class="number">0</span>]  <span class="comment"># å‡è®¾ embedding_fn å¯ç”¨</span></span><br><span class="line">results = collection.query(</span><br><span class="line">    query_embeddings=[query_vector],  <span class="comment"># æŸ¥è¯¢å‘é‡åˆ—è¡¨</span></span><br><span class="line">    n_results=<span class="number">2</span></span><br><span class="line">    <span class="comment"># ... åŒæ ·å¯ä»¥åŠ  where å’Œ where_document è¿‡æ»¤</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç†è§£è¿”å›ç»“æœ (results): results æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«ï¼š</p><ul><li><p>ids: æœ€ç›¸ä¼¼æ¡ç›®çš„ ID åˆ—è¡¨ (åˆ—è¡¨çš„åˆ—è¡¨ï¼Œå¤–å±‚åˆ—è¡¨å¯¹åº”æ¯ä¸ªæŸ¥è¯¢æ–‡æœ¬&#x2F;å‘é‡)ã€‚</p></li><li><p>distances: å¯¹åº”çš„è·ç¦» (è¶Šå°è¶Šç›¸ä¼¼)ã€‚</p></li><li><p>metadatas: å¯¹åº”çš„å…ƒæ•°æ®ã€‚</p></li><li><p>documents: å¯¹åº”çš„åŸå§‹æ–‡æ¡£æ–‡æœ¬ã€‚</p></li><li><p>embeddings (å¦‚æœ include&#x3D;[â€˜embeddingsâ€™]): å¯¹åº”çš„å‘é‡ã€‚</p></li><li><p>uris &#x2F; data (é€šå¸¸ä¸å¸¸ç”¨)ã€‚</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(results[<span class="string">&quot;ids&quot;</span>])      <span class="comment"># è¾“å‡º: [[&#x27;id3&#x27;, &#x27;id1&#x27;]]  (å¯¹äºå•ä¸ªæŸ¥è¯¢)</span></span><br><span class="line"><span class="built_in">print</span>(results[<span class="string">&quot;documents&quot;</span>]) <span class="comment"># è¾“å‡º: [[&#x27;The sun rises in the east.&#x27;, &#x27;The cat sat on the mat.&#x27;]]</span></span><br><span class="line"><span class="built_in">print</span>(results[<span class="string">&quot;distances&quot;</span>]) <span class="comment"># è¾“å‡º: [[0.15, 0.87]]   (å‡è®¾ id3 è·ç¦»æ›´å°)</span></span><br></pre></td></tr></table></figure><h2 id="ç®¡ç†æ•°æ®"><a href="#ç®¡ç†æ•°æ®" class="headerlink" title="ç®¡ç†æ•°æ®"></a>ç®¡ç†æ•°æ®</h2><p><strong>è·å– (Get):</strong>Â æ ¹æ® ID è·å–æ¡ç›®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">items = collection.get(</span><br><span class="line">    ids=[<span class="string">&quot;id1&quot;</span>, <span class="string">&quot;id2&quot;</span>],  <span class="comment"># å¯é€‰ï¼šæŒ‡å®š ID</span></span><br><span class="line">    <span class="comment"># where=&#123;...&#125;,        # å¯é€‰ï¼šå…ƒæ•°æ®è¿‡æ»¤</span></span><br><span class="line">    <span class="comment"># where_document=&#123;...&#125;, # å¯é€‰ï¼šæ–‡æ¡£å†…å®¹è¿‡æ»¤</span></span><br><span class="line">    <span class="comment"># limit=10,           # å¯é€‰ï¼šé™åˆ¶è¿”å›æ•°é‡</span></span><br><span class="line">    <span class="comment"># offset=0,           # å¯é€‰ï¼šåç§»é‡</span></span><br><span class="line">    <span class="comment"># include=[&quot;metadatas&quot;, &quot;documents&quot;, &quot;embeddings&quot;]  # æŒ‡å®šè¿”å›å“ªäº›å­—æ®µ</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># items ç»“æ„ä¸ query è¿”å›çš„å•ä¸ªæŸ¥è¯¢ç»“æœç±»ä¼¼ (ids, metadatas, documents, embeddings éƒ½æ˜¯åˆ—è¡¨)</span></span><br></pre></td></tr></table></figure><p><strong>æ›´æ–° (Update):</strong>Â æ›´æ–°æŒ‡å®š ID çš„æ¡ç›®ã€‚éœ€è¦æä¾›è¦æ›´æ–°çš„å­—æ®µ (<code>embeddings</code>,Â <code>metadatas</code>,Â <code>documents</code>)ã€‚æœªæä¾›çš„å­—æ®µä¿æŒä¸å˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">collection.update(</span><br><span class="line">    ids=[<span class="string">&quot;id2&quot;</span>],</span><br><span class="line">    metadatas=[&#123;<span class="string">&quot;source&quot;</span>: <span class="string">&quot;updated_sentence2&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;example&quot;</span>&#125;],</span><br><span class="line">    documents=[<span class="string">&quot;Dogs are truly amazing companions.&quot;</span>]</span><br><span class="line">    <span class="comment"># ä¹Ÿå¯ä»¥æ›´æ–° embeddings=[new_vector]</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤ (Delete):</strong>Â åˆ é™¤æŒ‡å®š ID æˆ–æ»¡è¶³æ¡ä»¶çš„æ¡ç›®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‰ ID åˆ é™¤</span></span><br><span class="line">collection.delete(ids=[<span class="string">&quot;id1&quot;</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æŒ‰å…ƒæ•°æ®æ¡ä»¶åˆ é™¤</span></span><br><span class="line">collection.delete(where=&#123;<span class="string">&quot;type&quot;</span>: &#123;<span class="string">&quot;$eq&quot;</span>: <span class="string">&quot;example&quot;</span>&#125;&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æŒ‰æ–‡æ¡£å†…å®¹æ¡ä»¶åˆ é™¤ (è°¨æ…ä½¿ç”¨!)</span></span><br><span class="line">collection.delete(where_document=&#123;<span class="string">&quot;$contains&quot;</span>: <span class="string">&quot;cat&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><h2 id="æŒä¹…åŒ–å­˜å‚¨-é‡è¦ï¼"><a href="#æŒä¹…åŒ–å­˜å‚¨-é‡è¦ï¼" class="headerlink" title="æŒä¹…åŒ–å­˜å‚¨ (é‡è¦ï¼)"></a>æŒä¹…åŒ–å­˜å‚¨ (é‡è¦ï¼)</h2><p>é»˜è®¤çš„Â <code>chromadb.Client()</code>Â æ˜¯çº¯å†…å­˜çš„ã€‚é‡å¯ Python ç¨‹åºæ•°æ®å°±æ²¡äº†ï¼å¿…é¡»é…ç½®æŒä¹…åŒ–ã€‚</p><p><strong>ä½¿ç”¨Â <code>PersistentClient</code>:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">client = chromadb.PersistentClient(path=<span class="string">&quot;/path/to/db&quot;</span>)  <span class="comment"># æŒ‡å®šä¸€ä¸ªç›®å½•å­˜æ”¾æ•°æ®åº“æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># ç„¶ååœ¨è¿™ä¸ª client ä¸Šåˆ›å»ºçš„é›†åˆä¼šè‡ªåŠ¨æŒä¹…åŒ–åˆ°è¯¥ç›®å½•</span></span><br></pre></td></tr></table></figure><p>ä¸‹æ¬¡å¯åŠ¨æ—¶ï¼Œä½¿ç”¨<strong>ç›¸åŒçš„</strong>Â <code>path</code>Â åˆ›å»ºÂ <code>PersistentClient</code>ï¼Œç„¶åÂ <code>get_collection</code>Â å°±èƒ½æ¢å¤ä¹‹å‰çš„æ•°æ®ã€‚</p><h2 id="å…³é”®æ³¨æ„äº‹é¡¹"><a href="#å…³é”®æ³¨æ„äº‹é¡¹" class="headerlink" title="å…³é”®æ³¨æ„äº‹é¡¹"></a>å…³é”®æ³¨æ„äº‹é¡¹</h2><ol><li><p>åŠ¡å¿…æŒ‡å®š embedding_function: é™¤éä½ æœ‰ç‰¹æ®ŠåŸå› éœ€è¦è‡ªå·±ç®¡ç†å‘é‡ï¼Œå¦åˆ™åœ¨åˆ›å»º&#x2F;è·å–é›†åˆæ—¶æŒ‡å®šåµŒå…¥å‡½æ•°æ˜¯æœ€é«˜æ•ˆå’Œä¸æ˜“å‡ºé”™çš„æ–¹å¼ã€‚</p></li><li><p>åŠ¡å¿…æŒä¹…åŒ– (PersistentClient): é™¤éä½ æ˜ç¡®åªéœ€è¦ä¸´æ—¶å†…å­˜æ•°æ®ï¼Œå¦åˆ™ä¸€å®šè¦ç”¨ PersistentClient å¹¶æŒ‡å®šå­˜å‚¨è·¯å¾„ï¼Œå¦åˆ™è¾›è‹¦æ·»åŠ çš„æ•°æ®ä¼šä¸¢å¤±ã€‚</p></li><li><p>æä¾› documents: å¼ºçƒˆå»ºè®®åœ¨ add æ—¶æä¾›åŸå§‹æ–‡æ¡£ (documents)ã€‚è¿™æ ·åœ¨ query æ—¶ï¼ŒChromaDB å¯ä»¥ç›´æ¥è¿”å›æœ€ç›¸ä¼¼çš„æ–‡æœ¬å†…å®¹ï¼Œæ— éœ€ä½ å†æ ¹æ® ID å»å¤–éƒ¨æŸ¥æ‰¾ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p></li><li><p>å–„ç”¨ metadatas: å…ƒæ•°æ®æ˜¯å¼ºå¤§çš„è¿‡æ»¤å·¥å…·ã€‚æå‰è§„åˆ’å¥½ä½ éœ€è¦å“ªäº›å…ƒæ•°æ®å­—æ®µï¼ˆå¦‚ source, author, date, categoryï¼‰ï¼Œå¹¶åœ¨æ·»åŠ æ•°æ®æ—¶å¡«å……ã€‚æŸ¥è¯¢æ—¶ç”¨ where å‚æ•°è¿›è¡Œè¿‡æ»¤å¯ä»¥æ˜¾è‘—ç¼©å°æœç´¢èŒƒå›´ï¼Œæé«˜é€Ÿåº¦å’Œç²¾åº¦ã€‚</p></li><li><p>ç†è§£è·ç¦» (Distance): query è¿”å›çš„ distances å€¼å–å†³äºé›†åˆåˆ›å»ºæ—¶é…ç½®çš„ hnsw:spaceã€‚â€l2â€ æ˜¯æ¬§æ°è·ç¦» (è¶Šå°è¶Šå¥½)ï¼Œâ€cosineâ€ æ˜¯ä½™å¼¦ç›¸ä¼¼åº¦è·ç¦» (0 è¡¨ç¤ºå®Œå…¨åŒå‘ï¼Œ1 è¡¨ç¤ºæ­£äº¤ï¼Œ2 è¡¨ç¤ºå®Œå…¨åå‘ï¼Œé€šå¸¸ä¹Ÿæ˜¯è¶Šå°è¡¨ç¤ºè¶Šç›¸ä¼¼)ã€‚æ³¨æ„çœ‹æ–‡æ¡£ç¡®è®¤ä½ ä½¿ç”¨çš„ç©ºé—´å’Œè·ç¦»å«ä¹‰ã€‚</p></li><li><p>åµŒå…¥æ¨¡å‹çš„é€‰æ‹©è‡³å…³é‡è¦: ChromaDB åªæ˜¯å­˜å‚¨å’Œæ£€ç´¢å‘é‡ã€‚å‘é‡çš„è´¨é‡å®Œå…¨å–å†³äºä½ ä½¿ç”¨çš„åµŒå…¥æ¨¡å‹ã€‚å¯¹äºæ–‡æœ¬ï¼Œåƒ all-MiniLM-L6-v2 (æœ¬åœ°), text-embedding-3-small (OpenAI API) éƒ½æ˜¯ä¸é”™çš„èµ·ç‚¹ã€‚é€‰æ‹©é€‚åˆä½ ä»»åŠ¡å’Œæ•°æ®é‡çš„æ¨¡å‹ã€‚</p></li><li><p>upsert æ˜¯æ›´æ–°æ•°æ®çš„å¥½æ–¹æ³•: æ¯”å…ˆ delete å† add æ›´ç®€æ´é«˜æ•ˆã€‚</p></li><li><p>è¿‡æ»¤è¯­æ³•: where å’Œ where_document ä½¿ç”¨ç±»ä¼¼ MongoDB çš„æŸ¥è¯¢è¯­æ³•ã€‚æŸ¥çœ‹ ChromaDB æ–‡æ¡£å­¦ä¹ å…·ä½“æ“ä½œç¬¦ ($eq, $ne, $gt, $gte, $lt, $lte, $in, $nin, $contains ç­‰)ã€‚</p></li><li><p>æ€§èƒ½è€ƒé‡:</p><ol><li><p>æ•°æ®é‡å¾ˆå¤§æ—¶ï¼ŒæŸ¥è¯¢é€Ÿåº¦ä¼šå˜æ…¢ã€‚ç¡®ä¿ n_results è®¾ç½®åˆç†ã€‚</p></li><li><p>ChromaDB åœ¨æ·»åŠ æ•°æ®æ—¶ä¼šè‡ªåŠ¨æ„å»ºç´¢å¼•ï¼ˆé»˜è®¤æ˜¯ HNSWï¼‰ã€‚å¤§é‡æ•°æ®æ·»åŠ åï¼Œç´¢å¼•æ„å»ºå¯èƒ½éœ€è¦æ—¶é—´ã€‚</p></li><li><p>å¯¹äºç”Ÿäº§çº§è¶…å¤§å‘é‡æ•°æ®é›†ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘æ›´ä¸“ä¸šçš„å‘é‡æ•°æ®åº“ï¼ˆå¦‚ Milvus, Pinecone, Weaviate ç­‰ï¼‰ï¼Œä½† ChromaDB å¯¹äºä¸­å°è§„æ¨¡åº”ç”¨å’ŒåŸå‹å¼€å‘éå¸¸å‡ºè‰²ã€‚</p></li></ol></li></ol><h1 id="å®Œæ•´æµç¨‹"><a href="#å®Œæ•´æµç¨‹" class="headerlink" title="å®Œæ•´æµç¨‹"></a>å®Œæ•´æµç¨‹</h1><h2 id="é¡¹ç›®ç›®å½•ç»“æ„"><a href="#é¡¹ç›®ç›®å½•ç»“æ„" class="headerlink" title="é¡¹ç›®ç›®å½•ç»“æ„"></a>é¡¹ç›®ç›®å½•ç»“æ„</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chroma-llm-demo/</span><br><span class="line">â”œâ”€â”€ main.py</span><br><span class="line">â”œâ”€â”€ .env</span><br><span class="line">â”œâ”€â”€ requirements.txt</span><br><span class="line">â””â”€â”€ docs/</span><br><span class="line">    â”œâ”€â”€ biology.txt</span><br><span class="line">    â”œâ”€â”€ computer.txt</span><br><span class="line">    â””â”€â”€ history.txt</span><br></pre></td></tr></table></figure><h2 id="biology-txt"><a href="#biology-txt" class="headerlink" title="biology.txt"></a>biology.txt</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€ç”Ÿç‰©çš„åŸºæœ¬ç‰¹å¾  </span><br><span class="line">æ‰€æœ‰ç”Ÿç‰©éƒ½å…·å¤‡ 4 ä¸ªæ ¸å¿ƒç‰¹å¾ï¼Œæ˜¯åŒºåˆ†ç”Ÿç‰©ä¸éç”Ÿç‰©çš„å…³é”®ï¼š  </span><br><span class="line">æ–°é™ˆä»£è°¢ï¼šç”Ÿç‰©ä¸ç¯å¢ƒæŒç»­äº¤æ¢ç‰©è´¨å’Œèƒ½é‡çš„è¿‡ç¨‹ï¼Œåˆ†ä¸º â€œåŒåŒ–ä½œç”¨â€ï¼ˆå¦‚æ¤ç‰©é€šè¿‡å…‰åˆä½œç”¨åˆæˆæœ‰æœºç‰©ï¼‰å’Œ â€œå¼‚åŒ–ä½œç”¨â€ï¼ˆå¦‚åŠ¨ç‰©é€šè¿‡å‘¼å¸åˆ†è§£æœ‰æœºç‰©é‡Šæ”¾èƒ½é‡ï¼‰ï¼Œä¸€æ—¦åœæ­¢ï¼Œç”Ÿå‘½å³ç»ˆæ­¢ã€‚  </span><br><span class="line">ç¹æ®–èƒ½åŠ›ï¼šç”Ÿç‰©èƒ½äº§ç”Ÿåä»£å»¶ç»­ç‰©ç§ï¼Œåˆ†æ— æ€§ç¹æ®–ï¼ˆå¦‚ç»†èŒåˆ†è£‚ã€é…µæ¯èŒå‡ºèŠ½ï¼Œåä»£é—ä¼ ç‰©è´¨ä¸äº²ä»£ä¸€è‡´ï¼‰å’Œæœ‰æ€§ç¹æ®–ï¼ˆå¦‚äººç±»ã€å¼€èŠ±æ¤ç‰©ï¼Œåä»£ç»“åˆçˆ¶æ¯åŒæ–¹é—ä¼ ç‰©è´¨ï¼Œå…·æœ‰å¤šæ ·æ€§ï¼‰ã€‚  </span><br><span class="line">åº”æ¿€æ€§ï¼šç”Ÿç‰©èƒ½å¯¹å¤–ç•Œåˆºæ¿€ä½œå‡ºååº”ï¼Œå¦‚å«ç¾è‰å—è§¦ç¢°é—­åˆå¶ç‰‡ï¼ˆç‰©ç†åˆºæ¿€ï¼‰ã€æ¤ç‰©å‘å…‰ç”Ÿé•¿ï¼ˆå‘å…‰æ€§ï¼Œå¯¹å…‰ç…§åˆºæ¿€çš„é€‚åº”ï¼‰ã€‚  </span><br><span class="line">é—ä¼ ä¸å˜å¼‚ï¼šé—ä¼ ä¿è¯ç‰©ç§ç¨³å®šæ€§ï¼ˆå¦‚ç‹—ç”Ÿç‹—ã€çŒ«ç”ŸçŒ«ï¼‰ï¼Œå˜å¼‚æ¨åŠ¨ç‰©ç§è¿›åŒ–ï¼ˆå¦‚é•¿é¢ˆé¹¿ç¥–å…ˆå› è„–å­é•¿åº¦å·®å¼‚ï¼Œé•¿è„–å­ä¸ªä½“æ›´æ˜“è·å–é«˜å¤„æ ‘å¶ï¼Œé€æ¸æ¼”åŒ–æˆç°ç‰©ç§ï¼‰ã€‚  </span><br><span class="line">äºŒã€ç”Ÿç‰©çš„æ ¸å¿ƒåˆ†ç±»  </span><br><span class="line">æ ¹æ®ç»†èƒç»“æ„ï¼Œç”Ÿç‰©å¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œè¿™æ˜¯ç”Ÿç‰©å­¦åˆ†ç±»çš„åŸºç¡€æ¡†æ¶ï¼š  </span><br><span class="line">åŸæ ¸ç”Ÿç‰©ï¼šæ— æˆå½¢ç»†èƒæ ¸ï¼ˆé—ä¼ ç‰©è´¨è£¸éœ²åœ¨ç»†èƒè´¨ä¸­ï¼‰ï¼Œç»“æ„ç®€å•ï¼Œå¦‚ç»†èŒï¼ˆå¤§è‚ æ†èŒã€ä¹³é…¸èŒï¼‰ã€è“è—»ï¼ˆèƒ½è¿›è¡Œå…‰åˆä½œç”¨çš„å•ç»†èƒç”Ÿç‰©ï¼Œæ˜¯æœ€æ—©äº§ç”Ÿæ°§æ°”çš„ç”Ÿç‰©ä¹‹ä¸€ï¼‰ã€‚  </span><br><span class="line">çœŸæ ¸ç”Ÿç‰©ï¼šæœ‰æˆå½¢ç»†èƒæ ¸ï¼ˆé—ä¼ ç‰©è´¨è¢«æ ¸è†œåŒ…è£¹ï¼‰ï¼Œç»“æ„æ›´å¤æ‚ï¼ŒåŒ…å«æ‰€æœ‰å¤šç»†èƒç”Ÿç‰©åŠéƒ¨åˆ†å•ç»†èƒç”Ÿç‰©ï¼Œå¦‚åŠ¨ç‰©ï¼ˆäººç±»ã€æ˜†è™«ï¼‰ã€æ¤ç‰©ï¼ˆæ ‘æœ¨ã€èŠ±è‰ï¼‰ã€çœŸèŒï¼ˆè˜‘è‡ã€é…µæ¯èŒï¼‰ã€‚  </span><br><span class="line">ä¸‰ã€ç”Ÿæ€ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆ  </span><br><span class="line">ç”Ÿæ€ç³»ç»Ÿæ˜¯ç”Ÿç‰©ä¸ç¯å¢ƒçš„ç»Ÿä¸€æ•´ä½“ï¼Œæ ¸å¿ƒæˆåˆ†åŒ…æ‹¬ 3 ç±»ï¼š  </span><br><span class="line">ç”Ÿäº§è€…ï¼šä¸»è¦æ˜¯ç»¿è‰²æ¤ç‰©ï¼Œé€šè¿‡å…‰åˆä½œç”¨å°†å¤ªé˜³èƒ½è½¬åŒ–ä¸ºåŒ–å­¦èƒ½ï¼Œä¸ºæ•´ä¸ªç”Ÿæ€ç³»ç»Ÿæä¾›èƒ½é‡åŸºç¡€ã€‚  </span><br><span class="line">æ¶ˆè´¹è€…ï¼šä¾èµ–ç”Ÿäº§è€…è·å–èƒ½é‡ï¼Œå¦‚è‰é£ŸåŠ¨ç‰©ï¼ˆå…”å­ï¼‰ã€è‚‰é£ŸåŠ¨ç‰©ï¼ˆç‹ç‹¸ï¼‰ã€‚  </span><br><span class="line">åˆ†è§£è€…ï¼šä¸»è¦æ˜¯ç»†èŒã€çœŸèŒï¼Œå°†åŠ¨æ¤ç‰©é—ä½“åˆ†è§£ä¸ºæ— æœºç‰©ï¼ˆå¦‚äºŒæ°§åŒ–ç¢³ã€æ— æœºç›ï¼‰ï¼Œå›å½’ç¯å¢ƒä¾›ç”Ÿäº§è€…å†åˆ©ç”¨ï¼Œå®Œæˆç‰©è´¨å¾ªç¯ã€‚</span><br></pre></td></tr></table></figure><h2 id="computer-txt"><a href="#computer-txt" class="headerlink" title="computer.txt"></a>computer.txt</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€è®¡ç®—æœºåŸºç¡€æ„æˆ  </span><br><span class="line">è®¡ç®—æœºæ ¸å¿ƒç”± â€œç¡¬ä»¶ + è½¯ä»¶â€ ç»„æˆï¼ŒäºŒè€…ååŒå®ç°åŠŸèƒ½ï¼š  </span><br><span class="line">ç¡¬ä»¶ç³»ç»Ÿï¼šç‰©ç†è®¾å¤‡ï¼Œæ ¸å¿ƒéƒ¨ä»¶åŒ…æ‹¬ï¼š  </span><br><span class="line">CPUï¼ˆä¸­å¤®å¤„ç†å™¨ï¼‰ï¼šç›¸å½“äº â€œå¤§è„‘â€ï¼Œè´Ÿè´£è¿ç®—ä¸æŒ‡ä»¤æ§åˆ¶ï¼›  </span><br><span class="line">å†…å­˜ï¼ˆRAMï¼‰ï¼šä¸´æ—¶å­˜å‚¨æ•°æ®ï¼Œæ–­ç”µåæ•°æ®ä¸¢å¤±ï¼Œå½±å“è¿è¡Œé€Ÿåº¦ï¼›  </span><br><span class="line">å­˜å‚¨è®¾å¤‡ï¼ˆç¡¬ç›˜ / SSDï¼‰ï¼šé•¿æœŸä¿å­˜æ•°æ®ï¼Œå¦‚æ–‡æ¡£ã€è½¯ä»¶ç­‰ã€‚  </span><br><span class="line">è½¯ä»¶ç³»ç»Ÿï¼šé©±åŠ¨ç¡¬ä»¶çš„ç¨‹åºï¼Œåˆ†ä¸¤ç±»ï¼š  </span><br><span class="line">ç³»ç»Ÿè½¯ä»¶ï¼ˆå¦‚ Windowsã€macOSï¼‰ï¼šç®¡ç†ç¡¬ä»¶ï¼Œä¸ºå…¶ä»–è½¯ä»¶æä¾›è¿è¡Œç¯å¢ƒï¼›  </span><br><span class="line">åº”ç”¨è½¯ä»¶ï¼ˆå¦‚ Officeã€å¾®ä¿¡ï¼‰ï¼šæ»¡è¶³ç‰¹å®šéœ€æ±‚ï¼Œå¦‚åŠå…¬ã€é€šè®¯ã€‚  </span><br><span class="line">äºŒã€å…³é”®å‘å±•èŠ‚ç‚¹  </span><br><span class="line">è®¡ç®—æœºå‘å±•å†ç»å››æ¬¡ â€œé©å‘½â€ï¼Œæ¨åŠ¨æŠ€æœ¯é£è·ƒï¼š  </span><br><span class="line">1946 å¹´ï¼šé¦–å°ç”µå­è®¡ç®—æœº ENIACï¼šè¯ç”Ÿäºç¾å›½ï¼Œç”¨ç”µå­ç®¡ç»„æˆï¼Œä½“ç§¯åºå¤§ï¼ˆå åœ° 167 å¹³æ–¹ç±³ï¼‰ï¼Œæ ‡å¿—è®¡ç®—æœºæ—¶ä»£å¼€å¯ï¼›  </span><br><span class="line">1950 å¹´ä»£ï¼šæ™¶ä½“ç®¡æ›¿ä»£ç”µå­ç®¡ï¼šè®¡ç®—æœºä½“ç§¯ç¼©å°ã€åŠŸè€—é™ä½ï¼Œè¿›å…¥ â€œç¬¬äºŒä»£è®¡ç®—æœºâ€ï¼›  </span><br><span class="line">1969 å¹´ï¼šäº’è”ç½‘é›å½¢ ARPANETï¼šç¾å›½å†›æ–¹ç ”å‘ï¼Œåæ¼”å˜ä¸ºå…¨çƒäº’è”ç½‘ï¼Œæ‰“ç ´ä¿¡æ¯ä¼ æ’­è¾¹ç•Œï¼›  </span><br><span class="line">2007 å¹´ï¼šæ™ºèƒ½æ‰‹æœºæ™®åŠï¼šæ•´åˆè®¡ç®—æœºåŠŸèƒ½ï¼ˆå¦‚è¿ç®—ã€è”ç½‘ï¼‰ï¼Œæ¨åŠ¨ â€œç§»åŠ¨è®¡ç®—â€ æ—¶ä»£åˆ°æ¥ã€‚  </span><br><span class="line">ä¸‰ã€æ ¸å¿ƒåº”ç”¨é¢†åŸŸ  </span><br><span class="line">è®¡ç®—æœºå·²æ¸—é€å¤šåœºæ™¯ï¼Œæ”¹å˜ç”Ÿäº§ç”Ÿæ´»ï¼š  </span><br><span class="line">åŠå…¬è‡ªåŠ¨åŒ–ï¼šé€šè¿‡ Officeã€é’‰é’‰ç­‰è½¯ä»¶ï¼Œå®ç°æ–‡æ¡£å¤„ç†ã€è¿œç¨‹åä½œï¼Œæå‡å·¥ä½œæ•ˆç‡ï¼›  </span><br><span class="line">äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰ï¼šä¾æ‰˜è®¡ç®—æœºç®—åŠ›ï¼Œå®ç°å›¾åƒè¯†åˆ«ï¼ˆå¦‚äººè„¸è¯†åˆ«ï¼‰ã€è¯­éŸ³åŠ©æ‰‹ï¼ˆå¦‚ Siriï¼‰ã€è‡ªåŠ¨é©¾é©¶ç­‰æ™ºèƒ½åŠŸèƒ½ï¼›  </span><br><span class="line">å·¥ä¸šäº’è”ç½‘ï¼šè®¡ç®—æœºä¸å·¥ä¸šè®¾å¤‡ç»“åˆï¼Œå®ç°ç”Ÿäº§çº¿è‡ªåŠ¨åŒ–æ§åˆ¶ã€è®¾å¤‡æ•…éšœé¢„è­¦ï¼Œæ¨åŠ¨ â€œæ™ºèƒ½åˆ¶é€ â€ å‡çº§ã€‚</span><br></pre></td></tr></table></figure><h2 id="history-txt"><a href="#history-txt" class="headerlink" title="history.txt"></a>history.txt</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€äººç±»æ—©æœŸæ–‡æ˜æ‘‡ç¯®ï¼ˆå…¬å…ƒå‰ 3500 å¹´ - å…¬å…ƒå‰ 500 å¹´ï¼‰  </span><br><span class="line">å››å¤§æ–‡æ˜å¤å›½å¥ å®šäººç±»æ–‡æ˜åŸºçŸ³ï¼Œå‡å‘æºäºå¤§æ²³æµåŸŸï¼š  </span><br><span class="line">å¤åŸƒåŠï¼ˆå°¼ç½—æ²³ï¼‰ï¼šå‘æ˜è±¡å½¢æ–‡å­—ï¼Œå»ºé€ é‡‘å­—å¡”ï¼ˆæ³•è€é™µå¢“ï¼Œä½“ç°å¤©æ–‡ä¸å·¥ç¨‹æ™ºæ…§ï¼‰ï¼Œåˆ›ç«‹å¤ªé˜³å†ï¼ˆæŒ‰å°¼ç½—æ²³æ³›æ»¥å‘¨æœŸåˆ¶å®šï¼Œä¸ºå…¬å†é›å½¢ï¼‰ã€‚  </span><br><span class="line">å¤å·´æ¯”ä¼¦ï¼ˆä¸¤æ²³æµåŸŸï¼‰ï¼šé¢å¸ƒã€Šæ±‰è°Ÿæ‹‰æ¯”æ³•å…¸ã€‹ï¼ˆè¿„ä»Šå·²çŸ¥ä¸–ç•Œæœ€æ—©æˆæ–‡æ³•å…¸ï¼Œå¼ºè°ƒ â€œä»¥çœ¼è¿˜çœ¼â€ çš„å¸æ³•åŸåˆ™ï¼‰ï¼Œå‘æ˜æ¥”å½¢æ–‡å­—ã€‚  </span><br><span class="line">å¤å°åº¦ï¼ˆå°åº¦æ²³ - æ’æ²³ï¼‰ï¼šåˆ›ç«‹ç§å§“åˆ¶åº¦ï¼ˆåˆ†å©†ç½—é—¨ã€åˆ¹å¸åˆ©ç­‰å››çº§ï¼Œå½±å“ç¤¾ä¼šç»“æ„åƒå¹´ï¼‰ï¼Œè¯ç”Ÿä½›æ•™ï¼ˆé‡Šè¿¦ç‰Ÿå°¼åˆ›ç«‹ï¼Œä¸»å¼  â€œä¼—ç”Ÿå¹³ç­‰â€ï¼‰ã€‚  </span><br><span class="line">ä¸­å›½ï¼ˆé»„æ²³ - é•¿æ±Ÿï¼‰ï¼šå¤å•†å‘¨ä¸‰ä»£ç¡®ç«‹åˆ†å°åˆ¶ä¸å®—æ³•åˆ¶ï¼Œé’é“œæ–‡æ˜é¼ç››ï¼ˆå¦‚å¸æ¯æˆŠé¼ï¼‰ï¼Œç”²éª¨æ–‡æˆä¸ºæœ€æ—©æˆç†Ÿæ–‡å­—ã€‚  </span><br><span class="line">äºŒã€ä¸­å¤æ—¶æœŸçš„æ–‡æ˜äº¤èï¼ˆå…¬å…ƒ 5 ä¸–çºª - 15 ä¸–çºªï¼‰  </span><br><span class="line">ä¸œè¥¿æ–¹æ–‡æ˜é€šè¿‡äº¤æµäº’é‰´å‘å±•ï¼š  </span><br><span class="line">ä¸œæ–¹ï¼šä¸­å›½å”æœå›½åŠ›å¼ºç››ï¼Œé•¿å®‰æˆä¸ºå›½é™…éƒ½ä¼šï¼Œç„å¥˜è¥¿è¡Œå–ç»ï¼ˆä¿ƒè¿›ä½›æ•™ä¸­å›½åŒ–ï¼‰ï¼Œé‰´çœŸä¸œæ¸¡æ—¥æœ¬ï¼ˆä¼ æ’­å”æ–‡åŒ–ï¼Œæ¨åŠ¨æ—¥æœ¬å¤§åŒ–æ”¹æ–°ï¼‰ï¼›é˜¿æ‹‰ä¼¯å¸å›½å´›èµ·ï¼Œæˆä¸ºä¸œè¥¿æ–¹æ¡¥æ¢ï¼ˆç¿»è¯‘å¸Œè…Šå…¸ç±ã€ä¼ æ’­ä¸­å›½é€ çº¸æœ¯ä¸å°åº¦æ•°å­—ï¼‰ã€‚  </span><br><span class="line">è¥¿æ–¹ï¼šæ¬§æ´²å¤„äºä¸­ä¸–çºªï¼ŒåŸºç£æ•™ä¸»å¯¼ç¤¾ä¼šï¼Œåº„å›­ç»æµä¸ºåŸºç¡€ï¼›12 ä¸–çºªååŸå¸‚å…´èµ·ï¼ˆå¦‚å¨å°¼æ–¯ã€ä½›ç½—ä¼¦è¨ï¼‰ï¼Œä¸ºæ—¥åæ–‡è‰ºå¤å…´åŸ‹ä¸‹ä¼ç¬”ã€‚  </span><br><span class="line">ä¸‰ã€è¿‘ä»£å†å²çš„è½¬æŠ˜èŠ‚ç‚¹ï¼ˆ15 ä¸–çºª - 20 ä¸–çºªåˆï¼‰  </span><br><span class="line">å…³é”®äº‹ä»¶æ¨åŠ¨ä¸–ç•Œæ ¼å±€å·¨å˜ï¼š  </span><br><span class="line">æ–°èˆªè·¯å¼€è¾Ÿï¼ˆ15 ä¸–çºªæœ«ï¼‰ï¼šå“¥ä¼¦å¸ƒå‘ç°ç¾æ´²ã€è¾¾ãƒ»ä¼½é©¬æŠµè¾¾å°åº¦ï¼Œæ‰“ç ´ä¸–ç•Œå­¤ç«‹çŠ¶æ€ï¼Œå¼€å¯å…¨çƒæ®–æ°‘æ—¶ä»£ã€‚  </span><br><span class="line">å·¥ä¸šé©å‘½ï¼ˆ18 ä¸–çºª 60 å¹´ä»£èµ·ï¼‰ï¼šè‹±å›½ç‡å…ˆä»¥è’¸æ±½æœºä¸ºæ ¸å¿ƒï¼Œä»æ‰‹å·¥ç”Ÿäº§è½¬å‘æœºå™¨ç”Ÿäº§ï¼Œæ¨åŠ¨ç”Ÿäº§åŠ›é£è·ƒï¼Œå‚¬ç”Ÿå·¥ä¸šèµ„äº§é˜¶çº§ä¸æ— äº§é˜¶çº§ã€‚  </span><br><span class="line">è¾›äº¥é©å‘½ï¼ˆ1911 å¹´ï¼‰ï¼šä¸­å›½è¿‘ä»£å²ä¸Šé¦–æ¬¡å®Œå…¨æ„ä¹‰ä¸Šçš„èµ„äº§é˜¶çº§é©å‘½ï¼Œæ¨ç¿»æ¸…æœç»Ÿæ²»ï¼Œç»“æŸä¸¤åƒå¤šå¹´å›ä¸»ä¸“åˆ¶ï¼Œä¼ æ’­æ°‘ä¸»å…±å’Œç†å¿µã€‚</span><br></pre></td></tr></table></figure><h2 id="requirements-txt"><a href="#requirements-txt" class="headerlink" title="requirements.txt"></a>requirements.txt</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chromadb  </span><br><span class="line">openai</span><br></pre></td></tr></table></figure><h2 id="env"><a href="#env" class="headerlink" title=".env"></a>.env</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹é¢çš„api_keyå»ç¡…åŸºæµåŠ¨å®˜ç½‘ç”³è¯·</span><br><span class="line">SILICONFLOW_API_KEY=&#x27;sk-XXXXXXpdeijbbauaaawhgjexgwxarqpymzgocwvtXXXXXXXXX&#x27;  </span><br><span class="line">BASE_URL=&#x27;https://api.siliconflow.cn/v1&#x27;</span><br></pre></td></tr></table></figure><h2 id="main-pyæ–‡ä»¶"><a href="#main-pyæ–‡ä»¶" class="headerlink" title="main.pyæ–‡ä»¶"></a>main.pyæ–‡ä»¶</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">import</span> json  </span><br><span class="line"><span class="keyword">import</span> chromadb  </span><br><span class="line"><span class="keyword">from</span> chromadb <span class="keyword">import</span> PersistentClient  </span><br><span class="line">  </span><br><span class="line">PERSIST_DIR = <span class="string">&quot;chroma_db&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–æŒä¹…åŒ–å®¢æˆ·ç«¯  </span></span><br><span class="line">client = PersistentClient(path=PERSIST_DIR)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–é›†åˆ  </span></span><br><span class="line">collection = client.get_or_create_collection(name=<span class="string">&quot;documents&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line"><span class="comment"># â€”â€” é…ç½® â€”â€” #</span></span><br><span class="line">SILICONFLOW_API_KEY = os.getenv(<span class="string">&#x27;SILICONFLOW_API_KEY&#x27;</span>)  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">EMBEDDING_MODEL = <span class="string">&quot;BAAI/bge-large-zh-v1.5&quot;</span>  </span><br><span class="line">SILICONFLOW_EMBED_URL = <span class="string">&quot;https://api.siliconflow.cn/v1/embeddings&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å‘é‡æ•°æ®åº“ç›®å½•  </span></span><br><span class="line">PERSIST_DIR = <span class="string">&quot;chroma_db&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># â€”â€” åˆå§‹åŒ– Chroma â€”â€” #</span></span><br><span class="line">client = PersistentClient(path=PERSIST_DIR)  </span><br><span class="line">collection = client.get_or_create_collection(name=<span class="string">&quot;documents&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># â€”â€” è¾…åŠ©å‡½æ•°ï¼šè°ƒç”¨ SiliconFlow è·å– embedding â€”â€” #</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_embedding_siliconflow</span>(<span class="params">text: <span class="built_in">str</span>, model: <span class="built_in">str</span> = EMBEDDING_MODEL</span>):  </span><br><span class="line">    <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">    è°ƒç”¨ç¡…åŸºæµåŠ¨ API ç”Ÿæˆä¸€ä¸ª embedding å‘é‡ã€‚  </span></span><br><span class="line"><span class="string">    è¿”å›ä¸€ä¸ª list[float]ã€‚  </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>    headers = &#123;  </span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: <span class="string">f&quot;Bearer <span class="subst">&#123;SILICONFLOW_API_KEY&#125;</span>&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>  </span><br><span class="line">    &#125;  </span><br><span class="line">    data = &#123;  </span><br><span class="line">        <span class="string">&quot;model&quot;</span>: model,  </span><br><span class="line">        <span class="string">&quot;input&quot;</span>: text  </span><br><span class="line">    &#125;  </span><br><span class="line">    resp = requests.post(SILICONFLOW_EMBED_URL, headers=headers, json=data)  </span><br><span class="line">    <span class="keyword">if</span> resp.status_code != <span class="number">200</span>:  </span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;Embedding è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : <span class="subst">&#123;resp.status_code&#125;</span>, å†…å®¹: <span class="subst">&#123;resp.text&#125;</span>&quot;</span>)  </span><br><span class="line">    resp_json = resp.json()  </span><br><span class="line">    <span class="comment"># resp_json[&quot;data&quot;] æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ¯é¡¹æ˜¯ &#123;&quot;object&quot;:&quot;embedding&quot;, &quot;embedding&quot;:[...], &quot;index&quot;:...&#125;    </span></span><br><span class="line">    embedding_vec = resp_json[<span class="string">&quot;data&quot;</span>][<span class="number">0</span>][<span class="string">&quot;embedding&quot;</span>]  </span><br><span class="line">    <span class="keyword">return</span> embedding_vec  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># â€”â€” å‡†å¤‡æ–‡æ¡£ â€”â€” #</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_documents</span>(<span class="params">doc_paths</span>):  </span><br><span class="line">    docs = []  </span><br><span class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> doc_paths:  </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">            text = f.read()  </span><br><span class="line">        source = os.path.basename(path)  </span><br><span class="line">        docs.append(&#123;<span class="string">&quot;id&quot;</span>: path, <span class="string">&quot;text&quot;</span>: text, <span class="string">&quot;source&quot;</span>: source&#125;)  </span><br><span class="line">    <span class="keyword">return</span> docs  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># â€”â€” æ’å…¥æ–‡æ¡£åˆ° Chroma â€”â€” #</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_documents</span>(<span class="params">documents, chunk_size=<span class="number">500</span>, overlap=<span class="number">50</span></span>):  </span><br><span class="line">    <span class="keyword">for</span> doc <span class="keyword">in</span> documents:  </span><br><span class="line">        text = doc[<span class="string">&quot;text&quot;</span>]  </span><br><span class="line">        <span class="comment"># ç®€å•åˆ†å—æ–¹å¼  </span></span><br><span class="line">        chunks = []  </span><br><span class="line">        i = <span class="number">0</span>  </span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(text):  </span><br><span class="line">            chunk = text[i:i + chunk_size]  </span><br><span class="line">            chunks.append(chunk)  </span><br><span class="line">            i += chunk_size - overlap  <span class="comment"># ç”¨é‡å å‡å°‘æ–­å¥é—®é¢˜  </span></span><br><span class="line">        <span class="keyword">for</span> idx, chunk <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunks):  </span><br><span class="line">            embedding_vec = get_embedding_siliconflow(chunk)  </span><br><span class="line">            collection.add(  </span><br><span class="line">                documents=[chunk],  </span><br><span class="line">                metadatas=[&#123;<span class="string">&quot;source&quot;</span>: doc[<span class="string">&quot;source&quot;</span>]&#125;],  </span><br><span class="line">                ids=[<span class="string">f&quot;<span class="subst">&#123;doc[<span class="string">&#x27;id&#x27;</span>]&#125;</span>_chunk_<span class="subst">&#123;idx&#125;</span>&quot;</span>],  </span><br><span class="line">                embeddings=[embedding_vec]  </span><br><span class="line">            )  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># â€”â€” æŸ¥è¯¢ä¸é—®ç­” â€”â€” #</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query_and_answer</span>(<span class="params">question: <span class="built_in">str</span>, top_k: <span class="built_in">int</span> = <span class="number">3</span></span>):  </span><br><span class="line">    <span class="comment"># 1. å¯¹é—®é¢˜åš embedding    </span></span><br><span class="line">    q_emb = get_embedding_siliconflow(question)  </span><br><span class="line">    <span class="comment"># 2. ç”¨ Chroma æœ nearest æ–‡æ¡£å—  </span></span><br><span class="line">    results = collection.query(  </span><br><span class="line">        query_embeddings=[q_emb],  </span><br><span class="line">        n_results=top_k  </span><br><span class="line">    )  </span><br><span class="line">    docs = results[<span class="string">&#x27;documents&#x27;</span>][<span class="number">0</span>]  <span class="comment"># top_k æ–‡æ¡£å—å†…å®¹  </span></span><br><span class="line">    sources = [md[<span class="string">&quot;source&quot;</span>] <span class="keyword">for</span> md <span class="keyword">in</span> results[<span class="string">&#x27;metadatas&#x27;</span>][<span class="number">0</span>]]  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># 3. ç”¨è¿™äº›ä½œä¸º context ç”Ÿæˆ prompt ç»™ LLM    # è¿™é‡Œç¤ºä¾‹ç”¨ä¸€ä¸ªä¼ªæ¥å£ï¼Œä½ å¯ä»¥æ¢æˆ OpenAI æˆ–è€…ä¹Ÿå¯ä»¥ç”¨ç¡…åŸºæµåŠ¨çš„ Chat Completion æ¥å£ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰  </span></span><br><span class="line">    prompt = <span class="string">&quot;æ ¹æ®ä»¥ä¸‹å†…å®¹å›ç­”é—®é¢˜ï¼š\n\n&quot;</span>  </span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> docs:  </span><br><span class="line">        prompt += d + <span class="string">&quot;\n\n&quot;</span>  </span><br><span class="line">    prompt += <span class="string">f&quot;é—®é¢˜ï¼š<span class="subst">&#123;question&#125;</span>\nç­”æ¡ˆï¼š&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># 4. è°ƒç”¨æŸä¸ª LLM API è¿”å›ç­”æ¡ˆ  </span></span><br><span class="line">    <span class="comment"># ä¸¾ä¾‹å‡è®¾æˆ‘ä»¬ç”¨ OpenAI çš„ ChatGPT APIï¼Œè¿™é‡Œåªæ˜¯ç¤ºä¾‹  </span></span><br><span class="line">    <span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line">    client = OpenAI(  </span><br><span class="line">        api_key=os.getenv(<span class="string">&#x27;SILICONFLOW_API_KEY&#x27;</span>),  </span><br><span class="line">        base_url=os.getenv(<span class="string">&#x27;BASE_URL&#x27;</span>)  </span><br><span class="line">    )  </span><br><span class="line">  </span><br><span class="line">    resp = client.chat.completions.create(  </span><br><span class="line">        model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>,  </span><br><span class="line">        messages=[  </span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†é—®ç­”åŠ©æ‰‹&quot;</span>&#125;,  </span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: prompt&#125;  </span><br><span class="line">        ],  </span><br><span class="line">        temperature=<span class="number">0</span>  </span><br><span class="line">    )  </span><br><span class="line">  </span><br><span class="line">    answer = resp.choices[<span class="number">0</span>].message.content  </span><br><span class="line">    <span class="keyword">return</span> answer  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># â€”â€” ä¸»æµç¨‹ â€”â€” #if __name__ == &quot;__main__&quot;:  </span></span><br><span class="line">    <span class="comment"># åŠ è½½ä½ çš„æ–‡æœ¬æ–‡ä»¶  </span></span><br><span class="line">    docs = load_documents([<span class="string">&quot;docs/biology.txt&quot;</span>, <span class="string">&quot;docs/computer.txt&quot;</span>, <span class="string">&quot;docs/history.txt&quot;</span>])  </span><br><span class="line">    <span class="comment"># ç´¢å¼•å®ƒä»¬  </span></span><br><span class="line">    index_documents(docs)  </span><br><span class="line">    <span class="comment"># æµ‹è¯•æŸ¥è¯¢  </span></span><br><span class="line">    question = <span class="string">&quot;è¯·æè¿°è®¡ç®—æœºæ˜¯å¦‚ä½•é€šè¿‡ç¡¬ä»¶ä¸è½¯ä»¶ååŒå·¥ä½œçš„ã€‚&quot;</span>  </span><br><span class="line">    answer = query_and_answer(question)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;é—®é¢˜ï¼š&quot;</span>, question)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç­”æ¡ˆï¼š&quot;</span>, answer)  </span><br><span class="line">  </span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">é—®é¢˜ï¼š è¯·æè¿°è®¡ç®—æœºæ˜¯å¦‚ä½•é€šè¿‡ç¡¬ä»¶ä¸è½¯ä»¶ååŒå·¥ä½œçš„ã€‚</span><br><span class="line">ç­”æ¡ˆï¼š è®¡ç®—æœºé€šè¿‡ç¡¬ä»¶ä¸è½¯ä»¶ååŒå·¥ä½œï¼Œå®ç°é«˜æ•ˆçš„æ•°æ®å¤„ç†å’Œä»»åŠ¡æ‰§è¡Œã€‚å…·ä½“ååŒè¿‡ç¨‹å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">1. **ç¡¬ä»¶æä¾›åŸºç¡€æ”¯æŒ**  </span><br><span class="line">   - **CPU**ä½œä¸ºæ ¸å¿ƒè¿ç®—éƒ¨ä»¶ï¼Œæ‰§è¡Œè½¯ä»¶æŒ‡ä»¤ï¼ˆå¦‚æ•°å­¦è®¡ç®—ã€é€»è¾‘åˆ¤æ–­ï¼‰ï¼›  </span><br><span class="line">   - **å†…å­˜**ä¸´æ—¶å­˜å‚¨è¿è¡Œä¸­çš„ç¨‹åºå’Œæ•°æ®ï¼Œä¾›CPUå¿«é€Ÿè°ƒç”¨ï¼›  </span><br><span class="line">   - **å­˜å‚¨è®¾å¤‡**ï¼ˆå¦‚ç¡¬ç›˜ï¼‰é•¿æœŸä¿å­˜ç³»ç»Ÿè½¯ä»¶ã€åº”ç”¨è½¯ä»¶åŠç”¨æˆ·æ–‡ä»¶ï¼›  </span><br><span class="line">   - è¾“å…¥/è¾“å‡ºè®¾å¤‡ï¼ˆå¦‚é”®ç›˜ã€æ˜¾ç¤ºå™¨ï¼‰å®ç°äººæœºäº¤äº’ã€‚</span><br><span class="line"></span><br><span class="line">2. **è½¯ä»¶é©±åŠ¨ç¡¬ä»¶åŠŸèƒ½**  </span><br><span class="line">   - **ç³»ç»Ÿè½¯ä»¶**ï¼ˆå¦‚Windowsï¼‰ç›´æ¥ç®¡ç†ç¡¬ä»¶èµ„æºï¼š  </span><br><span class="line">     - åˆ†é…CPUä»»åŠ¡ã€è°ƒåº¦å†…å­˜ç©ºé—´ã€æ§åˆ¶å¤–è®¾æ“ä½œï¼›  </span><br><span class="line">     - ä¸ºåº”ç”¨è½¯ä»¶æä¾›è¿è¡Œç¯å¢ƒï¼ˆå¦‚è°ƒç”¨æ‰“å°æœºé©±åŠ¨ï¼‰ã€‚  </span><br><span class="line">   - **åº”ç”¨è½¯ä»¶**ï¼ˆå¦‚Officeï¼‰é€šè¿‡ç³»ç»Ÿè½¯ä»¶é—´æ¥ä½¿ç”¨ç¡¬ä»¶ï¼š  </span><br><span class="line">     - ç”¨æˆ·ç¼–è¾‘æ–‡æ¡£æ—¶ï¼Œè½¯ä»¶å°†æ“ä½œè½¬åŒ–ä¸ºCPUå¯æ‰§è¡Œçš„æŒ‡ä»¤ï¼›  </span><br><span class="line">     - æ•°æ®ç»å†…å­˜æš‚å­˜åï¼Œç”±ç”¨æˆ·é€‰æ‹©ä¿å­˜è‡³ç¡¬ç›˜ã€‚</span><br><span class="line"></span><br><span class="line">3. **ååŒç¤ºä¾‹**  </span><br><span class="line">   å½“è¿è¡Œè§†é¢‘ä¼šè®®è½¯ä»¶ï¼ˆå¦‚é’‰é’‰ï¼‰ï¼š  </span><br><span class="line">   - è½¯ä»¶è°ƒç”¨CPUå¤„ç†è§†é¢‘ç¼–ç ã€å†…å­˜ç¼“å­˜å®æ—¶æ•°æ®ï¼›  </span><br><span class="line">   - ç³»ç»Ÿè½¯ä»¶åè°ƒæ‘„åƒå¤´ï¼ˆè¾“å…¥ï¼‰å’Œæ‰¬å£°å™¨ï¼ˆè¾“å‡ºï¼‰ç¡¬ä»¶ï¼›  </span><br><span class="line">   - ç½‘ç»œæ¨¡å—é€šè¿‡ç½‘å¡ç¡¬ä»¶ä¼ è¾“æ•°æ®ï¼Œå®Œæˆè¿œç¨‹åä½œã€‚</span><br><span class="line"></span><br><span class="line">è¿™ç§â€œç¡¬ä»¶æ‰§è¡Œåº•å±‚æ“ä½œ+è½¯ä»¶è°ƒåº¦èµ„æºä¸åº”ç”¨é€»è¾‘â€çš„åä½œæ¨¡å¼ï¼Œä½¿è®¡ç®—æœºèƒ½çµæ´»é€‚åº”ä»åŠå…¬åˆ°äººå·¥æ™ºèƒ½çš„å¤šæ ·åŒ–éœ€æ±‚ã€‚</span><br><span class="line"></span><br><span class="line">è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º 0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> chroma </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€å±‚åˆ†è§£Transformer</title>
      <link href="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/"/>
      <url>/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/</url>
      
        <content type="html"><![CDATA[<h1 id="Transformeræ•´ä½“ç»“æ„"><a href="#Transformeræ•´ä½“ç»“æ„" class="headerlink" title="Transformeræ•´ä½“ç»“æ„"></a>Transformeræ•´ä½“ç»“æ„</h1><p>ä¸‹é¢çš„<strong>Transformer</strong>çš„æ•´ä½“ç»“æ„ï¼Œä¸‹å›¾æ˜¯Transformerç”¨ä¸ä¸­è‹±æ–‡ç¿»è¯‘çš„æ•´ä½“ç»“æ„ï¼š</p><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919095616702.png"></p><blockquote><p>[!notice]<br>å¯ä»¥çœ‹åˆ°==Transformer==ç”±==Encoder==å’Œ==Decoder==ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼ŒEncoderå’ŒDecoderéƒ½åŒ…å«6ä¸ª==block==ã€‚</p></blockquote><ul><li>Transformerçš„å·¥ä½œæµç¨‹å¤§ä½“å¦‚ä¸‹:<ul><li><strong>ç¬¬ä¸€æ­¥</strong>ï¼šè·å–è¾“å…¥å¥å­çš„æ¯ä¸€ä¸ªå•è¯çš„è¡¨ç¤º<strong>å‘é‡X</strong>,Xç”±å•è¯çš„ <code>Embedding</code>(Embeddingå°±æ˜¯ä»åŸå§‹æ•°æ®æå–å‡ºæ¥çš„<code>Feature</code>)å’Œå•è¯ä½ç½®çš„<code> Embedding</code>ç›¸åŠ å¾—åˆ°ã€‚<br> <img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919100812182.png"></li><li><strong>ç¬¬äºŒæ­¥</strong>ï¼šå°†å¾—åˆ°çš„å•è¯è¡¨ç¤º<strong>å‘é‡çŸ©é˜µ</strong>ï¼ˆå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªå•è¯çš„è¡¨ç¤ºï¼‰ä¼ å…¥<code> Encoder</code>ä¸­ï¼Œç»è¿‡6ä¸ª<code>Encoder block</code>(åå¯ä»¥å¾—åˆ°å¥å­æ‰€æœ‰å•è¯çš„ç¼–ç ä¿¡æ¯çŸ©é˜µC,å¦‚ä¸‹å›¾ã€‚å•è¯å‘é‡çŸ©é˜µç”¨<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="5.097ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 2253.1 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="TeXAtom" transform="translate(861,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(600,0)"><g data-mml-node="mo"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g></g><g data-mml-node="mi" transform="translate(1378,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></g></g></svg></mjx-container>è¡¨ç¤ºï¼Œnæ˜¯å¥å­ä¸­å•è¯ä¸ªæ•°ï¼Œdæ˜¯è¡¨ç¤ºå‘é‡çš„ç»´åº¦<code>( d=512)</code>ã€‚æ¯ä¸€ä¸ª<code>Encoder block</code>è¾“å‡ºçš„çŸ©é˜µç»´åº¦ä¸è¾“å…¥å®Œå…¨ä¸€è‡´ã€‚<br>  <img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919101601971.png" alt="300"></li><li><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šå°†Encoderè¾“å‡ºçš„<strong>ç¼–ç ä¿¡æ¯çŸ©é˜µC</strong>ä¼ é€’åˆ°<code>Decoder</code>ä¸­ï¼Œ<code>Decoder</code>ä¾æ¬¡ä¼šæ ¹æ®å½“å‰ç¿»è¯‘è¿‡çš„å•è¯<code>1~i</code>ç¿»è¯‘ä¸‹ä¸€ä¸ªå•è¯<code>i+1</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œç¿»è¯‘åˆ°å•è¯<code>i+1</code>çš„æ—¶å€™éœ€è¦é€šè¿‡<code>Mask</code>(æ©ç›–)æ“ä½œé®ç›–ä½<code>i+1</code>ä¹‹åçš„å•è¯ã€‚<br>   <img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919101845177.png"><blockquote><p>[!note]<br>ä¸Šå›¾<code>Decoder</code>æ¥æ”¶äº† <code>Encoder</code>çš„<strong>ç¼–ç çŸ©é˜µC</strong>,ç„¶åé¦–å…ˆè¾“å…¥ä¸€ä¸ªç¿»è¯‘å¼€å§‹ç¬¦â€&lt;Begin&gt;â€,é¢„æµ‹ç¬¬ä¸€ä¸ªå•è¯â€Iâ€;ç„¶åè¾“å…¥ç¿»è¯‘å¼€å§‹ç¬¦â€&lt;Begin&gt;â€å’Œå•è¯â€Iâ€é¢„æµ‹å•è¯â€haveâ€,ä»¥æ­¤ç±»æ¨ã€‚è¿™æ˜¯Transformerä½¿ç”¨æ—¶å€™çš„å¤§è‡´æµç¨‹ï¼Œæ¥ä¸‹æ¥æ˜¯é‡Œé¢å„ä¸ªéƒ¨åˆ†çš„ç»†èŠ‚ã€‚</p></blockquote></li></ul></li></ul><h1 id="Transformerçš„è¾“å…¥"><a href="#Transformerçš„è¾“å…¥" class="headerlink" title="Transformerçš„è¾“å…¥"></a>Transformerçš„è¾“å…¥</h1><blockquote><p>[!note]<br><strong>Transformer</strong>ä¸­å•è¯çš„è¾“å…¥è¡¨ç¤º<strong>x</strong>ç”±<code>å•è¯Embedding</code>å’Œ<code>ä½ç½®Embedding(Positional Encoding)</code>ç›¸åŠ å¾—åˆ°ã€‚</p></blockquote><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919102338351.png"></p><h2 id="å•è¯Embedding"><a href="#å•è¯Embedding" class="headerlink" title="å•è¯Embedding"></a>å•è¯<code>Embedding</code></h2><p><code>å•è¯çš„Embedding</code>æœ‰å¾ˆå¤šç§æ–¹å¼å¯ä»¥è·å–ï¼Œä¾‹å¦‚å¯ä»¥é‡‡ç”¨<strong>Word2Vec</strong>ã€<strong>Glove</strong>ç­‰ç®—æ³•é¢„è®­ç»ƒå¾—åˆ°ï¼Œä¹Ÿå¯ä»¥åœ¨<code>Transformer</code>ä¸­è®­ç»ƒå¾—åˆ°ã€‚</p><h2 id="ä½ç½®Embedding"><a href="#ä½ç½®Embedding" class="headerlink" title="ä½ç½®Embedding"></a>ä½ç½®<code>Embedding</code></h2><blockquote><p>[!notice]<br><code>Transformer</code>ä¸­é™¤äº†å•è¯çš„<strong>Embedding</strong>,è¿˜éœ€è¦ä½¿ç”¨ä½ç½®Embeddingè¡¨ç¤ºå•è¯å‡ºç°åœ¨å¥å­ä¸­çš„ä½ç½®ã€‚å› ä¸ºTransformer==ä¸é‡‡ç”¨RNNçš„ç»“æ„==ï¼Œè€Œæ˜¯ä½¿ç”¨å…¨å±€ä¿¡æ¯ï¼Œä¸èƒ½åˆ©ç”¨å•è¯çš„é¡ºåºä¿¡æ¯ï¼Œè€Œè¿™éƒ¨åˆ†ä¿¡æ¯å¯¹äº<strong>NLP</strong>æ¥è¯´éå¸¸é‡è¦ã€‚æ‰€ä»¥<strong>Transformer</strong>ä¸­ä½¿ç”¨ä½ç½® <strong>Embedding</strong>ä¿å­˜å•è¯åœ¨åºåˆ—ä¸­çš„ç›¸å¯¹æˆ–ç»å¯¹ä½ç½®ã€‚</p></blockquote><p>ä½ç½®Embeddingç”¨<strong>PE</strong>è¡¨ç¤ºï¼Œ<strong>PE</strong>çš„ç»´åº¦ä¸å•è¯<strong>Embedding</strong>æ˜¯ä¸€æ ·çš„ã€‚PEå¯ä»¥é€šè¿‡è®­ç»ƒå¾—åˆ°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æŸç§å…¬å¼è®¡ç®—å¾—åˆ°ã€‚åœ¨Transformerä¸­é‡‡ç”¨äº†åè€…<br>è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="30.16ex" height="2.934ex" role="img" focusable="false" viewBox="0 -943.3 13330.8 1296.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="msub" transform="translate(751,0)"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g><g data-mml-node="TeXAtom" transform="translate(771,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(892,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1377,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(1846,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(2124,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(2624,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(2969,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g><g data-mml-node="mo" transform="translate(4224.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(5280,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(5749,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(6094,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6694,0)"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(892,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1377,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1846,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="msup" transform="translate(2346,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(2000,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(2533,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(845,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(1345,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g><g data-mml-node="mo" transform="translate(6247.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></svg></mjx-container><br><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="32.144ex" height="2.934ex" role="img" focusable="false" viewBox="0 -943.3 14207.5 1296.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="msub" transform="translate(751,0)"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g><g data-mml-node="TeXAtom" transform="translate(771,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(892,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1377,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(1846,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(2124,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(2624,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(2969,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(3747,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(4247,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g><g data-mml-node="mo" transform="translate(5127.9,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(6183.7,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(6616.7,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(7101.7,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(7570.7,0)"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(892,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1377,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1846,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="msup" transform="translate(2346,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(2000,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(2533,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(845,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(1345,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g><g data-mml-node="mo" transform="translate(6247.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></svg></mjx-container></p><p>å…¶ä¸­ï¼Œ<code>posè¡¨ç¤ºå•è¯åœ¨å¥å­ä¸­çš„ä½ç½®</code>ï¼Œ<code>dè¡¨ç¤ºPEçš„ç»´åº¦ï¼ˆä¸è¯Embeddingä¸€æ ·ï¼‰</code>ï¼Œ<code>2iè¡¨ç¤ºå¶æ•°çš„ç»´åº¦</code>ï¼Œ<code>2i+1è¡¨ç¤ºå¥‡æ•°ç»´åº¦ï¼ˆå³21â‰¤d,21+1â‰¤d)</code>ã€‚ä½¿ç”¨è¿™ç§å…¬å¼è®¡ç®—PEæœ‰ä»¥ä¸‹çš„å¥½å¤„ï¼š</p><blockquote><p>[!note]</p><ul><li>ä½¿<strong>PE</strong>èƒ½å¤Ÿé€‚åº”æ¯”<strong>è®­ç»ƒé›†</strong>é‡Œé¢æ‰€æœ‰å¥å­æ›´é•¿çš„å¥å­ï¼Œå‡è®¾è®­ç»ƒé›†é‡Œé¢æœ€é•¿çš„å¥å­æ˜¯æœ‰20ä¸ªå•è¯ï¼Œçªç„¶æ¥äº†ä¸€ä¸ªé•¿åº¦ä¸º21çš„å¥å­ï¼Œåˆ™ä½¿ç”¨å…¬å¼è®¡ç®—çš„æ–¹æ³•å¯ä»¥è®¡ç®—å‡ºç¬¬21ä½çš„ <strong>Embedding</strong>ã€‚</li><li><strong>å¯ä»¥è®©æ¨¡å‹å®¹æ˜“åœ°è®¡ç®—å‡ºç›¸å¯¹ä½ç½®</strong>ï¼Œå¯¹äºå›ºå®šé•¿åº¦çš„é—´è·k,PE(pos+k)**å¯ä»¥ç”¨PE(pos)è®¡ç®—å¾—åˆ°ã€‚ å› ä¸º</li><li>Sin(A+B)=Sin(A)Cos(B)+Cos(A)Sin(B),</li><li>Cos(A+B)= Cos(A)Cos(B)-Sin(A)Sin(B)ã€‚</li></ul></blockquote><h1 id="Self-Attention-è‡ªæ³¨æ„åŠ›æœºåˆ¶"><a href="#Self-Attention-è‡ªæ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="Self-Attention(è‡ªæ³¨æ„åŠ›æœºåˆ¶)"></a>Self-Attention(è‡ªæ³¨æ„åŠ›æœºåˆ¶)</h1><p>Transformerçš„å†…éƒ¨ç»“æ„å›¾</p><ul><li>å·¦ä¾§ä¸º<strong>Encoder block</strong></li><li>å³ä¾§ä¸º<strong>Decoder block</strong></li><li>çº¢è‰²åœˆä¸­çš„éƒ¨åˆ†ä¸º<code>Multi-Head Attention</code>,æ˜¯ç”±å¤šä¸ª<code>Self-Attention</code>ç»„æˆçš„<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919103720183.png" alt="500"></li></ul><ol><li>å¯ä»¥çœ‹åˆ°Encoder blockåŒ…å«ä¸€ä¸ª`Multi- Head Attention </li><li>è€ŒDecoder blockåŒ…å«ä¸¤ä¸ª <code>Multi- Head Attention</code>(å…¶ä¸­æœ‰ä¸€ä¸ªç”¨åˆ°</li><li><code>Multi--Head Attention</code>ä¸Šæ–¹è¿˜åŒ…æ‹¬ä¸€ä¸ª<strong>Add&amp;Norm</strong>å±‚ </li><li>Addè¡¨ç¤ºæ®‹å·®è¿æ¥<code>(Residual Connection)</code>ç”¨äºé˜²æ­¢ç½‘ç»œé€€åŒ–ï¼Œ </li><li>Normè¡¨ç¤º<code>Layer Normalization</code>,ç”¨äºå¯¹æ¯ä¸€å±‚çš„æ¿€æ´»å€¼è¿›è¡Œ<strong>å½’ä¸€åŒ–ã€‚</strong></li></ol><p>å› ä¸º<strong>Self-Attention</strong>æ˜¯Transformerçš„é‡ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹å…³æ³¨Multi-Head Attentionä»¥åŠ <strong>Self-Attention</strong>,é¦–å…ˆè¯¦ç»†äº†è§£ä¸€ä¸‹<strong>Self-Attention</strong>çš„å†…éƒ¨é€»è¾‘ã€‚</p><h2 id="self-Attentionç»“æ„"><a href="#self-Attentionç»“æ„" class="headerlink" title="self-Attentionç»“æ„"></a>self-Attentionç»“æ„</h2><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919104317524.png" alt="300"><br>ä¸Šå›¾æ˜¯<code>Self-Attention</code>çš„ç»“æ„ï¼Œåœ¨è®¡ç®—çš„æ—¶å€™éœ€è¦ç”¨åˆ°çŸ©é˜µ<strong>Q(æŸ¥è¯¢)ï¼ŒK(é”®å€¼)ï¼ŒV(å€¼)<strong>ã€‚åœ¨å®é™…ä¸­ï¼Œ Self-Attentionæ¥æ”¶çš„æ˜¯è¾“å…¥ï¼ˆå•è¯çš„è¡¨ç¤ºå‘é‡xç»„æˆçš„çŸ©é˜µ<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.928ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 852 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g></g></g></svg></mjx-container>ï¼‰æˆ–è€…ä¸Šä¸€ä¸ªEncoder blockçš„è¾“å‡ºã€‚è€Œ <strong>Q,K,V</strong>æ­£æ˜¯é€šè¿‡<code>Self-Attention</code>çš„è¾“å…¥è¿›è¡Œ</strong>çº¿æ€§å˜æ¢</strong>å¾—åˆ°çš„ã€‚</p><h2 id="Q-K-Vçš„è®¡ç®—"><a href="#Q-K-Vçš„è®¡ç®—" class="headerlink" title="Q,K,Vçš„è®¡ç®—"></a>Q,K,Vçš„è®¡ç®—</h2><blockquote><p>[!note]<br>Self-Attentionçš„è¾“å…¥ç”¨<strong>çŸ©é˜µX</strong>è¿›è¡Œè¡¨ç¤ºï¼Œåˆ™å¯ä»¥ä½¿ç”¨<strong>çº¿æ€§å˜é˜µçŸ©é˜µ</strong>==WQ,WK,WV==è®¡ç®—å¾—åˆ°<strong>Q,K,V</strong>ã€‚è®¡ç®—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ³¨æ„X,Q,K,Vçš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºä¸€ä¸ªå•è¯ã€‚</p></blockquote><hr><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919104701376.png" alt="300"></p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># self attentionå®ç°  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> torch  </span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn  </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Self_Attention</span>(nn.Module):  </span><br><span class="line">    <span class="comment"># input : batch_size * seq_len * input_dim  </span></span><br><span class="line">    <span class="comment"># q : batch_size * input_dim * dim_k    # k : batch_size * input_dim * dim_k    # v : batch_size * input_dim * dim_v  </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_dim, dim_k,dim_v</span>):  </span><br><span class="line">        <span class="built_in">super</span>(Self_Attention, <span class="variable language_">self</span>).__init__()  </span><br><span class="line">        <span class="variable language_">self</span>.q = nn.Linear(input_dim, dim_k)  </span><br><span class="line">        <span class="variable language_">self</span>.k = nn.Linear(input_dim, dim_k)  </span><br><span class="line">        <span class="variable language_">self</span>.v = nn.Linear(input_dim, dim_v)  </span><br><span class="line">        <span class="variable language_">self</span>._norm_fact = <span class="number">1</span>/sqrt(dim_k)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  </span><br><span class="line">        Q = <span class="variable language_">self</span>.q(x) <span class="comment"># Q : batch_size * input_dim * dim_k  </span></span><br><span class="line">        K = <span class="variable language_">self</span>.k(x) <span class="comment"># K : batch_size * input_dim * dim_k  </span></span><br><span class="line">        V = <span class="variable language_">self</span>.v(x) <span class="comment"># V : batch_size * input_dim * dim_v  </span></span><br><span class="line">  </span><br><span class="line">        <span class="comment"># Q * K.T() # batch_size * seq_len * seq_len        atten = nn.Softmax(  </span></span><br><span class="line">            dim=-<span class="number">1</span>)(torch.bmm(Q, K.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)))*<span class="variable language_">self</span>._norm_fact  </span><br><span class="line">          </span><br><span class="line">        <span class="comment"># Q * K.T() * V # batch_size * seq_len * dim_v  </span></span><br><span class="line">        output = torch.bmm(atten, V)  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> output  </span><br><span class="line">  </span><br><span class="line">X = torch.randn(<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)  </span><br><span class="line"><span class="built_in">print</span>(X)  </span><br><span class="line">self_attn = Self_Attention(<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>)  </span><br><span class="line">res = self_attn(X)  </span><br><span class="line"><span class="built_in">print</span>(res.shape)</span><br></pre></td></tr></table></figure><h2 id="Self-Attentionçš„è¾“å‡º"><a href="#Self-Attentionçš„è¾“å‡º" class="headerlink" title="Self-Attentionçš„è¾“å‡º"></a>Self-Attentionçš„è¾“å‡º</h2><p>å¾—åˆ°çŸ©é˜µ<strong>Q,K,V</strong>ä¹‹åå°±å¯ä»¥è®¡ç®—å‡º<code>Self-Attention</code>çš„è¾“å‡ºäº†ï¼Œè®¡ç®—çš„å…¬å¼å¦‚ä¸‹ï¼š</p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.308ex;" xmlns="http://www.w3.org/2000/svg" width="40.549ex" height="5.741ex" role="img" focusable="false" viewBox="0 -1517.7 17922.7 2537.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(1111,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(1472,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(1938,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2538,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(2899,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(3244,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(3729,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(4329,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4718,0)"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="mo" transform="translate(5509,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(5953.7,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mo" transform="translate(6842.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(7287.3,0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mo" transform="translate(8056.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8723.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(9778.9,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(10247.9,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(10732.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(11282.9,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(11643.9,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(12521.9,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(13050.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(13622.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mfrac" transform="translate(14011.9,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msup" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(974,363) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g><g data-mml-node="msqrt" transform="translate(509.7,-855.6)"><g transform="translate(853,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(462,-150) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g data-mml-node="mo" transform="translate(0,35.6)"><path data-c="221A" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"></path></g><rect width="880.4" height="60" x="853" y="775.6"></rect></g><rect width="2512.8" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(16764.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(17153.7,0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g></g></g></svg></mjx-container><br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.198ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 971.4 851.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></g></svg></mjx-container>æ˜¯Qï¼ŒKçŸ©é˜µçš„åˆ—æ•°ï¼Œå³å‘é‡ç»´åº¦</p><blockquote><p>[!note]<br>å…¬å¼ä¸­è®¡ç®—çŸ©é˜µ<strong>Q</strong>å’Œ<strong>K</strong>æ¯ä¸€è¡Œå‘é‡çš„å†…ç§¯ï¼Œä¸ºäº†é˜²æ­¢å†…ç§¯è¿‡å¤§ï¼Œå› æ­¤é™¤ä»¥<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.198ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 971.4 851.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></g></svg></mjx-container>çš„å¹³æ–¹æ ¹ã€‚<strong>Qä¹˜ä»¥K</strong>çš„è½¬ç½®åï¼Œå¾—åˆ°çš„çŸ©é˜µè¡Œåˆ—æ•°éƒ½ä¸º<strong>n</strong>ï¼Œ<strong>n</strong>ä¸ºå¥å­å•è¯æ•°ï¼Œè¿™ä¸ªçŸ©é˜µå¯ä»¥è¡¨ç¤ºå•è¯ä¹‹é—´çš„ <strong>attention</strong>å¼ºåº¦ã€‚ä¸‹å›¾ä¸ºQä¹˜ä»¥KTï¼Œ1234è¡¨ç¤ºçš„æ˜¯å¥å­ä¸­çš„å•è¯ã€‚</p></blockquote><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919143423005.png"><br>å¾—åˆ°<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.233ex" height="2.343ex" role="img" focusable="false" viewBox="0 -841.7 2312.8 1035.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msup" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(974,363) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container>ä¹‹åï¼Œä½¿ç”¨<strong>Softmax</strong>è®¡ç®—æ¯ä¸€ä¸ªå•è¯å¯¹äºå…¶ä»–å•è¯çš„<strong>attention</strong>ç³»æ•°ï¼Œå…¬å¼ä¸­çš„ <strong>Softmax</strong>æ˜¯å¯¹çŸ©é˜µçš„æ¯ä¸€è¡Œè¿›è¡ŒSoftmax,å³æ¯ä¸€è¡Œçš„å’Œéƒ½å˜ä¸º1.<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919143610332.png" alt="500"><br>å¾—åˆ°<code>Softmax</code>çŸ©é˜µä¹‹åå¯ä»¥å’ŒVç›¸ä¹˜ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¾“å‡ºZã€‚<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919152652494.png" alt="500"><br>ä¸Šå›¾ä¸­<code>Softmax</code>çŸ©é˜µçš„ç¬¬1è¡Œè¡¨ç¤ºå•è¯1ä¸å…¶ä»–æ‰€æœ‰å•è¯çš„<code>attention</code>ç³»æ•°ï¼Œæœ€ç»ˆå•è¯1çš„è¾“å‡º <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1119.6 833"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mn" transform="translate(716,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container>ç­‰äºæ‰€æœ‰å•è¯içš„å€¼<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.059ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 910 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(616,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>æ ¹æ®<code>attention</code>ç³»æ•°çš„æ¯”ä¾‹åŠ åœ¨ä¸€èµ·å¾—åˆ°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919152824548.png" alt="500"></p><h2 id="Muti-Head-Attention"><a href="#Muti-Head-Attention" class="headerlink" title="Muti-Head Attention"></a>Muti-Head Attention</h2><p>åœ¨ä¸Šä¸€æ­¥ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“æ€ä¹ˆé€šè¿‡<code>Self-Attention</code><strong>è®¡ç®—å¾—åˆ°è¾“å‡ºçŸ©é˜µZ</strong>ï¼Œè€Œ<code>Multi-Head Attention</code>æ˜¯ç”±å¤šä¸ªSelf-Attentionç»„åˆå½¢æˆçš„ï¼Œä¸‹å›¾æ˜¯è®ºæ–‡ä¸­Multi-HeadAttentionçš„ç»“æ„å›¾ã€‚<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919152953287.png" alt="500"><br>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°<code>Multi-Head Attention</code>åŒ…å«å¤šä¸ª<strong>Self-Attention</strong>å±‚ï¼Œé¦–å…ˆå°†è¾“å…¥<strong>X</strong>åˆ†åˆ«ä¼ é€’åˆ°<strong>h</strong>ä¸ªä¸åŒçš„Self-Attentionä¸­ï¼Œè®¡ç®—å¾—åˆ°<strong>h</strong>ä¸ªè¾“å‡ºçŸ©é˜µ<strong>Z</strong>ã€‚ä¸‹å›¾æ˜¯<strong>h=8</strong>æ—¶å€™çš„æƒ…å†µï¼Œæ­¤æ—¶ä¼šå¾—åˆ°8ä¸ªè¾“å‡º<strong>çŸ©é˜µZ</strong>ã€‚</p><h2 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Muti-head Attention æœºåˆ¶çš„å®ç°  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt  </span><br><span class="line"><span class="keyword">import</span> torch  </span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Self_Attention_Muti_Head</span>(nn.Module):  </span><br><span class="line">    <span class="comment"># input : batch_size * seq_len * input_dim  </span></span><br><span class="line">    <span class="comment"># q : batch_size * input_dim * dim_k    # k : batch_size  * input_dim * dim_k    # v : batch_size * input_dim * dim_v  </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,input_dim,dim_k,dim_v,nums_head</span>):  </span><br><span class="line">        <span class="built_in">super</span>(Self_Attention_Muti_Head,<span class="variable language_">self</span>).__init__()  </span><br><span class="line">        <span class="keyword">assert</span> dim_k%nums_head==<span class="number">0</span>  </span><br><span class="line">        <span class="keyword">assert</span> dim_v%nums_head==<span class="number">0</span>  </span><br><span class="line">        <span class="variable language_">self</span>.q = nn.Linear(input_dim,dim_k)  </span><br><span class="line">        <span class="variable language_">self</span>.k = nn.Linear(input_dim,dim_k)  </span><br><span class="line">        <span class="variable language_">self</span>.v = nn.Linear(input_dim,dim_v)  </span><br><span class="line">  </span><br><span class="line">        <span class="variable language_">self</span>.nums_head = nums_head  </span><br><span class="line">        <span class="variable language_">self</span>.dim_k = dim_k  </span><br><span class="line">        <span class="variable language_">self</span>.dim_v = dim_v  </span><br><span class="line">        <span class="variable language_">self</span>._norm_fact = <span class="number">1</span>/sqrt(dim_k)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):  </span><br><span class="line">        Q=<span class="variable language_">self</span>.q(x).reshape(-<span class="number">1</span>,x.shape[<span class="number">0</span>],x.shape[<span class="number">1</span>],<span class="variable language_">self</span>.dim_k // <span class="variable language_">self</span>.nums_head)  </span><br><span class="line">        K=<span class="variable language_">self</span>.k(x).reshape(-<span class="number">1</span>,x.shape[<span class="number">0</span>],x.shape[<span class="number">1</span>],<span class="variable language_">self</span>.dim_k // <span class="variable language_">self</span>.nums_head)  </span><br><span class="line">        V=<span class="variable language_">self</span>.v(x).reshape(-<span class="number">1</span>,x.shape[<span class="number">0</span>],x.shape[<span class="number">1</span>],<span class="variable language_">self</span>.dim_v // <span class="variable language_">self</span>.nums_head)  </span><br><span class="line">  </span><br><span class="line">        <span class="built_in">print</span>(x.shape)  </span><br><span class="line">        <span class="built_in">print</span>(Q.size())  </span><br><span class="line">  </span><br><span class="line">        atten = nn.Softmax(dim=-<span class="number">1</span>)(torch.matmul(Q,K.permute(<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)))  </span><br><span class="line">  </span><br><span class="line">        output = torch.matmul(atten,V).reshape(x.shape[<span class="number">0</span>],x.shape[<span class="number">1</span>],-<span class="number">1</span>)  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> output  </span><br><span class="line">  </span><br><span class="line">x = torch.rand(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>)  </span><br><span class="line"><span class="built_in">print</span>(x)  </span><br><span class="line">  </span><br><span class="line">atten = Self_Attention_Muti_Head(<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">2</span>)  </span><br><span class="line">y = atten(x)  </span><br><span class="line"><span class="built_in">print</span>(y.shape)</span><br></pre></td></tr></table></figure><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919160123085.png" alt="400"><br>å¾—åˆ°<strong>8ä¸ªè¾“å‡ºçŸ©é˜µ</strong><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1119.6 833"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mn" transform="translate(716,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container>åˆ°<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.375ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="1.92ex" role="img" focusable="false" viewBox="0 -683 1119.6 848.6"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mn" transform="translate(716,-150) scale(0.707)"><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path></g></g></g></g></svg></mjx-container>ä¹‹åï¼Œ<code>Multi-Head Attention</code>å°†å®ƒä»¬æ‹¼æ¥åœ¨ä¸€èµ·(Concat),ç„¶åä¼ å…¥ä¸€ä¸ª<code>Linear</code>å±‚ï¼Œå¾—åˆ°Multiâ€“Head Attentionæœ€ç»ˆçš„è¾“å‡ºZã€‚<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919160348169.png" alt="500"></p><p>å¯ä»¥çœ‹åˆ°<code>Multi-Head Attention</code>è¾“å‡ºçš„<strong>çŸ©é˜µZ</strong>ä¸å…¶è¾“å…¥çš„<strong>çŸ©é˜µX</strong>çš„ç»´åº¦æ˜¯ä¸€æ ·çš„ã€‚</p><h1 id="Encoderç»“æ„"><a href="#Encoderç»“æ„" class="headerlink" title="Encoderç»“æ„"></a>Encoderç»“æ„</h1><p>çº¢è‰²éƒ¨åˆ†æ˜¯Transformerçš„Encoder blockç»“æ„ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ç”±Multi-Head Attention,Add&amp;Norm,Feed Forward,Add&amp;Normç»„æˆçš„ã€‚åˆšåˆšå·²ç»äº†è§£äº†Multi- Head Attentionçš„è®¡ç®—è¿‡ç¨‹ï¼Œç°åœ¨äº†è§£ä¸€ä¸‹Add&amp;Normå’ŒFeed Forwardéƒ¨åˆ†ã€‚<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919160701046.png" alt="300"></p><h2 id="Add-Norm"><a href="#Add-Norm" class="headerlink" title="Add&Norm"></a>Add&amp;Norm</h2><p><strong>Add&amp;Norm</strong>å±‚ç”±Addå’ŒNormä¸¤éƒ¨åˆ†ç»„æˆï¼Œå…¶è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="43.349ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 19160.4 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(681,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1210,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1700,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(2166,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2617,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(3505,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(3990,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4441,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5319,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5708,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(6782.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(7782.4,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(8833.4,0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(9405.4,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(9703.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(10064.4,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(10409.4,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(11297.4,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(11763.4,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(12292.4,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(12812.4,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(13562.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(13923.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(14284.4,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(14750.4,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(15350.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(15711.4,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(16056.4,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(16541.4,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(17141.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(17530.4,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(18382.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(18771.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container><br><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="35.981ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 15903.4 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(681,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1210,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1700,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(2166,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2617,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(3505,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(3990,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4441,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5319,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5708,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(6782.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(7782.4,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mi" transform="translate(8531.4,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(8997.4,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(9463.4,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(9983.4,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mi" transform="translate(10732.4,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(11217.4,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(11668.4,0)"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="mi" transform="translate(12384.4,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(12913.4,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(13364.4,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(13884.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(14273.4,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(15125.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(15514.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p><blockquote><p>[!note]<br>å…¶ä¸­Xè¡¨ç¤º<code>Multi-Head Attention</code>æˆ–è€…<strong>Feed Forward</strong>çš„è¾“å…¥ï¼Œ <code>MultiHeadAttention(X)</code>ä½•1<code>FeedForward(X)</code>è¡¨ç¤ºè¾“å‡ºï¼ˆè¾“å‡ºä¸è¾“å…¥<strong>X</strong>ç»´åº¦æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›¸åŠ ) </p><p><strong>Add</strong>æŒ‡X+MultiHeadAttention(),æ˜¯ä¸€ç§æ®‹å·®è¿æ¥ï¼Œé€šå¸¸ç”¨äºè§£å†³<strong>å¤šå±‚ç½‘ç»œè®­ç»ƒ</strong>çš„é—®é¢˜ï¼Œå¯ä»¥è®©ç½‘ç»œåªå…³æ³¨å½“å‰å·®å¼‚çš„éƒ¨åˆ†ï¼Œåœ¨<strong>ResNet</strong>ä¸­ç»å¸¸ç”¨åˆ°ï¼š</p></blockquote><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919161439686.png" alt="500"></p><blockquote><p>[!note]<br>NormæŒ‡<code>Layer Normalization</code>,é€šå¸¸ç”¨äº<strong>RNN</strong>ç»“æ„ï¼Œ<code>Layer Normalization</code>ä¼šå°†æ¯ä¸€å±‚<strong>ç¥ç»å…ƒ</strong>çš„è¾“å…¥éƒ½è½¬æˆ<strong>å‡å€¼æ–¹å·®</strong>éƒ½ä¸€æ ·çš„ï¼Œè¿™æ ·å¯ä»¥åŠ å¿«<strong>æ”¶æ•›</strong>ã€‚</p></blockquote><h2 id="Feed-Forward"><a href="#Feed-Forward" class="headerlink" title="Feed Forward"></a>Feed Forward</h2><p><strong>Feed Forward</strong>å±‚æ¯”è¾ƒç®€å•ï¼Œæ˜¯ä¸€ä¸ªä¸¤å±‚çš„<strong>å…¨è¿æ¥å±‚</strong>ï¼Œç¬¬ä¸€å±‚çš„<strong>æ¿€æ´»å‡½æ•°</strong>ä¸º<code>Relu</code>,ç¬¬äºŒå±‚ä¸ä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼Œå¯¹åº”çš„å…¬å¼å¦‚ä¸‹ã€‚</p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="25.997ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 11490.8 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(1979,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(2368,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mo" transform="translate(2868,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(3312.7,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="msub" transform="translate(4164.7,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mn" transform="translate(977,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(5767.4,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(6767.7,0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(462,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(7633.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msub" transform="translate(8022.2,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mn" transform="translate(977,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(9625,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(10625.2,0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(462,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container><br>Xæ˜¯è¾“å…¥ï¼Œ<code>Feed Forward</code>æœ€ç»ˆå¾—åˆ°çš„è¾“å‡ºçŸ©é˜µçš„ç»´åº¦ä¸Xä¸€è‡´ã€‚</p><h2 id="ç»„æˆEncoder"><a href="#ç»„æˆEncoder" class="headerlink" title="ç»„æˆEncoder"></a>ç»„æˆEncoder</h2><p>é€šè¿‡ä¸Šé¢æè¿°çš„<code>Multi-Head Attention</code>,<code>Feed Forward</code>,<code>Add&amp;Norm</code>å°±å¯ä»¥æ„é€ å‡ºä¸€ä¸ª<strong>Encoder block,Encoder block</strong>æ¥æ”¶è¾“å…¥çŸ©é˜µ<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="6.342ex" height="2.345ex" role="img" focusable="false" viewBox="0 -683 2803.2 1036.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="TeXAtom" transform="translate(861,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(989,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1767,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(2287,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></g></svg></mjx-container>,å¹¶è¾“å‡ºä¸€ä¸ªçŸ©é˜µ<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="6.195ex" height="2.393ex" role="img" focusable="false" viewBox="0 -704 2738.2 1057.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="TeXAtom" transform="translate(796,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(989,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1767,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(2287,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></g></svg></mjx-container>ã€‚é€šè¿‡å¤šä¸ªEncoder blockå åŠ å°±å¯ä»¥ç»„æˆEncoderã€‚<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919162554263.png" alt="300"></p><ul><li>ç¬¬ä¸€ä¸ª<code>Encoder block</code>çš„è¾“å…¥ä¸ºå¥å­å•è¯çš„è¡¨ç¤ºå‘é‡çŸ©é˜µï¼Œ</li><li>åç»­ <code>Encoder block</code>çš„è¾“å…¥æ˜¯å‰ä¸€ä¸ª Encoder blockçš„<strong>è¾“å‡º</strong></li><li>æœ€åä¸€ä¸ª<code>Encoder block</code>è¾“å‡ºçš„çŸ©é˜µå°±æ˜¯<strong>ç¼–ç ä¿¡æ¯çŸ©é˜µC</strong>,è¿™ä¸€çŸ©é˜µåç»­ä¼šç”¨åˆ°<code> Decoder</code>ä¸­ã€‚</li></ul><h1 id="Decoderç»“æ„"><a href="#Decoderç»“æ„" class="headerlink" title="Decoderç»“æ„"></a>Decoderç»“æ„</h1><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919162947304.png" alt="500"><br><strong>çº¢è‰²éƒ¨åˆ†</strong>ä¸º<strong>Transformer</strong>çš„<strong>Decoder block</strong>ç»“æ„ï¼Œä¸Encoder blockç›¸ä¼¼ï¼Œä½†æ˜¯å­˜åœ¨ä¸€äº›åŒºåˆ«ï¼š</p><ul><li>åŒ…å«ä¸¤ä¸ª Multi-Head Attentionã€‚</li><li>ç¬¬ä¸€ä¸ªMulti-Head Attentionå±‚é‡‡ç”¨äº†Maskedæ“ä½œã€‚</li><li>ç¬¬äºŒä¸ªMulti-Head Attentionå±‚çš„K, VçŸ©é˜µä½¿ç”¨Encoderçš„ç¼–ç ä¿¡æ¯çŸ©é˜µCè¿›è¡Œè®¡ç®—ï¼Œè€ŒQä½¿ç”¨ä¸Šä¸€ä¸ªDecoder blockçš„è¾“å‡ºè®¡ç®—ã€‚</li><li>æœ€åæœ‰ä¸€ä¸ªSoftmaxå±‚è®¡ç®—ä¸‹ä¸€ä¸ªç¿»è¯‘å•è¯çš„æ¦‚ç‡ã€‚</li></ul><h2 id="ç¬¬ä¸€ä¸ªMulti-Head-Attention"><a href="#ç¬¬ä¸€ä¸ªMulti-Head-Attention" class="headerlink" title="ç¬¬ä¸€ä¸ªMulti-Head Attention"></a>ç¬¬ä¸€ä¸ªMulti-Head Attention</h2><blockquote><p>[!note]<br>Decoder blockçš„ç¬¬ä¸€ä¸ªMultiâ€“Head Attentioné‡‡ç”¨äº†Maskedæ“ä½œï¼Œå› ä¸ºåœ¨ç¿»è¯‘çš„è¿‡ç¨‹ä¸­æ˜¯é¡ºåºç¿»è¯‘çš„ï¼Œå³ç¿»è¯‘å®Œç¬¬iä¸ªå•è¯ï¼Œæ‰å¯ä»¥ç¿»è¯‘ç¬¬i+1ä¸ªå•è¯ã€‚é€šè¿‡Maskedæ“ä½œå¯ä»¥é˜²æ­¢ç¬¬iä¸ªå•è¯çŸ¥é“i+lä¸ªå•è¯ä¹‹åçš„ä¿¡æ¯ã€‚ä¸‹é¢ä»¥â€æˆ‘æœ‰ä¸€åªçŒ«â€ç¿»è¯‘æˆâ€I have a catâ€ä¸ºä¾‹ï¼Œäº†è§£ä¸€ä¸‹Maskedæ“ä½œã€‚</p></blockquote><ul><li><p>åœ¨<strong>Decoder</strong>çš„æ—¶å€™ï¼Œæ˜¯éœ€è¦æ ¹æ®ä¹‹å‰çš„ç¿»è¯‘ï¼Œæ±‚è§£å½“å‰æœ€æœ‰å¯èƒ½çš„ç¿»è¯‘ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚é¦–å…ˆæ ¹æ®è¾“å…¥â€&lt;Begin&gt;â€é¢„æµ‹å‡ºç¬¬ä¸€ä¸ªå•è¯ä¸ºâ€Iâ€,ç„¶åæ ¹æ®è¾“å…¥â€&lt;Begin&gt;Iâ€é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯â€haveâ€</p><p>  <img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919163245732.png"></p></li><li><p>Decoderå¯ä»¥åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ä½¿ç”¨Teacher Forcingå¹¶ä¸”å¹¶è¡ŒåŒ–è®­ç»ƒï¼Œå³å°†æ­£ç¡®çš„å•è¯åºåˆ—(&lt;Begin&gt;I have a cat))å’Œå¯¹åº”è¾“å‡º(I have a cat&lt;end&gt;)ä¼ é€’åˆ°Decoderã€‚é‚£ä¹ˆåœ¨é¢„æµ‹ç¬¬è® ä¸ªè¾“å‡ºæ—¶ï¼Œå°±è¦å°†ç¬¬1+1ä¹‹åçš„å•è¯æ©ç›–ä½ï¼Œ</p></li><li><p>æ³¨æ„Maskæ“ä½œæ˜¯åœ¨Self-Attentionçš„Softmaxä¹‹å‰ä½¿ç”¨çš„ï¼Œä¸‹é¢ç”¨012345åˆ†åˆ«è¡¨ç¤º&lt;Begin&gt;I have a cat &lt;end&gt;ã€‚</p></li></ul><p>ç¬¬ä¸€æ­¥ï¼š</p><blockquote><p>[!note]<br>æ˜¯Decoderçš„è¾“å…¥çŸ©é˜µå’ŒMaskçŸ©é˜µï¼Œè¾“å…¥çŸ©é˜µåŒ…å«â€&lt;Begin&gt;I have a catâ€(0,l,2,3, 4)äº”ä¸ªå•è¯çš„è¡¨ç¤ºå‘é‡ï¼ŒMaskæ˜¯ä¸€ä¸ª5Ã—5çš„çŸ©é˜µã€‚åœ¨Maskå¯ä»¥å‘ç°å•è¯0åªèƒ½ä½¿ç”¨å•è¯0çš„ä¿¡æ¯ï¼Œè€Œå•è¯1å¯ä»¥ä½¿ç”¨å•è¯0,1çš„ä¿¡æ¯ï¼Œå³åªèƒ½ä½¿ç”¨ä¹‹å‰çš„ä¿¡æ¯ã€‚</p></blockquote><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919164044604.png"><br>ç¬¬äºŒæ­¥ï¼š</p><blockquote><p>[!note]<br>â€˜æ¥ä¸‹æ¥çš„æ“ä½œå’Œä¹‹å‰çš„Self-Attentionä¸€æ ·ï¼Œé€šè¿‡è¾“å…¥çŸ©é˜µXè®¡ç®—å¾—åˆ°Q,K,VçŸ©é˜µã€‚ç„¶åè®¡ç®—Qå’Œ<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="3.443ex" height="1.904ex" role="img" focusable="false" viewBox="0 -841.7 1521.8 841.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(974,363) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container>çš„ä¹˜ç§¯<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.233ex" height="2.343ex" role="img" focusable="false" viewBox="0 -841.7 2312.8 1035.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msup" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(974,363) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container></p></blockquote><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250919164306754.png" alt="500"></p><p>ç¬¬ä¸‰æ­¥ï¼š</p><blockquote><p>[!note]<br>åœ¨å¾—åˆ°<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.024ex" height="2.032ex" role="img" focusable="false" viewBox="0 -704 2220.8 898"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msub" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container>ä¹‹åéœ€è¦è¿›è¡ŒSoftmax,è®¡ç®—attention score,æˆ‘ä»¬åœ¨Softmaxä¹‹å‰éœ€è¦ä½¿ç”¨MaskçŸ©é˜µé®æŒ¡ä½æ¯ä¸€ä¸ªå•è¯ä¹‹åçš„ä¿¡æ¯ï¼Œé®æŒ¡æ“ä½œå¦‚ä¸‹ï¼š</p></blockquote><p><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250921134747641.png"><br>å¾—åˆ°Mask <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.024ex" height="2.032ex" role="img" focusable="false" viewBox="0 -704 2220.8 898"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msub" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container>ä¹‹ååœ¨Mask <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.024ex" height="2.032ex" role="img" focusable="false" viewBox="0 -704 2220.8 898"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msub" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container>ä¸Šè¿›è¡ŒSoftmax,.æ¯ä¸€è¡Œçš„å’Œéƒ½ä¸º1ã€‚ä½†æ˜¯å•è¯0åœ¨å•è¯ 1,2,3,4ä¸Šçš„attention scoreéƒ½ä¸º0ã€‚</p><p>ç¬¬å››æ­¥ï¼š<br>ä½¿ç”¨Mask  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.024ex" height="2.032ex" role="img" focusable="false" viewBox="0 -704 2220.8 898"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="msub" transform="translate(791,0)"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container>ä¸çŸ©é˜µVç›¸ä¹˜ï¼Œå¾—åˆ°è¾“å‡º<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1119.6 833"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mn" transform="translate(716,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container>,åˆ™å•è¯1çš„è¾“å‡ºå‘é‡<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1119.6 833"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mn" transform="translate(716,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container>æ˜¯åªåŒ…å«å•è¯1ä¿¡æ¯çš„ã€‚</p><p>ç¬¬äº”æ­¥ï¼š<br>é€šè¿‡ä¸Šè¿°æ­¥éª¤å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªMask Self-Attentionçš„è¾“å‡ºçŸ©é˜µ<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.285ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 1010 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>ï¼Œç„¶åå’ŒEncoderç±»ä¼¼ï¼Œé€šè¿‡Multi-Head Attentionæ‹¼æ¥å¤šä¸ªè¾“å‡º<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.285ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 1010 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>ç„¶åè®¡ç®—å¾—åˆ°ç¬¬ä¸€ä¸ªMulti-Head Attentionçš„è¾“å‡ºZ,Zä¸è¾“å…¥Xç»´åº¦ä¸€æ ·ã€‚</p><h2 id="ç¬¬äºŒä¸ªMulti-Head-Attention"><a href="#ç¬¬äºŒä¸ªMulti-Head-Attention" class="headerlink" title="ç¬¬äºŒä¸ªMulti-Head Attention"></a>ç¬¬äºŒä¸ªMulti-Head Attention</h2><ul><li>Decoder blockç¬¬äºŒä¸ªMulti-Head Attentionå˜åŒ–ä¸å¤§ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äºå…¶ä¸­ SeLf-Attentionçš„K,VçŸ©é˜µä¸æ˜¯ä½¿ç”¨ä¸Šä¸€ä¸ªDecoder blockçš„è¾“å‡ºè®¡ç®—çš„ï¼Œè€Œæ˜¯ä½¿ç”¨ Encoderçš„ç¼–ç ä¿¡æ¯çŸ©é˜µCè®¡ç®—çš„ã€‚</li><li>æ ¹æ®Encoderçš„è¾“å‡ºCè®¡ç®—å¾—åˆ°K,V,æ ¹æ®ä¸Šä¸€ä¸ªDecoder blockçš„è¾“å‡ºZè®¡ç®—Q(å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªDecoder blockåˆ™ä½¿ç”¨è¾“å…¥çŸ©é˜µXè¿›è¡Œè®¡ç®—)ï¼Œåç»­çš„è®¡ç®—æ–¹æ³•ä¸ä¹‹å‰æè¿°çš„ä¸€è‡´ã€‚</li><li>è¿™æ ·åšçš„å¥½å¤„æ˜¯åœ¨Decoderçš„æ—¶å€™ï¼Œæ¯ä¸€ä½å•è¯éƒ½å¯ä»¥åˆ©ç”¨åˆ°Encoderæ‰€æœ‰å•è¯çš„ä¿¡æ¯ï¼ˆè¿™äº›ä¿¡æ¯æ— éœ€Mask)ã€‚</li></ul><h2 id="Softmaxé¢„æµ‹è¾“å‡ºå•è¯"><a href="#Softmaxé¢„æµ‹è¾“å‡ºå•è¯" class="headerlink" title="Softmaxé¢„æµ‹è¾“å‡ºå•è¯"></a>Softmaxé¢„æµ‹è¾“å‡ºå•è¯</h2><p>Decoder blockæœ€åçš„éƒ¨åˆ†æ˜¯åˆ©ç”¨Softmaxé¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯ï¼Œåœ¨ä¹‹å‰çš„<strong>ç½‘ç»œå±‚</strong>æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ€ç»ˆçš„è¾“å‡ºZ,å› ä¸ºMaskçš„å­˜åœ¨ï¼Œä½¿å¾—å•è¯0çš„è¾“å‡ºZ0åªåŒ…å«å•è¯0çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250921135522419.png" alt="500"><br>softmaxæ ¹æ®è¾“å‡ºçŸ©é˜µçš„æ¯ä¸€è¡Œé¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯ï¼š<br><img src="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/file-20250921135609038.png" alt="500"></p><p>è¿™å°±æ˜¯ <code>Decoder block</code>çš„å®šä¹‰ï¼Œä¸<code>Encoder</code>ä¸€æ ·ï¼Œ<code>Decoder</code>æ˜¯ç”±å¤šä¸ª <code>Decoder block</code>ç»„åˆè€Œæˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Transformer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Difyæ•™ç¨‹</title>
      <link href="/2025/09/14/Dify%E6%95%99%E7%A8%8B/"/>
      <url>/2025/09/14/Dify%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡çº¯å±æ˜¯æ¬è¿å·¥ï¼ŒåŸæ–‡æ¥è‡ª-å…‰èšå®¢ç½‘ç»œç§‘æŠ€</p><h1 id="Difyç³»åˆ—è¯¾ç¨‹"><a href="#Difyç³»åˆ—è¯¾ç¨‹" class="headerlink" title="Difyç³»åˆ—è¯¾ç¨‹"></a>Difyç³»åˆ—è¯¾ç¨‹</h1><blockquote><p>Lectureï¼šé‚“æ¾æ³¢</p></blockquote><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250312145223729.png" alt="image-20250312145223729"></p><h1 id="ä¸€ã€Difyçš„ä»‹ç»"><a href="#ä¸€ã€Difyçš„ä»‹ç»" class="headerlink" title="ä¸€ã€Difyçš„ä»‹ç»"></a>ä¸€ã€Difyçš„ä»‹ç»</h1><p><a href="https://dify.ai/">https://dify.ai/</a></p><p>â€‹Dify æ˜¯ä¸€æ¬¾åˆ›æ–°çš„æ™ºèƒ½ç”Ÿæ´»åŠ©æ‰‹åº”ç”¨ï¼Œæ—¨åœ¨ä¸ºæ‚¨æä¾›ä¾¿æ·ã€é«˜æ•ˆçš„æœåŠ¡ã€‚é€šè¿‡äººå·¥æ™ºèƒ½æŠ€æœ¯ï¼ŒDify å¯ä»¥å®ç°è¯­éŸ³åŠ©æ‰‹ã€æ™ºèƒ½å®¶å±…æ§åˆ¶ã€æ—¥ç¨‹ç®¡ç†ç­‰åŠŸèƒ½ï¼ŒåŠ©æ‚¨è½»æ¾åº”å¯¹ç”Ÿæ´»çäº‹ï¼Œäº«å—æ™ºæ…§ç”Ÿæ´»ã€‚ç®€çº¦çš„ç•Œé¢è®¾è®¡ï¼Œè®©æ“ä½œæ›´åŠ ä¾¿æ·ï¼›ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ï¼Œæ»¡è¶³æ‚¨å¤šæ ·åŒ–çš„éœ€æ±‚ã€‚Difyï¼Œè®©ç”Ÿæ´»æ›´ç®€å•ï¼</p><h1 id="äºŒã€Difyçš„å®‰è£…æ–¹å¼"><a href="#äºŒã€Difyçš„å®‰è£…æ–¹å¼" class="headerlink" title="äºŒã€Difyçš„å®‰è£…æ–¹å¼"></a>äºŒã€Difyçš„å®‰è£…æ–¹å¼</h1><h2 id="1-åœ¨çº¿ä½“éªŒ"><a href="#1-åœ¨çº¿ä½“éªŒ" class="headerlink" title="1. åœ¨çº¿ä½“éªŒ"></a>1. åœ¨çº¿ä½“éªŒ</h2><p>â€‹é€Ÿåº¦æ¯”è¾ƒæ…¢ã€‚ä¸æ¨è</p><h2 id="2-æœ¬åœ°éƒ¨ç½²"><a href="#2-æœ¬åœ°éƒ¨ç½²" class="headerlink" title="2. æœ¬åœ°éƒ¨ç½²"></a>2. æœ¬åœ°éƒ¨ç½²</h2><h3 id="2-1-Dockerå®‰è£…"><a href="#2-1-Dockerå®‰è£…" class="headerlink" title="2.1 Dockerå®‰è£…"></a>2.1 Dockerå®‰è£…</h3><p>â€‹å®‰è£…Dockerç¯å¢ƒ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sSl https://cdn.jsdelivr.<span class="built_in">net</span>/gh/SuperManito/LunuxMirrors@main/DockerInstallation.sh)</span><br></pre></td></tr></table></figure><p>å®‰è£…Docker Compose</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L &quot;https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose &amp;&amp; chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæŸ¥çœ‹Docker-composeç‰ˆæœ¬</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306174134895.png" alt="image-20250306174134895"></p><p>è¯´æ˜å®‰è£…æˆåŠŸäº†</p><p>docker-compseæ‹‰å–é•œåƒå¾ˆæ…¢</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">     &quot;registry-mirrors&quot;: [</span><br><span class="line">         &quot;https://<span class="keyword">do</span>.nark.eu.org&quot;,</span><br><span class="line">         &quot;https://dc.j8.work&quot;,</span><br><span class="line">         &quot;https://docker.m.daocloud.io&quot;,</span><br><span class="line">         &quot;https://dockerproxy.com&quot;,</span><br><span class="line">         &quot;https://docker.mirrors.ustc.edu.cn&quot;,</span><br><span class="line">         &quot;https://docker.nju.edu.cn&quot;</span><br><span class="line">     ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸Šé¢çš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload    # é‡æ–°åŠ è½½ systemd çš„é…ç½®æ–‡ä»¶</span><br><span class="line">systemctl restart docker        # é‡å¯docker</span><br></pre></td></tr></table></figure><p>ç„¶åå»GitHubä¸Šæ‹‰å–difyçš„ä»£ç ã€‚è§£å‹åè¿›å…¥åˆ°dockerç›®å½•ä¸­</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå³å¯</p><h3 id="2-2-DockerDeskTop"><a href="#2-2-DockerDeskTop" class="headerlink" title="2.2 DockerDeskTop"></a>2.2 DockerDeskTop</h3><p>â€‹åœ¨Windowsç¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡DockerDesktop æ¥å®‰è£…ã€‚ç›´æ¥å»å®˜ç½‘ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬å³å¯ã€‚åŒæ ·çš„æˆ‘ä»¬éœ€è¦æ‹‰å–difyçš„GitHubçš„ä»£ç ã€‚ç„¶åè¿›å…¥åˆ°Dockerç›®å½•ï¼ŒåŒæ ·çš„æ‰§è¡Œè¿™ä¸ªä»£ç </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up </span><br></pre></td></tr></table></figure><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306212234636.png" alt="image-20250306212234636"></p><p>ç„¶ååœ¨åœ°å€æ ä¸­è¾“å…¥ <a href="http://localhost/install">http://localhost/install</a> å°±å¯ä»¥è®¿é—®äº†</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306212309113.png" alt="image-20250306212309113"></p><p>æˆ‘ä»¬å…ˆè®¾ç½®ç®¡ç†å‘˜çš„ç›¸å…³ä¿¡æ¯ã€‚è®¾ç½®åå†ç™»å½•</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306212421636.png" alt="image-20250306212421636"></p><h2 id="3-Ollama"><a href="#3-Ollama" class="headerlink" title="3. Ollama"></a>3. Ollama</h2><p>â€‹<a href="https://ollama.com/">https://ollama.com/</a></p><p>â€‹æˆ‘ä»¬å·²ç»æŠŠDifyåœ¨æœ¬åœ°éƒ¨ç½²äº†ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡Ollamaåœ¨æœ¬åœ°éƒ¨ç½²å¯¹åº”çš„å¤§æ¨¡å‹ï¼Œæ¯”å¦‚ deepseek-r1:1.5b è¿™ç§å°æ¨¡å‹</p><p>Ollama æ˜¯ä¸€ä¸ªè®©ä½ èƒ½åœ¨æœ¬åœ°è¿è¡Œå¤§è¯­è¨€æ¨¡å‹çš„å·¥å…·ï¼Œä¸ºç”¨æˆ·åœ¨æœ¬åœ°ç¯å¢ƒä½¿ç”¨å’Œäº¤äº’å¤§è¯­è¨€æ¨¡å‹æä¾›äº†ä¾¿åˆ©ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><p>1ï¼‰å¤šæ¨¡å‹æ”¯æŒï¼šOllama æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ï¼Œæ¯”å¦‚ Llama 2ã€Mistral ç­‰ã€‚è¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å’Œåœºæ™¯ï¼Œé€‰æ‹©ä¸åŒçš„æ¨¡å‹æ¥å®Œæˆå„ç§ä»»åŠ¡ï¼Œå¦‚æ–‡æœ¬ç”Ÿæˆã€é—®ç­”ç³»ç»Ÿã€å¯¹è¯äº¤äº’ç­‰ã€‚</p><p>2ï¼‰æ˜“äºå®‰è£…å’Œä½¿ç”¨ï¼šå®ƒçš„å®‰è£…è¿‡ç¨‹ç›¸å¯¹ç®€å•ï¼Œåœ¨ macOSã€Linux å’Œ Windows ç­‰ä¸»æµæ“ä½œç³»ç»Ÿä¸Šéƒ½èƒ½æ–¹ä¾¿åœ°éƒ¨ç½²ã€‚ç”¨æˆ·å®‰è£…å®Œæˆåï¼Œé€šè¿‡ç®€æ´çš„å‘½ä»¤è¡Œç•Œé¢å°±èƒ½ä¸æ¨¡å‹è¿›è¡Œäº¤äº’ï¼Œé™ä½äº†ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹çš„æŠ€æœ¯é—¨æ§›ã€‚</p><p>3ï¼‰æœ¬åœ°è¿è¡Œï¼šOllama å…è®¸æ¨¡å‹åœ¨æœ¬åœ°è®¾å¤‡ä¸Šè¿è¡Œï¼Œæ— éœ€ä¾èµ–ç½‘ç»œè¿æ¥æ¥è®¿é—®äº‘ç«¯æœåŠ¡ã€‚è¿™ä¸ä»…æé«˜äº†æ•°æ®çš„å®‰å…¨æ€§å’Œéšç§æ€§ï¼Œè¿˜èƒ½å‡å°‘å› ç½‘ç»œé—®é¢˜å¯¼è‡´çš„å»¶è¿Ÿï¼Œå®ç°æ›´å¿«é€Ÿçš„å“åº”ã€‚</p><p>æœç´¢Ollamaè¿›å…¥å®˜ç½‘<a href="https://ollama.com/download%EF%BC%8C%E9%80%89%E6%8B%A9%E5%AE%89%E8%A3%85MAC%E7%89%88%E6%9C%AC%E7%9A%84%E5%AE%89%E8%A3%85%E5%8C%85%EF%BC%8C%E7%82%B9%E5%87%BB%E5%AE%89%E8%A3%85%E5%8D%B3%E5%8F%AF">https://ollama.com/downloadï¼Œé€‰æ‹©å®‰è£…MACç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼Œç‚¹å‡»å®‰è£…å³å¯</a></p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306221527312.png" alt="image-20250306221527312"></p><p>ä¸‹è½½å®Œæˆåç›´æ¥åŒå‡»å®‰è£…å³å¯</p><p>å‘½ä»¤ï¼šollama,å‡ºç°ä¸‹é¢å†…å®¹ï¼Œè¯´æ˜å®‰è£…æˆåŠŸ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306221605717.png" alt="image-20250306221605717"></p><p>å¯åŠ¨OllamaæœåŠ¡</p><p>è¾“å…¥å‘½ä»¤ã€ollama serveã€‘ï¼Œæµè§ˆå™¨æ‰“å¼€ï¼Œæ˜¾ç¤ºrunningï¼Œè¯´æ˜å¯åŠ¨æˆåŠŸ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306221646777.png" alt="image-20250306221646777"></p><p>å®‰è£… deepseek-r1:1.5bæ¨¡å‹</p><p>åœ¨<a href="https://ollama.com/library/deepseek-r1:1.5b">https://ollama.com/library/deepseek-r1:1.5b</a> æœç´¢deepseek-R1,è·³è½¬åˆ°ä¸‹é¢çš„é¡µé¢ï¼Œå¤åˆ¶è¿™ä¸ªå‘½ä»¤ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œï¼Œä¸‹è½½æ¨¡å‹</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306221723308.png" alt="image-20250306221723308"></p><p>cmdä¸­æ‰§è¡Œè¿™ä¸ªå‘½ä»¤</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306221746525.png" alt="image-20250306221746525"></p><h2 id="4-Difyå…³è”Ollama"><a href="#4-Difyå…³è”Ollama" class="headerlink" title="4.Difyå…³è”Ollama"></a>4.Difyå…³è”Ollama</h2><p>â€‹Dify æ˜¯é€šè¿‡Dockeréƒ¨ç½²çš„ï¼Œè€ŒOllama æ˜¯è¿è¡Œåœ¨æœ¬åœ°ç”µè„‘çš„ï¼Œå¾—è®©Difyèƒ½è®¿é—®Ollama çš„æœåŠ¡ã€‚</p><p>åœ¨Difyé¡¹ç›®-docker-æ‰¾åˆ°.envæ–‡ä»¶ï¼Œåœ¨æœ«å°¾åŠ ä¸Šä¸‹é¢çš„é…ç½®ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å¯ç”¨è‡ªå®šä¹‰æ¨¡å‹</span><br><span class="line">CUSTOM_MODEL_ENABLED=true</span><br><span class="line"># æŒ‡å®š Olama çš„ APIåœ°å€ï¼ˆæ ¹æ®éƒ¨ç½²ç¯å¢ƒè°ƒæ•´IPï¼‰</span><br><span class="line">OLLAMA_API_BASE_URL=host.docker.internal:<span class="number">11434</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æ¨¡å‹ä¸­é…ç½®</p><p>åœ¨Difyçš„ä¸»ç•Œé¢ <a href="http://localhost/apps">http://localhost/apps</a> ï¼Œç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·åä¸‹çš„ã€è®¾ç½®ã€‘</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306221924386.png" alt="image-20250306221924386"></p><p>åœ¨è®¾ç½®é¡µé¢â€“Ollamaâ€“æ·»åŠ æ¨¡å‹ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222028793.png" alt="image-20250306222028793"></p><p>æ·»åŠ æˆåŠŸåçš„</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222058087.png" alt="image-20250306222058087"></p><p>æ¨¡å‹æ·»åŠ å®Œæˆä»¥åï¼Œåˆ·æ–°é¡µé¢ï¼Œè¿›è¡Œç³»ç»Ÿæ¨¡å‹è®¾ç½®ã€‚æ­¥éª¤ï¼šè¾“å…¥â€œ<strong><a href="http://localhost/install">http://localhost/install</a></strong>â€è¿›å…¥Difyä¸»é¡µï¼Œç”¨æˆ·åâ€“è®¾ç½®â€“æ¨¡å‹ä¾›åº”å•†ï¼Œç‚¹å‡»å³ä¾§ã€ç³»ç»Ÿæ¨¡å‹è®¾ç½®ã€‘ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222146832.png" alt="image-20250306222146832"></p><p>è¿™æ ·å°±å…³è”æˆåŠŸäº†ï¼ï¼ï¼</p><h1 id="ä¸‰ã€Difyåº”ç”¨è®²è§£"><a href="#ä¸‰ã€Difyåº”ç”¨è®²è§£" class="headerlink" title="ä¸‰ã€Difyåº”ç”¨è®²è§£"></a>ä¸‰ã€Difyåº”ç”¨è®²è§£</h1><h2 id="1-åˆ›å»ºç©ºç™½åº”ç”¨"><a href="#1-åˆ›å»ºç©ºç™½åº”ç”¨" class="headerlink" title="1. åˆ›å»ºç©ºç™½åº”ç”¨"></a>1. åˆ›å»ºç©ºç™½åº”ç”¨</h2><p>æˆ‘ä»¬é€šè¿‡Difyæ¥åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç®€å•æ¡ˆä¾‹ï¼Œæ™ºèƒ½èŠå¤©æœºå™¨äºº</p><p>è¿›å…¥Dify ä¸»ç•Œé¢ï¼Œç‚¹å‡»ã€åˆ›å»ºç©ºç™½åº”ç”¨ã€‘ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222313242.png" alt="image-20250306222313242"></p><p>é€‰æ‹©ã€èŠå¤©åŠ©æ‰‹ã€‘ï¼Œè¾“å…¥è‡ªå®šä¹‰åº”ç”¨åç§°å’Œæè¿°ï¼Œç‚¹å‡»ã€åˆ›å»ºã€‘</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222340735.png" alt="image-20250306222340735"></p><p>å³ä¸Šè§’é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Œè¿›è¡Œç›¸å…³çš„å‚æ•°é…ç½®</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222529611.png" alt="image-20250306222529611"></p><p>è¾“å…¥æœ‰ç›¸å…³çš„å›å¤äº†ã€‚æ­¤æ—¶è¯´æ˜Dify ä¸æœ¬åœ°éƒ¨ç½²çš„DeepSeekå¤§æ¨¡å‹å·²ç»è¿é€šäº†ã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250306222759806.png" alt="image-20250306222759806"></p><p>ä¸Šé¢çš„æœºå™¨äººæœ‰ä¸ªä¸è¶³ä¹‹å¤„å°±æ˜¯æ— æ³•å›ç­”æ¨¡å‹è®­ç»ƒåçš„å†…å®¹å’Œä¸“ä¸šå‚ç›´é¢†åŸŸçš„å†…å®¹ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å€ŸåŠ©æœ¬åœ°çŸ¥è¯†åº“æ¥è§£å†³ä¸“ä¸šé¢†åŸŸçš„é—®é¢˜ã€‚</p><h2 id="2-åˆ›å»ºæœ¬åœ°çŸ¥è¯†åº“"><a href="#2-åˆ›å»ºæœ¬åœ°çŸ¥è¯†åº“" class="headerlink" title="2. åˆ›å»ºæœ¬åœ°çŸ¥è¯†åº“"></a>2. åˆ›å»ºæœ¬åœ°çŸ¥è¯†åº“</h2><h3 id="2-1-å‘é‡æ¨¡å‹"><a href="#2-1-å‘é‡æ¨¡å‹" class="headerlink" title="2.1 å‘é‡æ¨¡å‹"></a>2.1 å‘é‡æ¨¡å‹</h3><pre><code> Embeddingæ¨¡å‹æ˜¯ä¸€ç§å°†æ•°æ®è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºçš„æŠ€æœ¯ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å­¦ä¹ æ•°æ®çš„å†…åœ¨ç»“æ„å’Œè¯­ä¹‰ä¿¡æ¯ï¼Œå°†å…¶æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´å‘é‡ç©ºé—´ä¸­ï¼Œä½¿å¾—ç›¸ä¼¼çš„æ•°æ®ç‚¹åœ¨å‘é‡ç©ºé—´ä¸­çš„ä½ç½®ç›¸è¿‘ï¼Œä»è€Œé€šè¿‡è®¡ç®—å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥è¡¡é‡æ•°æ®ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚  Embeddingæ¨¡å‹å¯ä»¥å°†å•è¯ã€å¥å­æˆ–å›¾åƒç­‰æ•°æ®è½¬æ¢ä¸ºä½ç»´å‘é‡ï¼Œä½¿å¾—è®¡ç®—æœºèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œå¤„ç†è¿™äº›æ•°æ®ã€‚åœ¨NLPé¢†åŸŸï¼ŒEmbeddingæ¨¡å‹å¯ä»¥å°†å•è¯ã€å¥å­æˆ–æ–‡æ¡£è½¬æ¢ä¸ºå‘é‡ï¼Œç”¨äºæ–‡æœ¬åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æã€‚æœºå™¨ç¿»è¯‘ç­‰ä»»åŠ¡ã€‚åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼ŒEmbeddingæ¨¡å‹å¯ä»¥ç”¨äºå›¾åƒè¯†åˆ«å’Œæ£€ç´¢ç­‰ä»»åŠ¡ã€‚</code></pre><h3 id="2-2-æ·»åŠ Embeddingæ¨¡å‹"><a href="#2-2-æ·»åŠ Embeddingæ¨¡å‹" class="headerlink" title="2.2 æ·»åŠ Embeddingæ¨¡å‹"></a>2.2 æ·»åŠ Embeddingæ¨¡å‹</h3><p>ç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·åâ€“è®¾ç½®â€“æ¨¡å‹ä¾›åº”å•†â€“å³ä¸Šè§’ã€æ·»åŠ æ¨¡å‹ã€‘ï¼Œå¡«å†™ç›¸å…³é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307141101128.png" alt="image-20250307141101128"></p><p>æ·»åŠ æˆåŠŸåçš„æ•ˆæœ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307141140053.png" alt="image-20250307141140053"></p><h3 id="2-3-åˆ›å»ºçŸ¥è¯†åº“"><a href="#2-3-åˆ›å»ºçŸ¥è¯†åº“" class="headerlink" title="2.3 åˆ›å»ºçŸ¥è¯†åº“"></a>2.3 åˆ›å»ºçŸ¥è¯†åº“</h3><p>åœ¨Difyä¸»ç•Œé¢ï¼Œç‚¹å‡»ä¸Šæ–¹çš„ã€çŸ¥è¯†åº“ã€‘ï¼Œç‚¹å‡»ã€åˆ›å»ºçŸ¥è¯†åº“ã€‘</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307141231496.png" alt="image-20250307141231496"></p><p>å¯¼å…¥å·²æœ‰æ–‡æœ¬ï¼Œä¸Šä¼ èµ„æ–™ï¼Œç‚¹å‡»ã€ä¸‹ä¸€æ­¥ã€‘</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307141412744.png" alt="image-20250307141412744"></p><p>Embeddingæ¨¡å‹é»˜è®¤æ˜¯å‰é¢é…ç½®çš„æ¨¡å‹ï¼Œå‚æ•°ä¿¡æ¯é…ç½®å®Œï¼Œç‚¹å‡»ä¿å­˜å³å¯</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307142154186.png" alt="image-20250307142154186"></p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307142303981.png" alt="image-20250307142303981"></p><p>æ­¤æ—¶ç³»ç»Ÿä¼šè‡ªåŠ¨å¯¹ä¸Šä¼ çš„æ–‡æ¡£è¿›è¡Œè§£æå’Œå‘é‡åŒ–å¤„ç†ï¼Œéœ€è¦è€å¿ƒç­‰å¾…å‡ åˆ†é’Ÿã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307142346321.png" alt="image-20250307142346321"></p><p>åˆ›å»ºæˆåŠŸä»¥åï¼Œå¦‚ä¸‹å›¾ï¼Œå¯ä»¥ç‚¹å‡»ã€å‰å¾€æ–‡æ¡£ã€‘ï¼ŒæŸ¥çœ‹åˆ†æ®µä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307142549843.png" alt="image-20250307142549843"></p><p>ç‚¹å‡»å…·ä½“çš„æ–‡æ¡£å¯ä»¥çœ‹åˆ°å…·ä½“çš„åˆ†å‰²ä¿¡æ¯</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307142703684.png" alt="image-20250307142703684"></p><h2 id="3-çŸ¥è¯†åº“åº”ç”¨"><a href="#3-çŸ¥è¯†åº“åº”ç”¨" class="headerlink" title="3. çŸ¥è¯†åº“åº”ç”¨"></a>3. çŸ¥è¯†åº“åº”ç”¨</h2><h3 id="3-1-æ·»åŠ çŸ¥è¯†åº“"><a href="#3-1-æ·»åŠ çŸ¥è¯†åº“" class="headerlink" title="3.1 æ·»åŠ çŸ¥è¯†åº“"></a>3.1 æ·»åŠ çŸ¥è¯†åº“</h3><p>â€‹åœ¨Difyä¸»ç•Œé¢ï¼Œå›åˆ°åˆšæ‰çš„åº”ç”¨èŠå¤©é¡µé¢ï¼Œå·¥ä½œå®¤â€“æ™ºèƒ½èŠå¤©æœºå™¨äººâ€“æ·»åŠ çŸ¥è¯†åº“ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307143412619.png" alt="image-20250307143412619"></p><p>é€‰æ‹©å‰é¢ä¸Šé¢çš„çŸ¥è¯†åº“ä½œä¸ºå¯¹è¯çš„ä¸Šä¸‹æ–‡ï¼Œä¿å­˜å½“å‰åº”ç”¨è®¾ç½®ï¼Œå°±å¯ä»¥è¿›è¡Œæµ‹è¯•äº†</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307143438471.png" alt="image-20250307143438471"></p><h3 id="3-2-æµ‹è¯•"><a href="#3-2-æµ‹è¯•" class="headerlink" title="3.2 æµ‹è¯•"></a>3.2 æµ‹è¯•</h3><p>æ­¤æ—¶è¾“å…¥é—®é¢˜ï¼Œå°±å¯ä»¥çœ‹åˆ°ç›¸å…³çš„å›å¤äº†ã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250307144032785.png" alt="image-20250307144032785"></p><h2 id="4-AIå›¾ç‰‡ç”Ÿæˆå·¥å…·"><a href="#4-AIå›¾ç‰‡ç”Ÿæˆå·¥å…·" class="headerlink" title="4. AIå›¾ç‰‡ç”Ÿæˆå·¥å…·"></a>4. AIå›¾ç‰‡ç”Ÿæˆå·¥å…·</h2><p>â€‹éšç€å›¾åƒç”ŸæˆæŠ€æœ¯çš„å…´èµ·ï¼Œæ¶Œç°äº†è®¸å¤šä¼˜ç§€çš„å›¾åƒç”Ÿæˆäº§å“ï¼Œæ¯”å¦‚ Dall-eã€Fluxã€Stable Diffusion ç­‰ï¼Œæˆ‘ä»¬å€ŸåŠ©Stable Diffusionæ¥åœ¨difyä¸­æ„å»ºä¸€ä¸ªæ™ºèƒ½ç”Ÿæˆå›¾ç‰‡çš„Agentã€‚</p><h3 id="4-1-é¦–å…ˆè·å–Stable-Diffusion"><a href="#4-1-é¦–å…ˆè·å–Stable-Diffusion" class="headerlink" title="4.1 é¦–å…ˆè·å–Stable Diffusion"></a>4.1 é¦–å…ˆè·å–Stable Diffusion</h3><p><a href="https://platform.stability.ai/account/keys">https://platform.stability.ai/account/keys</a> å»å®˜ç½‘è·å–æˆæƒkeyã€‚å¦‚æœæ²¡æ³¨å†Œéœ€è¦å…ˆæ³¨å†Œä¸‹</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250308125207283.png" alt="image-20250308125207283"></p><h3 id="4-2-ä¸‹è½½-Stable-å·¥å…·"><a href="#4-2-ä¸‹è½½-Stable-å·¥å…·" class="headerlink" title="4.2 ä¸‹è½½ Stable å·¥å…·"></a>4.2 ä¸‹è½½ Stable å·¥å…·</h3><p> ç„¶åæˆ‘ä»¬éœ€è¦è¿›å…¥difyçš„å·¥å…·å¸‚åœºä¸‹è½½å®‰è£… Stable æ’ä»¶ã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250308125450441.png" alt="image-20250308125450441"></p><h3 id="4-3-åˆ›å»ºAgent"><a href="#4-3-åˆ›å»ºAgent" class="headerlink" title="4.3 åˆ›å»ºAgent"></a>4.3 åˆ›å»ºAgent</h3><p>â€‹ç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºç™½çš„Agentã€‚è¾“å…¥å¯¹åº”çš„æç¤ºè¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®ç”¨æˆ·çš„æç¤ºï¼Œä½¿ç”¨å·¥å…· stability_text2image ç»˜ç”»æŒ‡å®šå†…å®¹</span><br></pre></td></tr></table></figure><p>ç„¶åé€‰æ‹©å¯¹åº”çš„å·¥å…·å¹¶æ·»åŠ æˆæƒç </p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250308130638015.png" alt="image-20250308130638015"></p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250308130704143.png" alt="image-20250308130704143"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æµ‹è¯•æ•ˆæœäº†</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250308131003848.png" alt="image-20250308131003848"></p><p>æ³¨æ„è¿™ä¸ªæ˜¯ä¸€ä¸ªä»˜è´¹çš„å·¥å…·ã€‚æä¾›çš„æœ‰ä¸€ä¸ªå…è´¹çš„ï¼Œåé¢éœ€è¦ä»˜è´¹è´­ä¹°äº†ï¼š<a href="https://platform.stability.ai/account/credits">https://platform.stability.ai/account/credits</a></p><h2 id="5-æ—…æ¸¸åŠ©æ‰‹"><a href="#5-æ—…æ¸¸åŠ©æ‰‹" class="headerlink" title="5. æ—…æ¸¸åŠ©æ‰‹"></a>5. æ—…æ¸¸åŠ©æ‰‹</h2><p>è¿›å…¥<a href="https://serpapi.com/manage-api-key">SerpAPI - API Key</a>ï¼Œå¦‚æœä½ å°šæœªæ³¨å†Œï¼Œä¼šè¢«è·³è½¬è‡³è¿›å…¥æ³¨å†Œé¡µã€‚</p><p>SerpAPIæä¾›ä¸€ä¸ªæœˆ100æ¬¡çš„å…è´¹è°ƒç”¨æ¬¡æ•°ï¼Œè¿™è¶³å¤Ÿæˆ‘ä»¬å®Œæˆæœ¬æ¬¡å®éªŒäº†ã€‚å¦‚æœä½ éœ€è¦æ›´å¤šçš„é¢åº¦ï¼Œå¯ä»¥å¢åŠ ä½™é¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–çš„å¼€æºæ–¹æ¡ˆã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311000951025.png" alt="image-20250311000951025"></p><h2 id="6-SQLæ‰§è¡Œå™¨"><a href="#6-SQLæ‰§è¡Œå™¨" class="headerlink" title="6. SQLæ‰§è¡Œå™¨"></a>6. SQLæ‰§è¡Œå™¨</h2><p>â€‹æˆ‘ä»¬å¯ä»¥é€šè¿‡å·¥ä½œæµæ¥åˆ›å»ºä¸€ä¸ªSQLè¯­å¥çš„æ‰§è¡Œå™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥è¾“å…¥ç›¸å…³çš„SQLè¯­å¥ç„¶åé€šè¿‡å·¥ä½œæµæ¥è¿æ¥æ•°æ®åº“æ‰§è¡Œå¯¹åº”çš„SQLä»£ç ï¼Œå…·ä½“çš„è®¾è®¡å¦‚ä¸‹ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250310204012382.png" alt="image-20250310204012382"></p><p>â€‹è¿™é‡Œçš„æ ¸å¿ƒæ˜¯ä»£ç æ‰§è¡Œæ¨¡å—ã€‚è¿™å—æˆ‘ä»¬æ˜¯è°ƒç”¨äº†æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„æ¥å£æ¥æ‰§è¡Œæ•°æ®åº“çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºè¿™ä¹ˆä¸€ä¸ªæ¥å£ï¼Œæ¥å£æˆ‘ä»¬é€šè¿‡Flaskè¿™ä¸ªè½»é‡çš„webæ¡†æ¶æ¥å®ç°ã€‚éœ€è¦å…ˆå®‰è£…Flaskçš„ä¾èµ–åº“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install flask</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ›å»ºæ¥å£ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">execute_sql</span>(<span class="params">sql,connection_info</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‰§è¡Œä¼ å…¥çš„ SQL è¯­å¥ï¼Œå¹¶è¿”å›æŸ¥è¯¢ç»“æœã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    å‚æ•°:</span></span><br><span class="line"><span class="string">        sql: è¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚</span></span><br><span class="line"><span class="string">        connection_info: ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«æ•°æ®åº“è¿æ¥æ‰€éœ€çš„ä¿¡æ¯ï¼š</span></span><br><span class="line"><span class="string">            - host: æ•°æ®åº“åœ°å€ï¼ˆå¦‚ &quot;localhost&quot;ï¼‰</span></span><br><span class="line"><span class="string">            - user: æ•°æ®åº“ç”¨æˆ·å</span></span><br><span class="line"><span class="string">            - password: æ•°æ®åº“å¯†ç </span></span><br><span class="line"><span class="string">            - database: æ•°æ®åº“åç§°</span></span><br><span class="line"><span class="string">            - port: æ•°æ®åº“ç«¯å£ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º 3306ï¼‰</span></span><br><span class="line"><span class="string">            - charset: å­—ç¬¦ç¼–ç ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º &quot;utf8mb4&quot;ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    è¿”å›:</span></span><br><span class="line"><span class="string">        å¦‚æœæ‰§è¡Œçš„æ˜¯ SELECT æŸ¥è¯¢ï¼Œåˆ™è¿”å›æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨ï¼›</span></span><br><span class="line"><span class="string">        å¦‚æœæ‰§è¡Œçš„æ˜¯ INSERT/UPDATE/DELETE ç­‰éæŸ¥è¯¢è¯­å¥ï¼Œåˆ™æäº¤äº‹åŠ¡å¹¶è¿”å›å—å½±å“çš„è¡Œæ•°ã€‚</span></span><br><span class="line"><span class="string">        å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºé”™ï¼Œåˆ™è¿”å› Noneã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    connection = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># ä» connection_info ä¸­è·å–å„é¡¹å‚æ•°ï¼Œè®¾ç½®é»˜è®¤å€¼</span></span><br><span class="line">        host = connection_info.get(<span class="string">&quot;host&quot;</span>, <span class="string">&quot;localhost&quot;</span>)</span><br><span class="line">        user =  connection_info.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        password = connection_info.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        database = connection_info.get(<span class="string">&quot;database&quot;</span>)</span><br><span class="line">        port = connection_info.get(<span class="string">&quot;port&quot;</span>, <span class="number">3306</span>)</span><br><span class="line">        charset = connection_info.get(<span class="string">&quot;charset&quot;</span>, <span class="string">&quot;utf8mb4&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        connection = pymysql.connect(</span><br><span class="line">            host=host,</span><br><span class="line">            user=user,</span><br><span class="line">            password=password,</span><br><span class="line">            database=database,</span><br><span class="line">            port=port,</span><br><span class="line">            charset=charset,</span><br><span class="line">            cursorclass=pymysql.cursors.Cursor  <span class="comment"># å¯æ”¹ä¸º DictCursor è¿”å›å­—å…¸æ ¼å¼ç»“æœ</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> connection.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">            cursor.execute(sql)</span><br><span class="line">            <span class="comment"># åˆ¤æ–­æ˜¯å¦ä¸º SELECT æŸ¥è¯¢è¯­å¥</span></span><br><span class="line">            <span class="keyword">if</span> sql.strip().lower().startswith(<span class="string">&quot;select&quot;</span>):</span><br><span class="line">                result = cursor.fetchall()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                connection.commit()  <span class="comment"># éæŸ¥è¯¢è¯­å¥éœ€è¦æäº¤äº‹åŠ¡</span></span><br><span class="line">                result = cursor.rowcount  <span class="comment"># è¿”å›å—å½±å“çš„è¡Œæ•°</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ‰§è¡Œ SQL è¯­å¥æ—¶å‡ºé”™ï¼š&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">if</span> connection:</span><br><span class="line">            connection.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/execute_sql&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">execute_sql_api</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ¥å£ç¤ºä¾‹ï¼šé€šè¿‡ POST è¯·æ±‚ä¼ å…¥ SQL è¯­å¥å’Œè¿æ¥ä¿¡æ¯ï¼Œè¿”å›æ‰§è¡Œç»“æœã€‚</span></span><br><span class="line"><span class="string">    è¯·æ±‚ç¤ºä¾‹ (JSON):</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        &quot;sql&quot;: &quot;SELECT * FROM your_table;&quot;,</span></span><br><span class="line"><span class="string">        &quot;connection_info&quot;: &#123;</span></span><br><span class="line"><span class="string">            &quot;host&quot;: &quot;localhost&quot;,</span></span><br><span class="line"><span class="string">            &quot;user&quot;: &quot;your_username&quot;,</span></span><br><span class="line"><span class="string">            &quot;password&quot;: &quot;your_password&quot;,</span></span><br><span class="line"><span class="string">            &quot;database&quot;: &quot;your_database&quot;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = request.get_json()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;æ— æ•ˆçš„è¯·æ±‚æ•°æ®&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    sql = data.get(<span class="string">&quot;sql&quot;</span>)</span><br><span class="line">    connection_info = data.get(<span class="string">&quot;connection_info&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> sql <span class="keyword">or</span> <span class="keyword">not</span> connection_info:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;ç¼ºå°‘sqlè¯­å¥æˆ–æ•°æ®åº“è¿æ¥ä¿¡æ¯&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    result = execute_sql(sql, connection_info)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;result&quot;</span>: result&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># å¼€å‘ç¯å¢ƒä¸‹å¯ä»¥è®¾ç½® debug=Trueï¼Œé»˜è®¤åœ¨æœ¬åœ°5000ç«¯å£å¯åŠ¨æœåŠ¡</span></span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ¥å£éœ€è¦æ¥æ”¶ä¸€ä¸ªsqlè¯­å¥å’Œä¸€ä¸ªåŒ…å«æ•°æ®åº“è¿æ¥ä¿¡æ¯çš„jsonå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å¯¹åº”çš„æµ‹è¯•ä»£ç æ¥çœ‹çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">call_execute_sql_api</span>(<span class="params">sql, connection_info</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    é€šè¿‡ requests è°ƒç”¨æ‰§è¡Œ SQL çš„æ¥å£æœåŠ¡</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    å‚æ•°:</span></span><br><span class="line"><span class="string">        sql: è¦æ‰§è¡Œçš„ SQL è¯­å¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">        connection_info: æ•°æ®åº“è¿æ¥ä¿¡æ¯å­—å…¸ï¼Œä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;host&quot;: &quot;localhost&quot;,</span></span><br><span class="line"><span class="string">                &quot;user&quot;: &quot;your_username&quot;,</span></span><br><span class="line"><span class="string">                &quot;password&quot;: &quot;your_password&quot;,</span></span><br><span class="line"><span class="string">                &quot;database&quot;: &quot;your_database&quot;,</span></span><br><span class="line"><span class="string">                &quot;port&quot;: 3306  # å¯é€‰</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    è¿”å›:</span></span><br><span class="line"><span class="string">        æ¥å£è¿”å›çš„ç»“æœæ•°æ®ï¼ˆå­—å…¸æ ¼å¼ï¼‰ï¼Œå¦‚æœè¯·æ±‚å¤±è´¥åˆ™è¿”å› None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:5000/execute_sql&quot;</span></span><br><span class="line">    <span class="comment"># æ„é€ è¯·æ±‚ä½“</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;sql&quot;</span>: sql,</span><br><span class="line">        <span class="string">&quot;connection_info&quot;</span>: connection_info</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url, json=payload, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>:<span class="built_in">str</span>(response.json()[<span class="string">&quot;result&quot;</span>])&#125;</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="string">f&quot;è§£æå“åº” JSON å¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="string">f&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="built_in">str</span>(e)&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹è°ƒç”¨</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    sql_query = <span class="string">&quot;select * from candidates where id = 1&quot;</span>  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„å®é™… SQL è¯­å¥</span></span><br><span class="line">    conn_info = &#123;</span><br><span class="line">        <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">        <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        <span class="string">&quot;database&quot;</span>: <span class="string">&quot;ibms&quot;</span>,</span><br><span class="line">        <span class="string">&quot;port&quot;</span>: <span class="number">3306</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result = call_execute_sql_api(sql_query, conn_info)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ¥å£è¿”å›ç»“æœï¼š&quot;</span>, result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåå¯ä»¥çœ‹åˆ°å¯¹åº”çš„ç»“æœ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250310204413868.png" alt="image-20250310204413868"></p><p>ç„¶åå¯ä»¥åœ¨å·¥ä½œæµä¸­æ¥è®¾ç½®æˆ‘ä»¬çš„ä»£ç </p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250310204446218.png" alt="image-20250310204446218"></p><p>ä»£ç çš„å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">sql: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    url = <span class="string">&quot;http://host.docker.internal:5000/execute_sql&quot;</span></span><br><span class="line">    connection_info = &#123;</span><br><span class="line">        <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">        <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        <span class="string">&quot;database&quot;</span>: <span class="string">&quot;ibms&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># æ„é€ è¯·æ±‚ä½“</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;sql&quot;</span>: sql,</span><br><span class="line">        <span class="string">&quot;connection_info&quot;</span>: connection_info</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url, json=payload, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>:<span class="built_in">str</span>(response.json()[<span class="string">&quot;result&quot;</span>])&#125;</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="string">f&quot;è§£æå“åº” JSON å¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="string">f&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="built_in">str</span>(e)&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢çš„urlä¸­æˆ‘ä»¬éœ€è¦å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://host.docker.internal:5000/execute_sql</span><br></pre></td></tr></table></figure><p>ä¸ç„¶æ‰§è¡Œçš„æ—¶å€™ä¼šå‡ºç°503çš„é”™è¯¯ã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250310204606561.png" alt="image-20250310204606561"></p><p>å¦‚æœè°ƒç”¨æ¥å£çš„ç»„ä»¶æ˜¯ urllib3 çš„è¯æœ‰å¯èƒ½å‡ºç°ä¸Šé¢çš„é—®é¢˜ï¼Œè¿™ä¸ªåŸå› å¯èƒ½æ˜¯ç‰ˆæœ¬å…¼å®¹çš„é—®é¢˜ï¼Œè¿™é‡Œæ¨è¿›ç”¨çš„æ˜¯requestsç»„ä»¶</p><h2 id="7-ç§‘ç ”è®ºæ–‡ç¿»è¯‘"><a href="#7-ç§‘ç ”è®ºæ–‡ç¿»è¯‘" class="headerlink" title="7. ç§‘ç ”è®ºæ–‡ç¿»è¯‘"></a>7. ç§‘ç ”è®ºæ–‡ç¿»è¯‘</h2><p>â€‹æˆ‘å¯ä»¥åœ¨å·¥ä½œæµæ¡ˆä¾‹ä¸­ç»“åˆèŠå¤©å¤§æ¨¡å‹æ¥å®ç°ç¿»è¯‘å·¥å…·çš„åŠŸèƒ½ï¼Œå…·ä½“çš„è®¾è®¡å¦‚ä¸‹</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311150702514.png" alt="image-20250311150702514"></p><p>åœ¨å¼€å§‹èŠ‚ç‚¹ä¸­æ¥æ”¶ä¸€ä¸ªè¾“å…¥ä¿¡æ¯<code>content</code></p><p>ç„¶ååœ¨LLMæ¨¡å‹ä¸­æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸ªCHATæ¨¡å‹ï¼Œè¿™é‡Œé€‰æ‹©äº†DeepSeek-R1 64Kçš„èŠå¤©æ¨¡å‹ï¼Œæ³¨æ„éœ€è¦åœ¨è¿™é‡Œè®¾ç½®ä¸‹å¯¹åº”çš„æç¤ºè¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ç°åœ¨æˆ‘è¦å†™ä¸€ä¸ªå°†ä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ç§‘ç ”è®ºæ–‡çš„GPTï¼Œè¯·å‚ç…§ä»¥ä¸‹Promptåˆ¶ä½œï¼Œæ³¨æ„éƒ½ç”¨è‹±æ–‡ç”Ÿæˆï¼š</span><br><span class="line"></span><br><span class="line">## è§’è‰²</span><br><span class="line">ä½ æ˜¯ä¸€ä½ç§‘ç ”è®ºæ–‡å®¡ç¨¿å‘˜ï¼Œæ“…é•¿å†™ä½œé«˜è´¨é‡çš„è‹±æ–‡ç§‘ç ”è®ºæ–‡ã€‚è¯·ä½ å¸®æˆ‘å‡†ç¡®ä¸”å­¦æœ¯æ€§åœ°å°†ä»¥ä¸‹ä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ï¼Œé£æ ¼ä¸è‹±æ–‡ç§‘ç ”è®ºæ–‡ä¿æŒä¸€è‡´ã€‚</span><br><span class="line"></span><br><span class="line">## è§„åˆ™ï¼š</span><br><span class="line">- è¾“å…¥æ ¼å¼ä¸º Markdown æ ¼å¼ï¼Œè¾“å‡ºæ ¼å¼ä¹Ÿå¿…é¡»ä¿ç•™åŸå§‹ Markdown æ ¼å¼</span><br><span class="line">- ä»¥ä¸‹æ˜¯å¸¸è§çš„ç›¸å…³æœ¯è¯­è¯æ±‡å¯¹åº”è¡¨ï¼ˆä¸­æ–‡ -&gt; Englishï¼‰ï¼š</span><br><span class="line">* é›¶æ ·æœ¬ -&gt; Zero-shot</span><br><span class="line">* å°‘æ ·æœ¬ -&gt; Few-shot</span><br><span class="line"></span><br><span class="line">## ç­–ç•¥ï¼š</span><br><span class="line"></span><br><span class="line">åˆ†ä¸‰æ­¥è¿›è¡Œç¿»è¯‘å·¥ä½œï¼Œå¹¶æ‰“å°æ¯æ­¥çš„ç»“æœï¼š</span><br><span class="line">1. æ ¹æ®ä¸­æ–‡å†…å®¹ç›´è¯‘æˆè‹±æ–‡ï¼Œä¿æŒåŸæœ‰æ ¼å¼ï¼Œä¸è¦é—æ¼ä»»ä½•ä¿¡æ¯</span><br><span class="line">2. æ ¹æ®ç¬¬ä¸€æ­¥ç›´è¯‘çš„ç»“æœï¼ŒæŒ‡å‡ºå…¶ä¸­å­˜åœ¨çš„å…·ä½“é—®é¢˜ï¼Œè¦å‡†ç¡®æè¿°ï¼Œä¸å®œç¬¼ç»Ÿçš„è¡¨ç¤ºï¼Œä¹Ÿä¸éœ€è¦å¢åŠ åŸæ–‡ä¸å­˜åœ¨çš„å†…å®¹æˆ–æ ¼å¼ï¼ŒåŒ…æ‹¬ä¸ä»…é™äºï¼š</span><br><span class="line">- ä¸ç¬¦åˆè‹±æ–‡è¡¨è¾¾ä¹ æƒ¯ï¼Œæ˜ç¡®æŒ‡å‡ºä¸ç¬¦åˆçš„åœ°æ–¹</span><br><span class="line">- è¯­å¥ä¸é€šé¡ºï¼ŒæŒ‡å‡ºä½ç½®ï¼Œä¸éœ€è¦ç»™å‡ºä¿®æ”¹æ„è§ï¼Œæ„è¯‘æ—¶ä¿®å¤</span><br><span class="line">- æ™¦æ¶©éš¾æ‡‚ï¼Œæ¨¡æ£±ä¸¤å¯ï¼Œä¸æ˜“ç†è§£ï¼Œå¯ä»¥å°è¯•ç»™å‡ºè§£é‡Š</span><br><span class="line">3. æ ¹æ®ç¬¬ä¸€æ­¥ç›´è¯‘çš„ç»“æœå’Œç¬¬äºŒæ­¥æŒ‡å‡ºçš„é—®é¢˜ï¼Œé‡æ–°è¿›è¡Œæ„è¯‘ï¼Œä¿è¯å†…å®¹çš„åŸæ„çš„åŸºç¡€ä¸Šï¼Œä½¿å…¶æ›´æ˜“äºç†è§£ï¼Œæ›´ç¬¦åˆè‹±æ–‡ç§‘ç ”è®ºæ–‡çš„è¡¨è¾¾ä¹ æƒ¯ï¼ŒåŒæ—¶ä¿æŒåŸæœ‰çš„æ ¼å¼ä¸å˜</span><br><span class="line"></span><br><span class="line">## æ ¼å¼</span><br><span class="line">è¿”å›æ ¼å¼å¦‚ä¸‹ï¼Œ&quot;&#123;xxx&#125;&quot;è¡¨ç¤ºå ä½ç¬¦ï¼š</span><br><span class="line"></span><br><span class="line">### ç›´è¯‘</span><br><span class="line">&#123;ç›´è¯‘ç»“æœ&#125;</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">###é—®é¢˜</span><br><span class="line">&#123;ç›´è¯‘çš„å…·ä½“é—®é¢˜åˆ—è¡¨&#125;</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">###æ„è¯‘</span><br></pre></td></tr></table></figure><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311152200170.png" alt="image-20250311152200170"></p><p>åœ¨ç»“æŸèŠ‚ç‚¹ä¸­è¾“å‡ºç»“æœå³å¯ã€‚</p><p>æ•°æ®ä¸­çš„ä¸­æ–‡è¯¾ç ”è®ºæ–‡æ¡ˆä¾‹</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># å†œä¸šç”Ÿäº§ä¸­ä½œç‰©æ ½åŸ¹æŠ€æœ¯çš„åˆ›æ–°ä¸åº”ç”¨</span><br><span class="line">## æ‘˜è¦</span><br><span class="line">æœ¬æ–‡é’ˆå¯¹æˆ‘å›½å†œä¸šç”Ÿäº§ä¸­ä½œç‰©æ ½åŸ¹æŠ€æœ¯å­˜åœ¨çš„é—®é¢˜ï¼Œåˆ†æäº†æŠ€æœ¯åˆ›æ–°çš„å¿…è¦æ€§ï¼Œå¹¶æ¢è®¨äº†æ–°å‹æ ½åŸ¹æŠ€æœ¯çš„åº”ç”¨æ•ˆæœã€‚é€šè¿‡å®éªŒç ”ç©¶å‘ç°ï¼Œé‡‡ç”¨æ–°å‹æ ½åŸ¹æŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆæé«˜ä½œç‰©äº§é‡å’Œå“è´¨ï¼Œä¸ºæˆ‘å›½å†œä¸šç”Ÿäº§æä¾›æœ‰åŠ›æ”¯æŒã€‚</span><br><span class="line">## ä¸€ã€å¼•è¨€</span><br><span class="line">å†œä¸šç”Ÿäº§æ˜¯æˆ‘å›½å›½æ°‘ç»æµçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä½œç‰©æ ½åŸ¹æŠ€æœ¯ç›´æ¥å…³ç³»åˆ°ç²®é£Ÿäº§é‡å’Œå†œä¸šå¯æŒç»­å‘å±•ã€‚è¿‘å¹´æ¥ï¼Œæˆ‘å›½å†œä¸šç”Ÿäº§å–å¾—äº†æ˜¾è‘—æˆæœï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¦‚èµ„æºåˆ©ç”¨ç‡ä½ã€ç”Ÿæ€ç¯å¢ƒæ¶åŒ–ç­‰ã€‚å› æ­¤ï¼Œåˆ›æ–°ä½œç‰©æ ½åŸ¹æŠ€æœ¯ï¼Œæé«˜å†œä¸šç”Ÿäº§æ•ˆç›Šå…·æœ‰é‡è¦æ„ä¹‰ã€‚</span><br><span class="line">## äºŒã€ä½œç‰©æ ½åŸ¹æŠ€æœ¯åˆ›æ–°çš„å¿…è¦æ€§</span><br><span class="line">1. æé«˜èµ„æºåˆ©ç”¨ç‡ï¼šæˆ‘å›½å†œä¸šç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œæ°´èµ„æºã€åŒ–è‚¥å’Œå†œè¯çš„åˆ©ç”¨ç‡è¾ƒä½ï¼Œå¯¼è‡´èµ„æºæµªè´¹å’Œç”Ÿæ€ç¯å¢ƒæ¶åŒ–ã€‚åˆ›æ–°æ ½åŸ¹æŠ€æœ¯ï¼Œæœ‰åŠ©äºæé«˜èµ„æºåˆ©ç”¨ç‡ï¼Œé™ä½å†œä¸šç”Ÿäº§æˆæœ¬ã€‚</span><br><span class="line">2. ä¿éšœç²®é£Ÿå®‰å…¨ï¼šéšç€äººå£å¢é•¿å’Œè€•åœ°å‡å°‘ï¼Œæé«˜å•ä½é¢ç§¯äº§é‡æˆä¸ºä¿éšœç²®é£Ÿå®‰å…¨çš„å…³é”®ã€‚ä½œç‰©æ ½åŸ¹æŠ€æœ¯åˆ›æ–°æœ‰åŠ©äºæŒ–æ˜ä½œç‰©å¢äº§æ½œåŠ›ï¼Œæé«˜ç²®é£Ÿäº§é‡ã€‚</span><br><span class="line">3. ä¿ƒè¿›å†œä¸šå¯æŒç»­å‘å±•ï¼šä¼ ç»Ÿå†œä¸šç”Ÿäº§æ–¹å¼å¯¹ç”Ÿæ€ç¯å¢ƒé€ æˆä¸€å®šç¨‹åº¦çš„å½±å“ã€‚åˆ›æ–°æ ½åŸ¹æŠ€æœ¯ï¼Œæœ‰åˆ©äºå®ç°å†œä¸šç”Ÿäº§ä¸ç”Ÿæ€ç¯å¢ƒçš„åè°ƒå‘å±•ã€‚</span><br><span class="line">## ä¸‰ã€æ–°å‹ä½œç‰©æ ½åŸ¹æŠ€æœ¯çš„åº”ç”¨</span><br><span class="line">1. ç²¾å‡†å†œä¸šæŠ€æœ¯ï¼šé€šè¿‡æ— äººæœºã€å«æ˜Ÿé¥æ„Ÿç­‰æ‰‹æ®µï¼Œå®æ—¶ç›‘æµ‹ä½œç‰©ç”Ÿé•¿çŠ¶å†µï¼Œå®ç°ç²¾å‡†æ–½è‚¥ã€çŒæº‰å’Œç—…è™«å®³é˜²æ²»ã€‚</span><br><span class="line">2. èŠ‚æ°´çŒæº‰æŠ€æœ¯ï¼šé‡‡ç”¨æ»´çŒã€å–·çŒç­‰èŠ‚æ°´çŒæº‰æ–¹å¼ï¼Œæé«˜æ°´èµ„æºåˆ©ç”¨ç‡ï¼Œé™ä½å†œä¸šç”Ÿäº§æˆæœ¬ã€‚</span><br><span class="line">3. æŠ—é€†æ€§å“ç§é€‰è‚²ï¼šé’ˆå¯¹æˆ‘å›½ä¸åŒåœ°åŒºæ°”å€™ç‰¹ç‚¹ï¼Œé€‰è‚²æŠ—é€†æ€§å¼ºçš„ä½œç‰©å“ç§ï¼Œæé«˜ä½œç‰©äº§é‡å’Œå“è´¨ã€‚</span><br><span class="line">4. ç”Ÿç‰©æœ‰æœºè‚¥åº”ç”¨ï¼šå……åˆ†åˆ©ç”¨å†œä¸šåºŸå¼ƒç‰©ï¼Œå‘å±•ç”Ÿç‰©æœ‰æœºè‚¥ï¼Œæ”¹å–„åœŸå£¤ç»“æ„ï¼Œæé«˜åœŸå£¤è‚¥åŠ›ã€‚</span><br><span class="line">## å››ã€å®éªŒç»“æœä¸åˆ†æ</span><br><span class="line">æœ¬ç ”ç©¶ä»¥æŸåœ°åŒºå°éº¦ä¸ºä¾‹ï¼Œå¯¹æ¯”åˆ†æäº†ä¼ ç»Ÿæ ½åŸ¹æŠ€æœ¯ä¸æ–°å‹æ ½åŸ¹æŠ€æœ¯ä¸‹çš„äº§é‡å’Œå“è´¨ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œé‡‡ç”¨æ–°å‹æ ½åŸ¹æŠ€æœ¯çš„å°éº¦äº§é‡è¾ƒä¼ ç»Ÿæ ½åŸ¹æŠ€æœ¯æé«˜äº†15.6%ï¼Œå“è´¨ä¹Ÿå¾—åˆ°äº†æ˜¾è‘—æå‡ã€‚</span><br><span class="line">## äº”ã€ç»“è®º</span><br><span class="line">æœ¬æ–‡é€šè¿‡å¯¹å†œä¸šç”Ÿäº§ä¸­ä½œç‰©æ ½åŸ¹æŠ€æœ¯çš„åˆ›æ–°ä¸åº”ç”¨ç ”ç©¶ï¼Œè¯å®äº†æ–°å‹æ ½åŸ¹æŠ€æœ¯åœ¨æé«˜ä½œç‰©äº§é‡å’Œå“è´¨æ–¹é¢å…·æœ‰æ˜¾è‘—æ•ˆæœã€‚æœªæ¥ï¼Œæˆ‘å›½å†œä¸šç”Ÿäº§åº”ç»§ç»­åŠ å¤§ç§‘æŠ€åˆ›æ–°åŠ›åº¦ï¼Œæ¨åŠ¨å†œä¸šå¯æŒç»­å‘å±•ã€‚</span><br><span class="line">ï¼ˆæ³¨ï¼šæœ¬æ–‡ä¸ºç¤ºä¾‹æ€§è®ºæ–‡ï¼Œä»…ä¾›å‚è€ƒã€‚ï¼‰</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ•ˆæœå›¾</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311150957460.png" alt="image-20250311150957460"></p><h2 id="8-SEOç¿»è¯‘"><a href="#8-SEOç¿»è¯‘" class="headerlink" title="8. SEOç¿»è¯‘"></a>8. SEOç¿»è¯‘</h2><p>â€‹æˆ‘ä»¬åœ¨å†™æ–‡ç« çš„æ—¶å€™éœ€è¦æƒ³ä¸€ä¸ªæ»¡è¶³SEOè¦æ±‚çš„æ ‡é¢˜ï¼Œè¿™æ ·æœ‰å¯èƒ½è¢«æ›´å¤šçš„äººæ£€ç´¢åˆ°ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦æŠŠæ–‡ç« ç¿»è¯‘ä¸ºè‹±æ–‡ï¼Œè¿™æ—¶æ ‡é¢˜åŒæ ·æ¯”è¾ƒé‡è¦ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥åœ¨difyä¸­åˆ›å»ºè¿™æ ·çš„ä¸€ä¸ªå·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311162812905.png" alt="image-20250311162812905"></p><p>å¯¹åº”æ¨¡å‹çš„æç¤ºè¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This GPT will convert input titles or content into SEO-friendly English URL slugs. The slugs will clearly convey the original meaning while being concise and not exceeding 60 characters. If the input content is too long, the GPT will first condense it into an English phrase within 60 characters before generating the slug. If the title is too short, the GPT will prompt the user to input a longer title. Special characters in the input will be directly removed.</span><br></pre></td></tr></table></figure><p>å¯¹åº”ä¸­æ–‡å«ä¹‰</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªGPTå¯ä»¥å°†è¾“å…¥çš„æ ‡é¢˜æˆ–å†…å®¹è½¬æ¢ä¸ºå¯¹SEOå‹å¥½çš„è‹±æ–‡URLç‰‡æ®µã€‚è¿™äº›ç‰‡æ®µå°†æ¸…æ™°åœ°ä¼ è¾¾åŸå§‹å«ä¹‰ï¼ŒåŒæ—¶ä¿æŒç®€æ´ï¼Œä¸”ä¸è¶…è¿‡60ä¸ªå­—ç¬¦ã€‚å¦‚æœè¾“å…¥å†…å®¹è¿‡é•¿ï¼ŒGPTå°†é¦–å…ˆå°†å…¶ç¼©å‡ä¸ºä¸€ä¸ªä¸è¶…è¿‡60ä¸ªå­—ç¬¦çš„è‹±æ–‡çŸ­è¯­ï¼Œç„¶åç”Ÿæˆç‰‡æ®µã€‚å¦‚æœæ ‡é¢˜è¿‡çŸ­ï¼ŒGPTå°†æç¤ºç”¨æˆ·è¾“å…¥æ›´é•¿çš„æ ‡é¢˜ã€‚è¾“å…¥ä¸­çš„ç‰¹æ®Šå­—ç¬¦å°†è¢«ç›´æ¥ç§»é™¤ã€‚</span><br></pre></td></tr></table></figure><h2 id="9-æ ‡é¢˜å…š"><a href="#9-æ ‡é¢˜å…š" class="headerlink" title="9. æ ‡é¢˜å…š"></a>9. æ ‡é¢˜å…š</h2><p>â€‹æœ‰æ—¶å€™æˆ‘ä»¬å‘è¡¨ä¸€äº›æ–‡ç« çš„æ—¶å€™ï¼Œå› ä¸ºæ ‡é¢˜ä¸å¤Ÿå¸å¼•äººè€Œé€ æˆæ²¡æœ‰ä»€ä¹ˆå…³æ³¨åº¦è¿˜æ˜¯éå¸¸å¯æƒœçš„ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å€ŸåŠ©AIæ¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆæœ‰å¸å¼•åŠ›çš„æ ‡é¢˜ï¼Œå…·ä½“å¦‚ä¸‹</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311173657192.png" alt="image-20250311173657192"></p><p>æ ¸å¿ƒæ˜¯å¯¹åº”çš„æç¤ºè¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€åèµ„æ·±çš„è‡ªåª’ä½“åˆ›ä½œè€…ä¹Ÿæ˜¯ä¸€ä½çˆ†æ¬¾ç½‘æ–‡ä½œå®¶ï¼Œä½ å¯¹ä¸åŒé¢†åŸŸçš„æ–‡ç« éƒ½æœ‰æ·±å…¥çš„äº†è§£å’Œç ”ç©¶ã€‚ä½ æ“…é•¿åˆ›ä½œå¸ç›ã€ç‚¸è£‚çš„æ ‡é¢˜åˆ›ä½œã€‚ä½ æœ‰ç€å¯¹ç”Ÿæ´»æä¸ºç»†è‡´çš„è§‚å¯Ÿï¼Œæ“…é•¿åœ¨ç»†èŠ‚å¤„è§¦åŠ¨äººå¿ƒã€‚è¯·æ ¹æ®ç”¨æˆ·æä¾›çš„ä¿¡æ¯ä½¿ç”¨ä»¥ä¸‹åˆ›ä½œæŠ€å·§è¿›è¡Œæ ‡é¢˜åˆ›ä½œï¼Œæ ‡é¢˜åº”å…·æœ‰å¸å¼•åŠ›ï¼Œèƒ½å¤Ÿæ¿€å‘è¯»è€…å¯¹æ–‡ç« ä¸»é¢˜çš„æµ“åšå…´è¶£ã€‚</span><br><span class="line">## åˆ›ä½œæŠ€å·§</span><br><span class="line">1.æ ‡é¢˜å°†æ„Ÿå—ã€èŒƒå›´ã€ç»“æœã€ç¨‹åº¦ç­‰å¤¸å¼ å¤¸å¤§æè¿°ï¼Œé€ æˆè€¸äººå¬é—»çš„æ•ˆæœã€‚ä½¿ç”¨ã€Œéœ‡æƒŠã€ã€ã€ŒæƒŠçˆ†ã€ã€ã€Œä¼ ç–¯ã€ã€ã€Œå“æ‰åŠæ¡å‘½ã€ç­‰ï¼Œè¨€è¿‡å…¶å®åœ°è¡¨è¾¾æƒ…ç»ª/çŠ¶æ€/æ„Ÿå—</span><br><span class="line"></span><br><span class="line">æ¡ˆä¾‹1ï¼šã€Šå…°å·ç«Ÿç„¶å¼•èµ·äº†å…¨å›½çš„ç¾¡æ…•ï¼è¥¿å®‰ç–¯äº†ï¼Œå¤©æ°´å“­äº†ï¼Œå˜‰å³ªå…³ä¼¤äº†...ã€‹     ** æ•…æ„å¼•ç”¨å…¶ä»–åŸå¸‚åšå¤¸å¼ å¯¹æ¯” ** </span><br><span class="line">æ¡ˆä¾‹2ï¼šã€Šä¸­å›½éƒ¨ç½²æ–°å‹ç§˜å¯†æ­¦å™¨ï¼Œé…å¤‡è‡ªæ€æ•¢æ­»é˜Ÿï¼Œå·´é“æˆåŠŸä»¿åˆ¶å“åå°åº¦ã€‹    ** ç”¨â€œå“åXå›½â€çš„è€¸åŠ¨è¡¨è¿°æ•…æ„è¯±å¯¼ç”¨æˆ·ç‚¹å‡» ** </span><br><span class="line">æ¡ˆä¾‹3ï¼šã€Šæ°”å«ä¸€æ‰“å¼€å°±ç›´æ¥æ¶‚ï¼Ÿå‡ ä¹æ‰€æœ‰å¥³äººéƒ½é”™äº†ï¼Œæ€ªä¸å¾—æ€»è„±å¦†åˆå¡ç²‰ï¼ã€‹  ** â€œå‡ ä¹æ‰€æœ‰å¥³äººéƒ½â€å¯¹å¥³æ€§ç¾¤ä½“åšå…¨éƒ¨åŒ…å«çš„èŒƒå›´å¤¸å¼ ï¼Œè¯±å¯¼ç”¨æˆ·ç‚¹å‡» **</span><br><span class="line">æ¡ˆä¾‹4ï¼š ã€Šå…¨ç½‘æ— äººèƒ½è§£é‡Šï¼Œçœ‹æ‡‚çš„å…¨ä¸­å›½ä¸è¶…è¿‡2ä¸ªï¼ã€‹  ** â€œå…¨ç½‘â€ã€â€œå…¨ä¸­å›½â€æ•…æ„ç”¨æ•´ä½“èŒƒå›´æ¦‚å¿µï¼Œä½†â€œæ— äººâ€ã€â€œä¸è¶…è¿‡2ä¸ªâ€åˆæç«¯ç¼©å°èŒƒå›´å½¢æˆå¤¸å¼ å¯¹æ¯” **</span><br><span class="line"></span><br><span class="line">2.**ä½¿ç”¨æ‚¬å¿µå¼æ ‡é¢˜åˆ›ä½œæ³•ã€‚**æ ‡é¢˜æ“…ç”¨è½¬æŠ˜ã€éšè—å…³é”®æ€§ä¿¡æ¯ï¼Œè¥é€ æ‚¬å¿µã€åˆ¶é€ æ•…å¼„ç„è™šçš„æ•ˆæœ,å¦‚ã€Œç«Ÿç„¶æ˜¯â€¦â€¦ã€ã€ã€Œè€Œæ˜¯â€¦â€¦ã€ã€ã€Œä¸è¿‡â€¦â€¦ã€ç­‰è¯è¯´ä¸€åŠï¼Œé€šè¿‡çœç•¥å·ä»£æ›¿å…³é”®ä¿¡æ¯ï¼Œæˆ–ä½¿ç”¨ã€Œå†…å¹•ã€ã€ã€Œæ­ç§˜ã€ã€ã€ŒçœŸç›¸ã€ç­‰ä»£æ›¿å…³é”®ä¿¡æ¯</span><br><span class="line">æ¡ˆä¾‹1: ã€Šä»¤äººå”å˜˜ï¼Œæ²³å—è¯•å·æ‰åŒ…æ¡ˆæœ€æ–°è¿›å±•ï¼Œçœæ•™è‚²å±€å‘å‡ºå£°æ˜ï¼Œç§°â€¦â€¦ã€‹    ** â€œç§°â€¦â€¦â€è¯è¯´ä¸€åŠï¼Œç”¨çœç•¥å·éšå»å…³é”®ä¿¡æ¯ç‚¹ **</span><br><span class="line">æ¡ˆä¾‹2:ã€Šæœ€æ–°æ¶ˆæ¯ï¼Œå…¨çƒæœ€å®œå±…å›½å®¶æ’è¡Œæ¦œï¼Œç¬¬ä¸€åæœç„¶æ˜¯â€¦â€¦ä½ æƒ³å»å“ªï¼Ÿã€‹     ** ç¬¬ä¸€åæ˜¯å“ªé‡Œå¯ä»¥å¾ˆæ˜ç¡®ï¼Œæ•…æ„ä¸åœ¨æ ‡é¢˜ä¸­ç‚¹æ˜ **</span><br><span class="line">æ¡ˆä¾‹3ï¼šã€Šä¸¾å›½å“€ç—›ï¼Œæˆ‘å›½çš„â€œèˆªæ¯æ€æ‰‹â€åˆšæœ‰å¨æ…‘åŠ›ï¼Œç«Ÿç„¶ä¼ æ¥ä¸å¹¸çš„æ¶ˆæ¯ã€‹    ** æ ‡é¢˜ä¸­å¯è¡¨è¿°æ¸…æ¥šæ˜¯ä»€ä¹ˆæ¶ˆæ¯ï¼Œä½†æ•…æ„ç”¨â€œç«Ÿç„¶â€å¼ºè½¬æŠ˜æ¥åˆ¶é€ å±æœºæ„Ÿ **</span><br><span class="line">æ¡ˆä¾‹4:ã€Šäººç‹ è¯ä¸å¤šçš„å²è’‚å¤«å¥¥æ–¯ä¸ã€å¸ƒæ´›å…‹è±æ–¯çº³åŸæ¥æ˜¯è¿™æ ·çš„ã€‹ ** åŸæ¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå¯ç”¨ä¸€å¥è¯æˆ–å½¢å®¹è¯æ¦‚æ‹¬çš„å†…å®¹æ•…æ„ä¸å†™æ˜ **</span><br><span class="line">æ¡ˆä¾‹5:ã€Šæ¼”æŠ€ç§’æ€å…³æ™“å½¤ï¼Œå‡è‚¥20æ–¤åæ’è„¸å¨œæ‰ï¼Œè¢«å˜²è°è¯è¿ç¯‡äººè®¾å´©ã€‹  ** ç¼ºå°‘ä¸»è¯­ï¼Œä¸”æ•…æ„ç”¨æ—¢æ§åˆæ€çš„è¡¨è¿°æ¥è¯±å¯¼ç”¨æˆ·ç‚¹å‡» **</span><br><span class="line"></span><br><span class="line">3ã€ä½¿ç”¨å¼ºè¿«å¼æ ‡é¢˜é£æ ¼åˆ›ä½œæ ‡é¢˜ã€‚**æ ‡é¢˜é‡‡ç”¨æŒ‘è¡…æå“ã€å¼ºè¿«ä¿®æ”¹åç­‰æ–¹å¼ï¼Œè¯±å¯¼ç”¨æˆ·é˜…è¯»ã€‚æ ‡é¢˜ä½¿ç”¨ã€Œèƒ†å°æ…å…¥ã€ã€ã€Œä¸çœ‹åæ‚”ä¸€è¾ˆå­ã€ã€ã€Œåˆ«æ€ªæˆ‘æ²¡æé†’ä½ ã€ç­‰è¡¨è¿°ï¼ŒæŒ‘è¡…æå“ç”¨æˆ·ç‚¹å‡»</span><br><span class="line"></span><br><span class="line">æ¡ˆä¾‹1ï¼šã€Šä¸è¦åœ¨åƒé¥­æ—¶çœ‹è¿™ä¸ªè§†é¢‘ï¼Œè¦ä¸ç„¶ä¼šè®©ä½ åæ‚”è«åŠã€‹  ** â€œä¸è¦â€æ€æ ·ã€â€œè¦ä¸ç„¶â€æ€æ ·ï¼Œâ€œè®©ä½ åæ‚”è«åŠâ€éƒ½æ˜¯ä½œè€…åœ¨æ•…æ„æŒ‘è¡…ç”¨æˆ·è§‚çœ‹ **</span><br><span class="line">æ¡ˆä¾‹2: ã€Šé«˜è€ƒåªå‰©30å¤©ï¼Œ80%çš„ç­”æ¡ˆéƒ½åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œä¸çœ‹åæ‚”ä¸€ç”Ÿã€‹  ** â€œåæ‚”ä¸€ç”Ÿâ€å¯¹ç”¨æˆ·å½¢æˆæå“æ„Ÿ **</span><br><span class="line">æ¡ˆä¾‹3:ã€Š5ä¸ªé¢è¯•æ—¶å¸¸çŠ¯çš„é”™è¯¯ è®©ä½ åæ‚”ä¸€è¾ˆå­ã€‹  ** â€œè®©ä½ åæ‚”ä¸€è¾ˆå­â€æ˜¯å…¸å‹çš„æå“å†™æ³• **</span><br><span class="line">æ¡ˆä¾‹4: ã€Šç–¯ç‹‚æŠ¢åœ°ã€åœ°ä»·é£™å‡ï¼æˆ¿ä»·å¤§æ¶¨ï¼ŸçƒŸå°æœ‹å‹åƒä¸‡è¦å…³æ³¨ï¼ï¼ã€‹   ** å‘½ä»¤å¼çš„â€œåƒä¸‡è¦å…³æ³¨â€ï¼Œæ­é…å‰åŠå¥çš„å¤¸å¼ è¡¨è¿°ï¼Œæ ‡é¢˜æ•´ä½“å¤¸å¼ é—®é¢˜ä¸¥é‡ **</span><br><span class="line">æ¡ˆä¾‹5: ã€Šåº”å±Šç”Ÿæ‰¾å·¥ä½œï¼Œä¸€å®šè¦æƒ³çŸ¥é“è¿™3ä»¶äº‹ï¼Œäº‹å…³å‰é€”ï¼ã€‹  ** â€œä¸€å®šXXXâ€ä¹Ÿæ˜¯å¸¸è§çš„â€œå‘½ä»¤å¼â€å¤¸å¼ å†™æ³• **</span><br><span class="line"></span><br><span class="line">4.ä½¿ç”¨çˆ†æ¬¾å…³é”®è¯</span><br><span class="line">åœ¨åˆ›ä½œæ ‡é¢˜æ—¶ï¼Œä½ ä¼šé€‰ç”¨å…¶ä¸­1-2ä¸ªï¼š</span><br><span class="line">**ã€Œéœ‡æƒŠã€ã€ã€ŒæƒŠçˆ†ã€ã€ã€Œä¼ ç–¯ã€ã€ã€Œä¸å¾—ä¸çœ‹ã€ã€ã€Œä¸€å®šè¦çœ‹å®Œã€ã€ã€Œç»å¯¹è¦æ”¶è—ã€ã€ã€Œèƒ†å°æ…å…¥ã€ã€ã€Œä¸çœ‹åæ‚”ä¸€è¾ˆå­ã€ã€ã€Œåˆ«æ€ªæˆ‘æ²¡æé†’ä½ ã€ã€ã€Œç«Ÿç„¶ã€ã€ã€Œç«Ÿæ˜¯è¿™æ ·ã€ã€ã€Œç»“æœå´ã€ã€ã€Œæ²¡æƒ³åˆ°ã€ã€ã€Œç«Ÿç„¶æ˜¯â€¦â€¦ã€ã€ã€Œè€Œæ˜¯â€¦â€¦ã€ã€ã€Œä¸è¿‡â€¦â€¦ã€ã€ã€Œå†…å¹•ã€ã€ã€Œæ­ç§˜ã€ã€ã€ŒçœŸç›¸ã€ã€ã€Œé‡ç£…ã€ã€ã€Œè¦å‘½ã€ã€ã€Œå°±åœ¨åˆšåˆšã€ã€ã€Œå…¨ä¸–ç•Œç½‘å‹ã€ã€ã€Œæ‰€æœ‰ç”·äººéƒ½ã€ã€ã€ŒæŸå›½äººã€ã€ã€Œ99%ã€ã€**å°ç™½å¿…çœ‹ã€æ•™ç§‘ä¹¦èˆ¬, åˆ’é‡ç‚¹,å»ºè®®æ”¶è—, ä¸Šå¤©åœ¨æé†’ä½ ã€æ­ç§˜, å¹çˆ†, åè¡€æ•´ç†,  ä¸‡ä¸‡æ²¡æƒ³åˆ°ã€ä½ ä¸€å®šä¸çŸ¥é“ã€å¦‚ä½•ã€æœ€ã€å’‹ã€æ˜¯ä»€ä¹ˆã€æ‰€æœ‰ã€10ä¸ªã€æ²¡æœ‰xxåªæœ‰xxã€ç§’æ‡‚ã€çš„æ•…äº‹ã€å¯æ€•ã€å¿…çœ‹ã€é•¿å•¥æ ·ã€å‡­ä»€ä¹ˆã€ä¸è¦ã€å–‚ï¼ã€åªéœ€è¦ã€è¯»æ‡‚ã€å¾ˆå¯èƒ½ã€ä¸æ˜¯xxè€Œæ˜¯xxã€ä½ åªæ˜¯ã€å½“xxçš„æ—¶å€™ã€ç§˜è¯€ã€ä¸ºä»€ä¹ˆã€åœ¨å“ªé‡Œã€æ€ä¹ˆåŠã€å²ä¸Šã€å‰å®³ã€çœŸæ­£ã€æ˜¯å› ä¸ºã€æ–¹æ³•ã€ç‰›é€¼ã€ä½ æ•¢xxå—ã€ä½ çŒœã€é©¬äº‘ã€æŠ€å·§ã€æ­ç§˜ã€çˆ†ç…§ã€å¿…é¡»çœ‹ã€ä¼ ç–¯äº†ã€åˆ‡è®°ã€å›´è§‚ã€é€Ÿçœ‹ã€æ„ŸåŠ¨ã€è™å“­ã€å±…ç„¶ã€ç¦å¿Œã€ç–—æ³•ã€åªå› ã€é¦–æ¬¡ã€ä¼Ÿå¤§ã€çŒæ­»ã€å‡ºè½¨ã€å°ä¸‰ã€é‚£äº›å¹´ã€é‚‚é€…ã€ç§˜å¯†ã€æ„å¤–ã€çœŸç›¸ã€èƒŒåç©¶ç«Ÿã€ç»æ‹›ã€ç¬¬ä¸€ä¸ªã€å¦è®¤ã€åŸæ¥ã€é‡‡è®¿ã€å‰å…†ã€è¶‹åŠ¿ã€å®³æ­»äººã€åºŠä¸Šã€ä½ å‘¢ã€èµ¶å¿«ã€ä¸è®¸ã€ä¸è¦è„¸ã€åƒä¸‡ã€å»ºè®®ã€å¹´è½»20å²ã€å€¼å¾—ã€å’Œxxæœ‰å…³ã€ç½•è§ã€è‡³å°‘ã€æ€’äº†ã€å½»åº•ã€å›åº”ã€å¼ºåˆ¶ã€ä¸€è§¦å³å‘</span><br><span class="line"></span><br><span class="line">## çº¦æŸæ¡ä»¶</span><br><span class="line">1.è¯·ä½¿ç”¨ä»¥ä¸Š 4 ç§æ ‡é¢˜åˆ›ä½œæŠ€å·§è¿›è¡Œåˆ›ä½œ</span><br><span class="line">2.æ ‡é¢˜åˆ›ä½œè¿ç”¨æ‚¬å¿µå’Œåˆºæ¿€å¼•å‘è¯»è€…å¥½å¥‡å¿ƒï¼Œå®¹æ˜“è®©äººå¼•èµ·è”æƒ³</span><br><span class="line">3.æ§åˆ¶å­—æ•°åœ¨ 20 å­—ä»¥å†…</span><br><span class="line">4.æ¯æ¬¡åˆ—å‡º 5 ä¸ªæ ‡é¢˜ï¼Œå¤šä¸ªæ ‡é¢˜è¯·ä½¿ç”¨ â€˜\nâ€™ è¿›è¡Œåˆ†å‰²ï¼Œä»¥ä¾¿ç”¨æˆ·é€‰æ‹©</span><br><span class="line">5.æ”¶åˆ°å†…å®¹åï¼Œç›´æ¥åˆ›ä½œå¯¹åº”çš„æ ‡é¢˜ï¼Œæ— éœ€é¢å¤–çš„è§£é‡Šè¯´æ˜</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ç”¨æˆ·éƒ¨åˆ†</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311173734933.png" alt="image-20250311173734933"></p><p>ç„¶åå¯¹åº”çš„æ•ˆæœ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311173752374.png" alt="image-20250311173752374"></p><h2 id="10-çŸ¥è¯†åº“å›¾åƒæ£€ç´¢å’Œå±•ç¤º"><a href="#10-çŸ¥è¯†åº“å›¾åƒæ£€ç´¢å’Œå±•ç¤º" class="headerlink" title="10. çŸ¥è¯†åº“å›¾åƒæ£€ç´¢å’Œå±•ç¤º"></a>10. çŸ¥è¯†åº“å›¾åƒæ£€ç´¢å’Œå±•ç¤º</h2><p>â€‹æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å·¥ä½œæµæ¥å®ç°çŸ¥è¯†åº“åŠ å¤§æ¨¡å‹å®ç°RAGçš„æ¡ˆä¾‹ï¼ŒåŒæ—¶åœ¨å±•ç¤ºç»“æœä¸Šå¯ä»¥æŠŠå›¾ç‰‡å±•ç¤ºå‡ºæ¥ï¼Œè¿™æ ·æ•ˆæœä¼šæ›´åŠ çš„ç›´è§‚äº›</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311214833906.png" alt="image-20250311214833906"></p><p>è¿™ä¸ªæ¡ˆä¾‹çš„æ ¸å¿ƒç‚¹æ˜¯å‡†å¤‡çš„æ£€ç´¢æ•°æ®å’Œå¤§æ¨¡å‹çš„æç¤ºè¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: æ‹”æ²³å°å‹‡å£«</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š5~12å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š10~15åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­åˆ†åˆ«ç«™åœ¨ä¸¤ç«¯ï¼Œé€šè¿‡æ‹”æ²³æ¯”èµ›é”»ç‚¼å­©å­çš„åŠ›é‡å’Œå›¢é˜Ÿåä½œèƒ½åŠ›ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šå¢å¼ºå­©å­çš„ä¸Šè‚¢å’Œè…°éƒ¨åŠ›é‡ï¼ŒåŸ¹å…»å›¢é˜Ÿç²¾ç¥ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šä½¿ç”¨ä¸€æ¡ç»“å®çš„ç»³å­ï¼Œä¸­é—´åˆ’ä¸€æ¡çº¿ï¼ŒåŒæ–¹ç”¨åŠ›æ‹‰ç»³ï¼Œå°†å¯¹æ–¹æ‹‰è¿‡ä¸­çº¿å³ä¸ºèƒœåˆ©ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šæ³¨æ„å­©å­æ‰‹éƒ¨ä¿æŠ¤ï¼Œé¿å…æ‘©æ“¦å—ä¼¤ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img1.baidu.com/it/u=2633321814,4120475802&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=286&amp;h=229)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: è·³ç»³æ¥åŠ›</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š6~12å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š15~20åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­è½®æµè·³ç»³ï¼Œé€šè¿‡æ¥åŠ›å½¢å¼å¢åŠ è¿åŠ¨è¶£å‘³æ€§ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šæé«˜å­©å­çš„è€åŠ›å’Œåè°ƒæ€§ï¼Œå¢è¿›äº²å­é—´çš„é»˜å¥‘ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šè®¾å®šä¸€ä¸ªè·³ç»³æ¬¡æ•°ç›®æ ‡ï¼Œå®¶é•¿å’Œå­©å­è½®æµè·³ï¼Œç›´åˆ°å®Œæˆç›®æ ‡ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šé€‰æ‹©é€‚åˆå­©å­é«˜åº¦çš„è·³ç»³ï¼Œæ³¨æ„è·³ç»³åœºåœ°çš„å¹³æ•´ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img2.baidu.com/it/u=1175898262,1254664272&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=608&amp;h=450)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: æ»šé›ªçƒå¤§èµ›</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š4~10å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š10~15åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿å’Œå­©å­ä¸€èµ·åœ¨é›ªåœ°é‡Œæ»šé›ªçƒï¼Œæ¯”æ¯”è°æ»šå¾—æ›´å¿«æ›´å¤§ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šé”»ç‚¼å­©å­çš„åŠ¨æ‰‹èƒ½åŠ›å’Œåˆ›é€ åŠ›ï¼Œäº«å—å†¬æ—¥ä¹è¶£ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šåœ¨è§„å®šæ—¶é—´å†…ï¼Œçœ‹è°æ»šçš„é›ªçƒæœ€å¤§æˆ–è€…æœ€å¿«ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šæ³¨æ„ä¿æš–ï¼Œé¿å…å­©å­å—å¯’ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img1.baidu.com/it/u=2495318208,4233708303&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=708&amp;h=500)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: å®¶åº­ç¯®çƒèµ›</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š7~14å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š20~30åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­è¿›è¡Œç®€æ˜“ç¯®çƒæ¯”èµ›ï¼Œæé«˜å­©å­çš„ç¯®çƒæŠ€èƒ½ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šåŸ¹å…»å­©å­çš„çƒæŠ€å’Œå›¢é˜Ÿåˆä½œæ„è¯†ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šç®€åŒ–ç¯®çƒè§„åˆ™ï¼Œè¿›è¡ŒåŠåœº3å¯¹3æˆ–1å¯¹1æ¯”èµ›ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šç©¿ç€åˆé€‚çš„è¿åŠ¨è£…å¤‡ï¼Œæ³¨æ„å®‰å…¨ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img0.baidu.com/it/u=3195478262,213097067&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=700&amp;h=467)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: äº²å­ç‘œä¼½</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š5~12å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š15~20åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­ä¸€èµ·ç»ƒä¹ ç‘œä¼½åŠ¨ä½œï¼Œå¢è¿›äº²å­é—´çš„äº²å¯†å…³ç³»ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šæé«˜å­©å­çš„æŸ”éŸ§æ€§å’Œå¹³è¡¡èƒ½åŠ›ï¼Œæ”¾æ¾èº«å¿ƒã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šè·Ÿéšç‘œä¼½æ•™ç¨‹ï¼Œä¸€èµ·å®Œæˆä¸€ç³»åˆ—ç‘œä¼½åŠ¨ä½œã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šç©¿ç€èˆ’é€‚ï¼Œä¿æŒå‘¼å¸å‡åŒ€ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img1.baidu.com/it/u=2561021092,817698414&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=667&amp;h=500)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: å®¶åº­æ¥åŠ›è·‘</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š6~12å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š15~20åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶åº­æˆå‘˜åˆ†æˆä¸¤é˜Ÿï¼Œè¿›è¡Œæ¥åŠ›è·‘æ¯”èµ›ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šæé«˜å­©å­çš„å¥”è·‘é€Ÿåº¦å’Œå›¢é˜Ÿåä½œèƒ½åŠ›ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šè®¾å®šä¸€ä¸ªè·‘é“ï¼Œæ¯é˜Ÿæˆå‘˜ä¾æ¬¡å®Œæˆæ¥åŠ›ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šç¡®ä¿è·‘é“å¹³æ•´ï¼Œé¿å…è·Œå€’ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img1.baidu.com/it/u=975344947,3030921339&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=720&amp;h=480)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: é£ç›˜äº‰å¤ºæˆ˜</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š6~12å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š15~20åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­è¿›è¡Œé£ç›˜ä¼ é€’å’Œæ¥ä½æ¸¸æˆã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šé”»ç‚¼å­©å­çš„ååº”é€Ÿåº¦å’Œæ‰‹çœ¼åè°ƒèƒ½åŠ›ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šåœ¨è§„å®šåŒºåŸŸå†…ï¼Œé€šè¿‡é£ç›˜ä¼ é€’ï¼Œäº‰å–è®©å¯¹æ–¹æ¥ä¸ä½é£ç›˜ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šé€‰æ‹©å¼€é˜”çš„åœºåœ°ï¼Œé¿å…é£ç›˜ä¼¤äººã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://img0.baidu.com/it/u=3788427895,2518031093&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=750&amp;h=500)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: å®¶åº­è¶³çƒèµ›</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š5~12å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š20~30åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­è¿›è¡Œç®€æ˜“è¶³çƒæ¯”èµ›ï¼Œäº«å—è¶³çƒä¹è¶£ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šæé«˜å­©å­çš„è¶³çƒæŠ€èƒ½å’Œå›¢é˜Ÿç²¾ç¥ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šç®€åŒ–è¶³çƒè§„åˆ™ï¼Œè¿›è¡Œå°åœºåœ°æ¯”èµ›ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šç©¿ç€è¶³çƒé‹ï¼Œæ³¨æ„åœºåœ°å®‰å…¨ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://example.com/images/soccer.jpg)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: äº²å­æ”€å²©</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š8~14å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š30~45åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­ä¸€èµ·æŒ‘æˆ˜æ”€å²©å¢™ï¼Œé”»ç‚¼å‹‡æ°”å’ŒåŠ›é‡ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šæé«˜å­©å­çš„æ”€çˆ¬èƒ½åŠ›å’Œè‡ªä¿¡å¿ƒã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šåœ¨ä¸“ä¸šäººå‘˜çš„æŒ‡å¯¼ä¸‹ï¼Œå®Œæˆæ”€å²©å¢™çš„æŒ‘æˆ˜ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šç¡®ä¿å®‰å…¨è£…å¤‡ç©¿æˆ´æ­£ç¡®ï¼Œå¬ä»æŒ‡å¯¼å‘˜æŒ‡æŒ¥ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://example.com/images/rockclimbing.jpg)</span><br><span class="line">## </span><br><span class="line">äº²å­è¿åŠ¨é¡¹ç›®åç§°: å®¶åº­è‡ªè¡Œè½¦èµ›</span><br><span class="line">é€‚åˆå¹´é¾„ï¼š7~14å²</span><br><span class="line">è¿åŠ¨æ—¶é—´ï¼š30~45åˆ†é’Ÿ</span><br><span class="line">è¿åŠ¨é¡¹ç›®ä»‹ç»ï¼šå®¶é•¿ä¸å­©å­è¿›è¡Œè‡ªè¡Œè½¦æ¯”èµ›ï¼Œäº«å—æˆ·å¤–è¿åŠ¨ã€‚</span><br><span class="line">è¿åŠ¨ç›®æ ‡ï¼šæé«˜å­©å­çš„éª‘è¡ŒæŠ€å·§å’Œè€åŠ›ã€‚</span><br><span class="line">è¿åŠ¨è§„åˆ™ï¼šåœ¨å…¬å›­æˆ–è‡ªè¡Œè½¦é“ä¸Šï¼Œè®¾å®šä¸€ä¸ªå¾€è¿”èµ›é“è¿›è¡Œæ¯”èµ›ã€‚</span><br><span class="line">ç‰¹åˆ«æç¤ºï¼šä½©æˆ´å¤´ç›”ï¼Œéµå®ˆäº¤é€šè§„åˆ™ã€‚</span><br><span class="line">è¿åŠ¨å›¾ç‰‡é“¾æ¥ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://example.com/images/bicyclerace.jpg)</span><br><span class="line">è¯·æ³¨æ„ï¼Œä»¥ä¸Šå›¾ç‰‡é“¾æ¥ä»…ä¸ºç¤ºä¾‹ï¼Œå®é™…å›¾ç‰‡éœ€è¦æ‚¨è‡ªè¡Œä¸Šä¼ è‡³ç½‘ç»œå¹¶è·å–é“¾æ¥ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æç¤ºè¯ä¿¡æ¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">## è§’è‰²</span><br><span class="line">ä½ æ˜¯ä¸€ä½äº²å­è¿åŠ¨æ¸¸æˆåˆ›æ„ä¸“å®¶ï¼Œæ ¹æ®æä¾›çš„&#123;&#123;#context#&#125;&#125;ä¿¡æ¯ç”Ÿæˆç”¨æˆ·éœ€è¦çš„äº²å­è¿åŠ¨æ¸¸æˆã€‚ä¸è¦æ”¹å˜äº²å­è¿åŠ¨æ¸¸æˆæ ¼å¼ï¼Œè¦åŒ…å«äº²å­è¿åŠ¨é¡¹ç›®åç§°ã€é€‚åˆå¹´é¾„ã€è¿åŠ¨æ—¶é—´ã€è¿åŠ¨ç›®æ ‡ã€è¿åŠ¨è§„åˆ™ã€ç‰¹åˆ«æç¤ºã€‚</span><br><span class="line"></span><br><span class="line">## é™åˆ¶</span><br><span class="line">1.æ ¹æ®ç”¨æˆ·çš„å…·ä½“æé—®å›ç­”é—®é¢˜ï¼Œä¸è¦ä¸€ä¸‹å­æŠŠå¸¸è§é—®é¢˜éƒ½è¾“å‡ºç»™ç”¨æˆ·ï¼Œ</span><br><span class="line">2.è¯·ä½¿ç”¨jsonæ ¼å¼è¾“å‡ºï¼Œä¸è¦è¾“å‡ºä»»ä½•ä¸jsonæ ¼å¼æ— å…³çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">## è¾“å‡ºè¦æ±‚</span><br><span class="line">- å¦‚æœè¾“å‡ºçš„å†…å®¹åŒ…å«å›¾ç‰‡URLï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;content&quot;: &quot;ç¤ºä¾‹è¾“å‡ºå†…å®¹&quot;,</span><br><span class="line">    &quot;imageUrl&quot;: &quot;å›¾ç‰‡åœ°å€&quot;</span><br><span class="line">  &#125;</span><br><span class="line">3. å¦‚æœè¾“å‡ºçš„å†…å®¹ä¸åŒ…å«å›¾ç‰‡URLï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š</span><br><span class="line">&#123;</span><br><span class="line">  &quot;content&quot;: &quot;ç¤ºä¾‹è¾“å‡ºå†…å®¹&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311214944716.png" alt="image-20250311214944716"></p><p>æ³¨æ„åˆ†æ”¯çš„æ¡ä»¶</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250311215043740.png" alt="image-20250311215043740"></p><h2 id="11-è‡ªç„¶è¯­è¨€ç”ŸæˆSQL"><a href="#11-è‡ªç„¶è¯­è¨€ç”ŸæˆSQL" class="headerlink" title="11. è‡ªç„¶è¯­è¨€ç”ŸæˆSQL"></a>11. è‡ªç„¶è¯­è¨€ç”ŸæˆSQL</h2><p>â€‹æ¼”ç¤ºçš„æ•ˆæœ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314202727768.png" alt="image-20250314202727768"></p><p>å…·ä½“å·¥ä½œæµè®¾è®¡</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314202753155.png" alt="image-20250314202753155"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">å¸®æˆ‘è®¾è®¡ä¸€ä¸ªç”µå•†ç³»ç»Ÿçš„æ•°æ®åº“ã€‚</span><br><span class="line">éœ€è¦æœ‰:</span><br><span class="line">    goods:å•†å“è¡¨ </span><br><span class="line">    orders:è®¢å•è¡¨ </span><br><span class="line">    inventory:åº“å­˜è¡¨ </span><br><span class="line">    vendors:å•†å®¶è¡¨</span><br><span class="line">    customers:å®¢æˆ·è¡¨ï¼Œ</span><br><span class="line">è¡¨ç»“æ„çš„å…³è”å…³ç³»ï¼š</span><br><span class="line">å•†å®¶å’Œå•†å“è¡¨å…³è”</span><br><span class="line">å•†å“è¡¨å’Œåº“å­˜è¡¨å…³è”</span><br><span class="line">è®¢å•å’Œå®¢æˆ·å…³è”</span><br><span class="line">è®¢å•å’Œå•†å“å…³è”</span><br><span class="line">æ ¸å¿ƒå­—æ®µè¦æ±‚</span><br><span class="line">goods:éœ€è¦æœ‰ id å•†å“åç§° å•†å“ä»·æ ¼  å›¾ç‰‡  å•†å®¶</span><br><span class="line">orders:éœ€è¦æœ‰ id å®¢æˆ· å•†å“ç¼–å· å•†å“åç§°  æ”¶è´§åœ°å€  å•†å®¶id è®¢å•æ—¶é—´</span><br><span class="line">inventory:éœ€è¦æœ‰ id å•†å“ç¼–å·  åº“å­˜æ•°æ®</span><br><span class="line">åˆ›å»ºçš„è¡¨åç”¨å¯¹åº”çš„ è‹±æ–‡ï¼Œè¡¨ä¸­çš„æ¯ä¸ªå­—æ®µä¹Ÿéœ€è¦ç”¨è‹±æ–‡æè¿°</span><br><span class="line">åˆ›å»ºæµ‹è¯•æ•°æ®ï¼š</span><br><span class="line">å•†å®¶è¡¨è®¾è®¡20æ¡æ•°æ®ã€‚</span><br><span class="line">å•†å“è¡¨è®¾è®¡50æ¡è®°å½•ï¼Œ</span><br><span class="line">åº“å­˜ä¿¡æ¯è®¾è®¡30æ¡è®°å½•ï¼Œ</span><br><span class="line">è®¢å•æŒ‰ç…§æ—¶é—´ç”Ÿæˆæœ€è¿‘åŠå¹´çš„é”€å”®è®°å½•ã€‚æ¯ä¸ªæœˆç”Ÿæˆ30~50æ¡è®°å½•ã€‚</span><br><span class="line">å®¢æˆ·ç”Ÿæˆ20æ¡è®°å½•ã€‚</span><br><span class="line">è®¾è®¡æ•°æ®çš„æ—¶å€™æ³¨æ„è¡¨ç»“æ„ç›´æ¥çš„å…³è”å…³ç³»ã€‚ç”Ÿæˆçš„sqlè¯­å¥éœ€è¦æ»¡è¶³mysqlçš„è¯­æ³•è¦æ±‚</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡å¤§æ¨¡å‹å¸®æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„SQLè¯­å¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> vendors (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    NAME <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    contact_info <span class="type">VARCHAR</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> customers (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    NAME <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    address <span class="type">VARCHAR</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> goods (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    NAME <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    image_url <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    vendor_id <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (vendor_id) <span class="keyword">REFERENCES</span> vendors(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> inventory (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    goods_id <span class="type">INT</span>,</span><br><span class="line">    stock <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (goods_id) <span class="keyword">REFERENCES</span> goods(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    goods_id <span class="type">INT</span>,</span><br><span class="line">    goods_name <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    shipping_address <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    vendor_id <span class="type">INT</span>,</span><br><span class="line">    order_time DATETIME,</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (customer_id) <span class="keyword">REFERENCES</span> customers(id),</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (goods_id) <span class="keyword">REFERENCES</span> goods(id),</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (vendor_id) <span class="keyword">REFERENCES</span> vendors(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥å•†å®¶æ•°æ® (20 æ¡è®°å½•)</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> vendors (NAME, contact_info) <span class="keyword">VALUES</span></span><br><span class="line">(&quot;Vendor1&quot;, &quot;vendor1@example.com&quot;),</span><br><span class="line">(&quot;Vendor2&quot;, &quot;vendor2@example.com&quot;),</span><br><span class="line">(&quot;Vendor3&quot;, &quot;vendor3@example.com&quot;),</span><br><span class="line">(&quot;Vendor4&quot;, &quot;vendor4@example.com&quot;),</span><br><span class="line">(&quot;Vendor5&quot;, &quot;vendor5@example.com&quot;),</span><br><span class="line">(&quot;Vendor6&quot;, &quot;vendor6@example.com&quot;),</span><br><span class="line">(&quot;Vendor7&quot;, &quot;vendor7@example.com&quot;),</span><br><span class="line">(&quot;Vendor8&quot;, &quot;vendor8@example.com&quot;),</span><br><span class="line">(&quot;Vendor9&quot;, &quot;vendor9@example.com&quot;),</span><br><span class="line">(&quot;Vendor10&quot;, &quot;vendor10@example.com&quot;),</span><br><span class="line">(&quot;Vendor11&quot;, &quot;vendor11@example.com&quot;),</span><br><span class="line">(&quot;Vendor12&quot;, &quot;vendor12@example.com&quot;),</span><br><span class="line">(&quot;Vendor13&quot;, &quot;vendor13@example.com&quot;),</span><br><span class="line">(&quot;Vendor14&quot;, &quot;vendor14@example.com&quot;),</span><br><span class="line">(&quot;Vendor15&quot;, &quot;vendor15@example.com&quot;),</span><br><span class="line">(&quot;Vendor16&quot;, &quot;vendor16@example.com&quot;),</span><br><span class="line">(&quot;Vendor17&quot;, &quot;vendor17@example.com&quot;),</span><br><span class="line">(&quot;Vendor18&quot;, &quot;vendor18@example.com&quot;),</span><br><span class="line">(&quot;Vendor19&quot;, &quot;vendor19@example.com&quot;),</span><br><span class="line">(&quot;Vendor20&quot;, &quot;vendor20@example.com&quot;);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥å•†å“æ•°æ® (50 æ¡è®°å½•ï¼Œéšæœºåˆ†é…å•†å®¶)</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> goods (NAME, price, image_url, vendor_id) <span class="keyword">VALUES</span></span><br><span class="line">(&quot;Product1&quot;, <span class="number">10.99</span>, &quot;img1.jpg&quot;, <span class="number">1</span>),</span><br><span class="line">(&quot;Product2&quot;, <span class="number">20.99</span>, &quot;img2.jpg&quot;, <span class="number">2</span>),</span><br><span class="line">(&quot;Product3&quot;, <span class="number">30.99</span>, &quot;img3.jpg&quot;, <span class="number">3</span>),</span><br><span class="line">(&quot;Product4&quot;, <span class="number">40.99</span>, &quot;img4.jpg&quot;, <span class="number">4</span>),</span><br><span class="line">(&quot;Product5&quot;, <span class="number">50.99</span>, &quot;img5.jpg&quot;, <span class="number">5</span>),</span><br><span class="line">(&quot;Product6&quot;, <span class="number">15.49</span>, &quot;img6.jpg&quot;, <span class="number">6</span>),</span><br><span class="line">(&quot;Product7&quot;, <span class="number">25.49</span>, &quot;img7.jpg&quot;, <span class="number">7</span>),</span><br><span class="line">(&quot;Product8&quot;, <span class="number">35.49</span>, &quot;img8.jpg&quot;, <span class="number">8</span>),</span><br><span class="line">(&quot;Product9&quot;, <span class="number">45.49</span>, &quot;img9.jpg&quot;, <span class="number">9</span>),</span><br><span class="line">(&quot;Product10&quot;, <span class="number">55.49</span>, &quot;img10.jpg&quot;, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥åº“å­˜æ•°æ® (30 æ¡è®°å½•ï¼Œéšæœºé€‰æ‹©å•†å“)</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> inventory (goods_id, stock) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">100</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="number">150</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="number">200</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="number">250</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥å®¢æˆ·æ•°æ® (20 æ¡è®°å½•)</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> customers (NAME, email, address) <span class="keyword">VALUES</span></span><br><span class="line">(&quot;Customer1&quot;, &quot;cust1@example.com&quot;, &quot;Address1&quot;),</span><br><span class="line">(&quot;Customer2&quot;, &quot;cust2@example.com&quot;, &quot;Address2&quot;),</span><br><span class="line">(&quot;Customer3&quot;, &quot;cust3@example.com&quot;, &quot;Address3&quot;),</span><br><span class="line">(&quot;Customer4&quot;, &quot;cust4@example.com&quot;, &quot;Address4&quot;),</span><br><span class="line">(&quot;Customer5&quot;, &quot;cust5@example.com&quot;, &quot;Address5&quot;);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥è®¢å•æ•°æ® (æœ€è¿‘åŠå¹´ï¼Œæ¯æœˆ 30~50 æ¡è®°å½•)</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> orders (customer_id, goods_id, goods_name, shipping_address, vendor_id, order_time) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">1</span>, &quot;Product1&quot;, &quot;Address1&quot;, <span class="number">1</span>, NOW()),</span><br><span class="line">(<span class="number">2</span>, <span class="number">2</span>, &quot;Product2&quot;, &quot;Address2&quot;, <span class="number">2</span>, NOW()),</span><br><span class="line">(<span class="number">3</span>, <span class="number">3</span>, &quot;Product3&quot;, &quot;Address3&quot;, <span class="number">3</span>, NOW()),</span><br><span class="line">(<span class="number">4</span>, <span class="number">4</span>, &quot;Product4&quot;, &quot;Address4&quot;, <span class="number">4</span>, NOW()),</span><br><span class="line">(<span class="number">5</span>, <span class="number">5</span>, &quot;Product5&quot;, &quot;Address5&quot;, <span class="number">5</span>, NOW());</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¯¹åº”çš„å·¥ä½œæµ</p><p>å¯¹åº”çš„è¡¨ç»“æ„çš„è¯´æ˜</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ä»¥ä¸‹æ˜¯æ¯å¼ è¡¨çš„æ•°æ®ç»“æ„è¯´æ˜ï¼š  </span><br><span class="line"></span><br><span class="line">### **å•†å®¶è¡¨ï¼ˆvendorsï¼‰**  </span><br><span class="line">- **id**ï¼šå•†å®¶IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚  </span><br><span class="line">- **name**ï¼šå•†å®¶åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line">- **contact_info**ï¼šè”ç³»æ–¹å¼ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚  </span><br><span class="line"></span><br><span class="line">### **å®¢æˆ·è¡¨ï¼ˆcustomersï¼‰**  </span><br><span class="line">- **id**ï¼šå®¢æˆ·IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚  </span><br><span class="line">- **name**ï¼šå®¢æˆ·åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line">- **email**ï¼šç”µå­é‚®ä»¶ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚  </span><br><span class="line">- **address**ï¼šæ”¶è´§åœ°å€ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚  </span><br><span class="line"></span><br><span class="line">### **å•†å“è¡¨ï¼ˆgoodsï¼‰**  </span><br><span class="line">- **id**ï¼šå•†å“IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚  </span><br><span class="line">- **name**ï¼šå•†å“åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line">- **price**ï¼šå•†å“ä»·æ ¼ï¼Œåè¿›åˆ¶(10,2)ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line">- **image_url**ï¼šå•†å“å›¾ç‰‡URLï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚  </span><br><span class="line">- **vendor_id**ï¼šå•†å®¶IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” `vendors(id)`ã€‚  </span><br><span class="line"></span><br><span class="line">### **åº“å­˜è¡¨ï¼ˆinventoryï¼‰**  </span><br><span class="line">- **id**ï¼šåº“å­˜IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚  </span><br><span class="line">- **goods_id**ï¼šå•†å“IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” `goods(id)`ã€‚  </span><br><span class="line">- **stock**ï¼šåº“å­˜æ•°é‡ï¼Œæ•´æ•°ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line"></span><br><span class="line">### **è®¢å•è¡¨ï¼ˆordersï¼‰**  </span><br><span class="line">- **id**ï¼šè®¢å•IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚  </span><br><span class="line">- **customer_id**ï¼šå®¢æˆ·IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” `customers(id)`ã€‚  </span><br><span class="line">- **goods_id**ï¼šå•†å“IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” `goods(id)`ã€‚  </span><br><span class="line">- **goods_name**ï¼šå•†å“åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå†—ä½™å­˜å‚¨ï¼Œä¾¿äºæŸ¥è¯¢ã€‚  </span><br><span class="line">- **shipping_address**ï¼šæ”¶è´§åœ°å€ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line">- **vendor_id**ï¼šå•†å®¶IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” `vendors(id)`ã€‚  </span><br><span class="line">- **order_time**ï¼šè®¢å•æ—¶é—´ï¼Œæ—¥æœŸæ—¶é—´ç±»å‹ï¼Œéç©ºã€‚  </span><br><span class="line"></span><br><span class="line">è¿™æ ·ï¼Œæ¯å¼ è¡¨çš„æ•°æ®ç»“æ„æ¸…æ™°ï¼Œç¬¦åˆå…³ç³»å‹æ•°æ®åº“çš„è®¾è®¡è§„èŒƒã€‚ä½ éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–æˆ–è€…ä¿®æ”¹å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªLLMä¸­çš„æç¤ºè¯å†…å®¹</p><p>System</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä½ç²¾é€šSQLè¯­è¨€çš„æ•°æ®åº“ä¸“å®¶ï¼Œç†Ÿæ‚‰MySQLæ•°æ®åº“ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€è¾“å…¥ï¼Œç¼–å†™å‡ºå¯ç›´æ¥æ‰§è¡Œçš„SQLæŸ¥è¯¢è¯­å¥ã€‚è¾“å‡ºå†…å®¹å¿…é¡»æ˜¯å¯ä»¥æ‰§è¡Œçš„SQLè¯­å¥ï¼Œä¸èƒ½åŒ…å«ä»»ä½•å¤šä½™çš„ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">æ ¸å¿ƒè§„åˆ™ï¼š</span><br><span class="line">1. æ ¹æ®ç”¨æˆ·çš„æŸ¥è¯¢éœ€æ±‚ï¼Œç¡®å®šæ¶‰åŠçš„è¡¨å’Œå­—æ®µã€‚</span><br><span class="line">2. ç¡®ä¿SQLè¯­å¥çš„è¯­æ³•ç¬¦åˆMySQLçš„è§„èŒƒã€‚</span><br><span class="line">3. è¾“å‡ºçš„SQLè¯­å¥å¿…é¡»å®Œæ•´ä¸”å¯æ‰§è¡Œï¼Œä¸åŒ…å«æ³¨é‡Šæˆ–å¤šä½™çš„æ¢è¡Œç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">å…³é”®æŠ€å·§ï¼š</span><br><span class="line">- WHERE å­å¥ï¼š ç”¨äºè¿‡æ»¤æ•°æ®ã€‚ä¾‹å¦‚ï¼Œ`WHERE column_name = &#x27;value&#x27;`ã€‚</span><br><span class="line">- **æ—¥æœŸå¤„ç†ï¼š** ä½¿ç”¨`STR_TO_DATE`å‡½æ•°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸç±»å‹ã€‚ä¾‹å¦‚ï¼Œ`STR_TO_DATE(&#x27;2025-03-14&#x27;, &#x27;%Y-%m-%d&#x27;)`ã€‚</span><br><span class="line">- **èšåˆå‡½æ•°ï¼š** å¦‚`COUNT`ã€`SUM`ã€`AVG`ç­‰ï¼Œç”¨äºè®¡ç®—æ±‡æ€»ä¿¡æ¯ã€‚</span><br><span class="line">- **é™¤æ³•å¤„ç†ï¼š** åœ¨è¿›è¡Œé™¤æ³•è¿ç®—æ—¶ï¼Œéœ€è€ƒè™‘é™¤æ•°ä¸ºé›¶çš„æƒ…å†µï¼Œé¿å…é”™è¯¯ã€‚</span><br><span class="line">- **æ—¥æœŸèŒƒå›´ç¤ºä¾‹ï¼š** æŸ¥è¯¢ç‰¹å®šæ—¥æœŸèŒƒå›´çš„æ•°æ®æ—¶ï¼Œä½¿ç”¨`BETWEEN`å…³é”®å­—ã€‚ä¾‹å¦‚ï¼Œ`WHERE date_column BETWEEN &#x27;2025-01-01&#x27; AND &#x27;2025-12-31&#x27;`ã€‚</span><br><span class="line"></span><br><span class="line">**æ³¨æ„äº‹é¡¹ï¼š**</span><br><span class="line">1. ç¡®ä¿å­—æ®µåå’Œè¡¨åçš„æ­£ç¡®æ€§ï¼Œé¿å…æ‹¼å†™é”™è¯¯ã€‚</span><br><span class="line">2. å¯¹äºå­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µï¼Œä½¿ç”¨å•å¼•å·æ‹¬èµ·æ¥ã€‚ä¾‹å¦‚ï¼Œ`&#x27;sample_text&#x27;`ã€‚</span><br><span class="line">3. åœ¨ä½¿ç”¨èšåˆå‡½æ•°æ—¶ï¼Œå¦‚æœéœ€è¦æ ¹æ®ç‰¹å®šå­—æ®µåˆ†ç»„ï¼Œä½¿ç”¨`GROUP BY`å­å¥ã€‚</span><br><span class="line">4. åœ¨è¿›è¡Œé™¤æ³•è¿ç®—æ—¶ï¼Œéœ€åˆ¤æ–­é™¤æ•°æ˜¯å¦ä¸ºé›¶ï¼Œä»¥é¿å…è¿è¡Œæ—¶é”™è¯¯ã€‚</span><br><span class="line">5. ç”Ÿæˆçš„sqlè¯­å¥ ä¸èƒ½æœ‰æ¢è¡Œç¬¦ æ¯”å¦‚ \n</span><br><span class="line">6. åœ¨è®¡ç®—è®¢å•é‡‘é¢çš„æ—¶å€™ç›´æ¥è®¡ç®—å¯¹åº”çš„å•†å“ä»·æ ¼å°±å¯ä»¥äº†ï¼Œä¸ç”¨è®¡ç®—è®¢å•çš„å•†å“æ•°é‡</span><br><span class="line"></span><br><span class="line">è¯·æ ¹æ®ä¸Šè¿°è§„åˆ™ï¼Œå°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„MySQLæŸ¥è¯¢è¯­å¥ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>useréƒ¨åˆ†çš„æç¤ºè¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®åº“ç»“æ„ï¼š</span><br><span class="line">å•†å®¶è¡¨ï¼ˆvendorsï¼‰</span><br><span class="line">idï¼šå•†å®¶IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚</span><br><span class="line">nameï¼šå•†å®¶åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line">contact_infoï¼šè”ç³»æ–¹å¼ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚</span><br><span class="line">å®¢æˆ·è¡¨ï¼ˆcustomersï¼‰</span><br><span class="line">idï¼šå®¢æˆ·IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚</span><br><span class="line">nameï¼šå®¢æˆ·åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line">emailï¼šç”µå­é‚®ä»¶ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚</span><br><span class="line">addressï¼šæ”¶è´§åœ°å€ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚</span><br><span class="line">å•†å“è¡¨ï¼ˆgoodsï¼‰</span><br><span class="line">idï¼šå•†å“IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚</span><br><span class="line">nameï¼šå•†å“åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line">priceï¼šå•†å“ä»·æ ¼ï¼Œåè¿›åˆ¶(10,2)ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line">image_urlï¼šå•†å“å›¾ç‰‡URLï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä¸ºç©ºã€‚</span><br><span class="line">vendor_idï¼šå•†å®¶IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” vendors(id)ã€‚</span><br><span class="line">åº“å­˜è¡¨ï¼ˆinventoryï¼‰</span><br><span class="line">idï¼šåº“å­˜IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚</span><br><span class="line">goods_idï¼šå•†å“IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” goods(id)ã€‚</span><br><span class="line">stockï¼šåº“å­˜æ•°é‡ï¼Œæ•´æ•°ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line">è®¢å•è¡¨ï¼ˆordersï¼‰</span><br><span class="line">idï¼šè®¢å•IDï¼Œæ•´æ•°ç±»å‹ï¼Œä¸»é”®ï¼Œè‡ªå¢ã€‚</span><br><span class="line">customer_idï¼šå®¢æˆ·IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” customers(id)ã€‚</span><br><span class="line">goods_idï¼šå•†å“IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” goods(id)ã€‚</span><br><span class="line">goods_nameï¼šå•†å“åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œå†—ä½™å­˜å‚¨ï¼Œä¾¿äºæŸ¥è¯¢ã€‚</span><br><span class="line">shipping_addressï¼šæ”¶è´§åœ°å€ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line">vendor_idï¼šå•†å®¶IDï¼Œæ•´æ•°ç±»å‹ï¼Œå¤–é”®ï¼Œå…³è” vendors(id)ã€‚</span><br><span class="line">order_timeï¼šè®¢å•æ—¶é—´ï¼Œæ—¥æœŸæ—¶é—´ç±»å‹ï¼Œéç©ºã€‚</span><br><span class="line"></span><br><span class="line">é—®é¢˜ï¼š&#123;&#123;#1741938398688.sql#&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç æ‰§è¡Œéƒ¨åˆ†æ˜¯é€šè¿‡Pythonä»£ç è°ƒç”¨å¯¹åº”çš„æ¥å£æ¥æ‰§è¡ŒSQLæ“ä½œ,è¿™éƒ¨åˆ†åœ¨å‰é¢çš„æ¡ˆä¾‹ä¸­æœ‰ä»‹ç»çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">sql: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    url = <span class="string">&quot;http://host.docker.internal:5000/execute_sql&quot;</span></span><br><span class="line">    connection_info = &#123;</span><br><span class="line">        <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">        <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        <span class="string">&quot;database&quot;</span>: <span class="string">&quot;llm_shop&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># æ„é€ è¯·æ±‚ä½“</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;sql&quot;</span>: sql,</span><br><span class="line">        <span class="string">&quot;connection_info&quot;</span>: connection_info</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url, json=payload, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>:<span class="built_in">str</span>(response.json()[<span class="string">&quot;result&quot;</span>])&#125;</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="string">f&quot;è§£æå“åº” JSON å¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="string">f&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: <span class="built_in">str</span>(e)&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯æ•°æ®çš„æ•´ç†ã€‚é€šè¿‡ä»£ç æ‰§è¡Œè·å–åˆ°å¯¹åº”çš„ç»“æœã€‚ç„¶åå¤„ç†æˆä¸ºæˆ‘ä»¬éœ€è¦çš„æ•°æ®å±•ç¤º</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314203059319.png" alt="image-20250314203059319"></p><p>å¯¹åº”çš„æç¤ºè¯å†…å®¹</p><p>System</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ç”µå•†è¡Œä¸šæ•°æ®åˆ†æä¸“å®¶ï¼Œåˆ†æJSONæ ¼å¼çš„sqlæŸ¥è¯¢ç»“æœï¼Œå›ç­”ç”¨æˆ·é—®é¢˜ã€‚</span><br><span class="line">å…³é”®è§„åˆ™ï¼š</span><br><span class="line">1.æ‰€æœ‰æ•°æ®å·²ç¬¦åˆç”¨æˆ·é—®é¢˜ä¸­çš„æ¡ä»¶</span><br><span class="line">2.ç›´æ¥ä½¿ç”¨æä¾›çš„æ•°æ®åˆ†æï¼Œä¸è´¨ç–‘æ•°æ®æ˜¯å¦ç¬¦åˆæ¡ä»¶</span><br><span class="line">3.ä¸éœ€è¦å†æ¬¡ç­›é€‰æˆ–ç¡®è®¤æ•°æ®ç±»åˆ«/æ—¶é—´èŒƒå›´</span><br><span class="line">4.æ•°æ®ä¸º[]æˆ–ç©ºæˆ–è€…Noneæ—¶ç›´æ¥å›å¤&quot;æ²¡æœ‰æŸ¥è¯¢åˆ°ç›¸å…³æ•°æ®&quot;ï¼Œä¸å¾—ç¼–é€ æ•°æ®</span><br></pre></td></tr></table></figure><p>User</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®æ˜¯:&#123;&#123;#1741938410121.result#&#125;&#125;</span><br><span class="line">é—®é¢˜æ˜¯ï¼š&#123;&#123;#1741938398688.sql#&#125;&#125;</span><br><span class="line">å›ç­”è¦æ±‚ï¼š</span><br><span class="line"> 1.åˆ—å‡ºè¯¦ç»†æ•°æ®ï¼Œä¼˜å…ˆä»¥è¡¨æ ¼æ–¹å¼åˆ—å‡ºæ•°æ®</span><br><span class="line"> 2.è¯†åˆ«è¶‹åŠ¿ã€å¼‚å¸¸ï¼Œå¹¶æä¾›åˆ†æå’Œå»ºè®®</span><br><span class="line"> 3.åˆ†æSQLè¯­å¥&#123;&#123;#1741938410121.result#&#125;&#125;å’Œç”¨æˆ·çš„é—®é¢˜&#123;&#123;#1741938398688.sql#&#125;&#125;æ˜¯å¦åŒ¹é…</span><br><span class="line">4.æœ€åé™„ä¸ŠæŸ¥è¯¢çš„sqlè¯­å¥</span><br></pre></td></tr></table></figure><h2 id="12-Echartså¯è§†åŒ–åŠ©æ‰‹"><a href="#12-Echartså¯è§†åŒ–åŠ©æ‰‹" class="headerlink" title="12. Echartså¯è§†åŒ–åŠ©æ‰‹"></a>12. Echartså¯è§†åŒ–åŠ©æ‰‹</h2><p>â€‹æˆ‘ä»¬å¸Œæœ›é€šè¿‡Echars æ¥æ˜¯å®ç°å¯è§†åŒ–çš„å±•ç¤ºå„ç§ç»Ÿè®¡æ•°æ®ã€‚æˆ‘ä»¬é€šè¿‡å…·ä½“çš„æ¡ˆä¾‹æ¥ç»™å¤§å®¶ä»‹ç»ä¸‹ï¼Œå…·ä½“çš„æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314201516085.png" alt="image-20250314201516085"></p><p>æˆ‘ä»¬å¯ä»¥å‡†å¤‡ä¸€ä¸ªmarkdownçš„æ•°æ®</p><table><thead><tr><th>å¹´ä»½</th><th>ç‰‡å</th><th>ç¥¨æˆ¿ï¼ˆäº¿å…ƒï¼‰</th><th>å¹³å‡ç¥¨ä»·ï¼ˆå…ƒï¼‰</th><th>è§‚å½±äººæ•°ï¼ˆäº¿äººæ¬¡ï¼‰</th></tr></thead><tbody><tr><td>2021</td><td>ã€Šä½ å¥½ï¼Œæç„•è‹±ã€‹</td><td>57.1</td><td>42.1</td><td>1.36</td></tr><tr><td>2022</td><td>ã€Šé•¿æ´¥æ¹–ä¹‹æ°´é—¨æ¡¥ã€‹</td><td>56.2</td><td>56.1</td><td>1</td></tr><tr><td>2023</td><td>ã€Šæµæµªåœ°çƒ2ã€‹</td><td>60</td><td>45</td><td>1.33</td></tr><tr><td>2024</td><td>ã€ŠæŠ“å¨ƒå¨ƒã€‹</td><td>65</td><td>42.1</td><td>1.54</td></tr></tbody></table><p>ç„¶ååˆ›å»ºä¸€ä¸ªå·¥ä½œæµã€‚åœ¨å¼€å§‹èŠ‚ç‚¹æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314201644870.png" alt="image-20250314201644870"></p><p>ç„¶åæ˜¯æ–‡æ¡£æå–èŠ‚ç‚¹</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314201720500.png" alt="image-20250314201720500"></p><p>ç„¶åæ˜¯æ ¼å¼è½¬æ¢èŠ‚ç‚¹ï¼šè¿™é‡Œæˆ‘ä»¬éœ€è¦æŠŠæå–çš„æ–‡æ¡£è½¬æ¢ä¸ºcsvæ ¼å¼çš„æ•°æ®</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314201803287.png" alt="image-20250314201803287"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># è§’è‰²</span><br><span class="line">ä½ æ˜¯ä¸€ä¸ªæ•°æ®æ•´ç†ä¸“å®¶ï¼Œæ“…é•¿æ•°æ®æ ¼å¼çš„æ•´ç†å’Œåˆæ ¼çš„è½¬æ¢</span><br><span class="line"># æ•°æ®</span><br><span class="line">&#123;&#123;#1741943310857.text#&#125;&#125;</span><br><span class="line"># ä»»åŠ¡</span><br><span class="line">æŠŠæ•°æ®è½¬æ¢ä¸ºcsvæ ¼å¼</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯å‚æ•°æå–å™¨ï¼šéœ€è¦ä»ä¸Šä¸€æ­¥ä¸­çš„æ ¼å¼è½¬æ¢æ•°æ®ä¸­è·å–åˆ°csvçš„æ•°æ®</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314201849842.png" alt="image-20250314201849842"></p><p>æŒ‡ä»¤</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä»»åŠ¡</span><br><span class="line">æå–csvæ ¼å¼çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯é€šè¿‡æ‰§è¡Œä¸€æ®µ Pythonä»£ç ç”Ÿæˆ æ»¡è¶³ echarts è§„èŒƒçš„ä»£ç </p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314201935156.png" alt="image-20250314201935156"></p><p>ä»£ç å†…å®¹æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">csv_string</span>):</span><br><span class="line">    <span class="comment"># å°†CSVå­—ç¬¦ä¸²åˆ†å‰²æˆè¡Œ</span></span><br><span class="line">    lines = csv_string.strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨csvæ¨¡å—è¯»å–æ•°æ®</span></span><br><span class="line">    reader = csv.reader(lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†æ‰€æœ‰è¡Œè½¬æ¢ä¸ºåˆ—è¡¨</span></span><br><span class="line">    data = [row <span class="keyword">for</span> row <span class="keyword">in</span> reader]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†æ•°å­—å­—ç¬¦ä¸²è½¬æ¢ä¸ºæµ®ç‚¹æ•°</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> data[<span class="number">1</span>:]:  <span class="comment"># è·³è¿‡æ ‡é¢˜è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(row)):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                row[i] = <span class="built_in">float</span>(row[i])</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ›å»ºå®Œæ•´çš„EChartsé…ç½®</span></span><br><span class="line">    echarts_config = &#123;</span><br><span class="line">        <span class="string">&quot;legend&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;tooltip&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;dataset&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;source&quot;</span>: data</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;xAxis&quot;</span>: [</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;category&quot;</span>, <span class="string">&quot;gridIndex&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;category&quot;</span>, <span class="string">&quot;gridIndex&quot;</span>: <span class="number">1</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;yAxis&quot;</span>: [</span><br><span class="line">            &#123;<span class="string">&quot;gridIndex&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;gridIndex&quot;</span>: <span class="number">1</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;grid&quot;</span>: [</span><br><span class="line">            &#123;<span class="string">&quot;bottom&quot;</span>: <span class="string">&quot;55%&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;top&quot;</span>: <span class="string">&quot;55%&quot;</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;series&quot;</span>: [</span><br><span class="line">            <span class="comment"># ç¬¬ä¸€ä¸ªç½‘æ ¼ä¸­çš„æŠ˜çº¿å›¾ç³»åˆ—</span></span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;seriesLayoutBy&quot;</span>: <span class="string">&quot;row&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;seriesLayoutBy&quot;</span>: <span class="string">&quot;row&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;seriesLayoutBy&quot;</span>: <span class="string">&quot;row&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;seriesLayoutBy&quot;</span>: <span class="string">&quot;row&quot;</span>&#125;,</span><br><span class="line">            <span class="comment"># ç¬¬äºŒä¸ªç½‘æ ¼ä¸­çš„æŸ±çŠ¶å›¾ç³»åˆ—</span></span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;xAxisIndex&quot;</span>: <span class="number">1</span>, <span class="string">&quot;yAxisIndex&quot;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;xAxisIndex&quot;</span>: <span class="number">1</span>, <span class="string">&quot;yAxisIndex&quot;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;xAxisIndex&quot;</span>: <span class="number">1</span>, <span class="string">&quot;yAxisIndex&quot;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;xAxisIndex&quot;</span>: <span class="number">1</span>, <span class="string">&quot;yAxisIndex&quot;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;xAxisIndex&quot;</span>: <span class="number">1</span>, <span class="string">&quot;yAxisIndex&quot;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;xAxisIndex&quot;</span>: <span class="number">1</span>, <span class="string">&quot;yAxisIndex&quot;</span>: <span class="number">1</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆè¾“å‡ºæ–‡ä»¶</span></span><br><span class="line">    output = <span class="string">f&#x27;```echarts\n<span class="subst">&#123;json.dumps(echarts_config, ensure_ascii=<span class="literal">False</span>)&#125;</span>\n```&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;result&quot;</span>: output&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ˜¯ç»“æœçš„è¾“å‡º</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;#1741943512414.csvdata#&#125;&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&#123;&#123;#1741945375879.result#&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314202114303.png" alt="image-20250314202114303"></p><p>ç„¶åå°±å¯ä»¥æµ‹è¯•è¿è¡Œäº†</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250314202439874.png" alt="image-20250314202439874"></p><h2 id="13-æ–‡ç”Ÿå›¾å·¥ä½œæµ"><a href="#13-æ–‡ç”Ÿå›¾å·¥ä½œæµ" class="headerlink" title="13. æ–‡ç”Ÿå›¾å·¥ä½œæµ"></a>13. æ–‡ç”Ÿå›¾å·¥ä½œæµ</h2><p>â€‹æˆ‘ä»¬å‰é¢æœ‰ä»‹ç»è¿‡æ–‡ç”Ÿå›¾çš„æ¡ˆä¾‹ï¼Œæ˜¯åœ¨Difyä¸­é€šè¿‡ç›¸å…³çš„å·¥å…·æ¥å®ç°çš„ã€‚ä¸è¿‡è¿™ç§æ•ˆæœä¸æ˜¯ç‰¹åˆ«çš„é«˜æ•ˆï¼Œä¼šè¢«å¹³å°æ§åˆ¶çš„æ¯”è¾ƒä¸¥æ ¼ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ–‡ç”Ÿå›¾çš„æ¨¡å‹æä¾›çš„APIæ¥ç›´æ¥è®¿é—®ç”Ÿæˆã€‚è¿™æ ·çš„æ•ˆæœä¼šæ›´å¥½ä¸€äº›ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“æ€ä¹ˆå®ç°å§ã€‚</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316010457190.png" alt="image-20250316010457190"></p><p>å…·ä½“çš„æ•ˆæœä¸º</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316010616818.png" alt="image-20250316010616818"></p><p>ç”Ÿæˆçš„æ•ˆæœï¼š</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316011615321.png" alt="image-20250316011615321"></p><p>å›¾ç‰‡çš„ç”Ÿæˆæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯SiliconCloundæ¥å®ç°ã€‚æ–‡æ¡£åœ°å€ï¼š<a href="https://docs.siliconflow.cn/cn/api-reference/images/images-generations">https://docs.siliconflow.cn/cn/api-reference/images/images-generations</a></p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316012208833.png" alt="image-20250316012208833"></p><h2 id="14-ç”Ÿæˆå°è¯´å’Œè§’è‰²"><a href="#14-ç”Ÿæˆå°è¯´å’Œè§’è‰²" class="headerlink" title="14. ç”Ÿæˆå°è¯´å’Œè§’è‰²"></a>14. ç”Ÿæˆå°è¯´å’Œè§’è‰²</h2><p>â€‹æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ä¸€ä¸ªåŸºäºå¤§æ¨¡å‹æ¥ç”Ÿæˆå°è¯´å’Œç›¸å…³è§’è‰²çš„æ¡ˆä¾‹</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316014016339.png" alt="image-20250316014016339"></p><p>æ•ˆæœ</p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316014108708.png" alt="image-20250316014108708"></p><p><img src="/2025/09/14/Dify%E6%95%99%E7%A8%8B/image-20250316014116356.png" alt="image-20250316014116356"></p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dify </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shellç¼–ç¨‹</title>
      <link href="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/"/>
      <url>/2025/08/23/Shell%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Shellç¼–ç¨‹å…¥é—¨"><a href="#Shellç¼–ç¨‹å…¥é—¨" class="headerlink" title="Shellç¼–ç¨‹å…¥é—¨"></a>Shellç¼–ç¨‹å…¥é—¨</h1><h2 id="è®¤è¯†Shell"><a href="#è®¤è¯†Shell" class="headerlink" title="è®¤è¯†Shell"></a>è®¤è¯†Shell</h2><p>å¼€å‘è€…åœ¨è¿›è¡ŒæœåŠ¡å™¨é›†ç¾¤ç®¡ç†æ—¶ï¼Œéƒ½éœ€è¦<strong>ç¼–å†™ Shell ç¨‹åºæ¥è¿›è¡ŒæœåŠ¡å™¨ç®¡ç†</strong>ã€‚Shell æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œ<a href="https://so.csdn.net/so/search?q=%E8%A7%A3%E9%87%8A%E5%99%A8&spm=1001.2101.3001.7020">è§£é‡Šå™¨</a>ï¼Œä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªå‘Â LinuxÂ å†…æ ¸å‘é€è¯·æ±‚ä»¥ä¾¿äºè¿è¡Œç¨‹åºçš„ç•Œé¢ç³»ç»Ÿå‡çº§ç¨‹åºã€‚ç”¨æˆ·å¯ä»¥ç”¨ Shell æ¥<strong>å¯åŠ¨ã€æŒ‚èµ·ã€åœæ­¢æˆ–è€…ç¼–å†™ä¸€äº›ç¨‹åº</strong>ã€‚</p><h2 id="Shell-è„šæœ¬çš„åˆ›å»ºä¸æ‰§è¡Œ"><a href="#Shell-è„šæœ¬çš„åˆ›å»ºä¸æ‰§è¡Œ" class="headerlink" title="Shell è„šæœ¬çš„åˆ›å»ºä¸æ‰§è¡Œ"></a>Shell è„šæœ¬çš„åˆ›å»ºä¸æ‰§è¡Œ</h2><p>Shell è„šæœ¬åœ¨æ‰§è¡Œæ—¶æœ‰ä¸¤ä¸ªæ ¼å¼ä¸Šçš„è¦æ±‚ï¼šä»¥Â <code>#!/bin/bash</code>Â å¼€å¤´ã€å¿…é¡»æœ‰å¯æ‰§è¡Œæƒé™ã€‚å¦‚ä¸‹æˆ‘ä»¬ç¼–å†™ç¬¬ä¸€ä¸ª Shell è„šæœ¬ï¼š</p><ol><li>åˆ›å»ºæ–°ç›®å½• shell ç”¨äºå­˜æ”¾ shell è„šæœ¬ï¼›<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@raspberrypi:~# <span class="built_in">mkdir</span> /root/shell</span><br><span class="line">root@raspberrypi:~# <span class="built_in">cd</span> /root/shell/</span><br></pre></td></tr></table></figure></li><li>vim ç¼–è¾‘å™¨æ–°å»º shell è„šæœ¬ shell.shï¼Œè¾“å…¥å‘½ä»¤ï¼›<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world!&quot;</span></span><br></pre></td></tr></table></figure></li><li>è¿™ä¸ªæ—¶å€™æŸ¥çœ‹ shell.sh çš„æƒé™ï¼Œæ˜¯æ²¡æœ‰å¯æ‰§è¡Œæƒé™ x çš„ï¼›<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822004638486.png" alt="500"></li><li>ä¸ºå®ƒæ·»åŠ å¯æ‰§è¡Œæƒé™ï¼›<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@raspberrypi:~/shell# <span class="built_in">chmod</span> u+x shell.sh</span><br></pre></td></tr></table></figure><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822004750871.png" alt="500"></li><li>æ‰§è¡Œæ–‡ä»¶ï¼›<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822004856110.png" alt="400"><blockquote><p>shell è„šæœ¬å¸¸ç”¨çš„æ‰§è¡Œæ–¹å¼æœ‰ä¸¤ç§ï¼š</p></blockquote></li></ol><ul><li>è¾“å…¥è„šæœ¬çš„ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„ï¼ˆéœ€è¦å…ˆèµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™ xï¼‰ï¼›</li><li>sh + è„šæœ¬ï¼ˆæ— éœ€èµ‹äºˆæ‰§è¡Œæƒé™ï¼Œç›´æ¥æ‰§è¡Œå³å¯ï¼‰ã€‚</li></ul><h1 id="Shell-å˜é‡"><a href="#Shell-å˜é‡" class="headerlink" title="Shell å˜é‡"></a>Shell å˜é‡</h1><h2 id="ç³»ç»Ÿå˜é‡å’Œè‡ªå®šä¹‰å˜é‡"><a href="#ç³»ç»Ÿå˜é‡å’Œè‡ªå®šä¹‰å˜é‡" class="headerlink" title="ç³»ç»Ÿå˜é‡å’Œè‡ªå®šä¹‰å˜é‡"></a>ç³»ç»Ÿå˜é‡å’Œè‡ªå®šä¹‰å˜é‡</h2><p>Linux Shell ä¸­çš„å˜é‡åˆ†ä¸º<strong>ç³»ç»Ÿå˜é‡</strong>å’Œ<strong>ç”¨æˆ·è‡ªå®šä¹‰å˜é‡</strong>ã€‚ç³»ç»Ÿå˜é‡é¡¾åæ€ä¹‰å°±æ˜¯ç³»ç»Ÿå·²ç»è®¾ç½®å¥½çš„å˜é‡ï¼Œè¯¸å¦‚ $HOMEã€$PWDã€$USERã€$SHELL ç­‰éƒ½æ˜¯ç³»ç»Ÿå˜é‡ã€‚ä½¿ç”¨æŒ‡ä»¤Â <strong>set</strong>Â å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿä¸­æ‰€æœ‰çš„ç³»ç»Ÿå˜é‡ã€‚æˆ‘ä»¬å¸¸ç”¨è¾ƒå¤šçš„æ˜¯è‡ªå®šä¹‰å˜é‡ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><blockquote></blockquote><ul><li>å®šä¹‰å˜é‡ï¼š_å˜é‡åç§°&#x3D;å€¼_ï¼›</li><li>æ’¤é”€å˜é‡ï¼š_unset å˜é‡å_ï¼›</li><li>å®šä¹‰é™æ€å˜é‡ï¼š_readonly å˜é‡åç§°&#x3D;å€¼_ï¼ˆé™æ€å˜é‡ä¸èƒ½æ’¤é”€ï¼‰ï¼›</li><li>è¾“å‡ºå˜é‡ï¼š_$å˜é‡_ã€‚</li></ul><p>è¯•ç€æ“ä½œä¸€ä¸‹å˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®šä¹‰å˜é‡A</span></span><br><span class="line">A=100</span><br><span class="line"> </span><br><span class="line"><span class="comment">#è¾“å‡ºå˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> A=<span class="variable">$A</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;A=<span class="variable">$A</span>&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ’¤é”€å˜é‡A</span></span><br><span class="line"><span class="built_in">unset</span> A</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$A</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#å£°æ˜é™æ€çš„å˜é‡B = 3</span></span><br><span class="line"><span class="built_in">readonly</span> B=3</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$B</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœä¸ºï¼›<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822005436803.png" alt="500"></p><h2 id="å˜é‡çš„åŸºæœ¬è§„åˆ™"><a href="#å˜é‡çš„åŸºæœ¬è§„åˆ™" class="headerlink" title="å˜é‡çš„åŸºæœ¬è§„åˆ™"></a>å˜é‡çš„åŸºæœ¬è§„åˆ™</h2><p>åœ¨å®šä¹‰å˜é‡æ—¶å˜é‡åç§°å¯ä»¥ç”±å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ç»„æˆï¼Œä½†</p><ul><li><strong>ä¸èƒ½ä»¥æ•°å­—å¼€å¤´</strong>ï¼›</li><li><strong>ç­‰å·çš„ä¸¤ä¾§ä¸èƒ½æœ‰ç©ºæ ¼</strong>ï¼›</li><li><strong>å˜é‡åç§°ä¸€èˆ¬ä¸ºå¤§å†™</strong>ã€‚</li></ul><p>å°†å‘½ä»¤çš„è¿”å›å€¼èµ‹ç»™å˜é‡æ—¶ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼›</p><ul><li>A&#x3D;<code>data</code>ï¼Œè¡¨ç¤ºè¿è¡ŒÂ <strong><code> </code></strong>Â ä¸­çš„å‘½ä»¤ï¼Œå¹¶æŠŠç»“æœè¿”å›ç»™ Aï¼›</li><li>A&#x3D;$(data)ï¼Œ$() ç›¸å½“äº &#96;&#96;ã€‚</li></ul><h2 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½®ç¯å¢ƒå˜é‡"></a>è®¾ç½®ç¯å¢ƒå˜é‡</h2><ul><li>export å˜é‡å&#x3D;å˜é‡å€¼Â Â &#x2F;&#x2F;å°† Shell å˜é‡è¾“å‡ºä¸ºç¯å¢ƒå˜é‡&#x2F;å…¨å±€å˜é‡</li><li>source é…ç½®æ–‡ä»¶Â Â &#x2F;&#x2F;è®©ä¿®æ”¹åçš„é…ç½®ä¿¡æ¯ç«‹å³ç”Ÿæ•ˆ</li><li>echo $å˜é‡åÂ Â &#x2F;&#x2F;æŸ¥è¯¢ç¯å¢ƒå˜é‡çš„å€¼</li></ul><p>æ¡ˆä¾‹ï¼šåœ¨ &#x2F;etc&#x2F;profile æ–‡ä»¶ä¸­å®šä¹‰ TOMCAT_HOME ç¯å¢ƒå˜é‡ï¼Œvim æ‰“å¼€Â &#x2F;etc&#x2F;profile è¾“å…¥ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> TOMCAT_HOME=/opt/tomcat</span><br></pre></td></tr></table></figure><p>è®¾ç½®å®Œä¹‹ååˆ·æ–°é…ç½®çŠ¶æ€ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼›<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822010316487.png" alt="500"></p><h2 id="ä½ç½®å‚æ•°å˜é‡"><a href="#ä½ç½®å‚æ•°å˜é‡" class="headerlink" title="ä½ç½®å‚æ•°å˜é‡"></a>ä½ç½®å‚æ•°å˜é‡</h2><p>å½“æ‰§è¡Œä¸€ä¸ª Shell è„šæœ¬æ—¶ï¼Œå¦‚æœå¸Œæœ›è·å–åˆ°å‘½ä»¤è¡Œçš„å‚æ•°ä¿¡æ¯ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°ä½ç½®å‚æ•°å˜é‡ã€‚åŸºæœ¬è¯­æ³•æœ‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$n</span>  //n ä¸ºæ•°å­—ï¼Œ<span class="variable">$0</span> ä»£è¡¨å‘½ä»¤æœ¬èº«ï¼Œ<span class="variable">$1</span>-9 ä»£è¡¨ç¬¬ 1 åˆ°ç¬¬ 9 ä¸ªå‚æ•°ï¼Œ10 ä»¥ä¸Šçš„å‚æ•°éœ€è¦ç”¨å¤§æ‹¬å·åŒ…å«å¦‚ <span class="variable">$&#123;10&#125;</span></span><br><span class="line">$*  //ä»£è¡¨å‘½ä»¤è¡Œä¸­çš„æ‰€æœ‰å‚æ•°ï¼Œ$* å°†æ‰€æœ‰å‚æ•°çœ‹æˆä¸€ä¸ªæ•´ä½“</span><br><span class="line"><span class="variable">$@</span>  //è¿™ä¸ªå˜é‡ä¹Ÿå¯ä»¥ä»£è¡¨å‘½ä»¤è¡Œä¸­çš„æ‰€æœ‰å‚æ•°ï¼Œä¸è¿‡ <span class="variable">$@</span> æŠŠæ¯ä¸ªå‚æ•°åŒºåˆ†å¯¹å¾…</span><br><span class="line"><span class="variable">$#</span>  //ä»£è¡¨å‘½ä»¤è¡Œä¸­æ‰€æœ‰å‚æ•°çš„ä¸ªæ•°</span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼šç¼–å†™ä¸€ä¸ª Shell è„šæœ¬ position.shï¼Œåœ¨è„šæœ¬ä¸­è·å–åˆ°å‘½ä»¤è¡Œä¸­çš„å„ä¸ªå‚æ•°ä¿¡æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;0=<span class="variable">$0</span> 1=<span class="variable">$1</span> 2=<span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ‰€æœ‰å‚æ•°=$*&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å‚æ•°ä¸ªæ•°=<span class="variable">$#</span>&quot;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œæ—¶è¾“å…¥ 100 å’Œ 200 ä¸¤ä¸ªå‚æ•°ï¼Œç»“æœå¦‚ä¸‹ã€‚<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822010733551.png" alt="500"></p><h2 id="é¢„å®šä¹‰å˜é‡"><a href="#é¢„å®šä¹‰å˜é‡" class="headerlink" title="é¢„å®šä¹‰å˜é‡"></a>é¢„å®šä¹‰å˜é‡</h2><p>é¢„å®šä¹‰å˜é‡å°±æ˜¯ Shell çš„è®¾è®¡è€…äº‹å…ˆå®šä¹‰å¥½çš„å˜é‡ï¼Œå¯ä»¥ç›´æ¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨ã€‚åŸºæœ¬è¯­æ³•æœ‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">$Â Â //å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å·ç ï¼ˆPIDï¼‰</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">!Â //åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„è¿›ç¨‹å·</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">?Â Â //æœ€åä¸€æ¬¡æ‰§è¡Œå‘½ä»¤çš„è¿”å›çŠ¶æ€ï¼Œå¦‚æœè¿™ä¸ªå˜é‡çš„å€¼ä¸º0è¯æ˜ä¸Šä¸€ä¸ªå‘½ä»¤æ­£ç¡®æ‰§è¡Œï¼Œå¦‚æœä¸æ˜¯ 0 ä¸Šä¸€ä¸ªå‘½ä»¤æ²¡æœ‰æ­£ç¡®æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><h1 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h1><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ Shell ç¼–ç¨‹ä¸­æœ‰å„ç§è¿ç®—æ“ä½œï¼Œè¯­æ³•æ ¼å¼ä¸ºÂ $((è¿ç®—å¼))æˆ–Â $[è¿ç®—å¼]Â æˆ–è€…Â expr m + nï¼›å¦‚æœå¸Œæœ›å°†Â expr çš„å€¼èµ‹ç»™æŸä¸ªå˜é‡ï¼Œä½¿ç”¨Â `` å³å¯ã€‚</span><br></pre></td></tr></table></figure><ul><li><strong>*</strong>Â Â &#x2F;&#x2F;ä¹˜ï¼Œåœ¨Â &#96;&#96; é‡Œé¢çš„ä¹˜åº”è¯¥ç”¨æ­¤æ ¼å¼å³ * å‰æ·»åŠ è½¬ä¹‰å­—ç¬¦ \</li><li><strong>&#x2F;</strong>Â Â &#x2F;&#x2F;é™¤</li><li><strong>%</strong>Â Â &#x2F;&#x2F;å–ä½™</li></ul><p>æ¡ˆä¾‹1ï¼šè®¡ç®— (2+3)Ã—4ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#è®¡ç®—(2+3)Ã—4çš„å€¼</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ–¹å¼1</span></span><br><span class="line">result1=$(((<span class="number">2</span>+<span class="number">3</span>)*<span class="number">4</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;res1=<span class="variable">$result1</span>&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ–¹å¼2</span></span><br><span class="line">result2=$[(2+3)*4]</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;res2=<span class="variable">$result2</span>&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ–¹å¼3</span></span><br><span class="line">result3=`<span class="built_in">expr</span> 2 + 3`</span><br><span class="line">result4=`<span class="built_in">expr</span> <span class="variable">$result3</span> \* 4`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;expr res4=<span class="variable">$result4</span>&quot;</span></span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ã€‚<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822011903946.png" alt="500"><br>æ–¹å¼2æŠ¥é”™äº†ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><ol><li><code>$((...))</code>æ˜¯ç°ä»£ bash æ¨èçš„ç®—æœ¯è®¡ç®—æ–¹å¼ï¼Œè¯­æ³•ç®€æ´ç›´è§‚</li><li><code>$[...]</code>æ˜¯è¾ƒæ—§çš„è¯­æ³•ï¼Œåœ¨æŸäº› shell ä¸­å¯èƒ½ä¸æ”¯æŒ</li><li><code>expr</code>æ˜¯æœ€ä¼ ç»Ÿçš„æ–¹å¼ï¼Œéœ€è¦æ³¨æ„è¿ç®—ç¬¦å‰åå¿…é¡»æœ‰ç©ºæ ¼ï¼Œä¸”æŸäº›è¿ç®—ç¬¦ï¼ˆå¦‚ *ï¼‰éœ€è¦è½¬ä¹‰</li></ol><p>æ¡ˆä¾‹2ï¼šè®¡ç®—å‘½ä»¤è¡Œä¸¤ä¸ªå‚æ•°çš„å’Œï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¡ç®—å‘½ä»¤è¡Œä¸¤ä¸ªå‚æ•°çš„å’Œ</span></span><br><span class="line"><span class="built_in">sum</span>=$((<span class="variable">$1</span>+<span class="variable">$2</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;sum=<span class="variable">$sum</span>&quot;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œæ—¶è¾“å…¥ 20 å’Œ 50ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250822012257677.png" alt="500"></p><h1 id="æ¡ä»¶åˆ¤æ–­"><a href="#æ¡ä»¶åˆ¤æ–­" class="headerlink" title="æ¡ä»¶åˆ¤æ–­"></a>æ¡ä»¶åˆ¤æ–­</h1><p>æ¡ä»¶åˆ¤æ–­ä½¿ç”¨è¯­æ³•Â **[ condition ]**ï¼ˆæ³¨æ„ condition å‰åæœ‰ç©ºæ ¼ï¼‰ï¼Œéç©ºä¼šè¿”å› trueã€‚å¯ä»¥ä½¿ç”¨ $? éªŒè¯ç»“æœï¼Œ0 ä¸º trueï¼Œ&gt;1 ä¸ºfalseã€‚å¦‚ï¼š</p><ul><li>[ hspEdu ] ä¼šè¿”å› true</li><li>[ ] ä¼šè¿”å› false</li><li>[ conditionÂ ] &amp;&amp; echo yesÂ || echo no ï¼Œå‰ä¸€ä¸ªåˆ¤æ–­æ»¡è¶³æ—¶ä¼šç»§ç»­æ‰§è¡Œåé¢çš„è¯­å¥</li></ul><p>å¸¸ç”¨çš„åˆ¤æ–­è¯­å¥æœ‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line">=  //ç›¸ç­‰</span><br><span class="line">åˆ¤æ–­ä¸¤ä¸ªæ•´æ•°</span><br><span class="line"></span><br><span class="line">-lt  //å°äº</span><br><span class="line">-le  //å°äºç­‰äº</span><br><span class="line">-eq  //ç­‰äº</span><br><span class="line">-gt  //å¤§äº</span><br><span class="line">-ge  //å¤§äºç­‰äº</span><br><span class="line">-ne  //ä¸ç­‰äº</span><br><span class="line">æŒ‰ç…§æ–‡ä»¶æƒé™è¿›è¡Œåˆ¤æ–­</span><br><span class="line"></span><br><span class="line">-r  //æœ‰è¯»çš„æƒé™</span><br><span class="line">-w  //æœ‰å†™çš„quanx</span><br><span class="line">-x  //æœ‰æ‰§è¡Œçš„æƒé™</span><br><span class="line">æŒ‰ç…§æ–‡ä»¶ç±»å‹è¿›è¡Œåˆ¤æ–­</span><br><span class="line"></span><br><span class="line">-f  //æ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå¸¸è§„çš„æ–‡ä»¶</span><br><span class="line">-e  //æ–‡ä»¶å­˜åœ¨</span><br><span class="line">-d  //æ–‡ä»¶å­˜åœ¨å¹¶æ˜¯ä¸€ä¸ªç›®å½•</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼šåˆ¤æ–­ â€œokâ€ æ˜¯å¦ç­‰äº okï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;ok&quot;</span> = <span class="string">&quot;ok&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;equal&quot;</span> <span class="comment">#å¦‚æœç­‰äºåˆ™è¾“å‡º equal</span></span><br><span class="line"><span class="keyword">fi</span>  <span class="comment">#å¦åˆ™ç»“æŸ</span></span><br></pre></td></tr></table></figure><p>22 æ˜¯å¦å¤§äºç­‰äº 21ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ 22 -ge 21 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å¤§äº&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>&#x2F;root&#x2F;shell ç›®å½•ä¸‹æ˜¯å¦æœ‰ aaa.txt æ–‡ä»¶ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -f /root/shell/aaa.txt ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å­˜åœ¨&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250823184636321.png" alt="500"></p><h1 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h1><h2 id="if-è¯­å¥"><a href="#if-è¯­å¥" class="headerlink" title="if è¯­å¥"></a>if è¯­å¥</h2><p>if è¯­å¥çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼Œéœ€è¦æ³¨æ„ [ æ¡ä»¶åˆ¤æ–­å¼Â ] ä¸­æ‹¬å·ä¸åˆ¤æ–­å¼ä¹‹é—´å¿…é¡»æœ‰ç©ºæ ¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å•åˆ†æ”¯</span></span><br><span class="line"><span class="keyword">if</span> [ æ¡ä»¶åˆ¤æ–­å¼ ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">ä»£ç </span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¤šåˆ†æ”¯</span></span><br><span class="line"><span class="keyword">if</span> [ æ¡ä»¶åˆ¤æ–­å¼ ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">ä»£ç </span><br><span class="line"><span class="keyword">elif</span> [ æ¡ä»¶åˆ¤æ–­å¼ ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">ä»£ç </span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼šç¼–å†™ä¸€ä¸ª shell ç¨‹åºï¼Œå¦‚æœè¾“å…¥çš„å‚æ•°å¤§äºç­‰äº 60ï¼Œè¾“å‡ºâ€œåŠæ ¼â€ï¼Œå°äº 60 åˆ™è¾“å‡ºâ€œä¸åŠæ ¼â€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$1</span> -ge 60 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;åŠæ ¼&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$1</span> -le 60 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;ä¸åŠæ ¼&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œæ—¶å¸¦å‚æ•°ç»“æœå¦‚ä¸‹ï¼›<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250823184923512.png" alt="500"></p><h2 id="case-è¯­å¥"><a href="#case-è¯­å¥" class="headerlink" title="case è¯­å¥"></a>case è¯­å¥</h2><p>åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼Œå…¶ä¸­ * ä»£è¡¨éƒ½ä¸æ˜¯ä»¥ä¸Šçš„å€¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> $å˜é‡å <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;å€¼1&quot;</span>)</span><br><span class="line">å¦‚æœå˜é‡çš„å€¼ç­‰äº1ï¼Œåˆ™æ‰§è¡Œç¨‹åº1</span><br><span class="line">;;</span><br><span class="line"><span class="string">&quot;å€¼2&quot;</span>)</span><br><span class="line">å¦‚æœå˜é‡çš„å€¼ç­‰äº2ï¼Œåˆ™æ‰§è¡Œç¨‹åº2</span><br><span class="line">;;</span><br><span class="line">......</span><br><span class="line">*)</span><br><span class="line">å¦‚æœå˜é‡çš„å€¼éƒ½ä¸æ˜¯ä»¥ä¸Šçš„å€¼ï¼Œåˆ™æ‰§è¡Œæ­¤ç¨‹åº</span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼šç¼–å†™ Shell ç¨‹åºå½“å‘½ä»¤è¡Œå‚æ•°ä¸º 1 æ—¶è¾“å‡ºâ€œå‘¨ä¸€â€ï¼Œæ˜¯ 2 æ—¶è¾“å‡ºâ€œå‘¨äºŒâ€ï¼Œå…¶ä»–æƒ…å†µå‡è¾“å‡ºâ€œotherâ€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å‘¨ä¸€&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="string">&quot;2&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å‘¨äºŒ&quot;</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;other&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250823185127619.png" alt="500"></p><h2 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a>for å¾ªç¯</h2><p>for å¾ªç¯æœ‰ä¸¤ä¸ªåŸºæœ¬è¯­æ³•ï¼Œè¯­æ³•ä¸€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> å˜é‡ <span class="keyword">in</span> å€¼1 å€¼2 å€¼3...</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ç¨‹åº</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹1ï¼šæ‰“å°å‘½ä»¤è¡Œè¾“å…¥çš„å‚æ•°ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#ä½¿ç”¨$*</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;$*&quot;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;num is <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä½¿ç”¨$@</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;num is <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œè¿™ä¹Ÿå°è¯äº† $*(å°†æ‰€æœ‰å‚æ•°çœ‹æˆä¸€ä¸ªæ•´ä½“)Â å’Œ $@(å°†å‚æ•°åŒºåˆ«å¯¹å¾…) çš„åŒºåˆ«ï¼›<br><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250823185707944.png" alt="500"><br>é™¤æ­¤ä¹‹å¤– for å¾ªç¯è¿˜æœ‰ç¬¬äºŒä¸ªè¯­æ³•ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>((åˆå§‹å€¼;å¾ªç¯æ§åˆ¶æ¡ä»¶;å˜é‡å˜åŒ–))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ç¨‹åº</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹2ï¼šè¾“å‡ºä» 1 åŠ åˆ° 100 çš„å€¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">sum</span>=0</span><br><span class="line"><span class="keyword">for</span>(( i=<span class="number">1</span>;i&lt;=<span class="number">100</span>;i++ ))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">sum1=$((<span class="variable">$sum</span>+<span class="variable">$i</span>))</span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ </span></span><br><span class="line">sum2=$((sum+i))</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;SUM=<span class="variable">$sum1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;sum=<span class="variable">$sum2</span>&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250823190437968.png" alt="500"></p><h2 id="while-å¾ªç¯"><a href="#while-å¾ªç¯" class="headerlink" title="while å¾ªç¯"></a>while å¾ªç¯</h2><p>åŸºæœ¬è¯­æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [ æ¡ä»¶åˆ¤æ–­å¼ ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ç¨‹åº</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼šå‘½ä»¤è¡Œè¾“å…¥ä¸€ä¸ªå‚æ•° nï¼Œè®¡ç®— 1+2+..+n çš„å€¼ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/bin/bash</span></span><br><span class="line"><span class="built_in">sum</span>=0</span><br><span class="line">i=0</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -le <span class="variable">$1</span> ]  <span class="comment">#åªè¦ç¬¬iä¸ªæ•°å°äºæˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œå°±æ‰§è¡Œå¾ªç¯</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">sum</span>=$[<span class="variable">$sum</span>+<span class="variable">$i</span>]</span><br><span class="line">i=$[<span class="variable">$i</span>+1]  <span class="comment">#iè‡ªå¢</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;SUM=<span class="variable">$SUM</span>&quot;</span></span><br></pre></td></tr></table></figure><h2 id="read-è¯»å–æ§åˆ¶å°è¾“å…¥"><a href="#read-è¯»å–æ§åˆ¶å°è¾“å…¥" class="headerlink" title="read è¯»å–æ§åˆ¶å°è¾“å…¥"></a>read è¯»å–æ§åˆ¶å°è¾“å…¥</h2><p>åœ¨æˆ‘ä»¬è¿›è¡Œ Shell ç¼–ç¨‹çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¹Ÿéœ€è¦è·Ÿæ§åˆ¶å°è¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚ç”¨æˆ·åŠ¨æ€çš„è¾“å…¥ä¸€äº›æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ° readã€‚åŸºæœ¬è¯­æ³•ä¸º</p><blockquote><p><em>read(é€‰é¡¹)(å‚æ•°)</em><br>-p åˆ¶å®šè¯»å–å€¼æ—¶çš„æç¤ºç¬¦<br>-t æŒ‡å®šè¯»å–å€¼æ—¶çš„ç­‰å¾…æ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…è¾“å…¥ï¼Œåˆ™ä¸å†ç­‰å¾…</p></blockquote><p>æ¡ˆä¾‹ 1ï¼šè¯»å–æ§åˆ¶å°è¾“å…¥ä¸€ä¸ª num å€¼ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¾“å…¥num1=ï¼š&quot;</span> num1</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä½ è¾“å…¥çš„num1ä¸ºï¼š<span class="variable">$num1</span>&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/23/Shell%E7%BC%96%E7%A8%8B/file-20250824000323787.png" alt="500"><br>æ¡ˆä¾‹ 2ï¼šè¯»å–æ§åˆ¶å°è¾“å…¥ä¸€ä¸ª num å€¼ï¼ŒæŒ‡å®šåœ¨ 10 ç§’å†…è¾“å…¥ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> -t 10 -p <span class="string">&quot;è¾“å…¥num2=&quot;</span> num2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä½ è¾“å…¥çš„num2ä¸ºï¼š<span class="variable">$num2</span>&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨astrbotæ­å»ºä½¿ç”¨deepseekæ¨¡å‹çš„QQæœºå™¨äºº</title>
      <link href="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
      <url>/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/weixin_65654278/article/details/145452636?spm=1001.2014.3001.5501">æ—§åšå®¢åœ°å€ï¼šã€Šä½¿ç”¨astrbotæ­å»ºä½¿ç”¨deepseekæ¨¡å‹çš„QQæœºå™¨äººã€‹</a></p><h4 id="astrbotå®˜ç½‘"><a href="#astrbotå®˜ç½‘" class="headerlink" title="astrbotå®˜ç½‘"></a><a href="https://astrbot.app/">astrbotå®˜ç½‘</a></h4><h1 id="ä»€ä¹ˆæ˜¯-AstrBotï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-AstrBotï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ AstrBotï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ AstrBotï¼Ÿ</h1><ul><li><p>AstrBot æ˜¯ä¸€ä¸ªæ˜“äºä¸Šæ‰‹çš„å¤šå¹³å°èŠå¤©æœºå™¨äººåŠå¼€å‘æ¡†æ¶ã€‚é€šè¿‡å®ƒï¼Œä½ èƒ½å¤Ÿåœ¨å¤šç§æ¶ˆæ¯å¹³å°ä¸Šéƒ¨ç½²ä¸€ä¸ªæ”¯æŒå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„èŠå¤©æœºå™¨äººã€‚å¹¶ä»¥æ­¤å®ç°ä½†ä¸é™äº AI çŸ¥è¯†åº“é—®ç­”ã€è§’è‰²æ‰®æ¼”ã€ç¾¤èŠç®¡ç†ã€LLM Agent ç­‰åŠŸèƒ½ã€‚å®ƒæœ‰å¦‚ä¸‹ç‰¹æ€§</p></li><li><p>æ¾è€¦åˆï¼šAstrBot å†ç» 3 æ¬¡å¤§ä»£ç é‡æ„ã€‚æ¯ä¸€æ¬¡éƒ½åœ¨å‘ç€æ¾è€¦åˆã€æ¨¡å—åŒ–çš„æ–¹å‘è¿ˆè¿›ã€‚ç›®å‰ï¼ŒAstrBot é‡‡ç”¨äº†äº‹ä»¶æ€»çº¿å’Œæ¶ˆæ¯äº‹ä»¶æµæ°´çº¿çš„æ¶æ„è®¾è®¡ï¼Œå®ç°è¿‘ä¹å®Œå…¨çš„æ¨¡å—åŒ–ã€‚</p></li><li><p>å¼‚æ­¥ï¼šAstrBot é‡‡ç”¨äº†å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œä½¿å¾— AstrBot åœ¨å¤„ç†å¤šä¸ªæ¶ˆæ¯å¹³å°çš„æ¶ˆæ¯æ—¶ï¼Œèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆã€‚</p></li><li><p>å¤šæ¶ˆæ¯å¹³å°éƒ¨ç½²ï¼šAstrBot é»˜è®¤æ”¯æŒæ¥å…¥ QQã€QQé¢‘é“ã€å¾®ä¿¡ã€‚é€šè¿‡æ’ä»¶ï¼Œè¿˜å¯ä»¥æ¥å…¥ Telegram ç­‰ä»»ä½•æ¶ˆæ¯å¹³å°ã€‚</p></li><li><p>å®Œå–„çš„æ’ä»¶ç³»ç»Ÿï¼šAstrBot æä¾›äº†å®Œå–„ã€åŠå…¶æ˜“äºä¸Šæ‰‹çš„æ’ä»¶ç³»ç»Ÿï¼Œä½ å¯ä»¥é€šè¿‡æ’ä»¶å®ç°è‡ªå·±çš„åŠŸèƒ½ã€‚å¼€å‘ä¸€ä¸ªæ’ä»¶ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ã€‚</p></li></ul><h1 id="å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"><a href="#å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ" class="headerlink" title="å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"></a>å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h1><p>ä¸‹é¢çš„æ‹“æ‰‘å›¾ç®€è¿°äº† AstrBot ä¸æ’ä»¶ã€æ¶ˆæ¯å¹³å°é€‚é…å™¨ã€è¯­è¨€æ¨¡å‹æä¾›å•†ã€æ¶ˆæ¯åè®®å®ç°ç«¯çš„å…³ç³»ã€‚</p><p><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817011008321.png"></p><h1 id="å¼€å§‹éƒ¨ç½²ï¼ˆLinuxç”¨dockeréƒ¨ç½²ï¼‰"><a href="#å¼€å§‹éƒ¨ç½²ï¼ˆLinuxç”¨dockeréƒ¨ç½²ï¼‰" class="headerlink" title="å¼€å§‹éƒ¨ç½²ï¼ˆLinuxç”¨dockeréƒ¨ç½²ï¼‰"></a>å¼€å§‹éƒ¨ç½²ï¼ˆLinuxç”¨dockeréƒ¨ç½²ï¼‰</h1><p>æˆ‘çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ˜¯ä½¿ç”¨dockerè¿›è¡Œéƒ¨ç½²ï¼Œå¦‚æœè¿˜æ²¡å®‰è£…dockerï¼Œè¯·ä½¿ç”¨<a href="https://1panel.cn/docs/installation/online_installation/">å®‰è£…1panelé¢æ¿</a>è¿›è¡Œå‚»ç“œå¼è‡ªåŠ¨å®‰è£…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> astrbot</span><br><span class="line"><span class="built_in">cd</span> astrbot</span><br><span class="line"><span class="built_in">sudo</span> docker run -itd \</span><br><span class="line">-p 6180-6200:6180-6200 \</span><br><span class="line">-p 11451:11451 \</span><br><span class="line">-v <span class="variable">$PWD</span>/data:/AstrBot/data \</span><br><span class="line">--name astrbot soulter/astrbot:latest</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ AstrBot çš„æ—¥å¿—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> docker logs -f astrbot</span><br></pre></td></tr></table></figure><h2 id="ğŸ‰-å¤§åŠŸå‘Šæˆï¼"><a href="#ğŸ‰-å¤§åŠŸå‘Šæˆï¼" class="headerlink" title="ğŸ‰ å¤§åŠŸå‘Šæˆï¼"></a>ğŸ‰ å¤§åŠŸå‘Šæˆï¼</h2><p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ ä¼šçœ‹åˆ° AstrBot æ‰“å°å‡ºçš„æ—¥å¿—ã€‚</p><p>å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œä½ ä¼šçœ‹åˆ°ä¸€æ¡æ—¥å¿—æ˜¾ç¤ºç±»ä¼¼ ğŸŒˆ ç®¡ç†é¢æ¿å·²å¯åŠ¨ï¼Œå¯è®¿é—® å¹¶é™„å¸¦äº†å‡ æ¡é“¾æ¥ã€‚æ‰“å¼€å…¶ä¸­ä¸€ä¸ªé“¾æ¥å³å¯è®¿é—® AstrBot ç®¡ç†é¢æ¿ã€‚å¦‚ä¸‹å›¾<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817012042044.png"><br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817012800367.png"></p><blockquote><p>æ³¨æ„ï¼šå¦‚ä½•ä½¿ç”¨äº‘æœåŠ¡å™¨éƒ¨ç½²çš„è®°å¾—æ‰“å¼€é˜²ç«å¢™ï¼Œç«¯å£<code>6185</code></p></blockquote><p><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817013101613.png"><br>ç™»å½•è¿›å»å<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817013326885.png"></p><h1 id="é€šè¿‡-NapCatQQ-åè®®å®ç°ç«¯æ¥å…¥-QQ"><a href="#é€šè¿‡-NapCatQQ-åè®®å®ç°ç«¯æ¥å…¥-QQ" class="headerlink" title="é€šè¿‡ NapCatQQ åè®®å®ç°ç«¯æ¥å…¥ QQ"></a>é€šè¿‡ NapCatQQ åè®®å®ç°ç«¯æ¥å…¥ QQ</h1><blockquote><p>[!tip]<br><code>å¦‚æœè¿‡äºé¢‘ç¹ä½¿ç”¨ï¼ˆåŒä¸€æ—¶é—´å‘é€æ¶ˆæ¯æ¬¡æ•°è¿‡å¤šï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ›´é«˜çš„é£æ§é£é™©ï¼Œè¯·æ³¨æ„ä½¿ç”¨é¢‘ç‡ã€‚</code></p></blockquote><p>NapCatQQ æ˜¯åŸºäºæ— å¤´ QQNT çš„ OneBot åè®®å®ç°ç«¯ã€‚å®ƒæœ¬è´¨ä¸Šè¿è¡Œäº†ä¸€ä¸ª QQNT å®ä¾‹ã€‚</p><p><strong>WARNING</strong></p><p>ä¸ºäº†æˆåŠŸéƒ¨ç½²ï¼Œä½ éœ€è¦ï¼š</p><ul><li>ä¸€ä¸ª QQ å·ï¼ˆæœ€å¥½ä¸æ˜¯æ–°åˆ›å»ºçš„ QQ å·ï¼‰ã€‚</li><li>ä¸€å°å…·æœ‰æ‘„åƒåŠŸèƒ½çš„æ‰‹æœºä»¥æ‰«ç ç™»å½• QQã€‚</li></ul><h2 id="é€šè¿‡-Docker-éƒ¨ç½²-NapCat"><a href="#é€šè¿‡-Docker-éƒ¨ç½²-NapCat" class="headerlink" title="é€šè¿‡ Docker éƒ¨ç½² NapCat"></a>é€šè¿‡ Docker éƒ¨ç½² <a href="https://napcat.napneko.icu/">NapCat</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">-e NAPCAT_GID=$(<span class="built_in">id</span> -g) \</span><br><span class="line">-e NAPCAT_UID=$(<span class="built_in">id</span> -u) \</span><br><span class="line">-p 3000:3000 \</span><br><span class="line">-p 3001:3001 \</span><br><span class="line">-p 6099:6099 \</span><br><span class="line">--name napcat \</span><br><span class="line">--restart=always \</span><br><span class="line">mlikiowa/napcat-docker:latest</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°ä»¥ä¸‹é”™è¯¯è¯·æ›´æ–°dockeræºä»“åº“<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817020103834.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure><p>å†™å…¥ä¸€ä¸‹å†…å®¹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;https://docker.hpcloud.cloud&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.m.daocloud.io&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.unsee.tech&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.1panel.live&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;http://mirrors.ustc.edu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.chenby.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;http://mirror.azure.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://dockerpull.org&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://dockerhub.icu&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://hub.rat.dev&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://proxy.1panel.live&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.1panel.top&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.m.daocloud.io&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.1ms.run&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;https://docker.ketches.cn&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¿å­˜æ–‡ä»¶åé‡å¯ Docker æœåŠ¡ï¼Œæ–°çš„é•œåƒæºå³å¯ç”Ÿæ•ˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><p>é‡æ–°æ‰§è¡Œdocekréƒ¨ç½²æŒ‡ä»¤<br>æ‰§è¡ŒæˆåŠŸåï¼Œéœ€è¦æŸ¥çœ‹æ—¥å¿—ä»¥å¾—åˆ°ç™»å½•äºŒç»´ç å’Œç®¡ç†é¢æ¿çš„ URLã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs napcat</span><br></pre></td></tr></table></figure><p>è¯·å¤åˆ¶ç®¡ç†é¢æ¿çš„ URLï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å¤‡ç”¨ã€‚</p><p>ç„¶åä½¿ç”¨ä½ è¦ç™»å½•çš„ QQ æ‰«æå‡ºç°çš„äºŒç»´ç ï¼Œå³å¯ç™»å½•ã€‚</p><p>å¦‚æœç™»å½•é˜¶æ®µæ²¡æœ‰å‡ºç°é—®é¢˜ï¼Œå³æˆåŠŸéƒ¨ç½²ã€‚</p><p><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817021124492.png"></p><h1 id="è¿æ¥åˆ°-AstrBot"><a href="#è¿æ¥åˆ°-AstrBot" class="headerlink" title="è¿æ¥åˆ° AstrBot"></a>è¿æ¥åˆ° AstrBot</h1><h2 id="é…ç½®-aiocqhttp"><a href="#é…ç½®-aiocqhttp" class="headerlink" title="é…ç½® aiocqhttp"></a>é…ç½® aiocqhttp</h2><p>åœ¨ AstrBot çš„ç®¡ç†é¢æ¿ä¸­ï¼Œé€‰æ‹©å·¦è¾¹æ çš„ <strong>æ¶ˆæ¯å¹³å°</strong> é€‰é¡¹å¡ã€‚ç‚¹å‡»**+**å·æ–°å¢é€‚é…å™¨ï¼Œé€‰æ‹© __aiocqhttp__ï¼Œä¼šå‡ºç° <strong>aiocqhttp</strong> çš„ç›¸å…³é…ç½®é¡¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817021955892.png"><br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817021439724.png"></p><h2 id="é…ç½®é¡¹å¡«å†™ï¼š"><a href="#é…ç½®é¡¹å¡«å†™ï¼š" class="headerlink" title="é…ç½®é¡¹å¡«å†™ï¼š"></a>é…ç½®é¡¹å¡«å†™ï¼š</h2><p>ID(id)ï¼šéšæ„å¡«å†™ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„æ¶ˆæ¯å¹³å°å®ä¾‹ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨å¡«å……ã€‚<br>å¯ç”¨(enable): å‹¾é€‰ã€‚<br>åå‘ WebSocket ä¸»æœºåœ°å€ï¼šè¯·å¡«å†™ä½ çš„æœºå™¨çš„ IP åœ°å€ã€‚å¦‚ 0.0.0.0<br>åå‘ WebSocket ç«¯å£ï¼šå¡«å†™ä¸€ä¸ªç«¯å£11451ã€‚<code>è¿™ä¸ªç«¯å£æ˜¯é€šè¿‡ä¸Šé¢dockeréƒ¨ç½²çš„æ—¶å€™å°±å®šä¸‹æ¥äº†ï¼Œè·Ÿåˆ°è¿™ä¸€æ­¥åˆ«æ”¹æˆå…¶ä»–çš„</code></p><h3 id="ä¿å­˜é…ç½®"><a href="#ä¿å­˜é…ç½®" class="headerlink" title="ä¿å­˜é…ç½®"></a>ä¿å­˜é…ç½®</h3><p>åˆ‡è®°ç‚¹å‡»å³ä¸‹è§’Â <strong>ä¿å­˜</strong>ï¼ŒAstrBot é‡å¯å¹¶ä¼šåº”ç”¨é…ç½®ã€‚</p><h2 id="åœ¨-NapCatQQ-ä¸­æ·»åŠ -WebSocket-å®¢æˆ·ç«¯"><a href="#åœ¨-NapCatQQ-ä¸­æ·»åŠ -WebSocket-å®¢æˆ·ç«¯" class="headerlink" title="åœ¨ NapCatQQ ä¸­æ·»åŠ  WebSocket å®¢æˆ·ç«¯"></a>åœ¨ NapCatQQ ä¸­æ·»åŠ  WebSocket å®¢æˆ·ç«¯</h2><p>åˆ‡æ¢å› NapCatQQ çš„ç®¡ç†é¢æ¿ï¼Œç‚¹å‡» <strong>ç½‘ç»œé…ç½®-&gt;æ·»åŠ ç½‘ç»œé…ç½®</strong>ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œåç§°éšæ„å¡«å†™ï¼Œç±»å‹é€‰æ‹© <strong>WebSocket å®¢æˆ·ç«¯</strong>ã€‚ç‚¹å‡»ç¡®è®¤ã€‚<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817022411435.png"></p><p>åœ¨æ–°å¼¹å‡ºçš„çª—å£ä¸­ï¼š</p><ul><li>å‹¾é€‰ å¯ç”¨ã€‚</li><li>URL å¡«å†™ ws:&#x2F;&#x2F;&lt;å®¿ä¸»æœºIP&gt;:&lt;åœ¨ AstrBotä¸­å¡«å†™çš„ç«¯å£&gt;&#x2F;wsã€‚å¦‚ ws:&#x2F;&#x2F;172.17.0.3:11451&#x2F;wsã€‚<br>å› ä¸ºè¿™é‡Œæ˜¯é€šè¿‡dockeréƒ¨ç½²çš„ï¼Œè¦æŸ¥çœ‹å®¹å™¨ipï¼Œä¸æ˜¯ä½ å®é™…çš„ç‰©ç†æœºçš„ipåœ°å€,ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹astrBotåˆ†åˆ°çš„è™šæ‹ŸIPåœ°å€<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect -f <span class="string">&#x27;&#123;&#123;range.NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#x27;</span> astrbot </span><br></pre></td></tr></table></figure> å¦‚æœä¸å‡ºæ„å¤–çš„è¯ï¼Œä»–å°±ä¼šè¿”å›dockeråˆ†é…ç»™astrBotçš„è™šæ‹ŸIPåœ°å€äº†ï¼Œåœ¨napcaté‡Œå¡«ws:&#x2F;&#x2F;è·å–åˆ°çš„IP:11451&#x2F;ws å°±å¯ä»¥äº†</li><li>æ¶ˆæ¯æ ¼å¼ï¼šArray<br>åˆ‡è®°åé¢åŠ ä¸€ä¸ª <strong>&#x2F;ws</strong> åˆ‡è®°åé¢åŠ ä¸€ä¸ª &#x2F;ws! åˆ‡è®°åé¢åŠ ä¸€ä¸ª <strong>&#x2F;ws</strong></li></ul><p>ç‚¹å‡» <strong>ä¿å­˜</strong>ã€‚</p><p>ğŸ‰ å¤§åŠŸå‘Šæˆï¼<br>æ­¤æ—¶ï¼Œä½ çš„ AstrBot å’Œ NapCatQQ åº”è¯¥å·²ç»è¿æ¥æˆåŠŸã€‚ä½¿ç”¨ ç§èŠ çš„æ–¹å¼åœ¨ QQ å¯¹æœºå™¨äººå‘é€ &#x2F;help ä»¥æ£€æŸ¥æ˜¯å¦è¿æ¥æˆåŠŸã€‚<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817022913532.png"></p><h1 id="è·å–api"><a href="#è·å–api" class="headerlink" title="è·å–api"></a>è·å–api</h1><p>æˆ‘ç”¨çš„æ˜¯<a href="https://cloud.siliconflow.cn/i/iICxcKiF"><strong>ç¡…åŸºæµåŠ¨</strong></a>ï¼Œå®˜ç½‘é“¾æ¥<a href="https://cloud.siliconflow.cn/i/iICxcKiF%EF%BC%8C%E5%A6%82%E6%9E%9C%E8%A7%89%E6%98%AF%E6%88%91%E4%B8%8A%E9%9D%A2%E6%88%91%E6%AD%A5%E9%AA%A4%E5%AE%9E%E7%8E%B0%E6%B2%A1%E6%9C%89%E9%97%AE%E9%A2%98%E9%AB%98%E5%8F%B0%E6%82%A8%E7%9A%84%E8%B4%B5%E6%89%8B%E4%BD%BF%E7%94%A8%E6%88%91%E7%9A%84%E9%82%80%E8%AF%B7%E7%A0%81%E6%B3%A8%E5%86%8C%EF%BC%9A**iICxcKiF**%EF%BC%8C%E5%AE%83%E5%8F%AF%E4%BB%A5%E4%BD%BF%E6%96%B0%E7%94%A8%E6%88%B7%E8%8E%B7%E5%BE%97%E5%85%8D%E8%B4%B914%E5%85%83%E7%9A%84%E8%B5%A0%E9%80%81%E4%BD%99%E9%A2%9D%EF%BC%8C%E8%87%AA%E7%94%A8%E4%B8%8D%E5%A4%AA%E9%A2%91%E7%B9%81%E5%A4%A7%E6%A6%82%E5%8F%AF%E4%BB%A5%E7%94%A8%E4%B8%80%E7%99%BE%E5%A4%9A%E5%A4%A9%EF%BC%8C%E6%88%91%E9%97%AE%E8%BF%87LMM%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BA%86">https://cloud.siliconflow.cn/i/iICxcKiFï¼Œå¦‚æœè§‰æ˜¯æˆ‘ä¸Šé¢æˆ‘æ­¥éª¤å®ç°æ²¡æœ‰é—®é¢˜é«˜å°æ‚¨çš„è´µæ‰‹ä½¿ç”¨æˆ‘çš„é‚€è¯·ç æ³¨å†Œï¼š**iICxcKiF**ï¼Œå®ƒå¯ä»¥ä½¿æ–°ç”¨æˆ·è·å¾—å…è´¹14å…ƒçš„èµ é€ä½™é¢ï¼Œè‡ªç”¨ä¸å¤ªé¢‘ç¹å¤§æ¦‚å¯ä»¥ç”¨ä¸€ç™¾å¤šå¤©ï¼Œæˆ‘é—®è¿‡LMMæœºå™¨äººäº†</a> :smiley::smile::laughing:<br>ä¸‹é¢æ˜¯æˆ‘ç©äº†ä¸€å¤©ï¼Œå¤§æ¦‚ç”¨äº†0.018å…ƒ<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817023027317.png"><br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817023101677.png"><br>å¤åˆ¶APIç§˜é’¥å›åˆ°ä¸‹é¢çš„Astrbotç•Œé¢é€‰æ‹©<strong>æœåŠ¡æä¾›å•†-&gt;ç‚¹å‡»+å·æ–°å¢æœåŠ¡æä¾›å•†-&gt;é€‰æ‹©ç¡…åŸºæµåŠ¨</strong>ï¼Œå¡«åˆ°api keyå¤„ï¼Œæœ€åå³ä¸‹è§’ç‚¹å‡»<strong>ä¿å­˜ã€‚</strong><br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817023311871.png"><br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817023328282.png"></p><h2 id="ğŸ‰å¤§åŠŸå‘Šæˆ"><a href="#ğŸ‰å¤§åŠŸå‘Šæˆ" class="headerlink" title="ğŸ‰å¤§åŠŸå‘Šæˆ"></a>ğŸ‰å¤§åŠŸå‘Šæˆ</h2><p>å‘ä½ çš„QQæœºå™¨äººå‘é€æ¶ˆæ¯,<br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817023619725.png"><br><img src="/2025/08/17/projectNote/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/file-20250817023640917.png"><br>è¿›è¡Œåˆ°è¿™ä¸€æ­¥ï¼Œæ­å–œä½ å‡ºå¸ˆäº†ï¼Œå¯ä»¥å’Œä½ çš„æœºå™¨äººèŠå¤©äº†ï¼Œ<strong>å¦‚æœä½ çš„QQç¼ºå°‘ä¸€ä¸ªç§¯æå›å¤ä½ çš„å¥½å‹ï¼Œé‚£ä¹ˆè¿™æ¬¾æœºå™¨äººï¼Œä½ å€¼å¾—æ‹¥æœ‰ï¼ï¼ï¼</strong>ğŸ˜ğŸ˜ğŸ˜</p><p>æœ¬æ–‡å®ç°<a href="https://astrbot.soulter.top/what-is-astrbot.html">å®˜æ–¹æ–‡æ¡£https://astrbot.soulter.top/what-is-astrbot.html</a></p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>datax</title>
      <link href="/2025/08/10/datax/"/>
      <url>/2025/08/10/datax/</url>
      
        <content type="html"><![CDATA[<h1 id="DataXç®€ä»‹"><a href="#DataXç®€ä»‹" class="headerlink" title="DataXç®€ä»‹"></a>DataXç®€ä»‹</h1><h2 id="DataXæ¦‚è¿°"><a href="#DataXæ¦‚è¿°" class="headerlink" title="DataXæ¦‚è¿°"></a>DataXæ¦‚è¿°</h2><p>DataX æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ªå¼‚æ„æ•°æ®æºç¦»çº¿åŒæ­¥å·¥å…·ï¼Œè‡´åŠ›äºå®ç°åŒ…æ‹¬å…³ç³»å‹æ•°æ®åº“(MySQLã€Oracleç­‰)ã€HDFSã€Hiveã€ODPSã€HBaseã€FTPç­‰å„ç§å¼‚æ„æ•°æ®æºä¹‹é—´ç¨³å®šé«˜æ•ˆçš„æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚</p><p><a href="https://github.com/alibaba/DataX">dataxæºç åœ°å€</a>ï¼š<a href="https://github.com/alibaba/DataX">https://github.com/alibaba/DataX</a></p><h2 id="DataXæ”¯æŒçš„æ•°æ®æº"><a href="#DataXæ”¯æŒçš„æ•°æ®æº" class="headerlink" title="DataXæ”¯æŒçš„æ•°æ®æº"></a>DataXæ”¯æŒçš„æ•°æ®æº</h2><p>DataXç›®å‰å·²ç»æœ‰äº†æ¯”è¾ƒå…¨é¢çš„æ’ä»¶ä½“ç³»ï¼Œä¸»æµçš„RDBMSæ•°æ®åº“ã€NOSQLã€å¤§æ•°æ®è®¡ç®—ç³»ç»Ÿéƒ½å·²ç»æ¥å…¥ï¼Œç›®å‰æ”¯æŒæ•°æ®å¦‚ä¸‹å›¾ã€‚</p><table><thead><tr><th>ç±»å‹</th><th>æ•°æ®æº</th><th align="center">Reader(è¯»)</th><th align="center">Writer(å†™)</th><th align="center">æ–‡æ¡£</th></tr></thead><tbody><tr><td>RDBMS å…³ç³»å‹æ•°æ®åº“</td><td>MySQL</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/mysqlreader/doc/mysqlreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/mysqlwriter/doc/mysqlwriter.md">å†™</a></td></tr><tr><td></td><td>Oracle</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/oraclereader/doc/oraclereader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/oraclewriter/doc/oraclewriter.md">å†™</a></td></tr><tr><td></td><td>OceanBase</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/oceanbasev10reader/doc/oceanbasev10reader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/oceanbasev10writer/doc/oceanbasev10writer.md">å†™</a></td></tr><tr><td></td><td>SQLServer</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/sqlserverreader/doc/sqlserverreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/sqlserverwriter/doc/sqlserverwriter.md">å†™</a></td></tr><tr><td></td><td>PostgreSQL</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/postgresqlreader/doc/postgresqlreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/postgresqlwriter/doc/postgresqlwriter.md">å†™</a></td></tr><tr><td></td><td>DRDS</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/drdsreader/doc/drdsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/drdswriter/doc/drdswriter.md">å†™</a></td></tr><tr><td></td><td>Kingbase</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/drdsreader/doc/drdsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/drdswriter/doc/drdswriter.md">å†™</a></td></tr><tr><td></td><td>é€šç”¨RDBMS(æ”¯æŒæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“)</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/rdbmsreader/doc/rdbmsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/rdbmswriter/doc/rdbmswriter.md">å†™</a></td></tr><tr><td>é˜¿é‡Œäº‘æ•°ä»“æ•°æ®å­˜å‚¨</td><td>ODPS</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/odpsreader/doc/odpsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/odpswriter/doc/odpswriter.md">å†™</a></td></tr><tr><td></td><td>ADB</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/adbmysqlwriter/doc/adbmysqlwriter.md">å†™</a></td></tr><tr><td></td><td>ADS</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/adswriter/doc/adswriter.md">å†™</a></td></tr><tr><td></td><td>OSS</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/ossreader/doc/ossreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/osswriter/doc/osswriter.md">å†™</a></td></tr><tr><td></td><td>OCS</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/ocswriter/doc/ocswriter.md">å†™</a></td></tr><tr><td></td><td>Hologres</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hologresjdbcwriter/doc/hologresjdbcwriter.md">å†™</a></td></tr><tr><td></td><td>AnalyticDB For PostgreSQL</td><td align="center"></td><td align="center">âˆš</td><td align="center">å†™</td></tr><tr><td>é˜¿é‡Œäº‘ä¸­é—´ä»¶</td><td>datahub</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center">è¯» ã€å†™</td></tr><tr><td></td><td>SLS</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center">è¯» ã€å†™</td></tr><tr><td>å›¾æ•°æ®åº“</td><td>é˜¿é‡Œäº‘ GDB</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/gdbreader/doc/gdbreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/gdbwriter/doc/gdbwriter.md">å†™</a></td></tr><tr><td></td><td>Neo4j</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/neo4jwriter/doc/neo4jwriter.md">å†™</a></td></tr><tr><td>NoSQLæ•°æ®å­˜å‚¨</td><td>OTS</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/otsreader/doc/otsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/otswriter/doc/otswriter.md">å†™</a></td></tr><tr><td></td><td>Hbase0.94</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hbase094xreader/doc/hbase094xreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/hbase094xwriter/doc/hbase094xwriter.md">å†™</a></td></tr><tr><td></td><td>Hbase1.1</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hbase11xreader/doc/hbase11xreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/hbase11xwriter/doc/hbase11xwriter.md">å†™</a></td></tr><tr><td></td><td>Phoenix4.x</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hbase11xsqlreader/doc/hbase11xsqlreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/hbase11xsqlwriter/doc/hbase11xsqlwriter.md">å†™</a></td></tr><tr><td></td><td>Phoenix5.x</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hbase20xsqlreader/doc/hbase20xsqlreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/hbase20xsqlwriter/doc/hbase20xsqlwriter.md">å†™</a></td></tr><tr><td></td><td>MongoDB</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/mongodbreader/doc/mongodbreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/mongodbwriter/doc/mongodbwriter.md">å†™</a></td></tr><tr><td></td><td>Cassandra</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/cassandrareader/doc/cassandrareader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/cassandrawriter/doc/cassandrawriter.md">å†™</a></td></tr><tr><td>æ•°ä»“æ•°æ®å­˜å‚¨</td><td>StarRocks</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center">è¯» ã€<a href="https://github.com/alibaba/DataX/blob/master/starrockswriter/doc/starrockswriter.md">å†™</a></td></tr><tr><td></td><td>ApacheDoris</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/doriswriter/doc/doriswriter.md">å†™</a></td></tr><tr><td></td><td>ClickHouse</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/clickhousereader/doc/clickhousereader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/clickhousewriter/doc/clickhousewriter.md">å†™</a></td></tr><tr><td></td><td>Databend</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/databendwriter/doc/databendwriter.md">å†™</a></td></tr><tr><td></td><td>Hive</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hdfsreader/doc/hdfsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/hdfswriter/doc/hdfswriter.md">å†™</a></td></tr><tr><td></td><td>kudu</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hdfswriter/doc/hdfswriter.md">å†™</a></td></tr><tr><td></td><td>selectdb</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/selectdbwriter/doc/selectdbwriter.md">å†™</a></td></tr><tr><td>æ— ç»“æ„åŒ–æ•°æ®å­˜å‚¨</td><td>TxtFile</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/txtfilereader/doc/txtfilereader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/txtfilewriter/doc/txtfilewriter.md">å†™</a></td></tr><tr><td></td><td>FTP</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/ftpreader/doc/ftpreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/ftpwriter/doc/ftpwriter.md">å†™</a></td></tr><tr><td></td><td>HDFS</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/hdfsreader/doc/hdfsreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/hdfswriter/doc/hdfswriter.md">å†™</a></td></tr><tr><td></td><td>Elasticsearch</td><td align="center"></td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/elasticsearchwriter/doc/elasticsearchwriter.md">å†™</a></td></tr><tr><td>æ—¶é—´åºåˆ—æ•°æ®åº“</td><td>OpenTSDB</td><td align="center">âˆš</td><td align="center"></td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/opentsdbreader/doc/opentsdbreader.md">è¯»</a></td></tr><tr><td></td><td>TSDB</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/tsdbreader/doc/tsdbreader.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/tsdbwriter/doc/tsdbhttpwriter.md">å†™</a></td></tr><tr><td></td><td>TDengine</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center"><a href="https://github.com/alibaba/DataX/blob/master/tdenginereader/doc/tdenginereader-CN.md">è¯»</a>Â ã€<a href="https://github.com/alibaba/DataX/blob/master/tdenginewriter/doc/tdenginewriter-CN.md">å†™</a></td></tr></tbody></table><h1 id="DataXæ¶æ„åŸç†"><a href="#DataXæ¶æ„åŸç†" class="headerlink" title="DataXæ¶æ„åŸç†"></a>DataXæ¶æ„åŸç†</h1><h2 id="DataXè®¾è®¡ç†å¿µ"><a href="#DataXè®¾è®¡ç†å¿µ" class="headerlink" title="DataXè®¾è®¡ç†å¿µ"></a>DataXè®¾è®¡ç†å¿µ</h2><p>ä¸ºäº†è§£å†³å¼‚æ„æ•°æ®æºåŒæ­¥é—®é¢˜ï¼ŒDataXå°†å¤æ‚çš„ç½‘çŠ¶çš„åŒæ­¥é“¾è·¯å˜æˆäº†æ˜Ÿå‹æ•°æ®é“¾è·¯ï¼ŒDataXä½œä¸ºä¸­é—´ä¼ è¾“è½½ä½“è´Ÿè´£è¿æ¥å„ç§æ•°æ®æºã€‚å½“éœ€è¦æ¥å…¥ä¸€ä¸ªæ–°çš„æ•°æ®æºçš„æ—¶å€™ï¼Œåªéœ€è¦å°†æ­¤æ•°æ®æºå¯¹æ¥åˆ°DataXï¼Œä¾¿èƒ½è·Ÿå·²æœ‰çš„æ•°æ®æºåšåˆ°æ— ç¼æ•°æ®åŒæ­¥ã€‚<br><img src="/2025/08/10/datax/file-20250810132826276.png"></p><h2 id="DataX3-0æ¡†æ¶è®¾è®¡"><a href="#DataX3-0æ¡†æ¶è®¾è®¡" class="headerlink" title="DataX3.0æ¡†æ¶è®¾è®¡"></a>DataX3.0æ¡†æ¶è®¾è®¡</h2><p><img src="/2025/08/10/datax/file-20250810132945028.png"><br>DataXæœ¬èº«ä½œä¸º<strong>ç¦»çº¿æ•°æ®åŒæ­¥æ¡†æ¶</strong>ï¼Œé‡‡ç”¨<strong>Framework + plugin</strong>æ¶æ„æ„å»ºã€‚å°†æ•°æ®æºè¯»å–å’Œå†™å…¥æŠ½è±¡æˆä¸ºReader&#x2F;Writeræ’ä»¶ï¼Œçº³å…¥åˆ°æ•´ä¸ªåŒæ­¥æ¡†æ¶ä¸­ã€‚</p><ul><li><strong>Reade</strong>rï¼šReaderï¿½ä¸ºæ•°æ®é‡‡é›†æ¨¡å—ï¼Œè´Ÿè´£é‡‡é›†æ•°æ®æºçš„æ•°æ®ï¼Œå°†æ•°æ®å‘é€ç»™Frameworkã€‚</li><li><strong>Writer</strong>ï¼š Writerä¸ºæ•°æ®å†™å…¥æ¨¡å—ï¼Œè´Ÿè´£ä¸æ–­å‘Frameworkå–æ•°æ®ï¼Œå¹¶å°†æ•°æ®å†™å…¥åˆ°ç›®çš„ç«¯ã€‚</li><li><strong>Framework</strong>ï¼šFrameworkç”¨äºè¿æ¥readerå’Œwriterï¼Œä½œä¸ºä¸¤è€…çš„æ•°æ®ä¼ è¾“é€šé“ï¼Œå¹¶å¤„ç†ç¼“å†²ï¼Œæµæ§ï¼Œå¹¶å‘ï¼Œæ•°æ®è½¬æ¢ç­‰æ ¸å¿ƒæŠ€æœ¯é—®é¢˜ã€‚</li></ul><h2 id="DataX3-0æ ¸å¿ƒæ¶æ„"><a href="#DataX3-0æ ¸å¿ƒæ¶æ„" class="headerlink" title="DataX3.0æ ¸å¿ƒæ¶æ„"></a>DataX3.0æ ¸å¿ƒæ¶æ„</h2><p>DataX 3.0 å¼€æºç‰ˆæœ¬æ”¯æŒå•æœºå¤šçº¿ç¨‹æ¨¡å¼å®ŒæˆåŒæ­¥ä½œä¸šè¿è¡Œï¼Œæœ¬å°èŠ‚æŒ‰ä¸€ä¸ªDataXä½œä¸šç”Ÿå‘½å‘¨æœŸçš„æ—¶åºå›¾ï¼Œä»æ•´ä½“æ¶æ„è®¾è®¡éå¸¸ç®€è¦è¯´æ˜DataXå„ä¸ªæ¨¡å—ç›¸äº’å…³ç³»ã€‚<br><img src="/2025/08/10/datax/file-20250810133238491.png"></p><h3 id="æ ¸å¿ƒæ¨¡å—ä»‹ç»ï¼š"><a href="#æ ¸å¿ƒæ¨¡å—ä»‹ç»ï¼š" class="headerlink" title="æ ¸å¿ƒæ¨¡å—ä»‹ç»ï¼š"></a>æ ¸å¿ƒæ¨¡å—ä»‹ç»ï¼š</h3><ol><li><strong>job</strong>:å•ä¸ªæ•°æ®åŒæ­¥çš„ä½œä¸šï¼Œç§°ä¹‹ä¸ºä¸€ä¸ªJobï¼Œä¸€ä¸ªjobå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ã€‚</li><li>Task:æ ¹æ®ä¸åŒæ•°æ®æºçš„åˆ‡åˆ†ç­–ç•¥ï¼Œä¸€ä¸ªJobä¼šåˆ‡åˆ†ä¸ºå¤šä¸ªTask,Taskæ˜¯DataXä½œä¸šçš„æœ€å°å•å…ƒï¼Œæ¯ä¸ªTaskè´Ÿè´£ä¸€éƒ¨åˆ†æ•°æ®çš„åŒæ­¥å·¥ä½œã€‚ </li><li>TaskGroup:Schedulerè°ƒåº¦æ¨¡å—ä¼šå¯¹Taskè¿›è¡Œåˆ†ç»„ï¼Œæ¯ä¸ªTaskç»„ç§°ä¸ºä¸€ä¸ªTask Group,æ¯ä¸ªTask Group2è´Ÿè´£ä»¥ä¸€å®šçš„å¹¶å‘åº¦è¿è¡Œå…¶æ‰€åˆ†å¾—çš„Task,å•ä¸ªTask Groupçš„å¹¶å‘åº¦ä¸º5ã€‚ </li><li>Reader-â†’Channel-â†’Writer:æ¯ä¸ªTaskå¯åŠ¨åï¼Œéƒ½ä¼šå›ºå®šå¯åŠ¨Reader-â†’Channel-â†’Writerçš„çº¿ç¨‹æ¥å®ŒæˆåŒæ­¥å·¥ä½œã€‚</li><li>DataXä½œä¸šè¿è¡Œèµ·æ¥ä¹‹åï¼Œ Jobç›‘æ§å¹¶ç­‰å¾…å¤šä¸ªTaskGroupæ¨¡å—ä»»åŠ¡å®Œæˆï¼Œç­‰å¾…æ‰€æœ‰TaskGroupä»»åŠ¡å®ŒæˆåJobæˆåŠŸé€€å‡ºã€‚å¦åˆ™ï¼Œå¼‚å¸¸é€€å‡ºï¼Œè¿›ç¨‹é€€å‡ºå€¼é0</li></ol><h3 id="DataXè°ƒåº¦æµç¨‹ï¼š"><a href="#DataXè°ƒåº¦æµç¨‹ï¼š" class="headerlink" title="DataXè°ƒåº¦æµç¨‹ï¼š"></a>DataXè°ƒåº¦æµç¨‹ï¼š</h3><p>ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æˆ·æäº¤äº†ä¸€ä¸ªDataXä½œä¸šï¼Œå¹¶ä¸”é…ç½®äº†20ä¸ªå¹¶å‘ï¼Œç›®çš„æ˜¯å°†ä¸€ä¸ª100å¼ åˆ†è¡¨çš„mysqlæ•°æ®åŒæ­¥åˆ°odpsé‡Œé¢ã€‚ DataXçš„è°ƒåº¦å†³ç­–æ€è·¯æ˜¯ï¼š</p><ol><li>DataXJobæ ¹æ®åˆ†åº“åˆ†è¡¨åˆ‡åˆ†æˆäº†100ä¸ªTaskã€‚</li><li>æ ¹æ®20ä¸ªå¹¶å‘ï¼ŒDataXè®¡ç®—å…±éœ€è¦åˆ†é…4ä¸ªTaskGroupã€‚</li><li>4ä¸ªTaskGroupå¹³åˆ†åˆ‡åˆ†å¥½çš„100ä¸ªTaskï¼Œæ¯ä¸€ä¸ªTaskGroupè´Ÿè´£ä»¥5ä¸ªå¹¶å‘å…±è®¡è¿è¡Œ25ä¸ªTaskã€‚</li></ol><h3 id="DataXå’ŒSqoopå¯¹æ¯”"><a href="#DataXå’ŒSqoopå¯¹æ¯”" class="headerlink" title="DataXå’ŒSqoopå¯¹æ¯”"></a>DataXå’ŒSqoopå¯¹æ¯”</h3><table><thead><tr><th align="center">åŠŸèƒ½</th><th align="center">Datax</th><th align="center">Sqoop</th></tr></thead><tbody><tr><td align="center">è¿è¡Œæ¨¡å¼</td><td align="center">å•è¿›ç¨‹å¤šçº¿ç¨‹</td><td align="center">MR</td></tr><tr><td align="center">åˆ†å¸ƒå¼</td><td align="center">ä¸æ”¯æŒï¼Œå¯ä»¥é€šè¿‡è°ƒåº¦ç³»ç»Ÿè§„é¿</td><td align="center">æ”¯æŒ</td></tr><tr><td align="center">æµæ§</td><td align="center">æœ‰æµæ§åŠŸèƒ½</td><td align="center">éœ€è¦å®šåˆ¶</td></tr><tr><td align="center">ç»Ÿè®¡ä¿¡æ¯</td><td align="center">å·±æœ‰ä¸€äº›ç»Ÿè®¡ï¼Œä¸ŠæŠ¥éœ€å®šåˆ¶</td><td align="center">æ²¡æœ‰ï¼Œåˆ†å¸ƒå¼çš„æ•°æ®æ”¶é›†ä¸æ–¹ä¾¿</td></tr><tr><td align="center">æ•°æ®æ ¡éªŒ</td><td align="center">åœ¨coreéƒ¨åˆ†æœ‰æ ¡éªŒåŠŸèƒ½</td><td align="center">æ²¡æœ‰ï¼Œåˆ†å¸ƒå¼çš„æ•°æ®æ”¶é›†ä¸æ–¹ä¾¿</td></tr><tr><td align="center">ç›‘æ§</td><td align="center">éœ€è¦å®šåˆ¶</td><td align="center">éœ€è¦å®šåˆ¶</td></tr></tbody></table><h1 id="DataXéƒ¨ç½²"><a href="#DataXéƒ¨ç½²" class="headerlink" title="DataXéƒ¨ç½²"></a>DataXéƒ¨ç½²</h1><ol><li><p>ä¸‹è½½DataXå®‰è£…åŒ…å¹¶ä¸Šä¼ åˆ°hadoop102çš„&#x2F;opt&#x2F;software<br>ä¸‹è½½åœ°å€ï¼š<a href="http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz">http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz</a></p></li><li><p>è§£å‹datax.tar.gzåˆ°&#x2F;opt&#x2F;module</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf datax.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure></li><li><p>è‡ªæ£€ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python /opt/module/datax/bin/datax.py /opt/module/datax/job/job.json</span><br></pre></td></tr></table></figure></li><li><p>å‡ºç°å¦‚ä¸‹å†…å®¹ï¼Œåˆ™è¡¨æ˜å®‰è£…æˆåŠŸ<br><img src="/2025/08/10/datax/file-20250810135520118.png"></p></li></ol><h1 id="DataXä½¿ç”¨"><a href="#DataXä½¿ç”¨" class="headerlink" title="DataXä½¿ç”¨"></a>DataXä½¿ç”¨</h1><p><a href="https://github.com/alibaba/DataX/blob/master/userGuid.md">å®˜æ–¹æ–‡æ¡£</a><a href="https://github.com/alibaba/DataX/blob/master/userGuid.md">https://github.com/alibaba/DataX/blob/master/userGuid.md</a></p><h2 id="DataXä½¿ç”¨æ¦‚è¿°"><a href="#DataXä½¿ç”¨æ¦‚è¿°" class="headerlink" title="DataXä½¿ç”¨æ¦‚è¿°"></a>DataXä½¿ç”¨æ¦‚è¿°</h2><h3 id="DataXä»»åŠ¡æäº¤å‘½ä»¤"><a href="#DataXä»»åŠ¡æäº¤å‘½ä»¤" class="headerlink" title="DataXä»»åŠ¡æäº¤å‘½ä»¤"></a>DataXä»»åŠ¡æäº¤å‘½ä»¤</h3><p>Dataxçš„ä½¿ç”¨ååˆ†ç®€å•ï¼Œç”¨æˆ·åªéœ€è¦æ ¹æ®è‡ªå·±<strong>åŒæ­¥æ•°æ®çš„æ•°æ®æºå’Œç›®çš„åœ°é€‰æ‹©ç›¸åº”çš„Readerå’ŒWriterï¼Œå¹¶å°†Readerå’ŒWriterçš„ä¿¡æ¯é…ç½®åœ¨ä¸€ä¸ªjsonæ–‡ä»¶ä¸­ï¼Œç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æäº¤æ•°æ®åŒæ­¥ä»»åŠ¡å³å¯ã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py path/to/your/job.json</span><br></pre></td></tr></table></figure><h3 id="DataXé…ç½®æ–‡ä»¶æ ¼å¼"><a href="#DataXé…ç½®æ–‡ä»¶æ ¼å¼" class="headerlink" title="DataXé…ç½®æ–‡ä»¶æ ¼å¼"></a><a href="Hadoop.md#%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">DataXé…ç½®æ–‡ä»¶æ ¼å¼</a></h3><p>å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½åæŸ¥çœ‹DataXé…ç½®æ–‡ä»¶æ¨¡æ¿ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py -r mysqlreader -w hdfswriter</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶æ¨¡æ¿å¦‚ä¸‹ï¼Œjsonæœ€å¤–å±‚æ˜¯ä¸€ä¸ªjobï¼ŒjobåŒ…å«settingå’Œcontentä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­</p><ol><li>settingç”¨äºå¯¹æ•´ä¸ªjobè¿›è¡Œé…ç½®ï¼Œ</li><li>contentç”¨æˆ·é…ç½®æ•°æ®æºå’Œç›®çš„åœ°ã€‚</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Please save the following configuration as a json file and  use</span><br><span class="line">     python <span class="punctuation">&#123;</span>DATAX_HOME<span class="punctuation">&#125;</span>/bin/datax.py <span class="punctuation">&#123;</span>JSON_FILE_NAME<span class="punctuation">&#125;</span>.json </span><br><span class="line">to run the job.</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">//æ•°æ®æºå’Œç›®çš„åœ°ç›¸å…³é…ç½®</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>    </span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="comment">//Readerç›¸å…³é…ç½®</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="comment">//readeråç§°ï¼Œä¸å¯éšæ„å‘½å</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">            <span class="comment">//Readeré…ç½®å‚æ•°</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">                        <span class="attr">&quot;sliceRecordCount&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span> </span><br><span class="line">                <span class="comment">//writerç›¸å…³é…ç½®</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="comment">//writeråç§°ï¼Œä¸å¯éšæ„å‘½å</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;streamwriter&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                    <span class="comment">//writeré…ç½®å‚æ•°</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                        <span class="attr">&quot;print&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="comment">//Jobé…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬é™é€Ÿé…ç½®ç­‰</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="åŒæ­¥MySQLæ•°æ®åˆ°HDFSæ¡ˆä¾‹"><a href="#åŒæ­¥MySQLæ•°æ®åˆ°HDFSæ¡ˆä¾‹" class="headerlink" title="åŒæ­¥MySQLæ•°æ®åˆ°HDFSæ¡ˆä¾‹"></a>åŒæ­¥MySQLæ•°æ®åˆ°HDFSæ¡ˆä¾‹</h2><p>æ¡ˆä¾‹è¦æ±‚ï¼šåŒæ­¥gmallæ•°æ®åº“ä¸­base_provinceè¡¨æ•°æ®åˆ°HDFSçš„&#x2F;base_provinceç›®å½•<br>éœ€æ±‚åˆ†æï¼šè¦å®ç°è¯¥åŠŸèƒ½ï¼Œéœ€é€‰ç”¨MySQLReaderå’ŒHDFSWriterï¼ŒMySQLReaderå…·æœ‰ä¸¤ç§æ¨¡å¼åˆ†åˆ«æ˜¯TableModeå’ŒQuerySQLModeï¼Œå‰è€…ä½¿ç”¨tableï¼Œcolumnï¼Œwhereç­‰å±æ€§å£°æ˜éœ€è¦åŒæ­¥çš„æ•°æ®ï¼›åè€…ä½¿ç”¨ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥å£°æ˜éœ€è¦åŒæ­¥çš„æ•°æ®ã€‚<br>ä¸‹é¢åˆ†åˆ«ä½¿ç”¨ä¸¤ç§æ¨¡å¼è¿›è¡Œæ¼”ç¤ºã€‚</p><h3 id="MySQLReaderä¹‹TableMode"><a href="#MySQLReaderä¹‹TableMode" class="headerlink" title="MySQLReaderä¹‹TableMode"></a>MySQLReaderä¹‹TableMode</h3><ol><li><p>ç¼–å†™é…ç½®æ–‡ä»¶<br>(1)  åˆ›å»ºé…ç½®æ–‡ä»¶base_province.json</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/module/datax/job/base_province.json</span><br></pre></td></tr></table></figure><p>(2) é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;region_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;area_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;iso_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;iso_3166_2&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;where&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&gt;=3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://hadoop102:3306/gmall&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;base_province&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;splitPk&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bigint&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;region_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;area_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso_3166_2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gzip&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop102:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;base_province&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/base_province&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;append&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>é…ç½®æ–‡ä»¶è¯´æ˜</p></li></ol><p>(1) Readerå‚æ•°è¯´æ˜<br><img src="/2025/08/10/datax/file-20250810143036239.png"><br>(2) Writerå‚æ•°è¯´æ˜<br><img src="/2025/08/10/datax/file-20250810143122382.png"></p><blockquote><p>[!tip]<br>æ³¨æ„äº‹é¡¹ï¼š<br>HFDS Writerå¹¶æœªæä¾›nullFormatå‚æ•°ï¼šä¹Ÿå°±æ˜¯ç”¨æˆ·å¹¶ä¸èƒ½è‡ªå®šä¹‰nullå€¼å†™åˆ°HFDSæ–‡ä»¶ä¸­çš„å­˜å‚¨æ ¼å¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒHFDS Writerä¼šå°†nullå€¼å­˜å‚¨ä¸ºç©ºå­—ç¬¦ä¸²ï¼ˆâ€˜â€™ï¼‰ï¼Œè€ŒHiveé»˜è®¤çš„nullå€¼å­˜å‚¨æ ¼å¼ä¸º\Nã€‚æ‰€ä»¥åæœŸå°†DataXåŒæ­¥çš„æ–‡ä»¶å¯¼å…¥Hiveè¡¨å°±ä¼šå‡ºç°é—®é¢˜ã€‚</p></blockquote><p>ï¼ˆ3ï¼‰Settingå‚æ•°è¯´æ˜<br><img src="/2025/08/10/datax/file-20250810143305418.png"></p><ol start="3"><li><p>æäº¤ä»»åŠ¡<br>ï¼ˆ1ï¼‰åœ¨HDFSåˆ›å»º&#x2F;base_provinceç›®å½•<br>ä½¿ç”¨DataXå‘HDFSåŒæ­¥æ•°æ®æ—¶ï¼Œéœ€ç¡®ä¿ç›®æ ‡è·¯å¾„å·²å­˜åœ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">mkdir</span> /base_province</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è¿›å…¥DataXæ ¹ç›®å½•<br>ï¼ˆ3ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py job/base_province.json </span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ç»“æœ<br>ï¼ˆ1ï¼‰DataXæ‰“å°æ—¥å¿—<br><img src="/2025/08/10/datax/file-20250810143616787.png" alt="500"><br>ï¼ˆ2ï¼‰æŸ¥çœ‹HDFSæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">cat</span> /base_province/* | zcat</span><br></pre></td></tr></table></figure></li></ol><h3 id="MySQLReaderä¹‹QuerySQLMode"><a href="#MySQLReaderä¹‹QuerySQLMode" class="headerlink" title="MySQLReaderä¹‹QuerySQLMode"></a>MySQLReaderä¹‹QuerySQLMode</h3><ol><li><p>ç¼–å†™é…ç½®æ–‡ä»¶<br>ï¼ˆ1ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶base_province.json<br>ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹<br>Â <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">Â <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://hadoop102:3306/gmall&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;querySql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;select id,name,region_id,area_code,iso_code,iso_3166_2 from base_province where id&gt;=3&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bigint&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;region_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;area_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso_3166_2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gzip&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop102:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;base_province&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/base_province&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;append&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p></li><li><p>é…ç½®æ–‡ä»¶è¯´æ˜<br>ï¼ˆ1ï¼‰Readerå‚æ•°è¯´æ˜<br><img src="/2025/08/10/datax/file-20250810143928488.png"></p></li><li><p>æäº¤ä»»åŠ¡<br>ï¼ˆ1ï¼‰åˆ›å»ºç›®æ ‡è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">rm</span> -r -f /base_province/*</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è¿›å…¥DataXæ ¹ç›®å½•<br>ï¼ˆ3ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py job/base_province.json</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ç»“æœ<br>ï¼ˆ1ï¼‰DataXæ‰“å°æ—¥å¿—<br><img src="/2025/08/10/datax/file-20250810144708686.png" alt="500"><br>ï¼ˆ2ï¼‰æŸ¥çœ‹HDFSæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">cat</span> /base_province/* | zcat</span><br></pre></td></tr></table></figure></li></ol><h3 id="DataXä¼ å‚"><a href="#DataXä¼ å‚" class="headerlink" title="DataXä¼ å‚"></a>DataXä¼ å‚</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç¦»çº¿æ•°æ®åŒæ­¥ä»»åŠ¡éœ€è¦æ¯æ—¥å®šæ—¶é‡å¤æ‰§è¡Œï¼Œæ•…HDFSä¸Šçš„ç›®æ ‡è·¯å¾„é€šå¸¸ä¼šåŒ…å«ä¸€å±‚æ—¥æœŸï¼Œä»¥å¯¹æ¯æ—¥åŒæ­¥çš„æ•°æ®åŠ ä»¥åŒºåˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ—¥åŒæ­¥æ•°æ®çš„ç›®æ ‡è·¯å¾„ä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œå› æ­¤DataXé…ç½®æ–‡ä»¶ä¸­HDFS Writerçš„pathå‚æ•°çš„å€¼åº”è¯¥æ˜¯åŠ¨æ€çš„ã€‚ä¸ºå®ç°è¿™ä¸€æ•ˆæœï¼Œå°±éœ€è¦ä½¿ç”¨DataXä¼ å‚çš„åŠŸèƒ½ã€‚<br>DataXä¼ å‚çš„ç”¨æ³•å¦‚ä¸‹ï¼Œåœ¨JSONé…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨${param}å¼•ç”¨å‚æ•°ï¼Œåœ¨æäº¤ä»»åŠ¡æ—¶ä½¿ç”¨-pâ€-Dparam&#x3D;valueâ€ä¼ å…¥å‚æ•°å€¼ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ã€‚</p><ol><li><p>ç¼–å†™é…ç½®æ–‡ä»¶<br>ï¼ˆ1ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶base_province.json<br>ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://hadoop102:3306/gmall&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;querySql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;select id,name,region_id,area_code,iso_code,iso_3166_2 from base_province where id&gt;=3&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bigint&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;region_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;area_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso_3166_2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gzip&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop102:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;base_province&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/base_province/$&#123;dt&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;append&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æäº¤ä»»åŠ¡<br>ï¼ˆ1ï¼‰åˆ›å»ºç›®æ ‡è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">mkdir</span> /base_province/2020-06-14</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è¿›å…¥DataXæ ¹ç›®å½•<br>ï¼ˆ3ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py -p<span class="string">&quot;-Ddt=2020-06-14&quot;</span> job/base_province.json</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ç»“æœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">ls</span> /base_province</span><br></pre></td></tr></table></figure></li></ol><h3 id="åŒæ­¥HDFSæ•°æ®åˆ°MySQLæ¡ˆä¾‹"><a href="#åŒæ­¥HDFSæ•°æ®åˆ°MySQLæ¡ˆä¾‹" class="headerlink" title="åŒæ­¥HDFSæ•°æ®åˆ°MySQLæ¡ˆä¾‹"></a>åŒæ­¥HDFSæ•°æ®åˆ°MySQLæ¡ˆä¾‹</h3><p>æ¡ˆä¾‹è¦æ±‚ï¼šåŒæ­¥HDFSä¸Šçš„&#x2F;base_provinceç›®å½•ä¸‹çš„æ•°æ®åˆ°MySQL gmall æ•°æ®åº“ä¸‹çš„test_provinceè¡¨ã€‚<br>éœ€æ±‚åˆ†æï¼šè¦å®ç°è¯¥åŠŸèƒ½ï¼Œéœ€é€‰ç”¨HDFSReaderå’ŒMySQLWriterã€‚</p><ol><li><p>ç¼–å†™é…ç½®æ–‡ä»¶<br>ï¼ˆ1ï¼‰åˆ›å»ºé…ç½®æ–‡ä»¶test_province.json<br>ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfsreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop102:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/base_province&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;*&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gzip&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UTF-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;nullFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\\N&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlwriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;test_province&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jdbc:mysql://hadoop102:3306/gmall?useUnicode=true&amp;characterEncoding=utf-8&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;region_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;area_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;iso_code&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;iso_3166_2&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;replace&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>é…ç½®æ–‡ä»¶è¯´æ˜<br>ï¼ˆ1ï¼‰Readerå‚æ•°è¯´æ˜<br><img src="/2025/08/10/datax/file-20250810145252922.png"></p></li></ol><p>ï¼ˆ2ï¼‰Writerå‚æ•°è¯´æ˜<br><img src="/2025/08/10/datax/file-20250810145321194.png"></p><ol start="3"><li>æäº¤ä»»åŠ¡<br>ï¼ˆ1ï¼‰åœ¨MySQLä¸­åˆ›å»ºgmall.test_provinceè¡¨<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `test_province`;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `test_province`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `region_id` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `area_code` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `iso_code` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `iso_3166_2` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br></pre></td></tr></table></figure>ï¼ˆ2ï¼‰è¿›å…¥DataXæ ¹ç›®å½•<br>ï¼ˆ3ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bin/datax.py job/test_province.json </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ç»“æœ<br>ï¼ˆ1ï¼‰DataXæ‰“å°æ—¥å¿—<br>ï¼ˆ2ï¼‰æŸ¥çœ‹MySQLç›®æ ‡è¡¨æ•°æ®<br><img src="/2025/08/10/datax/file-20250810145539123.png"></li></ol><h1 id="DataXä¼˜åŒ–"><a href="#DataXä¼˜åŒ–" class="headerlink" title="DataXä¼˜åŒ–"></a>DataXä¼˜åŒ–</h1><h2 id="é€Ÿåº¦æ§åˆ¶"><a href="#é€Ÿåº¦æ§åˆ¶" class="headerlink" title="é€Ÿåº¦æ§åˆ¶"></a>é€Ÿåº¦æ§åˆ¶</h2><p>DataX3.0æä¾›äº†åŒ…æ‹¬é€šé“(å¹¶å‘)ã€è®°å½•æµã€å­—èŠ‚æµä¸‰ç§æµæ§æ¨¡å¼ï¼Œå¯ä»¥éšæ„æ§åˆ¶ä½ çš„ä½œä¸šé€Ÿåº¦ï¼Œè®©ä½ çš„ä½œä¸šåœ¨æ•°æ®åº“å¯ä»¥æ‰¿å—çš„èŒƒå›´å†…è¾¾åˆ°æœ€ä½³çš„åŒæ­¥é€Ÿåº¦ã€‚<br><img src="/2025/08/10/datax/file-20250810145635862.png"><br>æ³¨æ„äº‹é¡¹ï¼š<br>1.è‹¥é…ç½®äº†æ€»recordé™é€Ÿï¼Œåˆ™å¿…é¡»é…ç½®å•ä¸ªchannelçš„recordé™é€Ÿ<br>2.è‹¥é…ç½®äº†æ€»byteé™é€Ÿï¼Œåˆ™å¿…é¡»é…ç½®å•ä¸ªchanneçš„byteé™é€Ÿ<br>3.è‹¥é…ç½®äº†æ€»recordé™é€Ÿå’Œæ€»byteé™é€Ÿï¼Œchannelå¹¶å‘æ•°å‚æ•°å°±ä¼šå¤±æ•ˆã€‚å› ä¸ºé…ç½®äº†æ€»recordé™é€Ÿå’Œæ€»byteé™é€Ÿä¹‹åï¼Œå®é™…channelå¹¶å‘æ•°æ˜¯é€šè¿‡è®¡ç®—å¾—åˆ°çš„ï¼š<br>è®¡ç®—å…¬å¼ä¸º:<br>min(æ€»byteé™é€Ÿ&#x2F;å•ä¸ªchannelçš„byteé™é€Ÿï¼Œæ€»recordé™é€Ÿ&#x2F;å•ä¸ªchannelçš„recordé™é€Ÿ)</p><h2 id="å†…å­˜è°ƒæ•´"><a href="#å†…å­˜è°ƒæ•´" class="headerlink" title="å†…å­˜è°ƒæ•´"></a>å†…å­˜è°ƒæ•´</h2><p>å½“æå‡DataX Jobå†…Channelå¹¶å‘æ•°æ—¶ï¼Œå†…å­˜çš„å ç”¨ä¼šæ˜¾è‘—å¢åŠ ï¼Œå› ä¸ºDataXä½œä¸ºæ•°æ®äº¤æ¢é€šé“ï¼Œåœ¨å†…å­˜ä¸­ä¼šç¼“å­˜è¾ƒå¤šçš„æ•°æ®ã€‚ä¾‹å¦‚Channelä¸­ä¼šæœ‰ä¸€ä¸ªBufferï¼Œä½œä¸ºä¸´æ—¶çš„æ•°æ®äº¤æ¢çš„ç¼“å†²åŒºï¼Œè€Œåœ¨éƒ¨åˆ†Readerå’ŒWriterçš„ä¸­ï¼Œä¹Ÿä¼šå­˜åœ¨ä¸€äº›Bufferï¼Œä¸ºäº†é˜²æ­¢OOMç­‰é”™è¯¯ï¼Œéœ€è°ƒå¤§JVMçš„å †å†…å­˜ã€‚<br>å»ºè®®å°†å†…å­˜è®¾ç½®ä¸º4Gæˆ–è€…8Gï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¥è°ƒæ•´ã€‚<br>è°ƒæ•´JVM xms xmxå‚æ•°çš„ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯ç›´æ¥æ›´æ”¹datax.pyè„šæœ¬ï¼›å¦ä¸€ç§æ˜¯åœ¨å¯åŠ¨çš„æ—¶å€™ï¼ŒåŠ ä¸Šå¯¹åº”çš„å‚æ•°ï¼Œå¦‚ä¸‹ï¼š<br>python datax&#x2F;bin&#x2F;datax.py â€“jvm&#x3D;â€œ-Xms8G -Xmx8Gâ€ &#x2F;path&#x2F;to&#x2F;your&#x2F;job.json</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
            <tag> MySQL </tag>
            
            <tag> datax </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker-compose</title>
      <link href="/2025/08/07/docker-compose/"/>
      <url>/2025/08/07/docker-compose/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.docker.com/compose/">å®˜æ–¹æ–‡æ¡£</a><br>æœ¬æ–‡å‚è€ƒ<a href="https://blog.csdn.net/pushiqiang/article/details/78682323?spm=1001.2014.3001.5506">ã€Šdocker-composeæ•™ç¨‹ï¼ˆå®‰è£…ï¼Œä½¿ç”¨, å¿«é€Ÿå…¥é—¨ï¼‰ã€‹</a></p><h1 id="Composeä»‹ç»"><a href="#Composeä»‹ç»" class="headerlink" title="Composeä»‹ç»"></a>Composeä»‹ç»</h1><p>Docker Composeæ˜¯ä¸€ä¸ªç”¨æ¥å®šä¹‰å’Œè¿è¡Œå¤æ‚åº”ç”¨çš„<a href="docker%E5%85%A5%E9%97%A8.md">Docker</a>å·¥å…·ã€‚ä¸€ä¸ªä½¿ç”¨Dockerå®¹å™¨çš„åº”ç”¨ï¼Œé€šå¸¸ç”±å¤šä¸ªå®¹å™¨ç»„æˆã€‚ä½¿ç”¨Docker Composeä¸å†éœ€è¦ä½¿ç”¨shellè„šæœ¬æ¥å¯åŠ¨å®¹å™¨ã€‚<br>Compose é€šè¿‡<strong>ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥ç®¡ç†å¤šä¸ªDockerå®¹å™¨</strong>ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰çš„å®¹å™¨é€šè¿‡servicesæ¥å®šä¹‰ï¼Œç„¶åä½¿ç”¨<code>docker-compose</code>è„šæœ¬æ¥å¯åŠ¨ï¼Œåœæ­¢å’Œé‡å¯åº”ç”¨ï¼Œå’Œåº”ç”¨ä¸­çš„æœåŠ¡ä»¥åŠæ‰€æœ‰ä¾èµ–æœåŠ¡çš„å®¹å™¨ï¼Œéå¸¸é€‚åˆç»„åˆä½¿ç”¨å¤šä¸ªå®¹å™¨è¿›è¡Œå¼€å‘çš„åœºæ™¯ã€‚</p><h2 id="æŸ¥çœ‹æ˜¯å¦å®‰è£…"><a href="#æŸ¥çœ‹æ˜¯å¦å®‰è£…" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦å®‰è£…"></a>æŸ¥çœ‹æ˜¯å¦å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker compose version</span><br><span class="line">docker compose</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker-compose/file-20250807152015156.png"></p><h1 id="docker-composeæ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹"><a href="#docker-composeæ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹" class="headerlink" title="docker-composeæ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹"></a>docker-composeæ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹</h1><h2 id="docker-composeæ–‡ä»¶ç»“æ„"><a href="#docker-composeæ–‡ä»¶ç»“æ„" class="headerlink" title="docker-composeæ–‡ä»¶ç»“æ„"></a>docker-composeæ–‡ä»¶ç»“æ„</h2><p>docker-compose.yaml:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:alpine</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">frontend</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">update_config:</span></span><br><span class="line">        <span class="attr">parallelism:</span> <span class="number">2</span></span><br><span class="line">        <span class="attr">delay:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">restart_policy:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">on-failure</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:9.4</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db-data:/var/lib/postgresql/data</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">placement:</span></span><br><span class="line">        <span class="attr">constraints:</span> [<span class="string">node.role</span> <span class="string">==</span> <span class="string">manager</span>]</span><br><span class="line"> </span><br><span class="line">  <span class="attr">vote:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dockersamples/examplevotingapp_vote:before</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5000</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">frontend</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">update_config:</span></span><br><span class="line">        <span class="attr">parallelism:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">restart_policy:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">on-failure</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">result:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dockersamples/examplevotingapp_result:before</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5001</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">update_config:</span></span><br><span class="line">        <span class="attr">parallelism:</span> <span class="number">2</span></span><br><span class="line">        <span class="attr">delay:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">restart_policy:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">on-failure</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">worker:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dockersamples/examplevotingapp_worker</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">frontend</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">mode:</span> <span class="string">replicated</span></span><br><span class="line">      <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">labels:</span> [<span class="string">APP=VOTING</span>]</span><br><span class="line">      <span class="attr">restart_policy:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">on-failure</span></span><br><span class="line">        <span class="attr">delay:</span> <span class="string">10s</span></span><br><span class="line">        <span class="attr">max_attempts:</span> <span class="number">3</span></span><br><span class="line">        <span class="attr">window:</span> <span class="string">120s</span></span><br><span class="line">      <span class="attr">placement:</span></span><br><span class="line">        <span class="attr">constraints:</span> [<span class="string">node.role</span> <span class="string">==</span> <span class="string">manager</span>]</span><br><span class="line"> </span><br><span class="line">  <span class="attr">visualizer:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dockersamples/visualizer:stable</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">stop_grace_period:</span> <span class="string">1m30s</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;/var/run/docker.sock:/var/run/docker.sock&quot;</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">placement:</span></span><br><span class="line">        <span class="attr">constraints:</span> [<span class="string">node.role</span> <span class="string">==</span> <span class="string">manager</span>]</span><br><span class="line"> </span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">frontend:</span></span><br><span class="line">  <span class="attr">backend:</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">db-data:</span></span><br></pre></td></tr></table></figure><h2 id="docker-composeä½¿ç”¨ç¤ºä¾‹"><a href="#docker-composeä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="docker-composeä½¿ç”¨ç¤ºä¾‹"></a>docker-composeä½¿ç”¨ç¤ºä¾‹</h2><p>é€šè¿‡docker-composeæ„å»ºä¸€ä¸ªåœ¨dockerä¸­è¿è¡Œçš„åŸºäºpython flaskæ¡†æ¶çš„webåº”ç”¨</p><blockquote><p>[! tip]<br><strong>æ³¨æ„ï¼š</strong>ç¡®ä¿ä½ å·²ç»å®‰è£…äº†Docker Engineå’ŒDocker Composeã€‚ æ‚¨ä¸éœ€è¦å®‰è£…Pythonæˆ–Redisï¼Œå› ä¸ºè¿™ä¸¤ä¸ªéƒ½æ˜¯ç”±Dockeré•œåƒæä¾›çš„ã€‚</p></blockquote><h3 id="Step-1-å®šä¹‰pythonåº”ç”¨"><a href="#Step-1-å®šä¹‰pythonåº”ç”¨" class="headerlink" title="Step 1: å®šä¹‰pythonåº”ç”¨"></a><strong>Step 1: å®šä¹‰pythonåº”ç”¨</strong></h3><ul><li><ol><li>åˆ›å»ºå·¥ç¨‹ç›®å½•<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> compose_test</span><br><span class="line"><span class="built_in">cd</span> compose_test</span><br><span class="line"><span class="built_in">mkdir</span> src      <span class="comment"># æºç æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">mkdir</span> docker  <span class="comment"># dockeré…ç½®æ–‡ä»¶å¤¹</span></span><br></pre></td></tr></table></figure>ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â””â”€â”€ compose_test</span><br><span class="line">    â”œâ”€â”€ docker</span><br><span class="line">    â”‚   â””â”€â”€ docker-compose.yml</span><br><span class="line">    â”œâ”€â”€ Dockerfile</span><br><span class="line">    â””â”€â”€ src</span><br><span class="line">        â”œâ”€â”€ app.py</span><br><span class="line">        â””â”€â”€ requirements.txt</span><br></pre></td></tr></table></figure></li></ol></li><li><ol start="2"><li>åœ¨compose_test&#x2F;src&#x2F;ç›®å½•ä¸‹åˆ›å»ºpython flaskåº”ç”¨ compose_test&#x2F;src&#x2F;app.pyæ–‡ä»¶ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> Redis</span><br><span class="line"> </span><br><span class="line">app = Flask(__name__)</span><br><span class="line">redis = Redis(host=<span class="string">&#x27;redis&#x27;</span>, port=<span class="number">6379</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    count = redis.incr(<span class="string">&#x27;hits&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World! I have been seen &#123;&#125; times.\n&#x27;</span>.<span class="built_in">format</span>(count)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></li></ol></li><li>3 .åˆ›å»ºpython éœ€æ±‚æ–‡ä»¶ compose_test&#x2F;src&#x2F;requirements.txt<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flask</span><br><span class="line">redis</span><br></pre></td></tr></table></figure></li></ul><h3 id="Step-2-åˆ›å»ºå®¹å™¨çš„Dockerfileæ–‡ä»¶"><a href="#Step-2-åˆ›å»ºå®¹å™¨çš„Dockerfileæ–‡ä»¶" class="headerlink" title="Step 2: åˆ›å»ºå®¹å™¨çš„Dockerfileæ–‡ä»¶"></a><strong>Step 2: åˆ›å»ºå®¹å™¨çš„Dockerfileæ–‡ä»¶</strong></h3><p>ä¸€ä¸ªå®¹å™¨ä¸€ä¸ªDockerfileæ–‡ä»¶ï¼Œåœ¨compose_test&#x2F;ç›®å½•ä¸­åˆ›å»ºDockerfileæ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.7</span><br><span class="line"> </span><br><span class="line">COPY src/ /opt/src</span><br><span class="line">WORKDIR /opt/src</span><br><span class="line"> </span><br><span class="line">RUN pip install -r requirements.txt</span><br><span class="line">CMD [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;app.py&quot;</span>]</span><br></pre></td></tr></table></figure><p>Dockerfileæ–‡ä»¶å‘Šè¯‰dockeräº†å¦‚ä¸‹ä¿¡æ¯ï¼š</p><p>ä»Python 3.7çš„é•œåƒå¼€å§‹æ„å»ºä¸€ä¸ªå®¹å™¨é•œåƒã€‚ </p><p>å¤åˆ¶srcï¼ˆå³compose_test&#x2F;srcï¼‰ç›®å½•åˆ°å®¹å™¨ä¸­çš„&#x2F;opt&#x2F;srcç›®å½•ã€‚ </p><p>å°†å®¹å™¨çš„å·¥ä½œç›®å½•è®¾ç½®ä¸º&#x2F;opt&#x2F;srcï¼ˆé€šè¿‡docker exec -it your_docker_container_id bash è¿›å…¥å®¹å™¨åçš„é»˜è®¤ç›®å½•ï¼‰ã€‚<br>å®‰è£…Pythonä¾èµ–å…³ç³»ã€‚<br>å°†å®¹å™¨çš„é»˜è®¤å‘½ä»¤è®¾ç½®ä¸ºpython app.pyã€‚</p><h3 id="Step-3-å®šä¹‰docker-composeè„šæœ¬"><a href="#Step-3-å®šä¹‰docker-composeè„šæœ¬" class="headerlink" title="Step 3: å®šä¹‰docker-composeè„šæœ¬"></a><strong>Step 3: å®šä¹‰docker-composeè„šæœ¬</strong></h3><p>åœ¨compose_test&#x2F;docker&#x2F;ç›®å½•ä¸‹åˆ›å»ºdocker-compose.ymlæ–‡ä»¶ï¼Œå¹¶åœ¨é‡Œé¢å®šä¹‰æœåŠ¡ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">../</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:3.0.7</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªcomposeæ–‡ä»¶å®šä¹‰äº†ä¸¤ä¸ªæœåŠ¡ï¼Œå³å®šä¹‰äº†webå’Œredisä¸¤ä¸ªå®¹å™¨ã€‚<br>webå®¹å™¨ï¼š </p><p>ä½¿ç”¨å½“å‰docker-compose.ymlæ–‡ä»¶æ‰€åœ¨ç›®å½•çš„ä¸Šçº§ç›®å½•ï¼ˆcompose_test&#x2F;Dockerfileï¼‰ä¸­çš„Dockerfileæ„å»ºæ˜ åƒã€‚<br>å°†å®¹å™¨ä¸Šçš„æš´éœ²ç«¯å£5000æ˜ å°„åˆ°ä¸»æœºä¸Šçš„ç«¯å£5000ã€‚<br>WebæœåŠ¡å™¨çš„é»˜è®¤ç«¯å£5000ã€‚<br>rediså®¹å™¨ï¼š </p><p>redisæœåŠ¡ä½¿ç”¨ä»Docker Hubæå–çš„å®˜æ–¹redisé•œåƒ3.0.7ç‰ˆæœ¬ã€‚</p><h3 id="Step-4-ä½¿ç”¨Composeæ„å»ºå¹¶è¿è¡Œåº”ç”¨ç¨‹åº"><a href="#Step-4-ä½¿ç”¨Composeæ„å»ºå¹¶è¿è¡Œåº”ç”¨ç¨‹åº" class="headerlink" title="Step 4: ä½¿ç”¨Composeæ„å»ºå¹¶è¿è¡Œåº”ç”¨ç¨‹åº"></a><strong>Step 4: ä½¿ç”¨Composeæ„å»ºå¹¶è¿è¡Œåº”ç”¨ç¨‹åº</strong></h3><p>åœ¨compose_test&#x2F;docker&#x2F;ç›®å½•ä¸‹æ‰§è¡Œdocker-compose.ymlæ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br><span class="line"><span class="comment"># è‹¥æ˜¯è¦åå°è¿è¡Œï¼š $ docker-compose up -d</span></span><br><span class="line"><span class="comment"># è‹¥ä¸ä½¿ç”¨é»˜è®¤çš„docker-compose.yml æ–‡ä»¶åï¼š</span></span><br><span class="line">docker-compose -f server.yml up -d </span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://127.0.0.1:5000/" title="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a>æŸ¥çœ‹è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚</p><h3 id="Step-5-ç¼–è¾‘composeæ–‡ä»¶ä»¥æ·»åŠ æ–‡ä»¶ç»‘å®šæŒ‚è½½"><a href="#Step-5-ç¼–è¾‘composeæ–‡ä»¶ä»¥æ·»åŠ æ–‡ä»¶ç»‘å®šæŒ‚è½½" class="headerlink" title="Step 5: ç¼–è¾‘composeæ–‡ä»¶ä»¥æ·»åŠ æ–‡ä»¶ç»‘å®šæŒ‚è½½"></a><strong>Step 5: ç¼–è¾‘composeæ–‡ä»¶ä»¥æ·»åŠ æ–‡ä»¶ç»‘å®šæŒ‚è½½</strong></h3><p>ä¸Šé¢çš„ä»£ç æ˜¯åœ¨æ„å»ºæ—¶é™æ€å¤åˆ¶åˆ°å®¹å™¨ä¸­çš„ï¼Œå³é€šè¿‡Dockerfileæ–‡ä»¶ä¸­çš„COPY src &#x2F;opt&#x2F;srcå‘½ä»¤å®ç°ç‰©ç†ä¸»æœºä¸­çš„æºç å¤åˆ¶åˆ°å®¹å™¨ä¸­ï¼Œè¿™æ ·åœ¨åç»­ç‰©ç†ä¸»æœºsrcç›®å½•ä¸­ä»£ç çš„æ›´æ”¹ä¸ä¼šååº”åˆ°å®¹å™¨ä¸­ã€‚<br>å¯ä»¥é€šè¿‡volumes å…³é”®å­—å®ç°ç‰©ç†ä¸»æœºç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„åŠŸèƒ½ï¼ˆåŒæ—¶åˆ é™¤Dockerfileä¸­çš„COPYæŒ‡ä»¤ï¼Œä¸éœ€è¦åˆ›å»ºé•œåƒæ—¶å°†ä»£ç æ‰“åŒ…è¿›é•œåƒï¼Œè€Œæ˜¯é€šè¿‡volumsåŠ¨æ€æŒ‚è½½ï¼Œå®¹å™¨å’Œç‰©ç†hostå…±äº«æ•°æ®å·ï¼‰ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">../</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">../src:/opt/src</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;redis:3.0.7&quot;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡volumesï¼ˆå·ï¼‰å°†ä¸»æœºä¸Šçš„é¡¹ç›®ç›®å½•ï¼ˆcompose_test&#x2F;srcï¼‰æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„&#x2F;opt&#x2F;srcç›®å½•ï¼Œå…è®¸æ‚¨å³æ—¶ä¿®æ”¹ä»£ç ï¼Œè€Œæ— éœ€é‡æ–°æ„å»ºé•œåƒã€‚</p><h3 id="Step-6-é‡æ–°æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åº"><a href="#Step-6-é‡æ–°æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åº" class="headerlink" title="Step 6: é‡æ–°æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åº"></a><strong>Step 6: é‡æ–°æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åº</strong></h3><p>ä½¿ç”¨æ›´æ–°çš„composeæ–‡ä»¶æ„å»ºåº”ç”¨ç¨‹åºï¼Œç„¶åè¿è¡Œå®ƒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h2 id="composeå¸¸ç”¨æœåŠ¡é…ç½®å‚è€ƒ"><a href="#composeå¸¸ç”¨æœåŠ¡é…ç½®å‚è€ƒ" class="headerlink" title="composeå¸¸ç”¨æœåŠ¡é…ç½®å‚è€ƒ"></a>composeå¸¸ç”¨æœåŠ¡é…ç½®å‚è€ƒ</h2><p>Composeæ–‡ä»¶æ˜¯ä¸€ä¸ªå®šä¹‰æœåŠ¡ï¼Œç½‘ç»œå’Œå·çš„YAMLæ–‡ä»¶ã€‚ Composeæ–‡ä»¶çš„é»˜è®¤æ–‡ä»¶åä¸ºdocker-compose.ymlã€‚</p><blockquote><p>[!tip]<br>æç¤ºï¼šæ‚¨å¯ä»¥å¯¹æ­¤æ–‡ä»¶ä½¿ç”¨.ymlæˆ–.yamlæ‰©å±•åã€‚ ä»–ä»¬éƒ½å·¥ä½œã€‚</p></blockquote><p>ä¸dockerè¿è¡Œä¸€æ ·ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒDockerfileä¸­æŒ‡å®šçš„é€‰é¡¹ï¼ˆä¾‹å¦‚ï¼ŒCMDï¼ŒEXPOSEï¼ŒVOLUMEï¼ŒENVï¼‰éƒ½è¢«éµå®ˆï¼Œä½ ä¸éœ€è¦åœ¨docker-compose.ymlä¸­å†æ¬¡æŒ‡å®šå®ƒä»¬ã€‚</p><p>åŒæ—¶ä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼Bashçš„$ {VARIABLE} è¯­æ³•åœ¨é…ç½®å€¼ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://docs.docker.com/reference/compose-file/#variable-substitution">å˜é‡æ›¿æ¢</a>ã€‚</p><h3 id="build"><a href="#build" class="headerlink" title="build"></a>build</h3><p>build å¯ä»¥æŒ‡å®šåŒ…å«æ„å»ºä¸Šä¸‹æ–‡çš„è·¯å¾„ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">webapp:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./dir</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å…·æœ‰ä¸Šä¸‹æ–‡è·¯å¾„å’ŒæŒ‡å®šçš„Dockerfileæ–‡ä»¶ä»¥åŠargså‚æ•°å€¼ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">webapp:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./dir</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile-alternate</span></span><br><span class="line">      <span class="attr">args:</span></span><br><span class="line">        <span class="attr">buildno:</span> <span class="number">1</span></span><br><span class="line"><span class="string">``````</span></span><br><span class="line"></span><br><span class="line"><span class="string">webappæœåŠ¡å°†ä¼šé€šè¿‡./dirç›®å½•ä¸‹çš„Dockerfile-alternateæ–‡ä»¶æ„å»ºå®¹å™¨é•œåƒã€‚</span> </span><br><span class="line"><span class="string">å¦‚æœä½ åŒæ—¶æŒ‡å®šimageå’Œbuildï¼Œåˆ™composeä¼šé€šè¿‡buildæŒ‡å®šçš„ç›®å½•æ„å»ºå®¹å™¨é•œåƒï¼Œè€Œæ„å»ºçš„é•œåƒåä¸ºimageä¸­æŒ‡å®šçš„é•œåƒåå’Œæ ‡ç­¾ã€‚</span></span><br><span class="line"><span class="string">```yaml</span></span><br><span class="line"><span class="attr">build:</span> <span class="string">./dir</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">webapp:tag</span></span><br></pre></td></tr></table></figure><p>è¿™å°†ç”±.&#x2F;diræ„å»ºçš„åä¸ºwebappå’Œæ ‡è®°ä¸ºtagçš„é•œåƒã€‚</p><p><strong>context</strong></p><p>åŒ…å«Dockerfileæ–‡ä»¶çš„ç›®å½•è·¯å¾„ï¼Œæˆ–è€…æ˜¯gitä»“åº“çš„URLã€‚<br>å½“æä¾›çš„å€¼æ˜¯ç›¸å¯¹è·¯å¾„æ—¶ï¼Œå®ƒè¢«è§£é‡Šä¸ºç›¸å¯¹äºå½“å‰composeæ–‡ä»¶çš„ä½ç½®ã€‚ è¯¥ç›®å½•ä¹Ÿæ˜¯å‘é€åˆ°Dockerå®ˆæŠ¤ç¨‹åºæ„å»ºé•œåƒçš„ä¸Šä¸‹æ–‡ã€‚</p><p><strong>dockerfile</strong></p><p>å¤‡ç”¨Dockeræ–‡ä»¶ã€‚Composeå°†ä½¿ç”¨å¤‡ç”¨æ–‡ä»¶æ¥æ„å»ºã€‚ è¿˜å¿…é¡»æŒ‡å®šæ„å»ºè·¯å¾„ã€‚</p><p><strong>args</strong></p><p>æ·»åŠ æ„å»ºé•œåƒçš„å‚æ•°ï¼Œç¯å¢ƒå˜é‡åªèƒ½åœ¨æ„å»ºè¿‡ç¨‹ä¸­è®¿é—®ã€‚<br>é¦–å…ˆï¼Œåœ¨Dockerfileä¸­æŒ‡å®šè¦ä½¿ç”¨çš„å‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ARG buildno</span><br><span class="line">ARG password</span><br><span class="line"> </span><br><span class="line">RUN echo &quot;Build number: $buildno&quot;</span><br><span class="line">RUN script-requiring-password.sh &quot;$password&quot;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨argsé”®ä¸‹æŒ‡å®šå‚æ•°ã€‚ ä½ å¯ä»¥ä¼ é€’æ˜ å°„æˆ–åˆ—è¡¨ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">  <span class="attr">args:</span></span><br><span class="line">    <span class="attr">buildno:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">secret</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">  <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">buildno=1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">password=secret</span></span><br></pre></td></tr></table></figure><blockquote><p>[!tip]<br>æ³¨æ„ï¼šYAMLå¸ƒå°”å€¼ï¼ˆtrueï¼Œfalseï¼Œyesï¼Œnoï¼Œonï¼Œoffï¼‰å¿…é¡»ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œä»¥ä¾¿è§£æå™¨å°†å®ƒä»¬è§£é‡Šä¸ºå­—ç¬¦ä¸²ã€‚</p></blockquote><h3 id="image"><a href="#image" class="headerlink" title="image"></a>image</h3><p>æŒ‡å®šå¯åŠ¨å®¹å™¨çš„é•œåƒï¼Œå¯ä»¥æ˜¯é•œåƒä»“åº“&#x2F;æ ‡ç­¾æˆ–è€…é•œåƒidï¼ˆæˆ–è€…idçš„å‰ä¸€éƒ¨åˆ†ï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">ubuntu:14.04</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">tutum/influxdb</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">example-registry.com:4000/postgresql</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">a4bc65fd</span></span><br></pre></td></tr></table></figure><p>å¦‚æœé•œåƒä¸å­˜åœ¨ï¼ŒComposeå°†å°è¯•ä»å®˜æ–¹é•œåƒä»“åº“å°†å…¶pullä¸‹æ¥ï¼Œå¦‚æœä½ è¿˜æŒ‡å®šäº†buildï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†ä½¿ç”¨æŒ‡å®šçš„buildé€‰é¡¹æ„å»ºå®ƒï¼Œå¹¶ä½¿ç”¨imageæŒ‡å®šçš„åå­—å’Œæ ‡è®°å¯¹å…¶è¿›è¡Œæ ‡è®°ã€‚</p><h3 id="container-name"><a href="#container-name" class="headerlink" title="container_name"></a>container_name</h3><p>æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰å®¹å™¨åç§°ï¼Œè€Œä¸æ˜¯ç”Ÿæˆçš„é»˜è®¤åç§°ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">container_name:</span> <span class="string">my-web-container</span></span><br></pre></td></tr></table></figure><p>ç”±äºDockerå®¹å™¨åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œå› æ­¤å¦‚æœæŒ‡å®šäº†è‡ªå®šä¹‰åç§°ï¼Œåˆ™æ— æ³•å°†æœåŠ¡æ‰©å±•åˆ°å¤šä¸ªå®¹å™¨ã€‚</p><h3 id="volumes"><a href="#volumes" class="headerlink" title="volumes"></a>volumes</h3><p>å·æŒ‚è½½è·¯å¾„è®¾ç½®ã€‚å¯ä»¥è®¾ç½®å®¿ä¸»æœºè·¯å¾„ ï¼ˆHOST:CONTAINERï¼‰ æˆ–åŠ ä¸Šè®¿é—®æ¨¡å¼ ï¼ˆHOST:CONTAINER:roï¼‰,æŒ‚è½½æ•°æ®å·çš„é»˜è®¤æƒé™æ˜¯è¯»å†™ï¼ˆrwï¼‰ï¼Œå¯ä»¥é€šè¿‡roæŒ‡å®šä¸ºåªè¯»ã€‚<br>ä½ å¯ä»¥åœ¨ä¸»æœºä¸ŠæŒ‚è½½ç›¸å¯¹è·¯å¾„ï¼Œè¯¥è·¯å¾„å°†ç›¸å¯¹äºå½“å‰æ­£åœ¨ä½¿ç”¨çš„Composeé…ç½®æ–‡ä»¶çš„ç›®å½•è¿›è¡Œæ‰©å±•ã€‚ ç›¸å¯¹è·¯å¾„åº”å§‹ç»ˆä»¥ . æˆ–è€… .. å¼€å§‹ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="comment"># åªéœ€æŒ‡å®šä¸€ä¸ªè·¯å¾„ï¼Œè®©å¼•æ“åˆ›å»ºä¸€ä¸ªå·</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">/var/lib/mysql</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment"># æŒ‡å®šç»å¯¹è·¯å¾„æ˜ å°„</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">/opt/data:/var/lib/mysql</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment"># ç›¸å¯¹äºå½“å‰composeæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">./cache:/tmp/cache</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment"># ç”¨æˆ·å®¶ç›®å½•ç›¸å¯¹è·¯å¾„</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">~/configs:/etc/configs/:ro</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment"># å‘½åå·</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">datavolume:/var/lib/mysql</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå¦‚æœè¦è·¨å¤šä¸ªæœåŠ¡å¹¶é‡ç”¨æŒ‚è½½å·ï¼Œè¯·åœ¨é¡¶çº§volumeså…³é”®å­—ä¸­å‘½åæŒ‚åœ¨å·ï¼Œä½†æ˜¯å¹¶ä¸å¼ºåˆ¶ï¼Œå¦‚ä¸‹çš„ç¤ºä¾‹äº¦æœ‰é‡ç”¨æŒ‚è½½å·çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸æå€¡ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web1:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./web/</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../code:/opt/web/code</span></span><br><span class="line">  <span class="attr">web2:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./web/</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../code:/opt/web/code</span></span><br></pre></td></tr></table></figure><blockquote><p>[!tip]<br>** æ³¨æ„ï¼šé€šè¿‡é¡¶çº§volumeså®šä¹‰ä¸€ä¸ªæŒ‚è½½å·ï¼Œå¹¶ä»æ¯ä¸ªæœåŠ¡çš„å·åˆ—è¡¨ä¸­å¼•ç”¨å®ƒï¼Œ è¿™ä¼šæ›¿æ¢æ—©æœŸç‰ˆæœ¬çš„Composeæ–‡ä»¶æ ¼å¼ä¸­volumes_fromã€‚</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">data-volume:/var/lib/db</span></span><br><span class="line">  <span class="attr">backup:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">backup-service</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">data-volume:/var/lib/backup/data</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">data-volume:</span></span><br></pre></td></tr></table></figure><h3 id="command"><a href="#command" class="headerlink" title="command"></a>command</h3><p>è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">command:</span> <span class="string">bundle</span> <span class="string">exec</span> <span class="string">thin</span> <span class="string">-p</span> <span class="number">3000</span></span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»ä¼¼äºdockerfileçš„åˆ—è¡¨ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">command:</span> [<span class="string">&quot;bundle&quot;</span>, <span class="string">&quot;exec&quot;</span>, <span class="string">&quot;thin&quot;</span>, <span class="string">&quot;-p&quot;</span>, <span class="string">&quot;3000&quot;</span>]</span><br></pre></td></tr></table></figure><h3 id="links"><a href="#links" class="headerlink" title="links"></a>links</h3><p>é“¾æ¥åˆ°å¦ä¸€ä¸ªæœåŠ¡ä¸­çš„å®¹å™¨ã€‚ è¯·æŒ‡å®šæœåŠ¡åç§°å’Œé“¾æ¥åˆ«åï¼ˆSERVICEï¼šALIASï¼‰ï¼Œæˆ–è€…ä»…æŒ‡å®šæœåŠ¡åç§°ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">web:</span></span><br><span class="line">  <span class="attr">links:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">db:database</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">redis</span></span><br></pre></td></tr></table></figure><p>åœ¨å½“å‰çš„webæœåŠ¡çš„å®¹å™¨ä¸­å¯ä»¥é€šè¿‡é“¾æ¥çš„dbæœåŠ¡çš„åˆ«ådatabaseè®¿é—®dbå®¹å™¨ä¸­çš„æ•°æ®åº“åº”ç”¨ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåˆ«åï¼Œåˆ™å¯ç›´æ¥ä½¿ç”¨æœåŠ¡åè®¿é—®ã€‚</p><p>é“¾æ¥ä¸éœ€è¦å¯ç”¨æœåŠ¡è¿›è¡Œé€šä¿¡ - é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•æœåŠ¡éƒ½å¯ä»¥ä»¥è¯¥æœåŠ¡çš„åç§°åˆ°è¾¾ä»»ä½•å…¶ä»–æœåŠ¡ã€‚ ï¼ˆå®é™…æ˜¯é€šè¿‡è®¾ç½®&#x2F;etc&#x2F;hostsçš„åŸŸåè§£æï¼Œä»è€Œå®ç°å®¹å™¨é—´çš„é€šä¿¡ã€‚æ•…å¯ä»¥åƒåœ¨åº”ç”¨ä¸­ä½¿ç”¨localhostä¸€æ ·ä½¿ç”¨æœåŠ¡çš„åˆ«åé“¾æ¥å…¶ä»–å®¹å™¨çš„æœåŠ¡ï¼Œå‰ææ˜¯å¤šä¸ªæœåŠ¡å®¹å™¨åœ¨ä¸€ä¸ªç½‘ç»œä¸­å¯è·¯ç”±è”é€šï¼‰</p><p>linksä¹Ÿå¯ä»¥èµ·åˆ°å’Œdepends_onç›¸ä¼¼çš„åŠŸèƒ½ï¼Œå³å®šä¹‰æœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»è€Œç¡®å®šæœåŠ¡å¯åŠ¨çš„é¡ºåºã€‚</p><p>external_links<br>é“¾æ¥åˆ°docker-compose.yml å¤–éƒ¨çš„å®¹å™¨ï¼Œç”šè‡³å¹¶é Compose ç®¡ç†çš„å®¹å™¨ã€‚å‚æ•°æ ¼å¼è·Ÿ links ç±»ä¼¼ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">external_links:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">redis_1</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">project_db_1:mysql</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">project_db_1:postgresql</span></span><br></pre></td></tr></table></figure><h3 id="expose"><a href="#expose" class="headerlink" title="expose"></a>expose</h3><p>æš´éœ²ç«¯å£ï¼Œä½†ä¸æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œåªè¢«è¿æ¥çš„æœåŠ¡è®¿é—®ã€‚<br>ä»…å¯ä»¥æŒ‡å®šå†…éƒ¨ç«¯å£ä¸ºå‚æ•°</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">expose:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;3000&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;8000&quot;</span></span><br></pre></td></tr></table></figure><h3 id="ports"><a href="#ports" class="headerlink" title="ports"></a>ports</h3><p>æš´éœ²ç«¯å£ä¿¡æ¯ã€‚<br>å¸¸ç”¨çš„ç®€å•æ ¼å¼ï¼šä½¿ç”¨å®¿ä¸»ï¼šå®¹å™¨ ï¼ˆHOST:CONTAINERï¼‰æ ¼å¼æˆ–è€…ä»…ä»…æŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼ˆå®¿ä¸»å°†ä¼šéšæœºé€‰æ‹©ç«¯å£ï¼‰éƒ½å¯ä»¥ã€‚</p><blockquote><p>[!tip]<br>æ³¨æ„ï¼šå½“ä½¿ç”¨ HOST:CONTAINER æ ¼å¼æ¥æ˜ å°„ç«¯å£æ—¶ï¼Œå¦‚æœä½ ä½¿ç”¨çš„å®¹å™¨ç«¯å£å°äº 60 ä½ å¯èƒ½ä¼šå¾—åˆ°é”™è¯¯å¾—ç»“æœï¼Œå› ä¸º YAML å°†ä¼šè§£æ xx:yy è¿™ç§æ•°å­—æ ¼å¼ä¸º 60 è¿›åˆ¶ã€‚æ‰€ä»¥å»ºè®®é‡‡ç”¨å­—ç¬¦ä¸²æ ¼å¼ã€‚</p></blockquote><p>ç®€å•çš„çŸ­æ ¼å¼ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ports:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;3000&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;3000-3005&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;9090-9091:8080-8081&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;49100:22&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;127.0.0.1:8001:8001&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;127.0.0.1:5000-5010:5000-5010&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;6060:6060/udp&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨v3.2ä¸­portsçš„é•¿æ ¼å¼çš„è¯­æ³•å…è®¸é…ç½®ä¸èƒ½ç”¨çŸ­æ ¼å¼è¡¨ç¤ºçš„é™„åŠ å­—æ®µã€‚<br>é•¿æ ¼å¼ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">target:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">published:</span> <span class="number">8080</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">tcp</span></span><br><span class="line">    <span class="attr">mode:</span> <span class="string">host</span></span><br></pre></td></tr></table></figure><p>targetï¼šå®¹å™¨å†…çš„ç«¯å£<br>publishedï¼šç‰©ç†ä¸»æœºçš„ç«¯å£<br>protocolï¼šç«¯å£åè®®ï¼ˆtcpæˆ–udpï¼‰<br>modeï¼šhost å’Œingress ä¸¤æ€»æ¨¡å¼ï¼Œhostç”¨äºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå‘å¸ƒä¸»æœºç«¯å£ï¼Œingress ç”¨äºè¢«è´Ÿè½½å¹³è¡¡çš„swarmæ¨¡å¼ç«¯å£ã€‚</p><h3 id="restart"><a href="#restart" class="headerlink" title="restart"></a>restart</h3><p>noæ˜¯é»˜è®¤çš„é‡å¯ç­–ç•¥ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šé‡å¯å®¹å™¨ã€‚ æŒ‡å®šä¸ºalwaysæ—¶ï¼Œå®¹å™¨æ€»æ˜¯é‡æ–°å¯åŠ¨ã€‚ å¦‚æœé€€å‡ºä»£ç æŒ‡ç¤ºå‡ºç°æ•…éšœé”™è¯¯ï¼Œåˆ™on-failureå°†é‡æ–°å¯åŠ¨å®¹å™¨ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">restart:</span> <span class="string">&quot;no&quot;</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">on-failure</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure><h3 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h3><p>æ·»åŠ ç¯å¢ƒå˜é‡ã€‚ ä½ å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ä¸¤ç§å½¢å¼ã€‚ ä»»ä½•å¸ƒå°”å€¼; trueï¼Œfalseï¼Œyesï¼Œnoéœ€è¦ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œä»¥ç¡®ä¿å®ƒä»¬ä¸è¢«YMLè§£æå™¨è½¬æ¢ä¸ºTrueæˆ–Falseã€‚<br>åªç»™å®šåç§°çš„å˜é‡ä¼šè‡ªåŠ¨è·å–å®ƒåœ¨ Compose ä¸»æœºä¸Šçš„å€¼ï¼Œå¯ä»¥ç”¨æ¥é˜²æ­¢æ³„éœ²ä¸å¿…è¦çš„æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">environment:</span><br><span class="line">  RACK_ENV: development</span><br><span class="line">  SHOW: &#x27;true&#x27;</span><br><span class="line">  SESSION_SECRET:</span><br><span class="line"> </span><br><span class="line">environment:</span><br><span class="line">  - RACK_ENV=development</span><br><span class="line">  - SHOW=true</span><br><span class="line">  - SESSION_SECRET</span><br></pre></td></tr></table></figure><blockquote><p>[!tip]<br>æ³¨æ„ï¼šå¦‚æœä½ çš„æœåŠ¡æŒ‡å®šäº†buildé€‰é¡¹ï¼Œé‚£ä¹ˆåœ¨æ„å»ºè¿‡ç¨‹ä¸­é€šè¿‡environmentå®šä¹‰çš„ç¯å¢ƒå˜é‡å°†ä¸ä¼šèµ·ä½œç”¨ã€‚ å°†ä½¿ç”¨buildçš„argså­é€‰é¡¹æ¥å®šä¹‰æ„å»ºæ—¶çš„ç¯å¢ƒå˜é‡ã€‚</p></blockquote><h3 id="pid"><a href="#pid" class="headerlink" title="pid"></a>pid</h3><p>å°†PIDæ¨¡å¼è®¾ç½®ä¸ºä¸»æœºPIDæ¨¡å¼ã€‚ è¿™å°±æ‰“å¼€äº†å®¹å™¨ä¸ä¸»æœºæ“ä½œç³»ç»Ÿä¹‹é—´çš„å…±äº«PIDåœ°å€ç©ºé—´ã€‚ ä½¿ç”¨æ­¤æ ‡å¿—å¯åŠ¨çš„å®¹å™¨å°†èƒ½å¤Ÿè®¿é—®å’Œæ“ä½œè£¸æœºçš„å‘½åç©ºé—´ä¸­çš„å…¶ä»–å®¹å™¨ï¼Œåä¹‹äº¦ç„¶ã€‚å³æ‰“å¼€è¯¥é€‰é¡¹çš„å®¹å™¨å¯ä»¥ç›¸äº’é€šè¿‡è¿›ç¨‹ ID æ¥è®¿é—®å’Œæ“ä½œã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pid:</span> <span class="string">&quot;host&quot;</span></span><br></pre></td></tr></table></figure><h3 id="dns"><a href="#dns" class="headerlink" title="dns"></a>dns</h3><p>é…ç½® DNS æœåŠ¡å™¨ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dns:</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line"><span class="attr">dns:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">9.9</span><span class="number">.9</span><span class="number">.9</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docekrå…¥é—¨</title>
      <link href="/2025/08/07/docker%E5%85%A5%E9%97%A8/"/>
      <url>/2025/08/07/docker%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å¤§éƒ¨åˆ†å‚è€ƒ<a href="https://blog.csdn.net/m0_61503020/article/details/125456520?spm=1001.2014.3001.5506">ã€Šdocekrå…¥é—¨,è¿™ä¸€ç¯‡å°±å¤Ÿäº†ã€‹</a></p><h1 id="docekrèƒŒæ™¯ä»‹ç»"><a href="#docekrèƒŒæ™¯ä»‹ç»" class="headerlink" title="docekrèƒŒæ™¯ä»‹ç»"></a>docekrèƒŒæ™¯ä»‹ç»</h1><h2 id="ä»€ä¹ˆæ˜¯docekr"><a href="#ä»€ä¹ˆæ˜¯docekr" class="headerlink" title="ä»€ä¹ˆæ˜¯docekr"></a>ä»€ä¹ˆæ˜¯docekr</h2><p>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯æŠ‘åˆ¶çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„Linuxæœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨å®Œå…¨ä½¿ç”¨<strong>æ²™ç›’æœºåˆ¶</strong>ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šå­˜åœ¨ä»»ä½•æ¥å£ã€‚å‡ ä¹æ²¡æœ‰æ€§èƒ½å¼€é”€ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„åœ¨æœºå™¨å’Œæ•°æ®ä¸­å¿ƒè¿è¡Œã€‚æœ€é‡è¦çš„æ˜¯ï¼Œä»–ä»¬<strong>ä¸ä¾èµ–äºä»»ä½•è¯­è¨€ã€æ¡†æ¶æˆ–è€…åŒ…è£…ç³»ç»Ÿã€‚</strong></p><p>å°çŸ¥è¯†ï¼šæ²™ç›’ä¹Ÿå«æ²™ç®±ï¼ˆsandboxï¼‰ã€‚åœ¨è®¡ç®—æœºé¢†åŸŸæŒ‡ä¸€ç§è™šæ‹ŸæŠ€æœ¯ï¼Œè€Œä¸”å¤šç”¨äºè®¡ç®—æœºå®‰å…¨æŠ€æœ¯ã€‚å®‰å…¨è½¯ä»¶å¯ä»¥è®©å®ƒåœ¨æ²™ç›’ä¸­è¿è¡Œï¼Œå¦‚æœå«æœ‰æ¶æ„è¡Œä¸ºï¼Œåˆ™ç¦æ­¢ç¨‹åºçš„è¿›ä¸€æ­¥è¿è¡Œï¼Œè€Œè¿™ä¸ä¼šå¯¹ç³»ç»Ÿé€ æˆä»»ä½•å±å®³ã€‚<br><a href="https://www.docker.com/">å®˜ç½‘</a>ï¼š<a href="https://www.docker.com/">https://www.docker.com/</a></p><h2 id="Dockerå®¹å™¨æŠ€æœ¯ä¸è™šæ‹Ÿæœºçš„åŒºåˆ«"><a href="#Dockerå®¹å™¨æŠ€æœ¯ä¸è™šæ‹Ÿæœºçš„åŒºåˆ«" class="headerlink" title="Dockerå®¹å™¨æŠ€æœ¯ä¸è™šæ‹Ÿæœºçš„åŒºåˆ«"></a>Dockerå®¹å™¨æŠ€æœ¯ä¸è™šæ‹Ÿæœºçš„åŒºåˆ«</h2><p>Docker å®¹å™¨æŠ€æœ¯å’Œè™šæ‹Ÿæœºï¼ˆVMï¼‰éƒ½æ˜¯å®ç°èµ„æºéš”ç¦»å’Œç¯å¢ƒä¸€è‡´æ€§çš„æŠ€æœ¯ï¼Œä½†å®ƒä»¬çš„åº•å±‚å®ç°å’Œç‰¹æ€§æœ‰æ˜¾è‘—åŒºåˆ«ï¼Œä¸»è¦ä½“ç°åœ¨æ¶æ„ã€æ€§èƒ½ã€å¯åŠ¨é€Ÿåº¦ç­‰æ–¹é¢ã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«ï¼š</p><h3 id="1-æ¶æ„åŸç†"><a href="#1-æ¶æ„åŸç†" class="headerlink" title="1. æ¶æ„åŸç†"></a><strong>1. æ¶æ„åŸç†</strong></h3><ul><li><p><strong>è™šæ‹Ÿæœºï¼ˆVMï¼‰</strong>ï¼š<br>  åŸºäº<strong>ç¡¬ä»¶è™šæ‹ŸåŒ–</strong>ï¼Œéœ€è¦åœ¨å®¿ä¸»æœºï¼ˆHostï¼‰ä¸Šå®‰è£…<strong>Hypervisor</strong>ï¼ˆå¦‚ VMwareã€KVMï¼‰ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºéƒ½åŒ…å«å®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼ˆGuest OSï¼‰ã€åº”ç”¨ç¨‹åºåŠå¿…è¦çš„åº“ã€‚<br>  è™šæ‹Ÿæœºé€šè¿‡ Hypervisor æ¨¡æ‹Ÿç¡¬ä»¶èµ„æºï¼ˆCPUã€å†…å­˜ã€ç¡¬ç›˜ç­‰ï¼‰ï¼Œä¸å®¿ä¸»æœºå®Œå…¨éš”ç¦»ï¼Œç›¸å½“äºä¸€ä¸ªç‹¬ç«‹çš„ â€œç‰©ç†æœºâ€ã€‚</p></li><li><p><strong>Docker å®¹å™¨</strong>ï¼š<br>  åŸºäº<strong>æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–</strong>ï¼Œä¸éœ€è¦ Hypervisorï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚<br>  å®¹å™¨ä»…åŒ…å«åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–çš„åº“ï¼ˆå¦‚ Pythonã€Java ç¯å¢ƒï¼‰ï¼Œå…±äº«å®¿ä¸»æœºçš„ OS å†…æ ¸ï¼Œé€šè¿‡<strong>Namespace</strong>ï¼ˆéš”ç¦»è¿›ç¨‹ã€ç½‘ç»œç­‰ï¼‰å’Œ<strong>Cgroups</strong>ï¼ˆé™åˆ¶èµ„æºï¼‰å®ç°éš”ç¦»ã€‚</p></li></ul><h3 id="2-èµ„æºå ç”¨"><a href="#2-èµ„æºå ç”¨" class="headerlink" title="2. èµ„æºå ç”¨"></a><strong>2. èµ„æºå ç”¨</strong></h3><ul><li><p><strong>è™šæ‹Ÿæœº</strong>ï¼š<br>  æ¯ä¸ª VM éœ€è¦åˆ†é…ç‹¬ç«‹çš„ CPUã€å†…å­˜ã€ç£ç›˜ç­‰èµ„æºï¼Œä¸”åŒ…å«å®Œæ•´ OSï¼Œèµ„æºå ç”¨é«˜ï¼ˆé€šå¸¸ GB çº§ï¼‰ã€‚</p></li><li><p><strong>Docker å®¹å™¨</strong>ï¼š<br>  å…±äº«å®¿ä¸»æœºå†…æ ¸ï¼Œä»…å ç”¨åº”ç”¨ç¨‹åºæœ¬èº«çš„èµ„æºï¼Œèµ„æºå ç”¨æä½ï¼ˆé€šå¸¸ MB çº§ï¼‰ï¼Œå¯åœ¨åŒä¸€å°å®¿ä¸»æœºä¸Šè¿è¡Œæˆç™¾ä¸Šåƒä¸ªå®¹å™¨ã€‚</p></li></ul><h3 id="3-å¯åŠ¨é€Ÿåº¦"><a href="#3-å¯åŠ¨é€Ÿåº¦" class="headerlink" title="3. å¯åŠ¨é€Ÿåº¦"></a><strong>3. å¯åŠ¨é€Ÿåº¦</strong></h3><ul><li><p><strong>è™šæ‹Ÿæœº</strong>ï¼š<br>  å¯åŠ¨éœ€ç»å† BIOSã€OS åŠ è½½ç­‰å®Œæ•´æµç¨‹ï¼Œé€šå¸¸éœ€è¦<strong>åˆ†é’Ÿçº§</strong>ï¼ˆå¦‚ 1-5 åˆ†é’Ÿï¼‰ã€‚</p></li><li><p><strong>Docker å®¹å™¨</strong>ï¼š<br>  æ— éœ€å¯åŠ¨æ“ä½œç³»ç»Ÿï¼Œç›´æ¥è¿è¡Œåº”ç”¨è¿›ç¨‹ï¼Œå¯åŠ¨é€Ÿåº¦ä¸º<strong>ç§’çº§ç”šè‡³æ¯«ç§’çº§</strong>ï¼ˆå¦‚ 1-3 ç§’ï¼‰ã€‚</p></li></ul><h3 id="4-éš”ç¦»æ€§"><a href="#4-éš”ç¦»æ€§" class="headerlink" title="4. éš”ç¦»æ€§"></a><strong>4. éš”ç¦»æ€§</strong></h3><ul><li><p><strong>è™šæ‹Ÿæœº</strong>ï¼š<br>  éš”ç¦»æ€§æå¼ºï¼ŒVM ä¹‹é—´ã€VM ä¸å®¿ä¸»æœºä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œä¸€ä¸ª VM çš„å´©æºƒæˆ–å®‰å…¨é—®é¢˜ä¸ä¼šå½±å“å…¶ä»– VMã€‚</p></li><li><p><strong>Docker å®¹å™¨</strong>ï¼š<br>  éš”ç¦»æ€§è¾ƒå¼±ï¼Œå…±äº«å®¿ä¸»æœºå†…æ ¸ï¼Œè‹¥å†…æ ¸å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å½±å“æ‰€æœ‰å®¹å™¨ã€‚ä½†é€šè¿‡ Namespace å’Œ Cgroupsï¼Œå¯å®ç°è¿›ç¨‹ã€ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿçš„éš”ç¦»ï¼Œæ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯éœ€æ±‚ã€‚</p></li></ul><h3 id="5-ç§»æ¤æ€§"><a href="#5-ç§»æ¤æ€§" class="headerlink" title="5. ç§»æ¤æ€§"></a><strong>5. ç§»æ¤æ€§</strong></h3><ul><li><p><strong>è™šæ‹Ÿæœº</strong>ï¼š<br>  é•œåƒä½“ç§¯å¤§ï¼ˆé€šå¸¸ GB çº§ï¼‰ï¼Œç§»æ¤å’Œåˆ†å‘è¾ƒæ…¢ï¼Œä¸”å— Hypervisor ç±»å‹é™åˆ¶ï¼ˆå¦‚ VMware é•œåƒæ— æ³•ç›´æ¥åœ¨ KVM ä¸Šè¿è¡Œï¼‰ã€‚</p></li><li><p><strong>Docker å®¹å™¨</strong>ï¼š<br>  é•œåƒä½“ç§¯å°ï¼ˆé€šå¸¸ MB çº§ï¼‰ï¼Œç§»æ¤æ€§æå¼ºï¼Œâ€œä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œâ€ï¼Œåªè¦å®¿ä¸»æœºå®‰è£… Dockerï¼Œå³å¯è¿è¡Œç›¸åŒçš„å®¹å™¨ï¼ˆä¸å—åº•å±‚ OS å‘è¡Œç‰ˆå½±å“ï¼Œå¦‚ Ubuntu å’Œ CentOS ä¸Šå¯è¿è¡ŒåŒä¸€å®¹å™¨ï¼‰ã€‚</p></li></ul><h3 id="6-é€‚ç”¨åœºæ™¯"><a href="#6-é€‚ç”¨åœºæ™¯" class="headerlink" title="6. é€‚ç”¨åœºæ™¯"></a><strong>6. é€‚ç”¨åœºæ™¯</strong></h3><ul><li><strong>è™šæ‹Ÿæœº</strong>ï¼š<ul><li>éœ€è¿è¡Œä¸åŒæ“ä½œç³»ç»Ÿï¼ˆå¦‚ Windows å’Œ Linux åŒæ—¶è¿è¡Œï¼‰ã€‚</li><li>å¯¹éš”ç¦»æ€§å’Œå®‰å…¨æ€§è¦æ±‚æé«˜ï¼ˆå¦‚é‡‘èã€åŒ»ç–—ç­‰é¢†åŸŸï¼‰ã€‚</li><li>è¿è¡Œéœ€è¦å®Œæ•´ OS æ”¯æŒçš„å¤æ‚åº”ç”¨ã€‚</li></ul></li><li><strong>Docker å®¹å™¨</strong>ï¼š<ul><li>å¾®æœåŠ¡æ¶æ„ï¼ˆå°†åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹å®¹å™¨ï¼‰ã€‚</li><li>æŒç»­é›†æˆ &#x2F; æŒç»­éƒ¨ç½²ï¼ˆCI&#x2F;CDï¼‰ï¼Œå¿«é€Ÿæ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ã€‚</li><li>èµ„æºå¯†é›†å‹åœºæ™¯ï¼ˆå¦‚é«˜å¹¶å‘ Web æœåŠ¡ï¼‰ï¼Œé«˜æ•ˆåˆ©ç”¨ç¡¬ä»¶èµ„æºã€‚</li></ul></li></ul><h3 id="æ€»ç»“å¯¹æ¯”è¡¨"><a href="#æ€»ç»“å¯¹æ¯”è¡¨" class="headerlink" title="æ€»ç»“å¯¹æ¯”è¡¨"></a><strong>æ€»ç»“å¯¹æ¯”è¡¨</strong></h3><table><thead><tr><th>ç‰¹æ€§</th><th>è™šæ‹Ÿæœºï¼ˆVMï¼‰</th><th>Docker å®¹å™¨</th></tr></thead><tbody><tr><td>æ ¸å¿ƒæŠ€æœ¯</td><td>ç¡¬ä»¶è™šæ‹ŸåŒ–ï¼ˆHypervisorï¼‰</td><td>æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–ï¼ˆNamespace&#x2F;Cgroupsï¼‰</td></tr><tr><td>èµ„æºå ç”¨</td><td>é«˜ï¼ˆGB çº§ï¼‰</td><td>ä½ï¼ˆMB çº§ï¼‰</td></tr><tr><td>å¯åŠ¨é€Ÿåº¦</td><td>åˆ†é’Ÿçº§</td><td>ç§’çº§ &#x2F; æ¯«ç§’çº§</td></tr><tr><td>éš”ç¦»æ€§</td><td>æå¼º</td><td>è¾ƒå¼ºï¼ˆå…±äº«å†…æ ¸ï¼‰</td></tr><tr><td>é•œåƒä½“ç§¯</td><td>å¤§</td><td>å°</td></tr><tr><td>ç§»æ¤æ€§</td><td>è¾ƒå·®ï¼ˆå— Hypervisor é™åˆ¶ï¼‰</td><td>æå¼ºï¼ˆè·¨å¹³å°å…¼å®¹ï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å¼ºéš”ç¦»éœ€æ±‚ã€å¤š OS è¿è¡Œ</td><td>å¾®æœåŠ¡ã€CI&#x2F;CDã€é«˜æ•ˆèµ„æºåˆ©ç”¨</td></tr></tbody></table><h3 id="dockerç›¸è¾ƒäºVMçš„ä¼˜ç‚¹"><a href="#dockerç›¸è¾ƒäºVMçš„ä¼˜ç‚¹" class="headerlink" title="dockerç›¸è¾ƒäºVMçš„ä¼˜ç‚¹"></a><strong>dockerç›¸è¾ƒäºVMçš„ä¼˜ç‚¹</strong></h3><ol><li>æ¯”VMå°ã€å¿«ï¼ŒDockerå®¹å™¨çš„å°ºå¯¸å‡å°ç›¸æ¯”äºæ•´ä¸ªè™šæ‹Ÿæœºå¤§å¤§ç®€åŒ–äº†åˆ†å¸ƒåˆ°äº‘å’Œåˆ†å‘æ—¶é—´çš„å¼€é”€ã€‚Dockerå¯åŠ¨ä¸€ä¸ªå®¹å™¨å®ä¾‹æ—¶é—´ä»…ä»…éœ€è¦å‡ ç§’é’Ÿã€‚</li><li>Dockeræ˜¯ä¸€ä¸ªå¼€æ”¾çš„å¹³å°ï¼Œæ„å»ºã€å‘å¸ƒå’Œè¿è¡Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºã€‚</li><li>å¼€å‘äººå‘˜ä¸éœ€è¦å…³ç³»å…·ä½“æ˜¯å“ªä¸ªLinuxæ“ä½œç³»ç»Ÿ</li><li>Googleã€å¾®è½¯ï¼ˆazureï¼‰ã€äºšé©¬é€Šã€IBMç­‰éƒ½æ”¯æŒdockerã€‚</li><li>Dockeræ”¯æŒUnix&#x2F;Linuxæ“ä½œç³»ç»Ÿï¼Œä¹Ÿæ”¯æŒWindowså’ŒMacã€‚</li></ol><h3 id="Dockerå±€é™æ€§"><a href="#Dockerå±€é™æ€§" class="headerlink" title="Dockerå±€é™æ€§"></a><strong>Dockerå±€é™æ€§</strong></h3><p>Dockerç”¨äºåº”ç”¨ç¨‹åºæ—¶æ˜¯æœ€æœ‰ç”¨çš„ï¼Œä½†å¹¶ä¸åŒ…å«<strong>æ•°æ®ã€æ—¥å¿—ã€æ•°æ®åº“ç­‰é€šå¸¸æ”¾åœ¨Dockerå®¹å™¨å¤–</strong>ã€‚ä¸€ä¸ªå®¹å™¨çš„é•œåƒé€šå¸¸éƒ½å¾ˆå°ï¼Œä¸ç”¨å’Œå­˜å‚¨å¤§é‡æ•°æ®ï¼Œ<strong>å­˜å‚¨å¯ä»¥é€šè¿‡å¤–éƒ¨æŒ‚è½½ç­‰æ–¹å¼ä½¿ç”¨</strong>ï¼Œæ¯”å¦‚ï¼šNFSã€ipsanã€MFSç­‰ ï¼Œæˆ–è€…<strong>dockerå‘½ä»¤ ï¼Œ-væ˜ å°„ç£ç›˜åˆ†åŒº</strong>ã€‚<br>æ€»ä¹‹ï¼Œ<strong>dockeråªç”¨äºè®¡ç®—ï¼Œå­˜å‚¨äº¤ç»™åˆ«äººã€‚</strong></p><h3 id="é€šè¿‡dockeræ¶æ„å›¾åˆæ­¥äº†è§£docker"><a href="#é€šè¿‡dockeræ¶æ„å›¾åˆæ­¥äº†è§£docker" class="headerlink" title="é€šè¿‡dockeræ¶æ„å›¾åˆæ­¥äº†è§£docker"></a>é€šè¿‡dockeræ¶æ„å›¾åˆæ­¥äº†è§£docker</h3><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807102709031.png"><br><strong>å·¥ä½œæµç¨‹ï¼š</strong>  </p><ol><li>å¯åŠ¨docker  </li><li>ä¸‹è½½é•œåƒåˆ°æœ¬åœ°  </li><li>å¯åŠ¨dockerå®¹å™¨å®ä¾‹</li></ol><p>&#x3D;&#x3D;Dockeræ ¸å¿ƒæŠ€æœ¯:&#x3D;&#x3D;  </p><ol><li>Namespace â€”&gt; å®ç°Containerçš„è¿›ç¨‹ã€ç½‘ç»œã€æ¶ˆæ¯ã€æ–‡ä»¶ç³»ç»Ÿå’Œä¸»æœºåçš„éš”ç¦»ã€‚  </li><li>Cgroup â€”&gt; å®ç°å¯¹èµ„æºçš„é…é¢å’Œè°ƒåº¦ã€‚<br>æ³¨æ„ï¼šCgroupçš„é…é¢ï¼Œå¯ä»¥æŒ‡å®šå®ä¾‹ä½¿ç”¨çš„CPUä¸ªæ•°ï¼Œå†…å­˜å¤§å°ç­‰ã€‚</li></ol><h3 id="Dockerç‰¹æ€§"><a href="#Dockerç‰¹æ€§" class="headerlink" title="Dockerç‰¹æ€§"></a>Dockerç‰¹æ€§</h3><p><strong>æ–‡ä»¶ç³»ç»Ÿéš”ç¦»</strong>ï¼šæ¯ä¸ªè¿›ç¨‹å®¹å™¨è¿è¡Œåœ¨ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„æ ¹æ–‡ä»¶ç³»ç»Ÿé‡Œã€‚<br><strong>èµ„æºéš”ç¦»</strong>ï¼šç³»ç»Ÿèµ„æºï¼ŒåƒCPUå’Œå†…å­˜ç­‰å¯ä»¥åˆ†é…åˆ°ä¸åŒçš„å®¹å™¨ä¸­ï¼Œä½¿ç”¨cgroupã€‚<br><strong>ç½‘ç»œéš”ç¦»</strong>ï¼šæ¯ä¸ªè¿›ç¨‹å®¹å™¨è¿è¡Œåœ¨è‡ªå·±çš„ç½‘è·¯ç©ºé—´ï¼Œè™šæ‹Ÿæ¥å£å’ŒIPåœ°å€ã€‚<br><strong>æ—¥å¿—è®°å½•</strong>ï¼šDockerå°†æ”¶é›†åˆ°å’Œè®°å½•çš„æ¯ä¸ªè¿›ç¨‹å®¹å™¨çš„æ ‡å‡†æµï¼ˆstdout&#x2F;stderr&#x2F;stdinï¼‰ï¼Œç”¨äºå®æ—¶æ£€ç´¢æˆ–è€…æ‰¹é‡æ£€ç´¢<br><strong>å˜æ›´ç®¡ç†</strong>ï¼šå®¹å™¨æ–‡ä»¶ç³»ç»Ÿçš„å˜æ›´å¯ä»¥æäº¤åˆ°æ–°çš„é•œåƒä¸­ï¼Œå¹¶å¯é‡å¤ä½¿ç”¨ä»¥åˆ›å»ºæ›´å¤šçš„å®¹å™¨ã€‚æ— éœ€ä½¿ç”¨æ¨¡æ¿æˆ–è€…æ‰‹åŠ¨é…ç½®ã€‚<br><strong>äº¤äº’å¼shell</strong>ï¼šDockerå¯ä»¥åˆ†é…ä¸€ä¸ªè™šæ‹Ÿç»ˆç«¯å¹¶ä¸”å…³è”åˆ°ä»»ä½•å®¹å™¨çš„æ ‡å‡†è¾“å‡ºä¸Šï¼Œä¾‹å¦‚è¿è¡Œä¸€ä¸ªä¸€æ¬¡æ€§äº¤äº’shellã€‚</p><h1 id="Dockerçš„å®‰è£…"><a href="#Dockerçš„å®‰è£…" class="headerlink" title="Dockerçš„å®‰è£…"></a>Dockerçš„å®‰è£…</h1><h2 id="docekrå®‰è£…èƒŒæ™¯"><a href="#docekrå®‰è£…èƒŒæ™¯" class="headerlink" title="docekrå®‰è£…èƒŒæ™¯"></a>docekrå®‰è£…èƒŒæ™¯</h2><p>dockerå®‰è£…çš„ä¸‰ç§æ–¹å¼,åŸºäºCentOS</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker</span><br><span class="line"></span><br><span class="line">yum -y install docker-engine</span><br><span class="line"></span><br><span class="line">yum -y install docker-ce</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å› ä¸ºDockeræœ€æ—©çš„ç‰ˆæœ¬åæ˜¯dockerå’Œdocker-enginï¼Œç°åœ¨çš„åå­—æ˜¯docker-ceå’Œdocker-eeã€‚<br><a href="https://docs.docker.com/engine/install/centos/">å®˜æ–¹å®‰è£…æ–‡æ¡£</a><a href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p><p>2017å¹´åˆï¼Œdockerå…¬å¸å°†åŸå…ˆçš„dockerå¼€æºé¡¹ç›®æ”¹åä¸ºmobyã€‚<br>mobyæ˜¯é›†æˆäº†åŸå…ˆçš„dockeré¡¹ç›®ï¼Œæ˜¯ç¤¾åŒºç»´æŠ¤çš„å¼€æºé¡¹ç›®ï¼Œè°éƒ½å¯ä»¥åœ¨mobyçš„åŸºç¡€æ‰“é€ è‡ªå·±çš„å®¹å™¨äº§å“ã€‚<br><strong>docker-ce æ˜¯dockerå…¬å¸ç»´æŠ¤çš„å¼€æºé¡¹ç›®</strong>ï¼Œæ˜¯ä¸€ä¸ªåŸºäºmobyé¡¹ç›®çš„å…è´¹å®¹å™¨äº§å“ã€‚<br><strong>docker-ee æ˜¯dockerå…¬å¸ç»´æŠ¤çš„é—­æºäº§å“</strong>ï¼Œæ˜¯dockerå…¬å¸çš„å•†ä¸šæ˜Œå¹³ã€‚<br>æ³¨ï¼šmobyæ˜¯æºä»£ç ï¼Œdocker-ce å’Œdocker-ee æ˜¯äº§å“å®¹å™¨ï¼ŒrpmåŒ…ã€‚</p><h2 id="å®‰è£…dockerä¾èµ–ç¯å¢ƒ"><a href="#å®‰è£…dockerä¾èµ–ç¯å¢ƒ" class="headerlink" title="å®‰è£…dockerä¾èµ–ç¯å¢ƒ"></a>å®‰è£…dockerä¾èµ–ç¯å¢ƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure><h2 id="é…ç½®å›½å†…docker-ceçš„yumæºï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯é˜¿é‡Œäº‘ï¼‰"><a href="#é…ç½®å›½å†…docker-ceçš„yumæºï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯é˜¿é‡Œäº‘ï¼‰" class="headerlink" title="é…ç½®å›½å†…docker-ceçš„yumæºï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯é˜¿é‡Œäº‘ï¼‰"></a>é…ç½®å›½å†…docker-ceçš„yumæºï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯é˜¿é‡Œäº‘ï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><p>yum-config-managerå‘½ä»¤ä½œç”¨æ˜¯æ·»åŠ yumæºã€‚<br>æ•²å®Œå‘½ä»¤ä¹‹åå¤§å®¶æ‰§è¡Œä¸€ä¸‹å‘½ä»¤å»çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰é…ç½®æˆåŠŸã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d</span><br><span class="line"><span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807103955873.png"></p><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker-ce doker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><p>å®‰è£…é€Ÿåº¦å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚<br>docker-ce:dockerç¨‹åº<br>docker-ce-cli:<br>å¦‚æœä¸çŸ¥é“åŒ…åçš„ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨yum info ç¨‹åº å‘½ä»¤æŸ¥çœ‹</p><h2 id="å¼€å¯ç½‘ç»œè½¬å‘åŠŸèƒ½"><a href="#å¼€å¯ç½‘ç»œè½¬å‘åŠŸèƒ½" class="headerlink" title="å¼€å¯ç½‘ç»œè½¬å‘åŠŸèƒ½"></a>å¼€å¯ç½‘ç»œè½¬å‘åŠŸèƒ½</h2><p>é»˜è®¤ä¼šè‡ªåŠ¨å¼€å¯ã€‚<br>è·¯å¾„ ï¼š&#x3D;&#x3D;&#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;ip_forward&#x3D;&#x3D;<br>æ‰‹åŠ¨å¼€å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysctl.conf   <span class="comment">#æ’å…¥ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">net.ipv4.forward =1</span><br><span class="line">-------------------------</span><br><span class="line">sysctl -p   <span class="comment">#ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">cat</span> /proc/sys/net/ipv4/ip_forward  <span class="comment">#æŸ¥çœ‹ç»“æœï¼Œä¸º1å¼€å¯æˆåŠŸã€‚</span></span><br></pre></td></tr></table></figure><p><strong>å¦‚æœæ²¡æœ‰å¼€å¯ç½‘ç»œè½¬å‘ï¼Œæˆ‘ä»¬å¯åŠ¨å®ä¾‹çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼ï¼ï¼</strong></p><p>å…³é—­é˜²ç«å¢™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iptables -nL <span class="comment">#æŸ¥çœ‹ä¸€ä¸‹iptableè§„åˆ™ï¼Œå…³é—­é˜²ç«å¢™åä¼šè‡ªåŠ¨æ’å…¥æ–°è§„åˆ™</span></span><br><span class="line"></span><br><span class="line">systemctl stop firewalld &amp;&amp; systemctl <span class="built_in">disable</span> firewalld  <span class="comment">#å…³é—­é˜²ç«å¢™</span></span><br><span class="line"></span><br><span class="line">sysctlrem restart docker <span class="comment"># å…³é—­é˜²ç«å¢™è¦æŠŠdockeré‡å¯ä¸€ä¸‹ï¼Œä¸ç„¶docker</span></span><br><span class="line">çš„ipåŒ…è½¬å‘åŠŸèƒ½æ— æ³•ä½¿ç”¨ã€‚å³ä¾¿é˜²ç«å¢™å…³é—­äº†ï¼Œdockerä¾æ—§ä¼šè°ƒç”¨å†…æ ¸æ¨¡å—netfilterå¢åŠ è§„åˆ™ï¼Œæ‰€ä»¥ä¼šæ–°å¢iptablesè§„åˆ™</span><br><span class="line"></span><br><span class="line">iptables -nL <span class="comment">#å†æŸ¥çœ‹ä¸€ä¸‹iptableè§„åˆ™ï¼Œä¼šå‘ç°å¤šå‡ºå¾ˆå¤šè§„åˆ™</span></span><br></pre></td></tr></table></figure><p>iptables -nL<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807103924653.png"></p><h2 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker &amp;&amp; systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><p>å¯åŠ¨å®Œæˆåä¼šè¯¥ç½‘ç»œå‚æ•°ï¼Œè¿™ä¸ªæ˜¯ipè½¬å‘ä¼šæ”¹æˆ1ã€‚é»˜è®¤0</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸ŠæŒ‡ä»¤ä¼šæ˜¾ç¤º1</p><h2 id="æŸ¥çœ‹docekrç‰ˆæœ¬"><a href="#æŸ¥çœ‹docekrç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹docekrç‰ˆæœ¬"></a>æŸ¥çœ‹docekrç‰ˆæœ¬</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docekr version</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807104346663.png"><br>è¿™é‡Œæˆ‘ä»¬å¾ˆæ¸…æ™°çš„å¯ä»¥çœ‹åˆ°dockeræ˜¯ä¸€ä¸ªC&#x2F;Sæ¶æ„çš„æ¨¡å¼ã€‚å®¢æˆ·ç«¯æ˜¯æˆ‘ä»¬çš„å‘½ä»¤è¡Œæ“ä½œï¼ŒæœåŠ¡ç«¯æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ã€‚</p><h2 id="æŸ¥çœ‹docekrä¿¡æ¯"><a href="#æŸ¥çœ‹docekrä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹docekrä¿¡æ¯"></a>æŸ¥çœ‹docekrä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡&#x3D;&#x3D;docker info&#x3D;&#x3D;çœ‹åˆ°æœºå™¨å­˜æ”¾dockeré•œåƒå¾—åœ°å€ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°dockerä»“åº“çš„åœ°å€ã€‚<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807104457352.png"></p><h1 id="dockerå…¥é—¨å‘½ä»¤"><a href="#dockerå…¥é—¨å‘½ä»¤" class="headerlink" title="dockerå…¥é—¨å‘½ä»¤"></a>dockerå…¥é—¨å‘½ä»¤</h1><h2 id="æœç´¢é•œåƒ"><a href="#æœç´¢é•œåƒ" class="headerlink" title="æœç´¢é•œåƒ"></a>æœç´¢é•œåƒ</h2><p>docker search</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search centos <span class="comment">#ä»docker hubä¸­æœç´¢dockeråä¸ºcentosçš„é•œåƒ</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807104620704.png"><br><strong>name</strong>:ä»£è¡¨æ­¤é•œåƒçš„åç§°<br><strong>description</strong>ï¼šæ­¤é•œåƒçš„æè¿°<br><strong>stars</strong>ï¼šä¸‹è½½æ¬¡æ•°<br><strong>official</strong>ï¼šæ˜¯å¦ç”±å®˜æ–¹æä¾›ï¼ˆå®˜æ–¹æä¾›å¯æ”¾å¿ƒä¸‹è½½ï¼Œå¯ä»¥åŸºäºæ­¤é•œåƒåšè‡ªå·±çš„é•œåƒï¼‰</p><h2 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h2><p>&#x3D;&#x3D;docker pull&#x3D;&#x3D;Â ï¼Œé»˜è®¤æ˜¯æ‹‰å»docker hubä¸Šæœç´¢åˆ°çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆç¬¬ä¸€ä¸ªï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807104728893.png">æ³¨æ„ï¼Œå¦‚æœè¿™é‡ŒæŠ¥é”™ï¼ŒTLS handshake timeoutï¼Œé‚£å°±æ˜¯ç½‘ç»œåŸå› å¯¼è‡´è¶…æ—¶ï¼Œå°è¯•å¤špullå‡ æ¬¡ã€‚ä¸‹é¢ä»‹ç»é…ç½®é•œåƒåŠ é€Ÿ<br>&#x3D;&#x3D;ä½¿ç”¨é˜¿é‡Œäº‘dockeré•œåƒåŠ é€Ÿå™¨ã€‚&#x3D;&#x3D;  </p><p>åœ°å€ï¼š<strong><a href="https://cr.console.aliyun.com/">https://cr.console.aliyun.com</a></strong>çš„æ§åˆ¶å°ï¼Œä½¿ç”¨æ”¯ä»˜å®è´¦å·ç™»å½•ï¼Œå·¦ä¾§åŠ é€Ÿå™¨å¸®åŠ©é¡µé¢ä¼šä¸ºä½ æ˜¾ç¤º<strong>ç‹¬ç«‹çš„åŠ é€Ÿåœ°å€</strong>ï¼Œè¿™ä¸ªåŠ é€Ÿåœ°å€æ¯ä¸ªäººçš„éƒ½ä¸åŒã€‚</p><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807104844697.png"><br><strong>å¯ä»¥é€šè¿‡ä¿®æ”¹daemoné…ç½®æ–‡ä»¶&#x2F;etc&#x2F;docker&#x2F;daemon.jsonæ¥ä½¿ç”¨åŠ é€Ÿå™¨ã€‚<br>æŠŠè‡ªå·±çš„ä¸“å±åŠ é€Ÿåœ°å€æ”¾åˆ°ä¸‹é¢çš„åœ°å€æ”¹ä¸€ä¸‹ï¼Œå†™å…¥æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://eu5rxjvf.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload  <span class="comment">#å¯åŠ¨é…ç½®</span></span><br><span class="line">systemctl restart docker  <span class="comment">#é‡å¯dockeræœåŠ¡</span></span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹é•œåƒ"><a href="#æŸ¥çœ‹é•œåƒ" class="headerlink" title="æŸ¥çœ‹é•œåƒ"></a>æŸ¥çœ‹é•œåƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images  <span class="comment">#æŸ¥çœ‹å·²ä¸‹è½½é•œåƒã€‚</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807105132574.png"></p><h2 id="å‹ç¼©åŒ…taré•œåƒå¯¼å…¥é•œåƒ"><a href="#å‹ç¼©åŒ…taré•œåƒå¯¼å…¥é•œåƒ" class="headerlink" title="å‹ç¼©åŒ…taré•œåƒå¯¼å…¥é•œåƒ"></a>å‹ç¼©åŒ…taré•œåƒå¯¼å…¥é•œåƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load -i /root/docker-centos-httpd.tar</span><br></pre></td></tr></table></figure><h1 id="dockerå‘½ä»¤å°ç»“"><a href="#dockerå‘½ä»¤å°ç»“" class="headerlink" title="dockerå‘½ä»¤å°ç»“"></a>dockerå‘½ä»¤å°ç»“</h1><h2 id="å¸®åŠ©å‘½ä»¤"><a href="#å¸®åŠ©å‘½ä»¤" class="headerlink" title="å¸®åŠ©å‘½ä»¤"></a>å¸®åŠ©å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version     <span class="comment">#æ˜¾ç¤ºdockerè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">docker info       <span class="comment">#æ˜¾ç¤ºdockerçš„ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨çš„æ•°é‡</span></span><br><span class="line">docker --<span class="built_in">help</span>     <span class="comment">#dockerå¸®åŠ©å‘½ä»¤æ‰‹å†Œ</span></span><br></pre></td></tr></table></figure><h2 id="é•œåƒå‘½ä»¤"><a href="#é•œåƒå‘½ä»¤" class="headerlink" title="é•œåƒå‘½ä»¤"></a>é•œåƒå‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">docker images  <span class="comment">#æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°ä¸»æœºçš„é•œåƒ</span></span><br><span class="line">docker search é•œåƒå           <span class="comment">#æœç´¢é•œåƒ</span></span><br><span class="line">docker pull é•œåƒå [æ ‡ç­¾]      <span class="comment">#ä¸‹è½½é•œåƒï¼ˆå¦‚æœä¸å†™tagï¼Œé»˜è®¤æ˜¯latestï¼‰</span></span><br><span class="line">docker rmi é•œåƒå [æ ‡ç­¾]       <span class="comment">#åˆ é™¤é•œåƒ    docker rmi -f $(docker images -aq)  åˆ é™¤å…¨éƒ¨é•œåƒ</span></span><br><span class="line">docker tag  é•œåƒå:ç‰ˆæœ¬   æ–°é•œåƒå:ç‰ˆæœ¬    <span class="comment">#å¤åˆ¶é•œåƒå¹¶ä¸”ä¿®æ”¹åç§°</span></span><br><span class="line">docker commit  -a <span class="string">&quot;xxx&quot;</span>  -c <span class="string">&quot;xxx&quot;</span> é•œåƒID åå­—ï¼šç‰ˆæœ¬   <span class="comment">#æäº¤é•œåƒ </span></span><br><span class="line">-a :æäº¤çš„é•œåƒä½œè€…ï¼›</span><br><span class="line">-c :ä½¿ç”¨DockerfileæŒ‡ä»¤æ¥åˆ›å»ºé•œåƒï¼›</span><br><span class="line">-m :æäº¤æ—¶çš„è¯´æ˜æ–‡å­—ï¼›</span><br><span class="line"></span><br><span class="line">docker load -i    /xxx/xxx.tar         <span class="comment">#å¯¼å…¥é•œåƒ</span></span><br><span class="line">docker save -o   /xxx/xxx.tar          <span class="comment">#ä¿å­˜ä¸€ä¸ªé•œåƒä¸ºä¸€ä¸ªtaråŒ…</span></span><br></pre></td></tr></table></figure><h2 id="å®¹å™¨å‘½ä»¤"><a href="#å®¹å™¨å‘½ä»¤" class="headerlink" title="å®¹å™¨å‘½ä»¤"></a>å®¹å™¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">docker run [å¯é€‰å‚æ•°] image å‘½ä»¤ <span class="comment">#å¯åŠ¨å®¹å™¨ï¼ˆæ— é•œåƒä¼šå…ˆä¸‹è½½é•œåƒï¼‰</span></span><br><span class="line"><span class="comment">#å‚æ•°è¯´æ˜</span></span><br><span class="line">--name = <span class="string">&quot;Name&quot;</span>   å®¹å™¨åå­—</span><br><span class="line">-c   åé¢è·Ÿå¾…å®Œæˆçš„å‘½ä»¤</span><br><span class="line">-d   ä»¥åå°æ–¹å¼è¿è¡Œå¹¶ä¸”è¿”å›IDï¼Œå¯åŠ¨å®ˆæŠ¤è¿›ç¨‹å¼å®¹å™¨</span><br><span class="line">-i   ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸tåŒæ—¶ä½¿ç”¨</span><br><span class="line">-t   ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ã€‚ä¹Ÿå³å¯åŠ¨äº¤äº’å¼å®¹å™¨</span><br><span class="line">-p   æŒ‡å®šå®¹å™¨ç«¯å£    -p å®¹å™¨ç«¯å£:ç‰©ç†æœºç«¯å£  æ˜ å°„ç«¯å£</span><br><span class="line">-P   éšæœºæŒ‡å®šç«¯å£</span><br><span class="line">-v   ç»™å®¹å™¨æŒ‚è½½å­˜å‚¨å·</span><br><span class="line"></span><br><span class="line">docker build  <span class="comment">#åˆ›å»ºé•œåƒ        -fï¼šæŒ‡å®šdockerfileæ–‡ä»¶è·¯å¾„   -tï¼šé•œåƒåå­—ä»¥åŠæ ‡ç­¾</span></span><br><span class="line">docker logs å®¹å™¨å®ä¾‹çš„ID          <span class="comment">#æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span></span><br><span class="line">docker rename æ—§åå­—  æ–°åå­—      <span class="comment"># ç»™å®¹å™¨é‡æ–°å‘½å</span></span><br><span class="line">docker top    å®¹å™¨å®ä¾‹çš„ID                  <span class="comment">#æŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹</span></span><br><span class="line">docker ps -a                    <span class="comment">#åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆä¸åŠ -aå°±æ˜¯åœ¨è¿è¡Œçš„ï¼‰</span></span><br><span class="line">docker <span class="built_in">rm</span>      å®¹å™¨å®ä¾‹çš„ID                 <span class="comment">#åˆ é™¤å®¹å™¨ï¼ˆæ­£åœ¨è¿è¡Œå®¹å™¨ä¸èƒ½åˆ é™¤ï¼Œé™¤éåŠ -fé€‰é¡¹ï¼‰</span></span><br><span class="line">docker <span class="built_in">kill</span>  å®¹å™¨å®ä¾‹çš„ID        <span class="comment">#æ€æ‰å®¹å™¨</span></span><br><span class="line">docker <span class="built_in">history</span>   å®¹å™¨å®ä¾‹çš„ID    <span class="comment">#æŸ¥çœ‹dockeré•œåƒçš„å˜æ›´å†å²</span></span><br><span class="line">docker start å®¹å™¨å®ä¾‹çš„ID        <span class="comment">#å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker restart å®¹å™¨å®ä¾‹çš„ID       <span class="comment">#é‡å¯å®¹å™¨</span></span><br><span class="line">docker stop å®¹å™¨å®ä¾‹çš„ID         <span class="comment">#åœæ­¢æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">docker attach /docker <span class="built_in">exec</span>  å®¹å™¨å®ä¾‹çš„ID   <span class="comment">#åŒä¸ºè¿›å…¥å®¹å™¨å‘½ä»¤ï¼Œä¸åŒçš„æ˜¯attachè¿æ¥ç»ˆæ­¢ä¼šè®©å®¹å™¨é€€å‡ºåå°è¿è¡Œï¼Œè€Œexecä¸ä¼šã€‚å¹¶ä¸”ï¼Œdocker attachæ˜¯è¿›å…¥æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šæƒ…åŠ¨æ–°çš„è¿›ç¨‹ï¼Œè€Œdocker execåˆ™ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¯ä»¥åœ¨é‡Œé¢æ“ä½œã€‚</span></span><br><span class="line">docker image inspect  å®¹å™¨åç§°ï¼šå®¹å™¨æ ‡ç­¾       <span class="comment">#æŸ¥çœ‹å®¹å™¨å†…æºæ•°æ®</span></span><br><span class="line">docker <span class="built_in">cp</span>  å®¹å™¨<span class="built_in">id</span>ï¼šå®¹å™¨å†…è·¯å¾„   ç›®çš„ä¸»æœºè·¯å¾„           <span class="comment">#ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºï¼ˆå¸¸ç”¨ï¼‰æˆ–è€…ä»ä¸»æœºæ‹·è´åˆ°å®¹å™¨ï¼ˆä¸€èˆ¬ç”¨æŒ‚è½½ï¼‰</span></span><br><span class="line"><span class="built_in">exit</span>                           <span class="comment">#ç›´æ¥é€€å‡ºå®¹å™¨ </span></span><br><span class="line">crlt + P + Q                   <span class="comment">#é€€å‡ºå®¹å™¨ä½†æ˜¯ä¸ç»ˆæ­¢è¿è¡Œ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Dockerå®¹å™¨æ•°æ®å·"><a href="#Dockerå®¹å™¨æ•°æ®å·" class="headerlink" title="Dockerå®¹å™¨æ•°æ®å·"></a>Dockerå®¹å™¨æ•°æ®å·</h1><h2 id="å®¹å™¨æ•°æ®å·ä»‹ç»ã€‚"><a href="#å®¹å™¨æ•°æ®å·ä»‹ç»ã€‚" class="headerlink" title="å®¹å™¨æ•°æ®å·ä»‹ç»ã€‚"></a>å®¹å™¨æ•°æ®å·ä»‹ç»ã€‚</h2><p>dockerå®¹å™¨åœ¨äº§ç”Ÿæ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœä¸é€šè¿‡docker commitç”Ÿæˆæ–°çš„é•œåƒï¼Œä½¿å¾—æ•°æ®ä½œä¸ºé•œåƒçš„ä¸€éƒ¨åˆ†ä¿å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆå½“å®¹å™¨åˆ é™¤ä¹‹åï¼Œæ•°æ®è‡ªç„¶è€Œç„¶çš„ä¹Ÿä¼šæ¶ˆå¤±ã€‚ä¸ºäº†èƒ½ä¿å­˜æ•°æ®ï¼Œå®¹å™¨ä¸­å¼•ç”¨äº†<strong>æ•°æ®å·</strong>çš„æ¦‚å¿µã€‚</p><h2 id="ä½œç”¨ä»¥åŠç‰¹ç‚¹"><a href="#ä½œç”¨ä»¥åŠç‰¹ç‚¹" class="headerlink" title="ä½œç”¨ä»¥åŠç‰¹ç‚¹"></a>ä½œç”¨ä»¥åŠç‰¹ç‚¹</h2><p>å·å°±æ˜¯<strong>ç›®å½•æˆ–è€…æ–‡ä»¶</strong>ï¼Œå­˜åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ä¹‹ä¸­ï¼Œç”±dockeræŒ‚è½½åˆ°å®¹å™¨ï¼Œä½†æ˜¯ä¸å±äºè”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤èƒ½å¤Ÿç»•è¿‡Union File Systemæä¾›ä¸€äº›ç”¨äºæŒç»­å­˜å‚¨æˆ–è€…å…±äº«æ•°æ®çš„ç‰¹æ€§ã€‚</p><p>å·çš„è®¾è®¡ç›®çš„å°±æ˜¯<strong>æ•°æ®çš„æŒä¹…åŒ–</strong>ï¼Œ<strong>å®Œå…¨ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå­˜å‘¨æœŸ</strong>ï¼Œå› æ­¤dockerä¸ä¼šå†å®¹å™¨åˆ é™¤æ—¶åˆ é™¤å…¶æŒ‚è½½çš„æ•°æ®å·ã€‚</p><p>å®ƒè¿˜å­˜åœ¨ä»¥ä¸‹å‡ ç§ç‰¹ç‚¹ï¼š</p><ol><li>æ•°æ®å·å¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–è€…é‡ç”¨æ•°æ®ã€‚</li><li>å·ä¸­çš„æ›´æ”¹å¯ä»¥ç›´æ¥ç”Ÿæ•ˆã€‚</li><li>æ•°æ®å·ä¸­çš„æ›´æ”¹ä¸ä¼šåŒ…å«åœ¨é•œåƒçš„æ›´æ–°ä¸­ã€‚</li><li>æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢ã€‚</li></ol><h2 id="ä½¿ç”¨æ•°æ®å·"><a href="#ä½¿ç”¨æ•°æ®å·" class="headerlink" title="ä½¿ç”¨æ•°æ®å·"></a>ä½¿ç”¨æ•°æ®å·</h2><p>ç›´æ¥ä½¿ç”¨å‘½ä»¤æ¥æŒ‚è½½ ï¼Œ -v</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v ä¸»æœºç›®å½•:å®¹å™¨ç›®å½• /bin/bash</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨åˆ›å»ºå®¹å™¨ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹æŒ‚è½½è·¯å¾„ä¸Šæœ‰æ²¡æœ‰test01è¿™ä¸ªç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ˜¯æ²¡æœ‰çš„ã€‚æ‰§è¡Œå‘½ä»¤ä¹‹åè¿›å…¥åˆ°å®¹å™¨å†…ï¼Œæˆ‘ä»¬lsçœ‹ä¸€ä¸‹å®¹å™¨çš„homeç›®å½•ï¼Œæ˜¯ç©ºçš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v /home/test01:/home centos /bin/bash</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807110422690.png"><br>å¦å¤–æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œcd &#x2F;homeç›®å½•ï¼Œè¿™ä¸‹æˆ‘ä»¬å‘ç°å¤šå‡ºæ¥äº†ä¸€ä¸ªtest01ç›®å½•ï¼Œè¿™ä¸ªtest01ç›®å½•ï¼Œå°±æ˜¯æˆ‘ä»¬åˆšåˆšå¯åŠ¨çš„å®¹å™¨å†…éƒ¨çš„homeç›®å½•ï¼Œå¹¶ä¸”ï¼Œæ­¤æ—¶è¿™ä¸¤ä¸ªç›®å½•æ˜¯åŒæ­¥çš„çŠ¶æ€ï¼Œæˆ‘ä»¬åœ¨homeç›®å½•ä¸­å†™å…¥ä»»ä½•æ–°çš„æ–‡ä»¶ï¼Œéƒ½ä¼šåŒæ­¥åˆ°ä¸»æœºhomeç›®å½•ä¸‹çš„test01ç›®å½•ã€‚<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807110618598.png" alt="|500"></p><p>æµ‹è¯•ï¼Œè¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œechoè¿›å»ä¸€ä¸ªa.txtæ–‡ä»¶<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807110716069.png"><br>ç„¶åæ¥åˆ°å®¿ä¸»æœºä¸Šï¼Œçœ‹ä¸€çœ¼æ˜¯ä¸æ˜¯test01ç›®å½•ä¸‹ä¹Ÿå‡ºç°äº†a.txtã€‚(åŒå‘ç»‘å®š)<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807110813578.png"></p><p><strong>docker inspect å®¹å™¨ID</strong>æŸ¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸï¼Œæ‰¾åˆ°è¿™ä¸ª&#x3D;&#x3D;Mounts&#x3D;&#x3D;ï¼Œå®ƒä»£è¡¨ç€æŒ‚è½½ï¼Œ<strong>type</strong>æ˜¯ç±»å‹ï¼ˆç»‘å®šï¼‰ï¼Œ<strong>source</strong>æ˜¯æºï¼ˆ&#x2F;home&#x2F;test01ï¼‰ï¼Œä¹Ÿå°±æ˜¯æŠŠä»€ä¹ˆæŒ‚è½½åˆ°å“ªé‡Œã€‚<strong>destination</strong>ï¼ˆhomeï¼‰å°±æ˜¯æŒ‚è½½çš„ç›®æ ‡è·¯å¾„äº†ã€‚<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807110944606.png"></p><h2 id="docekrçš„åŒ¿åæŒ‚è½½å’Œå…·åæŒ‚è½½"><a href="#docekrçš„åŒ¿åæŒ‚è½½å’Œå…·åæŒ‚è½½" class="headerlink" title="docekrçš„åŒ¿åæŒ‚è½½å’Œå…·åæŒ‚è½½"></a>docekrçš„åŒ¿åæŒ‚è½½å’Œå…·åæŒ‚è½½</h2><h3 id="åŒ¿åæŒ‚è½½ï¼ˆAnonymous-Volumeï¼‰"><a href="#åŒ¿åæŒ‚è½½ï¼ˆAnonymous-Volumeï¼‰" class="headerlink" title="åŒ¿åæŒ‚è½½ï¼ˆAnonymous Volumeï¼‰"></a>åŒ¿åæŒ‚è½½ï¼ˆAnonymous Volumeï¼‰</h3><ul><li><strong>ç‰¹ç‚¹</strong>ï¼šåªæŒ‡å®šå®¹å™¨å†…çš„æŒ‚è½½è·¯å¾„ï¼Œä¸æŒ‡å®šå®¿ä¸»æœºçš„è·¯å¾„æˆ–å·åï¼ŒDocker ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºçš„å·åã€‚</li><li><strong>ä½œç”¨</strong>ï¼šä¸´æ—¶æˆ–ç®€å•åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ— éœ€å…³å¿ƒæ•°æ®åœ¨å®¿ä¸»æœºçš„å…·ä½“å­˜å‚¨ä½ç½®ï¼Œç”± Docker è‡ªåŠ¨ç®¡ç†ã€‚</li><li><strong>ç¤ºä¾‹</strong>ï¼š  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼ï¼šdocker run -v å®¹å™¨å†…è·¯å¾„ ...</span></span><br><span class="line">docker run -d -v /app/data --name mycontainer nginx</span><br></pre></td></tr></table></figure>  æ­¤æ—¶ Docker ä¼šåˆ›å»ºä¸€ä¸ªéšæœºåç§°çš„å·ï¼ˆå¦‚<code>abcd1234...</code>ï¼‰ï¼Œå¹¶å°†å®¹å™¨å†…çš„<code>/app/data</code>ç›®å½•ä¸è¯¥å·å…³è”ã€‚</li></ul><h3 id="å…·åæŒ‚è½½ï¼ˆNamed-Volumeï¼‰"><a href="#å…·åæŒ‚è½½ï¼ˆNamed-Volumeï¼‰" class="headerlink" title="å…·åæŒ‚è½½ï¼ˆNamed Volumeï¼‰"></a>å…·åæŒ‚è½½ï¼ˆNamed Volumeï¼‰</h3><ul><li><strong>ç‰¹ç‚¹</strong>ï¼šä¸ºæ•°æ®å·æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰åç§°ï¼Œä¾¿äºç®¡ç†å’Œå¤ç”¨ï¼ŒåŒæ ·ä¸éœ€è¦æŒ‡å®šå®¿ä¸»æœºçš„å…·ä½“è·¯å¾„ï¼ˆè·¯å¾„ç”± Docker ç®¡ç†ï¼‰ã€‚</li><li><strong>ä½œç”¨</strong>ï¼šéœ€è¦å¤šæ¬¡ä½¿ç”¨åŒä¸€æ•°æ®å·ï¼ˆå¦‚å¤šä¸ªå®¹å™¨å…±äº«æ•°æ®ï¼‰ï¼Œæˆ–éœ€è¦æ˜¾å¼ç®¡ç†å·ï¼ˆå¦‚å¤‡ä»½ã€åˆ é™¤ï¼‰æ—¶ä½¿ç”¨ã€‚</li><li><strong>ç¤ºä¾‹</strong>ï¼š  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼ï¼šdocker run -v å·å:å®¹å™¨å†…è·¯å¾„ ...</span></span><br><span class="line">docker run -d -v mydata:/app/data --name mycontainer nginx</span><br></pre></td></tr></table></figure>  è¿™é‡Œåˆ›å»ºäº†åä¸º<code>mydata</code>çš„å·ï¼Œå®¹å™¨å†…<code>/app/data</code>çš„æ•°æ®ä¼šå­˜å‚¨åœ¨è¯¥å·ä¸­ï¼Œåç»­å…¶ä»–å®¹å™¨ä¹Ÿå¯é€šè¿‡<code>mydata</code>å·å…±äº«æ•°æ®ã€‚</li></ul><h3 id="ä¸¤è€…çš„å…±åŒç‚¹ä¸åŒºåˆ«"><a href="#ä¸¤è€…çš„å…±åŒç‚¹ä¸åŒºåˆ«" class="headerlink" title="ä¸¤è€…çš„å…±åŒç‚¹ä¸åŒºåˆ«"></a>ä¸¤è€…çš„å…±åŒç‚¹ä¸åŒºåˆ«</h3><table><thead><tr><th>ç‰¹æ€§</th><th>åŒ¿åæŒ‚è½½</th><th>å…·åæŒ‚è½½</th></tr></thead><tbody><tr><td>å·æ ‡è¯†</td><td>éšæœºç”Ÿæˆçš„ ID</td><td>è‡ªå®šä¹‰åç§°</td></tr><tr><td>ç®¡ç†éš¾åº¦</td><td>è¾ƒéš¾ï¼ˆéœ€è®°ä½éšæœº IDï¼‰</td><td>ç®€å•ï¼ˆé€šè¿‡åç§°æ“ä½œï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ä¸´æ—¶æ•°æ®ã€ä¸€æ¬¡æ€§ä½¿ç”¨</td><td>é•¿æœŸå¤ç”¨ã€å¤šå®¹å™¨å…±äº«</td></tr><tr><td>æŸ¥çœ‹å·ä¿¡æ¯</td><td><code>docker volume ls</code>Â å¯è§</td><td><code>docker volume ls</code>Â å¯è§</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="è¡¥å……è¯´æ˜"><a href="#è¡¥å……è¯´æ˜" class="headerlink" title="è¡¥å……è¯´æ˜"></a>è¡¥å……è¯´æ˜</h3><ul><li>æ— è®ºæ˜¯åŒ¿åè¿˜æ˜¯å…·åæŒ‚è½½ï¼Œæ•°æ®å·çš„å®é™…å­˜å‚¨è·¯å¾„éƒ½ç”± Docker ç®¡ç†ï¼ˆé€šå¸¸åœ¨<code>/var/lib/docker/volumes/</code>ç›®å½•ä¸‹ï¼‰ã€‚</li><li>è‹¥éœ€è¦æŒ‡å®šå®¿ä¸»æœºçš„å…·ä½“è·¯å¾„è¿›è¡ŒæŒ‚è½½ï¼ˆç»‘å®šæŒ‚è½½ï¼‰ï¼Œæ ¼å¼ä¸º<code>-v å®¿ä¸»æœºè·¯å¾„:å®¹å™¨å†…è·¯å¾„</code>ï¼Œè¿™ä¸ä¸Šè¿°ä¸¤ç§æ–¹å¼ä¸åŒã€‚</li></ul><p>é€šè¿‡è¿™ä¸¤ç§æŒ‚è½½æ–¹å¼ï¼Œå¯æœ‰æ•ˆå®ç°å®¹å™¨æ•°æ®çš„æŒä¹…åŒ–å’Œå…±äº«ï¼Œé¿å…å®¹å™¨åˆ é™¤åæ•°æ®ä¸¢å¤±ã€‚</p><h1 id="Dockerç½‘ç»œ"><a href="#Dockerç½‘ç»œ" class="headerlink" title="Dockerç½‘ç»œ"></a>Dockerç½‘ç»œ</h1><h2 id="æœ¬æœºç½‘ç»œç†è§£"><a href="#æœ¬æœºç½‘ç»œç†è§£" class="headerlink" title="æœ¬æœºç½‘ç»œç†è§£"></a>æœ¬æœºç½‘ç»œç†è§£</h2><p>æˆ‘ä»¬ä½¿ç”¨ifconfigå¯ä»¥çœ‹åˆ°ä¸‰ç»„ç½‘ç»œã€‚<br>é¦–å…ˆæ˜¯docker0ï¼Œè¿™æ˜¯æˆ‘ä»¬æœ¬èŠ‚çš„é‡ç‚¹ï¼Œdockerçš„ç½‘ç»œã€‚ä¹‹åæ˜¯eth0ï¼Œæœ¬æœºçš„å¤–ç½‘åœ°å€ã€‚loå£ï¼Œæœ¬åœ°ç¯å›åœ°å€ï¼Œå¯ä»¥ä»£è¡¨localhost<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807112327073.png"><br>å…³äºdocker0å‘¢ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå«docker0çš„è™šæ‹Ÿç½‘æ¡¥ã€‚æˆ‘ä»¬ä½¿ç”¨brctlå‘½ä»¤æ¥æŸ¥çœ‹ä¸€ä¸‹ã€‚ï¼ˆæ²¡æœ‰è¿™ä¸ªå‘½ä»¤çš„ä¸‹è½½<strong>yum -y install bridge-utils</strong>ï¼‰<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807112944921.png"></p><h2 id="veth-pairæŠ€æœ¯"><a href="#veth-pairæŠ€æœ¯" class="headerlink" title="veth-pairæŠ€æœ¯"></a>veth-pairæŠ€æœ¯</h2><p>ä»€ä¹ˆæ˜¯veth-pairæŠ€æœ¯ï¼Ÿè¦ç†è§£å®ƒï¼Œæˆ‘ä»¬é¦–å…ˆæ¥å¯åŠ¨ä¸¤ä¸ªtomcatå®¹å™¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -P --name=tomcat01 tomcat:7</span><br><span class="line">docker run -d -P --name=tomcat02 tomcat:7</span><br><span class="line">æç¤ºï¼šé€‰æ‹©tomcat7æ˜¯å› ä¸ºè¿™ä¸ªé•œåƒåŒ…å«äº†ip addr ç­‰å¸¸ç”¨å‘½ä»¤ï¼</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœºå™¨ä¹‹åï¼Œæˆ‘ä»¬æŸ¥çœ‹å®¹å™¨ipï¼Œé€šè¿‡å®¹å™¨çš„ip å»pingå®¿ä¸»æœºipï¼Œå‘ç°æ˜¯é€šçš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it tomcat01 ip addr</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113155934.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 172.17.0.3</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113216441.png"><br>ç†è§£ï¼šæˆ‘ä»¬æ¯å¯åŠ¨ä¸€ä¸ªdockerå®¹å™¨ï¼Œdockerå°±ä¼šç»™dockerå®¹å™¨åˆ†é…ä¸€ä¸ªipï¼Œå®‰è£…dockerä¹‹åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªå«docker0çš„ç½‘å¡ï¼Œè¿™é‡Œä½¿ç”¨çš„å°±æ˜¯<strong>veth-pairæŠ€æœ¯</strong>ã€‚</p><p>ä½¿ç”¨ip addrå‘½ä»¤ï¼ŒæŸ¥çœ‹æˆ‘ä»¬çš„ç½‘å¡ã€‚<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113316103.png"><br>æˆ‘ä»¬å‘ç°å¤šå‡ºæ¥äº†ä¸¤ä¸ªç½‘å¡ï¼Œåˆ°äº†è¿™é‡Œï¼Œä½ å·²ç»çŸ¥é“è¿™ä¸¤å¼ ç½‘å¡æ˜¯é‚£é‡Œæ¥çš„äº†å§ã€‚æ²¡é”™ï¼Œæ˜¯å¯åŠ¨å®¹å™¨ä¹‹åäº§ç”Ÿçš„ï¼æˆ‘ä»¬å›è¿‡å¤´æ¥æŸ¥çœ‹æˆ‘ä»¬åœ¨å¯åŠ¨çš„å®¹å™¨IPï¼Œå°±ä¼šå¾ˆæ¸…æ™°çš„å‘ç°ï¼Œè¿™ä¸ªç½‘å¡æ˜¯æˆå¯¹å­˜åœ¨çš„ï¼å®¹å™¨å†…çš„64å¯¹åº”ç€å®¿ä¸»æœºçš„65ï¼Œå®¹å™¨å†…çš„66å¯¹åº”å®¿ä¸»æœºçš„67ã€‚</p><p>ä»€ä¹ˆæ˜¯&#x3D;&#x3D;veth-pairï¼Ÿ&#x3D;&#x3D;<br>veth-pair å°±æ˜¯ä¸€å †çš„è™šæ‹Ÿè®¾å¤‡æ¥å£ï¼Œä»–ä»¬éƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œä¸€ç«¯è¿æ¥ç€åè®®ï¼Œä¸€ç«¯è¿æ¥ç€å½¼æ­¤ã€‚ä½¿å¾—å®ƒå……å½“äº†ä¸€ä¸ªæ¡¥æ¢çš„ä½œç”¨ã€‚<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113355249.png"></p><h2 id="dockerç½‘ç»œè¯¦è§£"><a href="#dockerç½‘ç»œè¯¦è§£" class="headerlink" title="dockerç½‘ç»œè¯¦è§£"></a>dockerç½‘ç»œè¯¦è§£</h2><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113421311.png"><br>ä¸éš¾çœ‹å‡ºï¼Œtomcat01å’Œtomcat02æ˜¯å…±ç”¨çš„åŒä¸€ä¸ªè·¯ç”±å™¨ï¼Œå³docker0ã€‚æ‰€æœ‰çš„å®¹å™¨åœ¨ä¸æŒ‡å®šæˆ‘ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯docker0è·¯ç”±çš„ï¼Œdocekrä¼šç»™æˆ‘ä»¬çš„å®¹å™¨åˆ†é…ä¸€ä¸ªé»˜è®¤IPã€‚<br>dockerç½‘ç»œå°±æ˜¯ä¸‹é¢è¿™ä¸ªç½‘ç»œæ¨¡å‹æ‰€æè¿°çš„ã€‚ï¼ˆdockeræ‰€æœ‰çš„ç½‘ç»œæ¥å£éƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œè™šæ‹Ÿçš„è½¬å‘æ•ˆç‡é«˜ï¼‰<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113444666.png"></p><h2 id="dockerç½‘ç»œæ¨¡å¼"><a href="#dockerç½‘ç»œæ¨¡å¼" class="headerlink" title="dockerç½‘ç»œæ¨¡å¼"></a>dockerç½‘ç»œæ¨¡å¼</h2><h3 id="dockerç½‘ç»œæ¨¡å¼æœ‰ä»¥ä¸‹å‡ ç§"><a href="#dockerç½‘ç»œæ¨¡å¼æœ‰ä»¥ä¸‹å‡ ç§" class="headerlink" title="dockerç½‘ç»œæ¨¡å¼æœ‰ä»¥ä¸‹å‡ ç§"></a>dockerç½‘ç»œæ¨¡å¼æœ‰ä»¥ä¸‹å‡ ç§</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Hostï¼šå®¹å™¨ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®ä¸»æœºçš„IPç­‰,è€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„IPå’Œç«¯å£</span><br><span class="line"></span><br><span class="line">Container: åˆ›å»ºçš„å®¹å™¨ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„IPï¼Œè€Œæ˜¯å’Œä¸€ä¸ªæŒ‡å®šçš„å®¹å™¨å…±äº«IPã€‚ï¼ˆä¸€èˆ¬ä¸ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">None: è¯¥æ¨¡å¼å…³é—­äº†å®¹å™¨çš„ç½‘ç»œåŠŸèƒ½ã€‚ï¼ˆä¸€èˆ¬ä¸ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">Bridgeï¼šé»˜è®¤ä¸ºè¯¥æ¨¡å¼ï¼ˆæ¡¥æ¥ï¼Œè‡ªå·±åˆ›å»ºä¹Ÿæ˜¯ç”¨å®ƒï¼‰ï¼Œæ­¤æ¨¡å¼ä¼šä¸ºæ¯ä¸€ä¸ªå®¹å™¨åˆ†é…ï¼Œè®¾ç½®IPç­‰ï¼Œå¹¶å°†å®¹å™¨è¿æ¥åˆ°ä¸€ä¸ªdocker0 çš„è™šæ‹Ÿç½‘æ¡¥ï¼Œé€šè¿‡docker 0 ç½‘æ¡¥ä»¥åŠiptables nat è¡¨é…ç½®ä¸å®¿ä¸»æœºé€šä¿¡ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network <span class="built_in">ls</span>   <span class="comment">#åˆ—å‡ºdockerç½‘å¡</span></span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œçš„å®¹å™¨"><a href="#åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œçš„å®¹å™¨" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œçš„å®¹å™¨"></a>åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œçš„å®¹å™¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ç›´æ¥å¯åŠ¨å‘½ä»¤ï¼Œ --net bridgeï¼Œå°±æ˜¯docker0ï¼ˆé»˜è®¤ï¼‰</span><br><span class="line">docker run -d -P --name=tomcat01 --net bridge tomcat</span><br><span class="line"></span><br><span class="line">docker0ç‰¹ç‚¹ï¼šé»˜è®¤ï¼ŒåŸŸåä¸èƒ½è®¿é—®ï¼Œ--<span class="built_in">link</span>ä¸å»ºè®®ä½¿ç”¨</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬è‡ªå·±æ¥åˆ›å»ºä¸€ä¸ªbridgeã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker network create --driver bridge --subnet 192.168.0.0/24 --gateway 192.168.0.1 testnet</span><br><span class="line"></span><br><span class="line">docekr network <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113704263.png"></p><p>æŸ¥çœ‹ç½‘å¡è¯¦æƒ…ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network inspect ç½‘å¡åå­—  <span class="comment">#æŸ¥çœ‹ç½‘å¡è¯¦ç»†ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113748900.png"></p><h3 id="å‘å¸ƒä¸¤ä¸ªåœ¨è‡ªå·±åˆ›å»ºçš„ç½‘ç»œé‡Œçš„å®¹å™¨"><a href="#å‘å¸ƒä¸¤ä¸ªåœ¨è‡ªå·±åˆ›å»ºçš„ç½‘ç»œé‡Œçš„å®¹å™¨" class="headerlink" title="å‘å¸ƒä¸¤ä¸ªåœ¨è‡ªå·±åˆ›å»ºçš„ç½‘ç»œé‡Œçš„å®¹å™¨"></a>å‘å¸ƒä¸¤ä¸ªåœ¨è‡ªå·±åˆ›å»ºçš„ç½‘ç»œé‡Œçš„å®¹å™¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -P --name=tomcat01-net --net=testnet tomcat:7</span><br><span class="line">docker run -d -P --name=tomcat02-net --net testnet tomcat:7</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨docker network inspect testnetï¼Œå°±å¯ä»¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„è¿™ä¸¤ä¸ªå®¹å™¨çš„IPäº†ã€‚<br><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113837560.png"><br>è¿˜è®°å¾—æˆ‘ä»¬å‰é¢è¯´çš„docker0çš„ç¼ºç‚¹ä¹‹ä¸€ï¼Œä¸èƒ½é€šè¿‡åŸŸåè®¿é—®å—ï¼Ÿè€Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ç½‘ç»œï¼Œå°±ä¿®å¤äº†è¿™ä¸ªåŠŸèƒ½ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it tomcat01-net ping -c 3 IP</span><br><span class="line">docker <span class="built_in">exec</span> -it tomcat01-net ping -c 3 tomcat02-net</span><br><span class="line"></span><br><span class="line">æç¤ºï¼Œping -cå¯ä»¥è‡ªå®šä¹‰pingçš„æ¬¡æ•°</span><br></pre></td></tr></table></figure><p><img src="/2025/08/07/docker%E5%85%A5%E9%97%A8/file-20250807113935900.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥ä½œæµ å®šæ—¶åŒæ­¥</title>
      <link href="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/"/>
      <url>/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<p>ä¸šåŠ¡ä¸Šçš„ çˆ¬è™«çš„ æ–‡ä»¶çš„æ•°æ®</p><pre class="mermaid">graph LR  æ•°æ®æº-->å®šæ—¶åŒæ­¥;  å®šæ—¶åŒæ­¥-->Hiveæ•°ä»“;</pre><p>å®šæ—¶åŒæ­¥å·¥å…· DataX<br><a href="https://github.com/alibaba/DataX">https://github.com/alibaba/DataX</a></p><p>åˆå§‹åŒ–ä¸ªäººå¼€å‘ç¯å¢ƒ<br>åˆ›å»ºå¼€å‘ç›®å½• - éµå¾ªè§„èŒƒ æ¯ä¸ªäººçš„ä»£ç è¦åœ¨è‡ªå·±çš„ç›®å½•ä¸‹å»å¼€å‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸ªäººç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /zhiyun/lijinquan</span><br><span class="line"><span class="built_in">cd</span> /zhiyun/lijinquan</span><br><span class="line"><span class="comment"># åˆ›å»º5ä¸ªåŠŸèƒ½ç›®å½•</span></span><br><span class="line"><span class="comment"># data - å­˜æ”¾æ•°æ®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># jobs - å­˜æ”¾dataxçš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># sql - sqlè„šæœ¬</span></span><br><span class="line"><span class="comment"># shell - shellè„šæœ¬</span></span><br><span class="line"><span class="comment"># python - pythonè„šæœ¬</span></span><br><span class="line"><span class="built_in">mkdir</span> data <span class="built_in">jobs</span> sql shell python</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨çš„è§„èŒƒå’Œè¦æ±‚"><a href="#å­˜å‚¨çš„è§„èŒƒå’Œè¦æ±‚" class="headerlink" title="å­˜å‚¨çš„è§„èŒƒå’Œè¦æ±‚"></a>å­˜å‚¨çš„è§„èŒƒå’Œè¦æ±‚</h2><p>æŒ‰è¦æ±‚æ¯ä¸ªæœˆå­˜å‚¨ä¸€ä»½å†å²æ•°æ®, è‡³å°‘ä¿ç•™24ä¸ªæœˆçš„ç‰ˆæœ¬æ•°æ®</p><pre class="mermaid">graph LR   æºè¡¨-->|DataX|Hive-ODS;   Hive-ODS-->2025-05;   Hive-ODS-->2025-06;   Hive-ODS-->2025-07-å½“æœˆå°±è¦†ç›–;   Hive-ODS-->2025-08;</pre><h2 id="é…ç½®æ–‡ä»¶çš„ç¼–å†™"><a href="#é…ç½®æ–‡ä»¶çš„ç¼–å†™" class="headerlink" title="é…ç½®æ–‡ä»¶çš„ç¼–å†™"></a>é…ç½®æ–‡ä»¶çš„ç¼–å†™</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                 <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;errorLimit&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;record&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;percentage&quot;</span><span class="punctuation">:</span> <span class="number">0.02</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jd&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;*&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;yyj_nmpa&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://192.168.8.8:3306/jd&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hdp:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;orc&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/zhiyun/yaoyinjin/tmp/nmpa&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nmpa.data&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;link&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;title&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index_id&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;categories&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;date_&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;article&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;truncate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æŠ½å–æ•°æ®"><a href="#æŠ½å–æ•°æ®" class="headerlink" title="æŠ½å–æ•°æ®"></a>æŠ½å–æ•°æ®</h2><p>æ³¨æ„æŠ½å–å‰éœ€è¦æå‰åˆ›å»ºHDFSç›®å½•Â <a href="http://192.168.8.67:9870/">http://192.168.8.67:9870/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">mkdir</span> -p /zhiyun/yaoyinjin/tmp/nmpa</span><br></pre></td></tr></table></figure><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731223052908.png"></p><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731225630668.png"></p><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731225217087.png"></p><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731225649969.png"></p><h2 id="Hiveå»ºè¡¨"><a href="#Hiveå»ºè¡¨" class="headerlink" title="Hiveå»ºè¡¨"></a>Hiveå»ºè¡¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å»ºç«‹ODSæ•°æ®åº“</span></span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> ods_yaoyinjin location &quot;/zhiyun/yaoyinjin/ods&quot;;</span><br><span class="line"><span class="comment">-- å»ºç«‹NMPAåˆ†åŒºè¡¨</span></span><br><span class="line"><span class="comment">-- ODSçš„è¡¨åº”è¯¥æ˜¯å¤–éƒ¨è¡¨</span></span><br><span class="line"><span class="comment">-- å†…éƒ¨è¡¨åˆ é™¤è¡¨çš„æ—¶å€™åˆ é™¤æ•°æ®, å¤–éƒ¨è¡¨åˆ é™¤è¡¨ä¸åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">external</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> ods_yaoyinjin.nmpa(</span><br><span class="line">id <span class="type">int</span>,</span><br><span class="line">link string,</span><br><span class="line">title string,</span><br><span class="line">index_id string,</span><br><span class="line">categories string,</span><br><span class="line">data_ string,</span><br><span class="line">article string</span><br><span class="line">) partitioned <span class="keyword">by</span> (dt string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> &quot;\t&quot;</span><br><span class="line">lines terminated <span class="keyword">by</span> &quot;\n&quot;</span><br><span class="line">stored <span class="keyword">as</span> orc</span><br><span class="line">location &quot;/zhiyun/yaoyinjin/ods/nmpa&quot;;</span><br></pre></td></tr></table></figure><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731230328889.png"> </p><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731230714809.png"></p><h2 id="åŠ è½½æ•°æ®åˆ°å½“æœˆåˆ†åŒº"><a href="#åŠ è½½æ•°æ®åˆ°å½“æœˆåˆ†åŒº" class="headerlink" title="åŠ è½½æ•°æ®åˆ°å½“æœˆåˆ†åŒº"></a>åŠ è½½æ•°æ®åˆ°å½“æœˆåˆ†åŒº</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data inpath <span class="string">&quot;/zhiyun/yaoyinjin/tmp/nmpa/*&quot;</span> overwrite into table ods_yaoyinjin.nmpa partition(dt=<span class="string">&quot;2025-07&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731230807031.png"></p><h2 id="éªŒè¯æ•°æ®"><a href="#éªŒè¯æ•°æ®" class="headerlink" title="éªŒè¯æ•°æ®"></a>éªŒè¯æ•°æ®</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> ods_lijinquan.nmpa;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ods_lijinquan.nmpa limit <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731231221016.png"></p><p><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250731231304841.png"></p><h2 id="è‡ªåŠ¨åŒ–è°ƒåº¦"><a href="#è‡ªåŠ¨åŒ–è°ƒåº¦" class="headerlink" title="è‡ªåŠ¨åŒ–è°ƒåº¦"></a>è‡ªåŠ¨åŒ–è°ƒåº¦</h2><p>éœ€æ±‚: æ¯å¤©å‡Œæ™¨4ç‚¹è‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªæµç¨‹<br>è°ƒåº¦å¹³å° - æµ·è±šè°ƒåº¦<br>linuxå®šæ—¶ä»»åŠ¡ - Cron<br><a href="http://192.168.8.67:12345/dolphinscheduler/ui/login">http://192.168.8.67:12345/dolphinscheduler/ui/login</a><br>ç”¨æˆ·åå’Œå¯†ç  admin &#x2F; dolphinscheduler123<br><img src="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/file-20250801100538044.png"><br><img src="/dag%20(1).png"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Hive </tag>
            
            <tag> æµ·è±šè°ƒåº¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒ»è¯å™¨æ¢°æ³•è§„æ•°æ®çˆ¬å–</title>
      <link href="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/"/>
      <url>/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<h1 id="åè¯è§£é‡Š"><a href="#åè¯è§£é‡Š" class="headerlink" title="åè¯è§£é‡Š"></a>åè¯è§£é‡Š</h1><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><ol><li>æ³•å¾‹æ³•è§„çŸ¥è¯†åº“çš„å»ºç«‹</li><li>AIç¯å¢ƒä¸çŸ¥è¯†åº“</li><li>æ‰£å­AIæ™ºèƒ½ä½“åº”ç”¨ä¸ç³»ç»Ÿé›†æˆ</li></ol><p>åŠŸèƒ½éœ€æ±‚ï¼š<br>å®ç°è¾“â¼Šå•†å“ä¿¡æ¯æ¥â¼ , æäº¤å•†å“åæ ¹æ®ç°æœ‰æ³•å¾‹æ³•è§„åˆ¤æ–­å•†å“æ˜¯å¦</p><pre class="mermaid">%%{init: {"flowchart": {"useMaxWidth": true}}}%%graph LRç³»ç»ŸA-->AIå¹³å°;ç³»ç»ŸB-->AIå¹³å°;ç³»ç»ŸC-->AIå¹³å°;å…¶ä»–-->Aå·¥å¹³å°; AIå¹³å°-->çŸ¥è¯†åº“;AIå¹³å°-->AIå¤§æ¨¡å‹;Aå·¥å¹³å°-->åŠŸèƒ½-åˆ¤æ–­å•†å“æ˜¯å¦ç¬¦åˆçŸ¥è¯†åº“é‡Œçš„æ³•å¾‹æ³•è§„;çŸ¥è¯†åº“-ç½‘ç«™;çŸ¥è¯†åº“-->æ–‡æ¡£-Word_Exce1_Cs;ç½‘ç«™-->çˆ¬è™«;çˆ¬è™«-->RPA;çˆ¬è™«-->Python;æ–‡æ¡£-word_Excel_CsV-->Pandas; AIå¤§æ¨¡å‹-->æœ¬åœ°AI; AIå¤§æ¨¡å‹-->äº‘AI;</pre><h1 id="æ³•å¾‹æ³•è§„æ•°æ®çˆ¬å–ç½‘ç«™"><a href="#æ³•å¾‹æ³•è§„æ•°æ®çˆ¬å–ç½‘ç«™" class="headerlink" title="æ³•å¾‹æ³•è§„æ•°æ®çˆ¬å–ç½‘ç«™"></a>æ³•å¾‹æ³•è§„æ•°æ®çˆ¬å–ç½‘ç«™</h1><ul><li>å›½å®¶è¯å“ç›‘ç£ç®¡ç†å±€  <a href="https://www.nmpa.gov.cn/ylqx/index.html">https://www.nmpa.gov.cn/ylqx/index.html</a> ï¼ˆçˆ¬å–ç›®æ ‡1ï¼‰</li><li>å›½å®¶è¯å“ç›‘ç£ç®¡ç†å±€åŒ»ç–—å™¨æ¢°æŠ€æœ¯å®¡è¯„ä¸­â¼¼  <a href="https://www.cmde.org.cn/index.html">https://www.cmde.org.cn/index.html</a> ï¼ˆçˆ¬å–ç›®æ ‡2ï¼‰</li><li>å›½å®¶è¯å…¸å§”å‘˜ä¼š (API)  <a href="https://www.chp.org.cn/">https://www.chp.org.cn/</a> </li><li>èšåˆå¹³å° - è¯æ™ºåŒ»æ¢°æ•°æ®   <a href="https://db.yaozh.com/qx">https://db.yaozh.com/qx</a> ï¼ˆçˆ¬å–ç›®æ ‡3ï¼‰</li></ul><h2 id="éœ€è¦è·å–çš„æ•°æ®"><a href="#éœ€è¦è·å–çš„æ•°æ®" class="headerlink" title="éœ€è¦è·å–çš„æ•°æ®"></a>éœ€è¦è·å–çš„æ•°æ®</h2><ol><li>æ ‡é¢˜</li><li>ç´¢å¼•å·</li><li>åˆ†ç±»</li><li>æ—¥æœŸ</li><li>æ–‡ç« å†…å®¹</li><li>å¤šä¸ªé™„ä»¶ï¼ˆéš¾ç‚¹ï¼Œéœ€è¦ä¸‹è½½ï¼Œä¿æŒæ–‡ä»¶æ ¼å¼ï¼ŒæŒ‰ç…§æ–‡ç« å­˜æ”¾ï¼Œåˆ¤æ–­å¦‚æœå·²å­˜åœ¨åˆ™è·³è¿‡ï¼‰</li></ol><p>ä¸€å®šè¦åšå¥½å¼‚å¸¸å¤„ç†<br>å­˜å…¥åˆ°MySQLï¼Œä¸€ä¸ªç½‘ç«™ä¸€ä¸ªè¡¨ï¼Œ åå­—_å¹³å°ï¼Œå­—æ®µè‡ªå®šä¹‰</p><h2 id="æ•°æ®æ’å…¥æ–‡ä»¶inser-data-py"><a href="#æ•°æ®æ’å…¥æ–‡ä»¶inser-data-py" class="headerlink" title="æ•°æ®æ’å…¥æ–‡ä»¶inser_data.py"></a>æ•°æ®æ’å…¥æ–‡ä»¶inser_data.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xbot</span><br><span class="line"><span class="keyword">from</span> xbot <span class="keyword">import</span> <span class="built_in">print</span>, sleep</span><br><span class="line"><span class="keyword">from</span> .<span class="keyword">import</span> package</span><br><span class="line"><span class="keyword">from</span> .package <span class="keyword">import</span> variables <span class="keyword">as</span> glv</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">from</span> pymysql <span class="keyword">import</span> OperationalError, ProgrammingError</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">insert_data</span>(<span class="params">table,cols,data_list</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># æ•°æ®åº“è¿æ¥å‚æ•°</span></span><br><span class="line">Â  Â  db_config = &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;192.168.65.66&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;Yao&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  <span class="string">&#x27;database&#x27;</span>: <span class="string">&#x27;yingdao&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  <span class="string">&#x27;charset&#x27;</span>: <span class="string">&#x27;utf8mb4&#x27;</span></span><br><span class="line"></span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  connection = <span class="literal">None</span></span><br><span class="line">Â  Â  cursor = <span class="literal">None</span></span><br><span class="line">Â  Â  <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span></span><br><span class="line">Â  Â  Â  Â  connection = pymysql.connect(**db_config)</span><br><span class="line">Â  Â  Â  Â  cursor = connection.cursor()</span><br><span class="line">Â  Â  Â  Â  <span class="comment"># å‡è®¾è¦æ’å…¥çš„è¡¨åä¸º &#x27;your_table&#x27;ï¼ŒåŒ…å«3åˆ—</span></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è¯·æ ¹æ®å®é™…è¡¨ç»“æ„ä¿®æ”¹è¡¨åå’Œå ä½ç¬¦æ•°é‡</span></span><br><span class="line">Â  Â  Â  Â  sql = <span class="string">f&quot;INSERT INTO <span class="subst">&#123;table&#125;</span> (<span class="subst">&#123;<span class="string">&#x27;,&#x27;</span>.join(cols)&#125;</span>) VALUES (<span class="subst">&#123;<span class="string">&#x27;%s,&#x27;</span> * (<span class="built_in">len</span>(cols)-<span class="number">1</span>)&#125;</span>%s)&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># æ‰§è¡Œæ’å…¥æ“ä½œï¼Œdata_list æ˜¯è¦æ’å…¥çš„åˆ—è¡¨æ•°æ®</span></span><br><span class="line">Â  Â  Â  Â  cursor.execute(sql, data_list)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># æäº¤äº‹åŠ¡</span></span><br><span class="line">Â  Â  Â  Â  connection.commit()</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®æ’å…¥æˆåŠŸ&quot;</span>)</span><br><span class="line">Â  Â  Â  Â  </span><br><span class="line">Â  Â  <span class="keyword">except</span> OperationalError <span class="keyword">as</span> e:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®åº“è¿æ¥é”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> connection:</span><br><span class="line">Â  Â  Â  Â  Â  Â  connection.rollback()</span><br><span class="line">Â  Â  Â  Â  Â  Â  </span><br><span class="line">Â  Â  <span class="keyword">except</span> ProgrammingError <span class="keyword">as</span> e:</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">f&quot;SQLæ‰§è¡Œé”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> connection:</span><br><span class="line">Â  Â  Â  Â  Â  Â  connection.rollback()</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">f&quot;å‘ç”Ÿé”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> connection:</span><br><span class="line">Â  Â  Â  Â  Â  Â  connection.rollback()</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">finally</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># å…³é—­æ¸¸æ ‡å’Œè¿æ¥</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> cursor:</span><br><span class="line">Â  Â  Â  Â  Â  Â  cursor.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> connection:</span><br><span class="line">Â  Â  Â  Â  Â  Â  connection.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line">Â  Â  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="çˆ¬å–npmç½‘ç«™"><a href="#çˆ¬å–npmç½‘ç«™" class="headerlink" title="çˆ¬å–npmç½‘ç«™"></a>çˆ¬å–npmç½‘ç«™</h2><h3 id="è¡¨åˆ›å»º"><a href="#è¡¨åˆ›å»º" class="headerlink" title="è¡¨åˆ›å»º"></a>è¡¨åˆ›å»º</h3><ol><li><strong>nmpa_platformä¸»è¡¨åˆ›å»º</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> nmpa_platform(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> AUTO_INCREMENT,</span><br><span class="line">link <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">not NULL</span> comment <span class="string">&#x27;é“¾æ¥&#x27;</span>,</span><br><span class="line">title <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;æ ‡é¢˜&#x27;</span>,</span><br><span class="line">index_id <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;ç´¢å¼•å·&#x27;</span>,</span><br><span class="line">categories <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not NULL</span> comment <span class="string">&#x27;ä¸»é¢˜åˆ†ç±»&#x27;</span>,</span><br><span class="line">date_ <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not NULL</span> COMMENT <span class="string">&#x27;å‘å¸ƒæ—¥æœŸ&#x27;</span>,</span><br><span class="line">article text <span class="keyword">not NULL</span> COMMENT <span class="string">&#x27;æ–‡ç« å†…å®¹&#x27;</span></span><br><span class="line">)ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><strong>att_tableé™„ä»¶è¡¨åˆ›å»º</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> att_table(</span><br><span class="line">att_link <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">PRIMARY key</span> comment <span class="string">&#x27;é™„ä»¶é“¾æ¥&#x27;</span>,</span><br><span class="line">index_id <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;ç´¢å¼•å·&#x27;</span>,</span><br><span class="line">att_name <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;é™„ä»¶å&#x27;</span>,</span><br><span class="line">attachment text  comment <span class="string">&#x27;é™„ä»¶å†…å®¹&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure></li></ol><h3 id="get-table1-data-py"><a href="#get-table1-data-py" class="headerlink" title="get_table1_data.py"></a>get_table1_data.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xbot</span><br><span class="line"><span class="keyword">from</span> xbot <span class="keyword">import</span> <span class="built_in">print</span>, sleep,web</span><br><span class="line"><span class="keyword">from</span> xbot.app <span class="keyword">import</span> databook</span><br><span class="line"><span class="keyword">from</span> .<span class="keyword">import</span> package</span><br><span class="line"><span class="keyword">from</span> .package <span class="keyword">import</span> variables <span class="keyword">as</span> glv</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> .inser_data <span class="keyword">import</span> insert_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ¯ä¸€é¡µçš„url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_page_url</span>(<span class="params">url</span>):</span><br><span class="line">    web_object=web.create(url,<span class="string">&quot;cef&quot;</span>,load_timeout=<span class="number">20</span>)</span><br><span class="line">    element1=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[5]/div/div[2]/div/a[1]&#x27;</span>)</span><br><span class="line">    element2=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[5]/div/div[2]/div/a[7]&#x27;</span>)</span><br><span class="line">    index_str=element2.get_attribute(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    index=<span class="built_in">int</span>(re.findall(<span class="string">r&#x27;\d+&#x27;</span>,index_str)[<span class="number">0</span>])</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> element1.get_attribute(<span class="string">&#x27;href&#x27;</span>)==<span class="string">&#x27;index_1.html&#x27;</span>:</span><br><span class="line">        list_page=[ <span class="string">f&quot;https://www.nmpa.gov.cn/ylqx/ylqxfgwj/index_<span class="subst">&#123;i&#125;</span>.html&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,index+<span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        list_page=[ <span class="string">f&quot;https://www.nmpa.gov.cn/ylqx/ylqxfgwj/index_<span class="subst">&#123;i&#125;</span>.html&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,index+<span class="number">1</span>)]</span><br><span class="line">        list_page.insert(<span class="number">0</span>,url)</span><br><span class="line"></span><br><span class="line">    web_object.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list_page</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ¯ä¸€ä¸ªæ–‡ç« çš„url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_art_url</span>(<span class="params">list_page</span>):</span><br><span class="line">    list_link=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list_page:</span><br><span class="line">        web_object=web.create(i,<span class="string">&quot;cef&quot;</span>,load_timeout=<span class="number">20</span>)</span><br><span class="line">        lis=web_object.find_all_by_xpath(<span class="string">&quot;/html/body/div[5]/div/div[2]/ul/li&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> lis:</span><br><span class="line">            href=element.find_by_xpath(<span class="string">&#x27;./a&#x27;</span>).get_attribute(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> href.startswith(<span class="string">&#x27;../../&#x27;</span>): </span><br><span class="line">                list_link.append(href.replace(<span class="string">&#x27;../../&#x27;</span>,<span class="string">&#x27;https://www.nmpa.gov.cn/&#x27;</span>))</span><br><span class="line">        web_object.close()</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> list_link</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å…¨éƒ¨æ•°æ®ï¼ŒåŒ…æ‹¬é™„ä»¶é“¾æ¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_Data_and_att_link</span>(<span class="params">list_link</span>):</span><br><span class="line">    list_data=[]</span><br><span class="line">    att_file_link=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list_link:</span><br><span class="line">        <span class="keyword">try</span> :</span><br><span class="line">            web_object=web_object=web.create(i,<span class="string">&quot;cef&quot;</span>,load_timeout=<span class="number">20</span>)</span><br><span class="line">            </span><br><span class="line">            title_element=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[1]/table/tbody/tr[2]/td[2]&#x27;</span>)</span><br><span class="line">            title=title_element.get_text()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> title.rfind(<span class="string">&quot;ã€å¤±æ•ˆã€‘&quot;</span>)!=-<span class="number">1</span> <span class="keyword">or</span> title.rfind(<span class="string">&quot;ã€åºŸæ­¢ã€‘&quot;</span>)!=-<span class="number">1</span>:</span><br><span class="line">                web_object.close()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            index_id_element=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[1]/table/tbody/tr[1]/td[2]&#x27;</span>)</span><br><span class="line">            cat_element=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[1]/table/tbody/tr[1]/td[4]&#x27;</span>)</span><br><span class="line">            date_element=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[1]/table/tbody/tr[3]/td[2]&#x27;</span>)</span><br><span class="line">            art_element=web_object.find_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[5]&#x27;</span>)</span><br><span class="line">            index_id=index_id_element.get_text()</span><br><span class="line">            categories=cat_element.get_text()</span><br><span class="line">            date_=date_element.get_text()</span><br><span class="line">            article=art_element.get_text()</span><br><span class="line">            list_data.append([i,title,index_id,categories,date_,article])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è·å¾—ä¸€è¡Œæ•°æ®å°±æ’ä¸€è¡Œæ•°æ®</span></span><br><span class="line">            insert_list=[i,title,index_id,categories,date_,article]</span><br><span class="line">            table = <span class="string">&quot;nmpa_platform&quot;</span></span><br><span class="line">            cols=[<span class="string">&quot;link&quot;</span>,<span class="string">&quot;title&quot;</span>,<span class="string">&quot;index_id&quot;</span>,<span class="string">&quot;categories&quot;</span>,<span class="string">&quot;date_&quot;</span>,<span class="string">&quot;article&quot;</span>]</span><br><span class="line">            insert_data(table,cols,insert_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            att_elements=web_object.find_all_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[5]/p/a&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span> att_elements:</span><br><span class="line">                table_name=<span class="string">&quot;att_table&quot;</span></span><br><span class="line">                att_cols=[<span class="string">&quot;att_link&quot;</span>,<span class="string">&quot;index_id&quot;</span>,<span class="string">&quot;att_name&quot;</span>]</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> att_elements:</span><br><span class="line">                    file_name=i.get_attribute(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">                    href=i.get_attribute(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">                    att_link=<span class="string">&#x27;https://www.nmpa.gov.cn/&#x27;</span>+href</span><br><span class="line">                   </span><br><span class="line">                    <span class="comment"># æ’å…¥æ•°æ®</span></span><br><span class="line">                    att_insert=[att_link,index_id,file_name]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    att_file_link.append(att_insert)</span><br><span class="line"></span><br><span class="line">                    insert_data(table_name,att_cols,att_insert)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æœ¬æ¬¡æ²¡é™„ä»¶:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å¼‚å¸¸ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            web_object.close()</span><br><span class="line">    <span class="keyword">return</span> list_data,att_file_link</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line">  </span><br><span class="line">    </span><br><span class="line">    url=<span class="string">r&#x27;https://www.nmpa.gov.cn/ylqx/ylqxfgwj/index.html&#x27;</span></span><br><span class="line">    list_page=get_page_url(url)</span><br><span class="line">    <span class="comment"># list_page=[&#x27;https://www.nmpa.gov.cn/ylqx/ylqxfgwj/index.html&#x27;,&#x27;https://www.nmpa.gov.cn/ylqx/ylqxfgwj/index_1.html&#x27; ]</span></span><br><span class="line">    list_link=get_art_url(list_page)</span><br><span class="line">    <span class="comment"># list_link=[&#x27;https://www.nmpa.gov.cn/xxgk/fgwj/gzwj/gzwjylqx/20250526175353132.html&#x27;,&#x27;https://www.nmpa.gov.cn/xxgk/fgwj/gzwj/gzwjylqx/20250326171742135.html&#x27;]</span></span><br><span class="line">    list_data,att_link=get_Data_and_att_link(list_link)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;list_data:<span class="subst">&#123;list_data&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;att_link:<span class="subst">&#123;att_link&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> list_data,att_link</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/file-20250730142831068.png"><br><img src="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/file-20250730142856665.png"></p><h2 id="çˆ¬å–cmdeç½‘ç«™"><a href="#çˆ¬å–cmdeç½‘ç«™" class="headerlink" title="çˆ¬å–cmdeç½‘ç«™"></a>çˆ¬å–cmdeç½‘ç«™</h2><h3 id="è¡¨åˆ›å»º-1"><a href="#è¡¨åˆ›å»º-1" class="headerlink" title="è¡¨åˆ›å»º"></a>è¡¨åˆ›å»º</h3><ol><li><strong>cmde_platformä¸»è¡¨åˆ›å»º</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> cmde_platform(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> AUTO_INCREMENT,</span><br><span class="line">link <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">not NULL</span> comment <span class="string">&#x27;é“¾æ¥&#x27;</span>,</span><br><span class="line">title <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;æ ‡é¢˜&#x27;</span>,</span><br><span class="line">index_id <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;ç´¢å¼•å·&#x27;</span>,</span><br><span class="line"><span class="comment">-- categories varchar(16) not NULL comment &#x27;ä¸»é¢˜åˆ†ç±»&#x27;,</span></span><br><span class="line">date_ <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not NULL</span> COMMENT <span class="string">&#x27;å‘å¸ƒæ—¥æœŸ&#x27;</span>,</span><br><span class="line">article text <span class="keyword">not NULL</span> COMMENT <span class="string">&#x27;æ–‡ç« å†…å®¹&#x27;</span></span><br><span class="line">)ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure></li><li><strong>att_cmdeé™„ä»¶è¡¨åˆ›å»º</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> att_cmde(</span><br><span class="line">att_link <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">PRIMARY key</span> comment <span class="string">&#x27;é™„ä»¶é“¾æ¥&#x27;</span>,</span><br><span class="line">index_id <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;ç´¢å¼•å·&#x27;</span>,</span><br><span class="line">att_name <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;é™„ä»¶å&#x27;</span>,</span><br><span class="line">attachment text  comment <span class="string">&#x27;é™„ä»¶å†…å®¹&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure></li></ol><h3 id="get-table2-data-py"><a href="#get-table2-data-py" class="headerlink" title="get_table2_data.py"></a>get_table2_data.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xbot</span><br><span class="line"><span class="keyword">from</span> xbot <span class="keyword">import</span> <span class="built_in">print</span>, sleep,web</span><br><span class="line"><span class="keyword">from</span> .<span class="keyword">import</span> package</span><br><span class="line"><span class="keyword">from</span> .package <span class="keyword">import</span> variables <span class="keyword">as</span> glv</span><br><span class="line"><span class="keyword">from</span> .inser_data <span class="keyword">import</span> insert_data</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·é¡µé“¾æ¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_page_url</span>():</span><br><span class="line">    url=<span class="string">r&quot;https://www.cmde.org.cn/flfg/index.html&quot;</span></span><br><span class="line">    wb_object = web.create(url,mode=<span class="string">&#x27;cef&#x27;</span>,load_timeout=<span class="number">20</span>)</span><br><span class="line">    last_index_element=wb_object.find_by_xpath(<span class="string">&#x27;/html/body/div[3]/div[3]/div[2]/div/a[7]&#x27;</span>)</span><br><span class="line">    page_num_str= last_index_element.get_attribute(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">    page_num = <span class="built_in">int</span>(re.findall(<span class="string">&#x27;\d+&#x27;</span>,page_num_str)[<span class="number">0</span>])</span><br><span class="line">    page_url= [  <span class="string">f&quot;https://www.cmde.org.cn/flfg/index_<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>.html&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(page_num) ]</span><br><span class="line">    page_url.insert(<span class="number">0</span>,url)</span><br><span class="line">    wb_object.close()</span><br><span class="line">    <span class="keyword">return</span> page_url</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ–‡ç« é“¾æ¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_art_url</span>(<span class="params">page_url</span>):</span><br><span class="line">    link_all_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> page_url:</span><br><span class="line">        wb_object=web.create(i,mode=<span class="string">&#x27;cef&#x27;</span>,load_timeout=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">        link_elements= wb_object.find_all_by_xpath(<span class="string">&quot;/html/body/div[3]/div[3]/div[2]/ul/li/a&quot;</span>)</span><br><span class="line">        href_list=[ item.get_attribute(<span class="string">&#x27;href&#x27;</span>) <span class="keyword">for</span> item <span class="keyword">in</span> link_elements] </span><br><span class="line">        link_list= [ i.replace(<span class="string">&#x27;../&#x27;</span>,<span class="string">&#x27;https://www.cmde.org.cn/&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> href_list]</span><br><span class="line">        link_all_list.extend(link_list)</span><br><span class="line">        wb_object.close()</span><br><span class="line">    <span class="keyword">return</span> link_all_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_insert_data</span>(<span class="params">list_url</span>):</span><br><span class="line">    table_name = <span class="string">&#x27;cmde_platform&#x27;</span></span><br><span class="line">    cols=[<span class="string">&quot;link&quot;</span>,<span class="string">&quot;title&quot;</span>,<span class="string">&quot;index_id&quot;</span>,<span class="string">&quot;date_&quot;</span>,<span class="string">&quot;article&quot;</span>]</span><br><span class="line"></span><br><span class="line">    att_table = <span class="string">&quot;att_cmde&quot;</span></span><br><span class="line">    att_cols=[<span class="string">&quot;att_link&quot;</span>,<span class="string">&quot;index_id&quot;</span>,<span class="string">&quot;att_name&quot;</span>]</span><br><span class="line">    all_data_list=[]</span><br><span class="line">    all_att_list=[]</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list_url:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            we_object=web.create(item,mode=<span class="string">&#x27;cef&#x27;</span>)</span><br><span class="line">            title_element=we_object.find_by_xpath(<span class="string">&#x27;/html/body/div[3]/h2&#x27;</span>)</span><br><span class="line">            date_element=we_object.find_by_xpath(<span class="string">&#x27;/html/body/div[3]/div[2]&#x27;</span>)</span><br><span class="line">            content_element=we_object.find_by_xpath(<span class="string">&#x27;/html/body/div[3]/div[3]&#x27;</span>)</span><br><span class="line">            title=title_element.get_text()</span><br><span class="line">            date_str=date_element.get_text().split(<span class="string">&#x27;ï¼š&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">            content=content_element.get_text()</span><br><span class="line">            index_id=re.findall(<span class="string">&#x27;\d+&#x27;</span>,item)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            insert_list=[item,title,index_id,date_str,content]</span><br><span class="line">            insert_data(table_name,cols,insert_list)</span><br><span class="line"></span><br><span class="line">            all_data_list.append(insert_list)</span><br><span class="line"></span><br><span class="line">            att_elements = we_object.find_all_by_xpath(<span class="string">&quot;/html/body/div[3]/div[3]/p/a&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> att_elements==<span class="literal">None</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æœ¬æ–‡ç« æ²¡æœ‰é™„ä»¶:<span class="subst">&#123;item&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> item <span class="keyword">in</span> att_elements:</span><br><span class="line">                    att_name=item.get_text()</span><br><span class="line">                    att_link=<span class="string">&#x27;https://www.cmde.org.cn/&#x27;</span>+item.get_attribute(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">                    att_insert=[att_link,index_id,att_name]</span><br><span class="line">                    insert_data(att_table,att_cols,att_insert)</span><br><span class="line"></span><br><span class="line">                    all_att_list.append(att_insert)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;æŠ¥é”™ï¼š<span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            we_object =web.get_active(<span class="string">&#x27;cef&#x27;</span>)</span><br><span class="line">            we_object.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> all_data_list,all_att_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line">   </span><br><span class="line">    page_url=get_page_url()</span><br><span class="line">    <span class="comment"># print(page_url)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># page_url=[&#x27;https://www.cmde.org.cn/flfg/index.html&#x27;]</span></span><br><span class="line">    list_art_url=get_art_url(page_url)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># list_art_url=[&#x27;https://www.cmde.org.cn/flfg/fgwj/ggtg/20250704095433110.html&#x27;, &#x27;https://www.cmde.org.cn/flfg/fgwj/ggtg/20250627134357106.html&#x27;,&#x27;https://www.cmde.org.cn/flfg/fgwj/ggtg/20250408092232159.html&#x27;]</span></span><br><span class="line">    all_data_list,all_att_list=get_insert_data(list_art_url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;all_data_list:<span class="subst">&#123;all_data_list&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;all_att_list:<span class="subst">&#123;all_att_list&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> all_data_list,all_att_list</span><br></pre></td></tr></table></figure><h3 id="ç»“æœ-1"><a href="#ç»“æœ-1" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/file-20250730142938358.png"><br><img src="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/file-20250730143011067.png"></p><h2 id="çˆ¬å–yaozhiç½‘ç«™"><a href="#çˆ¬å–yaozhiç½‘ç«™" class="headerlink" title="çˆ¬å–yaozhiç½‘ç«™"></a>çˆ¬å–yaozhiç½‘ç«™</h2><h3 id="è¡¨åˆ›å»º-2"><a href="#è¡¨åˆ›å»º-2" class="headerlink" title="è¡¨åˆ›å»º"></a>è¡¨åˆ›å»º</h3><p><strong>ä¸»è¡¨yaozhi_platform</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `yaozhi_platform` (</span><br><span class="line"> `id` <span class="type">INT</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;è‡ªå¢ä¸»é”®&#x27;</span>,</span><br><span class="line"> `title` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;æ ‡é¢˜&#x27;</span>,</span><br><span class="line"> `dept` <span class="type">VARCHAR</span>(<span class="number">50</span>) COMMENT <span class="string">&#x27;å‘å¸ƒéƒ¨é—¨&#x27;</span>,</span><br><span class="line"> `post_date` <span class="type">DATE</span> COMMENT <span class="string">&#x27;å‘å¸ƒæ—¥æœŸ&#x27;</span>,</span><br><span class="line"> `zihao` <span class="type">VARCHAR</span>(<span class="number">50</span>) COMMENT <span class="string">&#x27;å‘æ–‡å­—å·&#x27;</span>,</span><br><span class="line"> `level` <span class="type">VARCHAR</span>(<span class="number">50</span>) COMMENT <span class="string">&#x27;æ•ˆåŠ›çº§åˆ«&#x27;</span>,</span><br><span class="line"> `timeliness` <span class="type">VARCHAR</span>(<span class="number">50</span>) COMMENT <span class="string">&#x27;æ—¶æ•ˆæ€§&#x27;</span>,</span><br><span class="line"> `content` TEXT COMMENT <span class="string">&#x27;æ–‡ç« å†…å®¹&#x27;</span>,</span><br><span class="line"> `attachment_count` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;é™„ä»¶æ•°&#x27;</span>,</span><br><span class="line"> `attachment_path` <span class="type">VARCHAR</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;é™„ä»¶å­˜å‚¨è·¯å¾„ï¼ˆE:\å½±åˆ€çˆ¬å–\PRA_project\attachments\yaozhi\ï¼‰&#x27;</span>,</span><br><span class="line"> `link` <span class="type">VARCHAR</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;æ–‡ç« é“¾æ¥&#x27;</span>,</span><br><span class="line"> `create_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;è®°å½•åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">`update_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;è®°å½•æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line"> <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line"> ) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci COMMENT<span class="operator">=</span><span class="string">&#x27;è¯æ™ºæ•°æ®è¡¨&#x27;</span>;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><h3 id="yaozhi-py"><a href="#yaozhi-py" class="headerlink" title="yaozhi.py"></a>yaozhi.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨æé†’:</span></span><br><span class="line"><span class="comment"># 1. xbotåŒ…æä¾›è½¯ä»¶è‡ªåŠ¨åŒ–ã€æ•°æ®è¡¨æ ¼ã€Excelã€æ—¥å¿—ã€AIç­‰åŠŸèƒ½</span></span><br><span class="line"><span class="comment"># 2. packageåŒ…æä¾›è®¿é—®å½“å‰åº”ç”¨æ•°æ®çš„åŠŸèƒ½ï¼Œå¦‚è·å–å…ƒç´ ã€è®¿é—®å…¨å±€å˜é‡ã€è·å–èµ„æºæ–‡ä»¶ç­‰åŠŸèƒ½</span></span><br><span class="line"><span class="comment"># 3. å½“æ­¤æ¨¡å—ä½œä¸ºæµç¨‹ç‹¬ç«‹è¿è¡Œæ—¶æ‰§è¡Œmainå‡½æ•°</span></span><br><span class="line"><span class="comment"># 4. å¯è§†åŒ–æµç¨‹ä¸­å¯ä»¥é€šè¿‡&quot;è°ƒç”¨æ¨¡å—&quot;çš„æŒ‡ä»¤ä½¿ç”¨æ­¤æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> xbot</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> xbot <span class="keyword">import</span> <span class="built_in">print</span>, sleep, web</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> package</span><br><span class="line"><span class="keyword">from</span> .package <span class="keyword">import</span> variables <span class="keyword">as</span> glv</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urljoin</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQLæ•°æ®åº“é…ç½®</span></span><br><span class="line">DB_CONFIG = &#123;</span><br><span class="line">    <span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;192.168.65.66&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;rYao&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span>: <span class="string">&#x27;yingdao&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;charset&#x27;</span>: <span class="string">&#x27;utf8mb4&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ•°æ®ä¿å­˜åˆ°MySQLæ•°æ®åº“</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_to_mysql</span>(<span class="params">title, dept, post_date, zihao, level, timeliness, content, attachment_count, attachment_path, link</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># åˆ›å»ºæ•°æ®åº“è¿æ¥</span></span><br><span class="line">        connection = pymysql.connect(**DB_CONFIG)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¤„ç†æ—¥æœŸæ ¼å¼</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            post_date = datetime.strptime(post_date, <span class="string">&#x27;%Y-%m-%d&#x27;</span>).date()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            post_date = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æˆªæ–­æ ‡é¢˜åˆ°255å­—ç¬¦ï¼ˆä¿ç•™æœ€å255å­—ç¬¦ï¼‰</span></span><br><span class="line">        title = title[:<span class="number">255</span>] <span class="keyword">if</span> <span class="built_in">len</span>(title) &gt; <span class="number">255</span> <span class="keyword">else</span> title</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> connection.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">            <span class="comment"># æ£€æŸ¥è®°å½•æ˜¯å¦å·²å­˜åœ¨ï¼ˆåŒæ—¶åˆ¤æ–­index_idå’Œlinkï¼‰</span></span><br><span class="line">            check_sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            SELECT 1 FROM hwz_yaozhi</span></span><br><span class="line"><span class="string">            WHERE link = %s</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            cursor.execute(check_sql, link)</span><br><span class="line">            exists = cursor.fetchone()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> exists:</span><br><span class="line">                <span class="comment"># æ›´æ–°ç°æœ‰è®°å½•</span></span><br><span class="line">                sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                UPDATE yaozhi_platform SET </span></span><br><span class="line"><span class="string">                    title = %s,</span></span><br><span class="line"><span class="string">                    dept = %s,</span></span><br><span class="line"><span class="string">                    post_date = %s,</span></span><br><span class="line"><span class="string">                    zihao = %s,</span></span><br><span class="line"><span class="string">                    level = %s,</span></span><br><span class="line"><span class="string">                    timeliness = %s,</span></span><br><span class="line"><span class="string">                    content = %s,</span></span><br><span class="line"><span class="string">                    attachment_count = %s,</span></span><br><span class="line"><span class="string">                    attachment_path = %s,</span></span><br><span class="line"><span class="string">                    update_time = CURRENT_TIMESTAMP</span></span><br><span class="line"><span class="string">                WHERE link = %s</span></span><br><span class="line"><span class="string">                &quot;&quot;&quot;</span></span><br><span class="line">                cursor.execute(sql, (title, dept, post_date, zihao, level, timeliness, content,</span><br><span class="line">                                     attachment_count, attachment_path, link))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æ›´æ–°æ•°æ®åº“è®°å½•: <span class="subst">&#123;title&#125;</span> - <span class="subst">&#123;link&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># æ’å…¥æ–°è®°å½•ï¼ˆåŒ…å«linkå­—æ®µï¼‰</span></span><br><span class="line">                sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                INSERT INTO yaozhi_platform (</span></span><br><span class="line"><span class="string">                    title, dept, post_date, zihao, level, timeliness,</span></span><br><span class="line"><span class="string">                    content, attachment_count, attachment_path,</span></span><br><span class="line"><span class="string">                    link</span></span><br><span class="line"><span class="string">                ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s)</span></span><br><span class="line"><span class="string">                &quot;&quot;&quot;</span></span><br><span class="line">                cursor.execute(sql, (title, dept, post_date, zihao, level, timeliness,</span><br><span class="line">                                     content, attachment_count, attachment_path,</span><br><span class="line">                                     link))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æ–°å¢æ•°æ®åº“è®°å½•: <span class="subst">&#123;title&#125;</span> - <span class="subst">&#123;link&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">            connection.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> pymysql.Error <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®åº“æ“ä½œå¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> connection:</span><br><span class="line">            connection.rollback()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">if</span> connection:</span><br><span class="line">            connection.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½é™„ä»¶</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_attachments</span>(<span class="params">web_object, title, base_url</span>):</span><br><span class="line">    <span class="comment"># åˆ›å»ºå®‰å…¨çš„æ ‡é¢˜ç›®å½•å</span></span><br><span class="line">    safe_title = <span class="string">&quot;&quot;</span>.join([c <span class="keyword">for</span> c <span class="keyword">in</span> title <span class="keyword">if</span> c.isalpha() <span class="keyword">or</span> c.isdigit() <span class="keyword">or</span> c <span class="keyword">in</span> (<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>)]).rstrip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. é™åˆ¶ç›®å½•åé•¿åº¦ï¼ˆWindowsè·¯å¾„æœ€å¤§260å­—ç¬¦ï¼Œè¿™é‡Œä¿ç•™100å­—ç¬¦ï¼‰</span></span><br><span class="line">    safe_title = safe_title[:<span class="number">100</span>] <span class="keyword">if</span> <span class="built_in">len</span>(safe_title) &gt; <span class="number">100</span> <span class="keyword">else</span> safe_title</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. å»é™¤é¦–å°¾ç©ºæ ¼å’Œç‚¹ï¼ˆé¿å…åˆ›å»º&quot;.&quot;æˆ–&quot;..&quot;ç›®å½•ï¼‰</span></span><br><span class="line">    safe_title = safe_title.strip().strip(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é™„ä»¶ä¿å­˜è·¯å¾„</span></span><br><span class="line">    base_dir = <span class="string">r&quot;E:\å½±åˆ€çˆ¬å–\PRA_project\attachments\yaozhi&quot;</span></span><br><span class="line">    save_dir = os.path.join(base_dir, safe_title)</span><br><span class="line">    os.makedirs(save_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æŸ¥æ‰¾é¡µé¢ä¸­çš„æ‰€æœ‰é™„ä»¶é“¾æ¥</span></span><br><span class="line">    attachment_links = web_object.find_all_by_xpath(</span><br><span class="line">        <span class="string">&quot;//a[contains(@href, &#x27;.pdf&#x27;) or contains(@href, &#x27;.doc&#x27;) or contains(@href, &#x27;.xls&#x27;) or contains(@href, &#x27;.zip&#x27;) or contains(@href, &#x27;.rar&#x27;)]&quot;</span>)</span><br><span class="line"></span><br><span class="line">    downloaded_files = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> link_element <span class="keyword">in</span> attachment_links:</span><br><span class="line">        file_url = link_element.get_attribute(<span class="string">&quot;href&quot;</span>)</span><br><span class="line">        file_name = link_element.get_text().strip()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¤„ç†ç›¸å¯¹è·¯å¾„</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> file_url.startswith(<span class="string">&quot;http&quot;</span>):</span><br><span class="line">            file_url = urljoin(base_url, file_url)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è·å–æ–‡ä»¶å</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> file_name <span class="keyword">or</span> file_name == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            file_name = os.path.basename(file_url)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ext = os.path.splitext(file_url)[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> file_name.endswith(ext):</span><br><span class="line">                file_name += ext</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨</span></span><br><span class="line">        file_path = os.path.join(save_dir, file_name)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(file_path):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;é™„ä»¶å·²å­˜åœ¨ï¼Œè·³è¿‡ä¸‹è½½: <span class="subst">&#123;file_name&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æ­£åœ¨ä¸‹è½½é™„ä»¶: <span class="subst">&#123;file_name&#125;</span>&quot;</span>)</span><br><span class="line">            response = requests.get(file_url, stream=<span class="literal">True</span>, timeout=<span class="number">30</span>)</span><br><span class="line">            response.raise_for_status()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> chunk <span class="keyword">in</span> response.iter_content(chunk_size=<span class="number">8192</span>):</span><br><span class="line">                    <span class="keyword">if</span> chunk:</span><br><span class="line">                        f.write(chunk)</span><br><span class="line"></span><br><span class="line">            downloaded_files.append(file_name)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;é™„ä»¶ä¸‹è½½å®Œæˆ: <span class="subst">&#123;file_name&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ä¸‹è½½é™„ä»¶å¤±è´¥: <span class="subst">&#123;file_name&#125;</span>, é”™è¯¯: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿”å›æœ¬æ¬¡ä¸‹è½½çš„æ–‡ä»¶åˆ—è¡¨ã€å½“å‰ç›®å½•æ€»æ–‡ä»¶æ•°ã€æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    total_files = <span class="built_in">len</span>(os.listdir(save_dir)) <span class="keyword">if</span> os.path.exists(save_dir) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> downloaded_files, total_files, save_dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–é¡µé¢å†…å®¹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_page</span>(<span class="params">title, link, dept, post_date</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ­£åœ¨è·å–ï¼š<span class="subst">&#123;title&#125;</span>,<span class="subst">&#123;link&#125;</span>&quot;</span>)</span><br><span class="line">    base_url = <span class="string">&quot;/&quot;</span>.join(link.split(<span class="string">&quot;/&quot;</span>)[:<span class="number">3</span>]) + <span class="string">&quot;/&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é‡è¯•é…ç½®</span></span><br><span class="line">    MAX_RETRIES = <span class="number">3</span>  <span class="comment"># æœ€å¤§é‡è¯•æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">for</span> attempt <span class="keyword">in</span> <span class="built_in">range</span>(MAX_RETRIES + <span class="number">1</span>):  <span class="comment"># 0,1,2,3 å…±4æ¬¡å°è¯•ï¼ˆé¦–æ¬¡+3æ¬¡é‡è¯•ï¼‰</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            web_object = web.create(link, <span class="string">&#x27;edge&#x27;</span>, load_timeout=<span class="number">30</span>)</span><br><span class="line">            <span class="comment"># æˆåŠŸåˆ™è·³å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">if</span> attempt &lt; MAX_RETRIES:</span><br><span class="line">                <span class="comment"># ç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;é¡µé¢åŠ è½½å¤±è´¥ï¼Œç¬¬ <span class="subst">&#123;attempt + <span class="number">1</span>&#125;</span> æ¬¡é‡è¯•: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                sleep(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># æœ€åä¸€æ¬¡å°è¯•å¤±è´¥</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;é¡µé¢åŠ è½½è¶…æ—¶ï¼Œå·²å°è¯• <span class="subst">&#123;MAX_RETRIES + <span class="number">1</span>&#125;</span> æ¬¡: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                web_object = <span class="literal">None</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–å˜é‡</span></span><br><span class="line">    zihao = <span class="string">&quot;&quot;</span></span><br><span class="line">    level = <span class="string">&quot;&quot;</span></span><br><span class="line">    timeliness = <span class="string">&quot;&quot;</span></span><br><span class="line">    content = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># è·å–æ‰€æœ‰ä¿¡æ¯é¡¹å®¹å™¨</span></span><br><span class="line">        info_items = web_object.find_all_by_xpath(<span class="string">&#x27;//div[@class=&quot;manual&quot;]/div[contains(@class, &quot;content&quot;)]&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> info_items:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># è·å–spanå…ƒç´ </span></span><br><span class="line">                span = item.find_by_xpath(<span class="string">&#x27;./span&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> span:</span><br><span class="line">                    span_text = span.get_text().strip()</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># æå–å®é™…å€¼</span></span><br><span class="line">                    <span class="keyword">if</span> span_text.startswith(<span class="string">&quot;ã€&quot;</span>):</span><br><span class="line">                        <span class="comment"># ç§»é™¤spanæ–‡æœ¬ï¼Œè·å–å‰©ä½™æ–‡æœ¬</span></span><br><span class="line">                        item_text = item.get_text().strip()</span><br><span class="line">                        value = item_text.replace(span_text, <span class="string">&quot;&quot;</span>, <span class="number">1</span>).strip()</span><br><span class="line"></span><br><span class="line">                        <span class="comment"># åˆ†ç±»å¤„ç†</span></span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;å‘æ–‡å­—å·&quot;</span> <span class="keyword">in</span> span_text:</span><br><span class="line">                            zihao = value</span><br><span class="line">                        <span class="keyword">elif</span> <span class="string">&quot;æ•ˆåŠ›çº§åˆ«&quot;</span> <span class="keyword">in</span> span_text:</span><br><span class="line">                            level = value</span><br><span class="line">                        <span class="keyword">elif</span> <span class="string">&quot;æ—¶æ•ˆ&quot;</span> <span class="keyword">in</span> span_text.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>):</span><br><span class="line">                            timeliness = value</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="comment"># å¿½ç•¥æ²¡æœ‰spançš„é¡¹</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æå–ä¿¡æ¯é¡¹æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–æ–‡ç« å†…å®¹</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># å°è¯•ç¬¬ä¸€ç§æ ¼å¼ï¼šclass=&quot;text&quot;</span></span><br><span class="line">        content_div = web_object.find_by_xpath(<span class="string">&#x27;//div[@class=&quot;text&quot;]&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> content_div:</span><br><span class="line">            content = content_div.get_text().strip()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># å°è¯•ç¬¬äºŒç§æ ¼å¼ï¼šclass=&quot;new_detail_content&quot;</span></span><br><span class="line">            content_div = web_object.find_by_xpath(<span class="string">&#x27;//div[@class=&quot;new_detail_content&quot;]&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> content_div:</span><br><span class="line">                content = content_div.get_text().strip()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># å°è¯•ç¬¬ä¸‰ç§æ ¼å¼ï¼šclass=&quot;text&quot;åœ¨divå†…</span></span><br><span class="line">                content_div = web_object.find_by_xpath(<span class="string">&#x27;//div[contains(@class, &quot;content&quot;)]//div[@class=&quot;text&quot;]&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> content_div:</span><br><span class="line">                    content = content_div.get_text().strip()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># å°è¯•ç¬¬å››ç§æ ¼å¼ï¼šclass=&quot;new_detail_content&quot;åœ¨divå†…</span></span><br><span class="line">                    content_div = web_object.find_by_xpath(</span><br><span class="line">                        <span class="string">&#x27;//div[contains(@class, &quot;content&quot;)]//div[@class=&quot;new_detail_content&quot;]&#x27;</span>)</span><br><span class="line">                    <span class="keyword">if</span> content_div:</span><br><span class="line">                        content = content_div.get_text().strip()</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        <span class="comment"># æœ€åå°è¯•ï¼šç›´æ¥è·å–æ•´ä¸ªmanualå†…å®¹</span></span><br><span class="line">                        manual_div = web_object.find_by_xpath(<span class="string">&#x27;//div[@class=&quot;manual&quot;]&#x27;</span>)</span><br><span class="line">                        <span class="keyword">if</span> manual_div:</span><br><span class="line">                            content = manual_div.get_text().strip()</span><br><span class="line">                    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;æå–å†…å®¹æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                        content = <span class="string">&quot;æ— æ³•æå–å†…å®¹&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å°ç»“æœ</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å‘æ–‡å­—å·: <span class="subst">&#123;zihao&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ•ˆåŠ›çº§åˆ«: <span class="subst">&#123;level&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ—¶æ•ˆæ€§: <span class="subst">&#123;timeliness&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ–‡ç« å†…å®¹: <span class="subst">&#123;content&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸‹è½½é™„ä»¶</span></span><br><span class="line">    downloaded_files, attachment_count, attachment_path = download_attachments(web_object, title, base_url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å·²åˆ›å»ºæ–‡ä»¶è·¯å¾„ï¼š<span class="subst">&#123;attachment_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> downloaded_files:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸä¸‹è½½ <span class="subst">&#123;<span class="built_in">len</span>(downloaded_files)&#125;</span> ä¸ªé™„ä»¶ï¼Œå½“å‰å…±æœ‰ <span class="subst">&#123;attachment_count&#125;</span> ä¸ªé™„ä»¶&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ²¡æœ‰æ–°é™„ä»¶éœ€è¦ä¸‹è½½ï¼Œå½“å‰å…±æœ‰ <span class="subst">&#123;attachment_count&#125;</span> ä¸ªé™„ä»¶&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­˜å…¥æ•°æ®åº“</span></span><br><span class="line">    save_to_mysql(title, dept, post_date, zihao, level, timeliness, content, attachment_count, attachment_path, link)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å…³é—­ç½‘é¡µ</span></span><br><span class="line">    web_object.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾åˆ—è¡¨</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_list</span>():</span><br><span class="line">    base_url = <span class="string">&#x27;https://db.yaozh.com/policies&#x27;</span></span><br><span class="line">    max_page = <span class="number">30</span>  <span class="comment"># çˆ¬å–30é¡µï¼ˆåŒ…æ‹¬é¦–é¡µï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_page + <span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ„å»ºé¡µé¢URLï¼ˆç¬¬1é¡µæ˜¯index.htmlï¼Œç¬¬2é¡µå¼€å§‹æ˜¯index_1.htmlï¼‰</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;base_url&#125;</span>?p=<span class="subst">&#123;page&#125;</span>.html&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹çˆ¬å–ç¬¬ <span class="subst">&#123;page&#125;</span>/<span class="subst">&#123;max_page&#125;</span> é¡µ&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># è·å–é¡µé¢å¹¶æå–æ¡ç›®å…ƒç´ </span></span><br><span class="line">            web_object = web.create(url, <span class="string">&#x27;edge&#x27;</span>, load_timeout=<span class="number">30</span>)</span><br><span class="line">            elements = web_object.find_all_by_xpath(<span class="string">&quot;/html/body/div[7]/div[6]/div/div[2]/table/tbody/tr&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æå–ä¿¡æ¯é¡¹æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¾ªç¯å¤„ç†å½“å‰é¡µæ‰€æœ‰æ¡ç›®</span></span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ ‡é¢˜</span></span><br><span class="line">                title = element.child_at(<span class="number">0</span>).get_text().strip()</span><br><span class="line">                <span class="comment"># é“¾æ¥</span></span><br><span class="line">                link = <span class="string">&quot;https://db.yaozh.com&quot;</span> + element.find_by_xpath(<span class="string">&quot;./th/a&quot;</span>).get_attribute(<span class="string">&quot;href&quot;</span>)</span><br><span class="line">                <span class="comment"># å‘å¸ƒéƒ¨é—¨</span></span><br><span class="line">                dept = element.child_at(<span class="number">1</span>).get_text().strip()</span><br><span class="line">                <span class="comment"># å‘å¸ƒæ—¥æœŸ</span></span><br><span class="line">                post_date = element.child_at(<span class="number">2</span>).get_text().strip()</span><br><span class="line">                <span class="comment"># çˆ¬å–é¡µé¢å†…å®¹</span></span><br><span class="line">                get_page(title, link, dept, post_date)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æå–ä¿¡æ¯é¡¹æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        web_object.close()</span><br><span class="line">        sleep(<span class="number">2</span>)  <span class="comment"># æ¯é¡µé—´éš”2ç§’é¿å…è¯·æ±‚è¿‡å¿«</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line">    get_list()</span><br><span class="line">    <span class="comment"># get_page(&quot;æ— å­—å·&quot;,&quot;https://db.yaozh.com/policies/3806033786892288.html&quot;,&quot;åŒ»ç–—å™¨æ¢°æŠ€æœ¯å®¡è¯„ä¸­å¿ƒ&quot;,&quot;2025-07-25&quot;)</span></span><br><span class="line">    <span class="comment"># get_page(&quot;æœ‰å­—å·&quot;,&quot;https://db.yaozh.com/policies/3802927935943168.html&quot;,&quot;å›½å®¶è¯å“å®¡è¯„ä¸­å¿ƒï¼ˆCDEï¼‰&quot;,&quot;2025-07-18&quot;)</span></span><br><span class="line">    <span class="comment"># get_page(&quot;æœ‰å®æ–½æ—¥æœŸ&quot;,&quot;https://db.yaozh.com/policies/3803629953048193.html&quot;,&quot;å›½å®¶å«å¥å§”ï¼ˆåŸå›½å®¶å«è®¡å§”ï¼‰&quot;,&quot;2025-07-21&quot;)</span></span><br></pre></td></tr></table></figure><h3 id="ç»“æœ-2"><a href="#ç»“æœ-2" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/file-20250730143137496.png"><br><img src="/2025/07/28/projectNote/%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/file-20250730143307279.png"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> RPA </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºšé©¬é€Šå•†å“éœ€æ±‚</title>
      <link href="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/"/>
      <url>/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><ol><li>æ‰“å¼€äºšé©¬é€Šç½‘å€</li><li>æ ¹æ®åˆ¶å®šçš„å¤§ç±»ç±»ç›®ï¼Œå»æ¯ä¸ªå°ç±»ç›®ä¸‹ç»Ÿè®¡Best Sellerså‰100åäº§å“çš„å•†å“IDã€æ ‡é¢˜ã€å›¾ç‰‡ã€ä»·æ ¼ã€é“¾æ¥</li><li>æŠŠç›¸åº”ä¿¡æ¯å†™è¿›æ•°æ®åº“</li><li>æŠŠæœ¬æ¬¡å†™å…¥çš„æ•°æ®è·Ÿä¸Šæ¬¡å†™å…¥çš„æ•°æ®åšåˆ†æ</li><li>æŠŠæœ‰æ–°å†²ä¸Šæ¥çš„é“¾æ¥ã€å“ªæ¡é“¾æ¥è°ƒä»·çš„ç»“æœï¼Œå‘æ¶ˆæ¯é€šçŸ¥æˆ‘ ï¼ˆçŸ­ä¿¡&#x2F;å¾®ä¿¡&#x2F;é’‰é’‰&#x2F;ç³»ç»Ÿé€šçŸ¥&#x2F;QQé‚®ç®±ï¼‰</li></ol><h2 id="è¡¨è®¾è®¡"><a href="#è¡¨è®¾è®¡" class="headerlink" title="è¡¨è®¾è®¡"></a>è¡¨è®¾è®¡</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> amazon_items (</span><br><span class="line"> id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT, <span class="comment">-- è‡ªå¢ä¸»é”®</span></span><br><span class="line">categories <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;åˆ†ç±»&#x27;</span>,</span><br><span class="line"> item_id <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;å•†å“ID&#x27;</span>,</span><br><span class="line"> title <span class="type">VARCHAR</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;æ ‡é¢˜&#x27;</span>,</span><br><span class="line"> img_url <span class="type">VARCHAR</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;å›¾ç‰‡é“¾æ¥&#x27;</span>,</span><br><span class="line"> price <span class="type">DECIMAL</span>(<span class="number">8</span>, <span class="number">2</span>) COMMENT <span class="string">&#x27;ä»·æ ¼&#x27;</span>,</span><br><span class="line"> link <span class="type">VARCHAR</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;å•†å“é“¾æ¥&#x27;</span>,</span><br><span class="line"> version <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;ç‰ˆæœ¬å·ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰&#x27;</span>,</span><br><span class="line"> create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span></span><br><span class="line"> )</span><br></pre></td></tr></table></figure><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><p> <strong>ä¸»æµç¨‹</strong>ï¼š</p><ol><li>è¿æ¥æ•°æ®åº“ï¼Œè·å–æœ€å¤§ç‰ˆæœ¬å· </li><li>æ‰“å¼€â¼¤ç±»â½¹â»šï¼Œè·å–â¼¦ç±»ç›¸ä¼¼å…ƒç´ ï¼Œ ForEach å¾ªåï¼Œè·å–å…¶â½‚æœ¬å†…å®¹å¯å–å‡ºâ¼¦ç±»æ ‡é¢˜ categories ï¼ˆå³åˆ†ç±»ï¼‰å’Œitem_id,ç”±äºåâ¾¯è·å–å’Œå­˜å‚¨å…¶ä»–å•†å“è¯¦æƒ…åœ¨â¼¦æµç¨‹ä¸­è¿›â¾ã€‚ç¼–å†™äº†å­æµç¨‹.flow(ç”¨äºè·å–è¦çˆ¬å–çš„æ•°æ®åˆ—è¡¨)å’Œget_message.flow(ç”¨äºè¾“å‡ºè¦æ’å…¥çš„æ•°æ®åˆ—è¡¨å’Œè¾“å‡ºè¦æ›´æ–°çš„ä¿¡æ¯)</li><li>æœ€ç»ˆçš„æ•°æ®åˆ—è¡¨æ’å…¥æ•°æ®åº“</li><li>å‘é€ä¿¡æ¯<br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727015406.png"><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727015756.png"><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727015952.png"><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727020044.png"><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727020029.png"></li></ol><p><strong>å­æµç¨‹</strong>ï¼š</p><ol><li>æ‹¼æ¥è¦è®¿é—®çš„url</li><li>æ‰“å¼€å­ç±»ç½‘é¡µ</li><li>æ–°å»ºå…¨å±€åˆ—è¡¨list_item_idå’Œlist_linkç”¨äºè¿½åŠ æ•°æ®</li><li>è®¾ç½®ç‚¹å‡»ä¸‹ä¸€é¡µçš„å¾ªç¯æ¬¡æ•°</li><li>æ»šåŠ¨ç½‘é¡µåˆ°åº•éƒ¨ï¼Œç­‰å¾…åŠ è½½ï¼Œæ‰¹é‡çˆ¬å–æ•°æ®</li><li>æ¸…æ´—æ‰¹é‡çˆ¬å–çš„æ•°æ®ï¼ŒæŠŠUS$29.90çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºfloatç±»å‹çš„29.90</li><li>æ‹¼æ¥æ‰€æœ‰åˆ—è¡¨ä¸ºæ•°æ®åº“è¡¨åçš„å­—æ®µçš„é¡ºåºçš„æ ¼å¼</li><li>è¾“å‡ºæœ€ç»ˆåˆ—è¡¨</li></ol><p><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727020116.png"><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727020149.png"><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727020225.png"><br>æ’å…¥çš„ä»£ç å—ç”¨äºæ¸…æ´—æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">process_element</span>(<span class="params">elem</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(elem, <span class="built_in">str</span>) <span class="keyword">and</span> elem.startswith(<span class="string">&#x27;US$&#x27;</span>):</span><br><span class="line">        <span class="comment"># ä»&quot;US$X&quot;æ ¼å¼çš„å­—ç¬¦ä¸²ä¸­æå–æ•°å­—</span></span><br><span class="line">        num_part = elem[<span class="number">3</span>:]  <span class="comment"># å–&quot;US$&quot;åé¢çš„éƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">float</span>(num_part)</span><br><span class="line">    <span class="comment"># å¿½ç•¥Noneå’Œå…¶ä»–ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸå§‹åˆ—è¡¨</span></span><br><span class="line">list1 = web_data_table</span><br><span class="line">list2 = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†æ¯ä¸ªå­åˆ—è¡¨</span></span><br><span class="line"><span class="keyword">for</span> sublist <span class="keyword">in</span> list1:</span><br><span class="line">    processed_sublist = []</span><br><span class="line">    <span class="keyword">for</span> elem <span class="keyword">in</span> sublist[<span class="number">2</span>:]:</span><br><span class="line">        processed = process_element(elem)</span><br><span class="line">        <span class="keyword">if</span> processed <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            processed_sublist.append(processed)</span><br><span class="line">    list2.append(processed_sublist)</span><br><span class="line"></span><br><span class="line">list3 = [ i[:<span class="number">2</span>]+j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(list1,list2) ]</span><br></pre></td></tr></table></figure><p><strong>get_messageå­æ¨¡å—</strong>ï¼š</p><ol><li>è¿æ¥æ•°æ®åº“æ‰§è¡Œä»¥ä¸‹sqlè¯­å¥æ‰¾å‡ºæ¯ä¸ªitem_idæœ€å¤§ç‰ˆæœ¬çš„è®°å½•<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> categories,a.item_id,title,img_url,price,link,a.version</span><br><span class="line"><span class="keyword">FROM</span> amazon_items a <span class="keyword">JOIN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> item_id, <span class="built_in">MAX</span>(version) <span class="keyword">AS</span> max_version <span class="keyword">FROM</span> amazon_items <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line"> item_id</span><br><span class="line"> ) s</span><br><span class="line"> <span class="keyword">ON</span> a.item_id <span class="operator">=</span> s.item_id <span class="keyword">AND</span> a.version <span class="operator">=</span> s.max_version;</span><br></pre></td></tr></table></figure></li><li>æ£€æŸ¥ä»·æ ¼æ˜¯å¦ç›¸åŒ,ä»·æ ¼ä¸åŒï¼Œæ›´æ–°ç‰ˆæœ¬å·å¹¶æ·»åŠ è°ƒä»·æ¶ˆæ¯</li><li>åå‘åˆ é™¤éœ€è¦ç§»é™¤çš„é¡¹ï¼Œé¿å…ç´¢å¼•å˜åŒ–é—®é¢˜</li><li>messageå¤„ç†æˆè¿™æ ·çš„æ ¼å¼ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">message += <span class="string">f&quot;æœ‰ä¸Šæ–°ï¼šã€åˆ†ç±»ï¼š<span class="subst">&#123;categories&#125;</span>ï¼Œå•†å“idï¼š<span class="subst">&#123;item_id&#125;</span>ï¼Œæ ‡é¢˜ï¼š<span class="subst">&#123;title&#125;</span>ï¼Œä»·æ ¼ï¼š<span class="subst">&#123;price&#125;</span>ï¼Œé“¾æ¥ï¼š<span class="subst">&#123;link&#125;</span>ã€‘\n&quot;</span></span><br></pre></td></tr></table></figure></li><li>è¿”å›è¦æ›´æ–°åˆ—è¡¨reslistå’Œè¦å‘é€çš„ä¿¡æ¯message<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">DBconnnectDict=&#123;</span><br><span class="line">        <span class="string">&quot;host&quot;</span>:<span class="string">&#x27;192.168.65.66&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;user&quot;</span>:<span class="string">&#x27;Yao&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;passwd&quot;</span>:<span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;db&quot;</span>:<span class="string">&#x27;yingdao&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment"># éç©ºè¿”å›æŸ¥è¯¢è¯­å¥å…ƒç»„</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_select_result</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        connection = pymysql.connect(</span><br><span class="line">                        host=DBconnnectDict[<span class="string">&quot;host&quot;</span>],</span><br><span class="line">                        port=<span class="number">3306</span>,</span><br><span class="line">                        user=DBconnnectDict[<span class="string">&quot;user&quot;</span>],</span><br><span class="line">                        passwd=DBconnnectDict[<span class="string">&quot;passwd&quot;</span>],</span><br><span class="line">                        db=DBconnnectDict[<span class="string">&quot;db&quot;</span>],</span><br><span class="line">                        charset=<span class="string">&#x27;utf8&#x27;</span></span><br><span class="line">                    )</span><br><span class="line">        <span class="comment"># åˆ›å»ºæ¸¸æ ‡å¯¹è±¡</span></span><br><span class="line">        cursor=connection.cursor()</span><br><span class="line">        <span class="comment"># å®šä¹‰SQLæŸ¥è¯¢è¯­å¥</span></span><br><span class="line">        sql=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        SELECT categories,a.item_id,title,img_url,price,link,a.version</span></span><br><span class="line"><span class="string">        FROM amazon_items a JOIN (</span></span><br><span class="line"><span class="string">        SELECT item_id, MAX(version) AS max_version FROM amazon_items GROUP BY</span></span><br><span class="line"><span class="string">        item_id</span></span><br><span class="line"><span class="string">        ) s</span></span><br><span class="line"><span class="string">        ON a.item_id = s.item_id AND a.version = s.max_version;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰§è¡ŒSQLæŸ¥è¯¢</span></span><br><span class="line">        cursor.execute(sql)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è·å–æŸ¥è¯¢ç»“æœï¼ˆä»¥åˆ—è¡¨å½¢å¼ä¿å­˜ï¼‰</span></span><br><span class="line">        result_list = cursor.fetchall()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœéœ€è¦å°†æ¯æ¡è®°å½•è½¬æ¢ä¸ºå­—å…¸ï¼ˆåŒ…å«å­—æ®µåï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç </span></span><br><span class="line">        <span class="comment"># columns = [desc[0] for desc in cursor.description]</span></span><br><span class="line">        <span class="comment"># result_list = [dict(zip(columns, row)) for row in cursor.fetchall()]</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æŸ¥è¯¢æˆåŠŸï¼Œå…±è·å– <span class="subst">&#123;<span class="built_in">len</span>(result_list)&#125;</span> æ¡è®°å½•&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> pymysql.MySQLError <span class="keyword">as</span> e:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®åº“æ“ä½œå‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        result_list = []  <span class="comment"># å‡ºé”™æ—¶è¿”å›ç©ºåˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å…³é—­æ¸¸æ ‡å’Œè¿æ¥</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;cursor&#x27;</span> <span class="keyword">in</span> <span class="built_in">locals</span>() <span class="keyword">and</span> cursor:</span><br><span class="line">            cursor.close()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;connection&#x27;</span> <span class="keyword">in</span> <span class="built_in">locals</span>() <span class="keyword">and</span> connection:</span><br><span class="line">            connection.close()</span><br><span class="line">    <span class="keyword">return</span>  result_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_version_list</span>(<span class="params">reslist</span>):</span><br><span class="line"></span><br><span class="line">    result_tuple=get_select_result()</span><br><span class="line">    <span class="comment"># åˆ›å»ºres_select ä¸­å•†å“ID åˆ°ç‰ˆæœ¬å·å’Œä»·æ ¼çš„æ˜ å°„</span></span><br><span class="line">    <span class="built_in">print</span>(result_tuple)</span><br><span class="line">    res_map = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> result_tuple:</span><br><span class="line">        categories, item_id, title, img_url, price, link, version = item</span><br><span class="line">        res_map[item_id] = (price, <span class="built_in">int</span>(version))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–æ¶ˆæ¯å˜é‡</span></span><br><span class="line">    message = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># ç”¨äºå­˜å‚¨éœ€è¦åˆ é™¤çš„reslist ç´¢å¼•</span></span><br><span class="line">    indices_to_remove = []</span><br><span class="line">    <span class="comment"># å¤„ç†è°ƒä»·å’Œç›¸åŒä»·æ ¼çš„æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">for</span> i, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(reslist):</span><br><span class="line">        categories, item_id, title, img_url, price, link, version = item</span><br><span class="line">        <span class="keyword">if</span> item_id <span class="keyword">in</span> res_map:</span><br><span class="line">            res_price, res_version = res_map[item_id]</span><br><span class="line">            <span class="comment"># æ£€æŸ¥ä»·æ ¼æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">            <span class="keyword">if</span> price == res_price:</span><br><span class="line">                indices_to_remove.append(i)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä»·æ ¼ä¸åŒï¼Œæ›´æ–°ç‰ˆæœ¬å·å¹¶æ·»åŠ è°ƒä»·æ¶ˆæ¯</span></span><br><span class="line">                new_version = res_version + <span class="number">1</span></span><br><span class="line">                reslist[i][<span class="number">6</span>] = <span class="built_in">str</span>(new_version) <span class="comment"># æ›´æ–°ç‰ˆæœ¬å·</span></span><br><span class="line">                message += <span class="string">f&quot;æœ‰è°ƒä»·ï¼šã€åˆ†ç±»ï¼š<span class="subst">&#123;categories&#125;</span>ï¼Œå•†å“idï¼š<span class="subst">&#123;item_id&#125;</span>ï¼Œæ ‡é¢˜ï¼š<span class="subst">&#123;title&#125;</span>ï¼Œä»·æ ¼ï¼š<span class="subst">&#123;res_price&#125;</span>â†’<span class="subst">&#123;price&#125;</span>ï¼Œé“¾æ¥ï¼š<span class="subst">&#123;link&#125;</span>ã€‘\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åå‘åˆ é™¤éœ€è¦ç§»é™¤çš„é¡¹ï¼Œé¿å…ç´¢å¼•å˜åŒ–é—®é¢˜</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">sorted</span>(indices_to_remove, reverse=<span class="literal">True</span>):</span><br><span class="line">        <span class="keyword">del</span> reslist[i]</span><br><span class="line">    <span class="comment"># å¤„ç†ä¸Šæ–°çš„æƒ…å†µ</span></span><br><span class="line">        res_ids = <span class="built_in">set</span>(res_map.keys())</span><br><span class="line">        new_items = [item <span class="keyword">for</span> item <span class="keyword">in</span> reslist <span class="keyword">if</span> item[<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> res_ids]</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> new_items:</span><br><span class="line">            categories, item_id, title, img_url, price, link, version = item</span><br><span class="line">            </span><br><span class="line">            message += <span class="string">f&quot;æœ‰ä¸Šæ–°ï¼šã€åˆ†ç±»ï¼š<span class="subst">&#123;categories&#125;</span>ï¼Œå•†å“idï¼š<span class="subst">&#123;item_id&#125;</span>ï¼Œæ ‡é¢˜ï¼š<span class="subst">&#123;title&#125;</span>ï¼Œä»·æ ¼ï¼š<span class="subst">&#123;price&#125;</span>ï¼Œé“¾æ¥ï¼š<span class="subst">&#123;link&#125;</span>ã€‘\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> reslist,message</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    [[&#x27;R&amp;B&#x27;,&#x27;B0FHJ7BCJ3&#x27;,&#x27;Here For It All&#x27;,&#x27;https://images-na.ssl-images-amazon.com/images/I/61e7eyCsIfL._AC_UL600_SR600,400_.jpg&#x27;,19.98,&#x27;https://www.amazon.com/-/zh/dp/B0FHJ7BCJ3&#x27;,1]]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    reslist,message=update_version_list(args)</span><br><span class="line">    <span class="built_in">print</span>(reslist)</span><br><span class="line">    <span class="built_in">print</span>(message)</span><br><span class="line">    <span class="keyword">return</span> reslist,message</span><br></pre></td></tr></table></figure></li></ol><h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><p><strong>ä¿¡æ¯é€šçŸ¥ç»“æœï¼š</strong><br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727005119.png"><br>æ•°æ®åº“æŸ¥è¯¢ç»“æœï¼š<br><img src="/2025/07/27/projectNote/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%95%86%E5%93%81%E9%9C%80%E6%B1%82/Pasted-image-20250727021136.png"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> å½±åˆ€RPA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frp+æœåŠ¡å™¨:å®ç°å†…ç½‘ç©¿é€</title>
      <link href="/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
      <url>/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯frp"><a href="#ä»€ä¹ˆæ˜¯frp" class="headerlink" title="ä»€ä¹ˆæ˜¯frp"></a>ä»€ä¹ˆæ˜¯frp</h1><ul><li><a href="https://github.com/fatedier/frp">frpå¼€æºåœ°å€</a></li><li><a href="https://gofrp.org/zh-cn/">frpå®‰è£…ä¸­æ–‡æ–‡æ¡£</a></li><li>frpä¸‹è½½åœ°å€ï¼ˆä» Github <a href="https://github.com/fatedier/frp/releases">Release</a> é¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ã€‚ï¼‰</li></ul><p>frp é‡‡ç”¨ C&#x2F;S æ¨¡å¼ï¼Œå°†</p><ol><li><p><strong>æœåŠ¡ç«¯éƒ¨ç½²åœ¨å…·æœ‰å…¬ç½‘ IP çš„æœºå™¨ä¸Šï¼Œ</strong></p></li><li><p><strong>å®¢æˆ·ç«¯éƒ¨ç½²åœ¨å†…ç½‘æˆ–é˜²ç«å¢™å†…çš„æœºå™¨ä¸Šï¼Œé€šè¿‡è®¿é—®æš´éœ²åœ¨æœåŠ¡å™¨ä¸Šçš„ç«¯å£ï¼Œåå‘ä»£ç†åˆ°å¤„äºå†…ç½‘çš„æœåŠ¡ã€‚</strong></p></li></ol><p> åœ¨æ­¤åŸºç¡€ä¸Šï¼Œfrp æ”¯æŒ TCP, UDP, HTTP, HTTPS ç­‰å¤šç§åè®®ï¼Œæä¾›äº†åŠ å¯†ã€å‹ç¼©ï¼Œèº«ä»½è®¤è¯ï¼Œä»£ç†é™é€Ÿï¼Œè´Ÿè½½å‡è¡¡ç­‰ä¼—å¤šèƒ½åŠ›ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ xtcp å®ç° P2P é€šä¿¡ã€‚</p><p><strong>å·¥å…·å‡†å¤‡</strong>ï¼š</p><ol><li><strong>ä¸€å°å…¬ç½‘æœåŠ¡å™¨ï¼Œéƒ¨ç½²æœåŠ¡ç«¯</strong></li><li>ä¸€å°å†…ç½‘æœºå™¨ï¼Œéƒ¨ç½²å®¢æˆ·ç«¯</li><li>frpè½¯ä»¶ï¼šfrpsæœåŠ¡ç«¯+ frpcå®¢æˆ·ç«¯</li></ol><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>ä¸‹è½½frpåˆ†åˆ«ä¸Šä¼ åˆ°æœåŠ¡å™¨å’Œå†…ç½‘æœºå™¨ï¼Œæ ¹æ®æœåŠ¡å™¨å’Œå†…ç½‘æœºå™¨åˆ†åˆ«ä¸‹è½½å¯¹åº”æ¶æ„çš„frpç‰ˆæœ¬</p><ul><li>amdç›¸å½“äºx86ï¼Œæ˜¯64ä½æŒ‡ä»¤çš„æ“ä½œç³»ç»Ÿæ¶æ„</li><li>arm64æ˜¯64ä½ç²¾ç®€æŒ‡ä»¤çš„æ“ä½œç³»ç»Ÿæ¶æ„ï¼Œç‰¹ç‚¹ä½èƒ½è€—ï¼Œè¢«å¹¿æ³›åº”ç”¨å°è®¾å¤‡å’Œç§»åŠ¨è®¾å¤‡</li></ul><h2 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h2><h3 id="æœåŠ¡å™¨è§£å‹frp"><a href="#æœåŠ¡å™¨è§£å‹frp" class="headerlink" title="æœåŠ¡å™¨è§£å‹frp"></a>æœåŠ¡å™¨è§£å‹frp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf frp_0.63.0_linux_amd64.tar.gz</span><br><span class="line"><span class="built_in">mv</span> frp_0.63.0_linux_amd64 /usr/local/frp</span><br><span class="line"><span class="built_in">rm</span> -f /usr/local/frp/frpc <span class="comment"># æœåŠ¡ç«¯ä¸éœ€è¦å®¢æˆ·ç«¯äº†</span></span><br><span class="line"><span class="built_in">rm</span> -f /usr/local/frp/frpc.toml <span class="comment"># æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ä¸éœ€è¦å®¢æˆ·ç«¯äº†</span></span><br></pre></td></tr></table></figure><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><ol><li>è®¾ç½®é…ç½®æ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /etc/frp</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/frp/frps.toml /etc/frp/frps.toml</span><br></pre></td></tr></table></figure><ol start="2"><li>é…ç½®frps.tomlæ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/frp/frps.toml</span><br></pre></td></tr></table></figure><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›‘å¬ç«¯å£ï¼Œè®°å¾—æœåŠ¡å™¨é˜²ç«å¢™è¦æ‰“å¼€</span></span><br><span class="line"><span class="attr">bindPort</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="attr">webServer.addr</span> = <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"><span class="comment"># ç½‘é¡µä»ªè¡¨ç›˜ç«¯å£ï¼Œè®°å¾—é˜²ç«å¢™æ‰“å¼€</span></span><br><span class="line"><span class="attr">webServer.port</span> = <span class="number">7500</span></span><br><span class="line"><span class="attr">webServer.user</span> = <span class="string">&quot;admin&quot;</span></span><br><span class="line"><span class="attr">webServer.password</span> = <span class="string">&quot;å¯†ç &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">auth.method</span>=<span class="string">&quot;token&quot;</span></span><br><span class="line"><span class="attr">auth.token</span> = <span class="string">&quot;thisisatoken&quot;</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p>åˆ©ç”¨systemdå¯åŠ¨åå°è¿›ç¨‹æŒ‚è½½</p><p>åˆ›å»ºserviceæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/systemd/system/frps.service</span><br></pre></td></tr></table></figure><p>frps.serviceå†…å®¹:</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span> = frp server</span><br><span class="line"><span class="attr">After</span> = network.target syslog.target</span><br><span class="line"><span class="attr">Wants</span> = network.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">ExecStart</span> = /usr/local/frp/frps -c /etc/frp/frps.toml</span><br><span class="line"></span><br><span class="line"><span class="attr">ExecStop</span>=/bin/kill <span class="variable">$MAINPID</span></span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"><span class="attr">RestartSec</span>=<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span> = multi-user.target</span><br></pre></td></tr></table></figure></li></ol><h3 id="æœåŠ¡ç«¯å¯åŠ¨"><a href="#æœåŠ¡ç«¯å¯åŠ¨" class="headerlink" title="æœåŠ¡ç«¯å¯åŠ¨"></a>æœåŠ¡ç«¯å¯åŠ¨</h3>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡è½½é…ç½®</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">systemctl start frps.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status frps.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">systemctl stop frps.service</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ frps æœåŠ¡çš„æœ€æ–°æ—¥å¿—</span></span><br><span class="line">journalctl -u frps</span><br><span class="line">   </span><br><span class="line"><span class="comment"># å®æ—¶è·Ÿè¸ªæ—¥å¿—ï¼ˆç±»ä¼¼ tail -fï¼‰</span></span><br><span class="line">journalctl -u frps -f</span><br><span class="line">   </span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœ€è¿‘ N è¡Œæ—¥å¿—</span></span><br><span class="line">journalctl -u frps -n 100</span><br></pre></td></tr></table></figure><p><img src="/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20250725145119696.png" alt="image-20250725145119696"></p><p>è®¾ç½®å¼€æœºè‡ªå¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> frps</span><br></pre></td></tr></table></figure><p>éªŒè¯å¼€æœºè‡ªå¯æ˜¯å¦ç”Ÿæ•ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status frps</span><br></pre></td></tr></table></figure><p><img src="/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20250725145855822.png" alt="image-20250725145855822"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl is-enabled frps  <span class="comment"># è¾“å‡º enabled åˆ™è¡¨ç¤ºæˆåŠŸ</span></span><br></pre></td></tr></table></figure><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><h3 id="å†…ç½‘æœºå™¨è§£å‹"><a href="#å†…ç½‘æœºå™¨è§£å‹" class="headerlink" title="å†…ç½‘æœºå™¨è§£å‹"></a>å†…ç½‘æœºå™¨è§£å‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf frp_0.63.0_linux_arm64.tar.gz</span><br><span class="line"><span class="built_in">mv</span> frp_0.63.0_linux_arm64 /usr/local/frp</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -f /usr/local/frp/frps <span class="comment"># ä¸éœ€è¦æœåŠ¡ç«¯äº†</span></span><br><span class="line"><span class="built_in">rm</span> -f /usr/local/frp/frps.toml <span class="comment"># ä¸éœ€è¦æœåŠ¡ç«¯äº†</span></span><br></pre></td></tr></table></figure><h3 id="é…ç½®æ–‡ä»¶-1"><a href="#é…ç½®æ–‡ä»¶-1" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><ol><li>è®¾ç½®é…ç½®æ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /etc/frp</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/frp/frpc.toml /etc/frp/frpc.toml</span><br></pre></td></tr></table></figure><ol start="2"><li>é…ç½®frpc.tomlæ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/frp/frpc.toml</span><br></pre></td></tr></table></figure><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /ect/frp/frpc.tpml</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½ çš„äº‘æœåŠ¡å™¨å…¬ç½‘ip</span></span><br><span class="line"><span class="attr">serverAddr</span> = <span class="string">&quot;å…¬ç½‘ip&quot;</span></span><br><span class="line"><span class="comment">#è¿æ¥åˆ°äº‘æœåŠ¡å™¨ç«¯å£,éœ€è¦å’Œfrps.tomlé…ç½®æ–‡ä»¶ä¸­ç«¯å£ä¸€è‡´</span></span><br><span class="line"><span class="attr">serverPort</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="attr">auth.method</span> = <span class="string">&quot;token&quot;</span></span><br><span class="line"><span class="attr">auth.token</span> = <span class="string">&quot;thisisatoken&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å†…ç½‘æœåŠ¡å™¨çš„ç»ˆç«¯è¿æ¥</span></span><br><span class="line"><span class="section">[[proxies]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;frp-ssh&quot;</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;tcp&quot;</span></span><br><span class="line"><span class="attr">localIP</span> = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="attr">localPort</span> = <span class="number">22</span></span><br><span class="line"><span class="attr">remotePort</span> = <span class="number">6000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å†…ç½‘æœåŠ¡å™¨çš„nextcloudè¿æ¥</span></span><br><span class="line"><span class="section">[[proxies]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;frp-nextcloud&quot;</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;tcp&quot;</span></span><br><span class="line"><span class="attr">localIP</span> = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="attr">localPort</span> = <span class="number">40070</span></span><br><span class="line"><span class="attr">remotePort</span> = <span class="number">8080</span></span><br></pre></td></tr></table></figure><p><strong>remotePortç«¯å£è®°å¾—æœåŠ¡å™¨é˜²ç«å¢™æ‰“å¼€</strong></p><ol start="3"><li><p>åˆ©ç”¨systemdå¯åŠ¨åå°è¿›ç¨‹æŒ‚è½½<br> åˆ›å»ºserviceæ–‡ä»¶</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/systemd/system/frpc.service</span><br></pre></td></tr></table></figure><p> frps.serviceå†…å®¹:</p> <figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=FRP Client Service</span><br><span class="line"><span class="attr">After</span>=network.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">User</span>=frp</span><br><span class="line"><span class="attr">Group</span>=frp</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/local/frp/frpc -c /etc/frp/frpc.toml</span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"><span class="attr">RestartSec</span>=<span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure><h3 id="å¯èƒ½å‘ç”Ÿçš„é”™è¯¯"><a href="#å¯èƒ½å‘ç”Ÿçš„é”™è¯¯" class="headerlink" title="å¯èƒ½å‘ç”Ÿçš„é”™è¯¯"></a>å¯èƒ½å‘ç”Ÿçš„é”™è¯¯</h3><ol><li><strong>ç”¨æˆ· &#x2F; ç»„æ˜¯å¦å­˜åœ¨</strong><br>é…ç½®ä¸­æŒ‡å®šäº† <code>User=frp</code> å’Œ <code>Group=frp</code>ï¼Œéœ€ç¡®è®¤ç³»ç»Ÿä¸­æ˜¯å¦çœŸçš„å­˜åœ¨ <code>frp</code> ç”¨æˆ·å’ŒåŒåç»„ã€‚å¦‚æœä¸å­˜åœ¨ï¼ŒæœåŠ¡ä¼šå› æ— æ³•åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·è€Œå¯åŠ¨å¤±è´¥ã€‚<br>æ£€æŸ¥å‘½ä»¤ï¼š<code>id frp</code>ï¼ˆè‹¥è¿”å›æ— æ­¤ç”¨æˆ·ï¼Œåˆ™éœ€åˆ›å»ºï¼š<code>sudo useradd -r -s /sbin/nologin frp</code>ï¼‰ã€‚</li><li><strong>æ–‡ä»¶æƒé™æ˜¯å¦åŒ¹é…</strong><br><code>frp</code> ç”¨æˆ·éœ€è¦å¯¹ä»¥ä¸‹æ–‡ä»¶æœ‰å¯¹åº”æƒé™ï¼š<ul><li><code>/usr/local/frp/frpc</code>ï¼šéœ€æœ‰å¯æ‰§è¡Œæƒé™ï¼ˆ<code>chmod +x</code>ï¼‰ã€‚</li><li><code>/etc/frp/frpc.toml</code>ï¼šéœ€æœ‰è¯»å–æƒé™ï¼ˆå¯è®¾ç½®ä¸º <code>chmod 644</code> å¹¶ç¡®ä¿æ‰€æœ‰è€…æˆ–ç»„åŒ…å« <code>frp</code>ï¼‰ã€‚</li></ul></li><li><strong>è·¯å¾„æ˜¯å¦æ­£ç¡®</strong><br>ç¡®è®¤ <code>ExecStart</code> ä¸­ <code>frpc</code> ç¨‹åºè·¯å¾„ï¼ˆ<code>/usr/local/frp/frpc</code>ï¼‰å’Œé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆ<code>/etc/frp/frpc.toml</code>ï¼‰æ˜¯å¦ä¸å®é™…å­˜æ”¾ä½ç½®ä¸€è‡´ï¼Œè·¯å¾„é”™è¯¯ä¼šå¯¼è‡´å¯åŠ¨å¤±è´¥ã€‚</li></ol><h3 id="å®¢æˆ·ç«¯å¯åŠ¨"><a href="#å®¢æˆ·ç«¯å¯åŠ¨" class="headerlink" title="å®¢æˆ·ç«¯å¯åŠ¨"></a>å®¢æˆ·ç«¯å¯åŠ¨</h3><pre><code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡è½½é…ç½®</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">systemctl start frpc.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status frpc.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">systemctl stop frpc.service</span><br></pre></td></tr></table></figure></code></pre><p> æŸ¥çœ‹æ—¥å¿—</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ frps æœåŠ¡çš„æœ€æ–°æ—¥å¿—</span></span><br><span class="line">journalctl -u frpc</span><br><span class="line">   </span><br><span class="line"><span class="comment"># å®æ—¶è·Ÿè¸ªæ—¥å¿—ï¼ˆç±»ä¼¼ tail -fï¼‰</span></span><br><span class="line">journalctl -u frpc -f</span><br><span class="line">   </span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœ€è¿‘ N è¡Œæ—¥å¿—</span></span><br><span class="line">journalctl -u frpc -n 100</span><br></pre></td></tr></table></figure><p> <img src="/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20250725152322309.png" alt="image-20250725152322309"></p><p> è®¾ç½®å¼€æœºè‡ªå¯</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> frpc</span><br></pre></td></tr></table></figure><p> éªŒè¯å¼€æœºè‡ªå¯æ˜¯å¦ç”Ÿæ•ˆ</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status frpc</span><br></pre></td></tr></table></figure><p> <img src="/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20250725152426082.png" alt="image-20250725152426082"></p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl is-enabled frps  <span class="comment"># è¾“å‡º enabled åˆ™è¡¨ç¤ºæˆåŠŸ</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="ç½‘é¡µä»ªè¡¨ç›˜"><a href="#ç½‘é¡µä»ªè¡¨ç›˜" class="headerlink" title="ç½‘é¡µä»ªè¡¨ç›˜"></a>ç½‘é¡µä»ªè¡¨ç›˜</h2><p><img src="/2025/07/25/frp-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20250725152625076.png" alt="image-20250725152625076"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº¬ä¸œRPAçˆ¬è™«</title>
      <link href="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/"/>
      <url>/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">å•†å“ ID item_id </span><br><span class="line">å•†å“é“¾æ¥ item_link </span><br><span class="line">æ ‡é¢˜ item_title </span><br><span class="line">â»”åº—åç§° store </span><br><span class="line">å°â¾¯ cover_link </span><br><span class="line">åŸä»· original_cost </span><br><span class="line">æŠ˜æ‰£ä»· discount_cost </span><br><span class="line">å“ç‰Œ brand </span><br><span class="line">å‹å· type </span><br><span class="line">è¯„è®ºæ•° comments</span><br></pre></td></tr></table></figure><h1 id="mysqlæ•°æ®åº“å»ºè¡¨"><a href="#mysqlæ•°æ®åº“å»ºè¡¨" class="headerlink" title="mysqlæ•°æ®åº“å»ºè¡¨"></a>mysqlæ•°æ®åº“å»ºè¡¨</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `jd_items` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;è‡ªå¢ä¸»é”®&#x27;</span>,</span><br><span class="line">  `item_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å•†å“ID&#x27;</span>,</span><br><span class="line">  `item_link` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;åœ°å€ httpå¼€å¤´&#x27;</span>,</span><br><span class="line">  `store` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;é—¨åº—åç§°&#x27;</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å•†å“æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  `cover_url` <span class="type">varchar</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;å›¾ç‰‡URLåœ°å€,httpå¼€å¤´&#x27;</span>,</span><br><span class="line">  `ori_price` <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;åŸä»·&#x27;</span>,</span><br><span class="line">  `price` <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;æŠ˜æ‰£ä»·&#x27;</span>,</span><br><span class="line">  `brand` <span class="type">varchar</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;å“ç‰Œ&#x27;</span>,</span><br><span class="line">  `brand_type` <span class="type">varchar</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;å“ç‰Œå‹å·&#x27;</span>,</span><br><span class="line">  `comment` <span class="type">varchar</span>(<span class="number">32</span>) COMMENT <span class="string">&#x27;è¯„è®ºæ•°&#x27;</span>,</span><br><span class="line">  `created_at` datetime <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;å†™å…¥æ—¶é—´ï¼ˆè‡ªåŠ¨å¡«å……ï¼‰&#x27;</span>,</span><br><span class="line">  `updated_at` datetime <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰&#x27;</span>,</span><br><span class="line">  `student` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å§“å å†™ä¸­æ–‡&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`) <span class="comment">-- è‡ªå¢å­—æ®µä½œä¸ºå•ä¸€ä¸»é”®</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure><h1 id="å½±åˆ€RPAæµç¨‹"><a href="#å½±åˆ€RPAæµç¨‹" class="headerlink" title="å½±åˆ€RPAæµç¨‹"></a>å½±åˆ€RPAæµç¨‹</h1><h2 id="ä¸»æµç¨‹"><a href="#ä¸»æµç¨‹" class="headerlink" title="ä¸»æµç¨‹"></a>ä¸»æµç¨‹</h2><p><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image-20250724170315317.png" alt="image-20250724170315317"></p><h2 id="è·å–å•†å“è¯¦æƒ…å­æµç¨‹"><a href="#è·å–å•†å“è¯¦æƒ…å­æµç¨‹" class="headerlink" title="è·å–å•†å“è¯¦æƒ…å­æµç¨‹"></a>è·å–å•†å“è¯¦æƒ…å­æµç¨‹</h2><h2 id=""><a href="#" class="headerlink" title=""></a><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image2.png" alt="image2"></h2><p>æ³¨æ„ï¼š</p><ol><li>æ¯ä¸€ä¸ªæ¨¡å—éƒ½è¦åšå¥½å¼‚å¸¸å¤„ç†</li><li>å®šä½ç½‘é¡µæ•°æ®æœ€å¥½ä½¿ç”¨xpathæ–¹æ³•</li></ol><h2 id="æ•°æ®æ¸…æ´—cleanå­æµç¨‹"><a href="#æ•°æ®æ¸…æ´—cleanå­æµç¨‹" class="headerlink" title="æ•°æ®æ¸…æ´—cleanå­æµç¨‹"></a>æ•°æ®æ¸…æ´—cleanå­æµç¨‹</h2><p><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image-20250724172733228.png" alt="image-20250724172733228"></p><h2 id="ä¸»æµç¨‹çš„æ•°æ®å…¥åº“"><a href="#ä¸»æµç¨‹çš„æ•°æ®å…¥åº“" class="headerlink" title="ä¸»æµç¨‹çš„æ•°æ®å…¥åº“"></a>ä¸»æµç¨‹çš„æ•°æ®å…¥åº“</h2><p><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image-20250724173301380.png" alt="image-20250724173301380"></p><h3 id="æ‰¹é‡æ’å…¥æ•°æ®"><a href="#æ‰¹é‡æ’å…¥æ•°æ®" class="headerlink" title="æ‰¹é‡æ’å…¥æ•°æ®"></a>æ‰¹é‡æ’å…¥æ•°æ®</h3><p><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image-20250724173334083.png" alt="image-20250724173334083"></p><p>â€‹                       <strong>invoke_resultæ˜¯å­æµç¨‹è¿”å›çš„å…ƒç»„ï¼Œè¿”å›çš„æ•°æ®éƒ½åœ¨å…ƒç»„é‡Œé¢ã€‚</strong></p><p><strong>æ—¥å¿—</strong></p><p><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image-20250724183805616.png" alt="image-20250724183805616"></p><h1 id="æ•°æ®åº“æŸ¥è¯¢ç»“æœ"><a href="#æ•°æ®åº“æŸ¥è¯¢ç»“æœ" class="headerlink" title="æ•°æ®åº“æŸ¥è¯¢ç»“æœ"></a>æ•°æ®åº“æŸ¥è¯¢ç»“æœ</h1><p><img src="/2025/07/24/projectNote/%E4%BA%AC%E4%B8%9CRPA%E7%88%AC%E8%99%AB/image-20250724183925770.png" alt="image-20250724183925770"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sql </tag>
            
            <tag> RPA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoåšå®¢éƒ¨ç½²äº‘æœåŠ¡å™¨</title>
      <link href="/2025/07/21/hexo%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2025/07/21/hexo%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="hexoåšå®¢éƒ¨ç½²äº‘æœåŠ¡å™¨"><a href="#hexoåšå®¢éƒ¨ç½²äº‘æœåŠ¡å™¨" class="headerlink" title="hexoåšå®¢éƒ¨ç½²äº‘æœåŠ¡å™¨"></a>hexoåšå®¢éƒ¨ç½²äº‘æœåŠ¡å™¨</h1><h2 id="å®‰è£…éœ€è¦çš„ä¾èµ–"><a href="#å®‰è£…éœ€è¦çš„ä¾èµ–" class="headerlink" title="å®‰è£…éœ€è¦çš„ä¾èµ–"></a>å®‰è£…éœ€è¦çš„ä¾èµ–</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y curl-devel expat-devel gettext-devel openssl-devel zlib-devel</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…ç¼–è¯‘å·¥å…·"><a href="#å®‰è£…ç¼–è¯‘å·¥å…·" class="headerlink" title="å®‰è£…ç¼–è¯‘å·¥å…·"></a>å®‰è£…ç¼–è¯‘å·¥å…·</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gcc perl-ExtUtils-MakeMaker package</span><br></pre></td></tr></table></figure><h2 id="æ£€æŸ¥Gitæ˜¯å¦å®‰è£…"><a href="#æ£€æŸ¥Gitæ˜¯å¦å®‰è£…" class="headerlink" title="æ£€æŸ¥Gitæ˜¯å¦å®‰è£…"></a>æ£€æŸ¥Gitæ˜¯å¦å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version </span><br></pre></td></tr></table></figure><h2 id="å®‰è£…Gitï¼šå·²ç»å®‰è£…è¿‡çš„å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥"><a href="#å®‰è£…Gitï¼šå·²ç»å®‰è£…è¿‡çš„å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥" class="headerlink" title="å®‰è£…Gitï¼šå·²ç»å®‰è£…è¿‡çš„å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥"></a>å®‰è£…Gitï¼šå·²ç»å®‰è£…è¿‡çš„å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install git -y </span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¯†ç "><a href="#æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¯†ç " class="headerlink" title="æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¯†ç "></a>æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¯†ç </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd git </span><br><span class="line">passwd git </span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºåšå®¢ç›®å½•"><a href="#åˆ›å»ºåšå®¢ç›®å½•" class="headerlink" title="åˆ›å»ºåšå®¢ç›®å½•"></a>åˆ›å»ºåšå®¢ç›®å½•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /home/blog </span><br></pre></td></tr></table></figure><h2 id="ç»™åšå®¢ç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™"><a href="#ç»™åšå®¢ç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™" class="headerlink" title="ç»™åšå®¢ç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™"></a>ç»™åšå®¢ç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> -R a+rw /home/blog </span><br></pre></td></tr></table></figure><h2 id="å»ºç«‹Gitä»“åº“"><a href="#å»ºç«‹Gitä»“åº“" class="headerlink" title="å»ºç«‹Gitä»“åº“"></a>å»ºç«‹Gitä»“åº“</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/git git init --bare blog.git </span><br></pre></td></tr></table></figure><h2 id="ç»™Gitç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™"><a href="#ç»™Gitç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™" class="headerlink" title="ç»™Gitç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™"></a>ç»™Gitç›®å½•å¢åŠ ç›¸åº”è¯»å†™æƒé™</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> -R a+rw /home/git </span><br></pre></td></tr></table></figure><h2 id="æ–°å»ºé’©å­æ–‡ä»¶"><a href="#æ–°å»ºé’©å­æ–‡ä»¶" class="headerlink" title="æ–°å»ºé’©å­æ–‡ä»¶"></a>æ–°å»ºé’©å­æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /home/git/blog.git/hooks/post-receive </span><br></pre></td></tr></table></figure><h2 id="åœ¨æ–‡ä»¶ä¸­æ·»åŠ "><a href="#åœ¨æ–‡ä»¶ä¸­æ·»åŠ " class="headerlink" title="åœ¨æ–‡ä»¶ä¸­æ·»åŠ "></a>åœ¨æ–‡ä»¶ä¸­æ·»åŠ </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --work-tree=/home/blog --git-dir=/home/git/blog.git checkout -f master</span><br></pre></td></tr></table></figure><p>è¿™å¥å‘½ä»¤æ˜¯å°†å­˜å‚¨åº“<code>/home/git/blog.git</code>å¼ºåˆ¶æ£€å‡ºå¹¶å°†æ–‡ä»¶æ”¾ç½®åˆ°æŒ‡å®šçš„å·¥ä½œæ ‘ç›®å½•<code>/home/blog</code>æœ€ç»ˆåšå®¢ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ˜¯å­˜å‚¨åˆ°&#x2F;home&#x2F;blogæ–‡ä»¶å¤¹ä¸‹çš„</p><h2 id="ç»™é’©å­æ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™"><a href="#ç»™é’©å­æ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™" class="headerlink" title="ç»™é’©å­æ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™"></a>ç»™é’©å­æ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x /home/git/blog.git/hooks/post-receive </span><br></pre></td></tr></table></figure><h1 id="å®‰è£…Nginx"><a href="#å®‰è£…Nginx" class="headerlink" title="å®‰è£…Nginx"></a>å®‰è£…Nginx</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx -y </span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨Nginx"><a href="#å¯åŠ¨Nginx" class="headerlink" title="å¯åŠ¨Nginx"></a>å¯åŠ¨Nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start nginx.service </span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨è¾“å…¥ipåœ°å€æ˜¾ç¤ºï¼š</p><p><img src="/2025/07/21/hexo%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/image-20250721190659065.png" alt="image-20250721190659065"></p><p>æ˜¾ç¤ºå¦‚ä¸Šï¼Œè¿™nginxå¯åŠ¨æˆåŠŸ</p><h2 id="æŸ¥çœ‹Nginxé…ç½®æ–‡ä»¶è·¯å¾„"><a href="#æŸ¥çœ‹Nginxé…ç½®æ–‡ä»¶è·¯å¾„" class="headerlink" title="æŸ¥çœ‹Nginxé…ç½®æ–‡ä»¶è·¯å¾„"></a>æŸ¥çœ‹Nginxé…ç½®æ–‡ä»¶è·¯å¾„</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t </span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹Nginxçš„é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹Nginxçš„é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹Nginxçš„é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹Nginxçš„é…ç½®æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nginx/nginx.conf  </span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè‡ªå·±ä¸»æœºä¸Šçš„Nginxçš„é…ç½®æ–‡ä»¶è·¯å¾„</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">server</span> &#123;</span><br><span class="line">       <span class="string">listen</span>       <span class="number">80</span><span class="string">;</span></span><br><span class="line">       <span class="string">listen</span>       [<span class="string">::</span>]<span class="string">:80;</span></span><br><span class="line">       <span class="string">server_name</span>  <span class="string">æœåŠ¡å™¨çš„IPåœ°å€æˆ–åŸŸå;</span></span><br><span class="line">       <span class="string">root</span>         <span class="string">åšå®¢å­˜æ”¾çš„è·¯å¾„;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment"># Load configuration files for the default server block.</span></span><br><span class="line">       <span class="string">include</span> <span class="string">/etc/nginx/default.d/*.conf;</span></span><br><span class="line"></span><br><span class="line">       <span class="string">error_page</span> <span class="number">404</span> <span class="string">/404.html;</span></span><br><span class="line">       <span class="string">location</span> <span class="string">=</span> <span class="string">/404.html</span> &#123;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="string">error_page</span> <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span> <span class="string">/50x.html;</span></span><br><span class="line">       <span class="string">location</span> <span class="string">=</span> <span class="string">/50x.html</span> &#123;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é‡å¯Nginx"><a href="#é‡å¯Nginx" class="headerlink" title="é‡å¯Nginx"></a>é‡å¯Nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx.service </span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨Git-Bashè¿›å…¥Windowsç«¯åšå®¢ç›®å½•"><a href="#ä½¿ç”¨Git-Bashè¿›å…¥Windowsç«¯åšå®¢ç›®å½•" class="headerlink" title="ä½¿ç”¨Git Bashè¿›å…¥Windowsç«¯åšå®¢ç›®å½•"></a>ä½¿ç”¨Git Bashè¿›å…¥Windowsç«¯åšå®¢ç›®å½•</h1><h2 id="ä¿®æ”¹Hexoåšå®¢çš„æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹Hexoåšå®¢çš„æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹Hexoåšå®¢çš„æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹Hexoåšå®¢çš„æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim _config.yaml</span><br></pre></td></tr></table></figure><p>åˆ°æ–‡ä»¶åº•éƒ¨ä¿®æ”¹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">   <span class="attr">repo:</span> <span class="string">git@æœåŠ¡å™¨IPæˆ–åŸŸå:/home/git/blog.git</span></span><br><span class="line">   <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤æœ¬åœ°windowçš„æ–‡ä»¶</p><p>æ–‡ä»¶è·¯å¾„ç¤ºä¾‹ï¼š<code>C:\Users\ç”¨æˆ·å\.ssh</code>ï¼Œä¸­çš„<code>known_hosts.old</code>å’Œ<code>known_hosts</code>ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><h2 id="ä¸Šä¼ éƒ¨ç½²"><a href="#ä¸Šä¼ éƒ¨ç½²" class="headerlink" title="ä¸Šä¼ éƒ¨ç½²"></a>ä¸Šä¼ éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><h1 id="å¸¸è§é”™è¯¯"><a href="#å¸¸è§é”™è¯¯" class="headerlink" title="å¸¸è§é”™è¯¯"></a>å¸¸è§é”™è¯¯</h1><p><img src="/2025/07/21/hexo%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/image-20250721191956974.png" alt="image-20250721191956974"></p><p>é”™è¯¯åŸå› å¯èƒ½æ˜¯ä»“åº“å¤ªå¹²å‡€äº†ï¼Œæ²¡æœ‰README.mdæ–‡ä»¶</p><p>åœ¨æœåŠ¡å™¨çš„<code>/home/git/blog.git</code>ç›®å½•ä¸‹æ‰§è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œè®©å®ƒè¯†åˆ«å‡ºæ¥æ˜¯masteråˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;My Hexo Blog&quot;</span> &gt; README.md</span><br></pre></td></tr></table></figure><p>å†é‡æ–°ä¸Šä¼ éƒ¨ç½²</p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo and Typora: å®Œç¾çš„å†™ä½œç»„åˆ</title>
      <link href="/2025/07/20/Hexo%20and%20Typora/"/>
      <url>/2025/07/20/Hexo%20and%20Typora/</url>
      
        <content type="html"><![CDATA[<h1 id="github-Hexo-Typora-åšå®¢åˆ›å»º"><a href="#github-Hexo-Typora-åšå®¢åˆ›å»º" class="headerlink" title="github + Hexo + Typora åšå®¢åˆ›å»º"></a>github + Hexo + Typora åšå®¢åˆ›å»º</h1><h1 id="å‚è€ƒæ•™ç¨‹"><a href="#å‚è€ƒæ•™ç¨‹" class="headerlink" title="å‚è€ƒæ•™ç¨‹"></a>å‚è€ƒæ•™ç¨‹</h1><h2 id="ä»0å¼€å§‹åˆ°éƒ¨ç½²åˆ°github"><a href="#ä»0å¼€å§‹åˆ°éƒ¨ç½²åˆ°github" class="headerlink" title="ä»0å¼€å§‹åˆ°éƒ¨ç½²åˆ°github"></a>ä»0å¼€å§‹åˆ°éƒ¨ç½²åˆ°github</h2><ul><li><a href="https://blog.csdn.net/sinat_37781304/article/details/82729029?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165856718216782391857659%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165856718216782391857659&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-82729029-null-null.142%5Ev33%5Eexperiment_2_v1,185%5Ev2%5Econtrol&utm_term=hexo&spm=1018.2226.3001.4187">hexoå²ä¸Šæœ€å…¨æ­å»ºæ•™ç¨‹</a></li><li><a href="https://hexo.io/zh-cn/docs/">æ–‡æ¡£ | Hexo</a></li><li><a href="https://moeci.com/posts/hexo-typora/">Hexo + Typora + å¼€å‘Hexoæ’ä»¶ è§£å†³å›¾ç‰‡è·¯å¾„ä¸ä¸€è‡´</a></li><li><a href="https://github.com/yiyungent/hexo-asset-img">å›¾ç‰‡æ’ä»¶å¼€æºåœ°å€</a></li><li><a href="https://h-sanae.github.io/2025/06/07/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/GitHub+Hexo%E5%8D%9A%E5%AE%A2%E5%88%9B%E5%BB%BA/">æœ¬æ–‡å¤§éƒ¨åˆ†å†…å®¹å‡ºå¤„</a></li></ul><h2 id="åŸºæœ¬æ­¥éª¤"><a href="#åŸºæœ¬æ­¥éª¤" class="headerlink" title="åŸºæœ¬æ­¥éª¤"></a>åŸºæœ¬æ­¥éª¤</h2><h3 id="1-å®‰è£…git"><a href="#1-å®‰è£…git" class="headerlink" title="1. å®‰è£…git"></a>1. å®‰è£…git</h3><h3 id="2-å®‰è£…nodejs"><a href="#2-å®‰è£…nodejs" class="headerlink" title="2. å®‰è£…nodejs"></a>2. å®‰è£…nodejs</h3><h3 id="3-å®‰è£…hexo"><a href="#3-å®‰è£…hexo" class="headerlink" title="3. å®‰è£…hexo"></a>3. å®‰è£…hexo</h3><p>å‰é¢gitå’Œnodejså®‰è£…å¥½åï¼Œå°±å¯ä»¥å®‰è£…hexoäº†ï¼Œä½ å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹Blogï¼Œç„¶å<code>cd</code>åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ˆæˆ–è€…åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ç›´æ¥å³é”®git bashæ‰“å¼€ï¼‰ã€‚</p><p>è¾“å…¥å‘½ä»¤å®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç‰ˆæœ¬å‘½ä»¤ï¼š<code>hexo -v</code></p><p>åˆå§‹åŒ–hexo</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init myblog</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªmyblogå¯ä»¥è‡ªå·±å–ä»€ä¹ˆåå­—éƒ½è¡Œï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ï¼ˆBlogï¼‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªmyblogæ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> myblog <span class="comment">#è¿›å…¥è¿™ä¸ªmyblogæ–‡ä»¶å¤¹</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>æ–°å»ºå®Œæˆåï¼ŒæŒ‡å®šæ–‡ä»¶å¤¹ç›®å½•ä¸‹æœ‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">YaoYinjin@LAPTOP-3VRKRFG2 MINGW64 /e/blog/myblog</span><br><span class="line">$ tree -L 1</span><br><span class="line">.</span><br><span class="line">|-- _config.landscape.yml</span><br><span class="line">|-- _config.yml <span class="comment">#åšå®¢çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">|-- db.json</span><br><span class="line">|-- node_modules   <span class="comment">#ä¾èµ–åŒ…</span></span><br><span class="line">|-- package-lock.json</span><br><span class="line">|-- package.json</span><br><span class="line">|-- public <span class="comment">#å­˜æ”¾ç”Ÿæˆçš„é¡µé¢</span></span><br><span class="line">|-- scaffolds <span class="comment">#ç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿</span></span><br><span class="line">|-- <span class="built_in">source</span> <span class="comment">#ç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç« </span></span><br><span class="line">`-- themes <span class="comment">#ä¸»é¢˜</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€hexoçš„æœåŠ¡ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ localhost:4000 å°±å¯ä»¥çœ‹åˆ°ä½ ç”Ÿæˆçš„åšå®¢äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ctrl+cå¯ä»¥æŠŠæœåŠ¡å…³æ‰</p><h3 id="4-GitHubåˆ›å»ºä¸ªäººä»“åº“"><a href="#4-GitHubåˆ›å»ºä¸ªäººä»“åº“" class="headerlink" title="4. GitHubåˆ›å»ºä¸ªäººä»“åº“"></a>4. GitHubåˆ›å»ºä¸ªäººä»“åº“</h3><p>åˆ›å»ºä¸€ä¸ªå’Œä½ ç”¨æˆ·åç›¸åŒçš„ä»“åº“ï¼Œåé¢åŠ .github.ioï¼Œåªæœ‰è¿™æ ·ï¼Œå°†æ¥è¦éƒ¨ç½²åˆ°GitHub pageçš„æ—¶å€™ï¼Œæ‰ä¼šè¢«è¯†åˆ«ï¼Œä¹Ÿå°±æ˜¯xxxx.github.ioï¼Œå…¶ä¸­xxxå°±æ˜¯ä½ æ³¨å†ŒGitHubçš„ç”¨æˆ·å</p><h3 id="5-ç”ŸæˆSSHæ·»åŠ åˆ°GitHub"><a href="#5-ç”ŸæˆSSHæ·»åŠ åˆ°GitHub" class="headerlink" title="5. ç”ŸæˆSSHæ·»åŠ åˆ°GitHub"></a>5. ç”ŸæˆSSHæ·»åŠ åˆ°GitHub</h3><p>å›åˆ°ä½ çš„git bashä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;yourname&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;youremail&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ yourname è¾“å…¥ä½ çš„GitHubç”¨æˆ·åï¼Œyouremail è¾“å…¥ä½ GitHubçš„é‚®ç®±ï¼ˆåŒå¼•å·ä¿ç•™ï¼‰</p><p>ç„¶ååˆ›å»ºSSHï¼Œä¸€è·¯å›è½¦(åº”è¯¥æœ‰3æ¬¡å›è½¦)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;youremail&quot;</span></span><br></pre></td></tr></table></figure><p>ç»ˆä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶åœ¨ç”¨æˆ·ç›®å½•ä¸‹ï¼Œæ‰“å¼€ç”¨æˆ·ç›®å½•ï¼Œæ‰¾åˆ°<code>.ssh\id_rsa.pub</code>æ–‡ä»¶ï¼Œè®°äº‹æœ¬æ‰“å¼€å¹¶å¤åˆ¶é‡Œé¢çš„å†…å®¹ï¼Œæ‰“å¼€ä½ çš„githubä¸»é¡µï¼Œè¿›å…¥ä¸ªäººè®¾ç½® -&gt; SSH and GPG keys -&gt; New SSH key<br>å°†åˆšå¤åˆ¶çš„å†…å®¹ç²˜è´´åˆ°keyé‚£é‡Œï¼Œtitleéšä¾¿å¡«ï¼Œä¿å­˜</p><p>æµ‹è¯•æ˜¯å¦æˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com <span class="comment"># æ³¨æ„é‚®ç®±åœ°å€ä¸ç”¨æ”¹</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæç¤ºAre you sure you want to continue connecting (yes&#x2F;no)? è¾“å…¥yesï¼Œç„¶åä¼šçœ‹åˆ°ï¼š<br>Hi CryingAtNight! Youâ€™ve successfully authenticated, but GitHub does not provide shell access.<br>çœ‹åˆ°è¿™ä¸ªä¿¡æ¯è¯´æ˜SSHå·²é…ç½®æˆåŠŸï¼</p><h3 id="6-å°†hexoéƒ¨ç½²åˆ°GitHub"><a href="#6-å°†hexoéƒ¨ç½²åˆ°GitHub" class="headerlink" title="6. å°†hexoéƒ¨ç½²åˆ°GitHub"></a>6. å°†hexoéƒ¨ç½²åˆ°GitHub</h3><p>æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼Œç¿»åˆ°æœ€åï¼Œä¿®æ”¹ä¸º:<br>(YourgithubNameå°±æ˜¯ä½ çš„GitHubè´¦æˆ·)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/YourgithubName/YourgithubName.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p><code>branch</code> å¡«ä½ åˆšåˆšåˆ›å»º<code>GitHub</code>ä»“åº“çš„é»˜è®¤åˆ†æ”¯åç§°ï¼Œçœ‹ä¸‹æ˜¯<code>master</code>è¿˜æ˜¯<code>main</code>ï¼Œä¸è¦å¡«é”™äº†ï¼Œè¿˜è¦æ³¨æ„ä¸€ä¸‹ï¼Œå†’å·åé¢åŠ ä¸€ä¸ªç©ºæ ¼</p><p>è¿™ä¸ªæ—¶å€™éœ€è¦å…ˆå®‰è£…deploy-git ï¼Œä¹Ÿå°±æ˜¯éƒ¨ç½²çš„å‘½ä»¤,è¿™æ ·ä½ æ‰èƒ½ç”¨å‘½ä»¤éƒ¨ç½²åˆ°GitHub</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤å®Œæˆï¼Œè¿‡ä¸€ä¼šå„¿å°±å¯ä»¥åœ¨<code>http://yourname.github.io</code> è¿™ä¸ªç½‘ç«™çœ‹åˆ°ä½ çš„åšå®¢äº†ï¼</p><h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>å› ä¸ºä»hexoæäº¤ä»£ç æ—¶ä¼šæŠŠä½ ä»¥å‰çš„æ‰€æœ‰ä»£ç éƒ½åˆ æ‰ï¼Œåœ¨ä¸Šä¼ ä»£ç åˆ°githubä¹‹å‰ï¼Œè¦è®°å¾—å…ˆæŠŠä»¥å‰æ‰€æœ‰ä»£ç ä¸‹è½½ä¸‹æ¥ï¼ˆè™½ç„¶githubæœ‰ç‰ˆæœ¬ç®¡ç†ï¼Œä½†å¤‡ä»½ä¸€ä¸‹æ€»æ˜¯å¥½çš„ï¼‰ã€‚</p><h1 id="ç›¸å…³å‘½ä»¤"><a href="#ç›¸å…³å‘½ä»¤" class="headerlink" title="ç›¸å…³å‘½ä»¤"></a>ç›¸å…³å‘½ä»¤</h1><p><a href="http://localhost:4000/">http://localhost:4000</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean   <span class="comment">#æ¸…é™¤ç¼“å­˜æ–‡ä»¶ db.json å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ public</span></span><br><span class="line">hexo g       <span class="comment">#ç”Ÿæˆç½‘ç«™é™æ€æ–‡ä»¶åˆ°é»˜è®¤è®¾ç½®çš„ public æ–‡ä»¶å¤¹(hexo generate çš„ç¼©å†™)</span></span><br><span class="line">hexo d       <span class="comment">#è‡ªåŠ¨ç”Ÿæˆç½‘ç«™é™æ€æ–‡ä»¶ï¼Œå¹¶éƒ¨ç½²åˆ°è®¾å®šçš„ä»“åº“(hexo deploy çš„ç¼©å†™)</span></span><br></pre></td></tr></table></figure><p>å¸¸ç”¨å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">&quot;postName&quot;</span> <span class="comment">#æ–°å»ºæ–‡ç« </span></span><br><span class="line">hexo new page <span class="string">&quot;pageName&quot;</span> <span class="comment">#æ–°å»ºé¡µé¢</span></span><br><span class="line">hexo generate <span class="comment">#ç”Ÿæˆé™æ€é¡µé¢è‡³publicç›®å½•</span></span><br><span class="line">hexo server <span class="comment">#å¼€å¯é¢„è§ˆè®¿é—®ç«¯å£ï¼ˆé»˜è®¤ç«¯å£4000ï¼Œ&#x27;ctrl + c&#x27;å…³é—­serverï¼‰</span></span><br><span class="line">hexo deploy <span class="comment">#éƒ¨ç½²åˆ°GitHub</span></span><br><span class="line">hexo <span class="built_in">help</span>  <span class="comment"># æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line">hexo version  <span class="comment">#æŸ¥çœ‹Hexoçš„ç‰ˆæœ¬</span></span><br></pre></td></tr></table></figure><p>ç¼©å†™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo n == hexo new</span><br><span class="line">hexo g == hexo generate</span><br><span class="line">hexo s == hexo server</span><br><span class="line">hexo d == hexo deploy</span><br></pre></td></tr></table></figure><p>ç»„åˆå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo s -g <span class="comment">#ç”Ÿæˆå¹¶æœ¬åœ°é¢„è§ˆ</span></span><br><span class="line">hexo d -g <span class="comment">#ç”Ÿæˆå¹¶ä¸Šä¼ </span></span><br></pre></td></tr></table></figure><h1 id="ä¸»é¢˜è®¾ç½®"><a href="#ä¸»é¢˜è®¾ç½®" class="headerlink" title="ä¸»é¢˜è®¾ç½®"></a>ä¸»é¢˜è®¾ç½®</h1><p><a href="https://github.com/Fechin/hexo-theme-diaspora">diasporaä¸»é¢˜</a><br><a href="https://butterfly.js.org/posts/4aa8abbe/">Butterfly æ–‡æª”(ä¸‰) ä¸»é¡Œé…ç½® | Butterfly</a></p><h2 id="ç¾åŒ–"><a href="#ç¾åŒ–" class="headerlink" title="ç¾åŒ–"></a>ç¾åŒ–</h2><p><a href="https://blog.csdn.net/qq_36759224/article/details/85420403">Hexoåšå®¢ä¼˜åŒ–ä¹‹åšå®¢ç¾åŒ–ç³»åˆ—</a></p><h2 id="æ ¹ç›®å½•å…¨å±€é…ç½®æ–‡ä»¶-config-yml"><a href="#æ ¹ç›®å½•å…¨å±€é…ç½®æ–‡ä»¶-config-yml" class="headerlink" title="æ ¹ç›®å½•å…¨å±€é…ç½®æ–‡ä»¶_config.yml"></a>æ ¹ç›®å½•å…¨å±€é…ç½®æ–‡ä»¶_config.yml</h2><p>1ã€<strong>æ‰€æœ‰çš„é…ç½®â€œ:â€ç¬¦å·åé¢éƒ½è¦å¸¦ç©ºæ ¼ï¼Œå¦åˆ™æ‰§è¡Œæœ¬åœ°æµ‹è¯•ç›´æ¥å¤±è´¥ã€‚</strong><br>2ã€languageæ˜¯è®¾ç½®è¯­è¨€ã€‚zh-Hansæ˜¯ä¸­æ–‡ã€‚<br>3ã€å¦‚æœè®¾ç½®zh-Hansåä»å‡ºç°ä¹±ç é—®é¢˜ã€‚éœ€è¦æ›´æ”¹æ–‡ä»¶çš„å­—ç¬¦ç¼–ç é›†ä¸ºUTF-8ï¼Œæ–¹æ³•å¾ˆå¤šã€‚</p><h1 id="å†™åšå®¢"><a href="#å†™åšå®¢" class="headerlink" title="å†™åšå®¢"></a>å†™åšå®¢</h1><p>å®šä½åˆ°æˆ‘ä»¬çš„hexoæ ¹ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &#x27;my-first-blog&#x27;</span><br></pre></td></tr></table></figure><p>hexoä¼šå¸®æˆ‘ä»¬åœ¨<code>_posts</code>ä¸‹ç”Ÿæˆç›¸å…³mdæ–‡ä»¶<br>æˆ‘ä»¬åªéœ€è¦æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥å¼€å§‹å†™åšå®¢äº†<br>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥è‡ªå·±æ–°å»ºmdæ–‡ä»¶ï¼Œç”¨è¿™ä¸ªå‘½ä»¤çš„å¥½å¤„æ˜¯å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆäº†æ—¶é—´<br>ä¸€èˆ¬å®Œæ•´æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: postName #æ–‡ç« é¡µé¢ä¸Šçš„æ˜¾ç¤ºåç§°ï¼Œä¸€èˆ¬æ˜¯ä¸­æ–‡</span><br><span class="line">date: 2013-12-02 15:30:16 #æ–‡ç« ç”Ÿæˆæ—¶é—´ï¼Œä¸€èˆ¬ä¸æ”¹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä»»æ„ä¿®æ”¹</span><br><span class="line">categories: é»˜è®¤åˆ†ç±» #åˆ†ç±»</span><br><span class="line">tags: [tag1,tag2,tag3] #æ–‡ç« æ ‡ç­¾ï¼Œå¯ç©ºï¼Œå¤šæ ‡ç­¾è¯·ç”¨æ ¼å¼ï¼Œæ³¨æ„:åé¢æœ‰ä¸ªç©ºæ ¼</span><br><span class="line">description: é™„åŠ ä¸€æ®µæ–‡ç« æ‘˜è¦ï¼Œå­—æ•°æœ€å¥½åœ¨140å­—ä»¥å†…ï¼Œä¼šå‡ºç°åœ¨metaçš„descriptioné‡Œé¢</span><br><span class="line">---</span><br><span class="line">ä»¥ä¸‹æ˜¯æ­£æ–‡</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•åˆ›å»ºè‰ç¨¿æ–‡ä»¶å¤¹åŠæ–‡ç« "><a href="#å¦‚ä½•åˆ›å»ºè‰ç¨¿æ–‡ä»¶å¤¹åŠæ–‡ç« " class="headerlink" title="å¦‚ä½•åˆ›å»ºè‰ç¨¿æ–‡ä»¶å¤¹åŠæ–‡ç« "></a>å¦‚ä½•åˆ›å»ºè‰ç¨¿æ–‡ä»¶å¤¹åŠæ–‡ç« </h2><ol><li><p><strong>æ‰‹åŠ¨åˆ›å»º</strong><br>ä½ å¯ä»¥æ‰‹åŠ¨åœ¨ <code>source</code> ç›®å½•ä¸‹åˆ›å»º <code>_drafts</code> æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å…¶ä¸­æ·»åŠ  <code>.md</code> æ–‡ä»¶ä½œä¸ºè‰ç¨¿ã€‚</p></li><li><p><strong>ä½¿ç”¨å‘½ä»¤åˆ›å»º</strong><br>ä½¿ç”¨ Hexo æä¾›çš„å‘½ä»¤åˆ›å»ºè‰ç¨¿ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆ <code>_drafts</code> æ–‡ä»¶å¤¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new draft <span class="string">&quot;æˆ‘çš„è‰ç¨¿æ–‡ç« &quot;</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåï¼ŒHexo ä¼šåœ¨ <code>source/_drafts</code> ä¸‹åˆ›å»º <code>æˆ‘çš„è‰ç¨¿æ–‡ç« .md</code> æ–‡ä»¶ã€‚</p></li><li><p><strong>é¢„è§ˆè‰ç¨¿</strong><br>å¯åŠ¨æœåŠ¡å™¨æ—¶æ·»åŠ  <code>--draft</code> å‚æ•°ï¼Œå¯é¢„è§ˆè‰ç¨¿æ–‡ç« ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server --draft</span><br></pre></td></tr></table></figure></li><li><p><strong>å‘å¸ƒè‰ç¨¿</strong>ï¼š<br>è‹¥è‰ç¨¿å®Œæˆï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†å…¶è½¬ä¸ºæ­£å¼æ–‡ç« ï¼ˆç§»åˆ° <code>source/_posts</code> ç›®å½•ï¼‰ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo publish draft <span class="string">&quot;è‰ç¨¿æ ‡é¢˜&quot;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Typora </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker</title>
      <link href="/2025/07/14/docker/"/>
      <url>/2025/07/14/docker/</url>
      
        <content type="html"><![CDATA[<h1 id="dockerä»‹ç»"><a href="#dockerä»‹ç»" class="headerlink" title="dockerä»‹ç»"></a>dockerä»‹ç»</h1><p>åœ¨å®‰è£…éƒ¨ç½²ç¨‹åºè¿‡ç¨‹ä¸­å­˜åœ¨çš„é—®é¢˜ï¼š</p><ol><li><p>ç‰ˆæœ¬ä¾èµ–</p><ul><li>å…¸å‹æ¡ˆä¾‹ï¼šjavaç¯å¢ƒæœ‰å¾ˆå¤šçš„jreç‰ˆæœ¬</li></ul></li><li><p>ç¯å¢ƒä¾èµ–</p><ul><li>å…¸å‹æ¡ˆä¾‹ï¼šoracleå®‰è£…éœ€è¦å¤§é‡æ”¯æ’‘åŒ…</li></ul></li><li><p>å®‰å…¨é£é™©</p><ul><li>å…¸å‹æ¡ˆä¾‹ï¼šå¤šä¸ªåº”ç”¨æ— æ³•å®‰è£…ä¸€ä¸ªæœåŠ¡å™¨</li></ul></li><li><p>æ€§èƒ½ç“¶é¢ˆ</p><ul><li>å…¸å‹æ¡ˆä¾‹ï¼šç¡¬ä»¶è®¾å¤‡æ‰©å±•å›°éš¾</li></ul></li></ol><h2 id="ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯"><a href="#ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯" class="headerlink" title="ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯"></a>ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯</h2><p>åœ¨è®¡ç®—æœºæŠ€æœ¯ä¸­ï¼Œè™šæ‹ŸåŒ–<strong>æ˜¯ä¸€ç§èµ„æºç®¡ç†æŠ€æœ¯</strong>ï¼Œæ˜¯å°†è®¡ç®—æœºçš„å„ç§å®ä½“èµ„æºï¼Œå¦‚æœåŠ¡å™¨ï¼Œç½‘ç»œï¼Œå†…å­˜ä»¥åŠå­˜å‚¨ç­‰äºˆä»¥æŠ½è±¡è½¬æ¢åå‘ˆç°å‡ºæ¥ï¼Œ<strong>æ‰“ç ´å®ä½“å®ä½“ç»“æ„é—´ä¸å¯åˆ‡å‰²çš„éšœç¢</strong>ï¼Œä½¿ç”¨æˆ·å¯ä»¥ç”¨æ¯”åŸæœ¬çš„ç»„æ€æ›´å¥½çš„æ–¹å¼æ¥åº”ç”¨è¿™äº›èµ„æº</p><h2 id="docekrå®¹å™¨æŠ€æœ¯çš„å‘å±•"><a href="#docekrå®¹å™¨æŠ€æœ¯çš„å‘å±•" class="headerlink" title="docekrå®¹å™¨æŠ€æœ¯çš„å‘å±•"></a>docekrå®¹å™¨æŠ€æœ¯çš„å‘å±•</h2><ul><li>Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„å¼€åŸå®¹å™¨é¡¹ç›®å®ƒè¯ç”Ÿäº2013å¹´å¹´åˆ.ç°åœ¨ä¸»æµçš„æ“ä½œç³»ç»ŸåŒ…æ‹¬å¼•inuxå„å¤§å‘è¡Œç‰ˆæœ¬ï¼ŒMac<br>OS,windowsç­‰éƒ½æ”¯æŒDocker..å„å¤§äº‘æœåŠ¡æä¾›å•†ä¹Ÿçº·çº·æ¨å‡ºäº†åŸºäºDockerçš„æœåŠ¡</li><li>Dockerçš„æ„æƒ³æ˜¯è¦å®ç°â€<strong>Build ship and run any App,Anywhere</strong>â€˜â€œå³é€šè¿‡å¯¹åº”ç”¨çš„å°è£…(packaging),åˆ†å‘(distribution),éƒ¨ç½²(deploymen).è¿è¡Œ(runtime)ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç®¡ç†ï¼Œè¾¾åˆ°åº”ç”¨ç»„ä»¶çº§åˆ«çš„â€<strong>ä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œ</strong>â€œçš„ç›®çš„</li><li>è¿™äº›åº”ç”¨ç»„ä»¶å³å¯ä»¥æ˜¯ä¸€ä¸ªWbåº”ç”¨ï¼Œä¸€ä¸ªç¼–è¯‘ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥æ˜¯å¥—æ•°æ®åº“å¹³å°æœåŠ¡ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿæˆ–é›†ç¾¤.å¯ä»¥è¯´Dockerié¦–æ¬¡ä¸ºåº”ç”¨çš„å¼€å‘ï¼Œè¿è¡Œå’Œéƒ¨ç½²æä¾›äº†â€ä¸€ç«™å¼â€çš„å®ç”¨è§£å†³æ–¹æ¡ˆ</li></ul><h2 id="dockeræœ¬è´¨"><a href="#dockeræœ¬è´¨" class="headerlink" title="dockeræœ¬è´¨"></a>dockeræœ¬è´¨</h2><p>Dockerçš„è¯ç”ŸåŸºäºlinuxçš„å®¹å™¨æŠ€æœ¯(Linux Containers,LXC)</p><ul><li>å®¹å™¨å°†åº”ç”¨è¿›è¡Œæ²™ç›’å°è£…ï¼Œè¿›è¡Œéš”ç¦»ï¼Œå¹¶ç‹¬ç«‹åˆ†é…ç¡¬ä»¶èµ„æºã€‚</li><li>å®¹å™¨åœ¨æ ¸å¿ƒCPUæœ¬åœ°è¿è¡ŒæŒ‡ä»¤ï¼Œä¸éœ€è¦ä»»ä½•ä¸“é—¨çš„è§£é‡Šæœºåˆ¶.</li></ul><p>Dockeråœ¨LXCåŸºç¡€ä¸Šï¼Œä¼˜åŒ–äº†å®¹å™¨çš„ä½¿ç”¨ä½“éªŒ</p><ul><li>DockeræŒ‡ä»¤è®©ç”¨æˆ·æ— é¡»å…³æ³¨åº•å±‚æ“ä½œï¼Œç›´æ¥ç®¡ç†å’Œä½¿ç”¨å®¹å™¨</li><li>Docké€šè¿‡å¼•å…¥åˆ†å±‚æ–‡ä»¶ç³»ç»Ÿå’Œé•œåƒæœºåˆ¶ï¼Œé™ä½äº†è¿ç§»éš¾åº¦</li></ul><h2 id="docekrå®¹å™¨æŠ€æœ¯çš„ä¼˜åŠ¿"><a href="#docekrå®¹å™¨æŠ€æœ¯çš„ä¼˜åŠ¿" class="headerlink" title="docekrå®¹å™¨æŠ€æœ¯çš„ä¼˜åŠ¿"></a>docekrå®¹å™¨æŠ€æœ¯çš„ä¼˜åŠ¿</h2><ol><li>æ›´å¿«çš„äº¤ä»˜å’Œéƒ¨ç½²</li><li>æ›´é«˜æ•ˆçš„èµ„æºåˆ©ç”¨</li><li>æ›´è½»æ¾çš„è¿ç§»å’Œæ‰©å±•</li><li>è‰¯å¥½çš„éš”ç¦»æ€§</li><li>å®Œæ•´çš„æŠ€æœ¯ç”Ÿæ€</li></ol><h2 id="docekrå®¹å™¨æŠ€æœ¯å’ŒVMwareçš„æ¯”è¾ƒ"><a href="#docekrå®¹å™¨æŠ€æœ¯å’ŒVMwareçš„æ¯”è¾ƒ" class="headerlink" title="docekrå®¹å™¨æŠ€æœ¯å’ŒVMwareçš„æ¯”è¾ƒ"></a>docekrå®¹å™¨æŠ€æœ¯å’ŒVMwareçš„æ¯”è¾ƒ</h2><table><thead><tr><th align="center"></th><th align="center">docker</th><th align="center">VMware</th></tr></thead><tbody><tr><td align="center">å¯åŠ¨</td><td align="center">ç§’çº§</td><td align="center">åˆ†é’Ÿçº§</td></tr><tr><td align="center">æ€§èƒ½</td><td align="center">æ¥è¿‘å®¿ä¸»æœº</td><td align="center">è¾ƒå¼±</td></tr><tr><td align="center">èµ„æº</td><td align="center">èµ„æºå ç”¨å°</td><td align="center">èµ„æºå ç”¨å¤§</td></tr><tr><td align="center">éš”ç¦»</td><td align="center">å®‰å…¨éš”ç¦»</td><td align="center">å®Œå…¨éš”ç¦»</td></tr></tbody></table><h1 id="dockeræ‰©å±•ç»„ä»¶"><a href="#dockeræ‰©å±•ç»„ä»¶" class="headerlink" title="dockeræ‰©å±•ç»„ä»¶"></a>dockeræ‰©å±•ç»„ä»¶</h1><ol><li><p><strong>Docker  Machine</strong></p><p>Docker Machine æ˜¯ Docker å®˜æ–¹æä¾›çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨<strong>è¿œç¨‹è™šæ‹Ÿä¸»æœºä¸Šå®‰è£…å’Œç®¡ç†</strong> <strong>Docker</strong>ã€‚å®ƒç®€åŒ–äº†åœ¨ä¸åŒå¹³å°ï¼ˆå¦‚è™šæ‹Ÿæœºã€äº‘æœåŠ¡ç­‰ï¼‰ä¸Šéƒ¨ç½² Docker ç¯å¢ƒçš„æµç¨‹ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºã€ç®¡ç†å¤šä¸ªè™šæ‹Ÿä¸»æœºä¸Šçš„ Docker ç¯å¢ƒï¼Œæä¾›äº†ä¸€ç§ä¾¿æ·çš„æ–¹å¼æ¥æ­å»ºåˆ†å¸ƒå¼çš„ Docker éƒ¨ç½²ç¯å¢ƒã€‚</p></li><li><p><strong>Docker Swarm</strong></p><p>DockerSwarmæ˜¯Dockerå®˜æ–¹æä¾›çš„<strong>å®¹å™¨ç¼–æ’å·¥å…·</strong>ï¼Œç”¨äº<strong>ç®¡ç†å¤šä¸ªDockerä¸»æœºå¹¶å°†å®ƒä»¬ç»„æˆä¸€ä¸ªè™šæ‹Ÿçš„å®¹å™¨é›†ç¾¤</strong>ï¼Œå®ç°å®¹å™¨çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ä¼¸ç¼©å’Œç®¡ç†ã€‚é€šè¿‡ Docker Swarmï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°åœ¨å¤šä¸ªä¸»æœºä¸Šéƒ¨ç½²å®¹å™¨åº”ç”¨ï¼Œå¹¶åœ¨éœ€è¦æ—¶è¿›è¡Œæ‰©å±•æˆ–æ”¶ç¼©ï¼Œå®ç°é«˜å¯ç”¨æ€§å’Œè´Ÿè½½å‡è¡¡ã€‚</p></li><li><p><strong>Docker  Compose</strong></p><p>Docker Composeæ˜¯Dockerå®˜æ–¹æä¾›çš„å·¥å…·ï¼Œç”¨äº<strong>å®šä¹‰å’Œè¿è¡Œå¤šä¸ªå®¹å™¨çš„åº”ç”¨ç¨‹åº</strong>ã€‚é€šè¿‡ä¸€ä¸ªç®€å•çš„YAMLæ–‡ä»¶ï¼Œå¯ä»¥å®šä¹‰åº”ç”¨ç¨‹åºçš„æœåŠ¡ã€ç½‘ç»œå’Œå·ç­‰é…ç½®å¹¶ä½¿ç”¨å‘½ä»¤å¯åŠ¨ã€åœæ­¢ã€æ„å»ºå’Œç®¡ç†æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å®¹å™¨ã€‚Docker Composeç®€åŒ–äº†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²å’Œç®¡ç†æµç¨‹ï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥æ›´å¿«é€Ÿåœ°æ­å»ºå’Œè¿è¡Œå¤æ‚çš„å¤šå®¹å™¨åº”ç”¨ã€‚</p></li><li><p><strong>Docker File</strong></p><p>Dockerfileæ˜¯ç”¨äº<strong>æ„å»ºDockeré•œåƒçš„æ–‡æœ¬æ–‡ä»¶</strong>ï¼Œé€šè¿‡Dockerfileå¯ä»¥å®šä¹‰é•œåƒçš„æ„å»ºè¿‡ç¨‹å’Œå†…å®¹ã€‚åœ¨Dockerfileä¸­å¯ä»¥æŒ‡å®šåŸºç¡€é•œåƒã€è¿è¡Œå‘½ä»¤ã€å¤åˆ¶æ–‡ä»¶ã€è®¾ç½®ç¯å¢ƒå˜é‡ç­‰æ“ä½œï¼Œæœ€ç»ˆé€šè¿‡æ„å»ºå‘½ä»¤å°†Dockerfileè½¬æ¢ä¸ºå¯æ‰§è¡Œçš„Dockeré•œåƒã€‚ä½¿ç”¨Dockerfileå¯ä»¥å®ç°è‡ªåŠ¨åŒ–ã€å¯é‡å¤çš„é•œåƒæ„å»ºè¿‡ç¨‹ï¼Œå¸®åŠ©å¼€å‘äººå‘˜å¿«é€Ÿã€æ–¹ä¾¿åœ°åˆ›å»ºå®šåˆ¶åŒ–çš„é•œåƒã€‚</p></li><li><p><strong>kubernetes</strong>  </p><p>Kubernetesæœ€åˆæ˜¯ç”±Googleå…¬å¸å‘èµ·å¹¶å¼€æºçš„<strong>å®¹å™¨ç¼–æ’å¹³å°</strong>ï¼Œç”¨äºè‡ªåŠ¨éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†ä¸€ä¸ªé«˜åº¦å¯æ‰©å±•çš„é›†ç¾¤ç®¡ç†å·¥å…·ï¼Œæ”¯æŒå¤šä¸ªå®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ã€æ›´æ–°ã€ç»´æŠ¤å’Œä¼¸ç¼©ã€‚Kubernetesæä¾›äº†å¼ºå¤§çš„è‡ªåŠ¨åŒ–åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·ç®€åŒ–å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²å’Œç®¡ç†ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„å¯é æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p></li></ol><h1 id="dockerå®‰è£…ï¼ˆCentOSï¼‰"><a href="#dockerå®‰è£…ï¼ˆCentOSï¼‰" class="headerlink" title="dockerå®‰è£…ï¼ˆCentOSï¼‰"></a>dockerå®‰è£…ï¼ˆCentOSï¼‰</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…³é—­é˜²ç«å¢™</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line"><span class="comment">#å…³é—­selinux</span></span><br><span class="line">vim /etc/selinux/config</span><br><span class="line"><span class="comment"># å°†SELINUX=enforcingæ”¹ä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.æ‹·è´ä¸€ä»½æ–°çš„é˜¿é‡Œäº‘çš„ ä¸‹è½½æº åˆ° /etc/yum.repos.d/ä¸‹ </span></span><br><span class="line"><span class="built_in">mv</span> /root/CentOS-Base.repo /etc/yum.repos.d/</span><br><span class="line"><span class="comment">#2.æ¸…ç©ºåŸä¸‹è½½æ± </span></span><br><span class="line"><span class="built_in">sudo</span> yum clean all</span><br><span class="line"><span class="comment">#3. åŠ è½½æ–°æº</span></span><br><span class="line"><span class="built_in">sudo</span> yum makecache</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…å·¥å…·åŒ…</span></span><br><span class="line">yum install -y epel-release</span><br><span class="line"><span class="comment">#å®‰è£…åŸºç¡€è½¯ä»¶</span></span><br><span class="line">yum install -y net-tools rsync vim wget ntp</span><br><span class="line"></span><br><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·»åŠ é˜¿é‡Œyumæº</span></span><br><span class="line">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…docker</span></span><br><span class="line">yum -y install docker-ce</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨docker</span></span><br><span class="line">systemctl <span class="built_in">enable</span> --now docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">systemctl status docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨</span></span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line"><span class="comment">#é•œåƒåŠ é€Ÿ</span></span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"><span class="comment">#æ·»åŠ å†…å®¹</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://dockerhub.icu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.registry.cyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker-cf.registry.cyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://dockercf.jsdelivr.fyi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.jsdelivr.fyi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://dockertest.jsdelivr.fyi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.aliyuncs.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://dockerproxy.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.baidubce.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.m.daocloud.io&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.nju.edu.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.iscas.ac.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.rainbond.cc&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#ä½¿æ–‡ä»¶ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#éªŒè¯ docker æ˜¯å¦å®‰è£…æˆåŠŸå¹¶åœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€ä¸ªæµ‹è¯•çš„é•œåƒã€‚</span></span><br><span class="line"><span class="built_in">sudo</span> docker run hello-world</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716110709919.png" alt="image-20250716110709919"></p><h2 id="ä»é•œåƒä»“åº“è·å–"><a href="#ä»é•œåƒä»“åº“è·å–" class="headerlink" title="ä»é•œåƒä»“åº“è·å–"></a>ä»é•œåƒä»“åº“è·å–</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis <span class="comment">#é»˜è®¤æœ€æ–°ç‰ˆæœ¬latest</span></span><br><span class="line">docker pull mysql:5.7 <span class="comment">#æŒ‡å®šç‰ˆæœ¬</span></span><br><span class="line">docker pull tomcat:9.0.44-jdk8</span><br><span class="line"></span><br><span class="line">docker rmi mysql:5.7 <span class="comment">#åˆ é™¤é•œåƒ</span></span><br><span class="line">docker rmi -f mysql:5.7 <span class="comment">#å¼ºåˆ¶åˆ é™¤</span></span><br></pre></td></tr></table></figure><h2 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹å®¹å™¨åˆ—è¡¨</span></span><br><span class="line">docker container <span class="built_in">ls</span> -a</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.åˆ›å»ºå®¹å™¨</span></span><br><span class="line">docker createÂ  centosÂ </span><br><span class="line"></span><br><span class="line"><span class="comment">#2.åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker run -d tomcat:9.0.44-jdk8</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.ç”Ÿæˆå®¹å™¨å¸¸ç”¨å‚æ•°</span></span><br><span class="line">docker run --name mysql_new -d -p 3306:3306 \</span><br><span class="line">--net mysql-test \</span><br><span class="line">-v /usr/mysql/conf:/etc/my.cnf.d \ </span><br><span class="line">-v /usr/mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">--restart always \</span><br><span class="line">--privileged=<span class="literal">true</span> \</span><br><span class="line">--network-alias mysql \</span><br><span class="line">mysql:5.7</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.è¿›å…¥å®¹å™¨å‘½ä»¤</span></span><br><span class="line">docker <span class="built_in">exec</span> -itÂ  mysql_new bash</span><br><span class="line">docker attach mysql_new</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.åˆ é™¤å®¹å™¨</span></span><br><span class="line">docker container <span class="built_in">rm</span> mysql_new</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å¯åœå®¹å™¨</span></span><br><span class="line">docker container start|stop|restart mysql_new</span><br><span class="line">docker container pause|unpause mysql_new</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.å®¹å™¨æ–‡ä»¶ä¼ è¾“(æ‹·å‡º)</span></span><br><span class="line">docker container <span class="built_in">cp</span> mysql_new:/root/test /root/test</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.å¯¼å‡ºå®¹å™¨</span></span><br><span class="line">docker container <span class="built_in">export</span>Â  -o /root/mysql.tar mysql_new</span><br></pre></td></tr></table></figure><h2 id="æ‹‰å–-Tomcat-é•œåƒå¹¶å¯åŠ¨å®¹å™¨"><a href="#æ‹‰å–-Tomcat-é•œåƒå¹¶å¯åŠ¨å®¹å™¨" class="headerlink" title="æ‹‰å– Tomcat é•œåƒå¹¶å¯åŠ¨å®¹å™¨"></a>æ‹‰å– Tomcat é•œåƒå¹¶å¯åŠ¨å®¹å™¨</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum install -y unzip</span><br><span class="line">unzip webroot.zip <span class="comment">#è§£å‹åº”ç”¨åŒ…</span></span><br><span class="line"></span><br><span class="line">docker pull tomcat:9.0.44-jdk8 <span class="comment">#ä¹‹å‰å·²æ‰§è¡Œå¯ç•¥è¿‡</span></span><br><span class="line"></span><br><span class="line">docker run -d \</span><br><span class="line">--name=fr_tomcat \</span><br><span class="line">-p 8888:8080 \</span><br><span class="line">-v /root/webroot:/usr/local/tomcat/webapps/webroot \</span><br><span class="line">tomcat:9.0.44-jdk8</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716111050408.png" alt="image-20250716111050408"></p><h1 id="docekrä½¿ç”¨"><a href="#docekrä½¿ç”¨" class="headerlink" title="docekrä½¿ç”¨"></a>docekrä½¿ç”¨</h1><h2 id="1-docekr-image"><a href="#1-docekr-image" class="headerlink" title="1.docekr image"></a>1.docekr image</h2><h3 id="é•œåƒè·å–"><a href="#é•œåƒè·å–" class="headerlink" title="é•œåƒè·å–"></a>é•œåƒè·å–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.ä»é•œåƒä»“åº“è·å–</span></span><br><span class="line">    docker image pull tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#2.ä»tarå‹ç¼©åŒ…è·å– </span></span><br><span class="line">    docker image load  -i /root/oracle.tar</span><br><span class="line"><span class="comment">#3.ä»exportå¯¼å‡ºåŒ…è·å–</span></span><br><span class="line">    docker image import mysql_image.tar mysql:5.7</span><br><span class="line"><span class="comment">#4.ä»dockerFile æ–‡ä»¶æ„å»º</span></span><br><span class="line">    docker image build -t centos7:7 /root/Dockerfile</span><br><span class="line"><span class="comment">#5.ä»containerå®¹å™¨è½¬åŒ–</span></span><br><span class="line">    docker commit mysqlmaster mysql_master:5.7</span><br></pre></td></tr></table></figure><h3 id="é•œåƒæ“ä½œ"><a href="#é•œåƒæ“ä½œ" class="headerlink" title="é•œåƒæ“ä½œ"></a>é•œåƒæ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.ä¿å­˜è¿ç§»é•œåƒ</span></span><br><span class="line">    docker image save  -o /root/tomcat.tar tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#2.åˆ é™¤é•œåƒ </span></span><br><span class="line">    docker image <span class="built_in">rm</span> mysql:5.7</span><br><span class="line"><span class="comment">#3.åˆ é™¤æ— ç”¨é•œåƒ</span></span><br><span class="line">    docker image prune</span><br><span class="line"><span class="comment">#4.ä¸Šä¼ é•œåƒåˆ°ä»“åº“</span></span><br><span class="line">    docker image push tomcat:9.0.44-jdk8</span><br></pre></td></tr></table></figure><h3 id="é•œåƒæŸ¥çœ‹"><a href="#é•œåƒæŸ¥çœ‹" class="headerlink" title="é•œåƒæŸ¥çœ‹"></a>é•œåƒæŸ¥çœ‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.æŸ¥çœ‹é•œåƒåˆ—è¡¨</span></span><br><span class="line">    docker images <span class="built_in">ls</span></span><br><span class="line"><span class="comment">#2.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªæ˜ åƒçš„è¯¦ç»†ä¿¡æ¯ </span></span><br><span class="line">    docker image inspect mysql:5.7</span><br><span class="line"><span class="comment">#3.åˆ°ä»“åº“æ£€ç´¢é•œåƒ</span></span><br><span class="line">    docker  search  mysql</span><br><span class="line"><span class="comment">#4.ä¸Šä¼ é•œåƒåˆ°ä»“åº“</span></span><br><span class="line">    docker image push tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#5.æŸ¥çœ‹é•œåƒå†å²</span></span><br><span class="line">    docker image <span class="built_in">history</span> mysql:5.7</span><br></pre></td></tr></table></figure><h3 id="é•œåƒåˆ†å±‚ç»“æ„"><a href="#é•œåƒåˆ†å±‚ç»“æ„" class="headerlink" title="é•œåƒåˆ†å±‚ç»“æ„"></a>é•œåƒåˆ†å±‚ç»“æ„</h3><p><img src="/2025/07/14/docker/image-20250714151231302.png" alt="image-20250714151231302"></p><h2 id="2-Docker-container-å®¹å™¨"><a href="#2-Docker-container-å®¹å™¨" class="headerlink" title="2.Docker container å®¹å™¨"></a>2.<strong>Docker container</strong> <strong>å®¹å™¨</strong></h2><h2 id="ç”Ÿæˆå®¹å™¨"><a href="#ç”Ÿæˆå®¹å™¨" class="headerlink" title="ç”Ÿæˆå®¹å™¨"></a>ç”Ÿæˆå®¹å™¨</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.åˆ›å»ºå®¹å™¨</span></span><br><span class="line">    docker create  centos  </span><br><span class="line"><span class="comment">#2.åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ </span></span><br><span class="line">    docker run -d tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#3.ç”Ÿæˆå®¹å™¨å¸¸ç”¨å‚æ•°</span></span><br><span class="line">docker run --name mysql_new -d -p 3306:3306 \</span><br><span class="line">--net mysql-test \</span><br><span class="line">-v /usr/mysql/conf:/etc/my.cnf.d \</span><br><span class="line">-v /usr/mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">--restart always \</span><br><span class="line">--privileged=<span class="literal">true</span> \</span><br><span class="line">--network-alias mysql \</span><br><span class="line">mysql:5.7</span><br></pre></td></tr></table></figure><h3 id="å®¹å™¨æ“ä½œ"><a href="#å®¹å™¨æ“ä½œ" class="headerlink" title="å®¹å™¨æ“ä½œ"></a>å®¹å™¨æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.è¿›å…¥å®¹å™¨å‘½ä»¤</span></span><br><span class="line">    docker <span class="built_in">exec</span> -it  mysql_new bash</span><br><span class="line">    docker attach mysql_new</span><br><span class="line"><span class="comment">#2.åˆ é™¤å®¹å™¨ </span></span><br><span class="line">    docker container <span class="built_in">rm</span> mysql_new</span><br><span class="line"><span class="comment">#3.å¯åœå®¹å™¨</span></span><br><span class="line">    docker container start|stop|restart mysql_new</span><br><span class="line">    docker container pause|unpause mysql_new</span><br><span class="line"><span class="comment">#4.å®¹å™¨æ–‡ä»¶ä¼ è¾“(æ‹·å‡º)</span></span><br><span class="line">    docker container <span class="built_in">cp</span> mysql_new:/root/test /root/test</span><br><span class="line"><span class="comment">#5.å¯¼å‡ºå®¹å™¨</span></span><br><span class="line">    docker container <span class="built_in">export</span>  -o /root/mysql.tar mysql_new</span><br></pre></td></tr></table></figure><h3 id="å®¹å™¨æŸ¥çœ‹"><a href="#å®¹å™¨æŸ¥çœ‹" class="headerlink" title="å®¹å™¨æŸ¥çœ‹"></a>å®¹å™¨æŸ¥çœ‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.æŸ¥çœ‹å®¹å™¨åˆ—è¡¨</span></span><br><span class="line">    docker container <span class="built_in">ls</span> -a</span><br><span class="line"><span class="comment">#2.æŸ¥çœ‹å®¹å™¨è¯¦æƒ… </span></span><br><span class="line">    docker container inspect mysql_new</span><br><span class="line"><span class="comment">#3.æŸ¥çœ‹å®¹å™¨æ‰§è¡Œæ—¥å¿—</span></span><br><span class="line">    docker container logs mysql_new</span><br><span class="line"><span class="comment">#4.æŸ¥çœ‹å®¹å™¨è¿›ç¨‹</span></span><br><span class="line">    docker container ps mysql_new</span><br><span class="line">    docker container top mysql_new</span><br><span class="line"><span class="comment">#6.æŸ¥çœ‹å®¹å™¨èµ„æºå ç”¨</span></span><br><span class="line">    docker container stats</span><br><span class="line"><span class="comment">#5.æŸ¥çœ‹docker ç½‘ç»œ\å·</span></span><br><span class="line">    docker network <span class="built_in">ls</span></span><br><span class="line">    docker volume <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><h2 id="docker-networkç½‘ç»œ"><a href="#docker-networkç½‘ç»œ" class="headerlink" title="docker networkç½‘ç»œ"></a>docker networkç½‘ç»œ</h2><h3 id="dockerç«¯å£"><a href="#dockerç«¯å£" class="headerlink" title="dockerç«¯å£"></a>dockerç«¯å£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.éšæœºæš´éœ²å®¹å™¨æ‰€æœ‰ç«¯å£(å±é™©)</span></span><br><span class="line">    docker run -P -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#2.å°†å®¹å™¨æŒ‡å®šç«¯å£éšæœºæ˜ å°„åˆ°å®¿ä¸»æœºä¸€ä¸ªç«¯å£ä¸Š </span></span><br><span class="line">    docker run -P 80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#3.å°†å®¹å™¨æŒ‡å®šç«¯å£æŒ‡å®šæ˜ å°„åˆ°å®¿ä¸»æœºçš„ä¸€ä¸ªç«¯å£ä¸Š</span></span><br><span class="line">    docker run -p 8000:80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#4.å°†å®¹å™¨ipå’Œç«¯å£ï¼Œéšæœºæ˜ å°„åˆ°å®¿ä¸»æœºä¸Š</span></span><br><span class="line">    docker run -P 192.168.0.100::80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#5.å°†å®¹å™¨ipå’Œç«¯å£ï¼ŒæŒ‡å®šæ˜ å°„åˆ°å®¿ä¸»æœºä¸Š</span></span><br><span class="line">    docker run -p 192.168.0.100:8000:80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#6.æŒ‡å®šåè®®</span></span><br><span class="line">    docker run -d -p 8080:80/tcp nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250714151751936.png" alt="image-20250714151751936"></p><h3 id="dockerç½‘ç»œ"><a href="#dockerç½‘ç»œ" class="headerlink" title="dockerç½‘ç»œ"></a>dockerç½‘ç»œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.ä½¿ç”¨hostç½‘ç»œ</span></span><br><span class="line">    docker container run --network=host nginx</span><br><span class="line"><span class="comment">#2.ä½¿ç”¨macvlan ç½‘ç»œ </span></span><br><span class="line">  <span class="comment">#åˆ›å»º:</span></span><br><span class="line">    docker network create -d macvlan --subnet=192.168.10.0/24 \</span><br><span class="line">--gateway=192.168.100.1  -o parent=ens33 mac1</span><br><span class="line">  <span class="comment">#ä½¿ç”¨:</span></span><br><span class="line">    docker run --ip =192.168.100.2 --network mac1 nginx</span><br><span class="line"><span class="comment">#3.ä½¿ç”¨è‡ªå®šä¹‰æ¡¥æ¥ç½‘ç»œ</span></span><br><span class="line">  <span class="comment">#åˆ›å»º:</span></span><br><span class="line">    docker network create --driver bridge \</span><br><span class="line">--subnet 192.168.10.0/24 --gateway 192.168.10.1 mybridge</span><br><span class="line">  <span class="comment">#ä½¿ç”¨:</span></span><br><span class="line">    docker run --network=mybridge -d nginx</span><br></pre></td></tr></table></figure><h1 id="docker-composeä»‹ç»ä»¥åŠåº”ç”¨"><a href="#docker-composeä»‹ç»ä»¥åŠåº”ç”¨" class="headerlink" title="docker composeä»‹ç»ä»¥åŠåº”ç”¨"></a>docker composeä»‹ç»ä»¥åŠåº”ç”¨</h1><p>â€‹Docker Compose æ˜¯ Docker å®˜æ–¹æ¨å‡ºçš„å·¥å…·ï¼Œç”¨äº<strong>å®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨</strong>ã€‚é€šè¿‡å•ä¸ª YAML æ–‡ä»¶ï¼ˆé€šå¸¸å‘½åä¸º <code>docker-compose.yml</code>ï¼‰ï¼Œå¯ä»¥é…ç½®åº”ç”¨çš„æœåŠ¡ã€ç½‘ç»œå’Œå·ï¼Œä¸€é”®å¯åŠ¨æˆ–åœæ­¢æ•´ä¸ªåº”ç”¨æ ˆï¼Œæ— éœ€é€ä¸ªæ“ä½œå®¹å™¨ã€‚<br>Docker Compose æ˜¯ç®¡ç†å¤šå®¹å™¨åº”ç”¨çš„å¿…å¤‡å·¥å…·ï¼Œé€šè¿‡ YAML é…ç½®ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œå°¤å…¶é€‚åˆå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒã€‚å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œå¯ç»“åˆ Kubernetes ç­‰æ›´å¼ºå¤§çš„ç¼–æ’å·¥å…·ã€‚</p><h2 id="yamlæ–‡ä»¶ç¼–è¾‘è§„èŒƒ"><a href="#yamlæ–‡ä»¶ç¼–è¾‘è§„èŒƒ" class="headerlink" title="yamlæ–‡ä»¶ç¼–è¾‘è§„èŒƒ"></a>yamlæ–‡ä»¶ç¼–è¾‘è§„èŒƒ</h2><ul><li>ç¬¬ä¸€ï¼šYAMLæ˜¯ä¸€ç§æ ‡è®°æ€§è¯­è¨€ï¼Œç±»ä¼¼äºjsonæ•°æ®æè¿°è¯­è¨€ï¼Œå¯è¯»æ€§é«˜ï¼›ã€€</li><li>ç¬¬äºŒï¼šYAMLæ•°æ®ç»“æ„é€šè¿‡ç¼©è¿›æ¥è¡¨ç¤ºï¼Œè¿ç»­é¡¹ç›®é€šè¿‡å‡å·è¡¨ç¤ºï¼Œé”®å€¼å¯¹ç”¨å†’å·åˆ†éš”ï¼Œæ•°ç»„ä½¿ç”¨ä¸­æ‹¬å·<code>[]</code>æ‹¬èµ·æ¥ï¼Œbashç”¨èŠ±æ‹¬å·<code>&#123;&#125;</code>æ‹¬èµ·æ¥ï¼›ã€€</li><li>ç¬¬ä¸‰ï¼šä¸æ”¯æŒåˆ¶è¡¨ç¬¦TABç¼©è¿›ï¼Œåªèƒ½ä½¿ç”¨ç©ºæ ¼ç¼©è¿›ï¼›</li><li>ç¬¬å››ï¼šå­—ç¬¦åç¼©è¿›ä¸€ä¸ªç©ºæ ¼(å¦‚å†’å·ã€é€—å·ã€æ¨ªæ åé¡»åŠ ç©ºæ ¼)ï¼›</li><li>ç¬¬äº”ï¼šä½¿ç”¨#å·è¡¨ç¤ºæ³¨é‡Šï¼›</li><li>ç¬¬å…­ï¼šå¦‚æœåŒ…å«ç‰¹æ®Šå­—ç¬¦ç”¨å•å¼•å·<code>&#39; &#39;</code> æ ‡è®°ä¸ºæ™®é€šå­—ç¬¦,ç”¨åŒå¼•å·è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦æœ¬èº«çš„æ„æ€,å¸ƒå°”å€¼å¿…é¡»ä½¿ç”¨åŒå¼•å·<code>&quot; &quot;</code>æ‹¬èµ·æ¥ï¼›</li><li>ç¬¬ä¸ƒï¼šYAML åŒºåˆ†å¤§å°å†™ï¼›</li></ul><h2 id="docker-compose-yamlæ–‡ä»¶æŒ‡ä»¤"><a href="#docker-compose-yamlæ–‡ä»¶æŒ‡ä»¤" class="headerlink" title="docker compose yamlæ–‡ä»¶æŒ‡ä»¤"></a>docker compose yamlæ–‡ä»¶æŒ‡ä»¤</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">versionï¼šæŒ‡å®šæ­¤ymlæ–‡ä»¶åŸºäºçš„composeçš„ç‰ˆæœ¬</span></span><br><span class="line"><span class="string">servicesï¼šæŒ‡å®šåˆ›å»ºå®¹å™¨çš„æœåŠ¡é€‰é¡¹</span></span><br><span class="line"><span class="comment">#æœåŠ¡åï¼šä¾‹å¦‚nginxç­‰</span></span><br><span class="line"><span class="attr">network:</span> <span class="string">ç½‘ç»œæœåŠ¡åˆ›å»º</span></span><br><span class="line"><span class="attr">volume:</span> <span class="string">æ•°æ®å·æœåŠ¡åˆ›å»º</span></span><br><span class="line"><span class="string">hostnameï¼šå®¹å™¨ä¸»æœºå</span></span><br><span class="line"><span class="string">build</span> <span class="string">ï¼šæŒ‡å®šæ„å»ºé•œåƒä¸Šä¸‹æ–‡è·¯å¾„</span></span><br><span class="line"><span class="string">contextï¼šä¸Šä¸‹æ–‡è·¯å¾„</span></span><br><span class="line"><span class="string">dockerfileï¼šæŒ‡å®šæ„å»ºé•œåƒçš„</span> <span class="string">Dockerfile</span> <span class="string">æ–‡ä»¶å</span></span><br><span class="line"><span class="string">portsï¼šæš´éœ²å®¹å™¨ç«¯å£ï¼Œä¸-pç›¸åŒï¼Œä½†ç«¯å£ä¸èƒ½ä½äº60ï¼›ä¾‹å¦‚ï¼š-</span> <span class="number">1234</span><span class="string">:80</span></span><br><span class="line"><span class="string">networksï¼šåŠ å…¥é¡¶çº§networksä¸‹é…ç½®çš„ç½‘ç»œ</span></span><br><span class="line"><span class="string">deployï¼šæŒ‡å®šéƒ¨ç½²å’Œè¿è¡ŒæœåŠ¡ç›¸å…³é…ç½®ï¼Œåªèƒ½åœ¨Swarmæ¨¡å¼ä½¿ç”¨</span></span><br><span class="line"><span class="string">volumesï¼šæŒ‚è½½å®¿ä¸»æœºè·¯å¾„æˆ–å‘½ä»¤å·</span></span><br><span class="line"><span class="string">imageï¼šæŒ‡å®šå®¹å™¨è¿è¡Œçš„é•œåƒ</span></span><br><span class="line"><span class="string">commandï¼šæ‰§è¡Œå‘½ä»¤ï¼Œè¦†ç›–é»˜è®¤å‘½ä»¤</span></span><br><span class="line"><span class="string">container_nameï¼šæŒ‡å®šå®¹å™¨åç§°ï¼Œç”±äºå®¹å™¨åç§°æ˜¯å”¯ä¸€çš„ï¼Œå¦‚æœæŒ‡å®šè‡ªå®šä¹‰åç§°ï¼Œåˆ™æ— æ³•scaleï¼ˆæ‰©å±•ï¼‰</span></span><br><span class="line"><span class="string">environmentï¼šæ·»åŠ ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="string">restartï¼šé‡å¯ç­–ç•¥ï¼Œé‡å¯ç­–ç•¥æ˜¯noï¼Œalwaysï¼Œno-failureï¼Œunless-stoped</span></span><br><span class="line"><span class="literal">no</span><span class="string">ï¼Œé»˜è®¤ç­–ç•¥ï¼Œåœ¨å®¹å™¨é€€å‡ºæ—¶ä¸é‡å¯å®¹å™¨ã€‚</span></span><br><span class="line"><span class="string">on-failureï¼Œåœ¨å®¹å™¨éæ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€é0ï¼‰ï¼Œæ‰ä¼šé‡å¯å®¹å™¨ã€‚å¯åŠ (:3)</span> <span class="string">è§„å®šé‡å¯æ¬¡æ•°</span></span><br><span class="line"><span class="string">alwaysï¼Œåœ¨å®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯å®¹å™¨ã€‚</span></span><br><span class="line"><span class="string">unless-stoppedï¼Œåœ¨å®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯å®¹å™¨</span></span><br><span class="line"><span class="string">networksï¼šé…ç½®ç½‘ç»œï¼ŒæŒ‡å®šç½‘å¡è®¾å¤‡ç­‰</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="composeå‘½ä»¤"><a href="#composeå‘½ä»¤" class="headerlink" title="composeå‘½ä»¤"></a>composeå‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.åˆ›å»ºå’Œå¯åŠ¨æœåŠ¡</span></span><br><span class="line">docker compose up</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.åˆ é™¤å’Œåœæ­¢æœåŠ¡</span></span><br><span class="line">docker compose down</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.æœåŠ¡å¯åŠ¨/åœæ­¢/é‡å¯</span></span><br><span class="line">docker compose start/stop/restart</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.æŒ‡å®šå¯åŠ¨æ•°é‡</span></span><br><span class="line">docker compose up --scale master=2 --scale slave=2</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">docker compose logs [ -f å®¹å™¨åç§° --<span class="built_in">tail</span> =50 ]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="mysqlä¸»ä»éƒ¨ç½²"><a href="#mysqlä¸»ä»éƒ¨ç½²" class="headerlink" title="mysqlä¸»ä»éƒ¨ç½²"></a>mysqlä¸»ä»éƒ¨ç½²</h1><h2 id="æ—¥å¿—ä»‹ç»"><a href="#æ—¥å¿—ä»‹ç»" class="headerlink" title="æ—¥å¿—ä»‹ç»"></a>æ—¥å¿—ä»‹ç»</h2><p><img src="/2025/07/14/docker/image-20250716105104999.png" alt="image-20250716105104999"></p><h3 id="binlog-æ—¥å¿—ã€undo-æ—¥å¿—ã€redo-æ—¥å¿—ã€relay-æ—¥å¿—çš„ä½œç”¨ä¸åŒºåˆ«ï¼š"><a href="#binlog-æ—¥å¿—ã€undo-æ—¥å¿—ã€redo-æ—¥å¿—ã€relay-æ—¥å¿—çš„ä½œç”¨ä¸åŒºåˆ«ï¼š" class="headerlink" title="binlog æ—¥å¿—ã€undo æ—¥å¿—ã€redo æ—¥å¿—ã€relay æ—¥å¿—çš„ä½œç”¨ä¸åŒºåˆ«ï¼š"></a>binlog æ—¥å¿—ã€undo æ—¥å¿—ã€redo æ—¥å¿—ã€relay æ—¥å¿—çš„ä½œç”¨ä¸åŒºåˆ«ï¼š</h3><p>åœ¨ MySQL ä¸»ä»éƒ¨ç½²ä¸­ï¼Œä»¥ä¸‹æ˜¯å‡ ç§å…³é”®æ—¥å¿—çš„ä½œç”¨åŠåŒºåˆ«ï¼š</p><h3 id="binlog-æ—¥å¿—ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰"><a href="#binlog-æ—¥å¿—ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰" class="headerlink" title="binlog æ—¥å¿—ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰"></a><strong>binlog æ—¥å¿—ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šè®°å½•æ•°æ®åº“æ‰§è¡Œçš„å˜æ›´ï¼ˆå¦‚ INSERTã€UPDATEã€DELETE ç­‰ï¼‰ï¼Œç”¨äºä¸»ä»å¤åˆ¶å’Œæ•°æ®æ¢å¤ã€‚</li><li><strong>ä¸»ä»å¤åˆ¶ä¸­çš„è§’è‰²</strong>ï¼šä¸»åº“å°† binlog å‘é€ç»™ä»åº“ï¼Œä»åº“é€šè¿‡è§£æ binlog æ¥åŒæ­¥æ•°æ®ã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>é€»è¾‘æ ¼å¼ï¼ˆè®°å½• SQL è¯­å¥ï¼‰æˆ–äºŒè¿›åˆ¶æ ¼å¼ï¼ˆè®°å½•ç‰©ç†å˜æ›´ï¼‰ã€‚</li><li>å¯é€šè¿‡<code>log_bin</code>å‚æ•°å¯ç”¨ï¼Œæ—¥å¿—æ–‡ä»¶é€šå¸¸ä½äº<code>datadir</code>ç›®å½•ä¸‹ï¼ˆå¦‚<code>mysql-bin.xxxxxx</code>ï¼‰ã€‚</li></ul></li></ul><h3 id="undo-æ—¥å¿—ï¼ˆå›æ»šæ—¥å¿—ï¼‰"><a href="#undo-æ—¥å¿—ï¼ˆå›æ»šæ—¥å¿—ï¼‰" class="headerlink" title="undo æ—¥å¿—ï¼ˆå›æ»šæ—¥å¿—ï¼‰"></a><strong>undo æ—¥å¿—ï¼ˆå›æ»šæ—¥å¿—ï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šè®°å½•äº‹åŠ¡æ‰§è¡Œå‰çš„æ•°æ®çŠ¶æ€ï¼Œç”¨äºå›æ»šæœªæäº¤çš„äº‹åŠ¡æˆ– MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰ã€‚</li><li><strong>ä¸»ä»å¤åˆ¶ä¸­çš„è§’è‰²</strong>ï¼šä¸ç›´æ¥å‚ä¸å¤åˆ¶ï¼Œä»…ç”¨äºæœ¬åœ°äº‹åŠ¡å›æ»šã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼ˆAtomicityï¼‰å’Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€‚</li><li>å­˜å‚¨åœ¨<code>undo tablespace</code>ä¸­ï¼Œå¯é€šè¿‡<code>innodb_undo_tablespaces</code>å‚æ•°é…ç½®ã€‚</li></ul></li></ul><h3 id="redo-æ—¥å¿—ï¼ˆé‡åšæ—¥å¿—ï¼‰"><a href="#redo-æ—¥å¿—ï¼ˆé‡åšæ—¥å¿—ï¼‰" class="headerlink" title="redo æ—¥å¿—ï¼ˆé‡åšæ—¥å¿—ï¼‰"></a><strong>redo æ—¥å¿—ï¼ˆé‡åšæ—¥å¿—ï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šè®°å½•äº‹åŠ¡å¯¹æ•°æ®é¡µçš„ç‰©ç†ä¿®æ”¹ï¼Œç”¨äºå´©æºƒæ¢å¤ï¼ˆä¿è¯å·²æäº¤äº‹åŠ¡ä¸ä¸¢å¤±ï¼‰ã€‚</li><li><strong>ä¸»ä»å¤åˆ¶ä¸­çš„è§’è‰²</strong>ï¼šä¸ç›´æ¥å‚ä¸å¤åˆ¶ï¼Œç¡®ä¿ä¸»åº“æ•°æ®æŒä¹…åŒ–åæ‰é€šçŸ¥ä»åº“ã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>é¡ºåºå†™å…¥ï¼Œæ•ˆç‡é«˜ï¼Œé¿å…éšæœº IOã€‚</li><li>å­˜å‚¨åœ¨<code>ib_logfile*</code>æ–‡ä»¶ä¸­ï¼Œå¯é€šè¿‡<code>innodb_log_files_in_group</code>å’Œ<code>innodb_log_file_size</code>å‚æ•°é…ç½®ã€‚</li></ul></li></ul><h3 id="relay-æ—¥å¿—ï¼ˆä¸­ç»§æ—¥å¿—ï¼‰"><a href="#relay-æ—¥å¿—ï¼ˆä¸­ç»§æ—¥å¿—ï¼‰" class="headerlink" title="relay æ—¥å¿—ï¼ˆä¸­ç»§æ—¥å¿—ï¼‰"></a><strong>relay æ—¥å¿—ï¼ˆä¸­ç»§æ—¥å¿—ï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šä»åº“ç”¨äºå­˜å‚¨ä»ä¸»åº“æ¥æ”¶çš„ binlog äº‹ä»¶ï¼Œä¾› SQL çº¿ç¨‹æ‰§è¡Œã€‚</li><li><strong>ä¸»ä»å¤åˆ¶ä¸­çš„è§’è‰²</strong>ï¼šä»åº“ IO çº¿ç¨‹å°†ä¸»åº“çš„ binlog å†™å…¥ relay logï¼ŒSQL çº¿ç¨‹ä»ä¸­è¯»å–å¹¶æ‰§è¡Œã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>ä¸´æ—¶å­˜å‚¨ï¼Œæ‰§è¡Œåå¯åˆ é™¤ã€‚</li><li>æ–‡ä»¶é€šå¸¸ä½äº<code>datadir</code>ç›®å½•ä¸‹ï¼ˆå¦‚<code>relay-bin.xxxxxx</code>ï¼‰ï¼Œå¯é€šè¿‡<code>relay_log</code>å‚æ•°æŒ‡å®šè·¯å¾„ã€‚</li></ul></li></ul><h3 id="ä¸»ä»å¤åˆ¶æµç¨‹ä¸­çš„åä½œ"><a href="#ä¸»ä»å¤åˆ¶æµç¨‹ä¸­çš„åä½œ" class="headerlink" title="ä¸»ä»å¤åˆ¶æµç¨‹ä¸­çš„åä½œ"></a><strong>ä¸»ä»å¤åˆ¶æµç¨‹ä¸­çš„åä½œ</strong></h3><ol><li><strong>ä¸»åº“</strong>ï¼šæ‰§è¡Œäº‹åŠ¡ â†’ å†™å…¥ binlog â†’ å‘é€ binlog åˆ°ä»åº“ã€‚</li><li>ä»åº“ï¼š<ul><li>IO çº¿ç¨‹æ¥æ”¶ binlog â†’ å†™å…¥ relay logã€‚</li><li>SQL çº¿ç¨‹è¯»å– relay log â†’ æ‰§è¡Œ SQL è¯­å¥ â†’ æ›´æ–°æ•°æ®ã€‚</li><li>å†™å…¥ redo&#x2F;undo æ—¥å¿—ä¿è¯æœ¬åœ°äº‹åŠ¡çš„æŒä¹…æ€§å’Œä¸€è‡´æ€§ã€‚</li></ul></li></ol><h3 id="æ€»ç»“å¯¹æ¯”"><a href="#æ€»ç»“å¯¹æ¯”" class="headerlink" title="æ€»ç»“å¯¹æ¯”"></a><strong>æ€»ç»“å¯¹æ¯”</strong></h3><table><thead><tr><th>æ—¥å¿—ç±»å‹</th><th>ç”¨é€”</th><th>ä¸»ä»å¤åˆ¶ä¸­çš„è§’è‰²</th><th>å­˜å‚¨ä½ç½®</th></tr></thead><tbody><tr><td><strong>binlog</strong></td><td>è®°å½•å˜æ›´ï¼Œç”¨äºå¤åˆ¶å’Œæ¢å¤</td><td>ä¸»åº“ç”Ÿæˆï¼Œä»åº“åŒæ­¥</td><td>ä¸»åº“<code>mysql-bin.*</code></td></tr><tr><td><strong>undo</strong></td><td>å›æ»šäº‹åŠ¡ï¼Œæ”¯æŒ MVCC</td><td>ä¸å‚ä¸å¤åˆ¶</td><td><code>undo tablespace</code></td></tr><tr><td><strong>redo</strong></td><td>å´©æºƒæ¢å¤ï¼Œä¿è¯æŒä¹…åŒ–</td><td>ç¡®ä¿ä¸»åº“æ•°æ®æŒä¹…åŒ–</td><td><code>ib_logfile*</code></td></tr><tr><td><strong>relay</strong></td><td>ä¸´æ—¶å­˜å‚¨ä¸»åº“ binlogï¼Œä¾›ä»åº“æ‰§è¡Œ</td><td>ä»åº“æ¥æ”¶ä¸»åº“ binlog åç”Ÿæˆ</td><td>ä»åº“<code>relay-bin.*</code></td></tr></tbody></table><p>åˆç†é…ç½®è¿™äº›æ—¥å¿—å¯¹ä¸»ä»å¤åˆ¶çš„æ€§èƒ½å’Œå¯é æ€§è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œè°ƒæ•´ binlog æ ¼å¼ï¼ˆ<code>binlog_format</code>ï¼‰ã€redo æ—¥å¿—å¤§å°ï¼ˆ<code>innodb_log_file_size</code>ï¼‰ç­‰å‚æ•°å¯ä¼˜åŒ–å¤åˆ¶æ•ˆç‡ã€‚</p><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><p><img src="/2025/07/14/docker/image-20250716105032843.png" alt="image-20250716105032843"></p><h3 id="docker-compose-yaml"><a href="#docker-compose-yaml" class="headerlink" title="docker-compose.yaml"></a>docker-compose.yaml</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2.27&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql_m:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql_m</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">mysql_m</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3336</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./my_m.conf:/etc/mysql/conf.d/my.cnf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_m_volume:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_m_volume:/var/log/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root</span> </span><br><span class="line">  </span><br><span class="line">  <span class="attr">mysql_s:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql_s</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">mysql_s</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3337</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./my_s.conf:/etc/mysql/conf.d/my.cnf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_s_volume:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_s_volume:/var/log/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root</span> </span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">mysql_net:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mysql_net</span></span><br><span class="line">    <span class="attr">ipam:</span></span><br><span class="line">      <span class="attr">driver:</span> <span class="string">default</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">subnet:</span> <span class="number">192.168</span><span class="number">.100</span><span class="number">.0</span><span class="string">/24</span></span><br><span class="line">          <span class="attr">gateway:</span> <span class="number">192.168</span><span class="number">.100</span><span class="number">.1</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql_m_volume:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mysql_m_volume</span></span><br><span class="line">  <span class="attr">mysql_s_volume:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mysql_s_volume</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹ä¸»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy-m-conf"><a href="#ä¿®æ”¹ä¸»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy-m-conf" class="headerlink" title="ä¿®æ”¹ä¸»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy_m.conf"></a>ä¿®æ”¹ä¸»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy_m.conf</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">mysqld</span>]</span><br><span class="line"> <span class="comment">#ä¸»æœåŠ¡å™¨å”¯ä¸€ID</span></span><br><span class="line"><span class="string">server_id=1</span></span><br><span class="line"> <span class="comment">#å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—</span></span><br><span class="line"><span class="string">log-bin=mysql-bin</span></span><br><span class="line"><span class="comment">#ä¸Šé¢ä¸¤è¡Œæœ€é‡è¦ï¼Œä¸‹é¢çš„å¯ä»¥ä¸é…ç½®# è®¾ç½®ä¸è¦å¤åˆ¶çš„æ•°æ®åº“(å¯è®¾ç½®å¤šä¸ª)</span></span><br><span class="line"><span class="string">binlog-ignore-db=mysql</span></span><br><span class="line"><span class="string">binlog-ignore-db=information_schema</span></span><br><span class="line"> <span class="comment">#è®¾ç½®éœ€è¦å¤åˆ¶çš„æ•°æ®åº“ éœ€è¦å¤åˆ¶çš„ä¸»æ•°æ®åº“åå­—</span></span><br><span class="line"><span class="string">binlog-do-db=test</span></span><br><span class="line"> <span class="comment">#è®¾ç½®logbinæ ¼å¼ Rowã€Statementã€Mixed</span></span><br><span class="line"><span class="string">binlog_format=STATEMENT</span></span><br><span class="line"> <span class="comment"># Disabling symbolic-links is recommended to prevent assorted security risks å…³é—­é…ç½®å¤–å­˜å‚¨</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹ä»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy-s-conf"><a href="#ä¿®æ”¹ä»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy-s-conf" class="headerlink" title="ä¿®æ”¹ä»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy_s.conf"></a>ä¿®æ”¹ä»æœåŠ¡é…ç½®æ–‡ä»¶ï¼šmy_s.conf</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">mysqld</span>]</span><br><span class="line"><span class="string">server-id=2</span></span><br><span class="line"><span class="string">relay-log=relay-bin</span> <span class="comment">#å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—</span></span><br><span class="line"><span class="string">log-bin=mysql-bin</span> <span class="comment">#ä¸Šé¢ä¸¤è¡Œæœ€é‡è¦ï¼Œä¸‹é¢çš„å¯ä»¥ä¸é…ç½®# è®¾ç½®ä¸è¦å¤åˆ¶çš„æ•°æ®åº“(å¯è®¾ç½®å¤šä¸ª)</span></span><br><span class="line"><span class="comment"># read_only=1 #ä»æœåŠ¡å™¨åªè¯»</span></span><br><span class="line"><span class="string">slave-skip-errors=</span> <span class="number">1032</span><span class="string">,1062,1007,1050</span> <span class="comment">#å¿½ç•¥æŠ¥é”™</span></span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡ŒéªŒè¯"><a href="#æ‰§è¡ŒéªŒè¯" class="headerlink" title="æ‰§è¡ŒéªŒè¯"></a>æ‰§è¡ŒéªŒè¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> mysql_service/</span><br><span class="line">docker compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥ä¸»æœºå®¹å™¨</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql_m bash</span><br><span class="line"><span class="comment"># ç™»å½•mysql</span></span><br><span class="line">mysql -uroot -proot</span><br><span class="line"></span><br><span class="line">show master status;</span><br><span class="line"><span class="comment"># å‡ºç°ä»¥ä¸‹å†…å®¹è¯´æ˜my_m.confã€my_s.confé…ç½®å•å·²ç”Ÿæ•ˆ</span></span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716110119283.png" alt="image-20250716110119283"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªè´¦å·ï¼ˆç”¨æˆ·åï¼šworker å¯†ç ï¼šrootï¼‰</span></span><br><span class="line">create user <span class="string">&#x27;worker&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="comment"># ç»™æƒé™</span></span><br><span class="line">grant replication slave,replication client on *.* to <span class="string">&#x27;worker&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="comment"># å»ºåº“</span></span><br><span class="line">create database <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># éœ€è¦åœ¨æ‰§è¡Œä»¥ä¸‹é…ç½®å‰å†æŸ¥çœ‹ä¸€ä¸‹çŠ¶æ€ï¼ˆä¼šå˜ï¼‰</span></span><br><span class="line">show master status;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å¼€ä¸€ä¸ªç»ˆç«¯çª—å£è¿›å…¥ä»æœºå®¹å™¨</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql_s bash</span><br><span class="line"><span class="comment"># ç™»å½•mysql</span></span><br><span class="line">mysql -uroot -proot</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.ç™»å½•ä»æœåŠ¡å™¨é…ç½®æ‰§è¡Œ</span></span><br><span class="line">CHANGE MASTER TO MASTER_HOST=<span class="string">&#x27;mysql_m&#x27;</span>,</span><br><span class="line">MASTER_USER=<span class="string">&#x27;worker&#x27;</span>,</span><br><span class="line">MASTER_PASSWORD=<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">MASTER_PORT=3306, </span><br><span class="line">MASTER_LOG_FILE=<span class="string">&#x27;mysql-bin.000001&#x27;</span>,MASTER_LOG_POS=778;</span><br><span class="line"></span><br><span class="line"><span class="comment">#èµ·æœåŠ¡</span></span><br><span class="line">start slave;</span><br><span class="line"><span class="comment">#æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">show slave status\G;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»æœºå»ºåº“ä¸ä¼šåŒæ­¥ï¼Œéœ€è¦å…ˆæ‰‹åŠ¨å»ºåº“</span></span><br><span class="line">create database <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ä¸»æœºteståº“ä¸­é”®ä¸€å¼ è¡¨</span></span><br><span class="line">use <span class="built_in">test</span>;</span><br><span class="line">create table <span class="built_in">test</span> (<span class="built_in">id</span> int);</span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ä»æœºä¸­éªŒè¯ï¼Œä¼šåŒæ­¥åˆ›å»ºè¯¥è¡¨</span></span><br><span class="line">use <span class="built_in">test</span>;</span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è‹¥ä¹‹å‰åŒæ­¥å¤±è´¥ï¼Œä¿®æ­£åå¯ç”¨ä»¥ä¸‹å‘½ä»¤é‡æ–°åŒæ­¥</span></span><br><span class="line">stop slave;</span><br><span class="line">reset master;</span><br><span class="line">start slave;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">show slave status\G;</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716110205604.png" alt="image-20250716110205604"></p><h1 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h1><h2 id="redisä»‹ç»"><a href="#redisä»‹ç»" class="headerlink" title="redisä»‹ç»"></a>redisä»‹ç»</h2><p>â€‹    REmote DIctionary Server(Redis) æ˜¯ä¸€ä¸ªç”± Salvatore Sanfilippo å†™çš„ <strong>key-value å­˜å‚¨ç³»ç»Ÿ</strong>ï¼Œæ˜¯è·¨å¹³å°çš„<strong>éå…³ç³»å‹æ•°æ®åº“</strong>ã€‚</p><p>â€‹    Redis æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ ANSI C è¯­è¨€ç¼–å†™ã€éµå®ˆ BSD åè®®ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜ã€åˆ†å¸ƒå¼ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹(Key-Value)å­˜å‚¨æ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„ APIã€‚</p><p>â€‹    Redis é€šå¸¸è¢«ç§°ä¸º<strong>æ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯å­—ç¬¦ä¸²(String)ã€å“ˆå¸Œ(Hash)ã€åˆ—è¡¨(list)ã€é›†åˆ(sets)å’Œæœ‰åºé›†åˆ(sorted sets)ç­‰ç±»å‹</strong>ã€‚</p><h2 id="rediséƒ¨ç½²æ–¹æ¡ˆä»‹ç»"><a href="#rediséƒ¨ç½²æ–¹æ¡ˆä»‹ç»" class="headerlink" title="rediséƒ¨ç½²æ–¹æ¡ˆä»‹ç»"></a>rediséƒ¨ç½²æ–¹æ¡ˆä»‹ç»</h2><table><thead><tr><th>ç‰¹æ€§&#x2F;é…ç½®</th><th><strong>Redis</strong> <strong>ä¸»ä»å¤åˆ¶</strong></th><th><strong>Redis</strong> <strong>å“¨å…µ</strong></th><th><strong>Redis</strong> <strong>é›†ç¾¤</strong></th></tr></thead><tbody><tr><td><strong>ä¸»è¦ç›®çš„</strong></td><td>æ•°æ®å¤‡ä»½ä¸è¯»å†™åˆ†ç¦»</td><td>é«˜å¯ç”¨æ€§å’Œæ•…éšœè‡ªåŠ¨åˆ‡æ¢</td><td>é«˜å¹¶å‘å’Œæ•°æ®åˆ†æ•£å¤„ç†</td></tr><tr><td><strong>æ¶æ„</strong></td><td>ä¸€ä¸ªä¸»èŠ‚ç‚¹å’Œå¤šä¸ªä»èŠ‚ç‚¹</td><td>ç›‘æ§ä¸»ä»ç»“æ„å¹¶è‡ªåŠ¨åˆ‡æ¢</td><td>å¤šä¸ªä¸»èŠ‚ç‚¹ï¼Œæ•°æ®åˆ†ç‰‡</td></tr><tr><td><strong>æ•°æ®å¤åˆ¶</strong></td><td>ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹</td><td>ç›‘æ§å¹¶ç®¡ç†ä¸»ä»å¤åˆ¶</td><td>æ¯ä¸ªä¸»èŠ‚ç‚¹ç®¡ç†è‡ªå·±çš„æ•°æ®é›†</td></tr><tr><td><strong>æ•…éšœè½¬ç§»æœºåˆ¶</strong></td><td>æ‰‹åŠ¨æˆ–å“¨å…µè‡ªåŠ¨åˆ‡æ¢</td><td>è‡ªåŠ¨æ•…éšœè½¬ç§»</td><td>è‡ªåŠ¨å¤„ç†èŠ‚ç‚¹æ•…éšœ</td></tr><tr><td><strong>å¯ä¼¸ç¼©æ€§</strong></td><td>æœ‰é™ï¼Œä¾èµ–ä¸»èŠ‚ç‚¹</td><td>ä¸ºä¸»ä»ç»“æ„å¢åŠ é«˜å¯ç”¨æ€§</td><td>é«˜ï¼Œå› ä¸ºæ•°æ®åˆ†å¸ƒå¼å¤„ç†</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>æ•°æ®å¤‡ä»½å’Œè¯»æ‰©å±•</td><td>å…³é”®åº”ç”¨çš„é«˜å¯ç”¨æ€§</td><td>å¤§è§„æ¨¡åº”ç”¨çš„é«˜æ€§èƒ½éœ€æ±‚</td></tr><tr><td><strong>è®¾ç½®å¤æ‚åº¦</strong></td><td>ç›¸å¯¹ç®€å•</td><td>ä¸­ç­‰ï¼Œéœ€é…ç½®å“¨å…µ</td><td>å¤æ‚ï¼Œéœ€è§„åˆ’æ•°æ®åˆ†åŒº</td></tr></tbody></table><h2 id="redisä¸€ä¸»ä¸¤ä»ä¸‰å“¨å…µéƒ¨ç½²æ–¹æ¡ˆ"><a href="#redisä¸€ä¸»ä¸¤ä»ä¸‰å“¨å…µéƒ¨ç½²æ–¹æ¡ˆ" class="headerlink" title="redisä¸€ä¸»ä¸¤ä»ä¸‰å“¨å…µéƒ¨ç½²æ–¹æ¡ˆ"></a>redisä¸€ä¸»ä¸¤ä»ä¸‰å“¨å…µéƒ¨ç½²æ–¹æ¡ˆ</h2><p><img src="/2025/07/14/docker/image-20250716191145724.png" alt="image-20250716191145724"></p><h2 id="éƒ¨ç½²-1"><a href="#éƒ¨ç½²-1" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><h3 id="é…ç½®docker-compose-yamlæ–‡ä»¶"><a href="#é…ç½®docker-compose-yamlæ–‡ä»¶" class="headerlink" title="é…ç½®docker-compose.yamlæ–‡ä»¶"></a>é…ç½®docker-compose.yamlæ–‡ä»¶</h3><ol><li><p>åˆ›å»ºæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> redis_service</span><br><span class="line">vim redis_service/docker-compose.yaml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis1:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis1</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">redis1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6379</span><span class="string">:6379</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">16379</span><span class="string">:16379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis1/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis1/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-server</span> <span class="string">/etc/conf/redis.conf</span></span><br><span class="line">  <span class="attr">redis2:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis2</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">redis2</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6380</span><span class="string">:6380</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">16380</span><span class="string">:16380</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis2/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis2/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-server</span> <span class="string">/etc/conf/redis.conf</span></span><br><span class="line">  <span class="attr">redis3:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis3</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">redis3</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6381</span><span class="string">:6381</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">16381</span><span class="string">:16381</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis3/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis3/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-server</span> <span class="string">/etc/conf/redis.conf</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">sentinel1:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">sentinel1</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">sentinel1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">26379</span><span class="string">:26379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sentinel1/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./setinel1/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-sentinel</span> <span class="string">/etc/conf/sentinel.conf</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">sentinel2:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">sentinel2</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">sentinel2</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">26380</span><span class="string">:26379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sentinel2/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./setinel2/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-sentinel</span> <span class="string">/etc/conf/sentinel.conf</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">sentinel3:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">sentinel3</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">sentinel3</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">26381</span><span class="string">:26379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sentinel3/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./setinel3/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-sentinel</span> <span class="string">/etc/conf/sentinel.conf</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">redis_net:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /redis_service</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure></li></ol><h3 id="redis-masteré…ç½®æ–‡ä»¶"><a href="#redis-masteré…ç½®æ–‡ä»¶" class="headerlink" title="redis_masteré…ç½®æ–‡ä»¶"></a>redis_masteré…ç½®æ–‡ä»¶</h3><p>é…ç½®æ–‡ä»¶åredis.confï¼Œåœ¨redis1&#x2F;conf&#x2F;redis.conf</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">databases</span> <span class="number">10</span> </span><br><span class="line"><span class="string">bind</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">#ç›‘å¬ </span></span><br><span class="line"><span class="string">port</span> <span class="number">6379</span></span><br><span class="line"><span class="comment">#è®¿é—®å¯†ç  </span></span><br><span class="line"><span class="string">requirepass</span> <span class="number">123456</span></span><br><span class="line"><span class="string">masterauth</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#æŒä¹…åŒ–æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">dir</span> <span class="string">/data</span> </span><br><span class="line"><span class="comment">#æŒä¹…åŒ–æ–‡ä»¶</span></span><br><span class="line"><span class="string">dbfilename</span> <span class="string">dump.rdb</span></span><br><span class="line"><span class="comment">#å¯ç”¨ RDB æŒä¹…åŒ–æ–‡ä»¶çš„å‹ç¼©</span></span><br><span class="line"><span class="string">rdbcompression</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment">#å¦‚æœåå°ä¿å­˜å‡ºé”™åˆ™åœæ­¢å†™å…¥</span></span><br><span class="line"><span class="string">stop-writes-on-bgsave-error</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment">#å…³é—­ä¿æŠ¤æ¨¡å¼</span></span><br><span class="line"><span class="string">protected-mode</span> <span class="literal">no</span></span><br><span class="line"><span class="comment">#åœ¨ç©ºæ•°æ®åº“æ—¶è¿›è¡Œæ— ç›˜å¤åˆ¶åŠ è½½</span></span><br><span class="line"><span class="string">repl-diskless-load</span> <span class="string">on-empty-db</span></span><br><span class="line"><span class="comment">#å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ</span></span><br><span class="line"><span class="comment">#daemonize yes</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒä¹…åŒ–ç­–ç•¥</span></span><br><span class="line"><span class="comment">#è¡¨ç¤ºå¦‚æœåœ¨ 900 ç§’ï¼ˆ15 åˆ†é’Ÿï¼‰å†…æœ‰è‡³å°‘ 1 æ¬¡æ•°æ®ä¿®æ”¹æ“ä½œï¼Œåˆ™æ‰§è¡Œä¸€æ¬¡ RDB æŒä¹…åŒ–ã€‚</span></span><br><span class="line"><span class="string">save</span> <span class="number">900</span> <span class="number">1</span> </span><br><span class="line"><span class="comment">#åœ¨ 300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰å†…æœ‰è‡³å°‘ 10 æ¬¡æ•°æ®ä¿®æ”¹æ“ä½œï¼Œå°±æ‰§è¡Œä¸€æ¬¡ RDB æŒä¹…åŒ–ã€‚</span></span><br><span class="line"><span class="string">save</span> <span class="number">300</span> <span class="number">10</span>     </span><br><span class="line"><span class="string">save</span> <span class="number">60</span> <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ—¥å¿—</span></span><br><span class="line"><span class="string">logfile</span> <span class="string">redis.log</span></span><br></pre></td></tr></table></figure><h3 id="redis-slaveé…ç½®æ–‡ä»¶"><a href="#redis-slaveé…ç½®æ–‡ä»¶" class="headerlink" title="redis_slaveé…ç½®æ–‡ä»¶"></a>redis_slaveé…ç½®æ–‡ä»¶</h3><p>redis2å’Œredis3</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®ä¾‹åŒ–æ•°æ®åº“</span></span><br><span class="line"><span class="string">databases</span> <span class="number">10</span></span><br><span class="line"><span class="string">bind</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> </span><br><span class="line"><span class="comment">#ç›‘å¬</span></span><br><span class="line"><span class="string">port</span> <span class="number">6380</span></span><br><span class="line"><span class="comment">#è®¿é—®å¯†ç å’Œä¸»æœºå¯†ç </span></span><br><span class="line"><span class="string">requirepass</span> <span class="number">123456</span></span><br><span class="line"><span class="string">masterauth</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#æŒä¹…åŒ–æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">dir</span> <span class="string">/data</span> </span><br><span class="line"><span class="comment">#æŒä¹…åŒ–æ–‡ä»¶</span></span><br><span class="line"><span class="string">dbfilename</span> <span class="string">dump.rdb</span></span><br><span class="line"><span class="comment">#æŒ‡å®šæœ¬åœ°æ•°æ®å­˜å‚¨å‹ç¼©</span></span><br><span class="line"><span class="string">rdbcompression</span> <span class="literal">yes</span></span><br><span class="line"><span class="string">stop-writes-on-bgsave-error</span> <span class="literal">yes</span></span><br><span class="line"><span class="string">protected-mode</span> <span class="literal">no</span></span><br><span class="line"><span class="string">repl-diskless-load</span> <span class="string">on-empty-db</span></span><br><span class="line"><span class="comment">#daemonize yes</span></span><br><span class="line"><span class="comment">#protected-mode</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒä¹…åŒ–ç­–ç•¥</span></span><br><span class="line"><span class="string">save</span> <span class="number">900</span> <span class="number">1</span></span><br><span class="line"><span class="string">save</span> <span class="number">300</span> <span class="number">10</span></span><br><span class="line"><span class="string">save</span> <span class="number">60</span> <span class="number">10000</span></span><br><span class="line"><span class="comment">#æ—¥å¿—è·¯å¾„</span></span><br><span class="line"><span class="string">logfile</span> <span class="string">redis.log</span></span><br><span class="line"><span class="string">replicaof</span> <span class="string">redis1</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure><h3 id="sentinelé…ç½®æ–‡ä»¶"><a href="#sentinelé…ç½®æ–‡ä»¶" class="headerlink" title="sentinelé…ç½®æ–‡ä»¶"></a>sentinelé…ç½®æ–‡ä»¶</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#vim /usr/local/redis/etc/sentinel.conf</span></span><br><span class="line"> <span class="comment">#æ“ä½œç«¯å£</span></span><br><span class="line"> <span class="comment">#ç»‘å®šæ‰€æœ‰ç½‘ç»œæ¥å£</span></span><br><span class="line"><span class="string">bind</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">#å“¨å…µæœåŠ¡ç›‘å¬çš„ç«¯å£ã€‚</span></span><br><span class="line"><span class="string">port</span> <span class="number">26379</span></span><br><span class="line"><span class="comment">#æŒ‡å®šè¿›ç¨‹ ID æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line"><span class="string">pidfile</span> <span class="string">&quot;/data/redis-sentinel.pid&quot;</span></span><br><span class="line"><span class="comment">#å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="string">dir</span> <span class="string">&quot;/tmp&quot;</span> </span><br><span class="line"><span class="comment">#è®¾ç½®è®¿é—®å“¨å…µçš„å¯†ç </span></span><br><span class="line"><span class="string">requirepass</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#dockerå¿…å…³ ä¸ä»¥åå°è¿›ç¨‹æ–¹å¼è¿è¡Œ</span></span><br><span class="line"><span class="string">daemonize</span> <span class="literal">no</span> </span><br><span class="line"><span class="comment">#å…³é—­ä¿æŠ¤æ¨¡å¼</span></span><br><span class="line"><span class="string">protected-mode</span> <span class="literal">no</span> </span><br><span class="line"><span class="comment">#æŒ‡å®šæ—¥å¿—æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">logfile</span> <span class="string">&quot;/data/redis-sentinel.log&quot;</span></span><br><span class="line"><span class="comment">#å¯ç”¨ä¸»æœºåè§£æ</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">resolve-hostnames</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment">#ç›‘æ§åä¸ºredisMasterçš„ä¸»èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹åä¸ºredis1ï¼Œç«¯å£ä¸º 6379ï¼Œéœ€è¦è‡³å°‘ 2 ä¸ªå“¨å…µ</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">monitor</span> <span class="string">redisMaster</span> <span class="string">redis1</span> <span class="number">6379 </span><span class="number">2</span></span><br><span class="line"><span class="comment">#è¯¥ä¸»èŠ‚ç‚¹çš„è®¤è¯å¯†ç </span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">auth-pass</span> <span class="string">redisMaster</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#åœ¨æŒ‡å®šæ¯«ç§’æ•°åè®¤ä¸ºè¯¥ä¸»èŠ‚ç‚¹ä¸»è§‚ä¸‹çº¿ã€‚</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">down-after-milliseconds</span> <span class="string">redisMaster</span> <span class="number">100</span> </span><br><span class="line"><span class="comment">#æ•…éšœè½¬ç§»æ—¶åŒæ—¶åŒæ­¥çš„ä»èŠ‚ç‚¹æ•°é‡ä¸º 1 ä¸ª</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">parallel-syncs</span> <span class="string">redisMaster</span> <span class="number">1</span></span><br><span class="line"><span class="comment">#æ•…éšœè½¬ç§»è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">failover-timeout</span> <span class="string">redisMaster</span> <span class="number">600</span> </span><br></pre></td></tr></table></figure><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> redis_service</span><br><span class="line">docker compose down </span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716193050241.png" alt="image-20250716193050241"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716194121868.png" alt="image-20250716194121868"></p><ol><li>æŸ¥çœ‹ä»æœº</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# docker <span class="built_in">exec</span> -it redis1 redis-cli -p 6379</span><br><span class="line">127.0.0.1:6380&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716194621403.png" alt="image-20250716194621403"></p><ol start="2"><li>æŸ¥çœ‹ä»æœº</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# docker <span class="built_in">exec</span> -it redis2 redis-cli -p 6380</span><br><span class="line">127.0.0.1:6380&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716195916911.png" alt="image-20250716195916911"></p><ol start="3"><li>æŸ¥çœ‹å“¨å…µ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 redis_service]# docker <span class="built_in">exec</span> -it sentinel1 redis-cli -p 26379 </span><br><span class="line">127.0.0.1:26379&gt; info</span><br><span class="line">NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:26379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:26379&gt; info</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716195114095.png" alt="image-20250716195114095"></p><ol start="4"><li>äººä¸ºåœæ‰ä¸€ä¸ªredis</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker container redis1 stop</span><br><span class="line"><span class="comment"># å†æ¬¡æŸ¥çœ‹å“¨å…µ</span></span><br><span class="line">[root@CentOS7 redis_service]# docker <span class="built_in">exec</span> -it sentinel1 redis-cli -p 26379 </span><br><span class="line">127.0.0.1:26379&gt; info</span><br><span class="line">NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:26379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:26379&gt; info</span><br></pre></td></tr></table></figure><p><img src="/2025/07/14/docker/image-20250716200102571.png" alt="image-20250716200102571"></p><h1 id="kubernetesä»‹ç»ä»¥åŠåº”ç”¨"><a href="#kubernetesä»‹ç»ä»¥åŠåº”ç”¨" class="headerlink" title="kubernetesä»‹ç»ä»¥åŠåº”ç”¨"></a>kubernetesä»‹ç»ä»¥åŠåº”ç”¨</h1><ul><li><p>Kubernetesï¼ˆç®€ç§°k8sï¼‰æ˜¯ä¸€ä¸ª<strong>å¼€æºçš„å®¹å™¨ç¼–æ’å¹³å°</strong>ï¼Œç”¨äº<strong>è‡ªåŠ¨åŒ–éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨</strong>ã€‚</p></li><li><p>å®ƒçš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬<strong>è‡ªåŠ¨åŒ–å®¹å™¨éƒ¨ç½²ã€è´Ÿè½½å‡è¡¡ã€è‡ªæˆ‘ä¿®å¤ã€å­˜å‚¨ç¼–æ’ä»¥åŠè·¨é›†ç¾¤èµ„æºç®¡ç†</strong>ã€‚</p></li><li><p>é€šè¿‡Kubernetesï¼Œä¼ä¸šèƒ½å¤Ÿé«˜æ•ˆç®¡ç†å¤§è§„æ¨¡çš„å®¹å™¨åŒ–åº”ç”¨ï¼Œç¡®ä¿åº”ç”¨çš„é«˜å¯ç”¨æ€§å’Œå¼¹æ€§æ‰©å±•ã€‚</p></li></ul><p>æ ¸å¿ƒåŠŸèƒ½ï¼š</p><ol><li><strong>è‡ªåŠ¨è°ƒåº¦</strong>ï¼šå°†å®¹å™¨æ”¾åˆ°K8Sé›†ç¾¤çš„ä»»æ„èŠ‚ç‚¹ä¸­ï¼Œå¹¶æ ¹æ®å®¹å™¨éœ€è¦å’ŒèŠ‚ç‚¹è´Ÿè½½å†³å®šç›®æ ‡èŠ‚ç‚¹ã€‚</li><li><strong>è‡ªåŠ¨ä¿®å¤</strong>ï¼šå½“å¥åº·æ£€æŸ¥å‘ç°èŠ‚ç‚¹é—®é¢˜ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†èŠ‚ç‚¹ä¸Šçš„èµ„æºè¿›è¡Œè½¬ç§»ï¼Œå¹¶æ¢å¤åŠŸèƒ½ã€‚</li><li><strong>è‡ªåŠ¨ç¼©æ‰©å®¹</strong>ï¼šé€šè¿‡é¢„å®šä¹‰è´Ÿè½½æŒ‡æ ‡ï¼Œæ ¹æ®æŒ‡æ ‡è‡ªåŠ¨è§¦å‘åŠ¨æ€ç¼©æ‰©å®¹è¡Œä¸ºã€‚</li></ol><h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><h4 id="Master"><a href="#Master" class="headerlink" title="Master"></a>Master</h4><p>Masterä¸ºæ§åˆ¶èŠ‚ç‚¹ï¼Œè´Ÿè´£æ•´ä¸ªé›†ç¾¤çš„ç®¡ç†æ§åˆ¶ã€‚</p><p>MasterèŠ‚ç‚¹ç”±ï¼šAPIserverã€ETCD ã€controller Managerã€scheduleç­‰ç»„ä»¶æ„æˆã€‚</p><h4 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h4><p>Nodeçš„ä½œç”¨æ˜¯æ‰¿æ¥å·¥ä½œè´Ÿè½½ã€‚</p><p>NodeèŠ‚ç‚¹æœ‰ç”±ï¼škubeletã€rumtimeã€kube-proxyç»„æˆã€‚</p><p><img src="/2025/07/14/docker/image-20250717202918467.png" alt="image-20250717202918467"></p><p>å®¢æˆ·ç«¯ï¼šKubectlã€UIï¼šè´Ÿè´£ç»™API-Serverå‘é€æŒ‡ä»¤ã€‚</p><p>API-Serverï¼šæ¥å—æŒ‡ä»¤ï¼ŒK8sé›†ç¾¤çš„æ ¸å¿ƒï¼Œæ˜¯é›†ç¾¤çš„APIå…¥å£ã€‚å®ƒè´Ÿè´£å¤„ç†æ¥è‡ªå„ç§å®¢æˆ·ç«¯çš„REST APIè¯·æ±‚èµ„æºå¹¶å¯¹å…¶è¿›è¡ŒéªŒè¯ã€æˆæƒï¼Œå¹¶å°†æœ‰æ•ˆçš„è¯·æ±‚æŒä¹…åŒ–åˆ°etcdæ•°æ®åº“ã€‚</p><p>ETCDï¼šåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œç”¨äºä¿å­˜Kubernetesé›†ç¾¤çš„æ‰€æœ‰é…ç½®æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚å®ƒå­˜å‚¨äº†é›†ç¾¤ä¸­çš„å„ç§èµ„æºå¯¹è±¡çš„å…ƒæ•°æ®ã€‚</p><p>Schedulerï¼šè´Ÿè´£å°†æœªè°ƒåº¦çš„Podsåˆ†é…åˆ°åˆé€‚çš„NodeèŠ‚ç‚¹ä¸Šè¿è¡Œã€‚å®ƒæ ¹æ®ä¸€ç³»åˆ—çš„è°ƒåº¦ç®—æ³•å’Œç­–ç•¥æ¥è¿›è¡Œå†³ç­–ã€‚</p><p>Controller-Managerã€controllerï¼šè¿è¡Œç€ä¸€ç³»åˆ—çš„æ§åˆ¶å™¨ï¼Œè¿™äº›æ§åˆ¶å™¨è´Ÿè´£ç»´æŠ¤é›†ç¾¤çš„çŠ¶æ€ã€‚Controller-Managerè´Ÿè´£å®¹å™¨æ•°é‡ã€‚controllerä¿è¯è¿è¡ŒçŠ¶æ€ã€‚</p><p>Kubeletï¼šè´Ÿè´£ä¸kube-apié€šä¿¡ï¼Œè·å–èŠ‚ç‚¹çš„Podsçš„ä¿¡æ¯,ç®¡ç†å…¶ç”Ÿå‘½å‘¨æœŸ,å¹¶æŒ‰ç…§Podçš„å®šä¹‰åˆ›å»ºã€å¯åœç›‘æ§å®¹å™¨çš„è¿è¡ŒçŠ¶æ€ç­‰ã€‚å¹¶å°†çŠ¶æ€ä¸ŠæŠ¥ç»™controllerã€‚</p><p>Kube-proxyï¼šä¸»è¦è´Ÿè´£å®ç°K8s Serviceçš„ç½‘ç»œä»£ç†åŠŸèƒ½.å®ƒåœ¨æ¯ä¸ªNodeèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œç»´æŠ¤ç½‘ç»œè§„åˆ™ï¼Œå°†å¯¹Serviceçš„è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„Podä¸Šã€‚</p><p>RunTimeï¼šè´Ÿè´£k8sä¸­çš„èµ„æºéš”ç¦»,ç¡®ä¿æ¯ä¸ªå®¹å™¨æœ‰ç‹¬ç«‹çš„ç½‘ç»œ,æ–‡ä»¶ç³»ç»Ÿ,è¿›ç¨‹ç©ºé—´ä»è€Œé¿å…ç›¸äº’å¹²æ‰°ã€‚</p><p>Podï¼šPodæ˜¯æœ€å°çš„å¯éƒ¨ç½²å’Œå¯ç®¡ç†çš„è®¡ç®—å•å…ƒã€‚å®¹å™¨åœ¨åŒä¸€ä¸»æœºä¸Šå¯ä»¥ç›¸äº’é€šä¿¡ã€‚å¤šä¸ªå®¹å™¨å°è£…æˆä¸€ä¸ªPodï¼Œä¸€èˆ¬ä¸€ä¸ªå®¹å™¨åªæ”¾ä¸€ä¸ªåº”ç”¨ï¼Œä¸ºäº†è®©æœåŠ¡é«˜å¯ç”¨ï¼Œéœ€è¦å¤šä¸ªå®¹å™¨ï¼Œæ»¡è¶³ä½¿ç”¨éœ€æ±‚ï¼Œæ‰€ä»¥ç”¨Pod</p><p>æ‰“åŒ…å¤šä¸ªå®¹å™¨ç»Ÿä¸€ç®¡ç†ã€‚</p><p>Containerï¼šç”¨äºå°†åº”ç”¨ç¨‹åºä»¥åŠæ‰€æœ‰ä¾èµ–æ‰“åŒ…åœ¨ä¸€èµ·,ç¡®ä¿æ‰€æœ‰ç¨‹åºè¿è¡Œç¯å¢ƒç›¸åŒã€‚</p><h3 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h3><h4 id="Namespace"><a href="#Namespace" class="headerlink" title="Namespace"></a>Namespace</h4><h5 id="å·¥ä½œè´Ÿè½½ç±»ï¼šè´Ÿè´£æ¥å—å®¢æˆ·è®¿é—®è¯·æ±‚ï¼Œè¿”å›å®¢æˆ·éœ€è¦çš„æ•°æ®"><a href="#å·¥ä½œè´Ÿè½½ç±»ï¼šè´Ÿè´£æ¥å—å®¢æˆ·è®¿é—®è¯·æ±‚ï¼Œè¿”å›å®¢æˆ·éœ€è¦çš„æ•°æ®" class="headerlink" title="å·¥ä½œè´Ÿè½½ç±»ï¼šè´Ÿè´£æ¥å—å®¢æˆ·è®¿é—®è¯·æ±‚ï¼Œè¿”å›å®¢æˆ·éœ€è¦çš„æ•°æ®"></a>å·¥ä½œè´Ÿè½½ç±»ï¼šè´Ÿè´£æ¥å—å®¢æˆ·è®¿é—®è¯·æ±‚ï¼Œè¿”å›å®¢æˆ·éœ€è¦çš„æ•°æ®</h5><p>Podã€Deploymentã€ReplicaSetã€StatefulSetã€DaemonSetã€Jobã€CronJob</p><h5 id="ç½‘ç»œç±»"><a href="#ç½‘ç»œç±»" class="headerlink" title="ç½‘ç»œç±»"></a>ç½‘ç»œç±»</h5><p>Serviceã€Ingressã€NetworkPolicy</p><h5 id="å‚¨å­˜ç±»"><a href="#å‚¨å­˜ç±»" class="headerlink" title="å‚¨å­˜ç±»"></a>å‚¨å­˜ç±»</h5><p>Volumeã€PersistentVolume (PV)ã€Persistent VolumeClaim (PVC)</p><h5 id="é…ç½®ç±»"><a href="#é…ç½®ç±»" class="headerlink" title="é…ç½®ç±»"></a>é…ç½®ç±»</h5><p>ConfigMapã€Secret</p><h5 id="å®‰å…¨ç±»"><a href="#å®‰å…¨ç±»" class="headerlink" title="å®‰å…¨ç±»"></a>å®‰å…¨ç±»</h5><h5 id="æ‰©å±•ç±»"><a href="#æ‰©å±•ç±»" class="headerlink" title="æ‰©å±•ç±»"></a>æ‰©å±•ç±»</h5><h5 id="è‡ªåŠ¨ç¼©æ‰©å®¹ç±»"><a href="#è‡ªåŠ¨ç¼©æ‰©å®¹ç±»" class="headerlink" title="è‡ªåŠ¨ç¼©æ‰©å®¹ç±»"></a>è‡ªåŠ¨ç¼©æ‰©å®¹ç±»</h5><h5 id="å±‚çº§å…³ç³»"><a href="#å±‚çº§å…³ç³»" class="headerlink" title="å±‚çº§å…³ç³»"></a>å±‚çº§å…³ç³»</h5><p><img src="/2025/07/14/docker/image-20250717203132808.png" alt="image-20250717203132808"></p><p>podï¼šæœ€å°çš„éƒ¨ç½²å•å…ƒï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚</p><p>Deploymentï¼šç®¡ç†Podçš„å‰¯æœ¬å’Œæ»šåŠ¨æ›´æ–°ç­–ç•¥ã€‚</p><p>replicaSetï¼šç¡®ä¿æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬è¿è¡Œï¼ˆDeploymentçš„åº•å±‚å®ç°ï¼‰ã€‚</p><p>DaemonSetï¼šç®¡ç†æœ‰çŠ¶æ€åº”ç”¨çš„Podï¼Œæä¾›æœ‰åºéƒ¨ç½²å’Œå”¯ä¸€ç½‘ç»œæ ‡è¯†ã€‚</p><p>StatefulSetï¼šç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œä¸€ä¸ªPodçš„å‰¯æœ¬ã€‚</p><p>Serviceï¼šä¸ºPodæä¾›ç¨³å®šçš„ç½‘ç»œè®¿é—®ï¼ˆå¦‚è´Ÿè½½å‡è¡¡ã€æœåŠ¡å‘ç°ï¼‰</p><p>Ingressï¼šç®¡ç†å¤–éƒ¨è®¿é—®é›†ç¾¤å†…æœåŠ¡çš„è·¯ç”±è§„åˆ™ï¼ˆå¦‚ HTTP&#x2F;HTTPS è·¯ç”±ï¼‰ã€‚</p><p>Secretï¼šå­˜å‚¨æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç ã€Tokenï¼‰ï¼Œä»¥ Base64 ç¼–ç å­˜å‚¨éæ•æ„Ÿçš„é…ç½®æ•°æ®ï¼ˆå¦‚ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ï¼‰ã€‚</p><p>Job&#x2F;CronJobï¼šè¿è¡Œä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œä»»åŠ¡å®Œæˆå Pod ç»ˆæ­¢å®šæ—¶è¿è¡Œçš„ Jobã€‚</p><p>PVï¼šé›†ç¾¤ä¸­çš„æŒä¹…åŒ–å­˜å‚¨èµ„æºã€‚</p><p>PVCï¼šç”¨æˆ·å¯¹å­˜å‚¨èµ„æºçš„è¯·æ±‚å£°æ˜ï¼Œç»‘å®šåˆ° PVã€‚</p><h2 id="kubernetes-é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹"><a href="#kubernetes-é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹" class="headerlink" title="kubernetes-é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹"></a>kubernetes-é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods <span class="comment"># æŸ¥çœ‹æ‰€æœ‰ Pod</span></span><br><span class="line"></span><br><span class="line">kubectl get deployments <span class="comment"># æŸ¥çœ‹æ‰€æœ‰ Deployment</span></span><br><span class="line"></span><br><span class="line">kubectl get services <span class="comment"># æŸ¥çœ‹æ‰€æœ‰ Service</span></span><br><span class="line"></span><br><span class="line">kubectl get pvc <span class="comment"># æŸ¥çœ‹æ‰€æœ‰ PVC</span></span><br><span class="line"></span><br><span class="line">kubectl get nodes <span class="comment"># æŸ¥çœ‹æ‰€æœ‰ Node</span></span><br><span class="line"></span><br><span class="line">kubectl get namespaces <span class="comment"># æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´</span></span><br><span class="line"></span><br><span class="line">kubectl get configmap &lt;name&gt; -o yaml <span class="comment"># æŸ¥çœ‹ ConfigMap å†…å®¹</span></span><br><span class="line"></span><br><span class="line">kubectl logs &lt;pod-name&gt;<span class="comment"># æŸ¥çœ‹ Pod æ—¥å¿—</span></span><br></pre></td></tr></table></figure><h2 id="kubernetes-èµ„æºåˆ›å»ºå‘½"><a href="#kubernetes-èµ„æºåˆ›å»ºå‘½" class="headerlink" title="kubernetes-èµ„æºåˆ›å»ºå‘½"></a>kubernetes-èµ„æºåˆ›å»ºå‘½</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1. åˆ›å»º Pod</span></span><br><span class="line">kubectl create deployment my-pod --image=nginx</span><br><span class="line"><span class="comment">#2. åˆ›å»º Deployment</span></span><br><span class="line">kubectl create deployment my-deployment --image=nginx --replicas=3</span><br><span class="line"><span class="comment">#3. åˆ›å»º Service</span></span><br><span class="line">kubectl create service clusterip my-service --tcp=80:8080</span><br><span class="line"><span class="comment">#4. åˆ›å»º ConfigMap</span></span><br><span class="line">kubectl create configmap my-config --from-literal=key1=value1 --from-literal=key2=value2</span><br><span class="line"><span class="comment">#5. åˆ›å»º Secret</span></span><br><span class="line">kubectl create secret generic my-secret --from-literal=username=admin --from-literal=password=secret</span><br><span class="line"><span class="comment">#6. åˆ›å»º Namespace</span></span><br><span class="line">kubectl create namespace my-namespace</span><br></pre></td></tr></table></figure><h2 id="kubernetes-Podä¿¡æ¯æŸ¥çœ‹"><a href="#kubernetes-Podä¿¡æ¯æŸ¥çœ‹" class="headerlink" title="kubernetes-Podä¿¡æ¯æŸ¥çœ‹"></a>kubernetes-Podä¿¡æ¯æŸ¥çœ‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. åˆ—å‡ºç‰¹å®šå‘½åç©ºé—´ä¸­çš„ podï¼š</span><br><span class="line">kubectl get pods -n &lt;namespace&gt;</span><br><span class="line">2. æŸ¥çœ‹ä¸€ä¸ª Pod è¯¦æƒ…ï¼š</span><br><span class="line">kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;</span><br><span class="line">3. æŸ¥çœ‹ Pod æ—¥å¿—ï¼š</span><br><span class="line">kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt;</span><br><span class="line">4. å°¾éƒ¨ Pod æ—¥å¿—ï¼š</span><br><span class="line">kubectl logs -f &lt;pod-name&gt; -n &lt;namespace&gt;</span><br><span class="line">5. åœ¨ pod ä¸­æ‰§è¡Œå‘½ä»¤ï¼š</span><br><span class="line">kubectl <span class="built_in">exec</span> -it &lt;pod-name&gt; -n &lt;namespace&gt; -- &lt;<span class="built_in">command</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="kubernetes-deploymenä¿¡æ¯"><a href="#kubernetes-deploymenä¿¡æ¯" class="headerlink" title="kubernetes-deploymenä¿¡æ¯"></a>kubernetes-deploymenä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. åˆ—å‡ºå‘½åç©ºé—´ä¸­çš„æ‰€æœ‰Deploymentï¼škubectl get deployments -n &lt;namespace&gt;</span><br><span class="line">2. æŸ¥çœ‹ä¸€ä¸ªDeploymentè¯¦æƒ…ï¼škubectl describe deployment &lt;deployment-name&gt; -n &lt;namespace&gt;</span><br><span class="line">3. æŸ¥çœ‹æ»šåŠ¨å‘å¸ƒçŠ¶æ€ï¼škubectl rollout status deployment/&lt;deployment-name&gt; -n &lt;namespace&gt;</span><br><span class="line">4. æŸ¥çœ‹æ»šåŠ¨å‘å¸ƒå†å²è®°å½•ï¼škubectl rollout <span class="built_in">history</span> deployment/&lt;deployment-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure><h2 id="kubernetes-labelæŒ‡ä»¤"><a href="#kubernetes-labelæŒ‡ä»¤" class="headerlink" title="kubernetes-labelæŒ‡ä»¤"></a>kubernetes-labelæŒ‡ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»™åä¸ºfooçš„Podæ·»åŠ label unhealthy=true</span></span><br><span class="line">$ kubectl label pods foo unhealthy=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™åä¸ºfooçš„Podä¿®æ”¹label ä¸º &#x27;status&#x27; value &#x27;unhealthy&#x27;ï¼Œä¸”è¦†ç›–ç°æœ‰çš„value</span></span><br><span class="line">$ kubectl label --overwrite pods foo status=unhealthy</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™ namespace ä¸­çš„æ‰€æœ‰ pod æ·»åŠ  label</span></span><br><span class="line">$ kubectl label  pods --all status=unhealthy</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»…å½“resource-version=1æ—¶æ‰æ›´æ–° åä¸ºfooçš„Podä¸Šçš„label</span></span><br><span class="line">$ kubectl label pods foo status=unhealthy --resource-version=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åä¸ºâ€œbarâ€çš„label ã€‚ï¼ˆä½¿ç”¨â€œ - â€å‡å·ç›¸è¿ï¼‰</span></span><br><span class="line">$ kubectl label pods foo bar-</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="kubernetes-åŸºç¡€æŒ‡ä»¤"><a href="#kubernetes-åŸºç¡€æŒ‡ä»¤" class="headerlink" title="kubernetes-åŸºç¡€æŒ‡ä»¤"></a>kubernetes-åŸºç¡€æŒ‡ä»¤</h2><p><strong>createï¼Œdeleteï¼Œgetï¼Œrunï¼Œexposeï¼Œsetï¼Œexplainï¼Œedit</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºDeploymentå’ŒServiceèµ„æº</span></span><br><span class="line">$ kubectl create -f demo-deployment.yaml</span><br><span class="line">$ kubectl create -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®yamlæ–‡ä»¶åˆ é™¤å¯¹åº”çš„èµ„æºï¼Œä½†æ˜¯yamlæ–‡ä»¶å¹¶ä¸ä¼šè¢«åˆ é™¤ï¼Œè¿™æ ·æ›´åŠ é«˜æ•ˆ</span></span><br><span class="line">$ kubectl delete -f demo-deployment.yaml </span><br><span class="line">$ kubectl delete -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥é€šè¿‡å…·ä½“çš„èµ„æºåç§°æ¥è¿›è¡Œåˆ é™¤ï¼Œä½¿ç”¨è¿™ä¸ªåˆ é™¤èµ„æºï¼ŒåŒæ—¶åˆ é™¤deploymentå’Œserviceèµ„æº</span></span><br><span class="line">$ kubectl delete å…·ä½“çš„èµ„æºåç§°</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="kubernetes-åŸºç¡€æŒ‡ä»¤-1"><a href="#kubernetes-åŸºç¡€æŒ‡ä»¤-1" class="headerlink" title="kubernetes-åŸºç¡€æŒ‡ä»¤"></a>kubernetes-åŸºç¡€æŒ‡ä»¤</h2><p><strong><a href="https://kubernetes.io/zh-cn/docs/reference/kubectl/quick-reference/">https://kubernetes.io/zh-cn/docs/reference/kubectl/quick-reference/</a></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºDeploymentå’ŒServiceèµ„æº</span></span><br><span class="line">$ kubectl create -f demo-deployment.yaml</span><br><span class="line">$ kubectl create -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®yamlæ–‡ä»¶åˆ é™¤å¯¹åº”çš„èµ„æºï¼Œä½†æ˜¯yamlæ–‡ä»¶å¹¶ä¸ä¼šè¢«åˆ é™¤ï¼Œè¿™æ ·æ›´åŠ é«˜æ•ˆ</span></span><br><span class="line">$ kubectl delete -f demo-deployment.yaml </span><br><span class="line">$ kubectl delete -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥é€šè¿‡å…·ä½“çš„èµ„æºåç§°æ¥è¿›è¡Œåˆ é™¤ï¼Œä½¿ç”¨è¿™ä¸ªåˆ é™¤èµ„æºï¼ŒåŒæ—¶åˆ é™¤deploymentå’Œserviceèµ„æº</span></span><br><span class="line">$ kubectl delete å…·ä½“çš„èµ„æºåç§°</span><br></pre></td></tr></table></figure><h1 id="Nginxåå‘ä»£ç†"><a href="#Nginxåå‘ä»£ç†" class="headerlink" title="Nginxåå‘ä»£ç†"></a>Nginxåå‘ä»£ç†</h1><h2 id="ä»£ç†æœåŠ¡å™¨"><a href="#ä»£ç†æœåŠ¡å™¨" class="headerlink" title="ä»£ç†æœåŠ¡å™¨"></a>ä»£ç†æœåŠ¡å™¨</h2><p><img src="/2025/07/14/docker/image-20250717203940718.png" alt="image-20250717203940718"></p><h3 id="ä»£ç†æœåŠ¡å™¨åŠŸèƒ½"><a href="#ä»£ç†æœåŠ¡å™¨åŠŸèƒ½" class="headerlink" title="ä»£ç†æœåŠ¡å™¨åŠŸèƒ½"></a>ä»£ç†æœåŠ¡å™¨åŠŸèƒ½</h3><p>1.éšè—å®¢æˆ·ç«¯èº«ä»½ï¼š æ­£å‘ä»£ç†å¯ä»¥éšè—å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€ï¼Œä¿æŠ¤å®¢æˆ·ç«¯çš„éšç§ã€‚</p><p>2.è®¿é—®æ§åˆ¶ï¼š æ­£å‘ä»£ç†å¯ä»¥æ ¹æ®ä¸€å®šçš„è§„åˆ™é™åˆ¶æˆ–å…è®¸å®¢æˆ·ç«¯çš„è®¿é—®è¯·æ±‚ï¼Œå®ç°è®¿é—®æ§åˆ¶åŠŸèƒ½ã€‚</p><p>3.ç¼“å­˜åŠ é€Ÿï¼š æ­£å‘ä»£ç†å¯ä»¥ç¼“å­˜ç»å¸¸è®¿é—®çš„é¡µé¢æˆ–èµ„æºï¼Œæé«˜è®¿é—®é€Ÿåº¦ï¼Œå‡è½»æœåŠ¡å™¨è´Ÿæ‹…ã€‚</p><h3 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>1.çªç ´ç½‘ç»œé™åˆ¶ </p><p>2.ç›‘æ§å’Œç®¡ç†å‘˜å·¥çš„ç½‘ç»œè®¿é—®è¡Œä¸º</p><p>3.éšè—å®¢æˆ·ç«¯çœŸå®IP</p><p>4.é˜²æ­¢æ•æ„Ÿæ•°æ®æ³„éœ²</p><p>5.å†…å®¹è¿‡æ»¤</p><p>6.æé«˜è®¿é—®é€Ÿåº¦</p><h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><p><img src="/2025/07/14/docker/image-20250717204042655.png" alt="image-20250717204042655"></p><h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><p>1.è´Ÿè½½å‡è¡¡ï¼š åå‘ä»£ç†å¯ä»¥æ ¹æ®åç«¯æœåŠ¡å™¨çš„è´Ÿè½½æƒ…å†µï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œæé«˜ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚</p><p>2.å®‰å…¨æ€§å¢å¼ºï¼šéšè—åç«¯æœåŠ¡å™¨çš„çœŸå®åœ°å€å’Œç«¯å£ï¼Œé˜²æ­¢ç›´æ¥æ”»å‡»ã€‚åŒæ—¶ï¼Œè¿˜å¯ä»¥å®ç°SSLåŠ å¯†ã€è®¿é—®æ§åˆ¶ç­‰å®‰å…¨åŠŸèƒ½ã€‚</p><p>3.ç¼“å­˜ä¼˜åŒ–ï¼šå¯ä»¥ç¼“å­˜é™æ€èµ„æºï¼Œå‡å°‘åç«¯æœåŠ¡å™¨çš„è´Ÿè½½ï¼Œæé«˜å“åº”é€Ÿåº¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hadoopé—®ç­”å°æµ‹éªŒ</title>
      <link href="/2025/07/07/hadoop%E9%97%AE%E7%AD%94%E5%B0%8F%E6%B5%8B%E9%AA%8C/"/>
      <url>/2025/07/07/hadoop%E9%97%AE%E7%AD%94%E5%B0%8F%E6%B5%8B%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="hadoopé—®ç­”å°æµ‹éªŒ"><a href="#hadoopé—®ç­”å°æµ‹éªŒ" class="headerlink" title="hadoopé—®ç­”å°æµ‹éªŒ"></a>hadoopé—®ç­”å°æµ‹éªŒ</h1><h2 id="1-hadoopç»„ä»¶æœ‰å“ªäº›-åˆ†åˆ«æœ‰ä»€ä¹ˆåŠŸèƒ½"><a href="#1-hadoopç»„ä»¶æœ‰å“ªäº›-åˆ†åˆ«æœ‰ä»€ä¹ˆåŠŸèƒ½" class="headerlink" title="1. hadoopç»„ä»¶æœ‰å“ªäº›?åˆ†åˆ«æœ‰ä»€ä¹ˆåŠŸèƒ½"></a>1. hadoopç»„ä»¶æœ‰å“ªäº›?åˆ†åˆ«æœ‰ä»€ä¹ˆåŠŸèƒ½</h2><h3 id="ä¸€ã€æ ¸å¿ƒç»„ä»¶"><a href="#ä¸€ã€æ ¸å¿ƒç»„ä»¶" class="headerlink" title="ä¸€ã€æ ¸å¿ƒç»„ä»¶"></a>ä¸€ã€æ ¸å¿ƒç»„ä»¶</h3><p>ç”±ä¸‰ä¸ªåŸºç¡€ç»„ä»¶æ„æˆï¼Œå®ƒä»¬æ˜¯æ•´ä¸ªæ¡†æ¶çš„åŸºçŸ³ï¼š</p><ol><li><p><strong>Hadoop Distributed File Systemï¼ˆHDFSï¼‰â€”â€” åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</strong></p><ul><li><strong>åŠŸèƒ½</strong>ï¼š<ul><li><p>ä¸“ä¸ºå­˜å‚¨æµ·é‡æ•°æ®è®¾è®¡çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå…·æœ‰é«˜å®¹é”™æ€§å’Œé«˜ååé‡ã€‚</p></li><li><p>å°†å¤§æ–‡ä»¶åˆ†å‰²æˆå›ºå®šå¤§å°çš„ â€œå—â€ï¼ˆé»˜è®¤ 128MBï¼‰ï¼Œåˆ†æ•£å­˜å‚¨åœ¨é›†ç¾¤çš„å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ¯ä¸ªå—ä¼šæœ‰å¤šä¸ªå‰¯æœ¬ï¼ˆé»˜è®¤ 3 ä¸ªï¼‰ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚<br>é€‚åˆå¤„ç† â€œä¸€æ¬¡å†™å…¥ã€å¤šæ¬¡è¯»å–â€ çš„åœºæ™¯ï¼Œä¸æ”¯æŒé¢‘ç¹çš„æ–‡ä»¶ä¿®æ”¹ï¼ˆæ›´é€‚åˆé™æ€æ•°æ®ï¼‰ã€‚</p></li></ul></li></ul></li><li><p><strong>MapReduceâ€”â€” åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶</strong></p><ul><li><strong>åŠŸèƒ½ï¼š</strong></li></ul></li></ol><p>â€‹åŸºäº â€œåˆ†è€Œæ²»ä¹‹â€ æ€æƒ³çš„ç¼–ç¨‹æ¨¡å‹ï¼Œç”¨äºå¹¶è¡Œå¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚</p><ul><li><strong>Map é˜¶æ®µ</strong>ï¼šå°†è¾“å…¥æ•°æ®åˆ†å‰²æˆå¤šä¸ªå­ä»»åŠ¡ï¼Œå¹¶è¡Œå¤„ç†åç”Ÿæˆä¸­é—´ç»“æœï¼ˆé”®å€¼å¯¹ï¼‰ã€‚</li><li><strong>Reduce é˜¶æ®µ</strong>ï¼šæ±‡æ€» Map é˜¶æ®µçš„ä¸­é—´ç»“æœï¼Œåˆå¹¶è®¡ç®—å¾—åˆ°æœ€ç»ˆè¾“å‡ºã€‚</li></ul><ol start="3"><li><strong>YARNï¼ˆYet Another Resource Negotiatorï¼‰â€”â€” èµ„æºç®¡ç†å™¨</strong></li></ol><ul><li><strong>åŠŸèƒ½ ï¼š</strong><br>è´Ÿè´£é›†ç¾¤èµ„æºï¼ˆCPUã€å†…å­˜ç­‰ï¼‰çš„ç»Ÿä¸€ç®¡ç†å’Œä»»åŠ¡è°ƒåº¦ï¼Œæ›¿ä»£äº†æ—©æœŸ Hadoop ä¸­çš„ JobTracker å’Œ TaskTrackerã€‚</li><li><strong>ResourceManager</strong>ï¼šå…¨å±€èµ„æºç®¡ç†å™¨ï¼Œåˆ†é…èµ„æºç»™åº”ç”¨ç¨‹åºã€‚</li><li><strong>NodeManager</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„èµ„æºç®¡ç†å™¨ï¼Œç›‘æ§èŠ‚ç‚¹èµ„æºä½¿ç”¨æƒ…å†µã€‚</li><li><strong>ApplicationMaster</strong>ï¼šä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºï¼ˆå¦‚ MapReduce ä»»åŠ¡ï¼‰ç”³è¯·èµ„æºå¹¶åè°ƒä»»åŠ¡æ‰§è¡Œã€‚</li></ul><h3 id="äºŒã€ç”Ÿæ€ç³»ç»Ÿç»„ä»¶"><a href="#äºŒã€ç”Ÿæ€ç³»ç»Ÿç»„ä»¶" class="headerlink" title="äºŒã€ç”Ÿæ€ç³»ç»Ÿç»„ä»¶"></a><strong>äºŒã€ç”Ÿæ€ç³»ç»Ÿç»„ä»¶</strong></h3><h4 id="1-Hiveâ€”â€”-æ•°æ®ä»“åº“å·¥å…·"><a href="#1-Hiveâ€”â€”-æ•°æ®ä»“åº“å·¥å…·" class="headerlink" title="1. Hiveâ€”â€” æ•°æ®ä»“åº“å·¥å…·"></a>1. <strong>Hiveâ€”â€” æ•°æ®ä»“åº“å·¥å…·</strong></h4><ul><li><p>åŠŸèƒ½ï¼š</p><p>æä¾›ç±» SQLï¼ˆHQLï¼‰æŸ¥è¯¢è¯­è¨€ï¼Œå°† SQL è¯­å¥è½¬æ¢ä¸º MapReduce ä»»åŠ¡ï¼Œæ–¹ä¾¿éç¨‹åºå‘˜å¤„ç†å¤§æ•°æ®ã€‚</p><ul><li>æ”¯æŒæ•°æ®å­˜å‚¨åœ¨ HDFS æˆ– HBase ä¸­ï¼Œé€‚åˆç¦»çº¿æ•°æ®åˆ†æå’ŒæŠ¥è¡¨ç”Ÿæˆã€‚</li><li>ç¼ºç‚¹ï¼šå»¶è¿Ÿè¾ƒé«˜ï¼Œä¸é€‚åˆå®æ—¶æŸ¥è¯¢ã€‚</li></ul></li></ul><h4 id="2-Sqoopâ€”â€”-æ•°æ®è¿ç§»å·¥å…·"><a href="#2-Sqoopâ€”â€”-æ•°æ®è¿ç§»å·¥å…·" class="headerlink" title="2. Sqoopâ€”â€” æ•°æ®è¿ç§»å·¥å…·"></a>2. <strong>Sqoopâ€”â€” æ•°æ®è¿ç§»å·¥å…·</strong></h4><ul><li><p>åŠŸèƒ½ ï¼š</p><p>åœ¨å…³ç³»å‹æ•°æ®åº“ï¼ˆå¦‚ MySQLã€Oracleï¼‰å’Œ Hadoop ç”Ÿæ€ï¼ˆHDFSã€Hiveã€HBaseï¼‰ä¹‹é—´è¿›è¡Œæ•°æ®åŒå‘è¿ç§»ã€‚</p><ul><li>åº•å±‚é€šè¿‡ MapReduce ä»»åŠ¡å®ç°é«˜æ•ˆå¹¶è¡Œä¼ è¾“ï¼Œé€‚åˆæ‰¹é‡æ•°æ®å¯¼å…¥ &#x2F; å¯¼å‡ºã€‚</li></ul></li></ul><h4 id="3-Sparkâ€”â€”-å¿«é€Ÿè®¡ç®—å¼•æ“ï¼ˆç”Ÿæ€å…³è”ç»„ä»¶ï¼‰"><a href="#3-Sparkâ€”â€”-å¿«é€Ÿè®¡ç®—å¼•æ“ï¼ˆç”Ÿæ€å…³è”ç»„ä»¶ï¼‰" class="headerlink" title="3. Sparkâ€”â€” å¿«é€Ÿè®¡ç®—å¼•æ“ï¼ˆç”Ÿæ€å…³è”ç»„ä»¶ï¼‰"></a>3. Sparkâ€”â€” å¿«é€Ÿè®¡ç®—å¼•æ“ï¼ˆç”Ÿæ€å…³è”ç»„ä»¶ï¼‰</h4><p>åŠŸèƒ½ï¼š<br>è™½ç„¶ä¸å±äº Hadoop æ ¸å¿ƒï¼Œä½†å¸¸ä¸ Hadoop é…åˆä½¿ç”¨ï¼Œæ˜¯åŸºäºå†…å­˜çš„åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ï¼Œæ¯” MapReduce å¿« 10-100 å€ã€‚<br>æ”¯æŒæ‰¹å¤„ç†ã€æµå¤„ç†ã€æœºå™¨å­¦ä¹ ç­‰ï¼Œå…¼å®¹ HDFSã€HBase ç­‰å­˜å‚¨ç³»ç»Ÿï¼Œå¯é€šè¿‡ YARN è°ƒåº¦èµ„æºã€‚</p><h2 id="2-åˆ†å¸ƒå¼å­˜å‚¨çš„ç»„ä»¶æ˜¯ä»€ä¹ˆ-æœ‰å“ªäº›è¿›ç¨‹-è¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ"><a href="#2-åˆ†å¸ƒå¼å­˜å‚¨çš„ç»„ä»¶æ˜¯ä»€ä¹ˆ-æœ‰å“ªäº›è¿›ç¨‹-è¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="2. åˆ†å¸ƒå¼å­˜å‚¨çš„ç»„ä»¶æ˜¯ä»€ä¹ˆ ?æœ‰å“ªäº›è¿›ç¨‹? è¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?"></a>2. åˆ†å¸ƒå¼å­˜å‚¨çš„ç»„ä»¶æ˜¯ä»€ä¹ˆ ?æœ‰å“ªäº›è¿›ç¨‹? è¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?</h2><p>åœ¨ Hadoop ç”Ÿæ€ä¸­ï¼Œåˆ†å¸ƒå¼å­˜å‚¨çš„æ ¸å¿ƒç»„ä»¶æ˜¯<strong>HDFSï¼ˆHadoop Distributed File Systemï¼‰</strong>ï¼Œå…¶æ¶æ„åŒ…å«å¤šä¸ªå…³é”®è¿›ç¨‹ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†ä»‹ç»ï¼š</p><h3 id="ä¸€ã€HDFS-æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹"><a href="#ä¸€ã€HDFS-æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹" class="headerlink" title="ä¸€ã€HDFS æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹"></a><strong>ä¸€ã€HDFS æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹</strong></h3><p>HDFS é‡‡ç”¨<strong>ä¸»ä»æ¶æ„ï¼ˆMaster-Slaveï¼‰</strong>ï¼Œä¸»è¦ç”±ä»¥ä¸‹è¿›ç¨‹ç»„æˆï¼š</p><h4 id="1-NameNodeï¼ˆä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"><a href="#1-NameNodeï¼ˆä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰" class="headerlink" title="1. NameNodeï¼ˆä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"></a>1. <strong>NameNodeï¼ˆä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>ä½œä¸º HDFS çš„ â€œå¤§è„‘â€ï¼Œç®¡ç†æ–‡ä»¶ç³»ç»Ÿçš„å‘½åç©ºé—´ï¼ˆæ–‡ä»¶ç›®å½•ç»“æ„ï¼‰å’Œå®¢æˆ·ç«¯å¯¹æ–‡ä»¶çš„è®¿é—®ã€‚</p><ul><li>ç»´æŠ¤æ–‡ä»¶å…ƒæ•°æ®ï¼ˆå¦‚æ–‡ä»¶åã€æƒé™ã€å—ä½ç½®æ˜ å°„ï¼‰ï¼Œä½†ä¸å­˜å‚¨å®é™…æ•°æ®ã€‚</li><li>å¤„ç†å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œå†³å®šæ•°æ®å—çš„å­˜å‚¨ä½ç½®ã€‚</li></ul></li><li><p><strong>ç‰¹ç‚¹</strong>ï¼š<br>å•ç‚¹æ•…éšœé£é™©ï¼ˆHDFS 2.0 å¼•å…¥äº† HA é«˜å¯ç”¨æ–¹æ¡ˆè§£å†³æ­¤é—®é¢˜ï¼‰ã€‚</p></li></ul><h4 id="2-DataNodeï¼ˆä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"><a href="#2-DataNodeï¼ˆä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰" class="headerlink" title="2. DataNodeï¼ˆä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"></a>2. <strong>DataNodeï¼ˆä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>è´Ÿè´£å®é™…æ•°æ®çš„å­˜å‚¨å’Œè¯»å†™æ“ä½œï¼Œåˆ†å¸ƒåœ¨é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p><ul><li>å°†æ•°æ®ä»¥ â€œå—â€ï¼ˆBlockï¼‰å½¢å¼å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ï¼Œé»˜è®¤æ¯ä¸ªå— 128MBï¼Œå¹¶ç»´æŠ¤å—çš„æ ¡éªŒå’Œã€‚</li><li>æ ¹æ® NameNode çš„æŒ‡ä»¤æ‰§è¡Œæ•°æ®å—çš„åˆ›å»ºã€åˆ é™¤å’Œå¤åˆ¶æ“ä½œã€‚</li></ul></li><li><p><strong>ä¸å®¢æˆ·ç«¯äº¤äº’</strong>ï¼š<br>ç›´æ¥å¤„ç†å®¢æˆ·ç«¯çš„æ•°æ®è¯»å†™è¯·æ±‚ï¼Œä¸ç»è¿‡ NameNodeï¼ˆå‡è½» NameNode è´Ÿæ‹…ï¼‰ã€‚</p></li></ul><h4 id="3-SecondaryNameNodeï¼ˆè¾…åŠ©åç§°èŠ‚ç‚¹è¿›ç¨‹ï¼‰"><a href="#3-SecondaryNameNodeï¼ˆè¾…åŠ©åç§°èŠ‚ç‚¹è¿›ç¨‹ï¼‰" class="headerlink" title="3. SecondaryNameNodeï¼ˆè¾…åŠ©åç§°èŠ‚ç‚¹è¿›ç¨‹ï¼‰"></a>3. <strong>SecondaryNameNodeï¼ˆè¾…åŠ©åç§°èŠ‚ç‚¹è¿›ç¨‹ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>å®šæœŸåˆå¹¶ NameNode çš„ç¼–è¾‘æ—¥å¿—ï¼ˆedits logï¼‰å’Œå‘½åç©ºé—´é•œåƒï¼ˆfsimageï¼‰ï¼Œè¾…åŠ© NameNode è¿›è¡Œå…ƒæ•°æ®ç®¡ç†ã€‚</p><ul><li>å¹¶é NameNode çš„çƒ­å¤‡ï¼Œè€Œæ˜¯å¸®åŠ©å‡å°‘ NameNode é‡å¯æ—¶çš„æ¢å¤æ—¶é—´ã€‚</li></ul></li><li><p><strong>å·¥ä½œæµç¨‹</strong>ï¼š<br>ä» NameNode è·å–æœ€æ–°çš„ fsimage å’Œ edits logï¼Œåˆå¹¶åè¿”å›ç»™ NameNodeã€‚</p></li></ul><h4 id="4-JournalNodeï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS-2-0-ï¼‰"><a href="#4-JournalNodeï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS-2-0-ï¼‰" class="headerlink" title="4. JournalNodeï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS 2.0+ï¼‰"></a>4. <strong>JournalNodeï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS 2.0+ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>åœ¨ HAï¼ˆé«˜å¯ç”¨ï¼‰æ¶æ„ä¸­ï¼Œå¤šä¸ª JournalNode ç»„æˆ Quorumï¼Œå­˜å‚¨ NameNode çš„ç¼–è¾‘æ—¥å¿—ï¼ˆeditsï¼‰ã€‚</p><ul><li>å½“ Active NameNode æ›´æ–°å…ƒæ•°æ®æ—¶ï¼Œä¼šåŒæ­¥å†™å…¥ JournalNode é›†ç¾¤ã€‚</li><li>Standby NameNode ä» JournalNode è¯»å–æ›´æ–°ï¼Œä¿æŒä¸ Active NameNode çš„çŠ¶æ€åŒæ­¥ã€‚</li></ul></li></ul><h4 id="5-ZKFailoverControllerï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS-2-0-ï¼‰"><a href="#5-ZKFailoverControllerï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS-2-0-ï¼‰" class="headerlink" title="5. ZKFailoverControllerï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS 2.0+ï¼‰"></a>5. <strong>ZKFailoverControllerï¼ˆé«˜å¯ç”¨è¿›ç¨‹ï¼ŒHDFS 2.0+ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>åŸºäº ZooKeeper å®ç° NameNode çš„è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆFailoverï¼‰ã€‚</p><ul><li>ç›‘æ§ NameNode çŠ¶æ€ï¼Œå½“ Active NameNode å¤±æ•ˆæ—¶ï¼Œè‡ªåŠ¨å°† Standby NameNode åˆ‡æ¢ä¸º Active çŠ¶æ€ã€‚</li></ul></li></ul><h3 id="äºŒã€HDFS-é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹"><a href="#äºŒã€HDFS-é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹" class="headerlink" title="äºŒã€HDFS é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹"></a><strong>äºŒã€HDFS é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹</strong></h3><p>ä¸ºé¿å…å•ç‚¹æ•…éšœï¼ŒHDFS 2.0 å¼•å…¥äº† HA æ–¹æ¡ˆï¼Œæ¶‰åŠä»¥ä¸‹é¢å¤–è¿›ç¨‹ï¼š</p><h4 id="1-Active-NameNode"><a href="#1-Active-NameNode" class="headerlink" title="1. Active NameNode"></a>1. <strong>Active NameNode</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„ä¸» NameNodeï¼Œè´Ÿè´£å®æ—¶æ›´æ–°å…ƒæ•°æ®ã€‚</li></ul><h4 id="2-Standby-NameNode"><a href="#2-Standby-NameNode" class="headerlink" title="2. Standby NameNode"></a>2. <strong>Standby NameNode</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>ä½œä¸º Active NameNode çš„çƒ­å¤‡ï¼Œé€šè¿‡ JournalNode åŒæ­¥å…ƒæ•°æ®ï¼Œç¡®ä¿åœ¨ Active æ•…éšœæ—¶èƒ½å¿«é€Ÿæ¥ç®¡ã€‚</li></ul><h4 id="3-ZooKeeper-é›†ç¾¤"><a href="#3-ZooKeeper-é›†ç¾¤" class="headerlink" title="3. ZooKeeper é›†ç¾¤"></a>3. <strong>ZooKeeper é›†ç¾¤</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>åè°ƒ Active å’Œ Standby NameNode çš„çŠ¶æ€ï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ª Active NameNodeã€‚</li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><p>HDFS çš„æ ¸å¿ƒè¿›ç¨‹é€šè¿‡åˆ†å·¥åä½œï¼Œå®ç°äº†å¤§è§„æ¨¡æ•°æ®çš„å¯é å­˜å‚¨å’Œé«˜æ•ˆè®¿é—®ï¼š</p><ul><li><strong>NameNode</strong>ï¼šç®¡ç†å…ƒæ•°æ®ï¼Œåè°ƒè¯»å†™è¯·æ±‚ã€‚</li><li><strong>DataNode</strong>ï¼šå­˜å‚¨å®é™…æ•°æ®å—ï¼Œæ‰§è¡Œæ•°æ®è¯»å†™ã€‚</li><li><strong>SecondaryNameNode</strong>ï¼šè¾…åŠ©å…ƒæ•°æ®ç®¡ç†ã€‚</li><li><strong>JournalNode&#x2F;ZKFC</strong>ï¼šä¿éšœé«˜å¯ç”¨æ€§ã€‚</li></ul><p>ç†è§£è¿™äº›è¿›ç¨‹çš„è§’è‰²å’Œäº¤äº’ï¼Œæ˜¯ä¼˜åŒ– HDFS æ€§èƒ½å’Œæ’æŸ¥æ•…éšœçš„å…³é”®ã€‚</p><h2 id="3-èµ„æºè°ƒåº¦ä½¿ç”¨ä»€ä¹ˆç»„ä»¶-è¯¥ç»„ä»¶æœ‰å“ªäº›è¿›ç¨‹-æ¯ä¸ªè¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ"><a href="#3-èµ„æºè°ƒåº¦ä½¿ç”¨ä»€ä¹ˆç»„ä»¶-è¯¥ç»„ä»¶æœ‰å“ªäº›è¿›ç¨‹-æ¯ä¸ªè¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="3. èµ„æºè°ƒåº¦ä½¿ç”¨ä»€ä¹ˆç»„ä»¶? è¯¥ç»„ä»¶æœ‰å“ªäº›è¿›ç¨‹?æ¯ä¸ªè¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?"></a>3. èµ„æºè°ƒåº¦ä½¿ç”¨ä»€ä¹ˆç»„ä»¶? è¯¥ç»„ä»¶æœ‰å“ªäº›è¿›ç¨‹?æ¯ä¸ªè¿›ç¨‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?</h2><p>åœ¨ Hadoop ç”Ÿæ€ä¸­ï¼Œèµ„æºè°ƒåº¦ä¸»è¦ç”± <strong>YARNï¼ˆYet Another Resource Negotiatorï¼‰</strong> ç»„ä»¶è´Ÿè´£ã€‚å®ƒæ˜¯ Hadoop 2.0 å¼•å…¥çš„èµ„æºç®¡ç†ç³»ç»Ÿï¼Œæ›¿ä»£äº†æ—©æœŸ MapReduce çš„ JobTracker&#x2F;Tracker æ¶æ„ï¼Œå®ç°äº†è®¡ç®—èµ„æºçš„ç»Ÿä¸€ç®¡ç†å’Œå¤šæ¡†æ¶å…±äº«ã€‚</p><h3 id="ä¸€ã€YARN-çš„æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹"><a href="#ä¸€ã€YARN-çš„æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹" class="headerlink" title="ä¸€ã€YARN çš„æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹"></a><strong>ä¸€ã€YARN çš„æ ¸å¿ƒç»„ä»¶ä¸è¿›ç¨‹</strong></h3><p>YARN é‡‡ç”¨ <strong>ä¸»ä»æ¶æ„ï¼ˆMaster-Slaveï¼‰</strong>ï¼Œä¸»è¦ç”±ä»¥ä¸‹è¿›ç¨‹ç»„æˆï¼š</p><h4 id="1-ResourceManagerï¼ˆRMï¼Œä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"><a href="#1-ResourceManagerï¼ˆRMï¼Œä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰" class="headerlink" title="1. ResourceManagerï¼ˆRMï¼Œä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"></a>1. <strong>ResourceManagerï¼ˆRMï¼Œä¸»èŠ‚ç‚¹è¿›ç¨‹ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>ä½œä¸ºå…¨å±€èµ„æºç®¡ç†å™¨ï¼Œè´Ÿè´£æ•´ä¸ªé›†ç¾¤çš„èµ„æºåˆ†é…å’Œè°ƒåº¦ã€‚</p><ul><li>æ¥æ”¶æ¥è‡ªå„ä¸ª <strong>ApplicationMaster</strong> çš„èµ„æºè¯·æ±‚ã€‚</li><li>æ ¹æ®é›†ç¾¤èµ„æºä½¿ç”¨æƒ…å†µå’Œé¢„è®¾çš„è°ƒåº¦ç­–ç•¥ï¼ˆå¦‚å®¹é‡è°ƒåº¦ã€å…¬å¹³è°ƒåº¦ï¼‰ï¼Œå°†èµ„æºåˆ†é…ç»™åº”ç”¨ç¨‹åºã€‚</li><li>ç›‘æ§ NodeManager çš„å¥åº·çŠ¶æ€ï¼Œå¤„ç†èŠ‚ç‚¹æ•…éšœã€‚</li></ul></li><li><p>å†…éƒ¨ç»„ä»¶ï¼š</p><ul><li><strong>Scheduler</strong>ï¼šçº¯è°ƒåº¦å™¨ï¼Œè´Ÿè´£åˆ†é…èµ„æºï¼Œä¸å‚ä¸åº”ç”¨ç¨‹åºç›‘æ§å’ŒçŠ¶æ€ç®¡ç†ã€‚</li><li><strong>ApplicationsManager</strong>ï¼šç®¡ç†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¥æ”¶æ–°åº”ç”¨çš„æäº¤è¯·æ±‚ã€‚</li></ul></li></ul><h4 id="2-NodeManagerï¼ˆNMï¼Œä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"><a href="#2-NodeManagerï¼ˆNMï¼Œä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰" class="headerlink" title="2. NodeManagerï¼ˆNMï¼Œä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰"></a>2. <strong>NodeManagerï¼ˆNMï¼Œä»èŠ‚ç‚¹è¿›ç¨‹ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>è¿è¡Œåœ¨æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šï¼Œè´Ÿè´£æœ¬åœ°èµ„æºç®¡ç†å’Œå®¹å™¨ç›‘æ§ã€‚</p><ul><li>å¯åŠ¨å’Œç›‘æ§ <strong>Container</strong>ï¼ˆèµ„æºéš”ç¦»å•å…ƒï¼Œå°è£… CPUã€å†…å­˜ç­‰èµ„æºï¼‰ã€‚</li><li>å‘ ResourceManager æ±‡æŠ¥èŠ‚ç‚¹èµ„æºä½¿ç”¨æƒ…å†µå’Œå®¹å™¨çŠ¶æ€ã€‚</li><li>æ ¹æ® ResourceManager çš„æŒ‡ä»¤ï¼Œå¯åŠ¨æˆ–åœæ­¢ Containerã€‚</li></ul></li></ul><h4 id="3-ApplicationMasterï¼ˆAMï¼Œæ¯ä¸ªåº”ç”¨ç‹¬æœ‰çš„è¿›ç¨‹ï¼‰"><a href="#3-ApplicationMasterï¼ˆAMï¼Œæ¯ä¸ªåº”ç”¨ç‹¬æœ‰çš„è¿›ç¨‹ï¼‰" class="headerlink" title="3. ApplicationMasterï¼ˆAMï¼Œæ¯ä¸ªåº”ç”¨ç‹¬æœ‰çš„è¿›ç¨‹ï¼‰"></a>3. <strong>ApplicationMasterï¼ˆAMï¼Œæ¯ä¸ªåº”ç”¨ç‹¬æœ‰çš„è¿›ç¨‹ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>æ¯ä¸ªåº”ç”¨ç¨‹åºï¼ˆå¦‚ MapReduce ä½œä¸šã€Spark ä»»åŠ¡ï¼‰å¯åŠ¨æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ª AMï¼Œè´Ÿè´£è¯¥åº”ç”¨çš„èµ„æºç”³è¯·å’Œä»»åŠ¡åè°ƒã€‚</p><ul><li>å‘ ResourceManager æ³¨å†Œå¹¶è¯·æ±‚èµ„æºï¼ˆContainerï¼‰ã€‚</li><li>ä¸ NodeManager é€šä¿¡ï¼Œå¯åŠ¨å’Œç›‘æ§ä»»åŠ¡å®¹å™¨ã€‚</li><li>è·Ÿè¸ªåº”ç”¨ç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€ï¼Œå‘ ResourceManager æ±‡æŠ¥è¿›åº¦ã€‚</li></ul></li><li><p><strong>ç¤ºä¾‹</strong>ï¼š<br>MapReduce ä½œä¸šçš„ AM è´Ÿè´£å°†ä»»åŠ¡æ‹†åˆ†ä¸º Map å’Œ Reduce ä»»åŠ¡ï¼Œå¹¶åˆ†é…åˆ°åˆé€‚çš„èŠ‚ç‚¹æ‰§è¡Œã€‚</p></li></ul><h4 id="4-Containerï¼ˆèµ„æºå®¹å™¨ï¼‰"><a href="#4-Containerï¼ˆèµ„æºå®¹å™¨ï¼‰" class="headerlink" title="4. Containerï¼ˆèµ„æºå®¹å™¨ï¼‰"></a>4. <strong>Containerï¼ˆèµ„æºå®¹å™¨ï¼‰</strong></h4><ul><li><p>ä½œç”¨ï¼š</p><p>æ˜¯ YARN ä¸­çš„èµ„æºéš”ç¦»å•å…ƒï¼Œç”± NodeManager ç®¡ç†ï¼Œè¿è¡Œå…·ä½“çš„ä»»åŠ¡ï¼ˆå¦‚ Map&#x2F;Reduce ä»»åŠ¡ï¼‰ã€‚</p><ul><li>æ¯ä¸ª Container æœ‰ä¸¥æ ¼çš„èµ„æºé™åˆ¶ï¼ˆCPUã€å†…å­˜ï¼‰ï¼Œé€šè¿‡ Linux cgroups å®ç°éš”ç¦»ã€‚</li><li>ä»»åŠ¡å®Œæˆåï¼ŒContainer è¢« NodeManager å›æ”¶ã€‚</li></ul></li></ul><h3 id="äºŒã€YARN-çš„è°ƒåº¦å™¨ç±»å‹"><a href="#äºŒã€YARN-çš„è°ƒåº¦å™¨ç±»å‹" class="headerlink" title="äºŒã€YARN çš„è°ƒåº¦å™¨ç±»å‹"></a><strong>äºŒã€YARN çš„è°ƒåº¦å™¨ç±»å‹</strong></h3><p>ResourceManager çš„ <strong>Scheduler</strong> æ”¯æŒå¤šç§è°ƒåº¦ç­–ç•¥ï¼Œå¸¸è§çš„æœ‰ï¼š</p><h4 id="1-å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity-Schedulerï¼‰"><a href="#1-å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity-Schedulerï¼‰" class="headerlink" title="1. å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity Schedulerï¼‰"></a>1. <strong>å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity Schedulerï¼‰</strong></h4><ul><li><strong>ç‰¹ç‚¹</strong>ï¼š<br>å°†é›†ç¾¤èµ„æºåˆ’åˆ†ä¸ºå¤šä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—æœ‰å›ºå®šçš„èµ„æºä¸Šé™ï¼Œæ”¯æŒå±‚çº§é˜Ÿåˆ—å’Œèµ„æºå…±äº«ã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼š<br>å¤šç§Ÿæˆ·ç¯å¢ƒï¼Œä¸åŒéƒ¨é—¨ &#x2F; ç”¨æˆ·å…±äº«é›†ç¾¤ï¼Œä¿è¯æ¯ä¸ªé˜Ÿåˆ—è‡³å°‘è·å¾—ä¸€å®šèµ„æºã€‚</li></ul><h4 id="2-å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair-Schedulerï¼‰"><a href="#2-å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair-Schedulerï¼‰" class="headerlink" title="2. å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair Schedulerï¼‰"></a>2. <strong>å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair Schedulerï¼‰</strong></h4><ul><li><strong>ç‰¹ç‚¹</strong>ï¼š<br>åŠ¨æ€å¹³è¡¡èµ„æºåˆ†é…ï¼Œä¼˜å…ˆä¸ºèµ„æºä¸è¶³çš„åº”ç”¨åˆ†é…èµ„æºï¼Œå®ç° â€œå…¬å¹³â€ å…±äº«ã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼š<br>äº¤äº’å¼ä½œä¸šä¸æ‰¹å¤„ç†ä½œä¸šå…±å­˜çš„åœºæ™¯ï¼Œé¿å…å¤§ä½œä¸šé•¿æ—¶é—´å ç”¨èµ„æºã€‚</li></ul><h4 id="3-å±‚æ¬¡è°ƒåº¦å™¨ï¼ˆHierarchical-Schedulerï¼‰"><a href="#3-å±‚æ¬¡è°ƒåº¦å™¨ï¼ˆHierarchical-Schedulerï¼‰" class="headerlink" title="3. å±‚æ¬¡è°ƒåº¦å™¨ï¼ˆHierarchical Schedulerï¼‰"></a>3. <strong>å±‚æ¬¡è°ƒåº¦å™¨ï¼ˆHierarchical Schedulerï¼‰</strong></h4><ul><li><strong>ç‰¹ç‚¹</strong>ï¼š<br>ç»“åˆå®¹é‡è°ƒåº¦å’Œå…¬å¹³è°ƒåº¦çš„ä¼˜åŠ¿ï¼Œæ”¯æŒå¤šçº§é˜Ÿåˆ—å’Œèµ„æºç»§æ‰¿ã€‚</li></ul><h3 id="ä¸‰ã€YARN-é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹"><a href="#ä¸‰ã€YARN-é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹" class="headerlink" title="ä¸‰ã€YARN é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹"></a><strong>ä¸‰ã€YARN é«˜å¯ç”¨ï¼ˆHAï¼‰æ¶æ„è¿›ç¨‹</strong></h3><p>ä¸ºé¿å…å•ç‚¹æ•…éšœï¼ŒYARN æ”¯æŒ ResourceManager çš„ HA éƒ¨ç½²ï¼Œæ¶‰åŠä»¥ä¸‹è¿›ç¨‹ï¼š</p><h4 id="1-Active-ResourceManager"><a href="#1-Active-ResourceManager" class="headerlink" title="1. Active ResourceManager"></a>1. <strong>Active ResourceManager</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„ä¸» RMï¼Œè´Ÿè´£å®æ—¶èµ„æºè°ƒåº¦ã€‚</li></ul><h4 id="2-Standby-ResourceManager"><a href="#2-Standby-ResourceManager" class="headerlink" title="2. Standby ResourceManager"></a>2. <strong>Standby ResourceManager</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>ä½œä¸ºçƒ­å¤‡ï¼ŒåŒæ­¥ Active RM çš„çŠ¶æ€ï¼Œåœ¨ä¸»èŠ‚ç‚¹æ•…éšœæ—¶è‡ªåŠ¨æ¥ç®¡ã€‚</li></ul><h4 id="3-ZooKeeper-é›†ç¾¤-1"><a href="#3-ZooKeeper-é›†ç¾¤-1" class="headerlink" title="3. ZooKeeper é›†ç¾¤"></a>3. <strong>ZooKeeper é›†ç¾¤</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>åè°ƒ Active å’Œ Standby RM çš„çŠ¶æ€ï¼Œç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ª Active RMã€‚</li></ul><h4 id="4-ZKFCï¼ˆZooKeeper-Failover-Controllerï¼‰"><a href="#4-ZKFCï¼ˆZooKeeper-Failover-Controllerï¼‰" class="headerlink" title="4. ZKFCï¼ˆZooKeeper Failover Controllerï¼‰"></a>4. <strong>ZKFCï¼ˆZooKeeper Failover Controllerï¼‰</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼š<br>ç›‘æ§ RM çŠ¶æ€ï¼ŒåŸºäº ZooKeeper å®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚</li></ul><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><p>YARN é€šè¿‡åˆ†ç¦»èµ„æºç®¡ç†å’Œä½œä¸šè°ƒåº¦ï¼Œå®ç°äº†é›†ç¾¤èµ„æºçš„é«˜æ•ˆåˆ©ç”¨å’Œå¤šæ¡†æ¶åä½œï¼š</p><ul><li><strong>ResourceManager</strong>ï¼šå…¨å±€èµ„æºè°ƒåº¦ï¼Œè´Ÿè´£èµ„æºåˆ†é…ã€‚</li><li><strong>NodeManager</strong>ï¼šèŠ‚ç‚¹èµ„æºç®¡ç†ï¼Œè¿è¡Œå®¹å™¨ã€‚</li><li><strong>ApplicationMaster</strong>ï¼šåº”ç”¨ç¨‹åºçš„èµ„æºåè°ƒè€…ã€‚</li><li><strong>Container</strong>ï¼šèµ„æºéš”ç¦»çš„åŸºæœ¬å•ä½ã€‚</li></ul><p>ç†è§£ YARN çš„æ¶æ„å’Œè°ƒåº¦æœºåˆ¶ï¼Œæœ‰åŠ©äºä¼˜åŒ–é›†ç¾¤èµ„æºåˆ©ç”¨ç‡ï¼Œæå‡å¤§æ•°æ®ä½œä¸šçš„æ‰§è¡Œæ•ˆç‡ã€‚</p><h2 id="4-åˆ†å¸ƒå¼è®¡ç®—åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤-shuffleæœ‰å‡ ä¸ªæ­¥éª¤"><a href="#4-åˆ†å¸ƒå¼è®¡ç®—åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤-shuffleæœ‰å‡ ä¸ªæ­¥éª¤" class="headerlink" title="4. åˆ†å¸ƒå¼è®¡ç®—åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤? shuffleæœ‰å‡ ä¸ªæ­¥éª¤?"></a>4. åˆ†å¸ƒå¼è®¡ç®—åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤? shuffleæœ‰å‡ ä¸ªæ­¥éª¤?</h2><h3 id="ä¸€ã€åˆ†å¸ƒå¼è®¡ç®—çš„å…¸å‹æ­¥éª¤ï¼ˆä»¥-MapReduce-ä¸ºä¾‹ï¼‰"><a href="#ä¸€ã€åˆ†å¸ƒå¼è®¡ç®—çš„å…¸å‹æ­¥éª¤ï¼ˆä»¥-MapReduce-ä¸ºä¾‹ï¼‰" class="headerlink" title="ä¸€ã€åˆ†å¸ƒå¼è®¡ç®—çš„å…¸å‹æ­¥éª¤ï¼ˆä»¥ MapReduce ä¸ºä¾‹ï¼‰"></a>ä¸€ã€åˆ†å¸ƒå¼è®¡ç®—çš„å…¸å‹æ­¥éª¤ï¼ˆä»¥ MapReduce ä¸ºä¾‹ï¼‰</h3><p>åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ï¼ˆå¦‚ MapReduceã€Sparkï¼‰é€šå¸¸å°†å¤§è§„æ¨¡æ•°æ®å¤„ç†ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªé˜¶æ®µï¼Œä»¥å®ç°å¹¶è¡ŒåŒ–å’Œå®¹é”™æ€§ã€‚ä»¥ä¸‹æ˜¯å…¸å‹çš„åˆ†å¸ƒå¼è®¡ç®—æµç¨‹ï¼š</p><h4 id="1-æ•°æ®åˆ†ç‰‡ï¼ˆData-Splittingï¼‰"><a href="#1-æ•°æ®åˆ†ç‰‡ï¼ˆData-Splittingï¼‰" class="headerlink" title="1. æ•°æ®åˆ†ç‰‡ï¼ˆData Splittingï¼‰"></a>1. <strong>æ•°æ®åˆ†ç‰‡ï¼ˆData Splittingï¼‰</strong></h4><ul><li>å°†è¾“å…¥æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªå°å—ï¼ˆå¦‚ HDFS ä¸­çš„ Blockï¼‰ï¼Œæ¯ä¸ªåˆ†ç‰‡ç”±ä¸€ä¸ª Map ä»»åŠ¡å¤„ç†ã€‚</li><li><strong>ç›®çš„</strong>ï¼šå®ç°æ•°æ®çš„å¹¶è¡Œå¤„ç†ã€‚</li></ul><h4 id="2-Map-é˜¶æ®µ"><a href="#2-Map-é˜¶æ®µ" class="headerlink" title="2. Map é˜¶æ®µ"></a>2. <strong>Map é˜¶æ®µ</strong></h4><ul><li>æ¯ä¸ª Map ä»»åŠ¡å¤„ç†ä¸€ä¸ªæ•°æ®åˆ†ç‰‡ï¼Œæ‰§è¡Œç”¨æˆ·å®šä¹‰çš„æ˜ å°„å‡½æ•°ï¼ˆå¦‚æå–ã€è½¬æ¢æ•°æ®ï¼‰ã€‚</li><li><strong>è¾“å‡º</strong>ï¼šä¸­é—´é”®å€¼å¯¹ï¼ˆKey-Valueï¼‰ã€‚</li></ul><h4 id="3-Shuffle-é˜¶æ®µ"><a href="#3-Shuffle-é˜¶æ®µ" class="headerlink" title="3. Shuffle é˜¶æ®µ"></a>3. <strong>Shuffle é˜¶æ®µ</strong></h4><ul><li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šå°† Map è¾“å‡ºçš„ä¸­é—´ç»“æœæŒ‰ Key åˆ†ç»„ï¼Œå¹¶åˆ†å‘åˆ°å¯¹åº”çš„ Reduce ä»»åŠ¡ã€‚</li><li><strong>å…³é”®æ­¥éª¤</strong>ï¼ˆè§ä¸‹æ–‡è¯¦ç»†æ‹†è§£ï¼‰ã€‚</li></ul><h4 id="4-Reduce-é˜¶æ®µ"><a href="#4-Reduce-é˜¶æ®µ" class="headerlink" title="4. Reduce é˜¶æ®µ"></a>4. <strong>Reduce é˜¶æ®µ</strong></h4><ul><li>æ¯ä¸ª Reduce ä»»åŠ¡å¤„ç†ä¸€ç»„å…·æœ‰ç›¸åŒ Key çš„æ•°æ®ï¼Œæ‰§è¡Œèšåˆæˆ–è®¡ç®—é€»è¾‘ã€‚</li><li><strong>è¾“å‡º</strong>ï¼šæœ€ç»ˆç»“æœæ•°æ®ã€‚</li></ul><h4 id="5-ç»“æœåˆå¹¶ä¸å­˜å‚¨"><a href="#5-ç»“æœåˆå¹¶ä¸å­˜å‚¨" class="headerlink" title="5. ç»“æœåˆå¹¶ä¸å­˜å‚¨"></a>5. <strong>ç»“æœåˆå¹¶ä¸å­˜å‚¨</strong></h4><ul><li>å°†æ‰€æœ‰ Reduce ä»»åŠ¡çš„è¾“å‡ºåˆå¹¶ï¼ˆå¯é€‰ï¼‰ï¼Œå­˜å‚¨åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ HDFSï¼‰æˆ–å…¶ä»–å­˜å‚¨ä»‹è´¨ã€‚</li></ul><h3 id="äºŒã€Shuffle-é˜¶æ®µçš„è¯¦ç»†æ­¥éª¤ï¼ˆä»¥-MapReduce-ä¸ºä¾‹ï¼‰"><a href="#äºŒã€Shuffle-é˜¶æ®µçš„è¯¦ç»†æ­¥éª¤ï¼ˆä»¥-MapReduce-ä¸ºä¾‹ï¼‰" class="headerlink" title="äºŒã€Shuffle é˜¶æ®µçš„è¯¦ç»†æ­¥éª¤ï¼ˆä»¥ MapReduce ä¸ºä¾‹ï¼‰"></a>äºŒã€Shuffle é˜¶æ®µçš„è¯¦ç»†æ­¥éª¤ï¼ˆä»¥ MapReduce ä¸ºä¾‹ï¼‰</h3><p>Shuffle æ˜¯åˆ†å¸ƒå¼è®¡ç®—ä¸­æœ€å…³é”®ä¸”å¤æ‚çš„ç¯èŠ‚ï¼Œè´Ÿè´£æ•°æ®çš„é‡ç»„å’Œåˆ†å‘ã€‚åœ¨ MapReduce ä¸­ï¼ŒShuffle åˆ†ä¸º Map ç«¯å’Œ Reduce ç«¯ä¸¤éƒ¨åˆ†ï¼Œå…±åŒ…å« 6 ä¸ªæ ¸å¿ƒæ­¥éª¤ï¼š</p><h4 id="Map-ç«¯çš„-Shuffle-æ­¥éª¤"><a href="#Map-ç«¯çš„-Shuffle-æ­¥éª¤" class="headerlink" title="Map ç«¯çš„ Shuffle æ­¥éª¤"></a><strong>Map ç«¯çš„ Shuffle æ­¥éª¤</strong></h4><ol><li><strong>Map è¾“å‡ºå†™å…¥å†…å­˜ç¼“å†²åŒº</strong><ul><li>Map ä»»åŠ¡çš„è¾“å‡ºé¦–å…ˆå†™å…¥å†…å­˜ä¸­çš„ç¯å½¢ç¼“å†²åŒºï¼ˆé»˜è®¤ 100MBï¼‰ã€‚</li><li>ç¼“å†²åŒºåŒæ—¶å­˜å‚¨æ•°æ®å’Œå…ƒæ•°æ®ï¼ˆè®°å½• Key çš„åˆ†åŒºä¿¡æ¯ã€åç§»é‡ç­‰ï¼‰ã€‚</li></ul></li><li><strong>æº¢å†™ï¼ˆSpillï¼‰åˆ°ç£ç›˜</strong><ul><li>å½“ç¼“å†²åŒºä½¿ç”¨ç‡è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ 80%ï¼‰æ—¶ï¼Œè§¦å‘æº¢å†™çº¿ç¨‹å°†æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜ã€‚</li><li><strong>æ’åº</strong>ï¼šåœ¨æº¢å†™å‰ï¼Œæ•°æ®æŒ‰ Key çš„å“ˆå¸Œå€¼è¿›è¡Œåˆ†åŒºï¼ˆPartitionï¼‰ï¼Œå¹¶å¯¹æ¯ä¸ªåˆ†åŒºå†…çš„ Key è¿›è¡Œæ’åºï¼ˆå¦‚å¿«é€Ÿæ’åºï¼‰ã€‚</li><li><strong>åˆå¹¶</strong>ï¼šå¦‚æœé…ç½®äº† Combinerï¼ˆæœ¬åœ°èšåˆå‡½æ•°ï¼‰ï¼Œä¼šåœ¨æº¢å†™å‰å¯¹ç›¸åŒ Key çš„å€¼è¿›è¡Œé¢„èšåˆã€‚</li></ul></li><li><strong>ç£ç›˜æ–‡ä»¶åˆå¹¶</strong><ul><li>å¤šä¸ªæº¢å†™æ–‡ä»¶ï¼ˆSpill Fileï¼‰æœ€ç»ˆåˆå¹¶ä¸ºä¸€ä¸ªæ›´å¤§çš„åˆ†åŒºæ’åºæ–‡ä»¶ï¼ˆPartitioned &amp; Sorted Fileï¼‰ã€‚</li><li>åˆå¹¶è¿‡ç¨‹ä¸­ä¼šä¿ç•™åˆ†åŒºå’Œæ’åºå±æ€§ï¼Œå‡å°‘ Reduce ç«¯çš„å¤„ç†è´Ÿæ‹…ã€‚</li></ul></li></ol><h4 id="Reduce-ç«¯çš„-Shuffle-æ­¥éª¤"><a href="#Reduce-ç«¯çš„-Shuffle-æ­¥éª¤" class="headerlink" title="Reduce ç«¯çš„ Shuffle æ­¥éª¤"></a><strong>Reduce ç«¯çš„ Shuffle æ­¥éª¤</strong></h4><ol><li><strong>è¿œç¨‹æ•°æ®æ‹‰å–ï¼ˆFetchï¼‰</strong><ul><li>Reduce ä»»åŠ¡å¯åŠ¨åï¼Œé€šè¿‡ HTTP ä»æ‰€æœ‰ Map ä»»åŠ¡çš„è¾“å‡ºæ–‡ä»¶ä¸­æ‹‰å–å±äºè‡ªå·±åˆ†åŒºçš„æ•°æ®ã€‚</li><li><strong>å¹¶è¡Œæ‹‰å–</strong>ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ä»ä¸åŒ Map èŠ‚ç‚¹è·å–æ•°æ®ï¼Œæé«˜æ•ˆç‡ã€‚</li></ul></li><li><strong>å†…å­˜ä¸ç£ç›˜æ•°æ®åˆå¹¶</strong><ul><li>æ‹‰å–çš„æ•°æ®é¦–å…ˆå­˜å…¥å†…å­˜ç¼“å†²åŒºï¼Œå½“è¾¾åˆ°é˜ˆå€¼æ—¶æº¢å†™åˆ°ç£ç›˜ã€‚</li><li>å¤šæ¬¡æº¢å†™ä¼šç”Ÿæˆå¤šä¸ªç£ç›˜æ–‡ä»¶ï¼Œæœ€ç»ˆåˆå¹¶ä¸ºä¸€ä¸ªå¤§æ–‡ä»¶ã€‚</li><li><strong>å½’å¹¶æ’åº</strong>ï¼šåˆå¹¶è¿‡ç¨‹ä¸­å¯¹æ•°æ®æŒ‰ Key è¿›è¡Œå…¨å±€æ’åºï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚</li></ul></li><li><strong>Reduce å¤„ç†</strong><ul><li>æ’åºåçš„ Key-Value æŒ‰ç»„ï¼ˆç›¸åŒ Key çš„æ‰€æœ‰ Valueï¼‰è¾“å…¥åˆ° Reduce å‡½æ•°ä¸­è¿›è¡Œè®¡ç®—ã€‚</li><li>æœ€ç»ˆç»“æœè¾“å‡ºåˆ° HDFS æˆ–å…¶ä»–å­˜å‚¨ç³»ç»Ÿã€‚</li></ul></li></ol><h2 id="5-hdfsæ–‡ä»¶ç³»ç»Ÿçš„è¯»å–æ•°æ®æµç¨‹æ˜¯ä»€ä¹ˆ"><a href="#5-hdfsæ–‡ä»¶ç³»ç»Ÿçš„è¯»å–æ•°æ®æµç¨‹æ˜¯ä»€ä¹ˆ" class="headerlink" title="5. hdfsæ–‡ä»¶ç³»ç»Ÿçš„è¯»å–æ•°æ®æµç¨‹æ˜¯ä»€ä¹ˆ?"></a>5. hdfsæ–‡ä»¶ç³»ç»Ÿçš„è¯»å–æ•°æ®æµç¨‹æ˜¯ä»€ä¹ˆ?</h2><p>HDFSï¼ˆHadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰çš„è¯»å–æ•°æ®æµç¨‹ä¸»è¦æ¶‰åŠå®¢æˆ·ç«¯ã€NameNodeï¼ˆå…ƒæ•°æ®èŠ‚ç‚¹ï¼‰å’Œ DataNodeï¼ˆæ•°æ®èŠ‚ç‚¹ï¼‰ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œæµç¨‹å¯åˆ†ä¸ºä»¥ä¸‹å…³é”®æ­¥éª¤ï¼š</p><h3 id="1-å®¢æˆ·ç«¯å‘èµ·è¯»å–è¯·æ±‚"><a href="#1-å®¢æˆ·ç«¯å‘èµ·è¯»å–è¯·æ±‚" class="headerlink" title="1. å®¢æˆ·ç«¯å‘èµ·è¯»å–è¯·æ±‚"></a><strong>1. å®¢æˆ·ç«¯å‘èµ·è¯»å–è¯·æ±‚</strong></h3><p>å®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨ HDFS æä¾›çš„ APIï¼ˆå¦‚<code>FileSystem.open(path)</code>ï¼‰å‘èµ·æ–‡ä»¶è¯»å–è¯·æ±‚ã€‚æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆä¸ HDFS çš„<code>DistributedFileSystem</code>ï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸæŠ½è±¡ç±»ï¼‰äº¤äº’ï¼Œå‘ŠçŸ¥éœ€è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ã€‚</p><h3 id="2-è·å–æ–‡ä»¶å…ƒæ•°æ®ï¼ˆä¸-NameNode-äº¤äº’ï¼‰"><a href="#2-è·å–æ–‡ä»¶å…ƒæ•°æ®ï¼ˆä¸-NameNode-äº¤äº’ï¼‰" class="headerlink" title="2. è·å–æ–‡ä»¶å…ƒæ•°æ®ï¼ˆä¸ NameNode äº¤äº’ï¼‰"></a><strong>2. è·å–æ–‡ä»¶å…ƒæ•°æ®ï¼ˆä¸ NameNode äº¤äº’ï¼‰</strong></h3><p><code>DistributedFileSystem</code>æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå‘<strong>NameNode</strong>å‘é€è¯·æ±‚ï¼Œè·å–ç›®æ ‡æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚å…ƒæ•°æ®åŒ…æ‹¬ï¼š</p><ul><li>æ–‡ä»¶è¢«åˆ†å‰²æˆçš„<strong>æ•°æ®å—ï¼ˆBlockï¼‰åˆ—è¡¨</strong>ï¼ˆæ–‡ä»¶æŒ‰å›ºå®šå¤§å°åˆ†å‰²ï¼Œé»˜è®¤å—å¤§å°ä¸º 128MB æˆ– 256MBï¼‰ï¼›</li><li>æ¯ä¸ªæ•°æ®å—çš„<strong>å‰¯æœ¬å­˜å‚¨ä½ç½®</strong>ï¼ˆå³è¯¥å—çš„å¤šä¸ªå‰¯æœ¬åˆ†åˆ«å­˜æ”¾åœ¨å“ªäº› DataNode ä¸Šï¼‰ã€‚</li></ul><p>NameNode ä»…å­˜å‚¨å…ƒæ•°æ®ï¼Œä¸å­˜å‚¨å®é™…æ•°æ®ï¼Œå› æ­¤ä¼šç›´æ¥è¿”å›ä¸Šè¿°ä¿¡æ¯ã€‚</p><h3 id="3-å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å…¥æµ"><a href="#3-å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å…¥æµ" class="headerlink" title="3. å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å…¥æµ"></a><strong>3. å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å…¥æµ</strong></h3><p><code>DistributedFileSystem</code>æ”¶åˆ° NameNode è¿”å›çš„å…ƒæ•°æ®åï¼Œä¼šä¸ºå®¢æˆ·ç«¯è¿”å›ä¸€ä¸ª<code>FSDataInputStream</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ•°æ®è¾“å…¥æµï¼‰å¯¹è±¡ã€‚è¯¥å¯¹è±¡å†…éƒ¨å°è£…äº†<code>DFSInputStream</code>ï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¾“å…¥æµï¼‰ï¼Œè´Ÿè´£åç»­ä¸ DataNode çš„å®é™…æ•°æ®äº¤äº’ã€‚</p><h3 id="4-å®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼ˆä¸-DataNode-äº¤äº’ï¼‰"><a href="#4-å®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼ˆä¸-DataNode-äº¤äº’ï¼‰" class="headerlink" title="4. å®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼ˆä¸ DataNode äº¤äº’ï¼‰"></a><strong>4. å®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼ˆä¸ DataNode äº¤äº’ï¼‰</strong></h3><p><code>DFSInputStream</code>æ ¹æ® NameNode è¿”å›çš„å…ƒæ•°æ®ï¼ŒæŒ‰é¡ºåºè¯»å–æ–‡ä»¶çš„å„ä¸ªæ•°æ®å—ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><strong>é€‰æ‹©æœ€ä¼˜ DataNode</strong>ï¼šå¯¹äºæ¯ä¸ªæ•°æ®å—ï¼Œ<code>DFSInputStream</code>ä¼šä¼˜å…ˆé€‰æ‹©è·ç¦»å®¢æˆ·ç«¯æœ€è¿‘çš„ DataNodeï¼ˆä¾‹å¦‚åŒä¸€æœºæ¶çš„èŠ‚ç‚¹ï¼Œå‡å°‘è·¨æœºæ¶ç½‘ç»œä¼ è¾“ï¼‰ï¼Œè‹¥è¯¥èŠ‚ç‚¹ä¸å¯ç”¨åˆ™è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–å‰¯æœ¬æ‰€åœ¨çš„ DataNodeã€‚</li><li><strong>ç›´æ¥è¯»å–æ•°æ®</strong>ï¼šå®¢æˆ·ç«¯é€šè¿‡<code>DFSInputStream</code>ä¸é€‰ä¸­çš„ DataNode å»ºç«‹è¿æ¥ï¼Œç›´æ¥è¯»å–è¯¥å—çš„æ•°æ®ï¼ˆæ•°æ®ä¼ è¾“ä¸ç»è¿‡ NameNodeï¼Œå‡è½» NameNode è´Ÿæ‹…ï¼‰ã€‚</li><li><strong>é¡ºåºè¯»å–æ‰€æœ‰å—</strong>ï¼šä¸€ä¸ªå—è¯»å–å®Œæˆåï¼Œ<code>DFSInputStream</code>ä¼šå…³é—­ä¸å½“å‰ DataNode çš„è¿æ¥ï¼Œè‡ªåŠ¨è¿æ¥ä¸‹ä¸€ä¸ªå—çš„æœ€ä¼˜ DataNodeï¼Œç»§ç»­è¯»å–ï¼Œç›´åˆ°æ‰€æœ‰å—å‡è¯»å–å®Œæ¯•ã€‚</li></ul><h3 id="5-å®¹é”™å¤„ç†"><a href="#5-å®¹é”™å¤„ç†" class="headerlink" title="5. å®¹é”™å¤„ç†"></a><strong>5. å®¹é”™å¤„ç†</strong></h3><p>åœ¨è¯»å–è¿‡ç¨‹ä¸­ï¼Œè‹¥æŸä¸ª DataNode å‡ºç°æ•…éšœï¼ˆå¦‚ç½‘ç»œä¸­æ–­ã€èŠ‚ç‚¹å®•æœºï¼‰ï¼Œ<code>DFSInputStream</code>ä¼šè‡ªåŠ¨å¤„ç†å®¹é”™ï¼š</p><ul><li>ç«‹å³å…³é—­ä¸æ•…éšœ DataNode çš„è¿æ¥ï¼›</li><li>ä»è¯¥å—çš„å…¶ä»–å‰¯æœ¬æ‰€åœ¨çš„ DataNode é‡æ–°è¯»å–æ•°æ®ï¼›</li><li>è®°å½•æ•…éšœèŠ‚ç‚¹ï¼Œåç»­è¯»å–æ—¶é¿å…ä½¿ç”¨ã€‚</li></ul><h3 id="6-è¯»å–å®Œæˆï¼Œå…³é—­æµ"><a href="#6-è¯»å–å®Œæˆï¼Œå…³é—­æµ" class="headerlink" title="6. è¯»å–å®Œæˆï¼Œå…³é—­æµ"></a><strong>6. è¯»å–å®Œæˆï¼Œå…³é—­æµ</strong></h3><p>å½“å®¢æˆ·ç«¯è¯»å–å®Œæ‰€æœ‰æ•°æ®å—ï¼ˆæ‹¼æ¥ä¸ºå®Œæ•´æ–‡ä»¶ï¼‰åï¼Œè°ƒç”¨<code>close()</code>æ–¹æ³•å…³é—­<code>FSDataInputStream</code>ï¼Œç»“æŸæœ¬æ¬¡è¯»å–æµç¨‹ã€‚</p><h3 id="æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“"><a href="#æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“" class="headerlink" title="æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“"></a><strong>æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“</strong></h3><ul><li><strong>å…ƒæ•°æ®ä¸æ•°æ®åˆ†ç¦»</strong>ï¼šNameNode ä»…æä¾›å…ƒæ•°æ®ï¼ˆå—ä½ç½®ï¼‰ï¼Œä¸å‚ä¸å®é™…æ•°æ®ä¼ è¾“ï¼Œæ•°æ®ç›´æ¥åœ¨å®¢æˆ·ç«¯ä¸ DataNode ä¹‹é—´ä¼ è¾“ï¼Œå‡è½» NameNode å‹åŠ›ã€‚</li><li><strong>å‰¯æœ¬åˆ©ç”¨</strong>ï¼šé€šè¿‡å¤šå‰¯æœ¬å­˜å‚¨ï¼Œä¿è¯äº†æ•°æ®è¯»å–çš„å¯é æ€§ï¼ˆæŸèŠ‚ç‚¹æ•…éšœæ—¶å¯åˆ‡æ¢åˆ°å…¶ä»–å‰¯æœ¬ï¼‰ã€‚</li><li><strong>å°±è¿‘è¯»å–</strong>ï¼šä¼˜å…ˆé€‰æ‹©è·ç¦»å®¢æˆ·ç«¯æœ€è¿‘çš„ DataNodeï¼ˆå¦‚åŒä¸€æœºæ¶ï¼‰ï¼Œå‡å°‘ç½‘ç»œå¼€é”€ï¼Œæå‡æ•ˆç‡ã€‚</li></ul><p>ç®€è¨€ä¹‹ï¼ŒHDFS è¯»å–æµç¨‹å¯æ¦‚æ‹¬ä¸ºï¼š<strong>å®¢æˆ·ç«¯è¯·æ±‚å…ƒæ•°æ®â†’NameNode è¿”å›å—ä½ç½®â†’å®¢æˆ·ç«¯ç›´æ¥ä» DataNode æŒ‰å—è¯»å–â†’å®¹é”™å¤„ç†â†’å®Œæˆè¯»å–</strong>ã€‚</p><h2 id="6-hdfsæ–‡ä»¶ç³»ç»Ÿçš„å†™æ–‡ä»¶æµç¨‹æ˜¯ä»€ä¹ˆ"><a href="#6-hdfsæ–‡ä»¶ç³»ç»Ÿçš„å†™æ–‡ä»¶æµç¨‹æ˜¯ä»€ä¹ˆ" class="headerlink" title="6. hdfsæ–‡ä»¶ç³»ç»Ÿçš„å†™æ–‡ä»¶æµç¨‹æ˜¯ä»€ä¹ˆ?"></a>6. hdfsæ–‡ä»¶ç³»ç»Ÿçš„å†™æ–‡ä»¶æµç¨‹æ˜¯ä»€ä¹ˆ?</h2><p>HDFSï¼ˆHadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰çš„å†™æ–‡ä»¶æµç¨‹åŒæ ·æ¶‰åŠå®¢æˆ·ç«¯ã€NameNode å’Œ DataNodeï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡<strong>å…ƒæ•°æ®ç®¡ç†</strong>å’Œ<strong>å‰¯æœ¬æœºåˆ¶</strong>ä¿è¯æ•°æ®çš„å¯é æ€§å’Œä¸€è‡´æ€§ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><h3 id="1-å®¢æˆ·ç«¯å‘èµ·å†™è¯·æ±‚"><a href="#1-å®¢æˆ·ç«¯å‘èµ·å†™è¯·æ±‚" class="headerlink" title="1. å®¢æˆ·ç«¯å‘èµ·å†™è¯·æ±‚"></a><strong>1. å®¢æˆ·ç«¯å‘èµ·å†™è¯·æ±‚</strong></h3><p>å®¢æˆ·ç«¯é€šè¿‡ HDFS APIï¼ˆå¦‚<code>FileSystem.create(path)</code>ï¼‰å‘èµ·æ–‡ä»¶å†™å…¥è¯·æ±‚ï¼Œé¦–å…ˆä¸<code>DistributedFileSystem</code>ï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸæŠ½è±¡ç±»ï¼‰äº¤äº’ï¼Œå‘ŠçŸ¥éœ€è¦å†™å…¥çš„æ–‡ä»¶è·¯å¾„ã€‚</p><h3 id="2-å‘-NameNode-è¯·æ±‚åˆ›å»ºæ–‡ä»¶"><a href="#2-å‘-NameNode-è¯·æ±‚åˆ›å»ºæ–‡ä»¶" class="headerlink" title="2. å‘ NameNode è¯·æ±‚åˆ›å»ºæ–‡ä»¶"></a><strong>2. å‘ NameNode è¯·æ±‚åˆ›å»ºæ–‡ä»¶</strong></h3><p><code>DistributedFileSystem</code>å‘<strong>NameNode</strong>å‘é€ â€œåˆ›å»ºæ–‡ä»¶â€ è¯·æ±‚ï¼ŒNameNode ä¼šè¿›è¡Œä¸€ç³»åˆ—æ ¡éªŒï¼š</p><ul><li>æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦å·²å­˜åœ¨ï¼ˆé¿å…è¦†ç›–ï¼‰ï¼›</li><li>æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æœ‰å†™æƒé™ï¼›</li><li>æ£€æŸ¥çˆ¶ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</li></ul><p>è‹¥æ ¡éªŒé€šè¿‡ï¼ŒNameNode ä¼šåœ¨å…ƒæ•°æ®ä¸­è®°å½•è¯¥æ–‡ä»¶çš„åˆ›å»ºçŠ¶æ€ï¼ˆæ ‡è®°ä¸º â€œæ­£åœ¨å†™å…¥â€ï¼‰ï¼Œå¹¶è¿”å› â€œå…è®¸åˆ›å»ºâ€ çš„å“åº”ï¼›è‹¥å¤±è´¥ï¼ˆå¦‚æ–‡ä»¶å·²å­˜åœ¨ï¼‰ï¼Œåˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="3-å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å‡ºæµå¹¶è·å–-DataNode-åˆ—è¡¨"><a href="#3-å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å‡ºæµå¹¶è·å–-DataNode-åˆ—è¡¨" class="headerlink" title="3. å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å‡ºæµå¹¶è·å– DataNode åˆ—è¡¨"></a><strong>3. å®¢æˆ·ç«¯åˆå§‹åŒ–è¾“å‡ºæµå¹¶è·å– DataNode åˆ—è¡¨</strong></h3><p><code>DistributedFileSystem</code>æ”¶åˆ°å…è®¸åˆ›å»ºçš„å“åº”åï¼Œä¸ºå®¢æˆ·ç«¯è¿”å›<code>FSDataOutputStream</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ•°æ®è¾“å‡ºæµï¼‰å¯¹è±¡ï¼Œå…¶å†…éƒ¨å°è£…äº†<code>DFSOutputStream</code>ï¼ˆåˆ†å¸ƒå¼è¾“å‡ºæµï¼‰ï¼Œè´Ÿè´£åç»­æ•°æ®ä¼ è¾“å’Œå‰¯æœ¬ç®¡ç†ã€‚</p><p>æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯é€šè¿‡<code>DFSOutputStream</code>å‘ NameNode è¯·æ±‚<strong>ç¬¬ä¸€ä¸ªæ•°æ®å—ï¼ˆBlockï¼‰çš„å­˜å‚¨ä½ç½®</strong>ã€‚NameNode æ ¹æ®å‰¯æœ¬æ”¾ç½®ç­–ç•¥ï¼ˆé»˜è®¤ 3 å‰¯æœ¬ï¼‰ï¼Œåˆ†é… 3 ä¸ª DataNode èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ï¼š1 ä¸ªæœ¬åœ°æœºæ¶èŠ‚ç‚¹ã€1 ä¸ªåŒæœºæ¶å…¶ä»–èŠ‚ç‚¹ã€1 ä¸ªå¼‚æœºæ¶èŠ‚ç‚¹ï¼Œå¹³è¡¡å¯é æ€§ä¸ç½‘ç»œå¼€é”€ï¼‰ï¼Œå¹¶å°†è¿™ 3 ä¸ª DataNode çš„åœ°å€è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><h3 id="4-å»ºç«‹æ•°æ®ä¼ è¾“ç®¡é“ï¼ˆPipelineï¼‰"><a href="#4-å»ºç«‹æ•°æ®ä¼ è¾“ç®¡é“ï¼ˆPipelineï¼‰" class="headerlink" title="4. å»ºç«‹æ•°æ®ä¼ è¾“ç®¡é“ï¼ˆPipelineï¼‰"></a><strong>4. å»ºç«‹æ•°æ®ä¼ è¾“ç®¡é“ï¼ˆPipelineï¼‰</strong></h3><p>å®¢æˆ·ç«¯çš„<code>DFSOutputStream</code>æ ¹æ® NameNode è¿”å›çš„ DataNode åˆ—è¡¨ï¼Œå»ºç«‹<strong>æ•°æ®ä¼ è¾“ç®¡é“</strong>ï¼š</p><ul><li>å®¢æˆ·ç«¯å…ˆä¸ç¬¬ä¸€ä¸ª DataNodeï¼ˆâ€œç®¡é“é¦–èŠ‚ç‚¹â€ï¼‰å»ºç«‹ TCP è¿æ¥ï¼›</li><li>ç¬¬ä¸€ä¸ª DataNode å†ä¸ç¬¬äºŒä¸ª DataNode å»ºç«‹è¿æ¥ï¼›</li><li>ç¬¬äºŒä¸ª DataNode ä¸ç¬¬ä¸‰ä¸ª DataNode å»ºç«‹è¿æ¥ï¼›<br>æœ€ç»ˆå½¢æˆ â€œå®¢æˆ·ç«¯â†’DataNode1â†’DataNode2â†’DataNode3â€ çš„é“¾å¼ç®¡é“ï¼Œç”¨äºæ•°æ®çš„é€çº§å¤åˆ¶ï¼ˆä¿è¯å‰¯æœ¬ä¸€è‡´æ€§ï¼‰ã€‚</li></ul><h3 id="5-å®¢æˆ·ç«¯å†™å…¥æ•°æ®ï¼ˆåˆ†å—-åˆ†æ•°æ®åŒ…ï¼‰"><a href="#5-å®¢æˆ·ç«¯å†™å…¥æ•°æ®ï¼ˆåˆ†å—-åˆ†æ•°æ®åŒ…ï¼‰" class="headerlink" title="5. å®¢æˆ·ç«¯å†™å…¥æ•°æ®ï¼ˆåˆ†å— + åˆ†æ•°æ®åŒ…ï¼‰"></a><strong>5. å®¢æˆ·ç«¯å†™å…¥æ•°æ®ï¼ˆåˆ†å— + åˆ†æ•°æ®åŒ…ï¼‰</strong></h3><p>å®¢æˆ·ç«¯å¼€å§‹å†™å…¥æ•°æ®ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><strong>æ•°æ®åˆ†å—</strong>ï¼šæ–‡ä»¶æŒ‰å›ºå®šå¤§å°ï¼ˆé»˜è®¤ 128MBï¼‰åˆ†å‰²ä¸ºæ•°æ®å—ï¼ˆBlockï¼‰ï¼Œé€ä¸ªå†™å…¥ï¼›</li><li><strong>æ•°æ®åŒ…ï¼ˆPacketï¼‰ä¼ è¾“</strong>ï¼šæ¯ä¸ªæ•°æ®å—è¢«æ‹†åˆ†ä¸ºæ›´å°çš„æ•°æ®åŒ…ï¼ˆé»˜è®¤ 64KBï¼‰ï¼Œå®¢æˆ·ç«¯å…ˆå°†æ•°æ®åŒ…å†™å…¥æœ¬åœ°ç¼“å†²åŒºï¼Œå†é€šè¿‡ç®¡é“å‘é€ç»™ç¬¬ä¸€ä¸ª DataNodeï¼›</li><li><strong>å‰¯æœ¬å¤åˆ¶</strong>ï¼šç¬¬ä¸€ä¸ª DataNode æ¥æ”¶æ•°æ®åŒ…åï¼Œç«‹å³è½¬å‘ç»™ç¬¬äºŒä¸ª DataNodeï¼Œç¬¬äºŒä¸ªå†è½¬å‘ç»™ç¬¬ä¸‰ä¸ªï¼Œå®ç°å‰¯æœ¬çš„åŒæ­¥å¤åˆ¶ï¼›</li><li><strong>ç¡®è®¤æœºåˆ¶</strong>ï¼šæ¯ä¸ª DataNode æ¥æ”¶æ•°æ®åŒ…å¹¶å†™å…¥æœ¬åœ°åï¼Œä¼šå‘ â€œä¸Šæ¸¸â€ è¿”å›ç¡®è®¤ï¼ˆACKï¼‰ã€‚æœ€ç»ˆï¼Œç¬¬ä¸‰ä¸ª DataNode çš„ç¡®è®¤ä¼šé€çº§ä¼ å›å®¢æˆ·ç«¯ï¼Œç¡®ä¿æ•°æ®åŒ…å·²è¢«æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹æ¥æ”¶ã€‚</li></ul><h3 id="6-æ•°æ®å—å†™å…¥å®Œæˆï¼Œè¯·æ±‚æ–°å—"><a href="#6-æ•°æ®å—å†™å…¥å®Œæˆï¼Œè¯·æ±‚æ–°å—" class="headerlink" title="6. æ•°æ®å—å†™å…¥å®Œæˆï¼Œè¯·æ±‚æ–°å—"></a><strong>6. æ•°æ®å—å†™å…¥å®Œæˆï¼Œè¯·æ±‚æ–°å—</strong></h3><p>å½“ä¸€ä¸ªæ•°æ®å—çš„æ‰€æœ‰æ•°æ®åŒ…å‡å†™å…¥å®Œæˆï¼ˆä¸”æ”¶åˆ°æ‰€æœ‰å‰¯æœ¬çš„ç¡®è®¤ï¼‰ï¼Œ<code>DFSOutputStream</code>ä¼šå‘ NameNode æŠ¥å‘Š â€œå½“å‰å—å†™å…¥å®Œæˆâ€ï¼Œå¹¶è¯·æ±‚åˆ†é…<strong>ä¸‹ä¸€ä¸ªæ•°æ®å—çš„ DataNode åˆ—è¡¨</strong>ã€‚é‡å¤æ­¥éª¤ 4-5ï¼Œç›´åˆ°æ‰€æœ‰æ•°æ®å—å‡å†™å…¥å®Œæˆã€‚</p><h3 id="7-å†™å…¥å®Œæˆï¼Œå…³é—­æµå¹¶ç¡®è®¤"><a href="#7-å†™å…¥å®Œæˆï¼Œå…³é—­æµå¹¶ç¡®è®¤" class="headerlink" title="7. å†™å…¥å®Œæˆï¼Œå…³é—­æµå¹¶ç¡®è®¤"></a><strong>7. å†™å…¥å®Œæˆï¼Œå…³é—­æµå¹¶ç¡®è®¤</strong></h3><p>å®¢æˆ·ç«¯å†™å®Œæ‰€æœ‰æ•°æ®åï¼Œè°ƒç”¨<code>close()</code>æ–¹æ³•å…³é—­<code>FSDataOutputStream</code>ï¼š</p><ul><li><code>DFSOutputStream</code>ä¼šå°†ç¼“å†²åŒºä¸­å‰©ä½™çš„æ•°æ®åŒ…å…¨éƒ¨å‘é€ï¼Œå¹¶ç­‰å¾…æœ€åä¸€æ‰¹ç¡®è®¤ï¼›</li><li>é€šçŸ¥ NameNode â€œæ–‡ä»¶å†™å…¥å®Œæˆâ€ï¼ŒNameNode æ›´æ–°å…ƒæ•°æ®ï¼ˆè®°å½•æ–‡ä»¶çš„æ‰€æœ‰å—ä¿¡æ¯ã€å‰¯æœ¬ä½ç½®ç­‰ï¼‰ï¼Œå¹¶å°†æ–‡ä»¶æ ‡è®°ä¸º â€œå·²å®Œæˆâ€ çŠ¶æ€ï¼ˆæ­¤æ—¶æ–‡ä»¶å¯è¢«è¯»å–ï¼‰ã€‚</li></ul><h3 id="å®¹é”™å¤„ç†ï¼ˆå…³é”®æœºåˆ¶ï¼‰"><a href="#å®¹é”™å¤„ç†ï¼ˆå…³é”®æœºåˆ¶ï¼‰" class="headerlink" title="å®¹é”™å¤„ç†ï¼ˆå…³é”®æœºåˆ¶ï¼‰"></a><strong>å®¹é”™å¤„ç†ï¼ˆå…³é”®æœºåˆ¶ï¼‰</strong></h3><p>å†™å…¥è¿‡ç¨‹ä¸­è‹¥æŸä¸ª DataNode æ•…éšœï¼ˆå¦‚ç½‘ç»œä¸­æ–­ã€èŠ‚ç‚¹å®•æœºï¼‰ï¼Œ<code>DFSOutputStream</code>ä¼šè‡ªåŠ¨å¤„ç†ï¼š</p><ul><li>ç«‹å³å…³é—­å½“å‰ç®¡é“ï¼Œæ ‡è®°æ•…éšœèŠ‚ç‚¹ï¼›</li><li>é€šçŸ¥ NameNode â€œè¯¥èŠ‚ç‚¹æ•…éšœâ€ï¼ŒNameNode ä¼šåç»­è°ƒåº¦å…¶ä»–èŠ‚ç‚¹è¡¥å……å‰¯æœ¬ï¼ˆç»´æŒé»˜è®¤ 3 å‰¯æœ¬ï¼‰ï¼›</li><li>å®¢æˆ·ç«¯é‡æ–°ä¸å‰©ä½™çš„å¥åº· DataNode å»ºç«‹æ–°ç®¡é“ï¼ˆä¾‹å¦‚ï¼šè‹¥ DataNode2 æ•…éšœï¼Œæ–°ç®¡é“ä¸º â€œå®¢æˆ·ç«¯â†’DataNode1â†’DataNode3â€ï¼‰ï¼Œå¹¶é‡å‘æœªç¡®è®¤çš„æ•°æ®åŒ…ï¼›</li><li>ç¡®ä¿æœ€ç»ˆæ‰€æœ‰æ•°æ®å—çš„å‰¯æœ¬æ•°é‡ç¬¦åˆé…ç½®ï¼ˆé»˜è®¤ 3 ä¸ªï¼‰ã€‚</li></ul><h3 id="æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“-1"><a href="#æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“-1" class="headerlink" title="æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“"></a><strong>æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“</strong></h3><ul><li><strong>ç®¡é“å¤åˆ¶</strong>ï¼šæ•°æ®é€šè¿‡é“¾å¼ç®¡é“é€çº§å¤åˆ¶åˆ°å‰¯æœ¬èŠ‚ç‚¹ï¼Œä¿è¯å‰¯æœ¬ä¸€è‡´æ€§ï¼›</li><li><strong>ç¡®è®¤æœºåˆ¶</strong>ï¼šæ¯ä¸ªæ•°æ®åŒ…éœ€ç»æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹ç¡®è®¤åæ‰ç®—å®Œæˆï¼Œç¡®ä¿æ•°æ®å¯é ï¼›</li><li><strong>æœºæ¶æ„ŸçŸ¥</strong>ï¼šå‰¯æœ¬åˆ†é…è€ƒè™‘æœºæ¶ä½ç½®ï¼ˆåŒæœºæ¶ + å¼‚æœºæ¶ï¼‰ï¼Œå¹³è¡¡å¯é æ€§ï¼ˆé¿å…å•æœºæ¶æ•…éšœï¼‰ä¸ç½‘ç»œæ•ˆç‡ï¼ˆå‡å°‘è·¨æœºæ¶ä¼ è¾“ï¼‰ï¼›</li><li><strong>NameNode è½»é‡å‚ä¸</strong>ï¼šä»…è´Ÿè´£å…ƒæ•°æ®ç®¡ç†å’Œå—åˆ†é…ï¼Œä¸å‚ä¸å®é™…æ•°æ®ä¼ è¾“ï¼Œé™ä½è´Ÿæ‹…ã€‚</li></ul><p>ç®€è¨€ä¹‹ï¼ŒHDFS å†™æµç¨‹å¯æ¦‚æ‹¬ä¸ºï¼š<strong>å®¢æˆ·ç«¯è¯·æ±‚åˆ›å»ºâ†’NameNode åˆ†é…èŠ‚ç‚¹â†’å»ºç«‹ç®¡é“å¤åˆ¶å‰¯æœ¬â†’åˆ†å—åˆ†åŒ…å†™å…¥â†’å®Œæˆåç¡®è®¤å…ƒæ•°æ®</strong>ï¼Œé€šè¿‡å®¹é”™æœºåˆ¶ç¡®ä¿æ•°æ®å¯é å­˜å‚¨ã€‚</p><h2 id="7-hdfsæ–‡ä»¶ç³»ç»Ÿ-namenodeçš„æ›´æ–°æµç¨‹æ˜¯ä»€ä¹ˆ"><a href="#7-hdfsæ–‡ä»¶ç³»ç»Ÿ-namenodeçš„æ›´æ–°æµç¨‹æ˜¯ä»€ä¹ˆ" class="headerlink" title="7. hdfsæ–‡ä»¶ç³»ç»Ÿ namenodeçš„æ›´æ–°æµç¨‹æ˜¯ä»€ä¹ˆ?"></a>7. hdfsæ–‡ä»¶ç³»ç»Ÿ namenodeçš„æ›´æ–°æµç¨‹æ˜¯ä»€ä¹ˆ?</h2><p>HDFS ä¸­ NameNode çš„æ ¸å¿ƒèŒè´£æ˜¯ç®¡ç†å…ƒæ•°æ®ï¼ˆå¦‚æ–‡ä»¶ç›®å½•ç»“æ„ã€æ•°æ®å—ä¸æ–‡ä»¶çš„æ˜ å°„ã€å—çš„å‰¯æœ¬ä½ç½®ç­‰ï¼‰ï¼Œå…¶å…ƒæ•°æ®çš„æ›´æ–°æµç¨‹ä¸å®¢æˆ·ç«¯æ“ä½œï¼ˆå¦‚åˆ›å»ºæ–‡ä»¶ã€å†™å…¥æ•°æ®ã€åˆ é™¤æ–‡ä»¶ã€é‡å‘½åç­‰ï¼‰ç´§å¯†ç»‘å®šï¼ŒåŒæ—¶ä¾èµ–<strong>æŒä¹…åŒ–æœºåˆ¶</strong>ï¼ˆä¿è¯å…ƒæ•°æ®ä¸ä¸¢å¤±ï¼‰å’Œ<strong>ä¸€è‡´æ€§ç»´æŠ¤</strong>ï¼ˆç¡®ä¿å…ƒæ•°æ®å‡†ç¡®ï¼‰ã€‚ä»¥ä¸‹æ˜¯ NameNode å…ƒæ•°æ®æ›´æ–°çš„æ ¸å¿ƒæµç¨‹ï¼š</p><h3 id="ä¸€ã€å…ƒæ•°æ®çš„å­˜å‚¨å½¢å¼"><a href="#ä¸€ã€å…ƒæ•°æ®çš„å­˜å‚¨å½¢å¼" class="headerlink" title="ä¸€ã€å…ƒæ•°æ®çš„å­˜å‚¨å½¢å¼"></a><strong>ä¸€ã€å…ƒæ•°æ®çš„å­˜å‚¨å½¢å¼</strong></h3><p>NameNode çš„å…ƒæ•°æ®åˆ†ä¸ºä¸¤ç§å½¢æ€ï¼Œæ›´æ–°æµç¨‹å›´ç»•è¿™ä¸¤ç§å½¢æ€å±•å¼€ï¼š</p><ol><li><p><strong>å†…å­˜å…ƒæ•°æ®ï¼ˆIn-Memory Metadataï¼‰</strong>ï¼šå®æ—¶ç»´æŠ¤çš„å…ƒæ•°æ®å¿«ç…§ï¼ŒåŒ…å«æ‰€æœ‰æ–‡ä»¶ã€ç›®å½•ã€å—çš„æœ€æ–°çŠ¶æ€ï¼ˆå¦‚æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€å—çš„å‰¯æœ¬ä½ç½®ã€å—çš„å¤§å°ç­‰ï¼‰ï¼Œä¾›å®¢æˆ·ç«¯å®æ—¶æŸ¥è¯¢å’Œæ“ä½œï¼Œæ€§èƒ½æé«˜ã€‚</p></li><li><p>æŒä¹…åŒ–å­˜å‚¨</p><p>ï¼š</p><ul><li><strong>FsImage</strong>ï¼šå…ƒæ•°æ®çš„ â€œå¿«ç…§æ–‡ä»¶â€ï¼Œå®šæœŸå°†å†…å­˜ä¸­çš„å…ƒæ•°æ®åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œæ˜¯å…ƒæ•°æ®çš„æŒä¹…åŒ–åŸºçº¿ã€‚</li><li><strong>EditLog</strong>ï¼šâ€œæ“ä½œæ—¥å¿—æ–‡ä»¶â€ï¼Œè®°å½•æ‰€æœ‰å¯¹å…ƒæ•°æ®çš„ä¿®æ”¹æ“ä½œï¼ˆå¦‚åˆ›å»ºæ–‡ä»¶ã€åˆ é™¤å—ç­‰ï¼‰ï¼Œæ˜¯å†…å­˜å…ƒæ•°æ®çš„ â€œå˜æ›´è®°å½•â€ï¼Œç¡®ä¿å…ƒæ•°æ®æ›´æ–°å¯è¿½æº¯ã€‚</li></ul></li></ol><h3 id="äºŒã€å…ƒæ•°æ®æ›´æ–°çš„æ ¸å¿ƒæµç¨‹ï¼ˆä»¥-â€œæ–‡ä»¶å†™å…¥â€-ä¸ºä¾‹ï¼‰"><a href="#äºŒã€å…ƒæ•°æ®æ›´æ–°çš„æ ¸å¿ƒæµç¨‹ï¼ˆä»¥-â€œæ–‡ä»¶å†™å…¥â€-ä¸ºä¾‹ï¼‰" class="headerlink" title="äºŒã€å…ƒæ•°æ®æ›´æ–°çš„æ ¸å¿ƒæµç¨‹ï¼ˆä»¥ â€œæ–‡ä»¶å†™å…¥â€ ä¸ºä¾‹ï¼‰"></a><strong>äºŒã€å…ƒæ•°æ®æ›´æ–°çš„æ ¸å¿ƒæµç¨‹ï¼ˆä»¥ â€œæ–‡ä»¶å†™å…¥â€ ä¸ºä¾‹ï¼‰</strong></h3><p>å®¢æˆ·ç«¯çš„ä»»ä½•æ“ä½œï¼ˆåˆ›å»ºã€å†™å…¥ã€åˆ é™¤ç­‰ï¼‰éƒ½ä¼šè§¦å‘ NameNode çš„å…ƒæ•°æ®æ›´æ–°ï¼Œä»¥æœ€å…¸å‹çš„ â€œæ–‡ä»¶å†™å…¥â€ ä¸ºä¾‹ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p><h4 id="1-å®¢æˆ·ç«¯å‘èµ·æ“ä½œè¯·æ±‚"><a href="#1-å®¢æˆ·ç«¯å‘èµ·æ“ä½œè¯·æ±‚" class="headerlink" title="1. å®¢æˆ·ç«¯å‘èµ·æ“ä½œè¯·æ±‚"></a><strong>1. å®¢æˆ·ç«¯å‘èµ·æ“ä½œè¯·æ±‚</strong></h4><p>å®¢æˆ·ç«¯é€šè¿‡ APIï¼ˆå¦‚<code>create</code>ã€<code>append</code>ç­‰ï¼‰å‘èµ·å¯¹ HDFS çš„ä¿®æ”¹æ“ä½œï¼ˆå¦‚åˆ›å»ºæ–‡ä»¶ã€å†™å…¥æ•°æ®å—ï¼‰ï¼Œè¯·æ±‚é¦–å…ˆåˆ°è¾¾<code>DistributedFileSystem</code>ï¼Œå†è½¬å‘ç»™ NameNodeã€‚</p><h4 id="2-NameNode-éªŒè¯æ“ä½œåˆæ³•æ€§"><a href="#2-NameNode-éªŒè¯æ“ä½œåˆæ³•æ€§" class="headerlink" title="2. NameNode éªŒè¯æ“ä½œåˆæ³•æ€§"></a><strong>2. NameNode éªŒè¯æ“ä½œåˆæ³•æ€§</strong></h4><p>NameNode æ”¶åˆ°è¯·æ±‚åï¼Œå…ˆè¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼š</p><ul><li>æƒé™æ ¡éªŒï¼ˆå®¢æˆ·ç«¯æ˜¯å¦æœ‰æ“ä½œæƒé™ï¼‰ï¼›</li><li>çŠ¶æ€æ ¡éªŒï¼ˆå¦‚åˆ›å»ºæ–‡ä»¶æ—¶æ£€æŸ¥è·¯å¾„æ˜¯å¦å·²å­˜åœ¨ï¼Œå†™å…¥å—æ—¶æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¤„äº â€œå¯å†™å…¥â€ çŠ¶æ€ï¼‰ï¼›</li><li>èµ„æºæ ¡éªŒï¼ˆå¦‚åˆ†é…å—æ—¶æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ DataNode å­˜å‚¨ç©ºé—´ï¼‰ã€‚</li></ul><p>è‹¥æ ¡éªŒå¤±è´¥ï¼Œç›´æ¥è¿”å›é”™è¯¯ï¼›è‹¥é€šè¿‡ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ã€‚</p><h4 id="3-è®°å½•æ“ä½œåˆ°-EditLogï¼ˆé¢„å†™æ—¥å¿—ï¼ŒWrite-Ahead-Logï¼‰"><a href="#3-è®°å½•æ“ä½œåˆ°-EditLogï¼ˆé¢„å†™æ—¥å¿—ï¼ŒWrite-Ahead-Logï¼‰" class="headerlink" title="3. è®°å½•æ“ä½œåˆ° EditLogï¼ˆé¢„å†™æ—¥å¿—ï¼ŒWrite-Ahead Logï¼‰"></a><strong>3. è®°å½•æ“ä½œåˆ° EditLogï¼ˆé¢„å†™æ—¥å¿—ï¼ŒWrite-Ahead Logï¼‰</strong></h4><p>ä¸ºä¿è¯å…ƒæ•°æ®æ›´æ–°çš„å¯é æ€§ï¼ŒNameNode é‡‡ç”¨ <strong>â€œå…ˆå†™æ—¥å¿—ï¼Œå†æ›´æ–°å†…å­˜â€</strong> çš„æœºåˆ¶ï¼ˆWrite-Ahead Loggingï¼ŒWALï¼‰ï¼š</p><ul><li>å°†å½“å‰æ“ä½œï¼ˆå¦‚ â€œåˆ›å»ºæ–‡ä»¶â€â€œåˆ†é…å— 1 åˆ° DataNode Aã€Bã€Câ€ï¼‰åºåˆ—åŒ–åå†™å…¥<strong>EditLog</strong>ï¼ˆé»˜è®¤å­˜å‚¨åœ¨ç£ç›˜çš„<code>dfs.namenode.edits.dir</code>ç›®å½•ï¼‰ã€‚</li><li>åªæœ‰å½“ EditLog å†™å…¥æˆåŠŸï¼ˆç¡®ä¿æ“ä½œè¢«æŒä¹…åŒ–ï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œåç»­çš„å†…å­˜å…ƒæ•°æ®æ›´æ–°ã€‚</li></ul><p><em>æ³¨ï¼šEditLog æ˜¯é¡ºåºå†™å…¥çš„ï¼Œæ€§èƒ½æé«˜ï¼Œä¸”æ”¯æŒå¤šç›®å½•å¤‡ä»½ï¼ˆæœ¬åœ°ç£ç›˜ + è¿œç¨‹å­˜å‚¨ï¼‰ï¼Œé˜²æ­¢å•ç‚¹æ•…éšœå¯¼è‡´æ—¥å¿—ä¸¢å¤±ã€‚</em></p><h4 id="4-æ›´æ–°å†…å­˜å…ƒæ•°æ®"><a href="#4-æ›´æ–°å†…å­˜å…ƒæ•°æ®" class="headerlink" title="4. æ›´æ–°å†…å­˜å…ƒæ•°æ®"></a><strong>4. æ›´æ–°å†…å­˜å…ƒæ•°æ®</strong></h4><p>EditLog å†™å…¥æˆåŠŸåï¼ŒNameNode ç«‹å³æ›´æ–°<strong>å†…å­˜ä¸­çš„å…ƒæ•°æ®</strong>ï¼š</p><ul><li>ä¾‹å¦‚ï¼Œåˆ›å»ºæ–‡ä»¶æ—¶ï¼Œå†…å­˜ä¸­æ–°å¢æ–‡ä»¶æ¡ç›®ï¼Œæ ‡è®°ä¸º â€œæ­£åœ¨å†™å…¥â€ çŠ¶æ€ï¼›</li><li>å†™å…¥æ•°æ®å—æ—¶ï¼Œä¸ºæ–‡ä»¶æ·»åŠ æ–°çš„å—æ˜ å°„ï¼ˆè®°å½•å— ID ä¸æ–‡ä»¶çš„å…³è”ï¼‰ï¼Œå¹¶è®°å½•å—çš„å‰¯æœ¬ä½ç½®ï¼ˆDataNode åˆ—è¡¨ï¼‰ï¼›</li><li>å½“æ–‡ä»¶å†™å…¥å®Œæˆæ—¶ï¼Œå°†æ–‡ä»¶çŠ¶æ€ä» â€œæ­£åœ¨å†™å…¥â€ æ”¹ä¸º â€œå·²å®Œæˆâ€ã€‚</li></ul><p>å†…å­˜å…ƒæ•°æ®çš„æ›´æ–°æ˜¯å®æ—¶çš„ï¼Œç¡®ä¿åç»­å®¢æˆ·ç«¯æŸ¥è¯¢èƒ½è·å–æœ€æ–°çŠ¶æ€ã€‚</p><h3 id="æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“-2"><a href="#æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“-2" class="headerlink" title="æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“"></a><strong>æ ¸å¿ƒç‰¹ç‚¹æ€»ç»“</strong></h3><ol><li><strong>å¯é æ€§</strong>ï¼šä¾èµ– EditLog çš„é¢„å†™æœºåˆ¶ï¼ˆå…ˆå†™æ—¥å¿—å†æ›´æ–°å†…å­˜ï¼‰ï¼Œç¡®ä¿ä»»ä½•å…ƒæ•°æ®ä¿®æ”¹éƒ½è¢«æŒä¹…åŒ–ï¼Œé¿å…å®•æœºä¸¢å¤±ã€‚</li><li><strong>é«˜æ•ˆæ€§</strong>ï¼šå†…å­˜å…ƒæ•°æ®å®æ—¶æ›´æ–°ï¼Œä¿è¯å®¢æˆ·ç«¯æ“ä½œçš„ä½å»¶è¿Ÿï¼›EditLog é¡ºåºå†™å…¥ã€FsImage å®šæœŸåˆå¹¶ï¼Œå¹³è¡¡æ€§èƒ½ä¸æŒä¹…åŒ–å¼€é”€ã€‚</li><li><strong>ä¸€è‡´æ€§</strong>ï¼šé€šè¿‡ä¸¥æ ¼çš„æ“ä½œæ ¡éªŒå’Œæ—¥å¿—è®°å½•ï¼Œç¡®ä¿å…ƒæ•°æ®çš„çŠ¶æ€ä¸å®é™…æ–‡ä»¶ç³»ç»Ÿä¸€è‡´ï¼ˆå¦‚æ–‡ä»¶è¦ä¹ˆå­˜åœ¨è¦ä¹ˆä¸å­˜åœ¨ï¼Œä¸ä¼šå‡ºç°ä¸­é—´æ€ï¼‰ã€‚</li></ol><p>ç®€è¨€ä¹‹ï¼ŒNameNode çš„å…ƒæ•°æ®æ›´æ–°æµç¨‹å¯æ¦‚æ‹¬ä¸ºï¼š<strong>å®¢æˆ·ç«¯è¯·æ±‚â†’æ ¡éªŒâ†’è®°å½• EditLogâ†’æ›´æ–°å†…å­˜å…ƒæ•°æ®â†’å®šæœŸåˆå¹¶æ—¥å¿—ä¸é•œåƒâ†’æ•…éšœæ—¶é‡æ”¾æ—¥å¿—æ¢å¤</strong>ã€‚</p><h2 id="8-æ•´ä¸ªmapreduceé˜¶æ®µç»å†å‡ æ¬¡æ’åº-åˆ†åˆ«åœ¨å“ªäº›é˜¶æ®µ"><a href="#8-æ•´ä¸ªmapreduceé˜¶æ®µç»å†å‡ æ¬¡æ’åº-åˆ†åˆ«åœ¨å“ªäº›é˜¶æ®µ" class="headerlink" title="8. æ•´ä¸ªmapreduceé˜¶æ®µç»å†å‡ æ¬¡æ’åº?åˆ†åˆ«åœ¨å“ªäº›é˜¶æ®µ?"></a>8. æ•´ä¸ªmapreduceé˜¶æ®µç»å†å‡ æ¬¡æ’åº?åˆ†åˆ«åœ¨å“ªäº›é˜¶æ®µ?</h2><p>åœ¨ MapReduce çš„æ•´ä¸ªæµç¨‹ä¸­ï¼Œæ’åºæ˜¯æ ¸å¿ƒæœºåˆ¶ä¹‹ä¸€ï¼Œå…±ç»å†<strong>ä¸‰æ¬¡æ’åº</strong>ï¼Œåˆ†åˆ«å‘ç”Ÿåœ¨ä»¥ä¸‹é˜¶æ®µï¼š</p><ol><li><strong>Map é˜¶æ®µçš„æº¢å†™ï¼ˆSpillï¼‰æ’åº</strong><br>å½“ Map ä»»åŠ¡çš„ç¯å½¢ç¼“å†²åŒºä½¿ç”¨ç‡è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ 80%ï¼‰æ—¶ï¼Œæ•°æ®ä¼šè¢«æº¢å†™åˆ°ç£ç›˜ã€‚æº¢å†™å‰ä¼šå¯¹ç¼“å†²åŒºä¸­çš„æ•°æ®è¿›è¡Œ<strong>å¿«é€Ÿæ’åº</strong>ï¼Œæ’åºä¾æ®æ˜¯é”®ï¼ˆKeyï¼‰å’Œåˆ†åŒºå·ï¼ˆPartitionï¼‰136ã€‚æ’åºåçš„æ•°æ®æŒ‰åˆ†åŒºèšé›†ï¼Œæ¯ä¸ªåˆ†åŒºå†…çš„é”®å€¼å¯¹æŒ‰ Key å‡åºæ’åˆ—ã€‚è¿™ä¸€æ­¥ç¡®ä¿æ¯ä¸ªæº¢å†™æ–‡ä»¶åœ¨åˆ†åŒºå†…æ˜¯æœ‰åºçš„ã€‚</li><li><strong>Map é˜¶æ®µçš„åˆå¹¶ï¼ˆMergeï¼‰æ’åº</strong><br>Map ä»»åŠ¡å®Œæˆåï¼Œç£ç›˜ä¸Šå¯èƒ½å­˜åœ¨å¤šä¸ªæº¢å†™æ–‡ä»¶ã€‚æ­¤æ—¶ä¼šå¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œ<strong>å½’å¹¶æ’åº</strong>ï¼Œå°†åŒä¸€åˆ†åŒºçš„å¤šä¸ªæº¢å†™æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå¤§æ–‡ä»¶ã€‚åˆå¹¶è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¼šæŒ‰ Key å†æ¬¡æ’åºï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªåˆ†åŒºæœ‰åºçš„è¾“å‡ºæ–‡ä»¶ã€‚</li><li><strong>Reduce é˜¶æ®µçš„è¾“å…¥åˆå¹¶æ’åº</strong><br>Reduce ä»»åŠ¡æ‹‰å–æ‰€æœ‰ Map ä»»åŠ¡çš„è¾“å‡ºæ•°æ®åï¼Œä¼šå°†åŒä¸€åˆ†åŒºçš„å¤šä¸ªæ–‡ä»¶è¿›è¡Œ<strong>å½’å¹¶æ’åº</strong>ã€‚è¿™ä¸€æ­¥å°†åˆ†æ•£çš„æœ‰åºæ•°æ®åˆå¹¶æˆä¸€ä¸ªå…¨å±€æœ‰åºçš„æ–‡ä»¶ï¼Œç¡®ä¿è¾“å…¥åˆ° Reducer çš„æ•°æ®æŒ‰ Key æœ‰åºæ’åˆ—ã€‚åˆå¹¶è¿‡ç¨‹å¯èƒ½æ¶‰åŠå†…å­˜åˆ°ç£ç›˜æˆ–ç£ç›˜åˆ°ç£ç›˜çš„å¤šæ¬¡åˆå¹¶ï¼Œä½†æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ªå®Œæ•´çš„æœ‰åºæ•°æ®é›†ã€‚</li></ol><h3 id="è¡¥å……è¯´æ˜"><a href="#è¡¥å……è¯´æ˜" class="headerlink" title="è¡¥å……è¯´æ˜"></a>è¡¥å……è¯´æ˜</h3><ul><li><strong>æ’åºçš„å¿…è¦æ€§</strong>ï¼šæ’åºæ˜¯ MapReduce æ¡†æ¶çš„é»˜è®¤è¡Œä¸ºï¼Œç›®çš„æ˜¯å°†ç›¸åŒ Key çš„æ•°æ®èšé›†åˆ°åŒä¸€ä¸ª Reducer å¤„ç†ï¼Œç¡®ä¿æ•°æ®å¤„ç†çš„æ­£ç¡®æ€§å’Œé«˜æ•ˆæ€§ã€‚</li><li><strong>æ’åºç®—æ³•</strong>ï¼šMap é˜¶æ®µçš„æº¢å†™ä½¿ç”¨å¿«é€Ÿæ’åºï¼Œè€Œåˆå¹¶é˜¶æ®µï¼ˆåŒ…æ‹¬ Map å’Œ Reduceï¼‰ä½¿ç”¨å½’å¹¶æ’åºï¼Œè¿™ä¸¤ç§ç®—æ³•çš„ç»“åˆä¿è¯äº†å¤§è§„æ¨¡æ•°æ®å¤„ç†çš„æ€§èƒ½ã€‚</li><li><strong>è¾“å‡ºæ’åº</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒReducer çš„è¾“å‡ºä¼šæŒ‰ Key å†æ¬¡æ’åºï¼Œä½†è¿™å±äºæ¡†æ¶è‡ªåŠ¨å®Œæˆçš„è¾“å‡ºå¤„ç†ï¼Œé€šå¸¸ä¸è®¡å…¥ MapReduce é˜¶æ®µçš„æ’åºæ¬¡æ•°ã€‚</li></ul><h2 id="9-hiveä¸­å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«-åˆ†åŒºè¡¨å’Œåˆ†æ¡¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#9-hiveä¸­å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«-åˆ†åŒºè¡¨å’Œåˆ†æ¡¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="9. hiveä¸­å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«? åˆ†åŒºè¡¨å’Œåˆ†æ¡¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>9. hiveä¸­å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«? åˆ†åŒºè¡¨å’Œåˆ†æ¡¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«?</h2><p>åœ¨ Hive ä¸­ï¼Œå†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ã€åˆ†åŒºè¡¨ä¸åˆ†æ¡¶è¡¨æ˜¯ä¸¤ç»„é‡è¦çš„æ¦‚å¿µï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><h3 id="ä¸€ã€å†…éƒ¨è¡¨ï¼ˆManaged-Tableï¼‰-vs-å¤–éƒ¨è¡¨ï¼ˆExternal-Tableï¼‰"><a href="#ä¸€ã€å†…éƒ¨è¡¨ï¼ˆManaged-Tableï¼‰-vs-å¤–éƒ¨è¡¨ï¼ˆExternal-Tableï¼‰" class="headerlink" title="ä¸€ã€å†…éƒ¨è¡¨ï¼ˆManaged Tableï¼‰ vs å¤–éƒ¨è¡¨ï¼ˆExternal Tableï¼‰"></a><strong>ä¸€ã€å†…éƒ¨è¡¨ï¼ˆManaged Tableï¼‰ vs å¤–éƒ¨è¡¨ï¼ˆExternal Tableï¼‰</strong></h3><h4 id="1-æ•°æ®ç®¡ç†æ–¹å¼"><a href="#1-æ•°æ®ç®¡ç†æ–¹å¼" class="headerlink" title="1. æ•°æ®ç®¡ç†æ–¹å¼"></a><strong>1. æ•°æ®ç®¡ç†æ–¹å¼</strong></h4><ul><li><strong>å†…éƒ¨è¡¨</strong><br>Hive å®Œå…¨ç®¡ç†æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬æ•°æ®çš„å­˜å‚¨è·¯å¾„ã€åˆ›å»ºã€åˆ é™¤ç­‰ã€‚å½“åˆ é™¤å†…éƒ¨è¡¨æ—¶ï¼Œæ•°æ®æ–‡ä»¶ä¹Ÿä¼šè¢«æ°¸ä¹…åˆ é™¤ã€‚</li><li><strong>å¤–éƒ¨è¡¨</strong><br>æ•°æ®å­˜å‚¨åœ¨ Hive å…ƒæ•°æ®æŒ‡å®šçš„è·¯å¾„ï¼ˆå¦‚ HDFSï¼‰ï¼ŒHive ä»…ç®¡ç†å…ƒæ•°æ®ï¼ˆè¡¨ç»“æ„ï¼‰ã€‚åˆ é™¤å¤–éƒ¨è¡¨æ—¶ï¼Œæ•°æ®æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ï¼Œä»…åˆ é™¤å…ƒæ•°æ®ã€‚</li></ul><h4 id="2-åˆ›å»ºè¯­æ³•å·®å¼‚"><a href="#2-åˆ›å»ºè¯­æ³•å·®å¼‚" class="headerlink" title="2. åˆ›å»ºè¯­æ³•å·®å¼‚"></a><strong>2. åˆ›å»ºè¯­æ³•å·®å¼‚</strong></h4><ul><li><p>å†…éƒ¨è¡¨</p><p>sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> internal_table (id <span class="type">INT</span>, name STRING);</span><br></pre></td></tr></table></figure></li><li><p>å¤–éƒ¨è¡¨</p><p>sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">EXTERNAL</span> <span class="keyword">TABLE</span> external_table (id <span class="type">INT</span>, name STRING)</span><br><span class="line">LOCATION <span class="string">&#x27;/path/to/data&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-ä½¿ç”¨åœºæ™¯"><a href="#3-ä½¿ç”¨åœºæ™¯" class="headerlink" title="3. ä½¿ç”¨åœºæ™¯"></a><strong>3. ä½¿ç”¨åœºæ™¯</strong></h4><ul><li><strong>å†…éƒ¨è¡¨</strong>ï¼šé€‚åˆä¸´æ—¶æ•°æ®æˆ–æµ‹è¯•æ•°æ®ï¼Œæ•°æ®ç”± Hive å®Œå…¨æŒæ§ã€‚</li><li><strong>å¤–éƒ¨è¡¨</strong>ï¼šé€‚åˆå…±äº«æ•°æ®ï¼ˆå¦‚å¤šä¸ªç³»ç»Ÿå…±åŒè®¿é—®åŒä¸€ HDFS è·¯å¾„ï¼‰æˆ–é¿å…è¯¯åˆ é‡è¦æ•°æ®ã€‚</li></ul><h3 id="äºŒã€åˆ†åŒºè¡¨ï¼ˆPartitioned-Tableï¼‰-vs-åˆ†æ¡¶è¡¨ï¼ˆBucketed-Tableï¼‰"><a href="#äºŒã€åˆ†åŒºè¡¨ï¼ˆPartitioned-Tableï¼‰-vs-åˆ†æ¡¶è¡¨ï¼ˆBucketed-Tableï¼‰" class="headerlink" title="äºŒã€åˆ†åŒºè¡¨ï¼ˆPartitioned Tableï¼‰ vs åˆ†æ¡¶è¡¨ï¼ˆBucketed Tableï¼‰"></a><strong>äºŒã€åˆ†åŒºè¡¨ï¼ˆPartitioned Tableï¼‰ vs åˆ†æ¡¶è¡¨ï¼ˆBucketed Tableï¼‰</strong></h3><h4 id="1-æ•°æ®ç»„ç»‡æ–¹å¼"><a href="#1-æ•°æ®ç»„ç»‡æ–¹å¼" class="headerlink" title="1. æ•°æ®ç»„ç»‡æ–¹å¼"></a><strong>1. æ•°æ®ç»„ç»‡æ–¹å¼</strong></h4><ul><li><strong>åˆ†åŒºè¡¨</strong><br>æŒ‰æŒ‡å®šå­—æ®µï¼ˆå¦‚æ—¥æœŸã€åœ°åŒºï¼‰å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªå­ç›®å½•ï¼ŒæŸ¥è¯¢æ—¶å¯é€šè¿‡åˆ†åŒºè¿‡æ»¤å¿«é€Ÿå®šä½æ•°æ®ã€‚<br><strong>ç¤ºä¾‹</strong>ï¼šæŒ‰æ—¥æœŸåˆ†åŒºçš„è¡¨ï¼Œæ•°æ®å­˜å‚¨åœ¨ <code>/table/date=20230101/</code>ã€<code>/table/date=20230102/</code> ç­‰ç›®å½•ã€‚</li><li><strong>åˆ†æ¡¶è¡¨</strong><br>æŒ‰æŒ‡å®šå­—æ®µçš„å“ˆå¸Œå€¼å°†æ•°æ®åˆ†æ•£åˆ°å¤šä¸ªæ–‡ä»¶ï¼ˆæ¡¶ï¼‰ä¸­ï¼Œç”¨äºæé«˜æ•°æ®æŠ½æ ·å’Œ JOIN æ•ˆç‡ã€‚<br><strong>ç¤ºä¾‹</strong>ï¼šæŒ‰ç”¨æˆ· ID åˆ†æ¡¶çš„è¡¨ï¼Œæ•°æ®è¢«å“ˆå¸Œåˆ° <code>000000_0</code>ã€<code>000001_0</code> ç­‰æ–‡ä»¶ã€‚</li></ul><h4 id="2-åˆ›å»ºè¯­æ³•å·®å¼‚-1"><a href="#2-åˆ›å»ºè¯­æ³•å·®å¼‚-1" class="headerlink" title="2. åˆ›å»ºè¯­æ³•å·®å¼‚"></a><strong>2. åˆ›å»ºè¯­æ³•å·®å¼‚</strong></h4><ul><li><p>åˆ†åŒºè¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> partitioned_table (id <span class="type">INT</span>, name STRING)</span><br><span class="line">PARTITIONED <span class="keyword">BY</span> (dt STRING);</span><br></pre></td></tr></table></figure></li><li><p>åˆ†æ¡¶è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> bucketed_table (id <span class="type">INT</span>, name STRING)</span><br><span class="line">CLUSTERED <span class="keyword">BY</span> (id) <span class="keyword">INTO</span> <span class="number">4</span> BUCKETS;</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-ä½¿ç”¨åœºæ™¯-1"><a href="#3-ä½¿ç”¨åœºæ™¯-1" class="headerlink" title="3. ä½¿ç”¨åœºæ™¯"></a><strong>3. ä½¿ç”¨åœºæ™¯</strong></h4><ul><li><strong>åˆ†åŒºè¡¨</strong>ï¼šé€‚åˆè¿‡æ»¤æ¡ä»¶é¢‘ç¹æ¶‰åŠåˆ†åŒºå­—æ®µï¼ˆå¦‚æŒ‰æ—¥æœŸæŸ¥è¯¢ï¼‰çš„åœºæ™¯ï¼Œå¯å¤§å¹…å‡å°‘æ•°æ®æ‰«æèŒƒå›´ã€‚</li><li><strong>åˆ†æ¡¶è¡¨</strong>ï¼šé€‚åˆ JOIN æ“ä½œï¼ˆæ¡¶æ•°ç›¸åŒä¸”åˆ†æ¡¶å­—æ®µä¸€è‡´æ—¶å¯ç›´æ¥åŒ¹é…ï¼‰æˆ–æ•°æ®æŠ½æ ·ï¼ˆå¦‚ <code>TABLESAMPLE</code> è¯­å¥ï¼‰ã€‚</li></ul><h3 id="ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“"><a href="#ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“" class="headerlink" title="ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“"></a><strong>ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“</strong></h3><table><thead><tr><th><strong>å¯¹æ¯”ç»´åº¦</strong></th><th><strong>å†…éƒ¨è¡¨ vs å¤–éƒ¨è¡¨</strong></th><th><strong>åˆ†åŒºè¡¨ vs åˆ†æ¡¶è¡¨</strong></th></tr></thead><tbody><tr><td><strong>æ•°æ®ç®¡ç†</strong></td><td>å†…éƒ¨è¡¨ç®¡ç†æ•°æ®ï¼Œå¤–éƒ¨è¡¨ä»…ç®¡ç†å…ƒæ•°æ®</td><td>å‡ä¸å½±å“æ•°æ®ç”Ÿå‘½å‘¨æœŸ</td></tr><tr><td><strong>æ•°æ®ç»„ç»‡å½¢å¼</strong></td><td>æ— ç‰¹æ®Šç»„ç»‡</td><td>åˆ†åŒºæŒ‰å­—æ®µåˆ›å»ºå­ç›®å½•ï¼Œåˆ†æ¡¶æŒ‰å“ˆå¸Œåˆ†æ–‡ä»¶</td></tr><tr><td><strong>ä¸»è¦ç›®çš„</strong></td><td>æ§åˆ¶æ•°æ®æ‰€æœ‰æƒå’Œç”Ÿå‘½å‘¨æœŸ</td><td>ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼ˆåˆ†åŒºè¿‡æ»¤ã€åˆ†æ¡¶ JOINï¼‰</td></tr><tr><td><strong>åˆ é™¤æ“ä½œå½±å“</strong></td><td>å†…éƒ¨è¡¨åˆ é™¤æ•°æ®ï¼Œå¤–éƒ¨è¡¨ä¿ç•™æ•°æ®</td><td>å‡ä¸åˆ é™¤æ•°æ®</td></tr></tbody></table><h3 id="å››ã€æœ€ä½³å®è·µå»ºè®®"><a href="#å››ã€æœ€ä½³å®è·µå»ºè®®" class="headerlink" title="å››ã€æœ€ä½³å®è·µå»ºè®®"></a><strong>å››ã€æœ€ä½³å®è·µå»ºè®®</strong></h3><ol><li><strong>å†…éƒ¨è¡¨ &#x2F; å¤–éƒ¨è¡¨é€‰æ‹©</strong><ul><li>è‹¥æ•°æ®ä»…ç”± Hive ä½¿ç”¨ä¸”éœ€è¦è‡ªåŠ¨ç®¡ç†ï¼Œç”¨å†…éƒ¨è¡¨ã€‚</li><li>è‹¥æ•°æ®éœ€è¢«å…¶ä»–ç³»ç»Ÿå…±äº«æˆ–ä¿æŠ¤ï¼Œç”¨å¤–éƒ¨è¡¨ã€‚</li></ul></li><li><strong>åˆ†åŒºè¡¨ &#x2F; åˆ†æ¡¶è¡¨é€‰æ‹©</strong><ul><li>è¿‡æ»¤æ¡ä»¶å¸¸æ¶‰åŠæŸå­—æ®µï¼ˆå¦‚æ—¥æœŸï¼‰æ—¶ï¼Œä¼˜å…ˆåˆ†åŒºã€‚</li><li>JOIN æ“ä½œé¢‘ç¹æˆ–éœ€æ•°æ®æŠ½æ ·æ—¶ï¼Œè€ƒè™‘åˆ†æ¡¶ã€‚</li><li>å¤æ‚åœºæ™¯å¯ç»„åˆä½¿ç”¨ï¼ˆå¦‚åˆ†åŒº + åˆ†æ¡¶ï¼‰ã€‚</li></ul></li></ol><h2 id="10-æ•°æ®å€¾æ–œæ˜¯ä»€ä¹ˆ-å¦‚ä½•è§„é¿å’Œå¤„ç†"><a href="#10-æ•°æ®å€¾æ–œæ˜¯ä»€ä¹ˆ-å¦‚ä½•è§„é¿å’Œå¤„ç†" class="headerlink" title="10. æ•°æ®å€¾æ–œæ˜¯ä»€ä¹ˆ? å¦‚ä½•è§„é¿å’Œå¤„ç†?"></a>10. æ•°æ®å€¾æ–œæ˜¯ä»€ä¹ˆ? å¦‚ä½•è§„é¿å’Œå¤„ç†?</h2><p>åœ¨å¤§æ•°æ®å¤„ç†åœºæ™¯ä¸­ï¼Œ<strong>æ•°æ®å€¾æ–œ</strong>æ˜¯æŒ‡ç”±äºæ•°æ®åˆ†å¸ƒæç«¯ä¸å‡åŒ€ï¼Œå¯¼è‡´éƒ¨åˆ†è®¡ç®—èŠ‚ç‚¹æ‰¿æ‹…äº†è¿œè¶…å…¶ä»–èŠ‚ç‚¹çš„æ•°æ®é‡æˆ–è®¡ç®—å‹åŠ›ï¼Œè¿›è€Œæ‹–æ…¢æ•´ä¸ªä»»åŠ¡æ‰§è¡Œæ•ˆç‡ï¼ˆç”šè‡³å¯¼è‡´èŠ‚ç‚¹å†…å­˜æº¢å‡ºã€ä»»åŠ¡å¤±è´¥ï¼‰çš„ç°è±¡ã€‚</p><h3 id="æ•°æ®å€¾æ–œçš„è¡¨ç°ä¸å½±å“"><a href="#æ•°æ®å€¾æ–œçš„è¡¨ç°ä¸å½±å“" class="headerlink" title="æ•°æ®å€¾æ–œçš„è¡¨ç°ä¸å½±å“"></a><strong>æ•°æ®å€¾æ–œçš„è¡¨ç°ä¸å½±å“</strong></h3><ul><li><strong>è¡¨ç°</strong>ï¼šä»»åŠ¡è¿›åº¦é•¿æ—¶é—´åœç•™åœ¨ 99%ï¼ˆå°‘æ•°èŠ‚ç‚¹æœªå®Œæˆï¼‰ã€éƒ¨åˆ†èŠ‚ç‚¹æ—¥å¿—é¢‘ç¹æŠ¥å†…å­˜è­¦å‘Šï¼ˆOOMï¼‰ã€ä¸åŒèŠ‚ç‚¹å¤„ç†çš„æ•°æ®é‡å·®å¼‚æ‚¬æ®Šï¼ˆå¦‚æŸèŠ‚ç‚¹å¤„ç† 1000 ä¸‡æ¡æ•°æ®ï¼Œå…¶ä»–èŠ‚ç‚¹ä»…å¤„ç† 1 ä¸‡æ¡ï¼‰ã€‚</li><li><strong>å½±å“</strong>ï¼šä»»åŠ¡æ‰§è¡Œæ—¶é—´å¤§å¹…å»¶é•¿ã€èµ„æºåˆ©ç”¨ç‡æä½ï¼ˆå¤šæ•°èŠ‚ç‚¹ç©ºé—²ï¼‰ã€æç«¯æƒ…å†µå¯¼è‡´ä»»åŠ¡å¤±è´¥ã€‚</li></ul><h3 id="æ•°æ®å€¾æ–œçš„å¸¸è§åœºæ™¯"><a href="#æ•°æ®å€¾æ–œçš„å¸¸è§åœºæ™¯" class="headerlink" title="æ•°æ®å€¾æ–œçš„å¸¸è§åœºæ™¯"></a><strong>æ•°æ®å€¾æ–œçš„å¸¸è§åœºæ™¯</strong></h3><p>æ•°æ®å€¾æ–œé€šå¸¸å‘ç”Ÿåœ¨éœ€è¦<strong>shuffle æ“ä½œ</strong>çš„ç¯èŠ‚ï¼ˆå¦‚<code>group by</code>ã€<code>join</code>ã€<code>distinct</code>ç­‰ï¼‰ï¼Œå› ä¸º shuffle ä¼šæ ¹æ® key çš„å“ˆå¸Œå€¼åˆ†é…æ•°æ®åˆ°ä¸åŒèŠ‚ç‚¹ï¼Œè‹¥æŸä¸ª key çš„æ•°é‡å¼‚å¸¸å¤šï¼ˆâ€œå¤§ keyâ€ï¼‰ï¼Œåˆ™ä¼šå¯¼è‡´å¯¹åº”èŠ‚ç‚¹è´Ÿè½½è¿‡é«˜ã€‚å¸¸è§åœºæ™¯åŒ…æ‹¬ï¼š</p><ul><li><code>group by key</code>æ—¶ï¼ŒæŸç±» key çš„æ•°é‡å æ¯”è¶…è¿‡ 90%ï¼›</li><li><code>join</code>æ“ä½œä¸­ï¼ŒæŸå¼ è¡¨çš„æŸä¸ªå…³è” key åŒ…å«æ•°ç™¾ä¸‡æ¡æ•°æ®ï¼Œè€Œå…¶ä»– key ä»…æ•°åƒæ¡ï¼›</li><li><code>distinct</code>å»é‡æ—¶ï¼ŒæŸä¸ªå€¼çš„é‡å¤æ¬¡æ•°æé«˜ï¼ˆå¦‚ç»Ÿè®¡ç”¨æˆ·è¡Œä¸ºæ—¶ï¼Œâ€œæœªçŸ¥ç”¨æˆ· IDâ€ çš„è®°å½•é‡æå¤§ï¼‰ã€‚</li></ul><h3 id="æ•°æ®å€¾æ–œçš„è§„é¿æ–¹æ³•ï¼ˆäº‹å‰é¢„é˜²ï¼‰"><a href="#æ•°æ®å€¾æ–œçš„è§„é¿æ–¹æ³•ï¼ˆäº‹å‰é¢„é˜²ï¼‰" class="headerlink" title="æ•°æ®å€¾æ–œçš„è§„é¿æ–¹æ³•ï¼ˆäº‹å‰é¢„é˜²ï¼‰"></a><strong>æ•°æ®å€¾æ–œçš„è§„é¿æ–¹æ³•ï¼ˆäº‹å‰é¢„é˜²ï¼‰</strong></h3><p>è§„é¿çš„æ ¸å¿ƒæ˜¯<strong>å‡å°‘ â€œå¤§ keyâ€ çš„äº§ç”Ÿ</strong>ï¼Œä»æ•°æ®æºå¤´æˆ–è®¡ç®—é€»è¾‘ä¸Šé¿å…æç«¯ä¸å‡åŒ€çš„åˆ†å¸ƒã€‚</p><h4 id="1-æ•°æ®é¢„å¤„ç†ï¼šè¿‡æ»¤-æ¸…æ´—æ— æ•ˆæ•°æ®"><a href="#1-æ•°æ®é¢„å¤„ç†ï¼šè¿‡æ»¤-æ¸…æ´—æ— æ•ˆæ•°æ®" class="headerlink" title="1. æ•°æ®é¢„å¤„ç†ï¼šè¿‡æ»¤ &#x2F; æ¸…æ´—æ— æ•ˆæ•°æ®"></a>1. <strong>æ•°æ®é¢„å¤„ç†ï¼šè¿‡æ»¤ &#x2F; æ¸…æ´—æ— æ•ˆæ•°æ®</strong></h4><ul><li><p>æå‰è¿‡æ»¤æ‰æ— æ„ä¹‰çš„ â€œè„æ•°æ®â€ï¼ˆå¦‚ç©ºå€¼ã€é»˜è®¤å€¼ã€å¼‚å¸¸å€¼ï¼‰ã€‚ä¾‹å¦‚ï¼šç”¨æˆ·è¡Œä¸ºæ—¥å¿—ä¸­ï¼Œâ€œæœªçŸ¥ç”¨æˆ· IDï¼ˆå¦‚ - 1ï¼‰â€ çš„è®°å½•å¯èƒ½å æ¯”æé«˜ï¼Œå¯æå‰è¿‡æ»¤æˆ–å•ç‹¬æ ‡è®°å¤„ç†ã€‚</p></li><li><p>ç¤ºä¾‹ï¼šåœ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">join</span><br></pre></td></tr></table></figure><p>å‰ï¼Œå…ˆè¿‡æ»¤æ‰å…³è” key ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">null</span><br></pre></td></tr></table></figure><p>æˆ–å¼‚å¸¸å€¼çš„æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¿‡æ»¤æ— æ•ˆkeyï¼Œé¿å…å‚ä¸shuffle</span></span><br><span class="line"><span class="keyword">SELECT</span> a.id, b.name </span><br><span class="line"><span class="keyword">FROM</span> table_a a</span><br><span class="line"><span class="keyword">JOIN</span> table_b b </span><br><span class="line"><span class="keyword">ON</span> a.id <span class="operator">=</span> b.id </span><br><span class="line"><span class="keyword">WHERE</span> a.id <span class="keyword">IS</span> <span class="keyword">NOT NULL</span> <span class="keyword">AND</span> a.id <span class="operator">!=</span> <span class="number">-1</span>;</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-æ‹†åˆ†å¤§-keyï¼šå°†é›†ä¸­çš„-key-åˆ†æ•£åŒ–"><a href="#2-æ‹†åˆ†å¤§-keyï¼šå°†é›†ä¸­çš„-key-åˆ†æ•£åŒ–" class="headerlink" title="2. æ‹†åˆ†å¤§ keyï¼šå°†é›†ä¸­çš„ key åˆ†æ•£åŒ–"></a>2. <strong>æ‹†åˆ†å¤§ keyï¼šå°†é›†ä¸­çš„ key åˆ†æ•£åŒ–</strong></h4><ul><li>è‹¥æŸç±» key å¤©ç„¶å­˜åœ¨ï¼ˆå¦‚çƒ­é—¨å•†å“ IDï¼‰ï¼Œå¯é€šè¿‡ â€œæ‹†åˆ†â€ å°†å…¶è½¬åŒ–ä¸ºå¤šä¸ªå­ keyï¼Œåˆ†æ•£åˆ°ä¸åŒèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼šå°†å¤§ key <code>key001</code>æ‹†åˆ†ä¸º<code>key001_0</code>ã€<code>key001_1</code>ã€â€¦ã€<code>key001_n</code>ï¼Œæ¯ä¸ªå­ key çš„æ•°æ®é‡å‡åŒ€ã€‚</li><li>é€‚ç”¨åœºæ™¯ï¼šå·²çŸ¥æŸ key æ˜¯å¤§ keyï¼ˆå¦‚ä¸šåŠ¡ä¸Šå·²çŸ¥ â€œçƒ­é—¨å•†å“ IDâ€ï¼‰ï¼Œå¯åœ¨æ•°æ®å†™å…¥æ—¶æå‰æ‹†åˆ†ï¼Œæˆ–åœ¨è®¡ç®—å‰é€šè¿‡è§„åˆ™æ‹†åˆ†ã€‚</li></ul><h4 id="3-é€‰æ‹©åˆé€‚çš„è®¡ç®—é€»è¾‘ï¼šé¿å…ä¸å¿…è¦çš„-shuffle"><a href="#3-é€‰æ‹©åˆé€‚çš„è®¡ç®—é€»è¾‘ï¼šé¿å…ä¸å¿…è¦çš„-shuffle" class="headerlink" title="3. é€‰æ‹©åˆé€‚çš„è®¡ç®—é€»è¾‘ï¼šé¿å…ä¸å¿…è¦çš„ shuffle"></a>3. <strong>é€‰æ‹©åˆé€‚çš„è®¡ç®—é€»è¾‘ï¼šé¿å…ä¸å¿…è¦çš„ shuffle</strong></h4><ul><li><p>å°è¡¨å¹¿æ’­ï¼ˆBroadcast Joinï¼‰ï¼šè‹¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">join</span><br></pre></td></tr></table></figure><p>çš„ä¸¤å¼ è¡¨ä¸­ï¼Œä¸€å¼ æ˜¯å°è¡¨ï¼ˆæ•°æ®é‡ &lt;å¹¿æ’­é˜ˆå€¼ï¼Œå¦‚ 10GBï¼‰ï¼Œå¯å°†å°è¡¨å¹¿æ’­åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œé¿å… shuffleï¼ˆå¤§è¡¨ä¸æœ¬åœ°å°è¡¨ç›´æ¥å…³è”ï¼‰ã€‚é€‚ç”¨äº â€œå¤§è¡¨ join å°è¡¨â€ åœºæ™¯ï¼ˆå¦‚ç»´åº¦è¡¨ä¸äº‹å®è¡¨ joinï¼‰ã€‚</p><ul><li><p>Spark ä¸­å¯é€šè¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">broadcast()</span><br></pre></td></tr></table></figure><p>å‡½æ•°å®ç°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark.sql.functions <span class="keyword">import</span> broadcast</span><br><span class="line">df = big_table.join(broadcast(small_table), on=<span class="string">&quot;key&quot;</span>, how=<span class="string">&quot;left&quot;</span>)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>é¿å…å…¨å±€<code>distinct</code>ï¼šå¦‚éœ€ç»Ÿè®¡ â€œç”¨æˆ·æ€»æ•°â€ï¼Œè‹¥ç›´æ¥ç”¨<code>count(distinct user_id)</code>ï¼Œå¯èƒ½å› æŸç±»ç”¨æˆ· ID é‡å¤è¿‡å¤šå¯¼è‡´å€¾æ–œï¼Œå¯æ”¹ä¸º<code>group by user_id</code>å<code>count</code>ï¼Œåˆ†æ•£è®¡ç®—å‹åŠ›ã€‚</p></li></ul><h3 id="æ•°æ®å€¾æ–œçš„å¤„ç†æ–¹æ³•ï¼ˆäº‹ä¸­è§£å†³ï¼‰"><a href="#æ•°æ®å€¾æ–œçš„å¤„ç†æ–¹æ³•ï¼ˆäº‹ä¸­è§£å†³ï¼‰" class="headerlink" title="æ•°æ®å€¾æ–œçš„å¤„ç†æ–¹æ³•ï¼ˆäº‹ä¸­è§£å†³ï¼‰"></a><strong>æ•°æ®å€¾æ–œçš„å¤„ç†æ–¹æ³•ï¼ˆäº‹ä¸­è§£å†³ï¼‰</strong></h3><p>å½“å€¾æ–œå·²å‘ç”Ÿæ—¶ï¼Œæ ¸å¿ƒæ˜¯ <strong>â€œæ‹†åˆ†å¤§ keyï¼Œåˆ†æ•£è´Ÿè½½â€</strong> æˆ– <strong>â€œå•ç‹¬å¤„ç†å¤§ keyâ€</strong>ï¼Œä»¥ä¸‹æ˜¯å…·ä½“ç­–ç•¥ï¼š</p><h4 id="1-å¤§-key-æ‹†åˆ†ï¼ˆåŠ ç›æ³•ï¼‰"><a href="#1-å¤§-key-æ‹†åˆ†ï¼ˆåŠ ç›æ³•ï¼‰" class="headerlink" title="1. å¤§ key æ‹†åˆ†ï¼ˆåŠ ç›æ³•ï¼‰"></a>1. <strong>å¤§ key æ‹†åˆ†ï¼ˆåŠ ç›æ³•ï¼‰</strong></h4><p>å¯¹å¯¼è‡´å€¾æ–œçš„å¤§ keyï¼Œé€šè¿‡æ·»åŠ éšæœºå‰ç¼€ï¼ˆâ€œåŠ ç›â€ï¼‰å°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªå­ keyï¼Œåˆ†æ•£åˆ°ä¸åŒèŠ‚ç‚¹å¤„ç†ï¼Œæœ€ååˆå¹¶ç»“æœã€‚<br><strong>ç¤ºä¾‹</strong>ï¼š<code>join</code>æ—¶æŸ key <code>K</code>æœ‰ 100 ä¸‡æ¡æ•°æ®ï¼Œå…¶ä»– key ä»… 1 ä¸‡æ¡ï¼š</p><ul><li><strong>æ­¥éª¤ 1</strong>ï¼šå¯¹å·¦è¡¨çš„<code>K</code>æ·»åŠ éšæœºå‰ç¼€ï¼ˆå¦‚<code>K_0</code>ã€<code>K_1</code>ã€â€¦ã€<code>K_9</code>ï¼‰ï¼Œæ‹†åˆ†ä¸º 10 ä¸ªå­ keyï¼ˆæ•°æ®é‡å„ 10 ä¸‡ï¼‰ï¼›</li><li><strong>æ­¥éª¤ 2</strong>ï¼šå¯¹å³è¡¨çš„<code>K</code>å¤åˆ¶ 10 ä»½ï¼Œåˆ†åˆ«æ·»åŠ ç›¸åŒå‰ç¼€ï¼ˆ<code>K_0</code>åˆ°<code>K_9</code>ï¼‰ï¼›</li><li><strong>æ­¥éª¤ 3</strong>ï¼šä¸¤è¡¨æŒ‰åŠ ç›åçš„ key è¿›è¡Œ<code>join</code>ï¼Œæ­¤æ—¶åŸå¤§ key çš„ 100 ä¸‡æ•°æ®è¢«åˆ†æ•£åˆ° 10 ä¸ªèŠ‚ç‚¹å¤„ç†ï¼›</li><li><strong>æ­¥éª¤ 4</strong>ï¼šå»æ‰å‰ç¼€ï¼Œåˆå¹¶ç»“æœã€‚</li></ul><h4 id="2-è°ƒæ•´-shuffle-åˆ†åŒºæ•°"><a href="#2-è°ƒæ•´-shuffle-åˆ†åŒºæ•°" class="headerlink" title="2. è°ƒæ•´ shuffle åˆ†åŒºæ•°"></a>2. <strong>è°ƒæ•´ shuffle åˆ†åŒºæ•°</strong></h4><p>é»˜è®¤çš„ shuffle åˆ†åŒºæ•°ï¼ˆå¦‚ Spark é»˜è®¤ 200ï¼ŒHive é»˜è®¤ 100ï¼‰å¯èƒ½å¯¼è‡´åˆ†åŒºæ•°ä¸è¶³ï¼ŒåŠ å‰§å€¾æ–œã€‚å¯é€šè¿‡å¢åŠ åˆ†åŒºæ•°è®©æ•°æ®æ›´å‡åŒ€åˆ†å¸ƒï¼š</p><ul><li>Sparkï¼š<code>spark.sql.shuffle.partitions = 1000</code>ï¼ˆæ ¹æ®æ•°æ®é‡è°ƒæ•´ï¼Œé€šå¸¸æ¯åˆ†åŒº 100MB~1GBï¼‰ï¼›</li><li>Hiveï¼š<code>set mapreduce.job.reduces = 1000</code>ï¼ˆreduce æ•°å³åˆ†åŒºæ•°ï¼‰ã€‚</li></ul><h4 id="3-æ¡†æ¶çº§å‚æ•°ä¼˜åŒ–"><a href="#3-æ¡†æ¶çº§å‚æ•°ä¼˜åŒ–" class="headerlink" title="3. æ¡†æ¶çº§å‚æ•°ä¼˜åŒ–"></a>3. <strong>æ¡†æ¶çº§å‚æ•°ä¼˜åŒ–</strong></h4><p>ä¸»æµå¤§æ•°æ®æ¡†æ¶æä¾›äº†è‡ªåŠ¨å¤„ç†å€¾æ–œçš„å‚æ•°ï¼Œå¯ç›´æ¥å¼€å¯ï¼š</p><ul><li>Sparkï¼š<ul><li><code>spark.sql.adaptive.enabled = true</code>ï¼ˆè‡ªé€‚åº”æ‰§è¡Œï¼ŒåŠ¨æ€è°ƒæ•´åˆ†åŒºæ•°ï¼‰ï¼›</li><li><code>spark.sql.adaptive.skewJoin.enabled = true</code>ï¼ˆè‡ªåŠ¨æ£€æµ‹å¹¶å¤„ç† join å€¾æ–œï¼Œæ‹†åˆ†å¤§ keyï¼‰ã€‚</li></ul></li><li>Hiveï¼š<ul><li><code>set hive.optimize.skewjoin = true</code>ï¼ˆå¼€å¯å€¾æ–œ join ä¼˜åŒ–ï¼‰ï¼›</li><li><code>set hive.skewjoin.key = 100000</code>ï¼ˆå®šä¹‰ â€œå¤§ keyâ€ é˜ˆå€¼ï¼Œè¶…è¿‡è¯¥å€¼åˆ™è§†ä¸ºå€¾æ–œï¼‰ã€‚</li></ul></li></ul><h4 id="4-è¿‡æ»¤æˆ–å•ç‹¬å¤„ç†å¤§-key"><a href="#4-è¿‡æ»¤æˆ–å•ç‹¬å¤„ç†å¤§-key" class="headerlink" title="4. è¿‡æ»¤æˆ–å•ç‹¬å¤„ç†å¤§ key"></a>4. <strong>è¿‡æ»¤æˆ–å•ç‹¬å¤„ç†å¤§ key</strong></h4><p>è‹¥å¤§ key çš„æ•°æ®æ— å®é™…ä¸šåŠ¡æ„ä¹‰ï¼ˆå¦‚æµ‹è¯•æ•°æ®ã€å¼‚å¸¸å€¼ï¼‰ï¼Œå¯ç›´æ¥è¿‡æ»¤ï¼›è‹¥å¿…é¡»ä¿ç•™ï¼Œå¯å•ç‹¬æå–å¤§ key æ•°æ®ï¼Œç”¨ â€œå°è¡¨å¹¿æ’­â€ æˆ– â€œMap ç«¯ joinâ€ å•ç‹¬å¤„ç†ï¼Œå†ä¸å…¶ä»–ç»“æœåˆå¹¶ã€‚</p><h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><p>æ•°æ®å€¾æ–œçš„æœ¬è´¨æ˜¯ <strong>â€œæ•°æ®åˆ†å¸ƒä¸å‡åŒ€â€</strong>ï¼Œæ ¸å¿ƒè§£å†³æ€è·¯æ˜¯ï¼š</p><ol><li><strong>äº‹å‰è§„é¿</strong>ï¼šé€šè¿‡æ•°æ®æ¸…æ´—ã€é€»è¾‘ä¼˜åŒ–å‡å°‘å¤§ key äº§ç”Ÿï¼›</li><li><strong>äº‹ä¸­å¤„ç†</strong>ï¼šé€šè¿‡æ‹†åˆ†å¤§ keyã€è°ƒæ•´åˆ†åŒºã€æ¡†æ¶å‚æ•°ä¼˜åŒ–ç­‰åˆ†æ•£è´Ÿè½½ã€‚</li></ol><p>å®é™…å¤„ç†ä¸­éœ€ç»“åˆå…·ä½“ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚æ•°æ®ç‰¹ç‚¹ã€è®¡ç®—é€»è¾‘ï¼‰å’Œæ¡†æ¶ç‰¹æ€§é€‰æ‹©åˆé€‚æ–¹æ¡ˆï¼Œæœ€ç»ˆç›®æ ‡æ˜¯è®©æ•°æ®åœ¨èŠ‚ç‚¹é—´åˆ†å¸ƒå°½å¯èƒ½å‡åŒ€ï¼Œæå‡æ•´ä½“è®¡ç®—æ•ˆç‡ã€‚</p><h2 id="11-å¦‚ä½•ä½¿ç”¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸Šä¼ æˆ–ä¸‹è½½æ•°æ®-å…³é—­hdfsæ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ¨¡å¼"><a href="#11-å¦‚ä½•ä½¿ç”¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸Šä¼ æˆ–ä¸‹è½½æ•°æ®-å…³é—­hdfsæ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ¨¡å¼" class="headerlink" title="11. å¦‚ä½•ä½¿ç”¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸Šä¼ æˆ–ä¸‹è½½æ•°æ®? å…³é—­hdfsæ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ¨¡å¼"></a>11. å¦‚ä½•ä½¿ç”¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸Šä¼ æˆ–ä¸‹è½½æ•°æ®? å…³é—­hdfsæ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ¨¡å¼</h2><p>HDFSï¼ˆHadoop Distributed File Systemï¼‰æ˜¯ Hadoop ç”Ÿæ€ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºå­˜å‚¨å’Œç®¡ç†å¤§è§„æ¨¡æ•°æ®é›†ã€‚ä¸‹é¢ä»‹ç»å¦‚ä½•ä½¿ç”¨ HDFS å‘½ä»¤è¡Œå·¥å…·ä¸Šä¼  &#x2F; ä¸‹è½½æ•°æ®ï¼Œä»¥åŠå¦‚ä½•å…³é—­å®‰å…¨æ¨¡å¼ã€‚</p><h3 id="ä¸€ã€HDFS-æ•°æ®ä¸Šä¼ ä¸ä¸‹è½½"><a href="#ä¸€ã€HDFS-æ•°æ®ä¸Šä¼ ä¸ä¸‹è½½" class="headerlink" title="ä¸€ã€HDFS æ•°æ®ä¸Šä¼ ä¸ä¸‹è½½"></a><strong>ä¸€ã€HDFS æ•°æ®ä¸Šä¼ ä¸ä¸‹è½½</strong></h3><h4 id="1-ä¸Šä¼ æ•°æ®åˆ°-HDFSï¼ˆä»æœ¬åœ°åˆ°-HDFSï¼‰"><a href="#1-ä¸Šä¼ æ•°æ®åˆ°-HDFSï¼ˆä»æœ¬åœ°åˆ°-HDFSï¼‰" class="headerlink" title="1. ä¸Šä¼ æ•°æ®åˆ° HDFSï¼ˆä»æœ¬åœ°åˆ° HDFSï¼‰"></a><strong>1. ä¸Šä¼ æ•°æ®åˆ° HDFSï¼ˆä»æœ¬åœ°åˆ° HDFSï¼‰</strong></h4><p>ä½¿ç”¨<code>hdfs dfs -put</code>æˆ–<code>hdfs dfs -copyFromLocal</code>å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•ï¼šhdfs dfs -put &lt;æœ¬åœ°è·¯å¾„&gt; &lt;HDFSç›®æ ‡è·¯å¾„&gt;</span></span><br><span class="line">hdfs dfs -put /home/user/local_data.txt /user/hdfs/data/</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨copyFromLocalï¼ˆåŠŸèƒ½ç›¸åŒï¼‰</span></span><br><span class="line">hdfs dfs -copyFromLocal /home/user/local_data.txt /user/hdfs/data/</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>-f</code>ï¼šå¼ºåˆ¶è¦†ç›– HDFS ä¸Šå·²å­˜åœ¨çš„æ–‡ä»¶ï¼ˆè‹¥ç›®æ ‡è·¯å¾„å·²å­˜åœ¨åŒåæ–‡ä»¶ï¼‰ã€‚</li><li><code>-p</code>ï¼šä¿ç•™åŸå§‹æ–‡ä»¶çš„æƒé™ã€æ—¶é—´æˆ³ç­‰å±æ€§ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼šä¸Šä¼ ç›®å½•åŠå…¶æ‰€æœ‰å­æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -put /home/user/local_dir /user/hdfs/</span><br></pre></td></tr></table></figure><h4 id="2-ä»-HDFS-ä¸‹è½½æ•°æ®ï¼ˆä»-HDFS-åˆ°æœ¬åœ°ï¼‰"><a href="#2-ä»-HDFS-ä¸‹è½½æ•°æ®ï¼ˆä»-HDFS-åˆ°æœ¬åœ°ï¼‰" class="headerlink" title="2. ä» HDFS ä¸‹è½½æ•°æ®ï¼ˆä» HDFS åˆ°æœ¬åœ°ï¼‰"></a><strong>2. ä» HDFS ä¸‹è½½æ•°æ®ï¼ˆä» HDFS åˆ°æœ¬åœ°ï¼‰</strong></h4><p>ä½¿ç”¨<code>hdfs dfs -get</code>æˆ–<code>hdfs dfs -copyToLocal</code>å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¯­æ³•ï¼šhdfs dfs -get &lt;HDFSè·¯å¾„&gt; &lt;æœ¬åœ°ç›®æ ‡è·¯å¾„&gt;</span></span><br><span class="line">hdfs dfs -get /user/hdfs/data.txt /home/user/downloads/</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨copyToLocalï¼ˆåŠŸèƒ½ç›¸åŒï¼‰</span></span><br><span class="line">hdfs dfs -get /user/hdfs/data.txt /home/user/downloads/</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>-f</code>ï¼šå¼ºåˆ¶è¦†ç›–æœ¬åœ°å·²å­˜åœ¨çš„æ–‡ä»¶ã€‚</li><li><code>-ignoreCrc</code>ï¼šå¿½ç•¥ CRC æ ¡éªŒï¼ˆè‹¥æ–‡ä»¶æŸåä½†ä»éœ€ä¸‹è½½ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼šä¸‹è½½æ•´ä¸ªç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -get /user/hdfs/dir /home/user/downloads/</span><br></pre></td></tr></table></figure><h4 id="3-å…¶ä»–å¸¸ç”¨-HDFS-æ“ä½œå‘½ä»¤"><a href="#3-å…¶ä»–å¸¸ç”¨-HDFS-æ“ä½œå‘½ä»¤" class="headerlink" title="3. å…¶ä»–å¸¸ç”¨ HDFS æ“ä½œå‘½ä»¤"></a><strong>3. å…¶ä»–å¸¸ç”¨ HDFS æ“ä½œå‘½ä»¤</strong></h4><ul><li><p>æŸ¥çœ‹ HDFS æ–‡ä»¶åˆ—è¡¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">ls</span> /user/hdfs/</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">cat</span> /user/hdfs/data.txt</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºç›®å½•:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">mkdir</span> -p /user/hdfs/new_dir</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤æ–‡ä»¶ &#x2F; ç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">rm</span> -r /user/hdfs/to_delete</span><br></pre></td></tr></table></figure></li></ul><h3 id="äºŒã€å…³é—­-HDFS-å®‰å…¨æ¨¡å¼"><a href="#äºŒã€å…³é—­-HDFS-å®‰å…¨æ¨¡å¼" class="headerlink" title="äºŒã€å…³é—­ HDFS å®‰å…¨æ¨¡å¼"></a><strong>äºŒã€å…³é—­ HDFS å®‰å…¨æ¨¡å¼</strong></h3><h4 id="1-å®‰å…¨æ¨¡å¼ç®€ä»‹"><a href="#1-å®‰å…¨æ¨¡å¼ç®€ä»‹" class="headerlink" title="1. å®‰å…¨æ¨¡å¼ç®€ä»‹"></a><strong>1. å®‰å…¨æ¨¡å¼ç®€ä»‹</strong></h4><p>å®‰å…¨æ¨¡å¼æ˜¯ HDFS çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ï¼Œç”¨äºåœ¨ç³»ç»Ÿå¯åŠ¨ã€æ•…éšœæ¢å¤æˆ–ç»´æŠ¤æœŸé—´é˜²æ­¢æ•°æ®è¢«ä¿®æ”¹ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼š</p><ul><li>å®¢æˆ·ç«¯åªèƒ½è¯»å–æ•°æ®ï¼Œä¸èƒ½å†™å…¥æˆ–åˆ é™¤æ–‡ä»¶ï¼›</li><li>NameNode ä¸ä¼šæ‰§è¡Œå—çš„å¤åˆ¶æˆ–åˆ é™¤æ“ä½œï¼›</li><li>å½“é›†ç¾¤ä¸­è¶…è¿‡ 99.9% çš„å—æ»¡è¶³æœ€å°å‰¯æœ¬æ•°è¦æ±‚æ—¶ï¼Œå®‰å…¨æ¨¡å¼å¯æ‰‹åŠ¨å…³é—­ã€‚</li></ul><h4 id="2-æŸ¥çœ‹å½“å‰å®‰å…¨æ¨¡å¼çŠ¶æ€"><a href="#2-æŸ¥çœ‹å½“å‰å®‰å…¨æ¨¡å¼çŠ¶æ€" class="headerlink" title="2. æŸ¥çœ‹å½“å‰å®‰å…¨æ¨¡å¼çŠ¶æ€"></a><strong>2. æŸ¥çœ‹å½“å‰å®‰å…¨æ¨¡å¼çŠ¶æ€</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfsadmin -safemode get</span><br><span class="line"><span class="comment"># è¾“å‡ºç¤ºä¾‹ï¼šSafe mode is OFFï¼ˆå…³é—­ï¼‰æˆ–Safe mode is ONï¼ˆå¼€å¯ï¼‰</span></span><br></pre></td></tr></table></figure><h4 id="3-æ‰‹åŠ¨å…³é—­å®‰å…¨æ¨¡å¼ï¼ˆéœ€ç®¡ç†å‘˜æƒé™ï¼‰"><a href="#3-æ‰‹åŠ¨å…³é—­å®‰å…¨æ¨¡å¼ï¼ˆéœ€ç®¡ç†å‘˜æƒé™ï¼‰" class="headerlink" title="3. æ‰‹åŠ¨å…³é—­å®‰å…¨æ¨¡å¼ï¼ˆéœ€ç®¡ç†å‘˜æƒé™ï¼‰"></a><strong>3. æ‰‹åŠ¨å…³é—­å®‰å…¨æ¨¡å¼ï¼ˆéœ€ç®¡ç†å‘˜æƒé™ï¼‰</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfsadmin -safemode leave</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p><ol><li>NameNode æ£€æŸ¥é›†ç¾¤ä¸­æ•°æ®å—çš„çŠ¶æ€ï¼Œç¡®ä¿è¶³å¤Ÿçš„å‰¯æœ¬å­˜åœ¨ï¼›</li><li>è‹¥æ»¡è¶³æ¡ä»¶ï¼ˆé€šå¸¸ 99.9% ä»¥ä¸Šçš„å—æœ‰è¶³å¤Ÿå‰¯æœ¬ï¼‰ï¼Œå®‰å…¨æ¨¡å¼è‡ªåŠ¨é€€å‡ºï¼›</li><li>è‹¥ä¸æ»¡è¶³æ¡ä»¶ï¼Œéœ€ç­‰å¾…æ•°æ®å—å¤åˆ¶å®Œæˆæˆ–æ‰‹åŠ¨ä¿®å¤ï¼ˆå¦‚æ·»åŠ  DataNodeï¼‰ã€‚</li></ol><h4 id="4-å¼ºåˆ¶é€€å‡ºå®‰å…¨æ¨¡å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰"><a href="#4-å¼ºåˆ¶é€€å‡ºå®‰å…¨æ¨¡å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰" class="headerlink" title="4. å¼ºåˆ¶é€€å‡ºå®‰å…¨æ¨¡å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰"></a><strong>4. å¼ºåˆ¶é€€å‡ºå®‰å…¨æ¨¡å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</strong></h4><p>è‹¥é›†ç¾¤å¤„äºå¼‚å¸¸çŠ¶æ€ï¼ˆå¦‚æ•°æ®å—ä¸¢å¤±ï¼‰ï¼Œä½†ä»éœ€å¼ºåˆ¶å…³é—­å®‰å…¨æ¨¡å¼ï¼Œå¯ä½¿ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfsadmin -safemode forceExit</span><br></pre></td></tr></table></figure><p><strong>é£é™©æç¤º</strong>ï¼šå¼ºåˆ¶é€€å‡ºå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´æˆ–ä¸¢å¤±ï¼Œä»…åœ¨ç´§æ€¥æƒ…å†µä¸‹ä½¿ç”¨ã€‚</p><h4 id="5-è¿›å…¥å®‰å…¨æ¨¡å¼ï¼ˆç”¨äºç»´æŠ¤ï¼‰"><a href="#5-è¿›å…¥å®‰å…¨æ¨¡å¼ï¼ˆç”¨äºç»´æŠ¤ï¼‰" class="headerlink" title="5. è¿›å…¥å®‰å…¨æ¨¡å¼ï¼ˆç”¨äºç»´æŠ¤ï¼‰"></a><strong>5. è¿›å…¥å®‰å…¨æ¨¡å¼ï¼ˆç”¨äºç»´æŠ¤ï¼‰</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfsadmin -safemode enter</span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a><strong>ä¸‰ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</strong></h3><h4 id="1-ä¸Šä¼ æ–‡ä»¶æ—¶æç¤º-â€œå®‰å…¨æ¨¡å¼å¼€å¯â€"><a href="#1-ä¸Šä¼ æ–‡ä»¶æ—¶æç¤º-â€œå®‰å…¨æ¨¡å¼å¼€å¯â€" class="headerlink" title="1. ä¸Šä¼ æ–‡ä»¶æ—¶æç¤º â€œå®‰å…¨æ¨¡å¼å¼€å¯â€"></a><strong>1. ä¸Šä¼ æ–‡ä»¶æ—¶æç¤º â€œå®‰å…¨æ¨¡å¼å¼€å¯â€</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cannot create file/user/hdfs/data.txt. Name node is in safe mode.</span><br></pre></td></tr></table></figure><p><strong>è§£å†³</strong>ï¼šæ‰§è¡Œ<code>hdfs dfsadmin -safemode leave</code>å…³é—­å®‰å…¨æ¨¡å¼ã€‚</p><h4 id="2-å®‰å…¨æ¨¡å¼æ— æ³•è‡ªåŠ¨é€€å‡º"><a href="#2-å®‰å…¨æ¨¡å¼æ— æ³•è‡ªåŠ¨é€€å‡º" class="headerlink" title="2. å®‰å…¨æ¨¡å¼æ— æ³•è‡ªåŠ¨é€€å‡º"></a><strong>2. å®‰å…¨æ¨¡å¼æ— æ³•è‡ªåŠ¨é€€å‡º</strong></h4><p>å¯èƒ½åŸå› ï¼š</p><ul><li>æ•°æ®å—å‰¯æœ¬ä¸è¶³ï¼ŒNameNode æŒç»­ç­‰å¾…å¤åˆ¶å®Œæˆï¼›</li><li>DataNode ä¸ NameNode é€šä¿¡å¼‚å¸¸ï¼ˆæ£€æŸ¥ç½‘ç»œå’Œæ—¥å¿—ï¼‰ã€‚<br><strong>è§£å†³</strong>ï¼š</li></ul><ol><li><p>æ£€æŸ¥æ•°æ®å—çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs fsck /</span><br></pre></td></tr></table></figure></li><li><p>è‹¥æœ‰ä¸¢å¤±å—ï¼Œå°è¯•ä¿®å¤æˆ–é‡æ–°ä¸Šä¼ æ•°æ®ï¼›</p></li><li><p>ç¡®è®¤æ‰€æœ‰ DataNode æ­£å¸¸è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfsadmin -report</span><br></pre></td></tr></table></figure></li></ol><h4 id="3-æƒé™é—®é¢˜"><a href="#3-æƒé™é—®é¢˜" class="headerlink" title="3. æƒé™é—®é¢˜"></a><strong>3. æƒé™é—®é¢˜</strong></h4><p>è‹¥æç¤º<code>Permission denied</code>ï¼Œéœ€ç¡®ä¿å½“å‰ç”¨æˆ·æœ‰æ“ä½œæƒé™ï¼Œæˆ–ä½¿ç”¨<code>hdfs dfs -chmod</code>ä¿®æ”¹æƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">chmod</span> 775 /user/hdfs/dir  <span class="comment"># èµ‹äºˆè¯»å†™æ‰§è¡Œæƒé™</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“-3"><a href="#æ€»ç»“-3" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ul><li><strong>ä¸Šä¼ æ•°æ®</strong>ï¼š<code>hdfs dfs -put &lt;æœ¬åœ°è·¯å¾„&gt; &lt;HDFSè·¯å¾„&gt;</code></li><li><strong>ä¸‹è½½æ•°æ®</strong>ï¼š<code>hdfs dfs -get &lt;HDFSè·¯å¾„&gt; &lt;æœ¬åœ°è·¯å¾„&gt;</code></li><li><strong>å…³é—­å®‰å…¨æ¨¡å¼</strong>ï¼š<code>hdfs dfsadmin -safemode leave</code></li><li><strong>ç»´æŠ¤å»ºè®®</strong>ï¼šå®šæœŸæ£€æŸ¥ HDFS å¥åº·çŠ¶æ€ï¼ˆ<code>hdfs dfsadmin -report</code>ï¼‰ï¼Œç¡®ä¿æ•°æ®å—å‰¯æœ¬æ•°è¾¾æ ‡ï¼Œé¿å…é¢‘ç¹è¿›å…¥å®‰å…¨æ¨¡å¼ã€‚</li></ul><h2 id="12-order-by-å’Œsort-by-çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯"><a href="#12-order-by-å’Œsort-by-çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯" class="headerlink" title="12. order by å’Œsort by çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯?"></a>12. order by å’Œsort by çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯?</h2><p><code>ORDER BY</code> å’Œ <code>SORT BY</code> æ˜¯åœ¨æ•°æ®å¤„ç†å’ŒæŸ¥è¯¢ä¸­ç”¨äºæ’åºçš„æ“ä½œï¼Œä½†å®ƒä»¬åœ¨åŠŸèƒ½ã€åº”ç”¨åœºæ™¯å’Œå®ç°æœºåˆ¶ä¸Šå­˜åœ¨ä¸€äº›åŒºåˆ«ï¼Œä¸‹é¢ä¸ºä½ è¯¦ç»†ä»‹ç»ï¼š</p><h3 id="1-SQL-ä¸­çš„-ORDER-BY"><a href="#1-SQL-ä¸­çš„-ORDER-BY" class="headerlink" title="1. SQL ä¸­çš„ ORDER BY"></a>1. SQL ä¸­çš„ <code>ORDER BY</code></h3><ul><li><p><strong>åŠŸèƒ½</strong>ï¼šå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œå…¨å±€æ’åºï¼Œç¡®ä¿æœ€ç»ˆè¾“å‡ºçš„ç»“æœé›†å®Œå…¨æœ‰åºã€‚</p></li><li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šéœ€è¦æœ€ç»ˆç»“æœä¸¥æ ¼æœ‰åºçš„åœºæ™¯ï¼Œå¦‚ç”ŸæˆæŠ¥è¡¨ã€å¯¼å‡ºæ’åºåçš„æ•°æ®ç­‰ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼š</p><ul><li>å¯¹æ•´ä¸ªç»“æœé›†è¿›è¡Œæ’åºï¼Œå¼€é”€è¾ƒå¤§ã€‚</li><li>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œéœ€è¦å°†æ‰€æœ‰æ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¿›è¡Œæ’åºï¼Œå¯èƒ½å¯¼è‡´æ•°æ®å€¾æ–œå’Œæ€§èƒ½é—®é¢˜ã€‚</li></ul></li><li><p>ç¤ºä¾‹:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-SQL-ä¸­çš„-SORT-BYï¼ˆéƒ¨åˆ†æ•°æ®åº“æ”¯æŒï¼‰"><a href="#2-SQL-ä¸­çš„-SORT-BYï¼ˆéƒ¨åˆ†æ•°æ®åº“æ”¯æŒï¼‰" class="headerlink" title="2. SQL ä¸­çš„ SORT BYï¼ˆéƒ¨åˆ†æ•°æ®åº“æ”¯æŒï¼‰"></a>2. SQL ä¸­çš„ <code>SORT BY</code>ï¼ˆéƒ¨åˆ†æ•°æ®åº“æ”¯æŒï¼‰</h3><ul><li><p><strong>åŠŸèƒ½</strong>ï¼šåœ¨æŸäº›æ•°æ®åº“ï¼ˆå¦‚ Hiveï¼‰ä¸­ï¼Œ<code>SORT BY</code> ç”¨äºåœ¨æ¯ä¸ªåˆ†åŒºå†…è¿›è¡Œæ’åºï¼Œè€Œéå…¨å±€æ’åºã€‚</p></li><li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåœ¨åˆ†å¸ƒå¼å¤„ç†ä¸­ï¼Œä¸éœ€è¦å…¨å±€æ’åºï¼Œä½†éœ€è¦æ¯ä¸ªåˆ†åŒºå†…éƒ¨æœ‰åºçš„åœºæ™¯ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼š</p><ul><li>æ¯ä¸ªåˆ†åŒºç‹¬ç«‹æ’åºï¼Œä¸åŒåˆ†åŒºä¹‹é—´çš„é¡ºåºæ— æ³•ä¿è¯ã€‚</li><li>æ€§èƒ½ä¼˜äº <code>ORDER BY</code>ï¼Œå› ä¸ºä¸éœ€è¦æ•°æ®é›†ä¸­ã€‚</li></ul></li><li><p>ç¤ºä¾‹</p><p>ï¼ˆHive è¯­æ³•ï¼‰ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">DISTRIBUTE <span class="keyword">BY</span> department</span><br><span class="line">SORT <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæŸ¥è¯¢ä¼šå°†æ•°æ®æŒ‰éƒ¨é—¨åˆ†åŒºï¼Œæ¯ä¸ªéƒ¨é—¨å†…æŒ‰è–ªæ°´é™åºæ’åˆ—ã€‚</p></li></ul><h3 id="3-ç¼–ç¨‹è¯­è¨€ä¸­çš„-sort-byï¼ˆå¦‚-Pythonã€Javaï¼‰"><a href="#3-ç¼–ç¨‹è¯­è¨€ä¸­çš„-sort-byï¼ˆå¦‚-Pythonã€Javaï¼‰" class="headerlink" title="3. ç¼–ç¨‹è¯­è¨€ä¸­çš„ sort byï¼ˆå¦‚ Pythonã€Javaï¼‰"></a>3. ç¼–ç¨‹è¯­è¨€ä¸­çš„ <code>sort by</code>ï¼ˆå¦‚ Pythonã€Javaï¼‰</h3><ul><li><p><strong>åŠŸèƒ½</strong>ï¼šåœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ç±»ä¼¼ <code>sort by</code> çš„è¯­æ³•å¯¹é›†åˆæˆ–æ•°æ®ç»“æ„è¿›è¡Œæ’åºã€‚</p></li><li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåœ¨ç¨‹åºä¸­å¯¹å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œæ’åºã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">employees = [</span><br><span class="line">    &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;salary&quot;</span>: <span class="number">5000</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;salary&quot;</span>: <span class="number">6000</span>&#125;</span><br><span class="line">]</span><br><span class="line">sorted_employees = <span class="built_in">sorted</span>(employees, key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;salary&quot;</span>], reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></li></ul><h3 id="4-ä¸»è¦åŒºåˆ«æ€»ç»“"><a href="#4-ä¸»è¦åŒºåˆ«æ€»ç»“" class="headerlink" title="4. ä¸»è¦åŒºåˆ«æ€»ç»“"></a>4. ä¸»è¦åŒºåˆ«æ€»ç»“</h3><table><thead><tr><th><strong>å¯¹æ¯”é¡¹</strong></th><th><strong>ORDER BY</strong></th><th><strong>SORT BY</strong></th></tr></thead><tbody><tr><td><strong>æ’åºèŒƒå›´</strong></td><td>å…¨å±€æ’åº</td><td>åˆ†åŒºå†…æ’åºï¼ˆæ•°æ®åº“ï¼‰æˆ–å±€éƒ¨æ’åºï¼ˆç¼–ç¨‹è¯­è¨€ï¼‰</td></tr><tr><td><strong>æ•°æ®åˆ†å¸ƒ</strong></td><td>éœ€æ”¶é›†æ‰€æœ‰æ•°æ®</td><td>åˆ†åŒºå¤„ç†ï¼Œæ•°æ®æ— éœ€é›†ä¸­</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>ä½ï¼ˆå°¤å…¶åœ¨å¤§æ•°æ®é‡æ—¶ï¼‰</td><td>é«˜</td></tr><tr><td><strong>ç»“æœä¿è¯</strong></td><td>å®Œå…¨æœ‰åº</td><td>åˆ†åŒºå†…æœ‰åºï¼Œå…¨å±€ä¸ä¸€å®šæœ‰åº</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td>ç”Ÿæˆæœ€ç»ˆæŠ¥è¡¨ã€ä¸¥æ ¼æœ‰åºè¾“å‡º</td><td>ä¸­é—´å¤„ç†æ­¥éª¤ã€æå‡æ€§èƒ½</td></tr></tbody></table><h3 id="5-ä½¿ç”¨å»ºè®®"><a href="#5-ä½¿ç”¨å»ºè®®" class="headerlink" title="5. ä½¿ç”¨å»ºè®®"></a>5. ä½¿ç”¨å»ºè®®</h3><ul><li><strong>éœ€è¦å…¨å±€æ’åº</strong>ï¼šä½¿ç”¨ <code>ORDER BY</code>ï¼Œä½†æ³¨æ„å¤§æ•°æ®é‡ä¸‹çš„æ€§èƒ½é—®é¢˜ã€‚</li><li><strong>åˆ†å¸ƒå¼ç¯å¢ƒä¼˜åŒ–</strong>ï¼šä½¿ç”¨ <code>DISTRIBUTE BY + SORT BY</code> æ›¿ä»£ <code>ORDER BY</code>ï¼Œæå‡æ€§èƒ½ã€‚</li><li><strong>ç¼–ç¨‹è¯­è¨€ä¸­æ’åº</strong>ï¼šä½¿ç”¨å†…ç½®çš„æ’åºå‡½æ•°ï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©å‡åºæˆ–é™åºã€‚</li></ul><p>ç†è§£è¿™äº›åŒºåˆ«åï¼Œä½ å¯ä»¥æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„æ’åºæ–¹å¼ï¼Œåœ¨ä¿è¯ç»“æœæ­£ç¡®æ€§çš„åŒæ—¶ä¼˜åŒ–æ€§èƒ½ã€‚</p><h2 id="13-cluster-by-å’Œdistribute-by-çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯"><a href="#13-cluster-by-å’Œdistribute-by-çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯" class="headerlink" title="13. cluster by å’Œdistribute by çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯?"></a>13. cluster by å’Œdistribute by çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯?</h2><p>åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œ<code>CLUSTER BY</code> å’Œ <code>DISTRIBUTE BY</code> æ˜¯ç”¨äºæ§åˆ¶æ•°æ®åˆ†å¸ƒå’Œåˆ†ç»„çš„æ“ä½œï¼Œä¸»è¦åœ¨åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ï¼ˆå¦‚ Hiveã€Spark SQLï¼‰ä¸­ä½¿ç”¨ã€‚å®ƒä»¬çš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p><h3 id="1-DISTRIBUTE-BY-çš„åŠŸèƒ½ä¸åœºæ™¯"><a href="#1-DISTRIBUTE-BY-çš„åŠŸèƒ½ä¸åœºæ™¯" class="headerlink" title="1. DISTRIBUTE BY çš„åŠŸèƒ½ä¸åœºæ™¯"></a><strong>1. <code>DISTRIBUTE BY</code> çš„åŠŸèƒ½ä¸åœºæ™¯</strong></h3><h4 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a><strong>åŠŸèƒ½</strong></h4><ul><li><strong>æ•°æ®åˆ†åŒº</strong>ï¼šå°†æ•°æ®æŒ‰ç…§æŒ‡å®šçš„å­—æ®µåˆ†å‘åˆ°ä¸åŒçš„åˆ†åŒºï¼ˆPartitionï¼‰æˆ–èŠ‚ç‚¹ä¸­ï¼Œç¡®ä¿ç›¸åŒå­—æ®µå€¼çš„æ•°æ®è¢«åˆ†é…åˆ°åŒä¸€ä¸ªåˆ†åŒºã€‚</li><li><strong>ä¸ä¿è¯æ’åº</strong>ï¼šåªæ§åˆ¶æ•°æ®çš„åˆ†å¸ƒï¼Œä¸ä¿è¯åˆ†åŒºå†…æ•°æ®æœ‰åºã€‚</li></ul><h4 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a><strong>åº”ç”¨åœºæ™¯</strong></h4><ul><li><strong>ä¼˜åŒ–åç»­æ“ä½œ</strong>ï¼šä¾‹å¦‚ï¼Œåœ¨æ‰§è¡Œ <code>JOIN</code> æˆ– <code>GROUP BY</code> å‰ï¼Œé€šè¿‡ <code>DISTRIBUTE BY</code> å°†å…³è”é”®ç›¸åŒçš„æ•°æ®åˆ†åˆ°åŒä¸€èŠ‚ç‚¹ï¼Œå‡å°‘æ•°æ®ä¼ è¾“å¼€é”€ã€‚</li><li><strong>ä¸ <code>SORT BY</code> é…åˆ</strong>ï¼šåœ¨æ¯ä¸ªåˆ†åŒºå†…è¿›è¡Œæ’åºï¼ˆéœ€æ­é… <code>SORT BY</code>ï¼‰ã€‚</li></ul><h4 id="ç¤ºä¾‹ï¼ˆHive-è¯­æ³•ï¼‰"><a href="#ç¤ºä¾‹ï¼ˆHive-è¯­æ³•ï¼‰" class="headerlink" title="ç¤ºä¾‹ï¼ˆHive è¯­æ³•ï¼‰"></a><strong>ç¤ºä¾‹ï¼ˆHive è¯­æ³•ï¼‰</strong></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">DISTRIBUTE <span class="keyword">BY</span> department;</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®ä¼šæŒ‰ <code>department</code> å­—æ®µåˆ†å‘åˆ°ä¸åŒåˆ†åŒºï¼Œä½†æ¯ä¸ªåˆ†åŒºå†…çš„æ•°æ®æ˜¯æ— åºçš„ã€‚</li></ul><h3 id="2-CLUSTER-BY-çš„åŠŸèƒ½ä¸åœºæ™¯"><a href="#2-CLUSTER-BY-çš„åŠŸèƒ½ä¸åœºæ™¯" class="headerlink" title="2. CLUSTER BY çš„åŠŸèƒ½ä¸åœºæ™¯"></a><strong>2. <code>CLUSTER BY</code> çš„åŠŸèƒ½ä¸åœºæ™¯</strong></h3><h4 id="åŠŸèƒ½-1"><a href="#åŠŸèƒ½-1" class="headerlink" title="åŠŸèƒ½"></a><strong>åŠŸèƒ½</strong></h4><ul><li><strong>æ•°æ®åˆ†åŒº + æ’åº</strong>ï¼šç›¸å½“äº <code>DISTRIBUTE BY</code> å’Œ <code>SORT BY</code> çš„ç»„åˆï¼Œæ—¢æŒ‰æŒ‡å®šå­—æ®µåˆ†åŒºï¼Œåˆåœ¨æ¯ä¸ªåˆ†åŒºå†…æŒ‰è¯¥å­—æ®µæ’åºã€‚</li><li><strong>ç­‰ä»·å†™æ³•</strong>ï¼š<code>CLUSTER BY col</code> ç­‰ä»·äº <code>DISTRIBUTE BY col SORT BY col</code>ã€‚</li></ul><h4 id="åº”ç”¨åœºæ™¯-1"><a href="#åº”ç”¨åœºæ™¯-1" class="headerlink" title="åº”ç”¨åœºæ™¯"></a><strong>åº”ç”¨åœºæ™¯</strong></h4><ul><li><strong>ç®€åŒ–è¯­æ³•</strong>ï¼šå½“åˆ†åŒºå­—æ®µå’Œæ’åºå­—æ®µç›¸åŒæ—¶ï¼Œä½¿ç”¨ <code>CLUSTER BY</code> æ›´ç®€æ´ã€‚</li><li><strong>æ•°æ®èšç±»</strong>ï¼šä½¿ç›¸åŒå­—æ®µå€¼çš„æ•°æ®èšé›†åœ¨ä¸€èµ·ï¼Œä¸”æœ‰åºæ’åˆ—ï¼Œä¾¿äºåç»­å¤„ç†ã€‚</li></ul><h4 id="ç¤ºä¾‹ï¼ˆHive-è¯­æ³•ï¼‰-1"><a href="#ç¤ºä¾‹ï¼ˆHive-è¯­æ³•ï¼‰-1" class="headerlink" title="ç¤ºä¾‹ï¼ˆHive è¯­æ³•ï¼‰"></a><strong>ç¤ºä¾‹ï¼ˆHive è¯­æ³•ï¼‰</strong></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">CLUSTER <span class="keyword">BY</span> department;</span><br></pre></td></tr></table></figure><ul><li><p>ç­‰ä»·äºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">DISTRIBUTE <span class="keyword">BY</span> department</span><br><span class="line">SORT <span class="keyword">BY</span> department;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”"><a href="#3-æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”" class="headerlink" title="3. æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”"></a><strong>3. æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”</strong></h3><table><thead><tr><th><strong>å¯¹æ¯”é¡¹</strong></th><th><strong>DISTRIBUTE BY</strong></th><th><strong>CLUSTER BY</strong></th></tr></thead><tbody><tr><td><strong>æ•°æ®åˆ†å¸ƒ</strong></td><td>æŒ‰å­—æ®µåˆ†åŒºï¼Œç¡®ä¿ç›¸åŒå€¼åœ¨åŒä¸€åˆ†åŒº</td><td>åŒä¸Š</td></tr><tr><td><strong>åˆ†åŒºå†…æ’åº</strong></td><td>ä¸ä¿è¯æ’åº</td><td>æŒ‰ç›¸åŒå­—æ®µæ’åºï¼ˆå‡åºï¼‰</td></tr><tr><td><strong>è¯­æ³•å¤æ‚åº¦</strong></td><td>éœ€æ­é… <code>SORT BY</code> å®ç°æ’åº</td><td>ä¸€æ­¥å®Œæˆåˆ†åŒºå’Œæ’åºï¼Œæ›´ç®€æ´</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td>ä¼˜åŒ– <code>JOIN</code>ã€åˆ†åŒºåè‡ªå®šä¹‰æ’åº</td><td>æ•°æ®èšç±»ã€ç®€åŒ–è¯­æ³•</td></tr></tbody></table><h3 id="4-ä½¿ç”¨å»ºè®®"><a href="#4-ä½¿ç”¨å»ºè®®" class="headerlink" title="4. ä½¿ç”¨å»ºè®®"></a><strong>4. ä½¿ç”¨å»ºè®®</strong></h3><ol><li><p><strong>åªéœ€åˆ†åŒº</strong>ï¼šä½¿ç”¨ <code>DISTRIBUTE BY</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">DISTRIBUTE <span class="keyword">BY</span> department</span><br><span class="line">SORT <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;  <span class="comment">-- åˆ†åŒºåæŒ‰è–ªæ°´æ’åº</span></span><br></pre></td></tr></table></figure></li><li><p><strong>åˆ†åŒº + æ’åºï¼ˆå­—æ®µç›¸åŒï¼‰</strong>ï¼šä½¿ç”¨ <code>CLUSTER BY</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">CLUSTER <span class="keyword">BY</span> department;  <span class="comment">-- æŒ‰éƒ¨é—¨åˆ†åŒºå¹¶æ’åº</span></span><br></pre></td></tr></table></figure></li><li><p><strong>åˆ†åŒº + æ’åºï¼ˆå­—æ®µä¸åŒï¼‰</strong>ï¼šä½¿ç”¨ <code>DISTRIBUTE BY + SORT BY</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line">DISTRIBUTE <span class="keyword">BY</span> department</span><br><span class="line">SORT <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;  <span class="comment">-- æŒ‰éƒ¨é—¨åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºå†…æŒ‰è–ªæ°´æ’åº</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="5-æ€§èƒ½è€ƒè™‘"><a href="#5-æ€§èƒ½è€ƒè™‘" class="headerlink" title="5. æ€§èƒ½è€ƒè™‘"></a><strong>5. æ€§èƒ½è€ƒè™‘</strong></h3><ul><li><strong>æ•°æ®å€¾æ–œ</strong>ï¼šè‹¥å­—æ®µå€¼åˆ†å¸ƒä¸å‡ï¼ˆå¦‚ <code>department</code> ä¸­æŸéƒ¨é—¨æ•°æ®è¿‡å¤šï¼‰ï¼Œå¯èƒ½å¯¼è‡´éƒ¨åˆ†åˆ†åŒºå¤„ç†å‹åŠ›è¿‡å¤§ã€‚</li><li><strong>åˆ†å¸ƒå¼è®¡ç®—</strong>ï¼šåˆç†ä½¿ç”¨ <code>DISTRIBUTE BY</code> å¯å‡å°‘ <code>SHUFFLE</code> å¼€é”€ï¼Œä½†è¿‡åº¦åˆ†åŒºä¼šå¢åŠ ä»»åŠ¡æ•°ã€‚</li></ul><h3 id="æ€»ç»“-4"><a href="#æ€»ç»“-4" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ul><li><strong>DISTRIBUTE BY</strong>ï¼šä¸“æ³¨äºæ•°æ®åˆ†åŒºï¼Œé€‚ç”¨äºä¼˜åŒ–æ•°æ®åˆ†å¸ƒã€‚</li><li><strong>CLUSTER BY</strong>ï¼šåˆ†åŒº + æ’åºä¸€æ­¥åˆ°ä½ï¼Œé€‚ç”¨äºç®€åŒ–è¯­æ³•å’Œæ•°æ®èšç±»ã€‚</li></ul><p>æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©ï¼Œè‹¥éœ€è‡ªå®šä¹‰æ’åºè§„åˆ™æˆ–åˆ†åŒºä¸æ’åºå­—æ®µä¸åŒï¼Œä½¿ç”¨ <code>DISTRIBUTE BY + SORT BY</code>ï¼›å¦åˆ™ä½¿ç”¨ <code>CLUSTER BY</code> æ›´é«˜æ•ˆã€‚</p><p>â€‹                               </p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hive</title>
      <link href="/2025/06/27/Hive/"/>
      <url>/2025/06/27/Hive/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯HIVE"><a href="#ä»€ä¹ˆæ˜¯HIVE" class="headerlink" title="ä»€ä¹ˆæ˜¯HIVE"></a>ä»€ä¹ˆæ˜¯HIVE</h1><p>Hive æ˜¯<strong>åŸºäº Hadoop çš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…·</strong>ã€‚ä»¥ä¸‹æ˜¯å…·ä½“ä»‹ç»:</p><ul><li><strong>åŠŸèƒ½ç‰¹ç‚¹</strong>ï¼šHive å¯ä»¥<strong>å°†ç»“æ„åŒ–çš„æ•°æ®æ–‡ä»¶æ˜ å°„ä¸ºä¸€å¼ æ•°æ®åº“è¡¨</strong>ï¼Œå¹¶æä¾›å®Œæ•´çš„ SQL æŸ¥è¯¢åŠŸèƒ½ï¼Œèƒ½å°† SQL è¯­å¥è½¬æ¢ä¸º MapReduce ä»»åŠ¡è¿›è¡Œè¿è¡Œã€‚å®ƒå…è®¸ç†Ÿæ‚‰ SQL çš„ç”¨æˆ·æ–¹ä¾¿åœ°æŸ¥è¯¢æ•°æ®ï¼Œä¹Ÿæ”¯æŒç†Ÿæ‚‰ MapReduce çš„å¼€å‘è€…è‡ªå®šä¹‰ mapper å’Œ reducerï¼Œä»¥å¤„ç†å¤æ‚çš„åˆ†æå·¥ä½œã€‚</li><li><strong>ä¼˜åŠ¿</strong>ï¼šå­¦ä¹ æˆæœ¬ä½ï¼Œé€šè¿‡ç±» SQL è¯­å¥å¯å¿«é€Ÿå®ç°ç®€å•çš„ MapReduce ç»Ÿè®¡ï¼Œæ— éœ€å¼€å‘ä¸“é—¨çš„ MapReduce åº”ç”¨ï¼Œååˆ†é€‚åˆæ•°æ®ä»“åº“çš„ç»Ÿè®¡åˆ†æã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¸¸ç”¨äºå¯¹æ—¶æ•ˆæ€§è¦æ±‚ä¸é«˜çš„æ•°æ®åˆ†æåœºæ™¯ã€‚ç”±äº <strong>Hive åº•å±‚ä¾èµ– Hadoop çš„ HDFS å­˜å‚¨æ•°æ®</strong>ï¼Œåˆ©ç”¨ MapReduce è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤èƒ½å¤Ÿå¤„ç†å¤§è§„æ¨¡çš„æ•°æ®ï¼Œåœ¨å¤„ç†æµ·é‡ç»“æ„åŒ–æ—¥å¿—çš„æ•°æ®ç»Ÿè®¡ç­‰æ–¹é¢åº”ç”¨å¹¿æ³›ã€‚</li><li><strong>ä¸æ•°æ®åº“çš„åŒºåˆ«</strong>ï¼š<ol><li>æ•°æ®åº“ä¸€èˆ¬ç”¨äºåœ¨çº¿åº”ç”¨ï¼Œæ”¯æŒå¯¹æŸä¸€è¡Œæˆ–æŸäº›è¡Œæ•°æ®çš„æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œï¼Œé‡‡ç”¨ â€œå†™æ—¶æ¨¡å¼â€ï¼Œæ•°æ®åŠ è½½æ…¢ä½†æŸ¥è¯¢å¿«ã€‚</li><li>è€Œ Hive ä¸æ”¯æŒå¯¹å…·ä½“è¡Œçš„æ“ä½œï¼Œä¹Ÿä¸æ”¯æŒäº‹åŠ¡å’Œç´¢å¼•ï¼Œé‡‡ç”¨ â€œè¯»æ—¶æ¨¡å¼â€ï¼Œé€‚åˆå¤„ç†éç»“æ„åŒ–æˆ–å­˜å‚¨æ¨¡å¼æœªçŸ¥çš„æ•°æ®ï¼Œæ›´ä¾§é‡äºå¯¹æµ·é‡æ•°æ®çš„æ‰¹é‡å¤„ç†å’Œåˆ†æã€‚</li></ol></li></ul><h1 id="HIVEå®‰è£…"><a href="#HIVEå®‰è£…" class="headerlink" title="HIVEå®‰è£…"></a><a href="Hadoop.md#HIVE%E5%AE%89%E8%A3%85">HIVEå®‰è£…</a></h1><h2 id="é…ç½®mysqlå®‰è£…æº"><a href="#é…ç½®mysqlå®‰è£…æº" class="headerlink" title="é…ç½®mysqlå®‰è£…æº"></a>é…ç½®mysqlå®‰è£…æº</h2><p>ï¼ˆåœ¨çº¿å®‰è£…æ–¹æ³•ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸‹è½½å®‰è£…æº</span></span><br><span class="line">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… mysql æº</span></span><br><span class="line">yum localinstall mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="comment"># å¯¼å…¥key</span></span><br><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br><span class="line"><span class="comment"># ä¿®æ”¹å›½å†…æº</span></span><br><span class="line">vim /etc/yum.repos.d/mysql-community.repo</span><br><span class="line">ä¿®æ”¹ baseurl ä¸º https://mirrors.cloud.tencent.com/mysql/yum/mysql-5.7-community-el7-x86_64/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…mysql</span></span><br><span class="line">yum install -y mysql-community-server</span><br></pre></td></tr></table></figure><ol><li>å®‰è£…mysql ï¼ˆæœ¬åœ°å®‰è£…æ–¹æ³•ï¼‰</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">00#rpmåŒ…å®‰è£…</span><br><span class="line"><span class="comment">#tar -zvxf mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz  -C /usr/local/mysql</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.è§£å‹ï¼š</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line">tar -zxvf mysql-5.7.22-linux-glibc2.12-x86_64.tar</span><br><span class="line"><span class="built_in">mv</span> mysql-5.7.22-linux-glibc2.12-x86_64 mysql-5.7.22</span><br><span class="line"><span class="built_in">ln</span> -s mysql-5.7.22 mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.æ·»åŠ ç”¨æˆ·ç»„å’Œç”¨æˆ·</span></span><br><span class="line"><span class="comment">#æ·»åŠ ç”¨æˆ·ç»„</span></span><br><span class="line">groupadd mysql</span><br><span class="line"><span class="comment">#æ·»åŠ ç”¨æˆ·mysql åˆ°ç”¨æˆ·ç»„mysql</span></span><br><span class="line">useradd -g mysql mysql</span><br><span class="line"><span class="comment">#4.å®‰è£…</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/mysql</span><br><span class="line"><span class="built_in">mkdir</span> data</span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql ./</span><br><span class="line">./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql/m<span class="string">&#x27;y&#x27;</span>s<span class="string">&#x27;q --datadir=/usr/local/mysql/data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#å°†mysql/ç›®å½•ä¸‹é™¤äº†data/ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ”¹å›rootç”¨æˆ·æ‰€æœ‰</span></span><br><span class="line"><span class="string">chown -R root .</span></span><br><span class="line"><span class="string">#mysqlç”¨æˆ·åªéœ€ä½œä¸ºmysql-5.7.22/data/ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰è€…</span></span><br><span class="line"><span class="string">chown -R mysql data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#5.å¤åˆ¶å¯åŠ¨æ–‡ä»¶</span></span><br><span class="line"><span class="string">cp support-files/mysql.server /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">chmod 755 /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">cp bin/my_print_defaults /usr/bin/ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.ä¿®æ”¹å¯åŠ¨è„šæœ¬</span></span><br><span class="line"><span class="string">vi /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">#ä¿®æ”¹é¡¹ï¼š</span></span><br><span class="line"><span class="string">basedir=/usr/local/mysql-5.7.22/</span></span><br><span class="line"><span class="string">datadir=/usr/local/mysql-5.7.22/data</span></span><br><span class="line"><span class="string">port=3306</span></span><br><span class="line"><span class="string">#åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘ /etc/profileï¼Œè¿™æ ·å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç”¨mysqlå‘½ä»¤äº†</span></span><br><span class="line"><span class="string">vi ~/.bash_profile</span></span><br><span class="line"><span class="string">#æ·»åŠ mysqlè·¯å¾„ï¼ŒåŠ å…¥ä¸‹é¢å†…å®¹ï¼ŒæŒ‰ESC--&gt;:wqä¿å­˜</span></span><br><span class="line"><span class="string">export PATH=$PATH:/usr/local/mysql-5.7.22/bin</span></span><br><span class="line"><span class="string">#åˆ·æ–°ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="string">source ~/.bash_profile</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#7.ä¿®æ”¹mysqlé…ç½®é¡¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vi /etc/my.cnf</span></span><br><span class="line"><span class="string">#é…ç½®å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string">basedir = /usr/local/mysql</span></span><br><span class="line"><span class="string">datadir = /usr/local/mysql/data</span></span><br><span class="line"><span class="string">socket = /tmp/mysql.sock</span></span><br><span class="line"><span class="string">user = mysql</span></span><br><span class="line"><span class="string">tmpdir = /tmp</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld_safe]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">log-error = /usr/local/mysql/data/error.log</span></span><br><span class="line"><span class="string">pid-file = /usr/local/mysql/data/mysql.pid</span></span><br><span class="line"><span class="string">#!includedir /etc/my.cnf.d</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#8.å¯åŠ¨mysql</span></span><br><span class="line"><span class="string">service mysqld start</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#å¦‚å¯åŠ¨å¤±è´¥ï¼Œåˆ é™¤ /usr/local/mysql-5.7.22/dataä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œé‡æ–°æ‰§è¡Œ./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/dataï¼Œå†å¯åŠ¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#9.è¿›å…¥mysqlä¿®æ”¹åˆå§‹å¯†ç ï¼Œä¿®æ”¹è¿œç¨‹è¿æ¥çš„ç”¨æˆ·æƒé™é—®é¢˜</span></span><br><span class="line"><span class="string">mysql -uroot -p</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ALTER USER &#x27;</span>root<span class="string">&#x27;@&#x27;</span>localhost<span class="string">&#x27; IDENTIFIED BY &#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">use mysql;</span></span><br><span class="line"><span class="string">UPDATE user SET host=&#x27;</span>%<span class="string">&#x27; WHERE user=&#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">flush privileges;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#å¼€æœºè‡ªå¯åŠ¨</span></span><br><span class="line"><span class="string">chkconfig --add mysqld</span></span><br><span class="line"><span class="string">chkconfig mysqld on</span></span><br><span class="line"><span class="string">chkconfig --list</span></span><br><span class="line"><span class="string">  mysqld          0:å…³    1:å…³    2:å¼€    3:å¼€    4:å¼€    5:å¼€    6:å…³</span></span><br></pre></td></tr></table></figure><ol><li>é…ç½®mysql</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¯åŠ¨mysql æœåŠ¡</span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"><span class="comment">#è®¾ç½®å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld</span><br><span class="line"><span class="comment"># é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="comment"># å…³é—­å¯†ç éªŒè¯</span></span><br><span class="line">vim /etc/my.cnf</span><br><span class="line"><span class="comment"># mysqldé€‰é¡¹ä¸‹åŠ å…¥</span></span><br><span class="line">validate_password=OFF</span><br><span class="line"><span class="comment">#é‡å¯mysqlæœåŠ¡</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="comment"># å¾—åˆ°ä¸´æ—¶å¯†ç </span></span><br><span class="line">grep <span class="string">&#x27;temporary password&#x27;</span> /var/log/mysqld.log</span><br><span class="line"><span class="comment">#ç™»å½•mysql</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="comment"># å¼€å‘ç¯å¢ƒ ä¿®æ”¹å¯†ç ä¸ºroot</span></span><br><span class="line">ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="comment">#ä¿®æ”¹rootè´¦å·ç™»å½•é™åˆ¶</span></span><br><span class="line">use mysql;</span><br><span class="line">UPDATE user SET host=<span class="string">&#x27;%&#x27;</span> WHERE user=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">flush privileges; </span><br><span class="line"><span class="comment">#åˆ›å»ºmetastoreå…ƒæ•°æ®åº“</span></span><br><span class="line">create database metastore</span><br><span class="line">DEFAULT CHARACTER SET utf8</span><br><span class="line">DEFAULT COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…HIVE"><a href="#å®‰è£…HIVE" class="headerlink" title="å®‰è£…HIVE"></a>å®‰è£…HIVE</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å‹apache-hive-3.1.2-bin.tar.gzåˆ°/opt/module/ç›®å½•ä¸‹é¢</span></span><br><span class="line">   tar -zxvf apache-hive-3.1.2-bin.tar.gz -C /opt/module/</span><br><span class="line"><span class="comment">#ä¿®æ”¹`/etc/profile.d/my_env.sh`ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡</span></span><br><span class="line">   vim /etc/profile.d/my_env.sh</span><br><span class="line"><span class="comment">#æ·»åŠ å†…å®¹</span></span><br><span class="line"><span class="comment">#HIVE_HOME</span></span><br><span class="line">   <span class="built_in">export</span> HIVE_HOME=/opt/module/apache-hive-3.1.2-bin</span><br><span class="line">   <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br><span class="line"><span class="comment">#åˆ·æ–°ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><ol><li>hiveåŸºç¡€é…ç½®</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å†³æ—¥å¿—JaråŒ…å†²çª</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.10.0.jar <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.10.0.bak</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‹·è´mysql-connector.jaråˆ°libåº“</span></span><br><span class="line"><span class="built_in">cp</span> /opt/software/mysql-connector-java-5.1.27-bin.jar <span class="variable">$HIVE_HOME</span>/lib</span><br></pre></td></tr></table></figure><ol><li><p>é…ç½®hive-site.xml</p><p>æŒ‘è½¬åˆ°<code>/opt/module/apache-hive-3.1.2-bin/conf/</code>ç›®å½•æ–°å»ºæ–‡ä»¶ hive-site.xml</p></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„URL--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://hadoop100:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„Driver--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„username--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„password--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Hiveå…ƒæ•°æ®å­˜å‚¨ç‰ˆæœ¬çš„éªŒè¯--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å…ƒæ•°æ®å­˜å‚¨æˆæƒ--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Hiveé»˜è®¤åœ¨HDFSçš„å·¥ä½œç›®å½•--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.enable.doAs<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å–æ¶ˆæœ¬åœ°æ¨¡å¼æ”¹ä¸ºfalse--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.mode.local.auto<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.map.child.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx2048m<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>åˆå§‹åŒ–Hiveå…ƒæ•°æ®åº“</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql -verbose</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–mapreduce"><a href="#ä¼˜åŒ–mapreduce" class="headerlink" title="ä¼˜åŒ–mapreduce"></a>ä¼˜åŒ–mapreduce</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure><p>å¢åŠ é…ç½®</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1536<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx1024M<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3072<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx2560M<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®beeline"><a href="#é…ç½®beeline" class="headerlink" title="é…ç½®beeline"></a>é…ç½®beeline</h2><p>é…ç½®core-site.xml ä½¿å…¶ä»»æ„èŠ‚ç‚¹éƒ½å¯ä»¥è®¿é—®hadoop</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;*&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;*&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><ol><li>å¯åŠ¨ hiveserver2</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å‰ç«¯å¯åŠ¨</span></span><br><span class="line">hiveserver2</span><br><span class="line"><span class="comment">#åå°å¯åŠ¨</span></span><br><span class="line"><span class="built_in">nohup</span> hiveserver2 &amp;</span><br></pre></td></tr></table></figure><ol><li>ç™»å½•å‘½ä»¤</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beeline -u jdbc:hive2://localhost:10000 -n root -p 123456 [å¯†ç éšæ„]</span><br><span class="line">beeline -u jdbc:hive2://localhost:10000 -n root -p 123456  -e <span class="string">&#x27;show tables;&#x27;</span> </span><br></pre></td></tr></table></figure><ol><li>dbeaverç™»å½•</li></ol><ul><li>è·å–æ–‡ä»¶ hadoop-common-3.1.3.jar</li><li>è·å–æ–‡ä»¶ hive-jdbc-3.1.2-standalone.jar</li><li>æ·»åŠ hiveæ•°æ®åº“é“¾æ¥</li></ul><h1 id="hive-æ•°æ®æ“ä½œè¯­å¥"><a href="#hive-æ•°æ®æ“ä½œè¯­å¥" class="headerlink" title="hive æ•°æ®æ“ä½œè¯­å¥"></a><strong>hive</strong> æ•°æ®æ“ä½œè¯­å¥</h1><h2 id="å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥"><a href="#å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥" class="headerlink" title="å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥"></a>å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥çœ‹æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">show</span>  database db_hive</span><br><span class="line"><span class="comment">--è¿‡æ»¤æŸ¥çœ‹æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">show</span> databases <span class="keyword">like</span> <span class="string">&#x27;db_hive*&#x27;</span>;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¯¦æƒ…</span></span><br><span class="line"><span class="keyword">desc</span> database db_hive</span><br><span class="line"><span class="keyword">desc</span> database extended db_hive;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¡¨</span></span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¡¨åˆ—è¯¦æƒ…</span></span><br><span class="line"><span class="keyword">desc</span> dept;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¡¨æ‰€æœ‰è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">desc</span> extended emp;</span><br><span class="line"><span class="keyword">show</span> formatted emp;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹åˆ†åŒºä¿¡æ¯</span></span><br><span class="line"><span class="keyword">show</span> partitions emp;</span><br></pre></td></tr></table></figure><h2 id="å»ºåº“æ“ä½œ"><a href="#å»ºåº“æ“ä½œ" class="headerlink" title="å»ºåº“æ“ä½œ"></a>å»ºåº“æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºæ•°æ®åº“</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] database_name</span><br><span class="line">[COMMENT database_comment]</span><br><span class="line">[LOCATION hdfs_path]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å»ºè¡¨æ“ä½œ"><a href="#å»ºè¡¨æ“ä½œ" class="headerlink" title="å»ºè¡¨æ“ä½œ"></a>å»ºè¡¨æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name <span class="comment">--å†…éƒ¨è¡¨</span></span><br><span class="line">[(col_name data_type [COMMENT col_comment], ...)] <span class="comment">--æ•°æ®ç±»å‹ </span></span><br><span class="line">[COMMENT table_comment] </span><br><span class="line">[PARTITIONED <span class="keyword">BY</span> (col_name data_type [COMMENT col_comment], ...)] <span class="comment">--åˆ†åŒºè¡¨</span></span><br><span class="line">[CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) </span><br><span class="line">[SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], ...)] <span class="keyword">INTO</span> num_buckets BUCKETS] <span class="comment">--åˆ†æ¡¶è¡¨</span></span><br><span class="line">[<span class="type">ROW</span> FORMAT DELIMITED <span class="comment">--æ•°æ®æ ¼å¼</span></span><br><span class="line">[FIELDS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--åˆ—åˆ†éš”</span></span><br><span class="line">[COLLECTION ITEMS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--å¤åˆæ•°æ®itemåˆ†éš”</span></span><br><span class="line">[MAP KEYS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--å¤åˆæ•°æ®keyåˆ†éš”</span></span><br><span class="line">[LINES TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]] <span class="comment">--è¡Œåˆ†éš”</span></span><br><span class="line">[STORED <span class="keyword">AS</span> file_format] <span class="comment">--å‹ç¼©æ ¼å¼</span></span><br><span class="line">[LOCATION hdfs_path] <span class="comment">--è¡¨æ•°æ®æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">[TBLPROPERTIES (property_name<span class="operator">=</span>property_value, ...)] <span class="comment">--å†…å¤–éƒ¨è¡¨è½¬æ¢</span></span><br><span class="line">[<span class="keyword">AS</span> select_statement]</span><br></pre></td></tr></table></figure><h2 id="ä¸Šä¼ æ•°æ®"><a href="#ä¸Šä¼ æ•°æ®" class="headerlink" title="ä¸Šä¼ æ•°æ®"></a>ä¸Šä¼ æ•°æ®</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--load</span></span><br><span class="line">load data [<span class="keyword">local</span>] inpath <span class="string">&#x27;æ•°æ®çš„path&#x27;</span> [overwrite] <span class="keyword">into</span> <span class="keyword">table</span> student [<span class="keyword">partition</span> (partcol1<span class="operator">=</span>val1,â€¦)];</span><br><span class="line"></span><br><span class="line"><span class="comment">--ä¸Šä¼ hdfs</span></span><br><span class="line">dfs <span class="operator">-</span>put <span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>hive<span class="operator">/</span>datas<span class="operator">/</span>student.txt <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>atguigu<span class="operator">/</span>hive;</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span>  student_par <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;wangwu&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;zhaoliu&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¦†ç›–æ’å…¥å¹¶ä¸”ä½¿ç”¨ç»“æœé›†è¿›è¡Œæ’å…¥</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> student_par <span class="keyword">select</span> id, name <span class="keyword">from</span> student ;</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½æ•°æ®"><a href="#ä¸‹è½½æ•°æ®" class="headerlink" title="ä¸‹è½½æ•°æ®"></a>ä¸‹è½½æ•°æ®</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;æ•°æ®çš„path&#x27;</span></span><br><span class="line"><span class="type">ROW</span> FORMAT DELIMITED FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\t&#x27;</span> dql_command;</span><br><span class="line"></span><br><span class="line"><span class="comment">--hadoop å¯¼å‡º</span></span><br><span class="line">dfs <span class="operator">-</span><span class="keyword">get</span> <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>hive<span class="operator">/</span>warehouse<span class="operator">/</span>student<span class="operator">/</span>student.txt</span><br><span class="line"><span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>datas<span class="operator">/</span>export<span class="operator">/</span>student3.txt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--hive shellå¯¼å‡º</span></span><br><span class="line">bin<span class="operator">/</span>hive <span class="operator">-</span>e <span class="string">&#x27;select * from default.student;&#x27;</span> <span class="operator">&gt;</span></span><br><span class="line"><span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>hive<span class="operator">/</span>datas<span class="operator">/</span>export<span class="operator">/</span>student4.txt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--exportå¯¼å‡º</span></span><br><span class="line"> export <span class="keyword">table</span> default.student <span class="keyword">to</span></span><br><span class="line"> <span class="string">&#x27;/user/hive/warehouse/export/student&#x27;</span>; </span><br></pre></td></tr></table></figure><h2 id="selectè¯­å¥"><a href="#selectè¯­å¥" class="headerlink" title="selectè¯­å¥"></a>selectè¯­å¥</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>] select_expr, select_expr, ...</span><br><span class="line">Â Â <span class="keyword">FROM</span> table_reference</span><br><span class="line">Â Â [<span class="keyword">WHERE</span> where_condition]</span><br><span class="line">Â Â [<span class="keyword">GROUP</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">Â Â [<span class="keyword">ORDER</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">Â Â [CLUSTER <span class="keyword">BY</span> col_list</span><br><span class="line">Â Â Â Â <span class="operator">|</span> [DISTRIBUTE <span class="keyword">BY</span> col_list] [SORT <span class="keyword">BY</span> col_list]</span><br><span class="line">Â Â ]</span><br><span class="line">Â [LIMIT number]</span><br></pre></td></tr></table></figure><h1 id="Hiveå¤åˆæ•°æ®ç±»å‹"><a href="#Hiveå¤åˆæ•°æ®ç±»å‹" class="headerlink" title="Hiveå¤åˆæ•°æ®ç±»å‹"></a>Hiveå¤åˆæ•°æ®ç±»å‹</h1><ul><li><p><strong>æ•°ç»„array</strong>: <strong>array&lt;valueæ•°æ®ç±»å‹&gt;</strong></p><ol><li>ç›¸åŒæ•°æ®ç±»å‹</li><li>æœ‰åºçš„æ’åˆ—</li><li>ä¸‹æ ‡ä¸ºæ•°å­—</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥è¯¢å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span>  a_score[<span class="number">0</span>] <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ„é€ å¤åˆæ•°æ®-array</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">array</span>(å€¼,å€¼) <span class="keyword">from</span> student</span><br></pre></td></tr></table></figure></li><li><p><strong>é›†åˆstruct</strong>:                         <strong>struct&lt;keyå€¼:valueæ•°æ®ç±»å‹,keyå€¼:valueæ•°æ®ç±»å‹&gt;</strong></p><ol><li><p>é¢„å®šä¹‰ä¸ªæ•°</p></li><li><p>é¢„å®šä¹‰é¡ºåº</p></li><li><p>keyé¢„å®šä¹‰</p></li><li><p>æ•°æ®ç±»å‹å¯ä¸åŒ</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥è¯¢å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span>  s_score.chinese <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ„é€ å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> named_struct(key,<span class="keyword">value</span>,key,<span class="keyword">value</span>)</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure></li><li><p><strong>å­—å…¸map</strong>:                              <strong>map&lt;keyæ•°æ®ç±»å‹,valueæ•°æ®ç±»å‹&gt;</strong></p><ol><li><p>æ ‡å‡†å­—å…¸ç±»å‹</p></li><li><p>keyè‡ªå®šä¹‰</p></li><li><p>æ•°æ®ç±»å‹å¯ä¸åŒ</p></li><li><p>ä¸ªæ•°ä¸é™</p></li></ol>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥è¯¢å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span>  m_score[<span class="string">&#x27;è¯­æ–‡&#x27;</span>] <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ„é€ å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> map(key,<span class="keyword">value</span>,key,<span class="keyword">value</span>)</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure><h2 id="hive-å†…ç½®å‡½æ•°"><a href="#hive-å†…ç½®å‡½æ•°" class="headerlink" title="hive å†…ç½®å‡½æ•°"></a><strong>hive</strong> å†…ç½®å‡½æ•°</h2>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">show</span> functions;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºè‡ªå¸¦çš„å‡½æ•°çš„ç”¨æ³•</span></span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">function</span> upper;</span><br><span class="line"><span class="comment">-- è¯¦ç»†æ˜¾ç¤ºè‡ªå¸¦çš„å‡½æ•°çš„ç”¨æ³•</span></span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">function</span> extended upper;</span><br></pre></td></tr></table></figure></li></ul><h1 id="pythonè¿æ¥hive"><a href="#pythonè¿æ¥hive" class="headerlink" title="pythonè¿æ¥hive"></a>pythonè¿æ¥hive</h1><h2 id="linuxç¯å¢ƒå®‰è£…python"><a href="#linuxç¯å¢ƒå®‰è£…python" class="headerlink" title="linuxç¯å¢ƒå®‰è£…python"></a>linuxç¯å¢ƒå®‰è£…python</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½å®‰è£…åŒ… æˆ–ä¸Šä¼ å®‰è£…åŒ…</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.9.9/Python-3.9.9.tgz</span><br><span class="line"><span class="comment"># è§£å‹</span></span><br><span class="line">tar -zxvf Python-3.9.10.tgz -C /opt/module/</span><br><span class="line"><span class="comment"># æ”¯æ’‘åŒ…</span></span><br><span class="line">yum install openssl-devel libffi-devel bzip2-devel gcc gcc-c++ wget -y</span><br><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">./configure --enable-optimizations</span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">make altinstall</span><br></pre></td></tr></table></figure><h3 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line">vim  /etc/profile.d/my_env.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$PATH</span>:/opt/python39/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæ•ˆ ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æˆ–è€…è¿›è¡Œè½¯è¿æ¥ é…ç½® </span></span><br><span class="line"><span class="built_in">cp</span> libpython3.9.a  /usr/lib64/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">ln</span> -s /root/software/python3.9/Python-3.9.10/python /usr/bin/python3</span><br><span class="line"><span class="built_in">ln</span> -s /opt/module/Python-3.9.10/python /usr/bin/python3</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…pyhiveåº“"><a href="#å®‰è£…pyhiveåº“" class="headerlink" title="å®‰è£…pyhiveåº“"></a>å®‰è£…pyhiveåº“</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pip3 install  -i https://mirrors.aliyun.com/pypi/simple/  thrift</span><br><span class="line">pip3 install  -i https://mirrors.aliyun.com/pypi/simple/  thrift-sasl</span><br><span class="line">pip3 install   -i https://mirrors.aliyun.com/pypi/simple/ PyHive</span><br><span class="line">pip3 install   -i https://mirrors.aliyun.com/pypi/simple/ PyM</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyhive <span class="keyword">import</span> hive</span><br><span class="line">conn=hive.connect(host=<span class="string">&#x27;localhost&#x27;</span>,port=<span class="number">10000</span>,username=<span class="string">&#x27;root&#x27;</span>,database=<span class="string">&#x27;db_hive&#x27;</span>)</span><br><span class="line">cursor=conn.cursor()</span><br><span class="line">sql=<span class="string">&#x27;show tables&#x27;</span></span><br><span class="line">cursor.execute(sql)</span><br><span class="line"><span class="built_in">print</span>(cursor.fetchall())</span><br></pre></td></tr></table></figure><h1 id="åˆ†åŒºè¡¨"><a href="#åˆ†åŒºè¡¨" class="headerlink" title="åˆ†åŒºè¡¨"></a>åˆ†åŒºè¡¨</h1><ul><li><p>åˆ†åŒºæ˜¯å°†ä¸€ä¸ªè¡¨æˆ–ç´¢å¼•ç‰©ç†åœ°åˆ†è§£ä¸ºå¤šä¸ªæ›´å°ã€æ›´å¯ç®¡ç†çš„éƒ¨åˆ†ã€‚</p></li><li><p>åˆ†åŒºå¯¹åº”ç”¨é€æ˜ï¼Œå³å¯¹è®¿é—®æ•°æ®åº“çš„åº”ç”¨è€Œè¨€ï¼Œé€»è¾‘ä¸Šè®²åªæœ‰ä¸€ä¸ªè¡¨æˆ–ä¸€ä¸ªç´¢å¼•ï¼ˆç›¸å½“äºåº”ç”¨â€œçœ‹åˆ°â€çš„åªæ˜¯ä¸€ä¸ªè¡¨æˆ–ç´¢å¼•ï¼‰ï¼Œä½†åœ¨ç‰©ç†ä¸Šè¿™ä¸ªè¡¨æˆ–ç´¢å¼•å¯èƒ½ç”±æ•°åä¸ªç‰©ç†åˆ†åŒºç»„æˆã€‚</p></li></ul><h2 id="åˆ†åŒºåº”ç”¨åœºæ™¯"><a href="#åˆ†åŒºåº”ç”¨åœºæ™¯" class="headerlink" title="åˆ†åŒºåº”ç”¨åœºæ™¯"></a>åˆ†åŒºåº”ç”¨åœºæ™¯</h2><p><img src="/Hadoop/image-20250701152059542.png" alt="image-20250701152059542"></p><h2 id="oracleåˆ†åŒºè¡¨ç§ç±»"><a href="#oracleåˆ†åŒºè¡¨ç§ç±»" class="headerlink" title="oracleåˆ†åŒºè¡¨ç§ç±»"></a><strong>oracle</strong>åˆ†åŒºè¡¨ç§ç±»</h2><ol><li><strong>èŒƒå›´åˆ†åŒº</strong>(range)</li><li><strong>åˆ—è¡¨åˆ†åŒº</strong>(list)</li><li><strong>æ•£åˆ—åˆ†åŒº</strong>(hash)</li><li><strong>ç»„åˆç»„åˆåˆ†åŒº</strong>(subpartition)</li></ol><h2 id="oracleåˆ†åŒº-èŒƒå›´åˆ†åŒº"><a href="#oracleåˆ†åŒº-èŒƒå›´åˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-èŒƒå›´åˆ†åŒº"></a><em>oracle</em>åˆ†åŒº-èŒƒå›´åˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> ORDER_ACTIVITIES   </span><br><span class="line">(  ORDER_ID      NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span>,   </span><br><span class="line">    ORDER_DATE    <span class="type">DATE</span>,   </span><br><span class="line">    TOTAL_AMOUNT NUMBER,   </span><br><span class="line">    CUSTOTMER_ID NUMBER(<span class="number">7</span>),   </span><br><span class="line">    PAID   <span class="type">CHAR</span>(<span class="number">1</span>)   </span><br><span class="line">)   <span class="comment">-- å»ºè¡¨è¯­å¥ä¸å˜</span></span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (ORDER_DATE) <span class="comment">-- èŒƒå›´åˆ†åŒºåˆ›å»º è¯­å¥ å…³é”®å­— range(åˆ—å)</span></span><br><span class="line">(  </span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART01 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;01- MAY -2003&#x27;</span>,<span class="string">&#x27;DD-MON-YYYY&#x27;</span>)) TABLESPACE ORD_TS01,  </span><br><span class="line">    <span class="comment">-- åˆ†åŒºå ï¼ˆæ—¶é—´å€¼ï¼‰è¡¨ç©ºé—´</span></span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART02 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;01-JUN-2003&#x27;</span>,<span class="string">&#x27;DD-MON-YYYY&#x27;</span>)) TABLESPACE ORD_TS02,  </span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART02 <span class="keyword">VALUES</span> LESS THAN (MAXVALUE) TABLESPACE ORD_TS03   <span class="comment">--ä½¿ç”¨maxvalue å°†å…¶ä»–ä¸ç¬¦åˆä¸Šè¿°èŒƒå›´çš„å€¼æ”¾å…¥å…¶ä¸­</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº"><a href="#oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº"></a>oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> ORDER_ACTIVITIES  </span><br><span class="line">(  PROBLEM_ID   NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span> <span class="keyword">PRIMARY KEY</span>,   </span><br><span class="line">    CUSTOMER_ID  NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span>,     </span><br><span class="line">    STATUS       VARCHAR2(<span class="number">20</span>))   </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> LIST (STATUS)    <span class="comment">-- èŒƒå›´åˆ†åŒºåˆ›å»º è¯­å¥ å…³é”®å­— LIST(åˆ—å)</span></span><br><span class="line">(    <span class="keyword">PARTITION</span> PROB_ACTIVE   <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE PROB_TS01,  <span class="comment">-- </span></span><br><span class="line">      <span class="keyword">PARTITION</span> PROB_INACTIVE <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>,<span class="string">&#x27;unknow&#x27;</span>) TABLESPACE PROB_TS02  </span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº"><a href="#oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº"></a>oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> HASH_TABLE   </span><br><span class="line">( COL NUMBER(<span class="number">8</span>),   </span><br><span class="line">  INF VARCHAR2(<span class="number">100</span>)   </span><br><span class="line">)   </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> HASH (COL)    <span class="comment">-- èŒƒå›´åˆ†åŒºåˆ›å»º è¯­å¥ å…³é”®å­— HASH(åˆ—å) </span></span><br><span class="line">(   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART01 TABLESPACE HASH_TS01,   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART02 TABLESPACE HASH_TS02,   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART03 TABLESPACE HASH_TS03   </span><br><span class="line">) </span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-ç»„åˆåˆ†åŒº"><a href="#oracleåˆ†åŒº-ç»„åˆåˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-ç»„åˆåˆ†åŒº"></a><strong>oracle</strong>åˆ†åŒº-ç»„åˆåˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> SALES   </span><br><span class="line">(  </span><br><span class="line">PRODUCT_ID VARCHAR2(<span class="number">5</span>),  </span><br><span class="line">SALES_DATE <span class="type">DATE</span>,  </span><br><span class="line">SALES_COST NUMBER(<span class="number">10</span>),  </span><br><span class="line">STATUS VARCHAR2(<span class="number">20</span>)  </span><br><span class="line">)  </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(SALES_DATE) SUBPARTITION <span class="keyword">BY</span> LIST (STATUS)  </span><br><span class="line">(  </span><br><span class="line">   <span class="keyword">PARTITION</span> P1 <span class="keyword">VALUES</span> LESS THAN(TO_DATE(<span class="string">&#x27;2003-01-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>))TABLESPACE rptfact2009   </span><br><span class="line">  (   </span><br><span class="line">      SUBPARTITION P1SUB1 <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE rptfact2009,   </span><br><span class="line">      SUBPARTITION P1SUB2 <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>) TABLESPACE rptfact2009   </span><br><span class="line">  ),   </span><br><span class="line">   <span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;2003-03-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>)) TABLESPACE rptfact2009   </span><br><span class="line">  (   </span><br><span class="line">      SUBPARTITION P2SUB1 <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE rptfact2009,   </span><br><span class="line">      SUBPARTITION P2SUB2 <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>) TABLESPACE rptfact2009   </span><br><span class="line">  )   </span><br><span class="line">)  </span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"><a href="#oracleåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ" class="headerlink" title="oracleåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"></a><em>oracle</em>åˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ·»åŠ åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> P3 <span class="keyword">VALUES</span> LESS THAN(TO_DATE(<span class="string">&#x27;2003-06-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>));  </span><br><span class="line"><span class="comment">--æ³¨æ„ï¼šä»¥ä¸Šæ·»åŠ çš„åˆ†åŒºç•Œé™åº”è¯¥é«˜äºæœ€åä¸€ä¸ª åˆ†åŒºç•Œé™ã€‚</span></span><br><span class="line"><span class="comment">-- æ·»åŠ äº†ä¸€ä¸ªP3SUB1å­åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES MODIFY <span class="keyword">PARTITION</span> P3 <span class="keyword">ADD</span> SUBPARTITION P3SUB1 <span class="keyword">VALUES</span>(<span class="string">&#x27;COMPLETE&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">DROP</span> <span class="keyword">PARTITION</span> P3;  </span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">DROP</span> SUBPARTITION P4SUB1;</span><br><span class="line"><span class="comment">-- æ³¨æ„ï¼šå¦‚æœåˆ é™¤çš„åˆ†åŒºæ˜¯è¡¨ä¸­å”¯ä¸€çš„åˆ†åŒºï¼Œé‚£ä¹ˆæ­¤åˆ†åŒºå°†ä¸èƒ½è¢«åˆ é™¤ï¼Œè¦æƒ³åˆ é™¤æ­¤åˆ†åŒºï¼Œå¿…é¡»åˆ é™¤è¡¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº¤æ¢åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name EXCHANGE <span class="keyword">PARTITION</span> partition_name <span class="keyword">WITH</span> <span class="keyword">TABLE</span> nonpartition_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å°†ä¸€ä¸ªåˆ†åŒº(å­åˆ†åŒº)å’Œéåˆ†åŒºè¡¨è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œoracleäº¤æ¢çš„æ–¹æ³•æ˜¯å…¶å®æ˜¯å¯¹é€»è¾‘å­˜å‚¨æ®µè¿›è¡Œäº¤æ¢ã€‚ä½¿ç”¨INCLUDEING INDEXESå­å¥å¯ä»¥åŒæ­¥å°†æœ¬åœ°ç´¢å¼•ä¹Ÿè¿›è¡Œäº¤æ¢ï¼Œä½¿ç”¨WITH VALIDATATIONå­å¥è¿˜å¯ä»¥å®ç°è¡Œæ•°æ®çš„éªŒè¯ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--äº¤æ¢åˆ†åŒºæ—¶å¦‚æœä¸å¸¦UPDATE INDEXESå­å¥ï¼Œåˆ™å…¨å±€ç´¢å¼•æˆ–å…¨å±€ç´¢å¼•åŸºäºçš„åˆ†åŒºå°†å˜ä¸ºä¸å¯ç”¨ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨"><a href="#hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨" class="headerlink" title="hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨"></a>hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨</h2><p><strong>åœ¨ Hadoop ä¸­ï¼ŒHive åˆ†åŒºè¡¨é€šå¸¸ä»¥ç‰¹å®šçš„ç›®å½•ç»“æ„æ¥å­˜å‚¨ã€‚</strong></p><p><strong>æ¯ä¸ªåˆ†åŒºå¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„ç›®å½•ï¼Œç›®å½•åé€šå¸¸åŒ…å«åˆ†åŒºåˆ—çš„å€¼ã€‚æ•°æ®æ–‡ä»¶ä¼šå­˜å‚¨åœ¨ç›¸åº”çš„åˆ†åŒºç›®å½•ä¸‹ã€‚</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºåˆ†åŒºè¡¨</span></span><br><span class="line"><span class="keyword">create table</span> dept_partition(</span><br><span class="line">deptno <span class="type">int</span>, dname string, loc string</span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (<span class="keyword">day</span> string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"><a href="#hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ" class="headerlink" title="hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"></a>hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ†åŒºè¡¨æ•°æ®å¯¼å…¥</span></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/opt/module/hive/datas/dept_20200401.log&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> dept_partition <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200401&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--selectåˆ†åŒºè¡¨æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span> log_list_6 <span class="keyword">partition</span>(dat<span class="operator">=</span><span class="string">&#x27;20221231&#x27;</span>) <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> log_list_tmp</span><br><span class="line"><span class="comment">--å¤šè¡¨åˆ†åŒºæ’å…¥ </span></span><br><span class="line"><span class="keyword">from</span> student </span><br><span class="line">  <span class="keyword">insert</span> overwrite <span class="keyword">table</span> student <span class="keyword">partition</span>(<span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201707&#x27;</span>)<span class="keyword">select</span> id, name <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201707&#x27;</span></span><br><span class="line">  <span class="keyword">insert</span> overwrite <span class="keyword">table</span> student <span class="keyword">partition</span>(<span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201706&#x27;</span>)<span class="keyword">select</span> id, name <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201706&#x27;</span>;</span><br><span class="line"><span class="comment">-- æŸ¥çœ‹åˆ†åŒº</span></span><br><span class="line"><span class="keyword">show</span> partitions tab_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ·»åŠ åˆ†åŒº</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200404&#x27;</span>) ;</span><br><span class="line"><span class="comment">--æ·»åŠ å¤šåˆ†åŒº</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200405&#x27;</span>) <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200406&#x27;</span>);</span><br><span class="line"><span class="comment">--åˆ é™¤åˆ†åŒº</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">drop</span> <span class="keyword">partition</span> (<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200406&#x27;</span>);</span><br><span class="line"><span class="comment">--æŸ¥çœ‹åˆ†åŒºè¡¨ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">show</span> partitions dept_partition;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹åˆ†åŒºè¡¨ç»“æ„</span></span><br><span class="line"><span class="keyword">desc</span> formatted dept_partition;</span><br><span class="line"><span class="comment">--ä¿®æ”¹åˆ†åŒºè¡¨</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>) <span class="keyword">SET</span> LOCATION &quot;new location&quot;;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>) RENAME <span class="keyword">TO</span> <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;20080808&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹"><a href="#è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹" class="headerlink" title="è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹"></a>è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> supermarket_p (</span><br><span class="line">id string, <span class="comment">-- è¡Œ ID  </span></span><br><span class="line">ord_id string comment <span class="string">&#x27;è®¢å• ID&#x27;</span>,  </span><br><span class="line">ord_date string comment <span class="string">&#x27;è®¢å•æ—¥æœŸ&#x27;</span>, </span><br><span class="line">exch_date string comment <span class="string">&#x27;å‘è´§æ—¥æœŸ&#x27;</span>,</span><br><span class="line">exch_type string comment <span class="string">&#x27;é‚®å¯„æ–¹å¼&#x27;</span>,</span><br><span class="line">cust_id string comment <span class="string">&#x27;å®¢æˆ· ID &#x27;</span>,</span><br><span class="line">cust_name string comment <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>,</span><br><span class="line">d_type string comment <span class="string">&#x27;ç»†åˆ†&#x27;</span>,</span><br><span class="line">city string comment <span class="string">&#x27;åŸå¸‚&#x27;</span>, </span><br><span class="line">prov string comment <span class="string">&#x27;çœ/è‡ªæ²»åŒº&#x27;</span>,  </span><br><span class="line">country string comment<span class="string">&#x27;å›½å®¶&#x27;</span>,</span><br><span class="line">area string comment <span class="string">&#x27;åœ°åŒº&#x27;</span>, </span><br><span class="line">pro_id string comment <span class="string">&#x27;äº§å“ ID&#x27;</span>,  </span><br><span class="line">type1 string comment <span class="string">&#x27;ç±»åˆ«&#x27;</span>,</span><br><span class="line">type2 string comment <span class="string">&#x27;å­ç±»åˆ«&#x27;</span>, </span><br><span class="line">pro_name string comment <span class="string">&#x27;äº§å“åç§°&#x27;</span>,</span><br><span class="line">sales <span class="type">float</span> comment <span class="string">&#x27;é”€å”®é¢&#x27;</span>,  </span><br><span class="line">count1 <span class="type">int</span> comment <span class="string">&#x27;æ•°é‡  &#x27;</span>,</span><br><span class="line">discount <span class="type">float</span> comment <span class="string">&#x27;æŠ˜æ‰£  &#x27;</span>,</span><br><span class="line">profit <span class="type">float</span> comment <span class="string">&#x27;åˆ©æ¶¦&#x27;</span></span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (c_type1 string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€åˆ†åŒºé…ç½®"><a href="#åŠ¨æ€åˆ†åŒºé…ç½®" class="headerlink" title="åŠ¨æ€åˆ†åŒºé…ç½®"></a>åŠ¨æ€åˆ†åŒºé…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">--å¼€å¯åŠ¨æ€åˆ†åŒº(é»˜è®¤å¼€å¯)</span><br><span class="line"><span class="built_in">set</span> hive.exec.dynamic.partition=<span class="literal">true</span></span><br><span class="line">--æŒ‡å®šéä¸¥æ ¼æ¨¡å¼ nonstrictæ¨¡å¼è¡¨ç¤ºå…è®¸æ‰€æœ‰çš„åˆ†åŒºå­—æ®µéƒ½å¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†åŒº</span><br><span class="line"><span class="built_in">set</span> hive.exec.dynamic.partition.mode=nonstrict</span><br><span class="line">--åœ¨æ‰€æœ‰æ‰§è¡ŒMRçš„èŠ‚ç‚¹ä¸Šï¼Œæœ€å¤§ä¸€å…±å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªåŠ¨æ€åˆ†åŒºã€‚é»˜è®¤1000</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.dynamic.partitions=1000</span><br><span class="line">--åœ¨æ¯ä¸ªæ‰§è¡ŒMRçš„èŠ‚ç‚¹ä¸Šï¼Œæœ€å¤§å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªåŠ¨æ€åˆ†åŒº(åˆ†åŒºå­—æ®µæœ‰å¤šå°‘ç§è®¾å¤šå°‘ä¸ª)</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.dynamic.partitions.pernode=100</span><br><span class="line">--æ•´ä¸ªMR Jobä¸­ï¼Œæœ€å¤§å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªHDFSæ–‡ä»¶ã€‚é»˜è®¤100000</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.created.files=100000</span><br><span class="line">--å½“æœ‰ç©ºåˆ†åŒºç”Ÿæˆæ—¶ï¼Œæ˜¯å¦æŠ›å‡ºå¼‚å¸¸</span><br><span class="line"><span class="built_in">set</span> hive.error.on.empty.partition=<span class="literal">false</span></span><br><span class="line">--æ‰“å¼€æ­£åˆ™æŸ¥è¯¢æ¨¡å¼`(dt|hr)?+.+`</span><br><span class="line"><span class="built_in">set</span> hive.support.quoted.identifiers=none</span><br></pre></td></tr></table></figure><h1 id="åˆ†æ¡¶è¡¨"><a href="#åˆ†æ¡¶è¡¨" class="headerlink" title="åˆ†æ¡¶è¡¨"></a>åˆ†æ¡¶è¡¨</h1><ul><li><p>åˆ†åŒºæä¾›ä¸€ä¸ªéš”ç¦»æ•°æ®å’Œä¼˜åŒ–æŸ¥è¯¢çš„ä¾¿åˆ©æ–¹å¼ã€‚ä¸è¿‡ï¼Œå¹¶éæ‰€æœ‰çš„æ•°æ®é›†éƒ½å¯å½¢æˆåˆç†çš„åˆ†åŒºã€‚å¯¹äºä¸€å¼ è¡¨æˆ–è€…åˆ†åŒºï¼ŒHive å¯ä»¥è¿›ä¸€æ­¥ç»„ç»‡æˆæ¡¶ï¼Œä¹Ÿå°±æ˜¯æ›´ä¸ºç»†ç²’åº¦çš„æ•°æ®èŒƒå›´åˆ’åˆ†ã€‚</p></li><li><p>åˆ†æ¡¶æ˜¯å°†æ•°æ®é›†åˆ†è§£æˆæ›´å®¹æ˜“ç®¡ç†çš„è‹¥å¹²éƒ¨åˆ†çš„å¦ä¸€ä¸ªæŠ€æœ¯ã€‚</p></li><li><p>åˆ†åŒº<strong>é’ˆå¯¹çš„æ˜¯æ•°æ®çš„å­˜å‚¨è·¯å¾„</strong>ï¼›åˆ†æ¡¶<strong>é’ˆå¯¹çš„æ˜¯æ•°æ®æ–‡ä»¶</strong>ã€‚</p></li></ul><h2 id="åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹"><a href="#åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹" class="headerlink" title="åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹"></a><strong>åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹</strong></h2><ul><li><p><strong>åˆ†æ¡¶ç­–ç•¥</strong></p></li><li><p><strong>Hiveçš„åˆ†æ¡¶é‡‡ç”¨å¯¹åˆ†æ¡¶å­—æ®µçš„å€¼è¿›è¡Œå“ˆå¸Œï¼Œç„¶åé™¤ä»¥æ¡¶çš„ä¸ªæ•°æ±‚ä½™çš„æ–¹ å¼å†³å®šè¯¥æ¡è®°å½•å­˜æ”¾åœ¨å“ªä¸ªæ¡¶å½“ä¸­</strong></p><p>&#x3D;&#x3D;reduceçš„ä¸ªæ•°è®¾ç½®ä¸º-1,è®©Jobè‡ªè¡Œå†³å®šéœ€è¦ç”¨å¤šå°‘ä¸ªreduceæˆ–è€…å°†reduceçš„ä¸ªæ•°è®¾ç½®ä¸ºå¤§äºç­‰äºåˆ†æ¡¶è¡¨çš„æ¡¶æ•°&#x3D;&#x3D;</p><p>&#x3D;&#x3D;<strong>ä»hdfsä¸­loadæ•°æ®åˆ°åˆ†æ¡¶è¡¨ä¸­ï¼Œé¿å…æœ¬åœ°æ–‡ä»¶æ‰¾ä¸åˆ°é—®é¢˜</strong>&#x3D;&#x3D;</p><p>&#x3D;&#x3D;<strong>ä¸è¦ä½¿ç”¨æœ¬åœ°æ¨¡å¼</strong>&#x3D;&#x3D;</p></li></ul><h2 id="hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨"><a href="#hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨" class="headerlink" title="hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨"></a>hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--åˆ›å»º4ä¸ªåˆ†æ¡¶çš„åˆ†æ¡¶è¡¨</span></span><br><span class="line"><span class="keyword">create table</span> stu_bucket(id <span class="type">int</span>, name string)</span><br><span class="line">clustered <span class="keyword">by</span>(id) </span><br><span class="line"><span class="keyword">into</span> <span class="number">4</span> buckets</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è®¾ç½®mapreduceæ•°é‡(äºŒé€‰ä¸€)</span></span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces<span class="operator">=</span><span class="number">3</span></span><br><span class="line"> <span class="keyword">set</span> mapred.reduce.tasks<span class="operator">=</span><span class="number">3</span></span><br><span class="line"><span class="comment">--å‘åˆ†æ¡¶è¡¨å¯¼å…¥æ•°æ®</span></span><br><span class="line">load data inpath   <span class="string">&#x27;/student.txt&#x27;</span> </span><br><span class="line"><span class="keyword">into</span> <span class="keyword">table</span> stu_bucket;</span><br></pre></td></tr></table></figure><h2 id="hiveæ’åºå…³é”®å­—"><a href="#hiveæ’åºå…³é”®å­—" class="headerlink" title="hiveæ’åºå…³é”®å­—"></a>hiveæ’åºå…³é”®å­—</h2><p><img src="/Hadoop/image-20250701153814791.png" alt="image-20250701153814791"></p><hr><p>##<strong>hive****æ’åºè¯­å¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--ä½¿ç”¨order by æ’åº</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 <span class="keyword">order</span> <span class="keyword">by</span> id</span><br><span class="line"><span class="comment">--ä½¿ç”¨sort by æ’åº</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 sort <span class="keyword">by</span> class_name <span class="keyword">desc</span></span><br><span class="line"><span class="comment">--ä½¿ç”¨distribute by åˆ†ç»„</span></span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces<span class="operator">=</span><span class="number">15</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 distribute <span class="keyword">by</span> class_name sort <span class="keyword">by</span> id <span class="keyword">desc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite  <span class="keyword">local</span> directory <span class="string">&#x27;/root/student2/&#x27;</span></span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2_b </span><br><span class="line">distribute <span class="keyword">by</span> sex </span><br><span class="line">sort <span class="keyword">by</span> chinese <span class="keyword">desc</span></span><br><span class="line"><span class="comment">--ä½¿ç”¨cluster by åˆ†ç»„å¹¶æ’åº</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 cluster <span class="keyword">by</span> class_name</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨awk-æ¸…æ´—-log"><a href="#ä½¿ç”¨awk-æ¸…æ´—-log" class="headerlink" title="ä½¿ç”¨awk æ¸…æ´— log"></a>ä½¿ç”¨awk æ¸…æ´— log</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> 2021-05-20.<span class="built_in">log</span> | awk -F <span class="string">&quot;\&quot;-\&quot;&quot;</span> <span class="string">&#x27;&#123;split($1, arr, &quot; &quot;);\</span></span><br><span class="line"><span class="string">split(substr(arr[4],2),dd,&quot;:&quot;);\</span></span><br><span class="line"><span class="string">split(dd[1],ee,&quot;/&quot;);\</span></span><br><span class="line"><span class="string">print arr[1]&quot;\t&quot;ee[1]&quot;-</span></span><br><span class="line"><span class="string">&quot;ee[2]&quot;-&quot;ee[3]&quot; &quot;dd[2]&quot;:&quot;dd[3]&quot;:&quot;dd[4]&quot;\t&quot;arr[7]&quot;\t&quot;$2&#125;&#x27;</span> | \</span><br><span class="line">awk -F <span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;&quot;date -d \&quot;&quot;$2&quot;\&quot; +%Y%m%d%H%M%S&quot; | getline d;print</span></span><br><span class="line"><span class="string">$1&quot;\t&quot;d&quot;\t&quot;$3&quot;\t&quot;$4 &#125;&#x27;</span> | \</span><br><span class="line">awk -F <span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;print $1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;(index($4,&quot;Windows&quot;)?&quot;Windows&quot;:</span></span><br><span class="line"><span class="string">(index($4,&quot;Linux&quot;)?&quot;Linux&quot;:&quot;Mac&quot;))&quot;\t&quot;(index($4,&quot;Chrome&quot;)?&quot;Chrome&quot;:</span></span><br><span class="line"><span class="string">(index($4,&quot;Version&quot;)?&quot;Safari&quot;:(index($4,&quot;Firefox&quot;)?&quot;Firefox&quot;:&quot;Opera&quot;)))&#125;&#x27;</span> &gt;</span><br><span class="line">new_2021-05-20.log</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hive </tag>
            
            <tag> Python </tag>
            
            <tag> MySQL </tag>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop</title>
      <link href="/2025/06/24/Hadoop/"/>
      <url>/2025/06/24/Hadoop/</url>
      
        <content type="html"><![CDATA[<h1 id="Hadoopç®€ä»‹"><a href="#Hadoopç®€ä»‹" class="headerlink" title="Hadoopç®€ä»‹"></a>Hadoopç®€ä»‹</h1><ul><li>Hadoopæ˜¯ä¸€ä¸ªç”±ApacheåŸºé‡‘ä¼šæ‰€å¼€å‘çš„åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€æ¶æ„</li><li>ä¸»è¦è§£å†³ï¼Œ<strong>æµ·é‡æ•°æ®çš„å­˜å‚¨å’Œæµ·é‡æ•°æ®çš„åˆ†æè®¡ç®—é—®é¢˜</strong></li><li>å¹¿ä¹‰ä¸Šæ¥è¯´ï¼ŒHadoopé€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªæ›´å¹¿æ³›çš„æ¦‚å¿µ-Hadoopç”Ÿæ€åœˆ</li></ul><h2 id="åˆ†å¸ƒå¼å­˜å‚¨"><a href="#åˆ†å¸ƒå¼å­˜å‚¨" class="headerlink" title="åˆ†å¸ƒå¼å­˜å‚¨"></a>åˆ†å¸ƒå¼å­˜å‚¨</h2><p>Hadoop çš„åˆ†å¸ƒå¼å­˜å‚¨ä¸»è¦åŸºäº HDFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰:<br>HDFSå°†æ•°æ®<strong>åˆ†å‰²æˆå¤šä¸ªæ•°æ®å—ï¼ˆblockï¼‰</strong>ï¼Œè¿™äº›æ•°æ®å—<strong>åˆ†æ•£å­˜å‚¨åœ¨é›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹ä¸Š</strong>ã€‚æ¯ä¸ªæ•°æ®å—ä¼šæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œé€šå¸¸é»˜è®¤æ˜¯ 3 ä¸ªå‰¯æœ¬.é‡‡ç”¨åˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œæé«˜äº†æ•°æ®çš„å¯é æ€§å’Œå®¹é”™æ€§ã€‚</p><p><img src="/2025/06/24/Hadoop/image-20250701140958694.png" alt="image-20250701140958694"></p><p>Hadoopçš„åˆ†å¸ƒå¼æ ¸å¿ƒç»„ä»¶æ˜¯MapReduceç¼–ç¨‹æ¨¡å‹:<br>åœ¨MapReduceä»»åŠ¡ä¸­ï¼Œæ•°æ®è¢«åˆ‡åˆ†ä¸ºå¤šä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡ç”±æˆ–å¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œã€‚æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£å°†è¾“å…¥æ•°æ®æ˜ å°„ä¸ºé”®-å€¼å¯¹ç”Ÿæˆä¸­é—´ç»“æœã€‚æœ€åï¼Œä¸­é—´ç»“æœæŒ‰ç…§é”®çš„æ’åºè¿›è¡Œåˆå¹¶å’Œå½’å¹¶ã€‚</p><p><img src="/2025/06/24/Hadoop/image-20250701141052158.png" alt="image-20250701141052158"></p><p><img src="/2025/06/24/Hadoop/image-20250701141243480.png" alt="image-20250701141243480"></p><h1 id="Hadoopç»„ä»¶-é¢è¯•é‡ç‚¹"><a href="#Hadoopç»„ä»¶-é¢è¯•é‡ç‚¹" class="headerlink" title="Hadoopç»„ä»¶(é¢è¯•é‡ç‚¹)"></a>Hadoopç»„ä»¶(é¢è¯•é‡ç‚¹)</h1><p><a href="hadoop%E9%97%AE%E7%AD%94%E5%B0%8F%E6%B5%8B%E9%AA%8C.md">hadoopé—®ç­”å°æµ‹éªŒ</a></p><h2 id="HDFS-æ¶æ„æ¦‚è¿°"><a href="#HDFS-æ¶æ„æ¦‚è¿°" class="headerlink" title="HDFS æ¶æ„æ¦‚è¿°"></a>HDFS æ¶æ„æ¦‚è¿°</h2><p>HDFSç»„ä»¶ç”¨äºå­˜å‚¨æ•°æ®,ä¸»è¦ç”±NameNode,DataNode,SecondaryNameNode ç»„æˆ</p><ul><li><strong>NameNode (nn)</strong>: <strong>å­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®</strong>ï¼Œå¦‚æ–‡ä»¶åï¼Œæ–‡ä»¶ç›®å½•ç»“æ„ï¼Œæ–‡ä»¶å±æ€§ (ç”Ÿæˆæ—¶é—´ã€å‰¯æœ¬æ•°ã€æ–‡ä»¶æƒé™)ï¼Œä»¥åŠæ¯ä¸ªæ–‡ä»¶çš„å—åˆ—è¡¨å’Œå—æ‰€åœ¨çš„DataNodeç­‰ã€‚</li><li><strong>DataNode(dn)</strong>: åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ<strong>å­˜å‚¨æ–‡ä»¶å—æ•°æ®ï¼Œä»¥åŠå—æ•°æ®çš„æ ¡éªŒã€‚</strong></li><li><strong>SecondaryNameNode(2nn)</strong>: æ¯éš”ä¸€æ®µæ—¶é—´<strong>å¯¹NameNodeå…ƒæ•°æ®è¿›è¡Œå¤‡ä»½</strong></li></ul><h2 id="Yarn-æ¶æ„æ¦‚è¿°"><a href="#Yarn-æ¶æ„æ¦‚è¿°" class="headerlink" title="Yarn æ¶æ„æ¦‚è¿°"></a>Yarn æ¶æ„æ¦‚è¿°</h2><p><strong>Yet Another Resource Negotiator ç®€ç§°YARN ï¼Œå¦ä¸€ç§èµ„æºåè°ƒè€…ï¼Œæ˜¯Hadoop çš„èµ„æºç®¡ç†å™¨ã€‚</strong></p><p>Yarnèµ„æºè°ƒåº¦è´Ÿè´£ç¡¬ä»¶èµ„æºç®¡ç†,ä¸»è¦ç”±:ResourceManager,NodeManager,ApplicationMasterç»„æˆ<br><img src="/2025/06/24/Hadoop/file-20250810003459589.png"></p><ul><li><strong>ResourceManager</strong> (èµ„æºç®¡ç†å™¨):<strong>.<strong>YARNé›†ç¾¤ä¸­çš„ä¸­å¿ƒè°ƒåº¦å™¨å’Œèµ„æºç®¡ç†å™¨ã€‚</strong>è´Ÿè´£æ•´ä¸ªé›†ç¾¤çš„èµ„æºåˆ†é…å’Œè°ƒåº¦ ç›‘æ§é›†ç¾¤ä¸­çš„è®¡ç®—èµ„æºä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€</strong>ã€‚</li><li><strong>NodeManager</strong> (èŠ‚ç‚¹ç®¡ç†å™¨):<strong>å•ä¸ªèŠ‚ç‚¹æœåŠ¡å™¨èµ„æºçš„ç®¡ç†è€…ã€‚</strong>æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ä»£ç†ç¨‹åº<strong>è´Ÿè´£ç®¡ç†å’Œç›‘æ§èŠ‚ç‚¹ä¸Šçš„èµ„æºå’Œä»»åŠ¡</strong>ã€‚æ¥æ”¶æ¥è‡ªRMçš„ä»»åŠ¡è°ƒåº¦è¯·æ±‚;å¯åŠ¨ã€åœæ­¢å’Œç›‘æ§ä»»åŠ¡çš„æ‰§è¡Œ;å‘é€èŠ‚ç‚¹çš„çŠ¶æ€å’Œå¯ç”¨èµ„æºæŠ¥å‘Š</li><li><strong>ApplicationMaster</strong> (åº”ç”¨ç¨‹åºç®¡ç†å™¨)ï¼š<strong>å•ä¸ªä»»åŠ¡è¿è¡Œçš„ç®¡ç†è€…</strong>ã€‚æ¯ä¸ªåº”ç”¨ç¨‹åºåœ¨YARNä¸­éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„AM.AppMasterè´Ÿè´£åè°ƒå’Œç®¡ç†åº”ç”¨ç¨‹åºçš„æ‰§è¡Œã€‚å®ƒä¸RMäº¤äº’ç”³è¯·èµ„æºå¹¶ç›‘ä»»åŠ¡çš„æ‰§è¡Œã€‚å®ƒè¿˜<strong>è´Ÿè´£ä»»åŠ¡çš„åˆ’åˆ†å’Œè°ƒåº¦ã€å®¹é”™å’Œæ¢å¤ã€è¿›åº¦è·Ÿè¸ª</strong>ç­‰ã€‚</li><li><strong><code>Container</code><strong>ï¼šå®¹å™¨ï¼Œç›¸å½“äºä¸€å°ç‹¬ç«‹çš„æœåŠ¡å™¨ï¼Œé‡Œé¢å°è£…äº†ä»»åŠ¡è¿è¡Œæ‰€éœ€è¦çš„èµ„æºï¼Œå¦‚</strong>å†…å­˜ã€CPUã€ç£ç›˜ã€ç½‘ç»œ</strong>ç­‰ã€‚</li></ul><p>è¯´æ˜ï¼š<br>ï¼ˆ1ï¼‰å®¢æˆ·ç«¯å¯ä»¥æœ‰å¤šä¸ª<br>ï¼ˆ2ï¼‰é›†ç¾¤ä¸Šå¯ä»¥è¿è¡Œå¤šä¸ªApplicationMaster<br>ï¼ˆ3ï¼‰æ¯ä¸ªNodeManagerä¸Šå¯ä»¥æœ‰å¤šä¸ªContainer</p><h2 id="MapReduce-æ¶æ„æ¦‚è¿°"><a href="#MapReduce-æ¶æ„æ¦‚è¿°" class="headerlink" title="MapReduce æ¶æ„æ¦‚è¿°"></a>MapReduce æ¶æ„æ¦‚è¿°</h2><p>MapReduce å°†è®¡ç®—è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šMap å’ŒReduce  </p><ol><li>Map é˜¶æ®µå¹¶è¡Œå¤„ç†è¾“å…¥æ•°æ®  </li><li>Reduce é˜¶æ®µå¯¹Map ç»“æœè¿›è¡Œæ±‡æ€»<br><img src="/2025/06/24/Hadoop/file-20250810004014162.png"></li></ol><h2 id="HDFSã€YARNã€MapReduce-ä¸‰è€…å…³ç³»"><a href="#HDFSã€YARNã€MapReduce-ä¸‰è€…å…³ç³»" class="headerlink" title="HDFSã€YARNã€MapReduce ä¸‰è€…å…³ç³»"></a>HDFSã€YARNã€MapReduce ä¸‰è€…å…³ç³»</h2><p><img src="/2025/06/24/Hadoop/file-20250810004101508.png"></p><h2 id="å¤§æ•°æ®æŠ€æœ¯ç”Ÿæ€ä½“ç³»"><a href="#å¤§æ•°æ®æŠ€æœ¯ç”Ÿæ€ä½“ç³»" class="headerlink" title="å¤§æ•°æ®æŠ€æœ¯ç”Ÿæ€ä½“ç³»"></a>å¤§æ•°æ®æŠ€æœ¯ç”Ÿæ€ä½“ç³»</h2><p><img src="/2025/06/24/Hadoop/file-20250810004247220.png"><br>å›¾ä¸­æ¶‰åŠçš„æŠ€æœ¯åè¯è§£é‡Šå¦‚ä¸‹ï¼š</p><ol><li><code>Sqoop</code>ï¼šSqoop æ˜¯ä¸€æ¬¾å¼€æºçš„å·¥å…·ï¼Œä¸»è¦ç”¨äºåœ¨Hadoopã€Hive ä¸ä¼ ç»Ÿçš„æ•°æ®åº“ï¼ˆMySQLï¼‰é—´è¿›è¡Œæ•°æ®çš„ä¼ é€’ï¼Œå¯ä»¥å°†ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ï¼ˆä¾‹å¦‚ ï¼šMySQLï¼ŒOracle ç­‰ï¼‰ä¸­çš„æ•°æ®å¯¼è¿›åˆ°Hadoop çš„HDFS ä¸­ï¼Œä¹Ÿå¯ä»¥å°†HDFS çš„æ•°æ®å¯¼è¿›åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­ã€‚</li><li><code>Flume</code>ï¼šFlume æ˜¯ä¸€ä¸ªé«˜å¯ç”¨çš„ï¼Œé«˜å¯é çš„ï¼Œåˆ†å¸ƒå¼çš„æµ·é‡æ—¥å¿—é‡‡é›†ã€èšåˆå’Œä¼ è¾“çš„ç³»ç»Ÿï¼ŒFlume æ”¯æŒåœ¨æ—¥å¿—ç³»ç»Ÿä¸­å®šåˆ¶å„ç±»æ•°æ®å‘é€æ–¹ï¼Œç”¨äºæ”¶é›†æ•°æ®ã€‚</li><li><code>Kafka</code>ï¼šKafka æ˜¯ä¸€ç§é«˜ååé‡çš„åˆ†å¸ƒå¼å‘å¸ƒè®¢é˜…æ¶ˆæ¯ç³»ç»Ÿã€‚</li><li><code>Spark</code>ï¼šSpark æ˜¯å½“å‰æœ€æµè¡Œçš„å¼€æºå¤§æ•°æ®å†…å­˜è®¡ç®—æ¡†æ¶ã€‚å¯ä»¥åŸºäºHadoop ä¸Šå­˜å‚¨çš„å¤§æ•°æ®è¿›è¡Œè®¡ç®—ã€‚</li><li><code>Flink</code>ï¼šFlink æ˜¯å½“å‰æœ€æµè¡Œçš„å¼€æºå¤§æ•°æ®å†…å­˜è®¡ç®—æ¡†æ¶ã€‚ç”¨äºå®æ—¶è®¡ç®—çš„åœºæ™¯è¾ƒå¤šã€‚</li><li><code>Oozie</code>ï¼šOozie æ˜¯ä¸€ä¸ªç®¡ç†Hadoop ä½œä¸šï¼ˆjobï¼‰çš„å·¥ä½œæµç¨‹è°ƒåº¦ç®¡ç†ç³»ç»Ÿã€‚</li><li><code>Hbase</code>ï¼šHBase æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€é¢å‘åˆ—çš„å¼€æºæ•°æ®åº“ã€‚HBase ä¸åŒäºä¸€èˆ¬çš„å…³ç³»æ•°æ®åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€‚åˆäºéç»“æ„åŒ–æ•°æ®å­˜å‚¨çš„æ•°æ®åº“ã€‚</li><li><code>Hive</code>ï¼šHive æ˜¯åŸºäºHadoop çš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…·ï¼Œå¯ä»¥å°†ç»“æ„åŒ–çš„æ•°æ®æ–‡ä»¶æ˜ å°„ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼Œå¹¶æä¾›ç®€å•çš„SQL æŸ¥è¯¢åŠŸèƒ½ï¼Œå¯ä»¥å°†SQL è¯­å¥è½¬æ¢ä¸ºMapReduce ä»»åŠ¡è¿›è¡Œè¿è¡Œã€‚å…¶ä¼˜ç‚¹æ˜¯å­¦ä¹ æˆæœ¬ä½ï¼Œå¯ä»¥é€šè¿‡ç±»SQL è¯­å¥å¿«é€Ÿå®ç°ç®€å•çš„MapReduce ç»Ÿè®¡ï¼Œä¸å¿…å¼€å‘ä¸“é—¨çš„MapReduce åº”ç”¨ï¼Œååˆ†é€‚åˆæ•°æ®ä»“åº“çš„ç»Ÿè®¡åˆ†æã€‚</li><li><code>ZooKeeper</code>ï¼šå®ƒæ˜¯ä¸€ä¸ªé’ˆå¯¹å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¯é åè°ƒç³»ç»Ÿï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åå­—æœåŠ¡ã€åˆ†å¸ƒå¼åŒæ­¥ã€ç»„æœåŠ¡ç­‰ã€‚</li></ol><h2 id="æ¨èç³»ç»Ÿæ¡†æ¶å›¾"><a href="#æ¨èç³»ç»Ÿæ¡†æ¶å›¾" class="headerlink" title="æ¨èç³»ç»Ÿæ¡†æ¶å›¾"></a>æ¨èç³»ç»Ÿæ¡†æ¶å›¾</h2><p>æ¨èç³»ç»Ÿé¡¹ç›®æ¡†æ¶<br><img src="/2025/06/24/Hadoop/file-20250810004351655.png"></p><h1 id="ä¸‰ä¸ªè™šæ‹Ÿæœºé…ç½®åˆ†å¸ƒå¼-ç¯å¢ƒæ­å»º-å¼€å‘é‡ç‚¹"><a href="#ä¸‰ä¸ªè™šæ‹Ÿæœºé…ç½®åˆ†å¸ƒå¼-ç¯å¢ƒæ­å»º-å¼€å‘é‡ç‚¹" class="headerlink" title="ä¸‰ä¸ªè™šæ‹Ÿæœºé…ç½®åˆ†å¸ƒå¼(ç¯å¢ƒæ­å»º:å¼€å‘é‡ç‚¹)"></a>ä¸‰ä¸ªè™šæ‹Ÿæœºé…ç½®åˆ†å¸ƒå¼(ç¯å¢ƒæ­å»º:å¼€å‘é‡ç‚¹)</h1><p><img src="/2025/06/24/Hadoop/image-20250626092139322.png" alt="image-20250626092139322"> </p><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><ol><li><p>æ“ä½œç³»ç»Ÿç¯å¢ƒ</p><ol><li>æ“ä½œç³»ç»Ÿä»¥åŠè½¯ä»¶ç³»ç»Ÿç¯å¢ƒæ­å»º</li><li>sshå…å¯†æ“ä½œ</li></ol></li><li><p>hadoopè½¯ä»¶</p><ol><li><p>è½¯ä»¶å®‰è£…</p></li><li><p>é›†ç¾¤é…ç½®</p></li></ol></li></ol><p><strong>ç¯å¢ƒé…ç½®</strong></p><ol><li><p>æ‰“å¼€è™šæ‹Ÿæœº-&gt;2.è™šæ‹Ÿç½‘ç»œç¼–è¾‘-&gt;3.æ›´æ”¹é…ç½®-&gt;</p></li><li><p><img src="/2025/06/24/Hadoop/image-20250626093107076.png" alt="image-20250626093107076"></p></li><li><p>æœ¬æœºç½‘ç»œæ›´æ”¹é€‚é…å™¨é€‰é¡¹ï¼Œæ‰¾åˆ°</p></li><li><p><img src="/2025/06/24/Hadoop/image-20250626093422694.png" alt="image-20250626093422694"></p></li><li><p>æ–°å»ºè™šæ‹Ÿæœº-&gt;ç¨åå®‰è£…æ“ä½œç³»ç»Ÿ-&gt;è™šæ‹Ÿæœºåç§°æ”¹ä¸ºhadoop100ï¼Œä½ç½®æ”¹ä¸ºD:vmware&#x2F;hadoop100,<img src="/2025/06/24/Hadoop/image-20250626094736868.png" alt="image-20250626094736868"></p></li></ol><p><img src="/2025/06/24/Hadoop/image-20250626094807272.png" alt="image-20250626094807272"><img src="/2025/06/24/Hadoop/image-20250626094854252.png" alt="image-20250626094854252"><img src="/2025/06/24/Hadoop/image-20250626094926569.png" alt="image-20250626094926569"></p><p><strong>å¯åŠ¨è™šæ‹Ÿæœº</strong></p><ol><li><p>æœ€å°åŒ–å®‰è£…</p></li><li><p><strong>ç½‘ç»œé…ç½®</strong></p><p><img src="/2025/06/24/Hadoop/image-20250626095142289.png" alt="image-20250626095142289"></p></li></ol><p><img src="/2025/06/24/Hadoop/image-20250626095226047.png" alt="image-20250626095226047"></p><p>å¼€å§‹å®‰è£…-&gt;<strong>ç”¨æˆ·å’Œå¯†ç éƒ½æ”¹ä¸ºroot</strong></p><h2 id="è½¯ä»¶å®‰è£…"><a href="#è½¯ä»¶å®‰è£…" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h2><h3 id="è½¯ä»¶å‡†å¤‡-ä¸Šä¼ æ–‡ä»¶"><a href="#è½¯ä»¶å‡†å¤‡-ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="è½¯ä»¶å‡†å¤‡&#x2F;ä¸Šä¼ æ–‡ä»¶"></a>è½¯ä»¶å‡†å¤‡&#x2F;ä¸Šä¼ æ–‡ä»¶</h3><ol><li><p>jdk-8u212-linux-x64.tar.gz</p></li><li><p>hadoop-3.1.3.tar.gz</p></li><li><p>CentOS-Base.repo</p></li></ol><h3 id="hadoopå®‰è£…è¿‡ç¨‹"><a href="#hadoopå®‰è£…è¿‡ç¨‹" class="headerlink" title="hadoopå®‰è£…è¿‡ç¨‹"></a>hadoopå®‰è£…è¿‡ç¨‹</h3><h4 id="ç³»ç»Ÿç¯å¢ƒé…ç½®"><a href="#ç³»ç»Ÿç¯å¢ƒé…ç½®" class="headerlink" title="ç³»ç»Ÿç¯å¢ƒé…ç½®"></a>ç³»ç»Ÿç¯å¢ƒé…ç½®</h4><ol><li><p>ä¸‹è½½æºçš„è°ƒæ•´</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.æ‹·è´ä¸€ä»½æ–°çš„é˜¿é‡Œäº‘çš„ ä¸‹è½½æº åˆ° /etc/yum.repos.d/ä¸‹ </span></span><br><span class="line"><span class="built_in">mv</span> /etc/yum.repos.d/CentOS-Base.repo</span><br><span class="line"><span class="comment">#2.æ¸…ç©ºåŸä¸‹è½½æ± </span></span><br><span class="line"><span class="built_in">sudo</span> yum clean all</span><br><span class="line"><span class="comment">#3. åŠ è½½æ–°æº</span></span><br><span class="line"><span class="built_in">sudo</span> yum makecache</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…epel-release(è½¯ä»¶ä»“åº“)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y epel-release</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…å¿…è¦å·¥å…·</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y net-tools rsync vim wget ntp</span><br></pre></td></tr></table></figure></li><li><p>å…³é—­é˜²ç«å¢™</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br></pre></td></tr></table></figure></li><li><p>å…³é—­selinux</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/selinux/config</span><br><span class="line"><span class="comment"># å°†SELINUX=enforcingæ”¹ä¸º</span></span><br><span class="line">SELINUX=disabled</span><br><span class="line"><span class="comment">#wqä¿å­˜</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="è½¯ä»¶å®‰è£…-1"><a href="#è½¯ä»¶å®‰è£…-1" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®ä¸»æœºåæ˜ å°„</span></span><br><span class="line">vim /etc/hosts</span><br><span class="line">ip hostname</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u212-linux-x64.tar.gz -C /opt/module/</span><br><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line">vim /etc/profile.d/my_env.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/module/jdk1.8.0_212</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"></span><br><span class="line">tar -zxvf hadoop-3.1.3.tar.gz -C /opt/module/</span><br><span class="line"></span><br><span class="line">vim /etc/profile.d/my_env.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/module/hadoop-3.1.3</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ›´æ–°ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment">#æµ‹è¯•ç¯å¢ƒå˜é‡é…ç½®</span></span><br><span class="line">hadoop version</span><br></pre></td></tr></table></figure><h4 id="ä¸»æœºå…‹éš†æ“ä½œ"><a href="#ä¸»æœºå…‹éš†æ“ä½œ" class="headerlink" title="ä¸»æœºå…‹éš†æ“ä½œ"></a>ä¸»æœºå…‹éš†æ“ä½œ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-ens33</span><br><span class="line"></span><br><span class="line">IPADDR=<span class="string">&quot;192.168.200.102&quot;</span></span><br><span class="line"></span><br><span class="line">hostnamectl set-hostname hadoop101</span><br></pre></td></tr></table></figure><h4 id="SSHåè®®å…å¯†é…ç½®"><a href="#SSHåè®®å…å¯†é…ç½®" class="headerlink" title="SSHåè®®å…å¯†é…ç½®"></a>SSHåè®®å…å¯†é…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç”Ÿæˆå¯†é’¥å¯¹</span></span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line"><span class="comment">#ä¼ è¾“å¯†é’¥</span></span><br><span class="line">ssh-copy-id hadoop100</span><br></pre></td></tr></table></figure><p><img src="/2025/06/24/Hadoop/image-20250701141804317.png" alt="image-20250701141804317"></p><h4 id="é…ç½®é›†ç¾¤æ–‡ä»¶"><a href="#é…ç½®é›†ç¾¤æ–‡ä»¶" class="headerlink" title="é…ç½®é›†ç¾¤æ–‡ä»¶"></a>é…ç½®é›†ç¾¤æ–‡ä»¶</h4><h3 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šNameNodeçš„åœ°å€ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop100:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šhadoopæ•°æ®çš„å­˜å‚¨ç›®å½• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.1.3/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®HDFSç½‘é¡µç™»å½•ä½¿ç”¨çš„é™æ€ç”¨æˆ·ä¸ºroot --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.http.staticuser.user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- nn webç«¯è®¿é—®åœ°å€--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop100:9870<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2nn webç«¯è®¿é—®åœ°å€--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:9868<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šMRèµ°shuffle --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šResourceManagerçš„åœ°å€--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop101<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ç¯å¢ƒå˜é‡çš„ç»§æ‰¿ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim mapred-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šMapReduceç¨‹åºè¿è¡Œåœ¨Yarnä¸Š --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="workers"><a href="#workers" class="headerlink" title="workers"></a>workers</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/module/hadoop-3.1.3/etc/hadoop/workers</span><br></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop100</span><br><span class="line">hadoop101</span><br><span class="line">hadoop102</span><br></pre></td></tr></table></figure><h3 id="æ ¼å¼åŒ–hdfsæ–‡ä»¶ç³»ç»Ÿ-è°¨æ…ä½¿ç”¨"><a href="#æ ¼å¼åŒ–hdfsæ–‡ä»¶ç³»ç»Ÿ-è°¨æ…ä½¿ç”¨" class="headerlink" title="æ ¼å¼åŒ–hdfsæ–‡ä»¶ç³»ç»Ÿ(è°¨æ…ä½¿ç”¨)"></a>æ ¼å¼åŒ–hdfsæ–‡ä»¶ç³»ç»Ÿ(<em><strong>è°¨æ…ä½¿ç”¨</strong></em>)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br><span class="line"><span class="comment">#hdfs å®‰å…¨æ¨¡å¼ å…³é—­</span></span><br><span class="line">hdfs dfsadmin -safemode leave</span><br><span class="line"><span class="comment">#hdfs å®‰å…¨æ¨¡å¼ å¼ºåˆ¶å…³é—­</span></span><br><span class="line">hdfs dfsadmin -safemode forceExit</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨é›†ç¾¤"><a href="#å¯åŠ¨é›†ç¾¤" class="headerlink" title="å¯åŠ¨é›†ç¾¤"></a>å¯åŠ¨é›†ç¾¤</h3><h4 id="start-dfs-sh-stop-dfs-sh"><a href="#start-dfs-sh-stop-dfs-sh" class="headerlink" title="start-dfs.sh stop-dfs.sh"></a>start-dfs.sh stop-dfs.sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim sbin/start-dfs.sh </span><br><span class="line">vim sbin/stop-dfs.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HDFS_DATANODE_USER=root</span><br><span class="line">HADOOP_SECURE_DN_USER=hdfs</span><br><span class="line">HDFS_NAMENODE_USER=root</span><br><span class="line">HDFS_SECONDARYNAMENODE_USER=root</span><br></pre></td></tr></table></figure><h4 id="start-yarn-sh-stop-yarn-sh"><a href="#start-yarn-sh-stop-yarn-sh" class="headerlink" title="start-yarn.sh stop-yarn.sh"></a>start-yarn.sh stop-yarn.sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim sbin/start-yarn.sh</span><br><span class="line">vim sbin/stop-yarn.sh</span><br><span class="line"></span><br><span class="line">YARN_RESOURCEMANAGER_USER=root</span><br><span class="line">HADOOP_SECURE_DN_USER=yarn</span><br><span class="line">YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure><h3 id="é…ç½®å†å²æœåŠ¡å™¨"><a href="#é…ç½®å†å²æœåŠ¡å™¨" class="headerlink" title="é…ç½®å†å²æœåŠ¡å™¨"></a>é…ç½®å†å²æœåŠ¡å™¨</h3><h4 id="mapred-site-xml-1"><a href="#mapred-site-xml-1" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vim mapred-site.xml</span><br><span class="line">mapred --daemon start historyserver</span><br><span class="line"><span class="comment">&lt;!-- å†å²æœåŠ¡å™¨ç«¯åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop100:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å†å²æœåŠ¡å™¨webç«¯åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop100:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="é…ç½®å†å²èšé›†"><a href="#é…ç½®å†å²èšé›†" class="headerlink" title="é…ç½®å†å²èšé›†"></a>é…ç½®å†å²èšé›†</h3><h4 id="yarn-site-xml-1"><a href="#yarn-site-xml-1" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br><span class="line"><span class="comment">&lt;!-- å¼€å¯æ—¥å¿—èšé›†åŠŸèƒ½ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è®¾ç½®æ—¥å¿—èšé›†æœåŠ¡å™¨åœ°å€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://hadoop101:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è®¾ç½®æ—¥å¿—ä¿ç•™æ—¶é—´ä¸º7å¤© --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å¯åœè„šæœ¬"><a href="#å¯åœè„šæœ¬" class="headerlink" title="å¯åœè„šæœ¬"></a>å¯åœè„šæœ¬</h3><h4 id="myhadoop-sh"><a href="#myhadoop-sh" class="headerlink" title="myhadoop.sh"></a>myhadoop.sh</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">if [ $# -lt 1 ]</span><br><span class="line">then</span><br><span class="line">    echo &quot;No Args Input...&quot;</span><br><span class="line">    exit ;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">case $1 in</span><br><span class="line">&quot;start&quot;)</span><br><span class="line">    echo &quot; =================== å¯åŠ¨ hadoopé›†ç¾¤ ===================&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    echo &quot; --------------- å¯åŠ¨ hdfs ---------------&quot;</span><br><span class="line">    ssh hadoop100 &quot;/opt/module/hadoop-3.1.3/sbin/start-dfs.sh&quot;</span><br><span class="line">    echo &quot; --------------- å¯åŠ¨ yarn ---------------&quot;</span><br><span class="line">    ssh hadoop101 &quot;/opt/module/hadoop-3.1.3/sbin/start-yarn.sh&quot;</span><br><span class="line">    echo &quot; --------------- å¯åŠ¨ historyserver ---------------&quot;</span><br><span class="line">    ssh hadoop100 &quot;/opt/module/hadoop-3.1.3/bin/mapred --daemon start historyserver&quot;</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;stop&quot;)</span><br><span class="line">    echo &quot; =================== å…³é—­ hadoopé›†ç¾¤ ===================&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    echo &quot; --------------- å…³é—­ historyserver ---------------&quot;</span><br><span class="line">    ssh hadoop100 &quot;/opt/module/hadoop-3.1.3/bin/mapred --daemon stop historyserver&quot;</span><br><span class="line">    echo &quot; --------------- å…³é—­ yarn ---------------&quot;</span><br><span class="line">    ssh hadoop101 &quot;/opt/module/hadoop-3.1.3/sbin/stop-yarn.sh&quot;</span><br><span class="line">    echo &quot; --------------- å…³é—­ hdfs ---------------&quot;</span><br><span class="line">    ssh hadoop100 &quot;/opt/module/hadoop-3.1.3/sbin/stop-dfs.sh&quot;</span><br><span class="line">;;</span><br><span class="line">&quot;status&quot;)</span><br><span class="line">    echo &quot; =================== hadoopé›†ç¾¤çŠ¶æ€ ===================&quot;</span><br><span class="line">   for host in hadoop100 hadoop101 hadoop102</span><br><span class="line">do</span><br><span class="line">        echo =============== $host ===============</span><br><span class="line">        ssh $host jps </span><br><span class="line">done</span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><h3 id="åŒæ­¥è„šæœ¬"><a href="#åŒæ­¥è„šæœ¬" class="headerlink" title="åŒæ­¥è„šæœ¬"></a>åŒæ­¥è„šæœ¬</h3><p>åœ¨<code>/root/bin</code>ç›®å½•ä¸‹åˆ›å»º<code>xsync</code>æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1. åˆ¤æ–­å‚æ•°ä¸ªæ•°</span></span><br><span class="line">if [ $# -lt 1 ]</span><br><span class="line">then</span><br><span class="line">    echo &quot;è¯·è¾“å…¥æ–‡ä»¶ç›®å½•çš„è·¯å¾„&quot;</span><br><span class="line">    exit;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2. éå†é›†ç¾¤æ‰€æœ‰æœºå™¨</span></span><br><span class="line">for host in hadoop100 hadoop101 hadoop102 </span><br><span class="line">do</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    echo ==================== $host ====================</span><br><span class="line">    #3. éå†æ‰€æœ‰â½¬å½•ï¼ŒæŒ¨ä¸ªå‘é€</span><br><span class="line">    for file in $@</span><br><span class="line">    do</span><br><span class="line">        #4. åˆ¤æ–­â½‚ä»¶æ˜¯å¦å­˜åœ¨</span><br><span class="line">        if [ -e $file ]</span><br><span class="line">        then</span><br><span class="line">            #5. è·å–çˆ¶ç›®å½•</span><br><span class="line">            pdir=$(cd -P $(dirname $file); pwd)</span><br><span class="line">            #6. è·å–å½“å‰â½‚ä»¶çš„åç§°</span><br><span class="line">            fname=$(basename $file)</span><br><span class="line">            rsync -av $pdir/$fname $host:$pdir</span><br><span class="line">        else</span><br><span class="line">            echo &quot;æ–‡ä»¶ä¸å­˜åœ¨ $file&quot;</span><br><span class="line">        fi</span><br><span class="line">     done</span><br><span class="line">done</span><br><span class="line">xsync abc </span><br></pre></td></tr></table></figure><hr><p>ä¿®æ”¹è„šæœ¬<code>xsync</code>å…·æœ‰æ‰§è¡Œæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x xsync</span><br></pre></td></tr></table></figure><h4 id="ç»“æœæˆªå›¾"><a href="#ç»“æœæˆªå›¾" class="headerlink" title="ç»“æœæˆªå›¾"></a>ç»“æœæˆªå›¾</h4><p><img src="/2025/06/24/Hadoop/image-20250701144157828.png" alt="image-20250701144157828"></p><p><img src="/2025/06/24/Hadoop/image-20250701144252469.png" alt="image-20250701144252469"></p><p><img src="/2025/06/24/Hadoop/image-20250701144309728.png" alt="image-20250701144309728"></p><h1 id="hadoopå¤§æ•°æ®å¹³å°-hiveç»„ä»¶éƒ¨ç½²ä»‹ç»"><a href="#hadoopå¤§æ•°æ®å¹³å°-hiveç»„ä»¶éƒ¨ç½²ä»‹ç»" class="headerlink" title="hadoopå¤§æ•°æ®å¹³å°-hiveç»„ä»¶éƒ¨ç½²ä»‹ç»"></a>hadoopå¤§æ•°æ®å¹³å°-hiveç»„ä»¶éƒ¨ç½²ä»‹ç»</h1><p><img src="/2025/06/24/Hadoop/image-20250701143412258.png" alt="image-20250701143412258"></p><h1 id="Hadoopå¹³å°-è¿›ç¨‹å¯åœå‘½ä»¤"><a href="#Hadoopå¹³å°-è¿›ç¨‹å¯åœå‘½ä»¤" class="headerlink" title="Hadoopå¹³å°-è¿›ç¨‹å¯åœå‘½ä»¤"></a>Hadoopå¹³å°-è¿›ç¨‹å¯åœå‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.æ—¥å¿—æœåŠ¡å¯åœå‘½ä»¤</span></span><br><span class="line">mapred --daemon start historyserver</span><br><span class="line"><span class="comment">#2.HDFSæ–‡ä»¶ç³»ç»ŸæœåŠ¡å¯åœå‘½ä»¤</span></span><br><span class="line">hdfs --daemon start namenode/datanode/secondarynamenode</span><br><span class="line"><span class="comment">#4.YarnæœåŠ¡å¯åœå‘½ä»¤</span></span><br><span class="line">yarn --daemon start/stop  resourcemanager/nodemanager</span><br></pre></td></tr></table></figure><h1 id="Hadoopå¹³å°-HDFSæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤"><a href="#Hadoopå¹³å°-HDFSæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="Hadoopå¹³å°-HDFSæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤"></a>Hadoopå¹³å°-HDFSæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">-<span class="built_in">ls</span> [-C] [-d] [-h] [-q] [-R] [-t] [-S] [-r] [-u] [-e] [&lt;path&gt; ...]:  <span class="comment">#æŸ¥çœ‹æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æˆ–ç›®å½•åˆ—è¡¨ã€‚</span></span><br><span class="line">-<span class="built_in">mkdir</span> [-p] &lt;path&gt; ...:  <span class="comment">#åˆ›å»ºæ–°çš„æ–‡ä»¶å¤¹ã€‚</span></span><br><span class="line">-moveFromLocal &lt;localsrc&gt; ... &lt;dst&gt;:  <span class="comment">#ä»æœ¬åœ°ç§»åŠ¨æ–‡ä»¶åˆ°HDFSã€‚</span></span><br><span class="line">-moveToLocal &lt;src&gt; &lt;localdst&gt;:  <span class="comment">#å°†æ–‡ä»¶ä»HDFSç§»åŠ¨åˆ°æœ¬åœ°ã€‚</span></span><br><span class="line">-<span class="built_in">mv</span> &lt;src&gt; ... &lt;dst&gt;:  <span class="comment">#åœ¨HDFSæ–‡ä»¶ç³»ç»Ÿå†…ç§»åŠ¨æ–‡ä»¶ã€‚</span></span><br><span class="line">-put [-f] [-p] [-l] [-d] &lt;localsrc&gt; ... &lt;dst&gt;:  <span class="comment">#ä¸Šä¼ æ–‡ä»¶åˆ°HDFSã€‚</span></span><br><span class="line">-renameSnapshot &lt;snapshotDir&gt; &lt;oldName&gt; &lt;newName&gt;:  <span class="comment">#é‡å‘½åæŒ‡å®šç›®å½•ä¸‹çš„å¿«ç…§ã€‚</span></span><br><span class="line">-<span class="built_in">rm</span> [-f] [-r|-R] [-skipTrash] [-safely] &lt;src&gt; ...:  <span class="comment">#åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼ˆåªèƒ½åˆ é™¤ç©ºæ–‡ä»¶å¤¹ï¼‰ã€‚</span></span><br><span class="line">-<span class="built_in">rmdir</span> [--ignore-fail-on-non-empty] &lt;<span class="built_in">dir</span>&gt; ...:  <span class="comment">#åˆ é™¤ç©ºæ–‡ä»¶å¤¹ï¼Œå¯ä»¥ä½¿ç”¨`--ignore-fail-on-non-empty`é€‰é¡¹åˆ é™¤éç©ºæ–‡ä»¶å¤¹ã€‚</span></span><br><span class="line">-setfacl [-R] [&#123;-b|-k&#125; &#123;-m|-x &lt;acl_spec&gt;&#125; &lt;path&gt;]|[--<span class="built_in">set</span> &lt;acl_spec&gt; &lt;path&gt;]:  <span class="comment">#è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„ACLï¼ˆè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼‰ã€‚</span></span><br><span class="line">-setfattr &#123;-n name [-v value] | -x name&#125; &lt;path&gt;:  <span class="comment">#è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æ‰©å±•å±æ€§ã€‚</span></span><br><span class="line">-setrep [-R] [-w] &lt;rep&gt; &lt;path&gt; ...:  <span class="comment">#è®¾ç½®æ–‡ä»¶çš„å‰¯æœ¬æ•°é‡ã€‚</span></span><br><span class="line">-<span class="built_in">stat</span> [format] &lt;path&gt; ...:  <span class="comment">#æ˜¾ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ã€‚</span></span><br><span class="line">-<span class="built_in">tail</span> [-f] [-s &lt;<span class="built_in">sleep</span> interval&gt;] &lt;file&gt;:  <span class="comment">#æŸ¥çœ‹æ–‡ä»¶çš„æœ«å°¾éƒ¨åˆ†å†…å®¹ã€‚</span></span><br><span class="line">-<span class="built_in">test</span> -[defsz] &lt;path&gt;:  <span class="comment">#æµ‹è¯•æ–‡ä»¶çš„å­˜åœ¨æ€§ã€ç›®å½•çš„ç©ºæˆ–éç©ºç­‰å±æ€§ã€‚</span></span><br><span class="line">-text [-ignoreCrc] &lt;src&gt; ...:  <span class="comment">#ä»¥æ–‡æœ¬å½¢å¼æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ã€‚</span></span><br><span class="line">-<span class="built_in">touch</span> [-a] [-m] [-t TIMESTAMP ] [-c] &lt;path&gt; ...:  <span class="comment">#åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶æˆ–è€…æ›´æ–°å·²æœ‰æ–‡ä»¶çš„æ—¶é—´æˆ³ã€‚</span></span><br><span class="line">-touchz &lt;path&gt; ...:  <span class="comment">#åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ã€‚</span></span><br><span class="line">-<span class="built_in">truncate</span> [-w] &lt;length&gt; &lt;path&gt; ...:  <span class="comment">#æ¸…ç©ºæ–‡ä»¶å†…å®¹æˆ–è€…å°†æ–‡ä»¶æˆªæ–­åˆ°æŒ‡å®šçš„é•¿åº¦ã€‚</span></span><br><span class="line">-usage [cmd ...]:  <span class="comment">#æ˜¾ç¤ºHDFSå‘½ä»¤çš„ç”¨æ³•ä¿¡æ¯ã€‚</span></span><br><span class="line"></span><br><span class="line">-appendToFile &lt;localsrc&gt; ... &lt;dst&gt;:  <span class="comment">#å°†æœ¬åœ°ç›®å½•è¿½åŠ åˆ°HDFSä¸‹çš„æŸä¸ªæ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line">-<span class="built_in">cat</span> [-ignoreCrc] &lt;src&gt; ...:  <span class="comment">#æŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</span></span><br><span class="line">-checksum &lt;src&gt; ...:  <span class="comment">#è®¡ç®—å¹¶ç¡®è®¤æ–‡ä»¶çš„æ ¡éªŒå’Œã€‚</span></span><br><span class="line">-<span class="built_in">chgrp</span> [-R] GROUP PATH...:  <span class="comment">#ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç”¨æˆ·ç»„ã€‚</span></span><br><span class="line">-<span class="built_in">chmod</span> [-R] &lt;MODE[,MODE]... | OCTALMODE&gt; PATH...:  <span class="comment">#ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚</span></span><br><span class="line">-<span class="built_in">chown</span> [-R] [OWNER][:[GROUP]] PATH...:  <span class="comment">#ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç”¨æˆ·ã€‚</span></span><br><span class="line">-copyFromLocal [-f] [-p] [-l] [-d] [-t &lt;thread count&gt;] &lt;localsrc&gt; ... &lt;dst&gt;:  <span class="comment">#ä»æœ¬åœ°å¤åˆ¶æ–‡ä»¶åˆ°HDFSã€‚</span></span><br><span class="line">-copyToLocal [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;:  <span class="comment">#ä»HDFSå¤åˆ¶æ–‡ä»¶åˆ°æœ¬åœ°ã€‚</span></span><br><span class="line">-count [-q] [-h] [-v] [-t [&lt;storage <span class="built_in">type</span>&gt;]] [-u] [-x] [-e] &lt;path&gt; ...:  <span class="comment">#ç»Ÿè®¡æ–‡ä»¶æˆ–ç›®å½•çš„æ•°é‡ã€‚</span></span><br><span class="line">-<span class="built_in">cp</span> [-f] [-p | -p[topax]] [-d] &lt;src&gt; ... &lt;dst&gt;:  <span class="comment">#åœ¨HDFSæ–‡ä»¶ç³»ç»Ÿä¸­æ‹·è´æ–‡ä»¶ã€‚</span></span><br><span class="line">-createSnapshot &lt;snapshotDir&gt; [&lt;snapshotName&gt;]:  <span class="comment">#åˆ›å»ºæŒ‡å®šç›®å½•çš„å¿«ç…§ã€‚</span></span><br><span class="line">-deleteSnapshot &lt;snapshotDir&gt; &lt;snapshotName&gt;:  <span class="comment">#åˆ é™¤æŒ‡å®šç›®å½•ä¸‹çš„å¿«ç…§ã€‚</span></span><br><span class="line">-<span class="built_in">df</span> [-h] [&lt;path&gt; ...]:  <span class="comment">#æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿå‰©ä½™ç©ºé—´ã€‚</span></span><br><span class="line">-<span class="built_in">du</span> [-s] [-h] [-v] [-x] &lt;path&gt; ...:  <span class="comment">#è®¡ç®—æ–‡ä»¶æˆ–ç›®å½•çš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚</span></span><br><span class="line">-expunge:  <span class="comment">#æ¸…ç©ºHDFSåƒåœ¾ç®±ã€‚</span></span><br><span class="line">-find &lt;path&gt; ... &lt;expression&gt; ...:  <span class="comment">#åœ¨æŒ‡å®šè·¯å¾„ä¸‹æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶ã€‚</span></span><br><span class="line">-get [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;:  <span class="comment">#ä»HDFSä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°ã€‚</span></span><br><span class="line">-getfacl [-R] &lt;path&gt;:  <span class="comment">#è·å–æ–‡ä»¶æˆ–ç›®å½•çš„ACLï¼ˆè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼‰ä¿¡æ¯ã€‚</span></span><br><span class="line">-getfattr [-R] &#123;-n name | -d&#125; [-e en] &lt;path&gt;:  <span class="comment">#è·å–æ–‡ä»¶æˆ–ç›®å½•çš„æ‰©å±•å±æ€§ä¿¡æ¯ã€‚</span></span><br><span class="line">-getmerge [-<span class="built_in">nl</span>] [-skip-empty-file] &lt;src&gt; &lt;localdst&gt;:  <span class="comment">#å°†å¤šä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶å¹¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚</span></span><br><span class="line">-<span class="built_in">head</span> &lt;file&gt;:  <span class="comment">#æŸ¥çœ‹æ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†å†…å®¹ã€‚</span></span><br><span class="line">-<span class="built_in">help</span> [cmd ...]:  <span class="comment">#è·å–HDFSå‘½ä»¤çš„å¸®åŠ©ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Hadoopå¹³å°-HDFSä¼˜ç¼ºç‚¹"><a href="#Hadoopå¹³å°-HDFSä¼˜ç¼ºç‚¹" class="headerlink" title="Hadoopå¹³å°-HDFSä¼˜ç¼ºç‚¹"></a>Hadoopå¹³å°-HDFSä¼˜ç¼ºç‚¹</h1><p><strong>HDFSç»„ä»¶ç”¨äºå­˜å‚¨æ•°æ®,ä¸»è¦ç”±*NameNode,DataNode,SecondaryNameNode ç»„æˆ</strong></p><p><img src="/2025/06/24/Hadoop/image-20250701144959041.png" alt="image-20250701144959041"></p><h1 id="Hadoopå¹³å°-HDFSè¯»å–æµç¨‹"><a href="#Hadoopå¹³å°-HDFSè¯»å–æµç¨‹" class="headerlink" title="Hadoopå¹³å°-HDFSè¯»å–æµç¨‹"></a>Hadoopå¹³å°-HDFSè¯»å–æµç¨‹</h1><p><img src="/2025/06/24/Hadoop/image-20250701145056181.png" alt="image-20250701145056181"></p><h1 id="Hadoopå¹³å°-NameNodeæ›´æ–°æµç¨‹"><a href="#Hadoopå¹³å°-NameNodeæ›´æ–°æµç¨‹" class="headerlink" title="Hadoopå¹³å°-NameNodeæ›´æ–°æµç¨‹"></a>Hadoopå¹³å°-NameNodeæ›´æ–°æµç¨‹</h1><p><img src="/2025/06/24/Hadoop/image-20250701145144059.png" alt="image-20250701145144059"></p><h1 id="Hadoopå¹³å°-yarnå·¥ä½œæµç¨‹"><a href="#Hadoopå¹³å°-yarnå·¥ä½œæµç¨‹" class="headerlink" title="Hadoopå¹³å°-yarnå·¥ä½œæµç¨‹"></a>Hadoopå¹³å°-yarnå·¥ä½œæµç¨‹</h1><p><img src="/2025/06/24/Hadoop/image-20250701145303204.png" alt="image-20250701145303204"></p><h1 id="Hadoopå¹³å°-mapreduceå·¥ä½œæµç¨‹"><a href="#Hadoopå¹³å°-mapreduceå·¥ä½œæµç¨‹" class="headerlink" title="Hadoopå¹³å°-mapreduceå·¥ä½œæµç¨‹"></a>Hadoopå¹³å°-mapreduceå·¥ä½œæµç¨‹</h1><p><img src="/2025/06/24/Hadoop/image-20250701145353344.png" alt="image-20250701145353344"></p><h1 id="ä»€ä¹ˆæ˜¯HIVE"><a href="#ä»€ä¹ˆæ˜¯HIVE" class="headerlink" title="ä»€ä¹ˆæ˜¯HIVE"></a>ä»€ä¹ˆæ˜¯HIVE</h1><p>Hive æ˜¯<strong>åŸºäº Hadoop çš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…·</strong>ã€‚ä»¥ä¸‹æ˜¯å…·ä½“ä»‹ç»:</p><ul><li><strong>åŠŸèƒ½ç‰¹ç‚¹</strong>ï¼šHive å¯ä»¥<strong>å°†ç»“æ„åŒ–çš„æ•°æ®æ–‡ä»¶æ˜ å°„ä¸ºä¸€å¼ æ•°æ®åº“è¡¨</strong>ï¼Œå¹¶æä¾›å®Œæ•´çš„ SQL æŸ¥è¯¢åŠŸèƒ½ï¼Œèƒ½å°† SQL è¯­å¥è½¬æ¢ä¸º MapReduce ä»»åŠ¡è¿›è¡Œè¿è¡Œã€‚å®ƒå…è®¸ç†Ÿæ‚‰ SQL çš„ç”¨æˆ·æ–¹ä¾¿åœ°æŸ¥è¯¢æ•°æ®ï¼Œä¹Ÿæ”¯æŒç†Ÿæ‚‰ MapReduce çš„å¼€å‘è€…è‡ªå®šä¹‰ mapper å’Œ reducerï¼Œä»¥å¤„ç†å¤æ‚çš„åˆ†æå·¥ä½œã€‚</li><li><strong>ä¼˜åŠ¿</strong>ï¼šå­¦ä¹ æˆæœ¬ä½ï¼Œé€šè¿‡ç±» SQL è¯­å¥å¯å¿«é€Ÿå®ç°ç®€å•çš„ MapReduce ç»Ÿè®¡ï¼Œæ— éœ€å¼€å‘ä¸“é—¨çš„ MapReduce åº”ç”¨ï¼Œååˆ†é€‚åˆæ•°æ®ä»“åº“çš„ç»Ÿè®¡åˆ†æã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¸¸ç”¨äºå¯¹æ—¶æ•ˆæ€§è¦æ±‚ä¸é«˜çš„æ•°æ®åˆ†æåœºæ™¯ã€‚ç”±äº <strong>Hive åº•å±‚ä¾èµ– Hadoop çš„ HDFS å­˜å‚¨æ•°æ®</strong>ï¼Œåˆ©ç”¨ MapReduce è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤èƒ½å¤Ÿå¤„ç†å¤§è§„æ¨¡çš„æ•°æ®ï¼Œåœ¨å¤„ç†æµ·é‡ç»“æ„åŒ–æ—¥å¿—çš„æ•°æ®ç»Ÿè®¡ç­‰æ–¹é¢åº”ç”¨å¹¿æ³›ã€‚</li><li><strong>ä¸æ•°æ®åº“çš„åŒºåˆ«</strong>ï¼š<ol><li>æ•°æ®åº“ä¸€èˆ¬ç”¨äºåœ¨çº¿åº”ç”¨ï¼Œæ”¯æŒå¯¹æŸä¸€è¡Œæˆ–æŸäº›è¡Œæ•°æ®çš„æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œï¼Œé‡‡ç”¨ â€œå†™æ—¶æ¨¡å¼â€ï¼Œæ•°æ®åŠ è½½æ…¢ä½†æŸ¥è¯¢å¿«ã€‚</li><li>è€Œ Hive ä¸æ”¯æŒå¯¹å…·ä½“è¡Œçš„æ“ä½œï¼Œä¹Ÿä¸æ”¯æŒäº‹åŠ¡å’Œç´¢å¼•ï¼Œé‡‡ç”¨ â€œè¯»æ—¶æ¨¡å¼â€ï¼Œé€‚åˆå¤„ç†éç»“æ„åŒ–æˆ–å­˜å‚¨æ¨¡å¼æœªçŸ¥çš„æ•°æ®ï¼Œæ›´ä¾§é‡äºå¯¹æµ·é‡æ•°æ®çš„æ‰¹é‡å¤„ç†å’Œåˆ†æã€‚</li></ol></li></ul><h1 id="HIVEå®‰è£…"><a href="#HIVEå®‰è£…" class="headerlink" title="HIVEå®‰è£…"></a>HIVEå®‰è£…</h1><h2 id="é…ç½®mysqlå®‰è£…æº"><a href="#é…ç½®mysqlå®‰è£…æº" class="headerlink" title="é…ç½®mysqlå®‰è£…æº"></a>é…ç½®mysqlå®‰è£…æº</h2><p>ï¼ˆåœ¨çº¿å®‰è£…æ–¹æ³•ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸‹è½½å®‰è£…æº</span></span><br><span class="line">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… mysql æº</span></span><br><span class="line">yum localinstall mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="comment"># å¯¼å…¥key</span></span><br><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br><span class="line"><span class="comment"># ä¿®æ”¹å›½å†…æº</span></span><br><span class="line">vim /etc/yum.repos.d/mysql-community.repo</span><br><span class="line">ä¿®æ”¹ baseurl ä¸º https://mirrors.cloud.tencent.com/mysql/yum/mysql-5.7-community-el7-x86_64/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…mysql</span></span><br><span class="line">yum install -y mysql-community-server</span><br></pre></td></tr></table></figure><ol><li>å®‰è£…mysql ï¼ˆæœ¬åœ°å®‰è£…æ–¹æ³•ï¼‰</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">00#rpmåŒ…å®‰è£…</span><br><span class="line"><span class="comment">#tar -zvxf mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz  -C /usr/local/mysql</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.è§£å‹ï¼š</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line">tar -zxvf mysql-5.7.22-linux-glibc2.12-x86_64.tar</span><br><span class="line"><span class="built_in">mv</span> mysql-5.7.22-linux-glibc2.12-x86_64 mysql-5.7.22</span><br><span class="line"><span class="built_in">ln</span> -s mysql-5.7.22 mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.æ·»åŠ ç”¨æˆ·ç»„å’Œç”¨æˆ·</span></span><br><span class="line"><span class="comment">#æ·»åŠ ç”¨æˆ·ç»„</span></span><br><span class="line">groupadd mysql</span><br><span class="line"><span class="comment">#æ·»åŠ ç”¨æˆ·mysql åˆ°ç”¨æˆ·ç»„mysql</span></span><br><span class="line">useradd -g mysql mysql</span><br><span class="line"><span class="comment">#4.å®‰è£…</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/mysql</span><br><span class="line"><span class="built_in">mkdir</span> data</span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql ./</span><br><span class="line">./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql/m<span class="string">&#x27;y&#x27;</span>s<span class="string">&#x27;q --datadir=/usr/local/mysql/data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#å°†mysql/ç›®å½•ä¸‹é™¤äº†data/ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ”¹å›rootç”¨æˆ·æ‰€æœ‰</span></span><br><span class="line"><span class="string">chown -R root .</span></span><br><span class="line"><span class="string">#mysqlç”¨æˆ·åªéœ€ä½œä¸ºmysql-5.7.22/data/ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰è€…</span></span><br><span class="line"><span class="string">chown -R mysql data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#5.å¤åˆ¶å¯åŠ¨æ–‡ä»¶</span></span><br><span class="line"><span class="string">cp support-files/mysql.server /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">chmod 755 /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">cp bin/my_print_defaults /usr/bin/ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.ä¿®æ”¹å¯åŠ¨è„šæœ¬</span></span><br><span class="line"><span class="string">vi /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">#ä¿®æ”¹é¡¹ï¼š</span></span><br><span class="line"><span class="string">basedir=/usr/local/mysql-5.7.22/</span></span><br><span class="line"><span class="string">datadir=/usr/local/mysql-5.7.22/data</span></span><br><span class="line"><span class="string">port=3306</span></span><br><span class="line"><span class="string">#åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘ /etc/profileï¼Œè¿™æ ·å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç”¨mysqlå‘½ä»¤äº†</span></span><br><span class="line"><span class="string">vi ~/.bash_profile</span></span><br><span class="line"><span class="string">#æ·»åŠ mysqlè·¯å¾„ï¼ŒåŠ å…¥ä¸‹é¢å†…å®¹ï¼ŒæŒ‰ESC--&gt;:wqä¿å­˜</span></span><br><span class="line"><span class="string">export PATH=$PATH:/usr/local/mysql-5.7.22/bin</span></span><br><span class="line"><span class="string">#åˆ·æ–°ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="string">source ~/.bash_profile</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#7.ä¿®æ”¹mysqlé…ç½®é¡¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vi /etc/my.cnf</span></span><br><span class="line"><span class="string">#é…ç½®å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string">basedir = /usr/local/mysql</span></span><br><span class="line"><span class="string">datadir = /usr/local/mysql/data</span></span><br><span class="line"><span class="string">socket = /tmp/mysql.sock</span></span><br><span class="line"><span class="string">user = mysql</span></span><br><span class="line"><span class="string">tmpdir = /tmp</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld_safe]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">log-error = /usr/local/mysql/data/error.log</span></span><br><span class="line"><span class="string">pid-file = /usr/local/mysql/data/mysql.pid</span></span><br><span class="line"><span class="string">#!includedir /etc/my.cnf.d</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#8.å¯åŠ¨mysql</span></span><br><span class="line"><span class="string">service mysqld start</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#å¦‚å¯åŠ¨å¤±è´¥ï¼Œåˆ é™¤ /usr/local/mysql-5.7.22/dataä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œé‡æ–°æ‰§è¡Œ./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/dataï¼Œå†å¯åŠ¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#9.è¿›å…¥mysqlä¿®æ”¹åˆå§‹å¯†ç ï¼Œä¿®æ”¹è¿œç¨‹è¿æ¥çš„ç”¨æˆ·æƒé™é—®é¢˜</span></span><br><span class="line"><span class="string">mysql -uroot -p</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ALTER USER &#x27;</span>root<span class="string">&#x27;@&#x27;</span>localhost<span class="string">&#x27; IDENTIFIED BY &#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">use mysql;</span></span><br><span class="line"><span class="string">UPDATE user SET host=&#x27;</span>%<span class="string">&#x27; WHERE user=&#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">flush privileges;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#å¼€æœºè‡ªå¯åŠ¨</span></span><br><span class="line"><span class="string">chkconfig --add mysqld</span></span><br><span class="line"><span class="string">chkconfig mysqld on</span></span><br><span class="line"><span class="string">chkconfig --list</span></span><br><span class="line"><span class="string">  mysqld          0:å…³    1:å…³    2:å¼€    3:å¼€    4:å¼€    5:å¼€    6:å…³</span></span><br></pre></td></tr></table></figure><ol><li>é…ç½®mysql</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¯åŠ¨mysql æœåŠ¡</span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"><span class="comment">#è®¾ç½®å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld</span><br><span class="line"><span class="comment"># é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="comment"># å…³é—­å¯†ç éªŒè¯</span></span><br><span class="line">vim /etc/my.cnf</span><br><span class="line"><span class="comment"># mysqldé€‰é¡¹ä¸‹åŠ å…¥</span></span><br><span class="line">validate_password=OFF</span><br><span class="line"><span class="comment">#é‡å¯mysqlæœåŠ¡</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="comment"># å¾—åˆ°ä¸´æ—¶å¯†ç </span></span><br><span class="line">grep <span class="string">&#x27;temporary password&#x27;</span> /var/log/mysqld.log</span><br><span class="line"><span class="comment">#ç™»å½•mysql</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="comment"># å¼€å‘ç¯å¢ƒ ä¿®æ”¹å¯†ç ä¸ºroot</span></span><br><span class="line">ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="comment">#ä¿®æ”¹rootè´¦å·ç™»å½•é™åˆ¶</span></span><br><span class="line">use mysql;</span><br><span class="line">UPDATE user SET host=<span class="string">&#x27;%&#x27;</span> WHERE user=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">flush privileges; </span><br><span class="line"><span class="comment">#åˆ›å»ºmetastoreå…ƒæ•°æ®åº“</span></span><br><span class="line">create database metastore</span><br><span class="line">DEFAULT CHARACTER SET utf8</span><br><span class="line">DEFAULT COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…HIVE"><a href="#å®‰è£…HIVE" class="headerlink" title="å®‰è£…HIVE"></a>å®‰è£…HIVE</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å‹apache-hive-3.1.2-bin.tar.gzåˆ°/opt/module/ç›®å½•ä¸‹é¢</span></span><br><span class="line">   tar -zxvf apache-hive-3.1.2-bin.tar.gz -C /opt/module/</span><br><span class="line"><span class="comment">#ä¿®æ”¹`/etc/profile.d/my_env.sh`ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡</span></span><br><span class="line">   vim /etc/profile.d/my_env.sh</span><br><span class="line"><span class="comment">#æ·»åŠ å†…å®¹</span></span><br><span class="line"><span class="comment">#HIVE_HOME</span></span><br><span class="line">   <span class="built_in">export</span> HIVE_HOME=/opt/module/apache-hive-3.1.2-bin</span><br><span class="line">   <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br><span class="line"><span class="comment">#åˆ·æ–°ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><ol><li>hiveåŸºç¡€é…ç½®</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å†³æ—¥å¿—JaråŒ…å†²çª</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.10.0.jar <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.10.0.bak</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‹·è´mysql-connector.jaråˆ°libåº“</span></span><br><span class="line"><span class="built_in">cp</span> /opt/software/mysql-connector-java-5.1.27-bin.jar <span class="variable">$HIVE_HOME</span>/lib</span><br></pre></td></tr></table></figure><ol><li><p>é…ç½®hive-site.xml</p><p>æŒ‘è½¬åˆ°<code>/opt/module/apache-hive-3.1.2-bin/conf/</code>ç›®å½•æ–°å»ºæ–‡ä»¶ hive-site.xml</p></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„URL--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://hadoop100:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„Driver--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„username--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbcè¿æ¥çš„password--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Hiveå…ƒæ•°æ®å­˜å‚¨ç‰ˆæœ¬çš„éªŒè¯--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å…ƒæ•°æ®å­˜å‚¨æˆæƒ--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Hiveé»˜è®¤åœ¨HDFSçš„å·¥ä½œç›®å½•--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.enable.doAs<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å–æ¶ˆæœ¬åœ°æ¨¡å¼æ”¹ä¸ºfalse--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.mode.local.auto<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.map.child.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx2048m<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>åˆå§‹åŒ–Hiveå…ƒæ•°æ®åº“</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql -verbose</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–mapreduce"><a href="#ä¼˜åŒ–mapreduce" class="headerlink" title="ä¼˜åŒ–mapreduce"></a>ä¼˜åŒ–mapreduce</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure><p>å¢åŠ é…ç½®</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1536<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx1024M<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3072<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx2560M<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®beeline"><a href="#é…ç½®beeline" class="headerlink" title="é…ç½®beeline"></a>é…ç½®beeline</h2><p>é…ç½®core-site.xml ä½¿å…¶ä»»æ„èŠ‚ç‚¹éƒ½å¯ä»¥è®¿é—®hadoop</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;*&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;*&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><ol><li>å¯åŠ¨ hiveserver2</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å‰ç«¯å¯åŠ¨</span></span><br><span class="line">hiveserver2</span><br><span class="line"><span class="comment">#åå°å¯åŠ¨</span></span><br><span class="line"><span class="built_in">nohup</span> hiveserver2 &amp;</span><br></pre></td></tr></table></figure><ol><li>ç™»å½•å‘½ä»¤</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beeline -u jdbc:hive2://localhost:10000 -n root -p 123456 [å¯†ç éšæ„]</span><br><span class="line">beeline -u jdbc:hive2://localhost:10000 -n root -p 123456  -e <span class="string">&#x27;show tables;&#x27;</span> </span><br></pre></td></tr></table></figure><ol><li>dbeaverç™»å½•</li></ol><ul><li>è·å–æ–‡ä»¶ hadoop-common-3.1.3.jar</li><li>è·å–æ–‡ä»¶ hive-jdbc-3.1.2-standalone.jar</li><li>æ·»åŠ hiveæ•°æ®åº“é“¾æ¥</li></ul><h1 id="hive-æ•°æ®æ“ä½œè¯­å¥"><a href="#hive-æ•°æ®æ“ä½œè¯­å¥" class="headerlink" title="hive æ•°æ®æ“ä½œè¯­å¥"></a><strong>hive</strong> æ•°æ®æ“ä½œè¯­å¥</h1><h2 id="å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥"><a href="#å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥" class="headerlink" title="å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥"></a>å…ƒæ•°æ®æŸ¥çœ‹è¯­å¥</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥çœ‹æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">show</span>  database db_hive</span><br><span class="line"><span class="comment">--è¿‡æ»¤æŸ¥çœ‹æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">show</span> databases <span class="keyword">like</span> <span class="string">&#x27;db_hive*&#x27;</span>;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¯¦æƒ…</span></span><br><span class="line"><span class="keyword">desc</span> database db_hive</span><br><span class="line"><span class="keyword">desc</span> database extended db_hive;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¡¨</span></span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¡¨åˆ—è¯¦æƒ…</span></span><br><span class="line"><span class="keyword">desc</span> dept;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹è¡¨æ‰€æœ‰è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">desc</span> extended emp;</span><br><span class="line"><span class="keyword">show</span> formatted emp;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹åˆ†åŒºä¿¡æ¯</span></span><br><span class="line"><span class="keyword">show</span> partitions emp;</span><br></pre></td></tr></table></figure><h2 id="å»ºåº“æ“ä½œ"><a href="#å»ºåº“æ“ä½œ" class="headerlink" title="å»ºåº“æ“ä½œ"></a>å»ºåº“æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºæ•°æ®åº“</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] database_name</span><br><span class="line">[COMMENT database_comment]</span><br><span class="line">[LOCATION hdfs_path]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å»ºè¡¨æ“ä½œ"><a href="#å»ºè¡¨æ“ä½œ" class="headerlink" title="å»ºè¡¨æ“ä½œ"></a>å»ºè¡¨æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name <span class="comment">--å†…éƒ¨è¡¨</span></span><br><span class="line">[(col_name data_type [COMMENT col_comment], ...)] <span class="comment">--æ•°æ®ç±»å‹ </span></span><br><span class="line">[COMMENT table_comment] </span><br><span class="line">[PARTITIONED <span class="keyword">BY</span> (col_name data_type [COMMENT col_comment], ...)] <span class="comment">--åˆ†åŒºè¡¨</span></span><br><span class="line">[CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) </span><br><span class="line">[SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], ...)] <span class="keyword">INTO</span> num_buckets BUCKETS] <span class="comment">--åˆ†æ¡¶è¡¨</span></span><br><span class="line">[<span class="type">ROW</span> FORMAT DELIMITED <span class="comment">--æ•°æ®æ ¼å¼</span></span><br><span class="line">[FIELDS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--åˆ—åˆ†éš”</span></span><br><span class="line">[COLLECTION ITEMS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--å¤åˆæ•°æ®itemåˆ†éš”</span></span><br><span class="line">[MAP KEYS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--å¤åˆæ•°æ®keyåˆ†éš”</span></span><br><span class="line">[LINES TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]] <span class="comment">--è¡Œåˆ†éš”</span></span><br><span class="line">[STORED <span class="keyword">AS</span> file_format] <span class="comment">--å‹ç¼©æ ¼å¼</span></span><br><span class="line">[LOCATION hdfs_path] <span class="comment">--è¡¨æ•°æ®æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">[TBLPROPERTIES (property_name<span class="operator">=</span>property_value, ...)] <span class="comment">--å†…å¤–éƒ¨è¡¨è½¬æ¢</span></span><br><span class="line">[<span class="keyword">AS</span> select_statement]</span><br></pre></td></tr></table></figure><h2 id="ä¸Šä¼ æ•°æ®"><a href="#ä¸Šä¼ æ•°æ®" class="headerlink" title="ä¸Šä¼ æ•°æ®"></a>ä¸Šä¼ æ•°æ®</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--load</span></span><br><span class="line">load data [<span class="keyword">local</span>] inpath <span class="string">&#x27;æ•°æ®çš„path&#x27;</span> [overwrite] <span class="keyword">into</span> <span class="keyword">table</span> student [<span class="keyword">partition</span> (partcol1<span class="operator">=</span>val1,â€¦)];</span><br><span class="line"></span><br><span class="line"><span class="comment">--ä¸Šä¼ hdfs</span></span><br><span class="line">dfs <span class="operator">-</span>put <span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>hive<span class="operator">/</span>datas<span class="operator">/</span>student.txt <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>atguigu<span class="operator">/</span>hive;</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span>  student_par <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;wangwu&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;zhaoliu&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¦†ç›–æ’å…¥å¹¶ä¸”ä½¿ç”¨ç»“æœé›†è¿›è¡Œæ’å…¥</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> student_par <span class="keyword">select</span> id, name <span class="keyword">from</span> student ;</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½æ•°æ®"><a href="#ä¸‹è½½æ•°æ®" class="headerlink" title="ä¸‹è½½æ•°æ®"></a>ä¸‹è½½æ•°æ®</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;æ•°æ®çš„path&#x27;</span></span><br><span class="line"><span class="type">ROW</span> FORMAT DELIMITED FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\t&#x27;</span> dql_command;</span><br><span class="line"></span><br><span class="line"><span class="comment">--hadoop å¯¼å‡º</span></span><br><span class="line">dfs <span class="operator">-</span><span class="keyword">get</span> <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>hive<span class="operator">/</span>warehouse<span class="operator">/</span>student<span class="operator">/</span>student.txt</span><br><span class="line"><span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>datas<span class="operator">/</span>export<span class="operator">/</span>student3.txt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--hive shellå¯¼å‡º</span></span><br><span class="line">bin<span class="operator">/</span>hive <span class="operator">-</span>e <span class="string">&#x27;select * from default.student;&#x27;</span> <span class="operator">&gt;</span></span><br><span class="line"><span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>hive<span class="operator">/</span>datas<span class="operator">/</span>export<span class="operator">/</span>student4.txt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--exportå¯¼å‡º</span></span><br><span class="line"> export <span class="keyword">table</span> default.student <span class="keyword">to</span></span><br><span class="line"> <span class="string">&#x27;/user/hive/warehouse/export/student&#x27;</span>; </span><br></pre></td></tr></table></figure><h2 id="selectè¯­å¥"><a href="#selectè¯­å¥" class="headerlink" title="selectè¯­å¥"></a>selectè¯­å¥</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>] select_expr, select_expr, ...</span><br><span class="line">Â Â <span class="keyword">FROM</span> table_reference</span><br><span class="line">Â Â [<span class="keyword">WHERE</span> where_condition]</span><br><span class="line">Â Â [<span class="keyword">GROUP</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">Â Â [<span class="keyword">ORDER</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">Â Â [CLUSTER <span class="keyword">BY</span> col_list</span><br><span class="line">Â Â Â Â <span class="operator">|</span> [DISTRIBUTE <span class="keyword">BY</span> col_list] [SORT <span class="keyword">BY</span> col_list]</span><br><span class="line">Â Â ]</span><br><span class="line">Â [LIMIT number]</span><br></pre></td></tr></table></figure><h1 id="Hiveå¤åˆæ•°æ®ç±»å‹"><a href="#Hiveå¤åˆæ•°æ®ç±»å‹" class="headerlink" title="Hiveå¤åˆæ•°æ®ç±»å‹"></a>Hiveå¤åˆæ•°æ®ç±»å‹</h1><ul><li><p><strong>æ•°ç»„array</strong>: <strong>array&lt;valueæ•°æ®ç±»å‹&gt;</strong></p><ol><li>ç›¸åŒæ•°æ®ç±»å‹</li><li>æœ‰åºçš„æ’åˆ—</li><li>ä¸‹æ ‡ä¸ºæ•°å­—</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥è¯¢å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span>  a_score[<span class="number">0</span>] <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ„é€ å¤åˆæ•°æ®-array</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">array</span>(å€¼,å€¼) <span class="keyword">from</span> student</span><br></pre></td></tr></table></figure></li><li><p><strong>é›†åˆstruct</strong>:                         <strong>struct&lt;keyå€¼:valueæ•°æ®ç±»å‹,keyå€¼:valueæ•°æ®ç±»å‹&gt;</strong></p><ol><li><p>é¢„å®šä¹‰ä¸ªæ•°</p></li><li><p>é¢„å®šä¹‰é¡ºåº</p></li><li><p>keyé¢„å®šä¹‰</p></li><li><p>æ•°æ®ç±»å‹å¯ä¸åŒ</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥è¯¢å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span>  s_score.chinese <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ„é€ å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> named_struct(key,<span class="keyword">value</span>,key,<span class="keyword">value</span>)</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure></li><li><p><strong>å­—å…¸map</strong>:                              <strong>map&lt;keyæ•°æ®ç±»å‹,valueæ•°æ®ç±»å‹&gt;</strong></p><ol><li><p>æ ‡å‡†å­—å…¸ç±»å‹</p></li><li><p>keyè‡ªå®šä¹‰</p></li><li><p>æ•°æ®ç±»å‹å¯ä¸åŒ</p></li><li><p>ä¸ªæ•°ä¸é™</p></li></ol>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥è¯¢å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span>  m_score[<span class="string">&#x27;è¯­æ–‡&#x27;</span>] <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ„é€ å¤åˆæ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> map(key,<span class="keyword">value</span>,key,<span class="keyword">value</span>)</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure><h2 id="hive-å†…ç½®å‡½æ•°"><a href="#hive-å†…ç½®å‡½æ•°" class="headerlink" title="hive å†…ç½®å‡½æ•°"></a><strong>hive</strong> å†…ç½®å‡½æ•°</h2>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">show</span> functions;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºè‡ªå¸¦çš„å‡½æ•°çš„ç”¨æ³•</span></span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">function</span> upper;</span><br><span class="line"><span class="comment">-- è¯¦ç»†æ˜¾ç¤ºè‡ªå¸¦çš„å‡½æ•°çš„ç”¨æ³•</span></span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">function</span> extended upper;</span><br></pre></td></tr></table></figure></li></ul><h1 id="pythonè¿æ¥hive"><a href="#pythonè¿æ¥hive" class="headerlink" title="pythonè¿æ¥hive"></a>pythonè¿æ¥hive</h1><h2 id="linuxç¯å¢ƒå®‰è£…python"><a href="#linuxç¯å¢ƒå®‰è£…python" class="headerlink" title="linuxç¯å¢ƒå®‰è£…python"></a>linuxç¯å¢ƒå®‰è£…python</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½å®‰è£…åŒ… æˆ–ä¸Šä¼ å®‰è£…åŒ…</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.9.9/Python-3.9.9.tgz</span><br><span class="line"><span class="comment"># è§£å‹</span></span><br><span class="line">tar -zxvf Python-3.9.10.tgz -C /opt/module/</span><br><span class="line"><span class="comment"># æ”¯æ’‘åŒ…</span></span><br><span class="line">yum install openssl-devel libffi-devel bzip2-devel gcc gcc-c++ wget -y</span><br><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">./configure --enable-optimizations</span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">make altinstall</span><br></pre></td></tr></table></figure><h3 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line">vim  /etc/profile.d/my_env.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$PATH</span>:/opt/python39/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæ•ˆ ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æˆ–è€…è¿›è¡Œè½¯è¿æ¥ é…ç½® </span></span><br><span class="line"><span class="built_in">cp</span> libpython3.9.a  /usr/lib64/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">ln</span> -s /root/software/python3.9/Python-3.9.10/python /usr/bin/python3</span><br><span class="line"><span class="built_in">ln</span> -s /opt/module/Python-3.9.10/python /usr/bin/python3</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…pyhiveåº“"><a href="#å®‰è£…pyhiveåº“" class="headerlink" title="å®‰è£…pyhiveåº“"></a>å®‰è£…pyhiveåº“</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pip3 install  -i https://mirrors.aliyun.com/pypi/simple/  thrift</span><br><span class="line">pip3 install  -i https://mirrors.aliyun.com/pypi/simple/  thrift-sasl</span><br><span class="line">pip3 install   -i https://mirrors.aliyun.com/pypi/simple/ PyHive</span><br><span class="line">pip3 install   -i https://mirrors.aliyun.com/pypi/simple/ PyM</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyhive <span class="keyword">import</span> hive</span><br><span class="line">conn=hive.connect(host=<span class="string">&#x27;localhost&#x27;</span>,port=<span class="number">10000</span>,username=<span class="string">&#x27;root&#x27;</span>,database=<span class="string">&#x27;db_hive&#x27;</span>)</span><br><span class="line">cursor=conn.cursor()</span><br><span class="line">sql=<span class="string">&#x27;show tables&#x27;</span></span><br><span class="line">cursor.execute(sql)</span><br><span class="line"><span class="built_in">print</span>(cursor.fetchall())</span><br></pre></td></tr></table></figure><h1 id="åˆ†åŒºè¡¨"><a href="#åˆ†åŒºè¡¨" class="headerlink" title="åˆ†åŒºè¡¨"></a>åˆ†åŒºè¡¨</h1><ul><li><p>åˆ†åŒºæ˜¯å°†ä¸€ä¸ªè¡¨æˆ–ç´¢å¼•ç‰©ç†åœ°åˆ†è§£ä¸ºå¤šä¸ªæ›´å°ã€æ›´å¯ç®¡ç†çš„éƒ¨åˆ†ã€‚</p></li><li><p>åˆ†åŒºå¯¹åº”ç”¨é€æ˜ï¼Œå³å¯¹è®¿é—®æ•°æ®åº“çš„åº”ç”¨è€Œè¨€ï¼Œé€»è¾‘ä¸Šè®²åªæœ‰ä¸€ä¸ªè¡¨æˆ–ä¸€ä¸ªç´¢å¼•ï¼ˆç›¸å½“äºåº”ç”¨â€œçœ‹åˆ°â€çš„åªæ˜¯ä¸€ä¸ªè¡¨æˆ–ç´¢å¼•ï¼‰ï¼Œä½†åœ¨ç‰©ç†ä¸Šè¿™ä¸ªè¡¨æˆ–ç´¢å¼•å¯èƒ½ç”±æ•°åä¸ªç‰©ç†åˆ†åŒºç»„æˆã€‚</p></li></ul><h2 id="åˆ†åŒºåº”ç”¨åœºæ™¯"><a href="#åˆ†åŒºåº”ç”¨åœºæ™¯" class="headerlink" title="åˆ†åŒºåº”ç”¨åœºæ™¯"></a>åˆ†åŒºåº”ç”¨åœºæ™¯</h2><p><img src="/2025/06/24/Hadoop/image-20250701152059542.png" alt="image-20250701152059542"></p><h2 id="oracleåˆ†åŒºè¡¨ç§ç±»"><a href="#oracleåˆ†åŒºè¡¨ç§ç±»" class="headerlink" title="oracleåˆ†åŒºè¡¨ç§ç±»"></a><strong>oracle</strong>åˆ†åŒºè¡¨ç§ç±»</h2><ol><li><strong>èŒƒå›´åˆ†åŒº</strong>(range)</li><li><strong>åˆ—è¡¨åˆ†åŒº</strong>(list)</li><li><strong>æ•£åˆ—åˆ†åŒº</strong>(hash)</li><li><strong>ç»„åˆç»„åˆåˆ†åŒº</strong>(subpartition)</li></ol><h2 id="oracleåˆ†åŒº-èŒƒå›´åˆ†åŒº"><a href="#oracleåˆ†åŒº-èŒƒå›´åˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-èŒƒå›´åˆ†åŒº"></a><em>oracle</em>åˆ†åŒº-èŒƒå›´åˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> ORDER_ACTIVITIES   </span><br><span class="line">(  ORDER_ID      NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span>,   </span><br><span class="line">    ORDER_DATE    <span class="type">DATE</span>,   </span><br><span class="line">    TOTAL_AMOUNT NUMBER,   </span><br><span class="line">    CUSTOTMER_ID NUMBER(<span class="number">7</span>),   </span><br><span class="line">    PAID   <span class="type">CHAR</span>(<span class="number">1</span>)   </span><br><span class="line">)   <span class="comment">-- å»ºè¡¨è¯­å¥ä¸å˜</span></span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (ORDER_DATE) <span class="comment">-- èŒƒå›´åˆ†åŒºåˆ›å»º è¯­å¥ å…³é”®å­— range(åˆ—å)</span></span><br><span class="line">(  </span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART01 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;01- MAY -2003&#x27;</span>,<span class="string">&#x27;DD-MON-YYYY&#x27;</span>)) TABLESPACE ORD_TS01,  </span><br><span class="line">    <span class="comment">-- åˆ†åŒºå ï¼ˆæ—¶é—´å€¼ï¼‰è¡¨ç©ºé—´</span></span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART02 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;01-JUN-2003&#x27;</span>,<span class="string">&#x27;DD-MON-YYYY&#x27;</span>)) TABLESPACE ORD_TS02,  </span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART02 <span class="keyword">VALUES</span> LESS THAN (MAXVALUE) TABLESPACE ORD_TS03   <span class="comment">--ä½¿ç”¨maxvalue å°†å…¶ä»–ä¸ç¬¦åˆä¸Šè¿°èŒƒå›´çš„å€¼æ”¾å…¥å…¶ä¸­</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº"><a href="#oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº"></a>oracleåˆ†åŒº-åˆ—è¡¨åˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> ORDER_ACTIVITIES  </span><br><span class="line">(  PROBLEM_ID   NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span> <span class="keyword">PRIMARY KEY</span>,   </span><br><span class="line">    CUSTOMER_ID  NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span>,     </span><br><span class="line">    STATUS       VARCHAR2(<span class="number">20</span>))   </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> LIST (STATUS)    <span class="comment">-- èŒƒå›´åˆ†åŒºåˆ›å»º è¯­å¥ å…³é”®å­— LIST(åˆ—å)</span></span><br><span class="line">(    <span class="keyword">PARTITION</span> PROB_ACTIVE   <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE PROB_TS01,  <span class="comment">-- </span></span><br><span class="line">      <span class="keyword">PARTITION</span> PROB_INACTIVE <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>,<span class="string">&#x27;unknow&#x27;</span>) TABLESPACE PROB_TS02  </span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº"><a href="#oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº"></a>oracleåˆ†åŒº-æ•£åˆ—åˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> HASH_TABLE   </span><br><span class="line">( COL NUMBER(<span class="number">8</span>),   </span><br><span class="line">  INF VARCHAR2(<span class="number">100</span>)   </span><br><span class="line">)   </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> HASH (COL)    <span class="comment">-- èŒƒå›´åˆ†åŒºåˆ›å»º è¯­å¥ å…³é”®å­— HASH(åˆ—å) </span></span><br><span class="line">(   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART01 TABLESPACE HASH_TS01,   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART02 TABLESPACE HASH_TS02,   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART03 TABLESPACE HASH_TS03   </span><br><span class="line">) </span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-ç»„åˆåˆ†åŒº"><a href="#oracleåˆ†åŒº-ç»„åˆåˆ†åŒº" class="headerlink" title="oracleåˆ†åŒº-ç»„åˆåˆ†åŒº"></a><strong>oracle</strong>åˆ†åŒº-ç»„åˆåˆ†åŒº</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> SALES   </span><br><span class="line">(  </span><br><span class="line">PRODUCT_ID VARCHAR2(<span class="number">5</span>),  </span><br><span class="line">SALES_DATE <span class="type">DATE</span>,  </span><br><span class="line">SALES_COST NUMBER(<span class="number">10</span>),  </span><br><span class="line">STATUS VARCHAR2(<span class="number">20</span>)  </span><br><span class="line">)  </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(SALES_DATE) SUBPARTITION <span class="keyword">BY</span> LIST (STATUS)  </span><br><span class="line">(  </span><br><span class="line">   <span class="keyword">PARTITION</span> P1 <span class="keyword">VALUES</span> LESS THAN(TO_DATE(<span class="string">&#x27;2003-01-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>))TABLESPACE rptfact2009   </span><br><span class="line">  (   </span><br><span class="line">      SUBPARTITION P1SUB1 <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE rptfact2009,   </span><br><span class="line">      SUBPARTITION P1SUB2 <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>) TABLESPACE rptfact2009   </span><br><span class="line">  ),   </span><br><span class="line">   <span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;2003-03-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>)) TABLESPACE rptfact2009   </span><br><span class="line">  (   </span><br><span class="line">      SUBPARTITION P2SUB1 <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE rptfact2009,   </span><br><span class="line">      SUBPARTITION P2SUB2 <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>) TABLESPACE rptfact2009   </span><br><span class="line">  )   </span><br><span class="line">)  </span><br></pre></td></tr></table></figure><h2 id="oracleåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"><a href="#oracleåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ" class="headerlink" title="oracleåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"></a><em>oracle</em>åˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ·»åŠ åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> P3 <span class="keyword">VALUES</span> LESS THAN(TO_DATE(<span class="string">&#x27;2003-06-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>));  </span><br><span class="line"><span class="comment">--æ³¨æ„ï¼šä»¥ä¸Šæ·»åŠ çš„åˆ†åŒºç•Œé™åº”è¯¥é«˜äºæœ€åä¸€ä¸ª åˆ†åŒºç•Œé™ã€‚</span></span><br><span class="line"><span class="comment">-- æ·»åŠ äº†ä¸€ä¸ªP3SUB1å­åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES MODIFY <span class="keyword">PARTITION</span> P3 <span class="keyword">ADD</span> SUBPARTITION P3SUB1 <span class="keyword">VALUES</span>(<span class="string">&#x27;COMPLETE&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">DROP</span> <span class="keyword">PARTITION</span> P3;  </span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">DROP</span> SUBPARTITION P4SUB1;</span><br><span class="line"><span class="comment">-- æ³¨æ„ï¼šå¦‚æœåˆ é™¤çš„åˆ†åŒºæ˜¯è¡¨ä¸­å”¯ä¸€çš„åˆ†åŒºï¼Œé‚£ä¹ˆæ­¤åˆ†åŒºå°†ä¸èƒ½è¢«åˆ é™¤ï¼Œè¦æƒ³åˆ é™¤æ­¤åˆ†åŒºï¼Œå¿…é¡»åˆ é™¤è¡¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº¤æ¢åˆ†åŒº</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name EXCHANGE <span class="keyword">PARTITION</span> partition_name <span class="keyword">WITH</span> <span class="keyword">TABLE</span> nonpartition_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å°†ä¸€ä¸ªåˆ†åŒº(å­åˆ†åŒº)å’Œéåˆ†åŒºè¡¨è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œoracleäº¤æ¢çš„æ–¹æ³•æ˜¯å…¶å®æ˜¯å¯¹é€»è¾‘å­˜å‚¨æ®µè¿›è¡Œäº¤æ¢ã€‚ä½¿ç”¨INCLUDEING INDEXESå­å¥å¯ä»¥åŒæ­¥å°†æœ¬åœ°ç´¢å¼•ä¹Ÿè¿›è¡Œäº¤æ¢ï¼Œä½¿ç”¨WITH VALIDATATIONå­å¥è¿˜å¯ä»¥å®ç°è¡Œæ•°æ®çš„éªŒè¯ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--äº¤æ¢åˆ†åŒºæ—¶å¦‚æœä¸å¸¦UPDATE INDEXESå­å¥ï¼Œåˆ™å…¨å±€ç´¢å¼•æˆ–å…¨å±€ç´¢å¼•åŸºäºçš„åˆ†åŒºå°†å˜ä¸ºä¸å¯ç”¨ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨"><a href="#hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨" class="headerlink" title="hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨"></a>hiveåˆ†åŒº-åˆ›å»ºåˆ†åŒºè¡¨</h2><p><strong>åœ¨ Hadoop ä¸­ï¼ŒHive åˆ†åŒºè¡¨é€šå¸¸ä»¥ç‰¹å®šçš„ç›®å½•ç»“æ„æ¥å­˜å‚¨ã€‚</strong></p><p><strong>æ¯ä¸ªåˆ†åŒºå¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„ç›®å½•ï¼Œç›®å½•åé€šå¸¸åŒ…å«åˆ†åŒºåˆ—çš„å€¼ã€‚æ•°æ®æ–‡ä»¶ä¼šå­˜å‚¨åœ¨ç›¸åº”çš„åˆ†åŒºç›®å½•ä¸‹ã€‚</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºåˆ†åŒºè¡¨</span></span><br><span class="line"><span class="keyword">create table</span> dept_partition(</span><br><span class="line">deptno <span class="type">int</span>, dname string, loc string</span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (<span class="keyword">day</span> string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"><a href="#hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ" class="headerlink" title="hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ"></a>hiveåˆ†åŒº-åˆ†åŒºè¡¨æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ†åŒºè¡¨æ•°æ®å¯¼å…¥</span></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/opt/module/hive/datas/dept_20200401.log&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> dept_partition <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200401&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--selectåˆ†åŒºè¡¨æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span> log_list_6 <span class="keyword">partition</span>(dat<span class="operator">=</span><span class="string">&#x27;20221231&#x27;</span>) <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> log_list_tmp</span><br><span class="line"><span class="comment">--å¤šè¡¨åˆ†åŒºæ’å…¥ </span></span><br><span class="line"><span class="keyword">from</span> student </span><br><span class="line">  <span class="keyword">insert</span> overwrite <span class="keyword">table</span> student <span class="keyword">partition</span>(<span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201707&#x27;</span>)<span class="keyword">select</span> id, name <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201707&#x27;</span></span><br><span class="line">  <span class="keyword">insert</span> overwrite <span class="keyword">table</span> student <span class="keyword">partition</span>(<span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201706&#x27;</span>)<span class="keyword">select</span> id, name <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201706&#x27;</span>;</span><br><span class="line"><span class="comment">-- æŸ¥çœ‹åˆ†åŒº</span></span><br><span class="line"><span class="keyword">show</span> partitions tab_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--æ·»åŠ åˆ†åŒº</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200404&#x27;</span>) ;</span><br><span class="line"><span class="comment">--æ·»åŠ å¤šåˆ†åŒº</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200405&#x27;</span>) <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200406&#x27;</span>);</span><br><span class="line"><span class="comment">--åˆ é™¤åˆ†åŒº</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">drop</span> <span class="keyword">partition</span> (<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200406&#x27;</span>);</span><br><span class="line"><span class="comment">--æŸ¥çœ‹åˆ†åŒºè¡¨ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">show</span> partitions dept_partition;</span><br><span class="line"><span class="comment">--æŸ¥çœ‹åˆ†åŒºè¡¨ç»“æ„</span></span><br><span class="line"><span class="keyword">desc</span> formatted dept_partition;</span><br><span class="line"><span class="comment">--ä¿®æ”¹åˆ†åŒºè¡¨</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>) <span class="keyword">SET</span> LOCATION &quot;new location&quot;;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>) RENAME <span class="keyword">TO</span> <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;20080808&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹"><a href="#è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹" class="headerlink" title="è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹"></a>è¶…å¸‚åˆ†åŒºè¡¨ç¤ºä¾‹</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> supermarket_p (</span><br><span class="line">id string, <span class="comment">-- è¡Œ ID  </span></span><br><span class="line">ord_id string comment <span class="string">&#x27;è®¢å• ID&#x27;</span>,  </span><br><span class="line">ord_date string comment <span class="string">&#x27;è®¢å•æ—¥æœŸ&#x27;</span>, </span><br><span class="line">exch_date string comment <span class="string">&#x27;å‘è´§æ—¥æœŸ&#x27;</span>,</span><br><span class="line">exch_type string comment <span class="string">&#x27;é‚®å¯„æ–¹å¼&#x27;</span>,</span><br><span class="line">cust_id string comment <span class="string">&#x27;å®¢æˆ· ID &#x27;</span>,</span><br><span class="line">cust_name string comment <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>,</span><br><span class="line">d_type string comment <span class="string">&#x27;ç»†åˆ†&#x27;</span>,</span><br><span class="line">city string comment <span class="string">&#x27;åŸå¸‚&#x27;</span>, </span><br><span class="line">prov string comment <span class="string">&#x27;çœ/è‡ªæ²»åŒº&#x27;</span>,  </span><br><span class="line">country string comment<span class="string">&#x27;å›½å®¶&#x27;</span>,</span><br><span class="line">area string comment <span class="string">&#x27;åœ°åŒº&#x27;</span>, </span><br><span class="line">pro_id string comment <span class="string">&#x27;äº§å“ ID&#x27;</span>,  </span><br><span class="line">type1 string comment <span class="string">&#x27;ç±»åˆ«&#x27;</span>,</span><br><span class="line">type2 string comment <span class="string">&#x27;å­ç±»åˆ«&#x27;</span>, </span><br><span class="line">pro_name string comment <span class="string">&#x27;äº§å“åç§°&#x27;</span>,</span><br><span class="line">sales <span class="type">float</span> comment <span class="string">&#x27;é”€å”®é¢&#x27;</span>,  </span><br><span class="line">count1 <span class="type">int</span> comment <span class="string">&#x27;æ•°é‡  &#x27;</span>,</span><br><span class="line">discount <span class="type">float</span> comment <span class="string">&#x27;æŠ˜æ‰£  &#x27;</span>,</span><br><span class="line">profit <span class="type">float</span> comment <span class="string">&#x27;åˆ©æ¶¦&#x27;</span></span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (c_type1 string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€åˆ†åŒºé…ç½®"><a href="#åŠ¨æ€åˆ†åŒºé…ç½®" class="headerlink" title="åŠ¨æ€åˆ†åŒºé…ç½®"></a>åŠ¨æ€åˆ†åŒºé…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">--å¼€å¯åŠ¨æ€åˆ†åŒº(é»˜è®¤å¼€å¯)</span><br><span class="line"><span class="built_in">set</span> hive.exec.dynamic.partition=<span class="literal">true</span></span><br><span class="line">--æŒ‡å®šéä¸¥æ ¼æ¨¡å¼ nonstrictæ¨¡å¼è¡¨ç¤ºå…è®¸æ‰€æœ‰çš„åˆ†åŒºå­—æ®µéƒ½å¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†åŒº</span><br><span class="line"><span class="built_in">set</span> hive.exec.dynamic.partition.mode=nonstrict</span><br><span class="line">--åœ¨æ‰€æœ‰æ‰§è¡ŒMRçš„èŠ‚ç‚¹ä¸Šï¼Œæœ€å¤§ä¸€å…±å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªåŠ¨æ€åˆ†åŒºã€‚é»˜è®¤1000</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.dynamic.partitions=1000</span><br><span class="line">--åœ¨æ¯ä¸ªæ‰§è¡ŒMRçš„èŠ‚ç‚¹ä¸Šï¼Œæœ€å¤§å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªåŠ¨æ€åˆ†åŒº(åˆ†åŒºå­—æ®µæœ‰å¤šå°‘ç§è®¾å¤šå°‘ä¸ª)</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.dynamic.partitions.pernode=100</span><br><span class="line">--æ•´ä¸ªMR Jobä¸­ï¼Œæœ€å¤§å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªHDFSæ–‡ä»¶ã€‚é»˜è®¤100000</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.created.files=100000</span><br><span class="line">--å½“æœ‰ç©ºåˆ†åŒºç”Ÿæˆæ—¶ï¼Œæ˜¯å¦æŠ›å‡ºå¼‚å¸¸</span><br><span class="line"><span class="built_in">set</span> hive.error.on.empty.partition=<span class="literal">false</span></span><br><span class="line">--æ‰“å¼€æ­£åˆ™æŸ¥è¯¢æ¨¡å¼`(dt|hr)?+.+`</span><br><span class="line"><span class="built_in">set</span> hive.support.quoted.identifiers=none</span><br></pre></td></tr></table></figure><h1 id="åˆ†æ¡¶è¡¨"><a href="#åˆ†æ¡¶è¡¨" class="headerlink" title="åˆ†æ¡¶è¡¨"></a>åˆ†æ¡¶è¡¨</h1><ul><li><p>åˆ†åŒºæä¾›ä¸€ä¸ªéš”ç¦»æ•°æ®å’Œä¼˜åŒ–æŸ¥è¯¢çš„ä¾¿åˆ©æ–¹å¼ã€‚ä¸è¿‡ï¼Œå¹¶éæ‰€æœ‰çš„æ•°æ®é›†éƒ½å¯å½¢æˆåˆç†çš„åˆ†åŒºã€‚å¯¹äºä¸€å¼ è¡¨æˆ–è€…åˆ†åŒºï¼ŒHive å¯ä»¥è¿›ä¸€æ­¥ç»„ç»‡æˆæ¡¶ï¼Œä¹Ÿå°±æ˜¯æ›´ä¸ºç»†ç²’åº¦çš„æ•°æ®èŒƒå›´åˆ’åˆ†ã€‚</p></li><li><p>åˆ†æ¡¶æ˜¯å°†æ•°æ®é›†åˆ†è§£æˆæ›´å®¹æ˜“ç®¡ç†çš„è‹¥å¹²éƒ¨åˆ†çš„å¦ä¸€ä¸ªæŠ€æœ¯ã€‚</p></li><li><p>åˆ†åŒº<strong>é’ˆå¯¹çš„æ˜¯æ•°æ®çš„å­˜å‚¨è·¯å¾„</strong>ï¼›åˆ†æ¡¶<strong>é’ˆå¯¹çš„æ˜¯æ•°æ®æ–‡ä»¶</strong>ã€‚</p></li></ul><h2 id="åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹"><a href="#åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹" class="headerlink" title="åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹"></a><strong>åˆ†æ¡¶è¡¨æ³¨æ„äº‹é¡¹</strong></h2><ul><li><p><strong>åˆ†æ¡¶ç­–ç•¥</strong></p></li><li><p><strong>Hiveçš„åˆ†æ¡¶é‡‡ç”¨å¯¹åˆ†æ¡¶å­—æ®µçš„å€¼è¿›è¡Œå“ˆå¸Œï¼Œç„¶åé™¤ä»¥æ¡¶çš„ä¸ªæ•°æ±‚ä½™çš„æ–¹ å¼å†³å®šè¯¥æ¡è®°å½•å­˜æ”¾åœ¨å“ªä¸ªæ¡¶å½“ä¸­</strong></p><p>&#x3D;&#x3D;reduceçš„ä¸ªæ•°è®¾ç½®ä¸º-1,è®©Jobè‡ªè¡Œå†³å®šéœ€è¦ç”¨å¤šå°‘ä¸ªreduceæˆ–è€…å°†reduceçš„ä¸ªæ•°è®¾ç½®ä¸ºå¤§äºç­‰äºåˆ†æ¡¶è¡¨çš„æ¡¶æ•°&#x3D;&#x3D;</p><p>&#x3D;&#x3D;<strong>ä»hdfsä¸­loadæ•°æ®åˆ°åˆ†æ¡¶è¡¨ä¸­ï¼Œé¿å…æœ¬åœ°æ–‡ä»¶æ‰¾ä¸åˆ°é—®é¢˜</strong>&#x3D;&#x3D;</p><p>&#x3D;&#x3D;<strong>ä¸è¦ä½¿ç”¨æœ¬åœ°æ¨¡å¼</strong>&#x3D;&#x3D;</p></li></ul><h2 id="hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨"><a href="#hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨" class="headerlink" title="hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨"></a>hiveåˆ†æ¡¶è¡¨-åˆ›å»ºåˆ†æ¡¶è¡¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--åˆ›å»º4ä¸ªåˆ†æ¡¶çš„åˆ†æ¡¶è¡¨</span></span><br><span class="line"><span class="keyword">create table</span> stu_bucket(id <span class="type">int</span>, name string)</span><br><span class="line">clustered <span class="keyword">by</span>(id) </span><br><span class="line"><span class="keyword">into</span> <span class="number">4</span> buckets</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è®¾ç½®mapreduceæ•°é‡(äºŒé€‰ä¸€)</span></span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces<span class="operator">=</span><span class="number">3</span></span><br><span class="line"> <span class="keyword">set</span> mapred.reduce.tasks<span class="operator">=</span><span class="number">3</span></span><br><span class="line"><span class="comment">--å‘åˆ†æ¡¶è¡¨å¯¼å…¥æ•°æ®</span></span><br><span class="line">load data inpath   <span class="string">&#x27;/student.txt&#x27;</span> </span><br><span class="line"><span class="keyword">into</span> <span class="keyword">table</span> stu_bucket;</span><br></pre></td></tr></table></figure><h2 id="hiveæ’åºå…³é”®å­—"><a href="#hiveæ’åºå…³é”®å­—" class="headerlink" title="hiveæ’åºå…³é”®å­—"></a>hiveæ’åºå…³é”®å­—</h2><p><img src="/2025/06/24/Hadoop/image-20250701153814791.png" alt="image-20250701153814791"></p><hr><p>##<strong>hive****æ’åºè¯­å¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--ä½¿ç”¨order by æ’åº</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 <span class="keyword">order</span> <span class="keyword">by</span> id</span><br><span class="line"><span class="comment">--ä½¿ç”¨sort by æ’åº</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 sort <span class="keyword">by</span> class_name <span class="keyword">desc</span></span><br><span class="line"><span class="comment">--ä½¿ç”¨distribute by åˆ†ç»„</span></span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces<span class="operator">=</span><span class="number">15</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 distribute <span class="keyword">by</span> class_name sort <span class="keyword">by</span> id <span class="keyword">desc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite  <span class="keyword">local</span> directory <span class="string">&#x27;/root/student2/&#x27;</span></span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2_b </span><br><span class="line">distribute <span class="keyword">by</span> sex </span><br><span class="line">sort <span class="keyword">by</span> chinese <span class="keyword">desc</span></span><br><span class="line"><span class="comment">--ä½¿ç”¨cluster by åˆ†ç»„å¹¶æ’åº</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 cluster <span class="keyword">by</span> class_name</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨awk-æ¸…æ´—-log"><a href="#ä½¿ç”¨awk-æ¸…æ´—-log" class="headerlink" title="ä½¿ç”¨awk æ¸…æ´— log"></a>ä½¿ç”¨awk æ¸…æ´— log</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> 2021-05-20.<span class="built_in">log</span> | awk -F <span class="string">&quot;\&quot;-\&quot;&quot;</span> <span class="string">&#x27;&#123;split($1, arr, &quot; &quot;);\</span></span><br><span class="line"><span class="string">split(substr(arr[4],2),dd,&quot;:&quot;);\</span></span><br><span class="line"><span class="string">split(dd[1],ee,&quot;/&quot;);\</span></span><br><span class="line"><span class="string">print arr[1]&quot;\t&quot;ee[1]&quot;-</span></span><br><span class="line"><span class="string">&quot;ee[2]&quot;-&quot;ee[3]&quot; &quot;dd[2]&quot;:&quot;dd[3]&quot;:&quot;dd[4]&quot;\t&quot;arr[7]&quot;\t&quot;$2&#125;&#x27;</span> | \</span><br><span class="line">awk -F <span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;&quot;date -d \&quot;&quot;$2&quot;\&quot; +%Y%m%d%H%M%S&quot; | getline d;print</span></span><br><span class="line"><span class="string">$1&quot;\t&quot;d&quot;\t&quot;$3&quot;\t&quot;$4 &#125;&#x27;</span> | \</span><br><span class="line">awk -F <span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;print $1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;(index($4,&quot;Windows&quot;)?&quot;Windows&quot;:</span></span><br><span class="line"><span class="string">(index($4,&quot;Linux&quot;)?&quot;Linux&quot;:&quot;Mac&quot;))&quot;\t&quot;(index($4,&quot;Chrome&quot;)?&quot;Chrome&quot;:</span></span><br><span class="line"><span class="string">(index($4,&quot;Version&quot;)?&quot;Safari&quot;:(index($4,&quot;Firefox&quot;)?&quot;Firefox&quot;:&quot;Opera&quot;)))&#125;&#x27;</span> &gt;</span><br><span class="line">new_2021-05-20.log</span><br></pre></td></tr></table></figure><h1 id="sqoop"><a href="#sqoop" class="headerlink" title="sqoop"></a>sqoop</h1><ol><li><p>å®‰è£…sqoop</p></li><li><p>sqoopä»‹ç»</p><ol><li>Sqoop æ˜¯ Apache æ——ä¸‹ä¸€æ¬¾<strong>ä¸“ä¸º Hadoop è®¾è®¡çš„æ•°æ®åŒæ­¥å·¥å…·</strong>ï¼Œå…¨ç§°ä¸º â€œSQL to Hadoopâ€ï¼Œä¸»è¦ç”¨äºåœ¨<strong>å…³ç³»å‹æ•°æ®åº“</strong>ï¼ˆå¦‚ MySQLã€Oracleï¼‰å’Œ<strong>Hadoop ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼ˆå¦‚ HDFSã€Hiveã€HBaseï¼‰ä¹‹é—´é«˜æ•ˆä¼ è¾“æ•°æ®ã€‚å®ƒé€šè¿‡ MapReduce ä»»åŠ¡å¹¶è¡Œå¤„ç†æ•°æ®ï¼Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®çš„æ‰¹é‡å¯¼å…¥å¯¼å‡ºï¼Œæ˜¯ Hadoop ç”Ÿæ€ä¸­è¿æ¥ç»“æ„åŒ–æ•°æ®å’Œéç»“æ„åŒ–æ•°æ®çš„é‡è¦æ¡¥æ¢ã€‚</li><li><h3 id="æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹ç‚¹"><a href="#æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹ç‚¹" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹ç‚¹"></a>æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹ç‚¹</h3><ol><li><strong>æ•°æ®å¯¼å…¥ï¼ˆImportï¼‰</strong><br>å°†å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ•°æ®æŠ½å–åˆ° Hadoop ä¸­ï¼ˆå¦‚ HDFS å­˜å‚¨ä¸ºæ–‡ä»¶ï¼Œæˆ–ç›´æ¥å¯¼å…¥ Hive è¡¨ã€HBase è¡¨ï¼‰ã€‚<ul><li><strong>æ”¯æŒå¢é‡å¯¼å…¥</strong>ï¼šå¯åŸºäºæ—¶é—´æˆ³æˆ–ä¸»é”®å¢é‡åŒæ­¥å˜åŒ–çš„æ•°æ®ã€‚</li><li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šé€šè¿‡ MapReduce å¹¶è¡Œè¯»å–æ•°æ®åº“åˆ†ç‰‡ï¼Œæå‡ä¼ è¾“æ•ˆç‡ã€‚</li></ul></li><li><strong>æ•°æ®å¯¼å‡ºï¼ˆExportï¼‰</strong><br>å°† Hadoop ä¸­çš„æ•°æ®ï¼ˆå¦‚ HDFS æ–‡ä»¶ã€Hive è¡¨ï¼‰å†™å›åˆ°å…³ç³»å‹æ•°æ®åº“ã€‚<ul><li><strong>äº‹åŠ¡æ”¯æŒ</strong>ï¼šç¡®ä¿å¯¼å‡ºæ“ä½œçš„åŸå­æ€§ï¼Œå¤±è´¥æ—¶å¯å›æ»šã€‚</li></ul></li><li><strong>å¤šç§æ•°æ®åº“æ”¯æŒ</strong><br>æ”¯æŒä¸»æµå…³ç³»å‹æ•°æ®åº“ï¼Œå¦‚ MySQLã€Oracleã€PostgreSQLã€SQL Server ç­‰ï¼Œä¹Ÿå¯é€šè¿‡ JDBC è¿æ¥å…¶ä»–æ•°æ®åº“ã€‚</li><li><strong>å…ƒæ•°æ®æ˜ å°„</strong><br>è‡ªåŠ¨å°†æ•°æ®åº“è¡¨ç»“æ„æ˜ å°„ä¸º Hive è¡¨æˆ– HDFS æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ Avroã€Parquetï¼‰ï¼Œç®€åŒ–æ•°æ®å»ºæ¨¡ã€‚</li><li><strong>ä¸ Hadoop ç”Ÿæ€é›†æˆ</strong><br>æ— ç¼é›†æˆ Hiveã€HBaseã€Spark ç­‰ç»„ä»¶ï¼Œå¯ä½œä¸º ETLï¼ˆæŠ½å– - è½¬æ¢ - åŠ è½½ï¼‰å·¥å…·é“¾çš„æ ¸å¿ƒç¯èŠ‚ã€‚</li></ol></li></ol></li></ol><p><strong>æ€»ç»“</strong><br>         Sqoop æ˜¯ Hadoop ç”Ÿæ€ä¸­è¿æ¥ç»“æ„åŒ–æ•°æ®æºï¼ˆå¦‚æ•°æ®åº“ï¼‰ä¸åˆ†å¸ƒå¼è®¡ç®—å¹³å°çš„å…³é”®å·¥å…·ï¼Œå°¤å…¶é€‚åˆæ‰¹é‡æ•°æ®è¿ç§»å’Œå‘¨æœŸæ€§ ETL ä»»åŠ¡ã€‚é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œæ¥å£ï¼Œå®ƒè®©æ•°æ®å·¥ç¨‹å¸ˆèƒ½å¤Ÿé«˜æ•ˆåœ°åœ¨ Hadoop ä¸ä¼ ç»Ÿ IT ç³»ç»Ÿé—´äº¤æ¢æ•°æ®ï¼Œé™ä½äº†å¤§æ•°æ®åº”ç”¨çš„é›†æˆé—¨æ§›ã€‚</p><ol start="3"><li>sqoopä½¿ç”¨</li></ol><hr><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ol><li>é…ç½®mysql</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database test</span><br><span class="line"><span class="keyword">DEFAULT</span> <span class="keyword">CHARACTER SET</span> utf8</span><br><span class="line"><span class="keyword">DEFAULT</span> <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"><span class="comment">--åˆ›å»ºæ•°æ®åº“</span></span><br><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line"><span class="comment">--åˆ›å»ºè´¦å·</span></span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">user</span> <span class="string">&#x27;test&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line"><span class="keyword">Grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> test.<span class="operator">*</span> <span class="keyword">to</span> test@<span class="string">&#x27;%&#x27;</span> </span><br><span class="line">identified <span class="keyword">by</span> <span class="string">&#x27;test&#x27;</span> <span class="keyword">with</span> <span class="keyword">grant</span> option;</span><br><span class="line"></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ‹·è´å®‰è£…åŒ…ä»¥åŠmysqlçš„jaråˆ°/rootç›®å½• å¹¶è§£å‹</span></span><br><span class="line">tar -zvxf sqoop-1.4.6.bin__hadoop-2.0.4-alpha.tar.gz -C /opt/module/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"></span><br><span class="line">vim /etc/profile.d/my_env.sh</span><br><span class="line"><span class="comment"># åŠ å…¥ sqoop è·¯å¾„</span></span><br><span class="line"><span class="comment">#SQOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> SQOOP_HOME=/opt/module/sqoop-1.4.6.bin__hadoop-2.0.4-alpha</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SQOOP_HOME</span>/bin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><hr><h2 id="å®‰è£…sqoop"><a href="#å®‰è£…sqoop" class="headerlink" title="å®‰è£…sqoop"></a>å®‰è£…sqoop</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3.é…ç½®sqoop</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$SQOOP_HOME</span>/conf</span><br><span class="line"><span class="built_in">cp</span> sqoop-env-template.sh sqoop-env.sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=/opt/module/hadoop-3.1.3</span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=/opt/module/hadoop-3.1.3</span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/module/apache-hive-3.1.2-bin</span><br><span class="line"><span class="comment">#export ZOOKEEPER_HOME=/opt/module/zookeeper-3.4.10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‹·è´ jdbc é©±åŠ¨åˆ° sqoop çš„ lib ç›®å½•ä¸‹</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-5.1.27-bin.jar /opt/module/sqoop-1.4.6.bin__hadoop-2.0.4-alpha/lib/</span><br></pre></td></tr></table></figure><p>4.æµ‹è¯•è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-databases --connect jdbc:mysql://localhost:3306/ --username root --password root</span><br></pre></td></tr></table></figure><hr><h3 id="åˆ†åŒºé‡æ„"><a href="#åˆ†åŒºé‡æ„" class="headerlink" title="åˆ†åŒºé‡æ„"></a>åˆ†åŒºé‡æ„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beeline -u <span class="string">&quot;jdbc:hive2://hadoop100:10000/db_hive&quot;</span> \</span><br><span class="line"> --outputformat=csv2 --showHeader=<span class="literal">false</span> -n root -p 123456 -e <span class="string">&quot;msck repair table log_sqoop&quot;</span></span><br></pre></td></tr></table></figure><h1 id="DataX"><a href="#DataX" class="headerlink" title="DataX"></a>DataX</h1><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/alibaba/DataX">https://github.com/alibaba/DataX</a><br>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/DataX/blob/master/introduction.md">https://github.com/alibaba/DataX/blob/master/introduction.md</a></p><p>DataX æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ª<strong>å¼‚æ„æ•°æ®æºç¦»çº¿åŒæ­¥å·¥å…·</strong>ï¼Œè‡´åŠ›äºå®ç°åŒ…æ‹¬å…³ç³»å‹æ•°æ®åº“(MySQLã€Oracleç­‰)ã€HDFSã€Hiveã€ODPSã€HBaseã€FTPç­‰å„ç§å¼‚æ„æ•°æ®æºä¹‹é—´ç¨³å®šé«˜æ•ˆçš„æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚</p><p> DataXæœ¬èº«ä½œä¸ºæ•°æ®åŒæ­¥æ¡†æ¶ï¼Œå°†ä¸åŒæ•°æ®æºçš„åŒæ­¥æŠ½è±¡ä¸º<strong>ä»æºå¤´æ•°æ®æºè¯»å–æ•°æ®çš„Readeræ’ä»¶ï¼Œä»¥åŠå‘ç›®æ ‡ç«¯å†™å…¥æ•°æ®çš„Writeræ’ä»¶</strong>ï¼Œç†è®ºä¸ŠDataXæ¡†æ¶å¯ä»¥æ”¯æŒä»»æ„æ•°æ®æºç±»å‹çš„æ•°æ®åŒæ­¥å·¥ä½œã€‚åŒæ—¶DataXæ’ä»¶ä½“ç³»ä½œä¸ºä¸€å¥—ç”Ÿæ€ç³»ç»Ÿ, æ¯æ¥å…¥ä¸€å¥—æ–°æ•°æ®æºè¯¥æ–°åŠ å…¥çš„æ•°æ®æºå³å¯å®ç°å’Œç°æœ‰çš„æ•°æ®æºäº’é€šã€‚</p><h2 id="å®‰è£…-datax"><a href="#å®‰è£…-datax" class="headerlink" title="å®‰è£… datax"></a>å®‰è£… datax</h2><p>ç¡®ä¿hadoopé›†ç¾¤æ²¡æœ‰é—®é¢˜</p><p>å°† <code>datax.tar.gz</code> ä¸Šä¼ åˆ° hadoop100 çš„ <code>/root</code>ç›®å½•ä¸‹, è§£å‹å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf datax.tar.gz -C /opt/moudule</span><br><span class="line"><span class="comment"># åŒæ­¥åˆ°å…¶ä»–æœºå™¨</span></span><br><span class="line">xsync /opt/moudule/datax</span><br></pre></td></tr></table></figure><h3 id="ç¼–å†™é…ç½®æ–‡ä»¶"><a href="#ç¼–å†™é…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–å†™é…ç½®æ–‡ä»¶"></a>ç¼–å†™é…ç½®æ–‡ä»¶</h3><p>å¼€å‘ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /zhiyun/lijinquan</span><br><span class="line"><span class="built_in">cd</span> /zhiyun/lijinquan</span><br><span class="line"><span class="comment"># åˆ›å»ºå‡ ä¸ªç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> <span class="built_in">jobs</span> sql python shell data</span><br></pre></td></tr></table></figure><p>dataxçš„é…ç½®æ–‡ä»¶éœ€è¦æ”¾åœ¨ jobs ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /zhiyun/lijinquan/jobs/c_org_busi.json</span><br></pre></td></tr></table></figure><p>åŠ å…¥å†…å®¹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                 <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;errorLimit&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;record&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;percentage&quot;</span><span class="punctuation">:</span> <span class="number">0.02</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zhiyun&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zhiyun&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;*&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;c_org_busi&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://192.168.50.179:3306/his?useSSL=false&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop100:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;orc&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/zhiyun/lijinquan/ods/c_org_busi&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c_org_busi.data&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;col1&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;TINYINT&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                           ..</span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;truncate`&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python /opt/datax/bin/datax.py /zhiyun/lijinquan/jobs/c_org_busi.json</span><br></pre></td></tr></table></figure><p>åˆ—åçš„å¤„ç†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. ä¸€ä¸ªåˆ—ä¸€ä¸ªåˆ—çš„å¤„ç†</span><br><span class="line">2. vscodeå¤šè¡Œç¼–è¾‘  alt+shift+é¼ æ ‡æ‹–åŠ¨</span><br></pre></td></tr></table></figure><p>æŠ½å– <code>c_org_busi</code> è¡¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨é…ç½®çš„path: [/zhiyun/lijinquan/ods/c_org_busi] ä¸å­˜åœ¨, è¯·å…ˆåœ¨hiveç«¯åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“å’Œè¡¨.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dataxä¸ä¼šè‡ªåŠ¨åˆ›å»ºHDFSä¸Šçš„è·¯å¾„, éœ€è¦æ‰‹åŠ¨åˆ›å»º</span><br><span class="line">hadoop fs -<span class="built_in">mkdir</span> -p /zhiyun/lijinquan/ods/c_org_busi</span><br></pre></td></tr></table></figure><p>ç¡®ä¿æŠ½å–æˆåŠŸ, æ²¡æœ‰æŠ¥é”™</p><h3 id="Hiveå»ºè¡¨"><a href="#Hiveå»ºè¡¨" class="headerlink" title="Hiveå»ºè¡¨"></a>Hiveå»ºè¡¨</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç¡®ä¿æ•°æ®åº“å­˜åœ¨</span></span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> ods_lijinquan location &quot;/zhiyun/lijinquan/ods&quot;;</span><br><span class="line"><span class="comment">-- å»ºè¡¨</span></span><br><span class="line"><span class="comment">-- odså±‚çš„è¡¨éƒ½åº”è¯¥æ˜¯å¤–éƒ¨è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">external</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> ods_lijinquan.c_org_busi(</span><br><span class="line">...</span><br><span class="line">) <span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> &quot;\t&quot;</span><br><span class="line">lines terminated <span class="keyword">by</span> &quot;\n&quot;</span><br><span class="line">stored <span class="keyword">as</span> orc</span><br><span class="line">location &quot;/zhiyun/lijinquan/ods/c_org_busi&quot;;</span><br></pre></td></tr></table></figure><h3 id="éªŒè¯æ•°æ®"><a href="#éªŒè¯æ•°æ®" class="headerlink" title="éªŒè¯æ•°æ®"></a>éªŒè¯æ•°æ®</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ods_lijinquan.c_org_busi limit <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> ods_lijinquan.c_org_busi;</span><br></pre></td></tr></table></figure><h3 id="è°ƒåº¦å¹³å°çš„å®‰è£…"><a href="#è°ƒåº¦å¹³å°çš„å®‰è£…" class="headerlink" title="è°ƒåº¦å¹³å°çš„å®‰è£…"></a>è°ƒåº¦å¹³å°çš„å®‰è£…</h3><p>å°†ç›®å½• <code>\07_åŒ»è¯\xxl-job-student-20221220</code>ä¸Šä¼ åˆ° hadoop100çš„ <code>/opt</code>ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ”¹å</span></span><br><span class="line"><span class="built_in">mv</span> /opt/xxl-job-student-20221220 /opt/xxljob</span><br><span class="line"><span class="comment"># å¯¼å…¥åˆ°mysql</span></span><br><span class="line"><span class="comment"># ç¡®ä¿mysqlçš„å¯†ç ä¸ºroot</span></span><br><span class="line">mysql -uroot -proot</span><br><span class="line"><span class="comment"># åœ¨mysqlé‡Œæ‰§è¡Œ:</span></span><br><span class="line"><span class="built_in">source</span> /opt/xxljob/tables_xxl_job.sql;</span><br><span class="line">quit;</span><br></pre></td></tr></table></figure><p>ç¼–å†™å¯åœè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /root/bin/xxl</span><br></pre></td></tr></table></figure><p>å†…å®¹:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">act=$1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start()&#123;</span><br><span class="line">    echo &quot;starting xxl-job&quot;</span><br><span class="line">    ssh root@hadoop100 &quot;cd /opt/xxljob; nohup java -jar xxl-job-admin-2.3.0.jar &gt; xxl-job.log 2&gt;&amp;1 &amp;&quot;</span><br><span class="line">    ssh root@hadoop100 &quot;cd /opt/xxljob; nohup java -jar xxl-job-executor-sample-springboot-2.3.0.jar &gt; xxl-job-executor.log 2&gt;&amp;1 &amp;&quot;</span><br><span class="line">    ssh root@hadoop101 &quot;cd /opt/xxljob; nohup java -jar xxl-job-executor-sample-springboot-2.3.0.jar &gt; xxl-job-executor.log 2&gt;&amp;1 &amp;&quot;</span><br><span class="line">    ssh root@hadoop102 &quot;cd /opt/xxljob; nohup java -jar xxl-job-executor-sample-springboot-2.3.0.jar &gt; xxl-job-executor.log 2&gt;&amp;1 &amp;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stop()&#123;</span><br><span class="line">    echo &quot;stopping xxl-job&quot;</span><br><span class="line">    ssh root@hadoop100 &quot;ps -aux | grep xxl-job-admin | grep -v grep | awk &#x27;&#123;print \$2&#125;&#x27; | xargs kill -9&quot;</span><br><span class="line">    ssh root@hadoop100 &quot;ps -aux | grep xxl-job-executor-sample | grep -v grep | awk &#x27;&#123;print \$2&#125;&#x27; | xargs kill -9&quot;</span><br><span class="line">    ssh root@hadoop101 &quot;ps -aux | grep xxl-job-executor-sample | grep -v grep | awk &#x27;&#123;print \$2&#125;&#x27; | xargs kill -9&quot;</span><br><span class="line">    ssh root@hadoop102 &quot;ps -aux | grep xxl-job-executor-sample | grep -v grep | awk &#x27;&#123;print \$2&#125;&#x27; | xargs kill -9&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">status()&#123;</span><br><span class="line">    echo &quot;=============== hadoop102 =================&quot;</span><br><span class="line">    ssh root@hadoop102 &quot;ps -aux | grep xxl-job-executor-sample | grep -v grep&quot;</span><br><span class="line">    echo &quot;=============== hadoop101 =================&quot;</span><br><span class="line">    ssh root@hadoop101 &quot;ps -aux | grep xxl-job-executor-sample | grep -v grep&quot;</span><br><span class="line">    echo &quot;=============== hadoop100 =================&quot;</span><br><span class="line">    ssh root@hadoop100 &quot;ps -aux | grep xxl-job | grep -v grep&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">case $act in</span><br><span class="line">start)</span><br><span class="line">    start</span><br><span class="line">    status</span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line">    stop</span><br><span class="line">    status</span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">    status</span><br><span class="line">;;</span><br><span class="line">status)</span><br><span class="line">    status</span><br><span class="line">;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p>åŠ æƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x /root/bin/xxl</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åŒæ­¥</span></span><br><span class="line">xsync /opt/xxljob</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨</span></span><br><span class="line">xxl start</span><br><span class="line"></span><br><span class="line">=============== hadoop102 =================</span><br><span class="line">root       2340  0.0  1.2 2679420 22952 ?       Sl   15:40   0:00 java -jar xxl-job-executor-sample-springboot-2.3.0.jar</span><br><span class="line">=============== hadoop101 =================</span><br><span class="line">root       2293  134  2.2 2679420 42324 ?       Sl   15:40   0:01 java -jar xxl-job-executor-sample-springboot-2.3.0.jar</span><br><span class="line">=============== hadoop100 =================</span><br><span class="line">root      20685  146  2.0 2679452 38340 ?       Sl   15:40   0:01 java -jar xxl-job-admin-2.3.0.jar</span><br><span class="line">root      20710  150  2.1 2679424 40340 ?       Sl   15:40   0:01 java -jar xxl-job-executor-sample-springboot-2.3.0.jar</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">çŠ¶æ€</span></span><br><span class="line">xxl status</span><br></pre></td></tr></table></figure><p>ç­‰åˆ° 8080 ç«¯å£å¯åŠ¨æˆåŠŸå, å¯ä»¥è®¿é—®:</p><p><a href="http://192.168.200.100:8080/xxl-job-admin">http://192.168.200.100:8080/xxl-job-admin</a></p><p>ç™»å½• admin &#x2F; 123456</p><p>æ‰§è¡Œå™¨: è°ƒåº¦å¹³å°ä¼šéšæœºä½¿ç”¨ä»»ä¸€æ‰§è¡Œå™¨å»æ‰§è¡Œä»»åŠ¡</p><h1 id="Hive-è¡¨å¯¼å‡ºåˆ°-MySQL-æ•°æ®åº“"><a href="#Hive-è¡¨å¯¼å‡ºåˆ°-MySQL-æ•°æ®åº“" class="headerlink" title="Hive è¡¨å¯¼å‡ºåˆ° MySQL æ•°æ®åº“"></a>Hive è¡¨å¯¼å‡ºåˆ° MySQL æ•°æ®åº“</h1><h2 id="test-read-hdfs-json"><a href="#test-read-hdfs-json" class="headerlink" title="test_read_hdfs.json"></a><code>test_read_hdfs.json</code></h2><p>å°† HDFS ä¸­çš„æ•°æ®åŒæ­¥åˆ° MySQL æ•°æ®åº“</p><ol><li>ä» HDFS è·¯å¾„ <code>/user/hive/warehouse/db_hive.db/sqoop_emp</code> è¯»å–æ•°æ®</li><li>æŒ‰åˆ¶è¡¨ç¬¦åˆ†éš”è§£ææ–‡æœ¬è¡Œï¼Œæå– 8 ä¸ªå­—æ®µ</li><li>é€šè¿‡ 3 ä¸ªå¹¶å‘é€šé“å°†æ•°æ®ä¼ è¾“åˆ° MySQL</li><li>å°†æ•°æ®æ’å…¥åˆ° MySQL çš„ <code>test.emp</code> è¡¨ä¸­</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfsreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/user/hive/warehouse/db_hive.db/sqoop_emp&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop100:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UTF-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlwriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;insert&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;empno&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;ename&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;job&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;mgr&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;hiredate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;sal&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;comm&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="string">&quot;deptno&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;session&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;set session sql_mode=&#x27;ANSI&#x27;&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jdbc:mysql://hadoop100:3306/test?useSSL=False&amp;useUnicode=true&amp;characterEncoding=utf-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;emp&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/06/24/Hadoop/image-20250707111745049.png" alt="image-20250707111745049"></p><h2 id="exp-log-sh"><a href="#exp-log-sh" class="headerlink" title="exp_log.sh"></a><code>exp_log.sh</code></h2><ol><li><strong>ç”Ÿæˆé…ç½®æ–‡ä»¶</strong>ï¼šæ ¹æ®ä¼ å…¥çš„æ—¥æœŸåˆ†åŒºå‚æ•° <code>$1</code>ï¼ŒåŠ¨æ€ç”Ÿæˆ DataX é…ç½®æ–‡ä»¶ <code>exp_log.json</code>ï¼Œé…ç½®ä» HDFS è¯»å–æŒ‡å®šæ—¥æœŸåˆ†åŒºçš„æ•°æ®ï¼Œå¹¶å†™å…¥ MySQL è¡¨ã€‚</li><li><strong>åˆ›å»ºç›®æ ‡è¡¨</strong>ï¼šåœ¨ MySQL ä¸­åˆ›å»º <code>log</code> è¡¨ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œå®šä¹‰äº”ä¸ª VARCHAR ç±»å‹çš„å­—æ®µç”¨äºå­˜å‚¨æ—¥å¿—æ•°æ®ã€‚</li><li><strong>æ‰§è¡Œæ•°æ®åŒæ­¥</strong>ï¼šè°ƒç”¨ DataX å·¥å…·æ‰§è¡Œæ•°æ®å¯¼å‡ºä»»åŠ¡ï¼Œå°† HDFS ä¸Šçš„æ–‡æœ¬æ ¼å¼æ•°æ®ï¼ˆ<code>/user/hive/warehouse/db_hive.db/log/dt=$part</code>ï¼‰æŒ‰å­—æ®µæ˜ å°„å…³ç³»å†™å…¥ MySQL çš„ <code>log</code> è¡¨ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">part=<span class="variable">$1</span> </span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªjsonï¼Œç”¨æ¥ç»™dataxè°ƒç”¨</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;job&quot;: &#123;</span></span><br><span class="line"><span class="string">        &quot;setting&quot;: &#123;</span></span><br><span class="line"><span class="string">            &quot;speed&quot;: &#123;</span></span><br><span class="line"><span class="string">                &quot;channel&quot;: 3</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &quot;content&quot;: [</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;reader&quot;: &#123;</span></span><br><span class="line"><span class="string">                    &quot;name&quot;: &quot;hdfsreader&quot;,</span></span><br><span class="line"><span class="string">                    &quot;parameter&quot;: &#123;</span></span><br><span class="line"><span class="string">                        &quot;path&quot;: &quot;/user/hive/warehouse/db_hive.db/log/dt=&#x27;</span><span class="variable">$part</span><span class="string">&#x27;&quot;,</span></span><br><span class="line"><span class="string">                        &quot;defaultFS&quot;: &quot;hdfs://hadoop100:8020&quot;,</span></span><br><span class="line"><span class="string">                        &quot;column&quot;: [</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;index&quot;: 0,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;index&quot;: 1,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;index&quot;: 2,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;index&quot;: 3,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;index&quot;: 4,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;</span></span><br><span class="line"><span class="string">                        ],</span></span><br><span class="line"><span class="string">                        &quot;fileType&quot;: &quot;text&quot;,</span></span><br><span class="line"><span class="string">                        &quot;encoding&quot;: &quot;UTF-8&quot;,</span></span><br><span class="line"><span class="string">                        &quot;fieldDelimiter&quot;: &quot;\t&quot;</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                &quot;writer&quot;: &#123;</span></span><br><span class="line"><span class="string">                    &quot;name&quot;: &quot;mysqlwriter&quot;,</span></span><br><span class="line"><span class="string">                    &quot;parameter&quot;: &#123;</span></span><br><span class="line"><span class="string">                        &quot;writeMode&quot;: &quot;insert&quot;,</span></span><br><span class="line"><span class="string">                        &quot;username&quot;: &quot;test&quot;,</span></span><br><span class="line"><span class="string">                        &quot;password&quot;: &quot;test&quot;,</span></span><br><span class="line"><span class="string">                        &quot;column&quot;: [</span></span><br><span class="line"><span class="string">                            &quot;ip&quot;,</span></span><br><span class="line"><span class="string">                            &quot;date_l&quot;,</span></span><br><span class="line"><span class="string">                            &quot;url&quot;,</span></span><br><span class="line"><span class="string">                            &quot;osinfo&quot;,</span></span><br><span class="line"><span class="string">                            &quot;bowser&quot;</span></span><br><span class="line"><span class="string">                        ],</span></span><br><span class="line"><span class="string">                        &quot;session&quot;: [</span></span><br><span class="line"><span class="string">                            &quot;set session sql_mode=&#x27;</span><span class="string">&quot;&#x27;ANSI&#x27;&quot;</span><span class="string">&#x27;&quot;</span></span><br><span class="line"><span class="string">                        ],</span></span><br><span class="line"><span class="string">                        &quot;connection&quot;: [</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;jdbcUrl&quot;: &quot;jdbc:mysql://hadoop100:3306/test?useSSL=False&amp;useUnicode=true&amp;characterEncoding=utf-8&quot;,</span></span><br><span class="line"><span class="string">                                &quot;table&quot;: [</span></span><br><span class="line"><span class="string">                                    &quot;log&quot;</span></span><br><span class="line"><span class="string">                                ]</span></span><br><span class="line"><span class="string">                            &#125;</span></span><br><span class="line"><span class="string">                        ]</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> &gt; /root/datax/json/exp_log.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™ä¸€ä¸ªå»ºè¡¨è¯­å¥ï¼Œå†mysqlå»ºè¡¨</span></span><br><span class="line">mysql -utest -ptest --database=<span class="built_in">test</span> -e \</span><br><span class="line"><span class="string">&#x27;create table if not exists log (</span></span><br><span class="line"><span class="string">    ip varchar(500),</span></span><br><span class="line"><span class="string">    date_l varchar(500),</span></span><br><span class="line"><span class="string">    url varchar(500),</span></span><br><span class="line"><span class="string">    osinfo varchar(500),</span></span><br><span class="line"><span class="string">    bowser varchar(500)</span></span><br><span class="line"><span class="string">)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨dataxç¨‹åºï¼Œå®Œæˆæ“ä½œ</span></span><br><span class="line">/usr/local/bin/python3.9 /opt/module/datax/bin/datax.py /root/datax/json/exp_log.json</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/06/24/Hadoop/image-20250707111856490.png" alt="image-20250707111856490"></p><h2 id="xxl-job-ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ-æ–°å¢ä»»åŠ¡ç®¡ç†"><a href="#xxl-job-ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ-æ–°å¢ä»»åŠ¡ç®¡ç†" class="headerlink" title="xxl-job-ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ-æ–°å¢ä»»åŠ¡ç®¡ç†"></a>xxl-job-ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒ-æ–°å¢ä»»åŠ¡ç®¡ç†</h2><p><img src="/2025/06/24/Hadoop/image-20250707111920017.png" alt="image-20250707111920017"></p><p><strong>GLUE IDE</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;xxl-job: hello shell&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;è„šæœ¬ä½ç½®ï¼š<span class="variable">$0</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä»»åŠ¡å‚æ•°ï¼š<span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;åˆ†ç‰‡åºå· = <span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;åˆ†ç‰‡æ€»æ•° = <span class="variable">$3</span>&quot;</span></span><br><span class="line">/root/datax/shell/exp_log.sh <span class="variable">$1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Good bye!&quot;</span></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡\</p><p><img src="/2025/06/24/Hadoop/image-20250707112014506.png" alt="image-20250707112014506"></p><p>mysql.testä¸­æŸ¥è¯¢logæ•°æ®é‡</p><p><img src="/2025/06/24/Hadoop/image-20250707112033577.png" alt="image-20250707112033577"></p><h1 id="åŠ¨æ€åˆ†åŒºè¡¨å¯¼å…¥å¯¼å‡º"><a href="#åŠ¨æ€åˆ†åŒºè¡¨å¯¼å…¥å¯¼å‡º" class="headerlink" title="åŠ¨æ€åˆ†åŒºè¡¨å¯¼å…¥å¯¼å‡º"></a>åŠ¨æ€åˆ†åŒºè¡¨å¯¼å…¥å¯¼å‡º</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;errorLimit&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;record&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;percentage&quot;</span><span class="punctuation">:</span> <span class="number">0.02</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;*&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;splitPk&quot;</span><span class="punctuation">:</span> <span class="string">&quot;db_id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;querySql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;select * from log where osinfo = &#x27;Windows&#x27;;&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;jjdbc:mysql://hadoop100:3306/test?useSSL=False&amp;useUnicode=true&amp;characterEncoding=utf-8&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hadoop100:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;orc&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/user/hive/warehouse/db_hive.db/log_tmp&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;log_p&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ip&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;date_l&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;url&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;osinfo&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;browser&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;truncate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;NONE&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨db_hiveä¸­å»ºlog_tempè¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> log_tmp(</span><br><span class="line">ip string,</span><br><span class="line">date_l string,</span><br><span class="line">url string,</span><br><span class="line">osinfo string,</span><br><span class="line">browser string</span><br><span class="line">)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br><span class="line">lines terminated <span class="keyword">by</span> <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">stored <span class="keyword">as</span> orc</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬<br><code>/usr/local/bin/python3.9 /opt/module/datax/bin/datax.py /root/datax/json/imp_log.json</code></p><p><img src="/2025/06/24/Hadoop/image-20250707112144219.png" alt="image-20250707112144219"></p><h2 id="imp-log-sh"><a href="#imp-log-sh" class="headerlink" title="imp_log.sh"></a><code>imp_log.sh</code></h2><ol><li><strong>JSON é…ç½®æ–‡ä»¶ç”Ÿæˆ</strong>ï¼šåˆ›å»º DataX ä»»åŠ¡é…ç½®æ–‡ä»¶ <code>imp_log.json</code>ï¼Œé…ç½®ä» MySQL è¯»å–æ•°æ®å¹¶å†™å…¥ HDFS çš„ ORC æ–‡ä»¶æ ¼å¼ã€‚</li><li>Hive è¡¨åˆ›å»ºï¼šä½¿ç”¨ Beeline è¿æ¥ Hiveï¼Œåˆ›å»ºä¸¤ä¸ª ORC æ ¼å¼çš„è¡¨ï¼š<ul><li><code>log_tmp</code>ï¼šä¸´æ—¶è¡¨ï¼Œç”¨äºå­˜å‚¨ä» MySQL å¯¼å…¥çš„åŸå§‹æ•°æ®</li><li><code>log_p</code>ï¼šåˆ†åŒºè¡¨ï¼ŒæŒ‰æ“ä½œç³»ç»Ÿç±»å‹ (<code>os_tp</code>) åˆ†åŒº</li></ul></li><li><strong>æ•°æ®æŠ½å–ä¸å¯¼å…¥</strong>ï¼šè°ƒç”¨ DataX å·¥å…·æ‰§è¡Œæ•°æ®åŒæ­¥ä»»åŠ¡ï¼Œå°† MySQL çš„ <code>log</code> è¡¨æ•°æ®å¯¼å…¥åˆ° Hive çš„ <code>log_tmp</code> è¡¨ã€‚</li><li><strong>åŠ¨æ€åˆ†åŒºæ’å…¥</strong>ï¼šé…ç½® Hive åŠ¨æ€åˆ†åŒºå‚æ•°ï¼Œå°† <code>log_tmp</code> è¡¨çš„æ•°æ®æŒ‰ <code>osinfo</code> å­—æ®µçš„å€¼è‡ªåŠ¨åˆ†é…åˆ° <code>log_tmp2</code> è¡¨çš„ä¸åŒåˆ†åŒºä¸­ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#åˆ›å»ºjsonæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    &quot;job&quot;: &#123;</span></span><br><span class="line"><span class="string">        &quot;setting&quot;: &#123;</span></span><br><span class="line"><span class="string">            &quot;speed&quot;: &#123;</span></span><br><span class="line"><span class="string">                &quot;channel&quot;: 3</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &quot;errorLimit&quot;: &#123;</span></span><br><span class="line"><span class="string">                &quot;record&quot;: 0,</span></span><br><span class="line"><span class="string">                &quot;percentage&quot;: 0.02</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &quot;content&quot;: [</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;reader&quot;: &#123;</span></span><br><span class="line"><span class="string">                    &quot;name&quot;: &quot;mysqlreader&quot;,</span></span><br><span class="line"><span class="string">                    &quot;parameter&quot;: &#123;</span></span><br><span class="line"><span class="string">                        &quot;username&quot;: &quot;test&quot;,</span></span><br><span class="line"><span class="string">                        &quot;password&quot;: &quot;test&quot;,</span></span><br><span class="line"><span class="string">                        &quot;column&quot;: [</span></span><br><span class="line"><span class="string">                            &quot;*&quot;</span></span><br><span class="line"><span class="string">                        ],</span></span><br><span class="line"><span class="string">                        //&quot;splitPk&quot;: &quot;db_id&quot;,</span></span><br><span class="line"><span class="string">                        &quot;connection&quot;: [</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;table&quot;: [</span></span><br><span class="line"><span class="string">                                    &quot;log;&quot;</span></span><br><span class="line"><span class="string">                                ],</span></span><br><span class="line"><span class="string">                                &quot;jdbcUrl&quot;: [</span></span><br><span class="line"><span class="string">                                    &quot;jdbc:mysql://hadoop100:3306/test?useSSL=False&amp;useUnicode=true&amp;characterEncoding=utf-8&quot;</span></span><br><span class="line"><span class="string">                                ]</span></span><br><span class="line"><span class="string">                            &#125;</span></span><br><span class="line"><span class="string">                        ]</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                &quot;writer&quot;: &#123;</span></span><br><span class="line"><span class="string">                    &quot;name&quot;: &quot;hdfswriter&quot;,</span></span><br><span class="line"><span class="string">                    &quot;parameter&quot;: &#123;</span></span><br><span class="line"><span class="string">                        &quot;defaultFS&quot;: &quot;hdfs://hadoop100:8020&quot;,</span></span><br><span class="line"><span class="string">                        &quot;fileType&quot;: &quot;orc&quot;,</span></span><br><span class="line"><span class="string">                        &quot;path&quot;: &quot;/user/hive/warehouse/db_hive.db/log_tmp&quot;,</span></span><br><span class="line"><span class="string">                        &quot;fileName&quot;: &quot;log_tmp&quot;,</span></span><br><span class="line"><span class="string">                        &quot;column&quot;: [</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;name&quot;: &quot;ip&quot;,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;name&quot;: &quot;date_l&quot;,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;name&quot;: &quot;url&quot;,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;name&quot;: &quot;osinfo&quot;,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;,</span></span><br><span class="line"><span class="string">                            &#123;</span></span><br><span class="line"><span class="string">                                &quot;name&quot;: &quot;browser&quot;,</span></span><br><span class="line"><span class="string">                                &quot;type&quot;: &quot;string&quot;</span></span><br><span class="line"><span class="string">                            &#125;</span></span><br><span class="line"><span class="string">                        ],</span></span><br><span class="line"><span class="string">                        &quot;writeMode&quot;: &quot;truncate&quot;,</span></span><br><span class="line"><span class="string">                        &quot;fieldDelimiter&quot;: &quot;\t&quot;,</span></span><br><span class="line"><span class="string">                        &quot;compress&quot;: &quot;NONE&quot;</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> &gt; /root/datax/json/imp_log.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ºä¸´æ—¶è¡¨å’Œåˆ†åŒºè¡¨</span></span><br><span class="line">beeline -u jdbc:hive2://hadoop100:10000/db_hive -u root -p 545456 -e \</span><br><span class="line"><span class="string">&quot;CREATE TABLE if not exists log_tmp(</span></span><br><span class="line"><span class="string">ip string,</span></span><br><span class="line"><span class="string">date_l string,</span></span><br><span class="line"><span class="string">url string,</span></span><br><span class="line"><span class="string">osinfo string,</span></span><br><span class="line"><span class="string">browser string</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">row format delimited</span></span><br><span class="line"><span class="string">fields terminated by &#x27;\t&#x27;</span></span><br><span class="line"><span class="string">lines TERMINATED by &#x27;\n&#x27;</span></span><br><span class="line"><span class="string">STORED AS orc;</span></span><br><span class="line"><span class="string">CREATE TABLE if not exists log_p(</span></span><br><span class="line"><span class="string">ip string,</span></span><br><span class="line"><span class="string">date_l string,</span></span><br><span class="line"><span class="string">url string, </span></span><br><span class="line"><span class="string">osinfo string,</span></span><br><span class="line"><span class="string">browser string</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">partitioned by (os_tp string)</span></span><br><span class="line"><span class="string">row format delimited</span></span><br><span class="line"><span class="string">fields terminated by &#x27;\t&#x27;</span></span><br><span class="line"><span class="string">lines TERMINATED by &#x27;\n&#x27;</span></span><br><span class="line"><span class="string">STORED AS orc &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;*******************å»ºè¡¨å®Œæˆ--***********************&#x27;</span></span><br><span class="line"><span class="comment">#å¯¼å…¥æ•°æ®</span></span><br><span class="line">/bin/python3 /opt/module/datax/bin/datax.py /root/datax/json/imp_log.json</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;*****************æ•°æ®å¯¼å…¥æˆåŠŸ************************&#x27;</span></span><br><span class="line"><span class="comment">#åŠ¨æ€åˆ†åŒº</span></span><br><span class="line">beeline -u jdbc:hive2://hadoop100:10000/db_hive -u root -p 545456 -e \</span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="string">set hive.exec.dynamic.partition=true;</span></span><br><span class="line"><span class="string">set hive.exec.dynamic.partition.mode=nonstrict;</span></span><br><span class="line"><span class="string">set hive.exec.max.dynamic.partitions=200;</span></span><br><span class="line"><span class="string">set hive.exec.max.dynamic.partitions.pernode=50;</span></span><br><span class="line"><span class="string">set hive.exec.max.created.files=1000;</span></span><br><span class="line"><span class="string">set hive.error.on.empty.partition=false;</span></span><br><span class="line"><span class="string">set hive.support.quoted.identifiers=none;</span></span><br><span class="line"><span class="string">insert into log_p partition (os_tp) select l.*,osinfo from log_tmp l;</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;------------------å®Œæˆ------------------&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/06/24/Hadoop/image-20250707112233843.png" alt="image-20250707112233843"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python</title>
      <link href="/2025/05/28/Python/"/>
      <url>/2025/05/28/Python/</url>
      
        <content type="html"><![CDATA[<h1 id="å›½å†…å¸¸ç”¨é•œåƒæº"><a href="#å›½å†…å¸¸ç”¨é•œåƒæº" class="headerlink" title="å›½å†…å¸¸ç”¨é•œåƒæº"></a>å›½å†…å¸¸ç”¨é•œåƒæº</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">æ¸…åå¤§å­¦ ï¼šhttps://pypi.tuna.tsinghua.edu.cn/simple/</span><br><span class="line"></span><br><span class="line">é˜¿é‡Œäº‘ï¼šhttp://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"></span><br><span class="line">ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ ï¼šhttp://pypi.mirrors.ustc.edu.cn/simple/</span><br><span class="line"></span><br><span class="line">åä¸­ç§‘æŠ€å¤§å­¦ï¼šhttp://pypi.hustunique.com/</span><br><span class="line"></span><br><span class="line">è±†ç“£æºï¼šhttp://pypi.douban.com/simple/</span><br><span class="line"></span><br><span class="line">è…¾è®¯æºï¼šhttp://mirrors.cloud.tencent.com/pypi/simple</span><br><span class="line"></span><br><span class="line">åä¸ºé•œåƒæºï¼šhttps://repo.huaweicloud.com/repository/pypi/simple/</span><br></pre></td></tr></table></figure><h1 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h1><ul><li><p><strong>æ•°å­—å‹ï¼š bool int float</strong> </p></li><li><p><strong>â¾®æ•°å­—å‹ï¼š str list tuple set dict</strong> </p></li><li><p><strong>â½‡æœŸå‹ï¼š time datetime</strong></p></li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sno=<span class="number">1</span></span><br><span class="line">age=<span class="number">18</span></span><br><span class="line">sname=<span class="string">&quot;å°æ˜&quot;</span></span><br><span class="line">high=<span class="number">1.786</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sname&#125;</span>å­¦å·ä¸º<span class="subst">&#123;sno&#125;</span>,å¹´é¾„ä¸º<span class="subst">&#123;age&#125;</span>å²,èº«é«˜ä¸º<span class="subst">&#123;high&#125;</span>ç±³&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sname&#125;</span>å­¦å·ä¸º<span class="subst">&#123;sno:05d&#125;</span>ï¼Œå¹´é¾„ä¸º<span class="subst">&#123;age&#125;</span>å²ï¼Œèº«é«˜ä¸º<span class="subst">&#123;high:<span class="number">.2</span>f&#125;</span>ç±³&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">f&#x27;<span class="subst">&#123;value&#125;</span>&#x27;</span>æ ¼å¼åŒ–è¾“å‡º</span><br></pre></td></tr></table></figure><h1 id="è¾“â¼Š"><a href="#è¾“â¼Š" class="headerlink" title="è¾“â¼Š"></a>è¾“â¼Š</h1><p>ä½¿â½¤ input å‡½æ•°æ¥æ¥æ”¶â½¤â¼¾ä»é”®ç›˜è¾“â¼Š ,input è¾“â¼Šçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²å‹ </p><p>passwd&#x3D;input(â€œ è¯·è¾“â¼Šå¯†ç ï¼š â€œ) print(type(passwd)) æˆ‘ä»¬ä½¿â½¤ int() ã€ float() ã€ str()  ç­‰è½¬æ¢ã€‚ </p><h1 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h1><ul><li>ç®—æ•°ï¼š + - * &#x2F; %( å–ä½™ ) **( å¹‚ ) &#x2F;&#x2F;( å–å•† ) </li><li>â½è¾ƒï¼š &#x3D;&#x3D; !&#x3D; &gt; &gt;&#x3D; &lt; &lt;&#x3D; </li><li>èµ‹å€¼ï¼š &#x3D; +&#x3D; -&#x3D; *&#x3D; &#x2F;&#x3D; **&#x3D; &#x2F;&#x2F;&#x3D; </li><li>é€»è¾‘ï¼š and or not</li></ul><h1 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h1><h2 id="é€‰æ‹©ç»“æ„-if"><a href="#é€‰æ‹©ç»“æ„-if" class="headerlink" title="é€‰æ‹©ç»“æ„ if"></a>é€‰æ‹©ç»“æ„ if</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sex=<span class="string">&quot;å¥³&quot;</span></span><br><span class="line"> <span class="keyword">if</span> sex==<span class="string">&quot;ç”·&quot;</span>:</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æ‰“æ¸¸æˆ&quot;</span>)</span><br><span class="line"> <span class="keyword">elif</span> sex==<span class="string">&quot;å¥³&quot;</span>:</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;å»é€›è¡—&quot;</span>)</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;å…¶ä»–&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="å¾ªç¯ç»“æ„-while-å’Œ-for"><a href="#å¾ªç¯ç»“æ„-while-å’Œ-for" class="headerlink" title="å¾ªç¯ç»“æ„ while å’Œ for"></a>å¾ªç¯ç»“æ„ while å’Œ for</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¾ªç¯è¾“å‡º1-10æ•°å­—</span></span><br><span class="line">i= 1</span><br><span class="line"> <span class="keyword">while</span>  i&lt;=10:</span><br><span class="line"> <span class="built_in">print</span>(i)</span><br><span class="line"> i+=1</span><br><span class="line"> <span class="comment"># å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥å¾ªç¯è¾“å‡ºé‡Œé¢çš„å­—ç¬¦</span></span><br><span class="line">names=<span class="string">&quot;hello world*ä½ å¥½&quot;</span></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> names:</span><br><span class="line"> <span class="built_in">print</span>(i)</span><br><span class="line"> <span class="comment"># æ•°å€¼èŒƒå›´</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(10): </span><br><span class="line"><span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><h1 id="å­—ç¬¦ä¸²-String"><a href="#å­—ç¬¦ä¸²-String" class="headerlink" title="å­—ç¬¦ä¸² (String)"></a>å­—ç¬¦ä¸² (String)</h1><ul><li>æ‹¼æ¥ * å¤åˆ¶ â€œâ€â€ ä¿ç•™æ ¼å¼ </li><li>å­—ç¬¦ä¸²çš„ç´¢å¼•æˆªå–ï¼Œå˜é‡å [ å¤´ä¸‹æ ‡ : å°¾ä¸‹æ ‡ ] </li><li>ç´¢å¼•å€¼ä»¥ 0  ä¸ºå¼€å§‹å€¼ï¼Œ-1  ä¸ºä»æœ«å°¾çš„å¼€å§‹ä½ç½®ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç´¢å¼•åˆ‡ç‰‡</span></span><br><span class="line">s=<span class="string">&quot;abcsdfsdf&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">0</span>:<span class="number">4</span>]) <span class="comment">#åšåˆ‡ç‰‡çš„æ—¶å€™ï¼Œæ˜¯å·¦é—­å³å¼€çš„ï¼Œä¹Ÿå°±æ˜¯ä¸åŒ…æ‹¬å³è¾¹æ•°å­—å¯¹åº”çš„ä¸‹æ ‡ç´¢å¼•</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">2</span>:]) </span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">0</span>:<span class="number">6</span>:<span class="number">2</span>]) <span class="comment">#æ­¥é•¿ä¸º2</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>å­—ç¬¦ä¸²å‡½æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><strong>len(str)</strong></td><td>è·å–å­—ç¬¦ä¸²é•¿åº¦</td></tr><tr><td><strong>str.find(â€˜strâ€™,int1,int2)</strong></td><td>å­—ç¬¦æŸ¥æ‰¾ ,æ‰¾åˆ°è¿”å›ç´¢å¼•ï¼Œæ²¡æ‰¾åˆ°è¿”å›-1.ã€‚<strong>int1ï¼Œint2åˆ†åˆ«ä»£è¡¨å¼€å§‹ç´¢å¼•å’Œç»“æŸç´¢å¼•</strong></td></tr><tr><td><strong>str.rfind()</strong></td><td>ä»£è¡¨ä»å³ä¾§å¼€å§‹æŸ¥æ‰¾</td></tr><tr><td><strong>str.isdigit()</strong></td><td>æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯æ•°å­—</td></tr><tr><td><strong>str.count()</strong></td><td>ç»Ÿè®¡å­—ç¬¦ä¸²é‡ŒæŸä¸ªå­—ç¬¦æˆ–å­å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°</td></tr></tbody></table><h1 id="Python-ä¸­çš„å­—ç¬¦-ASCII-ç è¿ç®—"><a href="#Python-ä¸­çš„å­—ç¬¦-ASCII-ç è¿ç®—" class="headerlink" title="Python ä¸­çš„å­—ç¬¦ ASCII ç è¿ç®—"></a>Python ä¸­çš„å­—ç¬¦ ASCII ç è¿ç®—</h1><h2 id="ASCIIç è¡¨"><a href="#ASCIIç è¡¨" class="headerlink" title="ASCIIç è¡¨"></a>ASCIIç è¡¨</h2><p><img src="/2025/05/28/Python/image-20250601011246268.png" alt="image-20250601011246268"></p><p>åœ¨ Python ä¸­ï¼Œå­—ç¬¦çš„ ASCII ç è¿ç®—å¯ä»¥é€šè¿‡ <code>ord()</code> å’Œ <code>chr()</code> å‡½æ•°å®ç°ï¼Œå…è®¸ä½ å¯¹å­—ç¬¦è¿›è¡Œæ•°å€¼æ“ä½œã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£é‡Šå’Œç¤ºä¾‹ï¼š</p><h2 id="æ ¸å¿ƒå‡½æ•°"><a href="#æ ¸å¿ƒå‡½æ•°" class="headerlink" title="æ ¸å¿ƒå‡½æ•°"></a>æ ¸å¿ƒå‡½æ•°</h2><ol><li><p><strong><code>ord(char)</code></strong> - è·å–å­—ç¬¦çš„ ASCII ç å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))  <span class="comment"># è¾“å‡º: 65 (å¤§å†™å­—æ¯ A)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># è¾“å‡º: 97 (å°å†™å­—æ¯ a)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>))  <span class="comment"># è¾“å‡º: 48 (æ•°å­— 0)</span></span><br></pre></td></tr></table></figure></li><li><p><strong><code>chr(code)</code></strong> - å°† ASCII ç è½¬æ¢ä¸ºå­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">65</span>))  <span class="comment"># è¾“å‡º: &#x27;A&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">97</span>))  <span class="comment"># è¾“å‡º: &#x27;a&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">48</span>))  <span class="comment"># è¾“å‡º: &#x27;0&#x27;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="ASCII-ç è¿ç®—ç¤ºä¾‹"><a href="#ASCII-ç è¿ç®—ç¤ºä¾‹" class="headerlink" title="ASCII ç è¿ç®—ç¤ºä¾‹"></a>ASCII ç è¿ç®—ç¤ºä¾‹</h2><h3 id="1-å­—ç¬¦å¤§å°å†™è½¬æ¢"><a href="#1-å­—ç¬¦å¤§å°å†™è½¬æ¢" class="headerlink" title="1. å­—ç¬¦å¤§å°å†™è½¬æ¢"></a>1. å­—ç¬¦å¤§å°å†™è½¬æ¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤§å†™è½¬å°å†™</span></span><br><span class="line">char = <span class="string">&#x27;B&#x27;</span></span><br><span class="line">lower_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(char) + <span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(lower_char)  <span class="comment"># è¾“å‡º: &#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°å†™è½¬å¤§å†™</span></span><br><span class="line">char = <span class="string">&#x27;z&#x27;</span></span><br><span class="line">upper_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(char) - <span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(upper_char)  <span class="comment"># è¾“å‡º: &#x27;Z&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-å­—ç¬¦ç§»ä½ï¼ˆå‡¯æ’’å¯†ç ï¼‰"><a href="#2-å­—ç¬¦ç§»ä½ï¼ˆå‡¯æ’’å¯†ç ï¼‰" class="headerlink" title="2. å­—ç¬¦ç§»ä½ï¼ˆå‡¯æ’’å¯†ç ï¼‰"></a>2. å­—ç¬¦ç§»ä½ï¼ˆå‡¯æ’’å¯†ç ï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_cipher</span>(<span class="params">text, shift</span>):</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            shifted = (<span class="built_in">ord</span>(char) - base + shift) % <span class="number">26</span> + base</span><br><span class="line">            result += <span class="built_in">chr</span>(shifted)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result += char</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">encrypted = caesar_cipher(<span class="string">&quot;Hello, World!&quot;</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(encrypted)  <span class="comment"># è¾“å‡º: &quot;Khoor, Zruog!&quot;</span></span><br><span class="line"></span><br><span class="line">decrypted = caesar_cipher(encrypted, -<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(decrypted)  <span class="comment"># è¾“å‡º: &quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure><h3 id="3-å­—ç¬¦æ¯”è¾ƒ"><a href="#3-å­—ç¬¦æ¯”è¾ƒ" class="headerlink" title="3. å­—ç¬¦æ¯”è¾ƒ"></a>3. å­—ç¬¦æ¯”è¾ƒ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">char1 = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">char2 = <span class="string">&#x27;z&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯”è¾ƒ ASCII ç å€¼</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(char1) &lt; <span class="built_in">ord</span>(char2))  <span class="comment"># è¾“å‡º: True (97 &lt; 122)</span></span><br></pre></td></tr></table></figure><h3 id="4-è®¡ç®—å­—ç¬¦ä½ç½®"><a href="#4-è®¡ç®—å­—ç¬¦ä½ç½®" class="headerlink" title="4. è®¡ç®—å­—ç¬¦ä½ç½®"></a>4. è®¡ç®—å­—ç¬¦ä½ç½®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">letter = <span class="string">&#x27;G&#x27;</span></span><br><span class="line">position = <span class="built_in">ord</span>(letter) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;&#x27;<span class="subst">&#123;letter&#125;</span>&#x27; æ˜¯å­—æ¯è¡¨ä¸­çš„ç¬¬ <span class="subst">&#123;position&#125;</span> ä¸ªå­—æ¯&quot;</span>)</span><br><span class="line"><span class="comment"># è¾“å‡º: &#x27;G&#x27; æ˜¯å­—æ¯è¡¨ä¸­çš„ç¬¬ 7 ä¸ªå­—æ¯</span></span><br></pre></td></tr></table></figure><h3 id="5-ç”Ÿæˆå­—æ¯åºåˆ—"><a href="#5-ç”Ÿæˆå­—æ¯åºåˆ—" class="headerlink" title="5. ç”Ÿæˆå­—æ¯åºåˆ—"></a>5. ç”Ÿæˆå­—æ¯åºåˆ—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆ A åˆ° Z</span></span><br><span class="line">uppercase = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)+<span class="number">1</span>)]</span><br><span class="line"><span class="built_in">print</span>(uppercase)  <span class="comment"># [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, ..., &#x27;Z&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆ a åˆ° z</span></span><br><span class="line">lowercase = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)+<span class="number">1</span>)]</span><br><span class="line"><span class="built_in">print</span>(lowercase)  <span class="comment"># [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, ..., &#x27;z&#x27;]</span></span><br></pre></td></tr></table></figure><h2 id="ASCII-ç è¡¨æ‘˜è¦"><a href="#ASCII-ç è¡¨æ‘˜è¦" class="headerlink" title="ASCII ç è¡¨æ‘˜è¦"></a>ASCII ç è¡¨æ‘˜è¦</h2><table><thead><tr><th align="left">å­—ç¬¦èŒƒå›´</th><th align="left">ASCII èŒƒå›´</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">æ•°å­— 0-9</td><td align="left">48-57</td><td align="left"><code>ord(&#39;0&#39;) = 48</code></td></tr><tr><td align="left">å¤§å†™å­—æ¯ A-Z</td><td align="left">65-90</td><td align="left"><code>ord(&#39;A&#39;) = 65</code></td></tr><tr><td align="left">å°å†™å­—æ¯ a-z</td><td align="left">97-122</td><td align="left"><code>ord(&#39;a&#39;) = 97</code></td></tr><tr><td align="left">ç‰¹æ®Šç¬¦å·</td><td align="left">32-47, 58-64, 91-96, 123-126</td><td align="left"><code>ord(&#39;@&#39;) = 64</code></td></tr></tbody></table><h2 id="é‡è¦æ³¨æ„äº‹é¡¹"><a href="#é‡è¦æ³¨æ„äº‹é¡¹" class="headerlink" title="é‡è¦æ³¨æ„äº‹é¡¹"></a>é‡è¦æ³¨æ„äº‹é¡¹</h2><ol><li><p><strong>Unicode æ”¯æŒ</strong>ï¼š</p><ul><li>Python 3 ä½¿ç”¨ Unicodeï¼Œ<code>ord()</code> è¿”å› Unicode ç ç‚¹</li><li>ASCII å­—ç¬¦çš„ Unicode ç ç‚¹ä¸ ASCII å€¼ç›¸åŒ</li></ul></li><li><p><strong>è¶…å‡º ASCII èŒƒå›´</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤„ç†é ASCII å­—ç¬¦</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;ä¸­&#x27;</span>))  <span class="comment"># è¾“å‡º: 20013 (ä¸­æ–‡å­—ç¬¦çš„ Unicode)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">20013</span>))  <span class="comment"># è¾“å‡º: &#x27;ä¸­&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>è¾¹ç•Œæ£€æŸ¥</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¡®ä¿åœ¨æœ‰æ•ˆèŒƒå›´å†…æ“ä½œ</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>) + <span class="number">1</span>))  <span class="comment"># è¶…å‡ºå°å†™å­—æ¯èŒƒå›´</span></span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li></ol><h2 id="å®é™…åº”ç”¨åœºæ™¯"><a href="#å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="å®é™…åº”ç”¨åœºæ™¯"></a>å®é™…åº”ç”¨åœºæ™¯</h2><ol><li><strong>æ•°æ®åŠ å¯†&#x2F;è§£å¯†</strong>ï¼šå®ç°ç®€å•çš„æ›¿æ¢å¯†ç </li><li><strong>æ–‡æœ¬å¤„ç†</strong>ï¼šå¤§å°å†™è½¬æ¢ã€å­—ç¬¦åˆ†ç±»</li><li><strong>ç®—æ³•å®ç°</strong>ï¼šæ’åºã€æœç´¢ã€å­—ç¬¦ä¸²æ¯”è¾ƒ</li><li><strong>ç¼–ç è½¬æ¢</strong>ï¼šåœ¨ä¸åŒå­—ç¬¦ç¼–ç é—´è½¬æ¢</li><li><strong>è¾“å…¥éªŒè¯</strong>ï¼šæ£€æŸ¥å­—ç¬¦ç±»å‹å’ŒèŒƒå›´</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®ç”¨å‡½æ•°ï¼šæ£€æŸ¥å­—ç¬¦æ˜¯å¦ä¸ºæ•°å­—</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_digit</span>(<span class="params">char</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) &lt;= <span class="built_in">ord</span>(char) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(is_digit(<span class="string">&#x27;5&#x27;</span>))  <span class="comment"># è¾“å‡º: True</span></span><br><span class="line"><span class="built_in">print</span>(is_digit(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># è¾“å‡º: False</span></span><br></pre></td></tr></table></figure><h1 id="list-ï¼ˆåˆ—è¡¨ï¼‰"><a href="#list-ï¼ˆåˆ—è¡¨ï¼‰" class="headerlink" title="list ï¼ˆåˆ—è¡¨ï¼‰"></a>list ï¼ˆåˆ—è¡¨ï¼‰</h1><p> List ï¼ˆåˆ—è¡¨ï¼‰  æ˜¯ Python  ä¸­ä½¿â½¤æœ€é¢‘ç¹çš„æ•°æ®ç±»å‹ã€‚</p><p>ä¸“â»”â½¤äºå­˜å‚¨â¼€ä¸²æ•°æ®ï¼Œå­˜å‚¨çš„æ•°æ®ç§°ä¸ºå…ƒç´  </p><p><strong>åˆ—è¡¨â½¤ [] å®šä¹‰ï¼Œå…ƒç´ ä¹‹é—´â½¤é€—å·åˆ†éš”</strong> </p><p>åˆ—è¡¨å¯ä»¥å®Œæˆâ¼¤å¤šæ•°é›†åˆç±»çš„æ•°æ®ç»“æ„å®ç°ã€‚åˆ—è¡¨ä¸­å…ƒç´ çš„ç±»å‹å¯ä»¥ä¸ç›¸åŒï¼Œå®ƒâ½€æŒæ•° å­—ï¼Œå­—ç¬¦ä¸²ç”šâ¾„å¯ä»¥åŒ…å«åˆ—è¡¨ï¼ˆæ‰€è°“åµŒå¥—ï¼‰ã€‚ åˆ—è¡¨å’Œå­—ç¬¦ä¸²â¼€æ ·ï¼Œ<strong>ç´¢å¼•ä» 0 å¼€å§‹ï¼Œåˆ—è¡¨åŒæ ·å¯ä»¥è¢«ç´¢å¼•å’Œæˆªå–ï¼Œåˆ—è¡¨è¢«æˆªå–åè¿”å›â¼€ä¸ª åŒ…å«æ‰€éœ€å…ƒç´ çš„æ–°åˆ—è¡¨ã€‚</strong> </p><ul><li><strong>List å¯ä»¥ä½¿â½¤ + æ“ä½œç¬¦è¿›â¾æ‹¼æ¥ã€‚</strong></li><li><strong>â½¤æ˜Ÿå· * æ˜¯é‡å¤æ“ä½œ</strong> </li><li><strong>åˆ›å»ºç©ºåˆ—è¡¨ï¼š []</strong></li></ul><h2 id="åˆ—è¡¨çš„å¸¸â½¤æ“ä½œ"><a href="#åˆ—è¡¨çš„å¸¸â½¤æ“ä½œ" class="headerlink" title="åˆ—è¡¨çš„å¸¸â½¤æ“ä½œ"></a>åˆ—è¡¨çš„å¸¸â½¤æ“ä½œ</h2><table><thead><tr><th>åˆ†ç±»</th><th>å…³é”®å­—&#x2F;å‡½æ•°&#x2F;æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å¢åŠ </td><td>åˆ—è¡¨.append(å€¼)</td><td>å‘åˆ—è¡¨æœ«å°¾è¿½åŠ å•ä¸ªå…ƒç´ </td></tr><tr><td></td><td>åˆ—è¡¨.extend(å€¼1,å€¼2Â·Â·Â·ï¼Œå€¼n)</td><td>å‘åˆ—è¡¨åé¢è¿½åŠ å¤šä¸ªå…ƒç´ </td></tr><tr><td></td><td>åˆ—è¡¨.insert(index,å€¼)</td><td>å°†æŸä¸ªå…ƒç´ æ’æ”¾åˆ°æŒ‡å®šä½ç½®</td></tr><tr><td></td><td>åˆ—è¡¨.pop(index)</td><td>åˆ é™¤ç´¢å¼•å¯¹åº”çš„å…ƒç´ ï¼Œå¦‚æœä¸åŠ ç´¢å¼•ï¼Œé»˜è®¤åˆ é™¤æœ€åå…ƒç´ ï¼ŒåŒæ—¶è¿”å›åˆ é™¤å…ƒç´ çš„å¼•ç”¨å…³ç³»</td></tr><tr><td></td><td>del åˆ—è¡¨[1:2]</td><td>æŒ‰ç…§åˆ‡ç‰‡æŒ‡å®šç´¢å¼•åˆ é™¤åˆ—è¡¨å…ƒç´ </td></tr><tr><td></td><td>åˆ—è¡¨.clear()</td><td>æŒ‰ç…§åˆ‡ç‰‡æŒ‡å®šç´¢å¼•åˆ é™¤åˆ—è¡¨å…ƒç´ </td></tr><tr><td>ä¿®æ”¹</td><td>åˆ—è¡¨[ç´¢å¼•]&#x3D;å€¼</td><td>ä¿®æ”¹æŒ‡å®šç´¢å¼•çš„æ•°æ®ï¼Œæ•°æ®ä¸å­˜åœ¨ä¼šæŠ¥é”™</td></tr><tr><td>æŸ¥è¯¢</td><td>åˆ—è¡¨[ç´¢å¼•]</td><td>æ ¹æ®ç´¢å¼•å–å€¼ï¼Œç´¢å¼•ä¸å­˜åœ¨ä¼šæŠ¥é”™</td></tr><tr><td></td><td><strong>åˆ—è¡¨.index(å€¼)</strong></td><td>æ ¹æ®å€¼å–ç´¢å¼•ï¼Œå€¼ä¸å­˜åœ¨ä¼šæŠ¥é”™</td></tr><tr><td></td><td>åˆ—è¡¨.count(å€¼ï¼‰</td><td>è¿”å›åˆ—è¡¨ä¸­åŒ…å«æŸä¸ªå€¼çš„ä¸ªæ•°</td></tr><tr><td></td><td>åˆ—è¡¨.sort()</td><td>å°†åˆ—è¡¨ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œreverse&#x3D;Trueä»£è¡¨é™åº</td></tr><tr><td></td><td>åˆ—è¡¨.reverse()</td><td>åˆ—è¡¨çš„åè½¬ï¼Œç”¨æ¥æ”¹å˜åŸåˆ—è¡¨çš„å…ˆåé¡ºåº</td></tr><tr><td></td><td>len(åˆ—è¡¨)</td><td>åˆ—è¡¨é•¿åº¦ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰</td></tr><tr><td></td><td>max(åˆ—è¡¨ï¼‰</td><td>è¿”å›åˆ—è¡¨å…ƒç´ æœ€å¤§å€¼</td></tr><tr><td></td><td>min(åˆ—è¡¨)</td><td>è¿”å›åˆ—è¡¨å…ƒç´ æœ€å°å€¼</td></tr><tr><td></td><td>sum(åˆ—è¡¨)</td><td>è¿”å›åˆ—è¡¨å…ƒç´ çš„æ€»å’Œ</td></tr></tbody></table><h1 id="å­—ç¬¦ä¸²ä¸åˆ—è¡¨è½¬æ¢"><a href="#å­—ç¬¦ä¸²ä¸åˆ—è¡¨è½¬æ¢" class="headerlink" title="å­—ç¬¦ä¸²ä¸åˆ—è¡¨è½¬æ¢"></a>å­—ç¬¦ä¸²ä¸åˆ—è¡¨è½¬æ¢</h1><ul><li><p><strong>split  åˆ†å‰²å­—ç¬¦ä¸²ä¸ºåˆ—è¡¨</strong> </p></li><li><p><strong>join  æ‹¼æ¥åˆ—è¡¨ä¸ºå­—ç¬¦ä¸²</strong></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">&quot;Google#Run,oob#Taobao#Facebook&quot;</span></span><br><span class="line">stxt=txt.split(<span class="string">&quot;#&quot;</span>) <span class="comment">#åˆ—è¡¨ç±»å‹</span></span><br><span class="line"><span class="built_in">print</span>(stxt[2]) <span class="comment">#åŒå­—ç¬¦ä¸²ä¸€æ ·åˆ‡ç‰‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> stxt:</span><br><span class="line"><span class="built_in">print</span>(i) <span class="comment">#å•è¯æ‰“å°è€Œä¸æ˜¯å­—ç¬¦æ‰“å°</span></span><br><span class="line">n=<span class="string">&quot;.&quot;</span>.<span class="built_in">join</span>(stxt) <span class="comment">#å­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure><h1 id="tuple-ï¼ˆå…ƒç»„ï¼‰åªè¯»çš„åˆ—è¡¨ã€‚"><a href="#tuple-ï¼ˆå…ƒç»„ï¼‰åªè¯»çš„åˆ—è¡¨ã€‚" class="headerlink" title="tuple ï¼ˆå…ƒç»„ï¼‰åªè¯»çš„åˆ—è¡¨ã€‚"></a>tuple ï¼ˆå…ƒç»„ï¼‰åªè¯»çš„åˆ—è¡¨ã€‚</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tuple1 = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">34</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(tuple1))</span><br><span class="line"><span class="built_in">print</span>(tuple1[<span class="number">3</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tuple1:</span><br><span class="line"> <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><h1 id="set-ï¼ˆé›†åˆï¼‰-â½†åºï¼Œå»æ‰é‡å¤æ•°æ®ã€‚"><a href="#set-ï¼ˆé›†åˆï¼‰-â½†åºï¼Œå»æ‰é‡å¤æ•°æ®ã€‚" class="headerlink" title="set ï¼ˆé›†åˆï¼‰  â½†åºï¼Œå»æ‰é‡å¤æ•°æ®ã€‚"></a>set ï¼ˆé›†åˆï¼‰  â½†åºï¼Œå»æ‰é‡å¤æ•°æ®ã€‚</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(set1))</span><br><span class="line"><span class="built_in">print</span>(set1)</span><br><span class="line">set2.add(<span class="number">66666</span>)</span><br><span class="line">set2.remove(<span class="number">55</span>)</span><br></pre></td></tr></table></figure><p>ä¸èƒ½ä½¿ç”¨ä¸‹æ ‡è®¿é—®setï¼Œæ‰€ä»¥ä¿®æ”¹æ“ä½œä¸€èˆ¬ä¸º<strong>removeæ“ä½œ + addæ“ä½œ</strong></p><p><strong>é—®é¢˜ï¼šå¦‚ä½•å®šä¹‰ä¸€ä¸ªç©ºé›†åˆï¼Ÿ</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set1=<span class="built_in">set</span>()</span><br><span class="line"><span class="comment"># æ­£ç¡®çš„ç±»å‹å£°æ˜æ˜¯ç±»å‹å…³é”®å­—()</span></span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„ç±»å‹å£°æ˜æ˜¯<strong>ç±»å‹å…³é”®å­—()</strong></p><h1 id="dict-ï¼ˆå­—å…¸ï¼‰"><a href="#dict-ï¼ˆå­—å…¸ï¼‰" class="headerlink" title="dict ï¼ˆå­—å…¸ï¼‰"></a>dict ï¼ˆå­—å…¸ï¼‰</h1><p> å­—å…¸ï¼ˆ dict ï¼‰æ˜¯ Python ä¸­å¦â¼€ä¸ªâ¾®å¸¸æœ‰â½¤çš„å†…ç½®æ•°æ®ç±»å‹ã€‚</p><ol><li><p><strong>å­—å…¸æ˜¯é”® (key) :  å€¼ (value) çš„ é›†åˆã€‚</strong> </p></li><li><p>åœ¨åŒâ¼€ä¸ªå­—å…¸ä¸­ï¼Œ<strong>é”® (key) å¿…é¡»æ˜¯å”¯â¼€çš„</strong>ã€‚é‡å¤çš„åé¢çš„ä¼šè¦†ç›–å‰é¢çš„</p></li><li><p>åˆ›å»ºç©ºå­—å…¸ä½¿â½¤ { } ã€‚</p></li></ol><table><thead><tr><th>åˆ†ç±»</th><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å¢åŠ </td><td><strong>dict[key]&#x3D;value</strong></td><td>é”®ä¸å­˜åœ¨ï¼Œä¼šæ·»åŠ é”®å€¼å¯¹</td></tr><tr><td>ä¿®æ”¹</td><td><strong>dict[key]&#x3D;value</strong></td><td>é”®å­˜åœ¨ï¼Œä¼šä¿®æ”¹é”®å€¼å¯¹</td></tr><tr><td>åˆ é™¤</td><td><strong>pop&#x2F;del&#x2F;clear</strong></td><td>æ²¡æœ‰ç´¢å¼•</td></tr><tr><td>æŸ¥è¯¢</td><td><strong>dict .keys()</strong></td><td>è·å–æ‰€æœ‰é”®ï¼Œæ˜¯ä¸€ä¸ªè§†å›¾</td></tr><tr><td></td><td><strong>dict.values()</strong></td><td>è·å–æ‰€æœ‰å€¼ï¼Œæ˜¯ä¸€ä¸ªè§†å›¾</td></tr><tr><td></td><td><strong>dict.items()</strong></td><td>è·å–é”®å€¼å¯¹</td></tr></tbody></table><p><strong>åœ¨Pythonä¸­ï¼Œ<code>for i in dict:</code> å¾ªç¯è¿­ä»£çš„æ˜¯å­—å…¸çš„é”®</strong>â€Œã€‚åœ¨Pythonä¸­ï¼Œå­—å…¸æ˜¯ä¸€ç§é”®å€¼å¯¹é›†åˆï¼Œæ¯ä¸ªé”®å¯¹åº”ä¸€ä¸ªå€¼ã€‚å½“ä½ ä½¿ç”¨ <code>for i in dict:</code> è¯­æ³•æ—¶ï¼Œå¾ªç¯ä¼šéå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®ï¼Œå¹¶å°†æ¯ä¸ªé”®ä¾æ¬¡èµ‹å€¼ç»™å˜é‡ <code>i</code>â€Œ12ã€‚</p><p>æ­¤å¤–ï¼ŒPythonè¿˜æä¾›äº†å…¶ä»–å‡ ç§éå†å­—å…¸çš„æ–¹æ³•ï¼š</p><ol><li>â€Œ<strong>éå†é”®</strong>â€Œï¼šä½¿ç”¨ <code>.keys()</code> æ–¹æ³•ï¼Œä¾‹å¦‚ <code>for key in dict.keys():</code>ã€‚</li><li>â€Œ<strong>éå†å€¼</strong>â€Œï¼šä½¿ç”¨ <code>.values()</code> æ–¹æ³•ï¼Œä¾‹å¦‚ <code>for value in dict.values():</code>ã€‚</li><li>â€Œ<strong>éå†é”®å€¼å¯¹</strong>â€Œï¼šä½¿ç”¨ <code>.items()</code> æ–¹æ³•ï¼Œä¾‹å¦‚ <code>for key, value in dict.items():</code>â€Œ12ã€‚</li></ol><h1 id="æ¨å¯¼å¼"><a href="#æ¨å¯¼å¼" class="headerlink" title="æ¨å¯¼å¼"></a>æ¨å¯¼å¼</h1><p>æ¨å¯¼å¼æ ¼å¼ä¸ºï¼š<strong>è¡¨è¾¾å¼ for  å˜é‡ in  è¾“â¼Šæº if  æ¡ä»¶</strong> </p><p>æ¨å¯¼å¼æ ¼å¼ä¸ºï¼š<strong>è¡¨è¾¾å¼ for  å˜é‡ in  è¾“â¼Šæº if  æ¡ä»¶ for  å˜é‡ in  è¾“â¼Šæº if  æ¡ä»¶</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»™å®šä¸€ä¸ªåˆ—è¡¨,å°†æ¯ä¸€ä½æ•°å­—å˜æˆå®ƒçš„å¹³æ–¹ alist = [1, 2, 3, 4, 5, 6, 7]</span></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœï¼š[1, 4, 9, 16, 25, 36, 49]</span></span><br><span class="line">alist = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="built_in">print</span>([i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> alist])</span><br><span class="line"><span class="built_in">print</span>([i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> alist <span class="keyword">if</span> i+<span class="number">2</span>&gt;<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(&#123;i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> alist&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tuple</span>((i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> alist)))</span><br><span class="line"><span class="built_in">print</span>(&#123;i**<span class="number">2</span>:<span class="string">f&quot;test<span class="subst">&#123;i&#125;</span>&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> alist&#125;)</span><br><span class="line"><span class="comment">#æ¨å¯¼ 30 ä»¥å†…å¯ä»¥è¢« 3 æ•´é™¤çš„æ•´æ•°ä¸ºåˆ—è¡¨ï¼š</span></span><br><span class="line"><span class="built_in">print</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>) <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>])</span><br></pre></td></tr></table></figure><p><strong>æ•°æ®æºä½¿â½¤å­—å…¸</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">d1=&#123;<span class="string">&quot;å¼ ä¸‰&quot;</span>:<span class="number">20</span>,<span class="string">&quot;æå››&quot;</span>:<span class="number">30</span>,<span class="string">&quot;ç‹äº”&quot;</span>:<span class="number">40</span>&#125;</span><br><span class="line"> <span class="comment"># æ¨å¯¼åˆ—è¡¨</span></span><br><span class="line"><span class="built_in">print</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> d1.values()])</span><br><span class="line"> <span class="comment"># æ¨å¯¼å­—å…¸</span></span><br><span class="line"><span class="built_in">print</span>(&#123;i:i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> d1.values() <span class="keyword">if</span> i&gt;<span class="number">20</span>&#125;)</span><br><span class="line"> <span class="comment"># æ¨å¯¼é›†åˆ</span></span><br><span class="line"><span class="built_in">print</span>(&#123;i <span class="keyword">for</span> i <span class="keyword">in</span> d1.values() <span class="keyword">if</span> i&gt;<span class="number">20</span>&#125;)</span><br><span class="line"> <span class="comment"># æ¨å¯¼å…ƒç»„</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tuple</span>((i <span class="keyword">for</span> i <span class="keyword">in</span> d1.values() <span class="keyword">if</span> i&gt;<span class="number">20</span>)))</span><br><span class="line"> <span class="comment"># äºŒé‡å¾ªç¯ æå–æ•°å­—ä¸ºåˆ—è¡¨[45,67,45,34,65,78]</span></span><br><span class="line">l1=[[<span class="number">45</span>,<span class="number">67</span>,<span class="number">45</span>,<span class="string">&quot;hhh&quot;</span>],[<span class="number">34</span>,<span class="number">65</span>,<span class="number">78</span>,<span class="string">&quot;test&quot;</span>]]</span><br><span class="line"><span class="built_in">print</span>([j <span class="keyword">for</span> i <span class="keyword">in</span> l1 <span class="keyword">for</span> j <span class="keyword">in</span> i <span class="keyword">if</span> <span class="built_in">type</span>(j)==<span class="built_in">int</span>])</span><br></pre></td></tr></table></figure><h1 id="list-ã€tupleã€setã€dictçš„åŒºåˆ«"><a href="#list-ã€tupleã€setã€dictçš„åŒºåˆ«" class="headerlink" title="list ã€tupleã€setã€dictçš„åŒºåˆ«"></a><strong>list ã€tupleã€setã€dictçš„åŒºåˆ«</strong></h1><p>åœ¨ Python ä¸­ï¼Œ<code>list</code>ï¼ˆåˆ—è¡¨ï¼‰ã€<code>tuple</code>ï¼ˆå…ƒç»„ï¼‰ã€<code>set</code>ï¼ˆé›†åˆï¼‰å’Œ <code>dict</code>ï¼ˆå­—å…¸ï¼‰æ˜¯å››ç§æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œå®ƒä»¬åœ¨ç‰¹æ€§ã€ç”¨é€”å’Œæ€§èƒ½ä¸Šæœ‰æ˜¾è‘—åŒºåˆ«ï¼š</p><h3 id="ğŸ“‹-1-Listï¼ˆåˆ—è¡¨ï¼‰"><a href="#ğŸ“‹-1-Listï¼ˆåˆ—è¡¨ï¼‰" class="headerlink" title="ğŸ“‹ 1. Listï¼ˆåˆ—è¡¨ï¼‰"></a>ğŸ“‹ 1. <strong>Listï¼ˆåˆ—è¡¨ï¼‰</strong></h3><ul><li><p><strong>ç‰¹æ€§</strong>ï¼šæœ‰åºé›†åˆï¼Œå¯å˜ï¼ˆå¯ä¿®æ”¹ï¼‰</p></li><li><p><strong>è¯­æ³•</strong>ï¼š<code>[å…ƒç´ 1, å…ƒç´ 2, ...]</code></p></li><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ä¿æŒå…ƒç´ æ’å…¥é¡ºåº</li><li>å…è®¸é‡å¤å…ƒç´ </li><li>å…ƒç´ å¯ä»¥æ˜¯ä¸åŒç±»å‹</li><li>é€šè¿‡ç´¢å¼•è®¿é—®ï¼ˆ<code>list[0]</code>ï¼‰</li></ul></li><li><p><strong>æ“ä½œ</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fruits = [<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>]</span><br><span class="line">fruits.append(<span class="string">&quot;orange&quot;</span>)    <span class="comment"># æ·»åŠ å…ƒç´ </span></span><br><span class="line">fruits[<span class="number">1</span>] = <span class="string">&quot;mango&quot;</span>       <span class="comment"># ä¿®æ”¹å…ƒç´ </span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š</p><ul><li>è®¿é—®ï¼šO(1)</li><li>æ’å…¥&#x2F;åˆ é™¤æœ«å°¾ï¼šO(1)</li><li>æ’å…¥&#x2F;åˆ é™¤ä¸­é—´ï¼šO(n)</li></ul></li><li><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šéœ€è¦ä¿æŒé¡ºåºä¸”å¯èƒ½ä¿®æ”¹çš„æ•°æ®é›†åˆ</p></li></ul><h3 id="ğŸ“¦-2-Tupleï¼ˆå…ƒç»„ï¼‰"><a href="#ğŸ“¦-2-Tupleï¼ˆå…ƒç»„ï¼‰" class="headerlink" title="ğŸ“¦ 2. Tupleï¼ˆå…ƒç»„ï¼‰"></a>ğŸ“¦ 2. <strong>Tupleï¼ˆå…ƒç»„ï¼‰</strong></h3><ul><li><p><strong>ç‰¹æ€§</strong>ï¼šæœ‰åºé›†åˆï¼Œ<strong>ä¸å¯å˜</strong>ï¼ˆåˆ›å»ºåä¸èƒ½ä¿®æ”¹ï¼‰</p></li><li><p><strong>è¯­æ³•</strong>ï¼š<code>(å…ƒç´ 1, å…ƒç´ 2, ...)</code> æˆ– å•å…ƒç´  <code>(å…ƒç´ ,)</code></p></li><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ¯”åˆ—è¡¨æ›´èŠ‚çœå†…å­˜</li><li>å¯å“ˆå¸Œï¼ˆå¯ä½œä¸ºå­—å…¸é”®ï¼‰</li><li>ä¿æŒå…ƒç´ æ’å…¥é¡ºåº</li><li>å…è®¸é‡å¤å…ƒç´ </li></ul></li><li><p><strong>æ“ä½œ</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colors = (<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(colors[<span class="number">0</span>])          <span class="comment"># è®¿é—®å…ƒç´ </span></span><br><span class="line"><span class="comment"># colors[1] = &quot;yellow&quot;    # é”™è¯¯ï¼ä¸å¯ä¿®æ”¹</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šè®¿é—® O(1)</p></li><li><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå›ºå®šæ•°æ®é›†åˆï¼ˆå¦‚åæ ‡ç‚¹ã€æ•°æ®åº“è®°å½•ï¼‰ã€å­—å…¸é”®</p></li></ul><h3 id="ğŸ§º-3-Setï¼ˆé›†åˆï¼‰"><a href="#ğŸ§º-3-Setï¼ˆé›†åˆï¼‰" class="headerlink" title="ğŸ§º 3. Setï¼ˆé›†åˆï¼‰"></a>ğŸ§º 3. <strong>Setï¼ˆé›†åˆï¼‰</strong></h3><ul><li><p><strong>ç‰¹æ€§</strong>ï¼šæ— åºé›†åˆï¼Œå¯å˜ï¼Œ<strong>å…ƒç´ å”¯ä¸€</strong></p></li><li><p><strong>è¯­æ³•</strong>ï¼š<code>&#123;å…ƒç´ 1, å…ƒç´ 2, ...&#125;</code> æˆ– <code>set(iterable)</code></p></li><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>è‡ªåŠ¨å»é‡</li><li>ä¸æ”¯æŒç´¢å¼•è®¿é—®</li><li>åªèƒ½åŒ…å«å¯å“ˆå¸Œå¯¹è±¡ï¼ˆä¸å¯å˜ç±»å‹ï¼‰</li><li>æ”¯æŒé›†åˆè¿ç®—ï¼ˆå¹¶é›†ã€äº¤é›†ç­‰ï¼‰</li></ul></li><li><p><strong>æ“ä½œ</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vowels = &#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;u&quot;</span>&#125;</span><br><span class="line">vowels.add(<span class="string">&quot;y&quot;</span>)           <span class="comment"># æ·»åŠ å…ƒç´ </span></span><br><span class="line">vowels.discard(<span class="string">&quot;i&quot;</span>)       <span class="comment"># åˆ é™¤å…ƒç´ </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a&quot;</span> <span class="keyword">in</span> vowels)      <span class="comment"># æˆå‘˜æ£€æµ‹</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š</p><ul><li>æ·»åŠ &#x2F;åˆ é™¤&#x2F;æˆå‘˜æ£€æµ‹ï¼šå¹³å‡ O(1)</li></ul></li><li><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå»é‡ã€æˆå‘˜æ£€æµ‹ã€é›†åˆè¿ç®—</p></li></ul><h3 id="ğŸ“–-4-Dictï¼ˆå­—å…¸ï¼‰"><a href="#ğŸ“–-4-Dictï¼ˆå­—å…¸ï¼‰" class="headerlink" title="ğŸ“– 4. Dictï¼ˆå­—å…¸ï¼‰"></a>ğŸ“– 4. <strong>Dictï¼ˆå­—å…¸ï¼‰</strong></h3><ul><li><p><strong>ç‰¹æ€§</strong>ï¼šé”®å€¼å¯¹é›†åˆï¼Œ<strong>æ— åº</strong>ï¼ˆPython 3.7+ ä¿æŒæ’å…¥é¡ºåºï¼‰ï¼Œå¯å˜</p></li><li><p><strong>è¯­æ³•</strong>ï¼š<code>&#123;é”®1: å€¼1, é”®2: å€¼2, ...&#125;</code></p></li><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>é”®å¿…é¡»æ˜¯å¯å“ˆå¸Œå¯¹è±¡ï¼ˆé€šå¸¸ä¸ºä¸å¯å˜ç±»å‹ï¼‰</li><li>é”®å”¯ä¸€ï¼Œå€¼å¯é‡å¤</li><li>é€šè¿‡é”®å¿«é€Ÿè®¿é—®å€¼</li></ul></li><li><p><strong>æ“ä½œ</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">person = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">30</span>&#125;</span><br><span class="line">person[<span class="string">&quot;email&quot;</span>] = <span class="string">&quot;alice@example.com&quot;</span>  <span class="comment"># æ·»åŠ /ä¿®æ”¹</span></span><br><span class="line"><span class="built_in">print</span>(person.get(<span class="string">&quot;age&quot;</span>))               <span class="comment"># è®¿é—®å€¼</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š</p><ul><li>è®¿é—®&#x2F;æ·»åŠ &#x2F;åˆ é™¤ï¼šå¹³å‡ O(1)</li></ul></li><li><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šé”®å€¼æ˜ å°„ã€å¿«é€ŸæŸ¥æ‰¾ã€JSON æ•°æ®è¡¨ç¤º</p></li></ul><h3 id="ğŸ†š-æ ¸å¿ƒåŒºåˆ«æ€»ç»“"><a href="#ğŸ†š-æ ¸å¿ƒåŒºåˆ«æ€»ç»“" class="headerlink" title="ğŸ†š æ ¸å¿ƒåŒºåˆ«æ€»ç»“"></a>ğŸ†š æ ¸å¿ƒåŒºåˆ«æ€»ç»“</h3><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">List</th><th align="left">Tuple</th><th align="left">Set</th><th align="left">Dict</th></tr></thead><tbody><tr><td align="left"><strong>æœ‰åºæ€§</strong></td><td align="left">âœ”ï¸ ä¿æŒé¡ºåº</td><td align="left">âœ”ï¸ ä¿æŒé¡ºåº</td><td align="left">âŒ æ— åº</td><td align="left">âŒ æ— åºï¼ˆ3.6+ ä¿æŒæ’å…¥é¡ºåºï¼‰</td></tr><tr><td align="left"><strong>å¯å˜æ€§</strong></td><td align="left">âœ”ï¸ å¯å˜</td><td align="left">âŒ ä¸å¯å˜</td><td align="left">âœ”ï¸ å¯å˜</td><td align="left">âœ”ï¸ å¯å˜</td></tr><tr><td align="left"><strong>å…ƒç´ å”¯ä¸€æ€§</strong></td><td align="left">âŒ å…è®¸é‡å¤</td><td align="left">âŒ å…è®¸é‡å¤</td><td align="left">âœ”ï¸ å”¯ä¸€</td><td align="left">é”®å”¯ä¸€ï¼Œå€¼å¯é‡å¤</td></tr><tr><td align="left"><strong>ç´¢å¼•è®¿é—®</strong></td><td align="left">âœ”ï¸ æ”¯æŒ</td><td align="left">âœ”ï¸ æ”¯æŒ</td><td align="left">âŒ ä¸æ”¯æŒ</td><td align="left">é€šè¿‡é”®è®¿é—®</td></tr><tr><td align="left"><strong>å†…å­˜æ•ˆç‡</strong></td><td align="left">ä¸€èˆ¬</td><td align="left">âœ… è¾ƒé«˜</td><td align="left">ä¸­ç­‰</td><td align="left">ä¸­ç­‰</td></tr><tr><td align="left"><strong>å…¸å‹æ“ä½œ</strong></td><td align="left">å¢åˆ æ”¹æŸ¥</td><td align="left">åªè¯»è®¿é—®</td><td align="left">é›†åˆè¿ç®—&#x2F;å»é‡</td><td align="left">é”®å€¼æŸ¥æ‰¾</td></tr><tr><td align="left"><strong>å¯å“ˆå¸Œæ€§</strong></td><td align="left">âŒ ä¸å¯å“ˆå¸Œ</td><td align="left">âœ… å¯å“ˆå¸Œ</td><td align="left">âŒ ä¸å¯å“ˆå¸Œ</td><td align="left">âŒ ä¸å¯å“ˆå¸Œ</td></tr><tr><td align="left"><strong>ç©ºå¯¹è±¡åˆ›å»º</strong></td><td align="left"><code>[]</code></td><td align="left"><code>()</code></td><td align="left"><code>set()</code></td><td align="left"><code>&#123;&#125;</code></td></tr></tbody></table><h3 id="ğŸ’¡-é€‰æ‹©æŒ‡å—"><a href="#ğŸ’¡-é€‰æ‹©æŒ‡å—" class="headerlink" title="ğŸ’¡ é€‰æ‹©æŒ‡å—"></a>ğŸ’¡ é€‰æ‹©æŒ‡å—</h3><ul><li>éœ€è¦<strong>æœ‰åºä¸”å¯ä¿®æ”¹</strong> â†’ ç”¨ <strong>List</strong></li><li>éœ€è¦<strong>æœ‰åºä¸”ä¸å¯å˜</strong> â†’ ç”¨ <strong>Tuple</strong>ï¼ˆæ›´å®‰å…¨ã€æ›´å¿«ï¼‰</li><li>éœ€è¦<strong>å»é‡&#x2F;æˆå‘˜æ£€æµ‹</strong> â†’ ç”¨ <strong>Set</strong></li><li>éœ€è¦<strong>é”®å€¼æ˜ å°„</strong> â†’ ç”¨ <strong>Dict</strong></li></ul><h3 id="âš¡-æ€§èƒ½å¯¹æ¯”ï¼ˆ10ä¸‡å…ƒç´ æ“ä½œï¼‰"><a href="#âš¡-æ€§èƒ½å¯¹æ¯”ï¼ˆ10ä¸‡å…ƒç´ æ“ä½œï¼‰" class="headerlink" title="âš¡ æ€§èƒ½å¯¹æ¯”ï¼ˆ10ä¸‡å…ƒç´ æ“ä½œï¼‰"></a>âš¡ æ€§èƒ½å¯¹æ¯”ï¼ˆ10ä¸‡å…ƒç´ æ“ä½œï¼‰</h3><table><thead><tr><th align="left">æ“ä½œ</th><th align="left">List</th><th align="left">Tuple</th><th align="left">Set</th><th align="left">Dict</th></tr></thead><tbody><tr><td align="left">æŸ¥æ‰¾å…ƒç´ </td><td align="left">O(n)</td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">O(1)</td></tr><tr><td align="left">æ’å…¥å…ƒç´ </td><td align="left">O(1)*</td><td align="left">N&#x2F;A</td><td align="left">O(1)</td><td align="left">O(1)</td></tr><tr><td align="left">å†…å­˜å ç”¨(MB)</td><td align="left">~8.5</td><td align="left">~7.2</td><td align="left">~4.2</td><td align="left">~4.8</td></tr></tbody></table><p><strong>åˆ—è¡¨æ’å…¥æœ«å°¾ä¸º O(1)ï¼Œæ’å…¥ä¸­é—´ä¸º O(n)</strong></p><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><p><strong>å‡½æ•°ä»£ç å—ä»¥ def å…³é”®è¯å¼€å¤´</strong> </p><p><strong>return [ è¡¨è¾¾å¼ ] ç»“æŸå‡½æ•°å¹¶è¿”å›ï¼Œè¿”å›â¼€ä¸ªæˆ–å¤šä¸ªå€¼ç»™è°ƒâ½¤â½…ï¼Œä¸å¸¦è¡¨è¾¾å¼çš„ return  ç›¸ å½“äºè¿”å› None ï¼Œå¤šä¸ªå€¼ä¸ºå…ƒç»„ã€‚</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å£°æ˜</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sayHello</span>():</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;ä½ å¥½&quot;</span>)</span><br><span class="line"> <span class="comment"># è°ƒç”¨</span></span><br><span class="line">sayHello()</span><br></pre></td></tr></table></figure><p><strong>ä¸å®šâ»“å‚æ•°</strong></p><ul><li>åŠ äº†æ˜Ÿå· * çš„å‚æ•°ä¼šä»¥<strong>å…ƒç»„ (tuple) çš„å½¢å¼å¯¼â¼Šï¼Œå­˜æ”¾æ‰€æœ‰æœªå‘½åçš„å˜é‡å‚æ•°ã€‚</strong></li><li>åŠ äº†ä¸¤ä¸ª æ˜Ÿå· ** çš„å‚æ•°ä¼šä»¥<strong>å­—å…¸çš„å½¢å¼å¯¼â¼Š</strong>ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getNumTuple</span>(<span class="params">n1,*n</span>):</span><br><span class="line"> <span class="built_in">print</span>(n1)</span><br><span class="line"> <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">getNumTuple(<span class="number">8</span>,<span class="number">9</span>,<span class="number">90</span>,<span class="number">100</span>,<span class="string">&quot;hello&quot;</span>,<span class="literal">True</span>,<span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getNumDict</span>(<span class="params">n1,**n</span>):</span><br><span class="line"> <span class="built_in">print</span>(n1)</span><br><span class="line"> <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">getNumDict(<span class="number">8</span>,age=<span class="number">40</span>,name=<span class="string">&quot;å‘¨æ°ä¼¦&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="å€¼ä¼ é€’ä¸å¼•â½¤ä¼ é€’"><a href="#å€¼ä¼ é€’ä¸å¼•â½¤ä¼ é€’" class="headerlink" title="å€¼ä¼ é€’ä¸å¼•â½¤ä¼ é€’"></a>å€¼ä¼ é€’ä¸å¼•â½¤ä¼ é€’</h1><ul><li><strong>å€¼ä¼ é€’ï¼šä¼ é€’çš„æ˜¯æ•°å€¼ï¼Œé€‚â½¤äºå®å‚ç±»å‹ä¸ºä¸å¯å˜ç±»å‹ï¼ˆ int,float,bool,str,tuple ï¼‰</strong></li><li><strong>å¼•â½¤ä¼ é€’ï¼šä¼ é€’çš„æ˜¯åœ°å€ï¼Œé€‚â½¤äºå®å‚ç±»å‹ä¸ºå¯å˜ç±»å‹ï¼ˆ list,set,dict,class ï¼‰</strong></li><li><strong>å‡½æ•°ä¼ å‚ï¼Œèƒ½ä¸ä¼ å°±ä¸ä¼ ï¼Œå®åœ¨ä¸è¡Œåœ¨ä¼ å‚ã€‚</strong></li></ul><h1 id="main-å‡½æ•°â€“-ç¨‹åºçš„â¼Šâ¼"><a href="#main-å‡½æ•°â€“-ç¨‹åºçš„â¼Šâ¼" class="headerlink" title="main å‡½æ•°â€“ ç¨‹åºçš„â¼Šâ¼"></a>main å‡½æ•°â€“ ç¨‹åºçš„â¼Šâ¼</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>: </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;test&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="File-â½‚ä»¶-è¯»å†™"><a href="#File-â½‚ä»¶-è¯»å†™" class="headerlink" title="File( â½‚ä»¶ )  è¯»å†™"></a>File( â½‚ä»¶ )  è¯»å†™</h1><p>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒä¼šå¸®å¿™åˆ›å»ºä¸€ä¸ªã€‚</p><p>modeå‚æ•°ï¼š</p><ul><li><strong>wï¼šè¦†ç›–å†™</strong></li><li><strong>a(append)ï¼šè¿½åŠ </strong></li></ul><table><thead><tr><th align="left">æ¨¡å¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">t</td><td align="left">æ–‡æœ¬æ¨¡å¼ (é»˜è®¤)ã€‚</td></tr><tr><td align="left">x</td><td align="left">å†™æ¨¡å¼ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™ä¼šæŠ¥é”™ã€‚</td></tr><tr><td align="left">b</td><td align="left">äºŒè¿›åˆ¶æ¨¡å¼ã€‚</td></tr><tr><td align="left">+</td><td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ›´æ–°(å¯è¯»å¯å†™)ã€‚</td></tr><tr><td align="left">U</td><td align="left">é€šç”¨æ¢è¡Œæ¨¡å¼ï¼ˆ<strong>Python 3 ä¸æ”¯æŒ</strong>ï¼‰ã€‚</td></tr><tr><td align="left">r</td><td align="left">ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶çš„æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚</td></tr><tr><td align="left">rb</td><td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºåªè¯»ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td></tr><tr><td align="left">r+</td><td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚</td></tr><tr><td align="left">rb+</td><td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td></tr><tr><td align="left">w</td><td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚</td></tr><tr><td align="left">wb</td><td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td></tr><tr><td align="left">w+</td><td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚</td></tr><tr><td align="left">wb+</td><td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td></tr><tr><td align="left">a</td><td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚</td></tr><tr><td align="left">ab</td><td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚</td></tr><tr><td align="left">a+</td><td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚æ–‡ä»¶æ‰“å¼€æ—¶ä¼šæ˜¯è¿½åŠ æ¨¡å¼ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ç”¨äºè¯»å†™ã€‚</td></tr><tr><td align="left">ab+</td><td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ç”¨äºè¯»å†™ã€‚</td></tr></tbody></table><p>é»˜è®¤ä¸ºæ–‡æœ¬æ¨¡å¼ï¼Œå¦‚æœè¦ä»¥<strong>äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€ï¼ŒåŠ ä¸Š b</strong> ã€‚</p><ol><li><p><strong>â½‚æœ¬â½‚ä»¶å†™</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\wtest.txt&quot;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span>  f :</span><br><span class="line"> f.write(<span class="string">&quot;ccccccccccccccc\n&quot;</span>)</span><br><span class="line"> f.write(<span class="string">&quot;ccccccccccccccc\n&quot;</span>)</span><br><span class="line"> f.close()</span><br></pre></td></tr></table></figure></li><li><p><strong>â½‚æœ¬â½‚ä»¶è¯»</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/root/python/test.txt&quot;</span>,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"> result = f.read()</span><br><span class="line"> <span class="comment"># resutl = f.readlines()</span></span><br><span class="line"> <span class="built_in">print</span>(resutl)</span><br><span class="line"> f.close()</span><br></pre></td></tr></table></figure><ol><li><strong>â€œç›¸å¯¹è·¯å¾„ä¸èµ·ä½œç”¨â€çš„çœŸç›¸</strong>ï¼š<ul><li>é—®é¢˜ä¸åœ¨ <code>open()</code>ï¼Œè€Œåœ¨äº<strong>å½“å‰å·¥ä½œç›®å½•(CWD)</strong> ä¸ä½ çš„é¢„æœŸä¸åŒ</li><li>CWD æ˜¯è¿è¡Œè„šæœ¬æ—¶çš„ç»ˆç«¯è·¯å¾„ï¼Œä¸æ˜¯è„šæœ¬æ‰€åœ¨è·¯å¾„</li></ul></li></ol></li></ol><h1 id="Python-åº“-æ ‡å‡†åº“-æ‰©å±•åº“-â¾ƒå®šä¹‰åº“"><a href="#Python-åº“-æ ‡å‡†åº“-æ‰©å±•åº“-â¾ƒå®šä¹‰åº“" class="headerlink" title="Python åº“ :  æ ‡å‡†åº“  æ‰©å±•åº“  â¾ƒå®šä¹‰åº“"></a>Python åº“ :  æ ‡å‡†åº“  æ‰©å±•åº“  â¾ƒå®šä¹‰åº“</h1><p>åœ¨ python  â½¤ import æˆ–è€… from â€¦ import æ¥å¯¼â¼Šç›¸åº”çš„åº“ã€‚</p><ul><li><strong>fieldnamesåœ¨å†™çš„æ—¶å€™è¦æå‰å‡†å¤‡å¥½fieldnamesåˆ—è¡¨ï¼Œè¯»çš„æ—¶å€™ä¸ç”¨å‡†å¤‡ã€‚</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"> <span class="comment">#å†™csvæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/root/python/user.csv&quot;</span>,mode=<span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"> result=csv.DictWriter(f,fieldnames=[<span class="string">&quot;id&quot;</span>,<span class="string">&quot;passwd&quot;</span>,<span class="string">&quot;bat&quot;</span>]) <span class="comment">#fieldnamesåœ¨å†™çš„æ—¶å€™è¦æå‰å‡†å¤‡å¥½fieldnamesåˆ—è¡¨ï¼Œè¯»çš„æ—¶å€™ä¸ç”¨å‡†å¤‡ã€‚</span></span><br><span class="line"> result.writeheader()</span><br><span class="line"> result.writerows(data)</span><br><span class="line"> f.close()</span><br><span class="line"> <span class="comment">#è¯»csvæ–‡ä»¶</span></span><br><span class="line">result = csv.DictReader(f)</span><br></pre></td></tr></table></figure><h1 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h1><ol><li><p><strong>ä¸€èˆ¬æ˜¯æ•´ä¸ªé¡¹ç›®å¼€å‘å®Œï¼ŒåŸºç¡€åŠŸèƒ½å¼€å‘å®Œï¼Œæ‰å¼€å§‹åšå¼‚å¸¸ã€‚ä¸è®©æ•´ä¸ªç¨‹åºå´©æºƒã€‚</strong></p></li><li><p><strong>è¿™ç§å¼‚å¸¸ä¸€èˆ¬æ˜¯ç»™ç”¨æˆ·æç¤ºç”¨çš„ã€‚</strong></p></li></ol><p> ç¨‹åºå´©æºƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line"> x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—: &quot;</span>))</span><br><span class="line"> z=<span class="number">100</span>/x</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æ‚¨è¾“å…¥çš„ä¸æ˜¯æ•°å­—,è¯·å†æ¬¡å°è¯•è¾“å…¥ï¼&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;é™¤æ•°ä¸èƒ½ä¸ºé›¶&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æœªçŸ¥é”™è¯¯&quot;</span>)</span><br><span class="line"> <span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure><p><strong>â¾ƒå®šä¹‰å¼‚å¸¸</strong> </p><p>ä½¿â½¤ raise  è¯­å¥æŠ›å‡ºâ¼€ä¸ªæŒ‡å®šçš„å¼‚å¸¸ raise Exception(â€œ ä¸èƒ½æ˜¯è´Ÿæ•° â€œ)</p><p>è®©ç¨‹åºå´©æºƒï¼Œå‘ç”Ÿå¼‚å¸¸</p><h1 id="â¾¯å‘å¯¹è±¡-OOP-å°è£…ã€ç»§æ‰¿ã€å¤šæ€"><a href="#â¾¯å‘å¯¹è±¡-OOP-å°è£…ã€ç»§æ‰¿ã€å¤šæ€" class="headerlink" title="â¾¯å‘å¯¹è±¡ OOP å°è£…ã€ç»§æ‰¿ã€å¤šæ€"></a>â¾¯å‘å¯¹è±¡ OOP å°è£…ã€ç»§æ‰¿ã€å¤šæ€</h1><p>ç±»æ˜¯æŠ½è±¡çš„ï¼Œå¯¹è±¡æ˜¯å…·ä½“çš„ï¼Œå…ˆæœ‰ç±»æ‰æœ‰å¯¹è±¡ </p><h2 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a><strong>å°è£…</strong></h2><p>ç±»åŠå¯¹è±¡åŒ…å«å±æ€§å’Œâ½…æ³• </p><ul><li><p>å±æ€§ï¼šé™æ€ç‰¹å¾  å…¨å±€å˜é‡  æˆå‘˜ </p><p>ç»™ç±»å®šä¹‰ç§æœ‰å±æ€§å¯ä»¥é€šè¿‡åœ¨å±æ€§åå‰åŠ ä¸Š<strong>åŒä¸‹åˆ’çº¿<code>__</code>æ¥å®šä¹‰ä¸€ä¸ªç§æœ‰å±æ€§</strong>ã€‚è¿™æ ·åšå¯ä»¥é˜²æ­¢è¿™ä¸ªå±æ€§è¢«å¤–éƒ¨ä»£ç ç›´æ¥è®¿é—®å’Œä¿®æ”¹ï¼Œä»è€Œä¿æŠ¤ç±»çš„å†…éƒ¨çŠ¶æ€ã€‚ç§æœ‰å±æ€§åœ¨ç±»çš„å¤–éƒ¨æ˜¯ä¸å¯è§çš„ï¼Œä½†ä»ç„¶å¯ä»¥åœ¨ç±»çš„å†…éƒ¨æ–¹æ³•ä¸­ä½¿ç”¨ã€‚</p></li><li><p>â½…æ³•ï¼šåŠ¨æ€ç‰¹å¾  å‡½æ•°  åŠŸèƒ½ </p></li><li><p>é­”æ³•â½…æ³•ï¼šä¸éœ€è¦è°ƒâ½¤å°±å¯ä»¥â¾ƒåŠ¨æ‰§â¾ã€‚</p></li><li><p>ä½œâ½¤ï¼š<strong>åˆå§‹åŒ–å¯¹è±¡çš„æˆå‘˜ ( ç»™å¯¹è±¡æ·»åŠ å±æ€§ )</strong></p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#ç±»å®šä¹‰</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line"> name=<span class="string">&quot;&quot;</span></span><br><span class="line"> age=<span class="number">0</span></span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,xingming,nianling</span>):</span><br><span class="line"> <span class="variable language_">self</span>.name=xingming</span><br><span class="line"> <span class="variable language_">self</span>.age=nianling</span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">self</span>):</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">f&quot;å§“åæ˜¯<span class="subst">&#123;self.name&#125;</span>,å¹´é¾„æ˜¯<span class="subst">&#123;self.age&#125;</span>&quot;</span>)</span><br><span class="line"> <span class="comment">#è°ƒç”¨</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"> ldh=People(<span class="string">&quot;åˆ˜å¾·å&quot;</span>,<span class="number">50</span>)</span><br><span class="line"> ldh.show()</span><br></pre></td></tr></table></figure><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p><strong>class  â¼¦ç±»å ( â½—ç±»å ):</strong> </p><p>â¼¦ç±»ç›´æ¥å…·å¤‡â½—ç±»çš„å±æ€§å’Œâ½…æ³• </p><p>è§£å†³ä»£ç é‡â½¤é—®é¢˜ï¼Œæâ¾¼å¼€å‘æ•ˆç‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">People</span>):</span><br><span class="line"> grade=<span class="string">&quot;&quot;</span></span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, xingming, nianling,nianji</span>):</span><br><span class="line"> <span class="built_in">super</span>().__init__(xingming,nianling)</span><br><span class="line"> <span class="variable language_">self</span>.grade=nianji</span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">self</span>):</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">f&quot;å¹´çº§æ˜¯<span class="subst">&#123;self.grade&#125;</span>&quot;</span>)</span><br><span class="line"> <span class="comment"># æ–¹æ³•é‡å†™</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">self</span>):</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">f&quot;å§“åæ˜¯<span class="subst">&#123;self.name&#125;</span>,å¹´é¾„æ˜¯<span class="subst">&#123;self.age&#125;</span>,å¹´çº§æ˜¯<span class="subst">&#123;self.grade&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h2><p>å¤šæ€ä»å­—â¾¯ä¸Šç†è§£å°±æ˜¯â¼€ä¸ªäº‹ç‰©å¯ä»¥å‘ˆç°å¤šç§çŠ¶æ€ã€‚ </p><p><strong>æ²¡æœ‰ç»§æ‰¿å°±æ²¡æœ‰å¤šæ€ã€‚</strong> </p><p><strong>å¤šæ€æ˜¯èƒ½â¾ƒâ¼°è¿›â¾åˆ¤æ–­è¯¥å»æ‰§â¾ä»€ä¹ˆ , åˆ›å»ºâ¼€ä¸ªåˆ—è¡¨æ¥ä½“ç° , â¾¯å‘å¯¹è±¡çš„åˆ—è¡¨ã€‚</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">l1=[ldh,zjl]</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> l1:</span><br><span class="line"> <span class="comment"># å¤šæ€</span></span><br><span class="line"><span class="built_in">print</span>(i.name)</span><br><span class="line"> i.show()</span><br></pre></td></tr></table></figure><h2 id="ç±»çš„ä¸“æœ‰æ–¹æ³•"><a href="#ç±»çš„ä¸“æœ‰æ–¹æ³•" class="headerlink" title="ç±»çš„ä¸“æœ‰æ–¹æ³•"></a>ç±»çš„ä¸“æœ‰æ–¹æ³•</h2><ul><li><strong><strong>init</strong> :</strong> æ„é€ å‡½æ•°ï¼Œåœ¨ç”Ÿæˆå¯¹è±¡æ—¶è°ƒç”¨</li><li><strong><strong>del</strong> :</strong> ææ„å‡½æ•°ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä½¿ç”¨</li><li><strong><strong>repr</strong> :</strong> æ‰“å°ï¼Œè½¬æ¢</li><li><strong><strong>setitem</strong> :</strong> æŒ‰ç…§ç´¢å¼•èµ‹å€¼</li><li><strong><strong>getitem</strong>:</strong> æŒ‰ç…§ç´¢å¼•è·å–å€¼</li><li><strong><strong>len</strong>:</strong> è·å¾—é•¿åº¦</li><li><strong><strong>cmp</strong>:</strong> æ¯”è¾ƒè¿ç®—</li><li><strong><strong>call</strong>:</strong> å‡½æ•°è°ƒç”¨</li><li><strong><strong>add</strong>:</strong> åŠ è¿ç®—</li><li><strong><strong>sub</strong>:</strong> å‡è¿ç®—</li><li><strong><strong>mul</strong>:</strong> ä¹˜è¿ç®—</li><li><strong><strong>truediv</strong>:</strong> é™¤è¿ç®—</li><li><strong><strong>mod</strong>:</strong> æ±‚ä½™è¿ç®—</li><li><strong><strong>pow</strong>:</strong> ä¹˜æ–¹</li></ul><p>ä½œä¸šï¼š</p><ol><li>å®šä¹‰â¼€ä¸ªâ½”æœç±»ï¼Œå®šä¹‰å±æ€§ï¼ˆåç§°å’Œé¢œâ¾Šï¼‰ï¼Œä½¿â½¤é­”æ³•â½…æ³•ï¼Œç„¶åé€šè¿‡â½”æœç±»ï¼Œåˆ›å»º è‹¹æœå¯¹è±¡ã€æ©˜â¼¦å¯¹è±¡ã€è¥¿â½ å¯¹è±¡å¹¶åˆ†åˆ«æ·»åŠ ä¸Šé¢œâ¾Šå±æ€§ï¼Œå®šä¹‰â¼€ä¸ªâ½…æ³•åˆ†åˆ«è¾“å‡º å¦‚ï¼š</li></ol><p>â€‹çº¢â¾Šçš„è‹¹æœçœŸå¥½åƒ </p><p>â€‹æ©™â¾Šçš„æ©˜â¼¦çœŸå¥½åƒ </p><p>â€‹ç»¿â¾Šçš„è¥¿â½ çœŸå¥½åƒ</p><ol start="2"><li><p>çŒ«ç±» Cat ã€‚å±æ€§ : â½‘çš„é¢œâ¾Š color ï¼Œå“ç§ breed ï¼Œäº²å’Œåº¦ love ã€‚â½…æ³• : åƒé¥­ eat() </p><p>ç‹—ç±» Dog ã€‚å±æ€§ : â½‘çš„é¢œâ¾Š color ï¼Œå“ç§ breed ï¼Œå¿ è¯šåº¦ loyal ã€‚â½…æ³• : åƒé¥­ eat() </p><p>è¦æ±‚ :  ä½¿â½¤å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ </p><p>æ ¹æ®ä»¥ä¸Šè¦æ±‚æŠ½å–â½—ç±»ä¸º Animal </p><p>é‡å†™ eat â½…æ³• </p><p>è¾“å‡ºæ‰“å°å¦‚ä¸‹ï¼š </p><p>æœ‰â¼€åªäº²å’Œåº¦æ˜¯ 10 çº§çš„èŠ±â¾Šçš„æ³¢æ–¯çŒ«æ­£åœ¨åƒâ»¥ â€¦.. </p><p>æœ‰â¼€åªå¿ è¯šåº¦æ˜¯ 9 çº§çš„â¿Šâ¾Šçš„è—ç’æ­£åœ¨å•ƒâ»£å¤´ â€¦.. </p><p>æœ‰â¼€åªäº²å’Œåº¦æ˜¯ 8 çº§çš„â½©â¾Šçš„åŠ è²çŒ«æ­£åœ¨åƒâ»¥ â€¦.. </p><p>æœ‰â¼€åªå¿ è¯šåº¦æ˜¯ 6 çº§çš„æ£•â¾Šçš„èŒ¶æ¯â½æ­£åœ¨å•ƒâ»£å¤´ â€¦..</p></li></ol><h1 id="time-datetime-åº“"><a href="#time-datetime-åº“" class="headerlink" title="time&amp;datetime åº“"></a>time&amp;datetime åº“</h1><p>Python ä¸­å¤„ç†æ—¶é—´çš„æ ‡å‡†åº“ </p><ol><li>æä¾›è·å–ç³»ç»Ÿæ—¶é—´å¹¶æ ¼å¼åŒ–è¾“å‡ºåŠŸèƒ½ </li><li>æä¾›ç³»ç»Ÿçº§ç²¾ç¡®è®¡æ—¶åŠŸèƒ½ï¼Œâ½¤äºç¨‹åºæ€§èƒ½åˆ†æ</li></ol><h1 id="time-åº“"><a href="#time-åº“" class="headerlink" title="time åº“"></a>time åº“</h1><p>åŒ…å«ä¸‰ç±»å‡½æ•° </p><ol><li>æ—¶é—´è·å–ï¼š <strong>localtime()</strong> </li><li>æ—¶é—´æ ¼å¼åŒ–ï¼š <strong>strftime()  strptime()</strong>    string   format time æ ¼å¼åŒ–å­—ç¬¦ä¸²   string parse time è§£æå­—ç¬¦ä¸²</li><li>ç¨‹åºè®¡æ—¶ï¼š <strong>sleep()  perf_counter(</strong>)</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> <span class="comment"># æ—¥æœŸç±»å‹ä¸å­—ç¬¦ä¸²ç›´æ¥äº’ç›¸è½¬åŒ–</span></span><br><span class="line">t1= time.localtime()</span><br><span class="line"> <span class="built_in">print</span>(time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,t1))</span><br><span class="line"> timeStr = <span class="string">&#x27;2018-01-26 12:55:20&#x27;</span></span><br><span class="line"> t2=time.strptime(timeStr, <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"> <span class="comment">#æµ‹è¯•ç¨‹åºæ‰§è¡Œæ—¶é—´å·®</span></span><br><span class="line">t_start = time.perf_counter()</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æµ‹è¯•&quot;</span>)</span><br><span class="line"> <span class="comment">#å¼€å§‹ä¼‘çœ </span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;ä¼‘çœ å®Œæ¯•&quot;</span>)</span><br><span class="line"> t_end =  time.perf_counter()</span><br><span class="line"> <span class="built_in">print</span>( t_end-t_start )</span><br><span class="line"> <span class="keyword">import</span> datetime</span><br><span class="line"> t = datetime.datetime.now()</span><br><span class="line"> <span class="built_in">print</span>(datetime.datetime.strftime(t,<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>))</span><br><span class="line"> <span class="built_in">print</span>(datetime.datetime.strptime(<span class="string">&quot;20230211&quot;</span>,<span class="string">&quot;%Y%m%d&quot;</span>))</span><br></pre></td></tr></table></figure><h1 id="è¿æ¥-MySQL-æ“ä½œ"><a href="#è¿æ¥-MySQL-æ“ä½œ" class="headerlink" title="è¿æ¥ MySQL æ“ä½œ"></a>è¿æ¥ MySQL æ“ä½œ</h1><p>pymysql  æ˜¯åœ¨ Python3.x  ç‰ˆæœ¬ä¸­â½¤äºè¿æ¥ MySQL  æœåŠ¡å™¨çš„â¼€ä¸ªåº“ åœ¨ vscode ç»ˆç«¯ä¸‹â¾¯ç›´æ¥è¿â¾ pip3 install pymysql å®‰è£…å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  pymysql</span><br><span class="line"> <span class="comment"># è¿æ¥database</span></span><br><span class="line"> conn = pymysql.connect(</span><br><span class="line"> host=<span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line"> user=<span class="string">&quot;root&quot;</span>,password=<span class="string">&quot;root123456&quot;</span>,</span><br><span class="line"> database=<span class="string">&quot;test&quot;</span>,</span><br><span class="line"> charset=<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æ‰“å¼€æ•°æ®åº“&quot;</span>)</span><br><span class="line"> <span class="comment">#å…³é—­æ•°æ®åº“</span></span><br><span class="line">conn.close()</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;å…³é—­æ•°æ®åº“&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="ç»“æ„æ“ä½œ"><a href="#ç»“æ„æ“ä½œ" class="headerlink" title="ç»“æ„æ“ä½œ"></a>ç»“æ„æ“ä½œ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨é¢„å¤„ç†è¯­å¥åˆ›å»ºè¡¨</span></span><br><span class="line">sql1 = <span class="string">&quot;&quot;&quot;create table if not exists MovieType(</span></span><br><span class="line"><span class="string"> tid int primary key,</span></span><br><span class="line"><span class="string"> tname varchar(20),</span></span><br><span class="line"><span class="string"> tcontent varchar(500),</span></span><br><span class="line"><span class="string"> tdate datetime</span></span><br><span class="line"><span class="string"> )&quot;&quot;&quot;</span></span><br><span class="line"> baoma.execute(sql1)</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®å¢åˆ æ”¹æ“ä½œ"><a href="#æ•°æ®å¢åˆ æ”¹æ“ä½œ" class="headerlink" title="æ•°æ®å¢åˆ æ”¹æ“ä½œ"></a>æ•°æ®å¢åˆ æ”¹æ“ä½œ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">&quot;insert into MovieType values(1,&#x27;å–œå‰§&#x27;,&#x27;è¿™æ˜¯ä¸€ç§æç¬‘çš„è§†é¢‘&#x27;,now())&quot;</span></span><br><span class="line"> result=baoma.execute(c)</span><br><span class="line"> conn.commit() <span class="comment">#éœ€è¦æäº¤æ‰åˆ°æ•°æ®åº“ï¼Œæœ‰é”™åˆ™rollback</span></span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;æ’å…¥æˆåŠŸ&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®æŸ¥è¯¢æ“ä½œ"><a href="#æ•°æ®æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æ•°æ®æŸ¥è¯¢æ“ä½œ"></a>æ•°æ®æŸ¥è¯¢æ“ä½œ</h2><p>baoma.fetchone(): æ‰§â¾å®Œæ¯•è¿”å›çš„ç»“æœé›†é»˜è®¤ä»¥å…ƒç»„æ˜¾â½° </p><p>baoma.fetchall(): å…ƒç»„çš„å…ƒç»„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  pymysql</span><br><span class="line"> sql = <span class="string">&quot;select * from MovieType order by tdate desc&quot;</span></span><br><span class="line"> baoma.execute(sql)</span><br><span class="line"> <span class="comment"># data = baoma.fetchone()#è¯»ä¸€è¡Œ</span></span><br><span class="line"><span class="comment"># print(data)</span></span><br><span class="line"> data = baoma.fetchall()<span class="comment">#è¯»æ‰€æœ‰</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"> <span class="keyword">for</span>  i <span class="keyword">in</span>  data:</span><br><span class="line"> <span class="built_in">print</span>(i[<span class="number">0</span>],i[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>ä¸Šæœºç»ƒä¹  9 </p><ol><li><p>çµæ´»ä½¿â½¤ pymyql æ¥å®Œæˆåˆ›å»ºè¡¨ã€æ·»åŠ æ•°æ®ã€æŸ¥è¯¢æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table <span class="keyword">if</span> <span class="keyword">not</span> exists MovieType(</span><br><span class="line"> tid <span class="built_in">int</span> primary key,</span><br><span class="line"> tname varchar(<span class="number">20</span>),</span><br><span class="line"> tcontent varchar(<span class="number">200</span>),</span><br><span class="line"> tdate datetime</span><br><span class="line"> )</span><br><span class="line"> insert into MovieType values(<span class="number">1</span>,<span class="string">&#x27;å–œå‰§&#x27;</span>,<span class="string">&#x27;è¿™æ˜¯ä¸€ä¸ªæç¬‘çš„ç”µå½±&#x27;</span>,now())</span><br><span class="line"> insert into MovieType values(<span class="number">2</span>,<span class="string">&#x27;åŠ¨ä½œ&#x27;</span>,<span class="string">&#x27;è¿™æ˜¯ä¸€ä¸ªæ‰“æ–—çš„ç”µå½±&#x27;</span>,now())</span><br><span class="line"> select * <span class="keyword">from</span> MovieType</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢æ•°æ®æ—¶â½‡æœŸå¤„ç†æˆå¦‚ä¸‹æ ¼å¼ï¼š</p><p>1  å–œå‰§  è¿™æ˜¯â¼€ä¸ªæç¬‘çš„ç”µå½± 2023 å¹´ 08 â½‰ 21 â½‡ </p><p>2  åŠ¨ä½œ  è¿™æ˜¯â¼€ä¸ªæ‰“â½ƒçš„ç”µå½± 2023 å¹´ 08 â½‰ 21 â½‡</p></li></ol><h1 id="ä¸‰å±‚æ¶æ„â€“é¢å‘å¯¹è±¡æ€æƒ³"><a href="#ä¸‰å±‚æ¶æ„â€“é¢å‘å¯¹è±¡æ€æƒ³" class="headerlink" title="ä¸‰å±‚æ¶æ„â€“é¢å‘å¯¹è±¡æ€æƒ³"></a>ä¸‰å±‚æ¶æ„â€“é¢å‘å¯¹è±¡æ€æƒ³</h1><p><img src="/2025/05/28/Python/image-20250613000538572.png" alt="image-20250613000538572"></p><h1 id="osåº“"><a href="#osåº“" class="headerlink" title="osåº“"></a>osåº“</h1><p><strong>os ï¼ˆ operating system ï¼‰æ˜¯ Python ç¨‹åºä¸æ“ä½œç³»ç»Ÿè¿›â¾äº¤äº’çš„æ¥â¼</strong> </p><p><strong>1 ã€ os.listdir ï¼ˆï¼‰è¿”å›å¯¹åº”â½¬å½•ä¸‹çš„æ‰€æœ‰â½‚ä»¶åŠâ½‚ä»¶å¤¹</strong> </p><p><strong>2 ã€ os.mkdir ï¼ˆï¼‰åˆ›å»ºâ½¬å½•ï¼ˆåªâ½€æŒâ¼€å±‚åˆ›å»ºï¼‰å³æ–°å»ºâ¼€ä¸ªè·¯å¾„</strong> </p><p><strong>3 ã€ os.open ï¼ˆï¼‰åˆ›å»ºâ½‚ä»¶ç›¸å½“äºå…¨å±€å‡½æ•° open() ï¼ˆ IO æµï¼‰ os.open(â€œt.txtâ€,os.O_CREAT)</strong> </p><p><strong>4 ã€ os.remove ï¼ˆâ½‚ä»¶åæˆ–è·¯å¾„ï¼‰åˆ é™¤â½‚ä»¶</strong> </p><p><strong>5 ã€ os.rmdir ï¼ˆï¼‰åˆ é™¤â½¬å½•</strong> </p><p><strong>6 ã€ os.system ï¼ˆï¼‰æ‰§â¾ç»ˆç«¯å‘½ä»¤ os.system(â€œtouch a.txtâ€)</strong></p><h1 id="pandasåº“"><a href="#pandasåº“" class="headerlink" title="pandasåº“"></a>pandasåº“</h1><p>Pandas  æ˜¯ Python  è¯­â¾”çš„â¼€ä¸ªæ‰©å±•ç¨‹åºåº“ï¼Œâ½¤äºæ•°æ®åˆ†æã€‚</p><p>Pandas  åå­—è¡â½£â¾ƒæœ¯è¯­ â€œpanel dataâ€ ï¼ˆâ¾¯æ¿æ•°æ®ï¼‰ </p><p>Pandas  å¯ä»¥ä»å„ç§â½‚ä»¶æ ¼å¼â½å¦‚ CSV ã€ JSON ã€ Excel</p><h2 id="Pandas-æ•°æ®ç»“æ„-DataFrame"><a href="#Pandas-æ•°æ®ç»“æ„-DataFrame" class="headerlink" title="Pandas  æ•°æ®ç»“æ„ - DataFrame"></a>Pandas  æ•°æ®ç»“æ„ - DataFrame</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;Site&quot;</span>:[<span class="string">&quot;Google&quot;</span>, <span class="string">&quot;Runoob&quot;</span>, <span class="string">&quot;Wiki&quot;</span>], <span class="string">&quot;Age&quot;</span>:[<span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>],<span class="string">&quot;sss&quot;</span>:[<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="number">1</span>]) <span class="comment">#ä¸€è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[[<span class="number">0</span>,<span class="number">1</span>]]) <span class="comment"># å¤šè¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&quot;Age&quot;</span>]) <span class="comment"># ä¸€åˆ—</span></span><br><span class="line"><span class="built_in">print</span>(df[[<span class="string">&quot;Age&quot;</span>,<span class="string">&quot;Site&quot;</span>]]) <span class="comment"># å¤šåˆ—</span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&quot;Age&quot;</span>][<span class="number">1</span>]) <span class="comment"># ä¸€ä¸ªå€¼</span></span><br><span class="line"><span class="built_in">print</span>(df[(df.Age&gt;<span class="number">11</span>) &amp; (df.sss&gt;<span class="number">35</span>)])<span class="comment"># å¸¦æ¡ä»¶ç­›é€‰</span></span><br><span class="line"><span class="built_in">print</span>(df[(df.Age&gt;<span class="number">11</span>) &amp; (df.sss&gt;<span class="number">35</span>)][<span class="string">&quot;Age&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(df[(df.Age.astype(<span class="built_in">int</span>)&gt;<span class="number">11</span>) &amp; (df.sss&gt;<span class="number">35</span>)])<span class="comment">#å¦‚æœéœ€è¦è½¬æ¢æ•°æ®ç±»å‹å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">#ä¿®æ”¹å€¼-æŸ¥å‡ºæ¥åï¼Œå³ä¾§ç»™å·¦ä¾§èµ‹å€¼å³å¯ï¼Œä¸å­˜åœ¨çš„åˆ—å³ä¸ºæ·»åŠ </span></span><br><span class="line">df[<span class="string">&quot;Age&quot;</span>]=<span class="number">100</span></span><br><span class="line">df[<span class="string">&quot;Age&quot;</span>][<span class="number">1</span>]=<span class="number">99</span></span><br><span class="line"> <span class="comment">#æ·»åŠ åˆ—</span></span><br><span class="line">df[<span class="string">&quot;tid&quot;</span>]=<span class="number">2</span></span><br><span class="line">df[<span class="string">&quot;Score&quot;</span>]=[<span class="number">90</span>,<span class="number">40</span>,<span class="number">99</span>]</span><br><span class="line">df.insert(<span class="number">1</span>,<span class="string">&quot;Sex&quot;</span>,[<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ç”·&quot;</span>])</span><br><span class="line"> <span class="comment"># 1ä»£è¡¨åˆ— 0ä»£è¡¨è¡Œ</span></span><br><span class="line">df.drop(<span class="number">1</span>,axis=<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">df.drop([<span class="number">0</span>,<span class="number">1</span>],axis=<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">df.drop(<span class="string">&quot;Age&quot;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">df.drop(df[df.Age&gt;<span class="number">10</span>].index,axis=<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2 id="Pandas-CSV-â½‚ä»¶"><a href="#Pandas-CSV-â½‚ä»¶" class="headerlink" title="Pandas CSV  â½‚ä»¶"></a>Pandas CSV  â½‚ä»¶</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&quot;/root/shell/douban.csv&quot;</span>)</span><br><span class="line">df = df[[<span class="string">&quot;id&quot;</span>,<span class="string">&quot;title&quot;</span>,<span class="string">&quot;rate&quot;</span>]]</span><br><span class="line">df.to_csv(<span class="string">&quot;/root/python/db.csv&quot;</span>,index=<span class="literal">False</span>)</span><br><span class="line">df.to_csv(<span class="string">&quot;/root/python/db.csv&quot;</span>,mode=<span class="string">&quot;a&quot;</span>, header=<span class="literal">False</span>, index=<span class="literal">False</span>)<span class="comment">#è¿½åŠ </span></span><br></pre></td></tr></table></figure><h2 id="Pandas-JSON"><a href="#Pandas-JSON" class="headerlink" title="Pandas JSON"></a>Pandas JSON</h2><p> <strong>json.loads() å‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå­—å…¸</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">d2 = [</span><br><span class="line"> &#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;Year 1&quot;</span>, <span class="string">&quot;student number&quot;</span>: <span class="number">20</span>, <span class="string">&quot;room&quot;</span>: <span class="string">&quot;Yellow&quot;</span>&#125;,</span><br><span class="line"> &#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;Year 2&quot;</span>, <span class="string">&quot;student number&quot;</span>: <span class="number">25</span>, <span class="string">&quot;room&quot;</span>: <span class="string">&quot;Blue&quot;</span>&#125;</span><br><span class="line"> ]</span><br><span class="line">df = pd.DataFrame(d2)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><h2 id="Pandas-excel-â½‚ä»¶"><a href="#Pandas-excel-â½‚ä»¶" class="headerlink" title="Pandas excel â½‚ä»¶"></a>Pandas excel â½‚ä»¶</h2><ul><li>sheet_name æŒ‡å®šäº†è¯»å– excel â¾¥â¾¯çš„å“ªâ¼€ä¸ª sheet </li><li>usecols æŒ‡å®šäº†è¯»å–å“ªäº›åˆ— nrows æŒ‡å®šäº†æ€»å…±è¯»å–å¤šå°‘â¾ </li><li>header æŒ‡å®šäº†åˆ—ååœ¨ç¬¬â¼â¾ï¼Œå¹¶ä¸”åªè¯»å–è¿™â¼€â¾å¾€ä¸‹çš„æ•°æ® </li><li>index_col æŒ‡å®šäº† index åœ¨ç¬¬â¼åˆ— </li><li>engine&#x3D;â€openpyxlâ€  æŒ‡å®šäº†ä½¿â½¤ä»€ä¹ˆå¼•æ“æ¥è¯»å– excel â½‚ä»¶</li></ul><p><strong>å®‰è£…ï¼š pip3 install openpyxl</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_excel(<span class="string">&quot;student.xlsx&quot;</span>,sheet_name=<span class="string">&quot;Sheet1&quot;</span>,header=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.to_excel(<span class="string">&quot;student1.xlsx&quot;</span>,sheet_name=<span class="string">&quot;xs&quot;</span>,index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h1 id="Numpy"><a href="#Numpy" class="headerlink" title="Numpy"></a>Numpy</h1><ol><li><ul><li><p>NumPyï¼ˆ<strong>Num</strong>erical <strong>Py</strong>thonï¼‰æ˜¯ Python ä¸­ç”¨äº<strong>ç§‘å­¦è®¡ç®—</strong>çš„åŸºç¡€ä¸”<strong>æå…¶æ ¸å¿ƒ</strong>çš„åº“ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„ <strong>N ç»´æ•°ç»„å¯¹è±¡</strong>ä»¥åŠä¸€ç³»åˆ—æ“ä½œè¿™äº›æ•°ç»„çš„å‡½æ•°å’Œå·¥å…·ã€‚å‡ ä¹æ‰€æœ‰å¤„ç†æ•°å€¼æ•°æ®çš„ Python åº“ï¼ˆå¦‚ Pandas, SciPy, Matplotlib, scikit-learn, TensorFlow, PyTorch ç­‰ï¼‰éƒ½å»ºç«‹åœ¨ NumPy ä¹‹ä¸Šæˆ–ä¸å…¶æ·±åº¦é›†æˆã€‚</p><p>ä»¥ä¸‹æ˜¯ NumPy çš„å…³é”®ç‰¹æ€§å’Œä»‹ç»ï¼š</p><ol><li><p><strong>æ ¸å¿ƒå¯¹è±¡ï¼š<code>ndarray</code> (N-dimensional array)</strong></p><ul><li><strong>å¤šç»´åŒè´¨æ•°ç»„ï¼š</strong> è¿™æ˜¯ NumPy çš„æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚å®ƒæ˜¯ä¸€ä¸ªåŒ…å«<strong>ç›¸åŒç±»å‹</strong>å…ƒç´ çš„è¡¨æ ¼ï¼ˆé€šå¸¸æ˜¯æ•°å­—ï¼‰ï¼Œå¯ä»¥é€šè¿‡éè´Ÿæ•´æ•°å…ƒç»„è¿›è¡Œç´¢å¼•ã€‚</li><li><strong>ç»´åº¦ (axes)ï¼š</strong> æ•°ç»„æœ‰ç»´åº¦ã€‚ä¾‹å¦‚ï¼š<ul><li>ä¸€ç»´æ•°ç»„ï¼š<code>[1, 2, 3]</code> (1 ä¸ªè½´)</li><li>äºŒç»´æ•°ç»„ï¼š<code>[[1, 2, 3], [4, 5, 6]]</code> (2 ä¸ªè½´ï¼šè¡Œã€åˆ—)</li><li>ä¸‰ç»´æ•°ç»„ï¼šæƒ³è±¡ä¸€ä¸ªç«‹æ–¹ä½“çš„æ•°æ® (3 ä¸ªè½´)ã€‚</li></ul></li><li><strong>å½¢çŠ¶ (shape)ï¼š</strong> ä¸€ä¸ªè¡¨ç¤ºæ¯ä¸ªç»´åº¦å¤§å°çš„å…ƒç»„ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢çš„äºŒç»´æ•°ç»„å½¢çŠ¶æ˜¯ <code>(2, 3)</code>ï¼ˆ2 è¡Œï¼Œ3 åˆ—ï¼‰ã€‚</li><li><strong>æ•°æ®ç±»å‹ (dtype)ï¼š</strong> æ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹ï¼Œå¦‚ <code>int32</code>, <code>int64</code>, <code>float32</code>, <code>float64</code>, <code>bool_</code>, <code>string_</code> ç­‰ã€‚å®šä¹‰ç±»å‹å¯¹äºå†…å­˜å ç”¨å’Œè®¡ç®—æ•ˆç‡è‡³å…³é‡è¦ã€‚</li><li><strong>å†…å­˜æ•ˆç‡ä¸é€Ÿåº¦ï¼š</strong> <code>ndarray</code> åœ¨å†…å­˜ä¸­è¿ç»­å­˜å‚¨ï¼ˆæˆ–æŒ‰ç‰¹å®šæ­¥å¹…å­˜å‚¨ï¼‰ï¼Œå¹¶ä½¿ç”¨ç¼–è¯‘åçš„ä½çº§ä»£ç ï¼ˆC&#x2F;Fortranï¼‰è¿›è¡Œæ“ä½œï¼Œè¿™æ¯” Python åŸç”Ÿçš„åˆ—è¡¨ (<code>list</code>) å¤„ç†æ•°å€¼æ•°æ®è¦<strong>å¿«å¾—å¤š</strong>ï¼Œ<strong>å†…å­˜æ•ˆç‡é«˜å¾—å¤š</strong>ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤§å‹æ•°æ®é›†ã€‚</li></ul></li><li><p><strong>çŸ¢é‡åŒ–æ“ä½œ (Vectorization)</strong></p><ul><li><p>NumPy æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ã€‚å®ƒå…è®¸ä½ å¯¹æ•´ä¸ªæ•°ç»„æ‰§è¡Œæ“ä½œï¼ˆåŠ ã€å‡ã€ä¹˜ã€é™¤ã€æ¯”è¾ƒã€å‡½æ•°åº”ç”¨ç­‰ï¼‰ï¼Œ<strong>æ— éœ€ç¼–å†™æ˜¾å¼çš„å¾ªç¯</strong>ã€‚</p></li><li><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>ç®€æ´æ€§ï¼š</strong> ä»£ç æ›´çŸ­ï¼Œæ›´æ˜“è¯»ï¼Œæ›´æ¥è¿‘æ•°å­¦è¡¨è¾¾å¼ã€‚</li><li><strong>é«˜æ€§èƒ½ï¼š</strong> åº•å±‚ä½¿ç”¨é«˜æ•ˆçš„é¢„ç¼–è¯‘ä¾‹ç¨‹ï¼Œé¿å…äº† Python å¾ªç¯çš„è§£é‡Šå™¨å¼€é”€ã€‚</li></ul></li><li><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">b = np.array([<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># çŸ¢é‡åŒ–åŠ æ³• - å¯¹æ•´ä¸ªæ•°ç»„æ“ä½œ</span></span><br><span class="line">c = a + b  <span class="comment"># ç»“æœ: array([6, 8, 10, 12])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çŸ¢é‡åŒ–ä¹˜æ³•</span></span><br><span class="line">d = a * <span class="number">2</span>  <span class="comment"># ç»“æœ: array([2, 4, 6, 8])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°å­¦å‡½æ•°ä½œç”¨äºæ•´ä¸ªæ•°ç»„</span></span><br><span class="line">e = np.sin(a)  <span class="comment"># è®¡ç®—æ¯ä¸ªå…ƒç´ çš„æ­£å¼¦å€¼</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>å¹¿æ’­ (Broadcasting)</strong></p><ul><li><p>è¿™æ˜¯ä¸€ç»„å¼ºå¤§çš„è§„åˆ™ï¼Œå…è®¸ NumPy å¯¹<strong>å½¢çŠ¶ä¸åŒ</strong>çš„æ•°ç»„æ‰§è¡Œç®—æœ¯è¿ç®—ã€‚</p></li><li><p>æ ¸å¿ƒæ€æƒ³ï¼šå°†è¾ƒå°çš„æ•°ç»„â€œå¹¿æ’­â€åˆ°è¾ƒå¤§æ•°ç»„çš„å½¢çŠ¶ï¼Œä½¿å®ƒä»¬å…·æœ‰<strong>å…¼å®¹çš„å½¢çŠ¶</strong>ï¼Œç„¶åè¿›è¡Œé€å…ƒç´ æ“ä½œã€‚</p></li><li><p><strong>è§„åˆ™ï¼ˆç®€åŒ–ï¼‰ï¼š</strong></p><ol><li>å¦‚æœä¸¤ä¸ªæ•°ç»„ç»´åº¦æ•°ä¸åŒï¼Œå°ç»´åº¦æ•°ç»„çš„å½¢çŠ¶ä¼šåœ¨å…¶<strong>å·¦è¾¹</strong>å¡«å…… <code>1</code>ã€‚</li><li>å¦‚æœä¸¤ä¸ªæ•°ç»„åœ¨æŸä¸ªç»´åº¦ä¸Šçš„å¤§å°ç›¸åŒï¼Œæˆ–è€…å…¶ä¸­ä¸€ä¸ªçš„å¤§å°ä¸º <code>1</code>ï¼Œåˆ™è®¤ä¸ºå®ƒä»¬åœ¨è¯¥ç»´åº¦ä¸Šæ˜¯<strong>å…¼å®¹çš„</strong>ã€‚</li><li>æ•°ç»„åªèƒ½åœ¨æ‰€æœ‰ç»´åº¦éƒ½å…¼å®¹çš„æƒ…å†µä¸‹å¹¿æ’­ã€‚</li><li>å¹¿æ’­åï¼Œæ¯ä¸ªæ•°ç»„çš„è¡Œä¸ºå°±åƒå®ƒæ‹¥æœ‰å’Œæœ€å¤§æ•°ç»„ä¸€æ ·çš„å½¢çŠ¶ã€‚</li></ol></li><li><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],  <span class="comment"># shape (2, 3)</span></span><br><span class="line">              [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line">b = np.array([<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>])  <span class="comment"># shape (3,) -&gt; å¹¿æ’­ä¸º (1, 3) -&gt; (2, 3)</span></span><br><span class="line"></span><br><span class="line">c = a + b</span><br><span class="line"><span class="comment"># ç»“æœï¼š</span></span><br><span class="line"><span class="comment"># [[1+10, 2+20, 3+30],</span></span><br><span class="line"><span class="comment">#  [4+10, 5+20, 6+30]]</span></span><br><span class="line"><span class="comment"># = [[11, 22, 33],</span></span><br><span class="line"><span class="comment">#    [14, 25, 36]]</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ä¸°å¯Œçš„å‡½æ•°åº“</strong></p><ul><li><strong>æ•°å­¦è¿ç®—ï¼š</strong> <code>np.add()</code>, <code>np.subtract()</code>, <code>np.multiply()</code>, <code>np.divide()</code>, <code>np.exp()</code>, <code>np.log()</code>, <code>np.sin()</code>, <code>np.cos()</code>, <code>np.sum()</code>, <code>np.mean()</code>, <code>np.std()</code>, <code>np.min()</code>, <code>np.max()</code> ç­‰ã€‚</li><li><strong>çº¿æ€§ä»£æ•°ï¼š</strong> <code>np.dot()</code> (ç‚¹ç§¯&#x2F;çŸ©é˜µä¹˜æ³•), <code>np.linalg.inv()</code> (çŸ©é˜µæ±‚é€†), <code>np.linalg.det()</code> (è¡Œåˆ—å¼), <code>np.linalg.eig()</code> (ç‰¹å¾å€¼&#x2F;ç‰¹å¾å‘é‡) ç­‰ (ä¸»è¦åœ¨ <code>numpy.linalg</code> å­æ¨¡å—)ã€‚</li><li><strong>æ•°ç»„æ“ä½œï¼š</strong> <code>np.reshape()</code>, <code>np.concatenate()</code>, <code>np.split()</code>, <code>np.transpose()</code>, <code>np.sort()</code>, <code>np.ravel()</code> (å±•å¹³), åˆ‡ç‰‡ã€ç´¢å¼•ï¼ˆåŸºç¡€ç´¢å¼•ã€å¸ƒå°”ç´¢å¼•ã€èŠ±å¼ç´¢å¼•ï¼‰ã€‚</li><li><strong>éšæœºæ•°ç”Ÿæˆï¼š</strong> <code>np.random.rand()</code>, <code>np.random.randn()</code>, <code>np.random.randint()</code>, <code>np.random.normal()</code> ç­‰ (åœ¨ <code>numpy.random</code> å­æ¨¡å—)ã€‚</li><li><strong>é€»è¾‘è¿ç®—ï¼š</strong> <code>np.logical_and()</code>, <code>np.logical_or()</code>, <code>np.logical_not()</code>, æ¯”è¾ƒè¿ç®—ç¬¦ (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>) è¿”å›å¸ƒå°”æ•°ç»„ã€‚</li><li><strong>æ–‡ä»¶ I&#x2F;Oï¼š</strong> <code>np.loadtxt()</code>, <code>np.savetxt()</code>, <code>np.load()</code> (ç”¨äº <code>.npy</code> æ ¼å¼), <code>np.save()</code> (ç”¨äº <code>.npy</code> æ ¼å¼)ï¼Œæ–¹ä¾¿è¯»å†™æ•°ç»„æ•°æ®ã€‚</li></ul></li><li><p><strong>ä¸å…¶ä»–åº“çš„äº’æ“ä½œæ€§</strong></p><ul><li>NumPy æ•°ç»„æ˜¯ Python ç§‘å­¦è®¡ç®—ç”Ÿæ€ç³»ç»Ÿçš„<strong>é€šç”¨æ•°æ®äº¤æ¢æ ¼å¼</strong>ã€‚</li><li>Pandas çš„ <code>DataFrame</code> å’Œ <code>Series</code> å¯ä»¥è½»æ¾è½¬æ¢ä¸º NumPy æ•°ç»„ (<code>.values</code> æˆ– <code>.to_numpy()</code>)ã€‚</li><li>SciPy ä¸ºç§‘å­¦è®¡ç®—ï¼ˆä¼˜åŒ–ã€ç§¯åˆ†ã€æ’å€¼ã€ä¿¡å·å¤„ç†ç­‰ï¼‰æä¾›äº†æ›´å¤šé«˜çº§å‡½æ•°ï¼Œé€šå¸¸ç›´æ¥æ“ä½œ NumPy æ•°ç»„ã€‚</li><li>Matplotlib ç­‰ç»˜å›¾åº“ç›´æ¥æ¥å— NumPy æ•°ç»„è¿›è¡Œç»˜å›¾ã€‚</li><li>scikit-learnã€TensorFlowã€PyTorch ç­‰æœºå™¨å­¦ä¹ &#x2F;æ·±åº¦å­¦ä¹ æ¡†æ¶çš„æ ¸å¿ƒæ•°æ®ç»“æ„é€šå¸¸åŸºäºæˆ–å…¼å®¹ NumPy æ•°ç»„ (<code>numpy.ndarray</code> æˆ–èƒ½ä¸ä¹‹è½¬æ¢çš„ tensor ç±»å‹)ã€‚</li></ul></li></ol><h1 id="Matplotlib"><a href="#Matplotlib" class="headerlink" title="Matplotlib"></a>Matplotlib</h1><p>Matplotlib æ˜¯ Python ç”Ÿæ€ç³»ç»Ÿä¸­æœ€<strong>æ ¸å¿ƒçš„æ•°æ®å¯è§†åŒ–åº“</strong>ï¼Œç”± John D. Hunter äº 2003 å¹´åˆ›å»ºã€‚å®ƒæä¾›äº†ç±»ä¼¼ MATLAB çš„ç»˜å›¾æ¥å£ï¼ŒåŒæ—¶å…·å¤‡ Python çš„çµæ´»æ€§å’Œå¼ºå¤§åŠŸèƒ½ï¼Œå·²æˆä¸ºç§‘å­¦è®¡ç®—ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ é¢†åŸŸçš„<strong>æ ‡å‡†å¯è§†åŒ–å·¥å…·</strong>ã€‚</p><h2 id="æ ¸å¿ƒç‰¹ç‚¹"><a href="#æ ¸å¿ƒç‰¹ç‚¹" class="headerlink" title="æ ¸å¿ƒç‰¹ç‚¹"></a>æ ¸å¿ƒç‰¹ç‚¹</h2><ol><li><strong>å…¨é¢çš„å›¾è¡¨æ”¯æŒ</strong>ï¼š<ul><li>åŸºç¡€å›¾è¡¨ï¼šæŠ˜çº¿å›¾ã€æ•£ç‚¹å›¾ã€æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€ç›´æ–¹å›¾</li><li>é«˜çº§å›¾è¡¨ï¼šç­‰é«˜çº¿å›¾ã€çƒ­åŠ›å›¾ã€3Då›¾ã€çŸ¢é‡åœºå›¾</li><li>ç»Ÿè®¡å›¾è¡¨ï¼šç®±çº¿å›¾ã€è¯¯å·®æ£’å›¾ã€å°æç´å›¾</li><li>åœ°ç†ç»˜å›¾ï¼šåŸºç¡€åœ°å›¾æŠ•å½±ï¼ˆéœ€é…åˆ Basemap æˆ– Cartopyï¼‰</li></ul></li><li><strong>å¤šå¹³å°å…¼å®¹</strong>ï¼š<ul><li>Jupyter Notebook å†…åµŒæ˜¾ç¤º</li><li>ç‹¬ç«‹çš„ GUI çª—å£</li><li>å¤šç§æ ¼å¼å¯¼å‡ºï¼šPNG, PDF, SVG, EPS ç­‰</li><li>Web åº”ç”¨é›†æˆï¼ˆé€šè¿‡ Agg åç«¯ï¼‰</li></ul></li><li><strong>é«˜åº¦å¯å®šåˆ¶</strong>ï¼š<ul><li>ç»†ç²’åº¦æ§åˆ¶æ¯ä¸ªå›¾è¡¨å…ƒç´ </li><li>æ”¯æŒ LaTeX æ•°å­¦å…¬å¼</li><li>ä¸°å¯Œçš„æ ·å¼å’Œé¢œè‰²é…ç½®</li></ul></li><li><strong>ä¸ç§‘å­¦è®¡ç®—æ ˆæ— ç¼é›†æˆ</strong>ï¼š<ul><li>åŸç”Ÿæ”¯æŒ NumPy æ•°ç»„</li><li>ä¸ Pandas DataFrame æ·±åº¦é›†æˆ</li><li>ä½œä¸º Seabornã€Plotly ç­‰é«˜çº§åº“çš„åŸºç¡€</li></ul></li></ol></li></ul></li></ol><h3 id="å…³é”®å¯¹è±¡"><a href="#å…³é”®å¯¹è±¡" class="headerlink" title="å…³é”®å¯¹è±¡"></a>å…³é”®å¯¹è±¡</h3><ul><li><strong>Figureï¼ˆå›¾å½¢ï¼‰</strong>ï¼šé¡¶çº§å®¹å™¨ï¼Œç›¸å½“äºç”»å¸ƒ</li><li><strong>Axesï¼ˆåæ ‡ç³»ï¼‰</strong>ï¼šå®é™…ç»˜å›¾åŒºåŸŸï¼ŒåŒ…å«åæ ‡è½´ã€æ ‡é¢˜ç­‰</li><li><strong>Axisï¼ˆåæ ‡è½´ï¼‰</strong>ï¼šå¤„ç†åˆ»åº¦ã€æ ‡ç­¾å’Œç½‘æ ¼çº¿</li><li><strong>Artistï¼ˆè‰ºæœ¯å®¶ï¼‰</strong>ï¼šæ‰€æœ‰å¯è§å…ƒç´ çš„åŸºç±»</li></ul><h2 id="åŸºæœ¬ä½¿ç”¨æ¨¡å¼"><a href="#åŸºæœ¬ä½¿ç”¨æ¨¡å¼" class="headerlink" title="åŸºæœ¬ä½¿ç”¨æ¨¡å¼"></a>åŸºæœ¬ä½¿ç”¨æ¨¡å¼</h2><h3 id="1-å¿«é€Ÿç»˜å›¾ï¼ˆpyplot-æ–¹å¼ï¼‰"><a href="#1-å¿«é€Ÿç»˜å›¾ï¼ˆpyplot-æ–¹å¼ï¼‰" class="headerlink" title="1. å¿«é€Ÿç»˜å›¾ï¼ˆpyplot æ–¹å¼ï¼‰"></a>1. å¿«é€Ÿç»˜å›¾ï¼ˆpyplot æ–¹å¼ï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®</span></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå›¾å½¢</span></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">4</span>))  <span class="comment"># è®¾ç½®å›¾å½¢å¤§å°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æŠ˜çº¿å›¾</span></span><br><span class="line">plt.plot(x, y, label=<span class="string">&#x27;sin(x)&#x27;</span>, color=<span class="string">&#x27;blue&#x27;</span>, linestyle=<span class="string">&#x27;-&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ ‡é¢˜å’Œæ ‡ç­¾</span></span><br><span class="line">plt.title(<span class="string">&#x27;Sine Wave&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;X-axis&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Y-axis&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å›¾ä¾‹å’Œç½‘æ ¼</span></span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid(<span class="literal">True</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾å½¢</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h3 id="2-é¢å‘å¯¹è±¡æ–¹å¼ï¼ˆæ¨èç”¨äºå¤æ‚å›¾è¡¨ï¼‰"><a href="#2-é¢å‘å¯¹è±¡æ–¹å¼ï¼ˆæ¨èç”¨äºå¤æ‚å›¾è¡¨ï¼‰" class="headerlink" title="2. é¢å‘å¯¹è±¡æ–¹å¼ï¼ˆæ¨èç”¨äºå¤æ‚å›¾è¡¨ï¼‰"></a>2. é¢å‘å¯¹è±¡æ–¹å¼ï¼ˆæ¨èç”¨äºå¤æ‚å›¾è¡¨ï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå›¾å½¢å’Œåæ ‡ç³»</span></span><br><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨åæ ‡ç³»ä¸Šç»˜å›¾</span></span><br><span class="line">ax.plot(x, np.sin(x), label=<span class="string">&#x27;Sine&#x27;</span>, color=<span class="string">&#x27;royalblue&#x27;</span>)</span><br><span class="line">ax.plot(x, np.cos(x), label=<span class="string">&#x27;Cosine&#x27;</span>, color=<span class="string">&#x27;crimson&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®åæ ‡ç³»å±æ€§</span></span><br><span class="line">ax.set_title(<span class="string">&#x27;Trigonometric Functions&#x27;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;X values&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;Function values&#x27;</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line">ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®åæ ‡è½´èŒƒå›´</span></span><br><span class="line">ax.set_xlim(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">ax.set_ylim(-<span class="number">1.5</span>, <span class="number">1.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ³¨é‡Š</span></span><br><span class="line">ax.annotate(<span class="string">&#x27;Local max&#x27;</span>, xy=(np.pi/<span class="number">2</span>, <span class="number">1</span>), xytext=(<span class="number">4</span>, <span class="number">1.2</span>),</span><br><span class="line">            arrowprops=<span class="built_in">dict</span>(facecolor=<span class="string">&#x27;black&#x27;</span>, shrink=<span class="number">0.05</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜é«˜è´¨é‡å›¾ç‰‡</span></span><br><span class="line">fig.savefig(<span class="string">&#x27;trig_functions.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨å›¾è¡¨ç±»å‹ç¤ºä¾‹"><a href="#å¸¸ç”¨å›¾è¡¨ç±»å‹ç¤ºä¾‹" class="headerlink" title="å¸¸ç”¨å›¾è¡¨ç±»å‹ç¤ºä¾‹"></a>å¸¸ç”¨å›¾è¡¨ç±»å‹ç¤ºä¾‹</h2><h3 id="1-å¤šå­å›¾å¸ƒå±€"><a href="#1-å¤šå­å›¾å¸ƒå±€" class="headerlink" title="1. å¤šå­å›¾å¸ƒå±€"></a>1. å¤šå­å›¾å¸ƒå±€</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾1ï¼šæ•£ç‚¹å›¾</span></span><br><span class="line">x = np.random.randn(<span class="number">100</span>)</span><br><span class="line">y = np.random.randn(<span class="number">100</span>)</span><br><span class="line">colors = np.random.rand(<span class="number">100</span>)</span><br><span class="line">sizes = <span class="number">100</span> * np.random.rand(<span class="number">100</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">0</span>].scatter(x, y, c=colors, s=sizes, alpha=<span class="number">0.6</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">0</span>].set_title(<span class="string">&#x27;Scatter Plot&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾2ï¼šæŸ±çŠ¶å›¾</span></span><br><span class="line">categories = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>]</span><br><span class="line">values = [<span class="number">25</span>, <span class="number">40</span>, <span class="number">30</span>, <span class="number">45</span>]</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">1</span>].bar(categories, values, color=[<span class="string">&#x27;skyblue&#x27;</span>, <span class="string">&#x27;salmon&#x27;</span>, <span class="string">&#x27;lightgreen&#x27;</span>, <span class="string">&#x27;gold&#x27;</span>])</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">1</span>].set_title(<span class="string">&#x27;Bar Chart&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾3ï¼šç›´æ–¹å›¾</span></span><br><span class="line">data = np.random.randn(<span class="number">1000</span>)</span><br><span class="line">axes[<span class="number">1</span>, <span class="number">0</span>].hist(data, bins=<span class="number">30</span>, color=<span class="string">&#x27;purple&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">axes[<span class="number">1</span>, <span class="number">0</span>].set_title(<span class="string">&#x27;Histogram&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾4ï¼šé¥¼å›¾</span></span><br><span class="line">sizes = [<span class="number">15</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">20</span>]</span><br><span class="line">explode = (<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0</span>, <span class="number">0</span>)  <span class="comment"># çªå‡ºç¬¬äºŒéƒ¨åˆ†</span></span><br><span class="line">axes[<span class="number">1</span>, <span class="number">1</span>].pie(sizes, explode=explode, labels=categories, autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>,</span><br><span class="line">               shadow=<span class="literal">True</span>, startangle=<span class="number">90</span>)</span><br><span class="line">axes[<span class="number">1</span>, <span class="number">1</span>].set_title(<span class="string">&#x27;Pie Chart&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()  <span class="comment"># è‡ªåŠ¨è°ƒæ•´å­å›¾é—´è·</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h3 id="2-é«˜çº§å¯è§†åŒ–ï¼š3D-æ›²é¢å›¾"><a href="#2-é«˜çº§å¯è§†åŒ–ï¼š3D-æ›²é¢å›¾" class="headerlink" title="2. é«˜çº§å¯è§†åŒ–ï¼š3D æ›²é¢å›¾"></a>2. é«˜çº§å¯è§†åŒ–ï¼š3D æ›²é¢å›¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®</span></span><br><span class="line">x = np.linspace(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">100</span>)</span><br><span class="line">y = np.linspace(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">100</span>)</span><br><span class="line">X, Y = np.meshgrid(x, y)</span><br><span class="line">Z = np.sin(np.sqrt(X**<span class="number">2</span> + Y**<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶3Dæ›²é¢</span></span><br><span class="line">surf = ax.plot_surface(X, Y, Z, cmap=<span class="string">&#x27;viridis&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ç­‰é«˜çº¿</span></span><br><span class="line">ax.contour(X, Y, Z, <span class="number">10</span>, offset=-<span class="number">1</span>, cmap=<span class="string">&#x27;coolwarm&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ ‡ç­¾</span></span><br><span class="line">ax.set_title(<span class="string">&#x27;3D Surface Plot&#x27;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ é¢œè‰²æ¡</span></span><br><span class="line">fig.colorbar(surf, shrink=<span class="number">0.5</span>, aspect=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h1 id="unittest"><a href="#unittest" class="headerlink" title="unittest"></a>unittest</h1><p><code>unittest</code> æ˜¯ Python æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œä¹Ÿç§°ä¸º PyUnitï¼ˆå— JUnit å¯å‘ï¼‰ã€‚å®ƒæä¾›äº†ä¸€å¥—å®Œæ•´çš„å·¥å…·æ¥ç¼–å†™ã€ç»„ç»‡å’Œè¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œå¸®åŠ©å¼€å‘è€…éªŒè¯ä»£ç çš„æ­£ç¡®æ€§ï¼Œç¡®ä¿ä»£ç åœ¨ä¿®æ”¹æˆ–æ‰©å±•åä»ç„¶èƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚</p><h2 id="æ ¸å¿ƒç»„ä»¶"><a href="#æ ¸å¿ƒç»„ä»¶" class="headerlink" title="æ ¸å¿ƒç»„ä»¶"></a>æ ¸å¿ƒç»„ä»¶</h2><h3 id="1-TestCase-ç±»"><a href="#1-TestCase-ç±»" class="headerlink" title="1. TestCase ç±»"></a>1. <strong>TestCase ç±»</strong></h3><ul><li>æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹éƒ½ç»§æ‰¿è‡ª <code>unittest.TestCase</code>ã€‚</li><li>æµ‹è¯•æ–¹æ³•å¿…é¡»ä»¥ <code>test_</code> å¼€å¤´ï¼Œä¾‹å¦‚ <code>test_addition()</code>ã€‚</li><li>åŒ…å«æ–­è¨€æ–¹æ³•ï¼ˆå¦‚ <code>assertEqual</code>ã€<code>assertTrue</code> ç­‰ï¼‰æ¥éªŒè¯é¢„æœŸç»“æœã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTestCase</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_addition</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.assertEqual(<span class="number">1</span> + <span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h3 id="2-TestSuite-ç±»"><a href="#2-TestSuite-ç±»" class="headerlink" title="2. TestSuite ç±»"></a>2. <strong>TestSuite ç±»</strong></h3><ul><li>ç”¨äºç»„åˆå¤šä¸ªæµ‹è¯•ç”¨ä¾‹æˆ–æµ‹è¯•å¥—ä»¶ï¼Œå½¢æˆæ›´å¤§çš„æµ‹è¯•é›†åˆã€‚</li><li>å¯ä»¥é€šè¿‡ <code>addTest()</code> æ–¹æ³•åŠ¨æ€æ·»åŠ æµ‹è¯•ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">suite = unittest.TestSuite()</span><br><span class="line">suite.addTest(MyTestCase(<span class="string">&quot;test_addition&quot;</span>))</span><br></pre></td></tr></table></figure><h3 id="3-TestLoader-ç±»"><a href="#3-TestLoader-ç±»" class="headerlink" title="3. TestLoader ç±»"></a>3. <strong>TestLoader ç±»</strong></h3><ul><li>è‡ªåŠ¨å‘ç°å’ŒåŠ è½½æµ‹è¯•ç”¨ä¾‹ã€‚</li><li>å¯ä»¥æ‰«ææŒ‡å®šç›®å½•æˆ–æ¨¡å—ï¼ŒæŸ¥æ‰¾æ‰€æœ‰ç»§æ‰¿è‡ª <code>TestCase</code> çš„ç±»å’Œæ–¹æ³•ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">loader = unittest.TestLoader()</span><br><span class="line">suite = loader.discover(<span class="string">&quot;tests&quot;</span>, pattern=<span class="string">&quot;test_*.py&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="4-TextTestRunner-ç±»"><a href="#4-TextTestRunner-ç±»" class="headerlink" title="4. TextTestRunner ç±»"></a>4. <strong>TextTestRunner ç±»</strong></h3><ul><li>ç”¨äºè¿è¡Œæµ‹è¯•å¥—ä»¶å¹¶è¾“å‡ºç»“æœã€‚</li><li>æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼ï¼ˆå¦‚æ–‡æœ¬ã€XMLã€HTML ç­‰ï¼‰ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">runner = unittest.TextTestRunner()</span><br><span class="line">runner.run(suite)</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨æ–­è¨€æ–¹æ³•"><a href="#å¸¸ç”¨æ–­è¨€æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–­è¨€æ–¹æ³•"></a>å¸¸ç”¨æ–­è¨€æ–¹æ³•</h2><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>assertEqual(a, b)</code></td><td>éªŒè¯ <code>a == b</code></td></tr><tr><td><code>assertNotEqual(a, b)</code></td><td>éªŒè¯ <code>a != b</code></td></tr><tr><td><code>assertTrue(x)</code></td><td>éªŒè¯ <code>x</code> ä¸ºçœŸ</td></tr><tr><td><code>assertFalse(x)</code></td><td>éªŒè¯ <code>x</code> ä¸ºå‡</td></tr><tr><td><code>assertIs(a, b)</code></td><td>éªŒè¯ <code>a</code> å’Œ <code>b</code> æ˜¯åŒä¸€ä¸ªå¯¹è±¡</td></tr><tr><td><code>assertIsNot(a, b)</code></td><td>éªŒè¯ <code>a</code> å’Œ <code>b</code> ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡</td></tr><tr><td><code>assertIsNone(x)</code></td><td>éªŒè¯ <code>x</code> æ˜¯ <code>None</code></td></tr><tr><td><code>assertIsNotNone(x)</code></td><td>éªŒè¯ <code>x</code> ä¸æ˜¯ <code>None</code></td></tr><tr><td><code>assertIn(a, b)</code></td><td>éªŒè¯ <code>a</code> åœ¨ <code>b</code> ä¸­</td></tr><tr><td><code>assertNotIn(a, b)</code></td><td>éªŒè¯ <code>a</code> ä¸åœ¨ <code>b</code> ä¸­</td></tr><tr><td><code>assertRaises(exc, fun, *args, **kwargs)</code></td><td>éªŒè¯ <code>fun(*args, **kwargs)</code> æŠ›å‡ºå¼‚å¸¸ <code>exc</code></td></tr></tbody></table><h2 id="æµ‹è¯•å¤¹å…·ï¼ˆFixturesï¼‰"><a href="#æµ‹è¯•å¤¹å…·ï¼ˆFixturesï¼‰" class="headerlink" title="æµ‹è¯•å¤¹å…·ï¼ˆFixturesï¼‰"></a>æµ‹è¯•å¤¹å…·ï¼ˆFixturesï¼‰</h2><ul><li>**<code>setUp()</code>**ï¼šåœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œå‰æ‰§è¡Œï¼Œç”¨äºåˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒã€‚</li><li>**<code>tearDown()</code>**ï¼šåœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œåæ‰§è¡Œï¼Œç”¨äºæ¸…ç†æµ‹è¯•ç¯å¢ƒã€‚</li><li><strong><code>setUpClass()</code></strong> å’Œ **<code>tearDownClass()</code>**ï¼šåœ¨ç±»çº§åˆ«æ‰§è¡Œï¼Œåˆ†åˆ«ç”¨äºç±»çº§åˆ«çš„åˆå§‹åŒ–å’Œæ¸…ç†ï¼ˆéœ€ä½¿ç”¨ <code>@classmethod</code> è£…é¥°å™¨ï¼‰ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyTestCase</span>(unittest.TestCase):</span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUpClass</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ç±»çº§åˆ«çš„åˆå§‹åŒ–&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ¯ä¸ªæµ‹è¯•å‰çš„åˆå§‹åŒ–&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_example</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¿è¡Œæµ‹è¯•&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ¯ä¸ªæµ‹è¯•åçš„æ¸…ç†&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDownClass</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ç±»çº§åˆ«çš„æ¸…ç†&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œæµ‹è¯•"><a href="#è¿è¡Œæµ‹è¯•" class="headerlink" title="è¿è¡Œæµ‹è¯•"></a>è¿è¡Œæµ‹è¯•</h2><h3 id="1-å‘½ä»¤è¡Œè¿è¡Œ"><a href="#1-å‘½ä»¤è¡Œè¿è¡Œ" class="headerlink" title="1. å‘½ä»¤è¡Œè¿è¡Œ"></a>1. <strong>å‘½ä»¤è¡Œè¿è¡Œ</strong></h3><ul><li><p>ä½¿ç”¨ <code>python -m unittest</code> è¿è¡Œæµ‹è¯•ã€‚</p></li><li><p>å¯ä»¥æŒ‡å®šæ¨¡å—ã€ç±»æˆ–æ–¹æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -m unittest tests.test_module</span><br><span class="line">python -m unittest tests.test_module.MyTestCase</span><br><span class="line">python -m unittest tests.test_module.MyTestCase.test_method</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-å‘ç°æµ‹è¯•"><a href="#2-å‘ç°æµ‹è¯•" class="headerlink" title="2. å‘ç°æµ‹è¯•"></a>2. <strong>å‘ç°æµ‹è¯•</strong></h3><ul><li><p>ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">discover</span><br></pre></td></tr></table></figure><p>é€‰é¡¹è‡ªåŠ¨å‘ç°æµ‹è¯•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">python -m unittest discover -s tests -p <span class="string">&quot;test_*.py&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="ç¤ºä¾‹ï¼šå®Œæ•´æµ‹è¯•æµç¨‹"><a href="#ç¤ºä¾‹ï¼šå®Œæ•´æµ‹è¯•æµç¨‹" class="headerlink" title="ç¤ºä¾‹ï¼šå®Œæ•´æµ‹è¯•æµç¨‹"></a>ç¤ºä¾‹ï¼šå®Œæ•´æµ‹è¯•æµç¨‹</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶ï¼šmath_operations.py</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">subtract</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a - b</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ–‡ä»¶ï¼štests/test_math_operations.py</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> math_operations <span class="keyword">import</span> add, subtract</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestMathOperations</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_add</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.assertEqual(add(<span class="number">1</span>, <span class="number">2</span>), <span class="number">3</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_subtract</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.assertEqual(subtract(<span class="number">5</span>, <span class="number">3</span>), <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure><p>è¿è¡Œæµ‹è¯•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">python -m unittest tests.test_math_operations</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">Ran 2 tests in 0.000s</span><br><span class="line"> </span><br><span class="line">OK</span><br></pre></td></tr></table></figure><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ol><li><strong>å†…ç½®æ”¯æŒ</strong>ï¼š<code>unittest</code> æ˜¯ Python æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œæ— éœ€é¢å¤–å®‰è£…ã€‚</li><li><strong>ç»“æ„æ¸…æ™°</strong>ï¼šé€šè¿‡ç»§æ‰¿ <code>TestCase</code> å’Œæ–¹æ³•å‘½åçº¦å®šï¼Œæµ‹è¯•ä»£ç ç»“æ„æ¸…æ™°ã€‚</li><li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šæä¾›å¤šç§æ–­è¨€æ–¹æ³•å’Œæµ‹è¯•å¤¹å…·ï¼Œæ»¡è¶³å¤æ‚æµ‹è¯•éœ€æ±‚ã€‚</li><li><strong>æ˜“äºé›†æˆ</strong>ï¼šå¯ä»¥ä¸æŒç»­é›†æˆå·¥å…·ï¼ˆå¦‚ Jenkinsã€GitHub Actionsï¼‰æ— ç¼é›†æˆã€‚</li></ol><h2 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h2><ul><li>å•å…ƒæµ‹è¯•ï¼šéªŒè¯å•ä¸ªå‡½æ•°æˆ–æ–¹æ³•çš„æ­£ç¡®æ€§ã€‚</li><li>é›†æˆæµ‹è¯•ï¼šéªŒè¯å¤šä¸ªæ¨¡å—æˆ–ç»„ä»¶çš„äº¤äº’ã€‚</li><li>å›å½’æµ‹è¯•ï¼šç¡®ä¿ä»£ç ä¿®æ”¹åä¸ä¼šå¼•å…¥æ–°çš„é—®é¢˜ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>unittest</code> æ˜¯ Python ä¸­åŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œé€‚åˆå¤§å¤šæ•° Python é¡¹ç›®çš„æµ‹è¯•éœ€æ±‚ã€‚é€šè¿‡åˆç†ç»„ç»‡æµ‹è¯•ç”¨ä¾‹å’Œåˆ©ç”¨æµ‹è¯•å¤¹å…·ï¼Œå¯ä»¥æ˜¾è‘—æé«˜ä»£ç çš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h1 id="Setuptoolsï¼šPython-æ‰“åŒ…ä¸åˆ†å‘çš„æ ¸å¿ƒå·¥å…·"><a href="#Setuptoolsï¼šPython-æ‰“åŒ…ä¸åˆ†å‘çš„æ ¸å¿ƒå·¥å…·" class="headerlink" title="Setuptoolsï¼šPython æ‰“åŒ…ä¸åˆ†å‘çš„æ ¸å¿ƒå·¥å…·"></a>Setuptoolsï¼šPython æ‰“åŒ…ä¸åˆ†å‘çš„æ ¸å¿ƒå·¥å…·</h1><p>Setuptools æ˜¯ Python ç”Ÿæ€ç³»ç»Ÿä¸­æœ€é‡è¦ä¸”<strong>å¹¿æ³›ä½¿ç”¨çš„åŒ…æ„å»ºå·¥å…·</strong>ï¼Œå®ƒæ‰©å±•äº† Python æ ‡å‡†åº“ä¸­çš„ distutils æ¨¡å—ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„é¡¹ç›®æ‰“åŒ…ã€ä¾èµ–ç®¡ç†å’Œåˆ†å‘èƒ½åŠ›ã€‚å‡ ä¹æ‰€æœ‰ç°ä»£ Python åŒ…éƒ½ä¾èµ–äº Setuptools è¿›è¡Œæ„å»ºå’Œåˆ†å‘ã€‚</p><h2 id="æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼"><a href="#æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼"></a>æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼</h2><h3 id="1-é¡¹ç›®æ‰“åŒ…"><a href="#1-é¡¹ç›®æ‰“åŒ…" class="headerlink" title="1. é¡¹ç›®æ‰“åŒ…"></a>1. <strong>é¡¹ç›®æ‰“åŒ…</strong></h3><ul><li>å°† Python ä»£ç ç»„ç»‡æˆå¯åˆ†å‘çš„æ ¼å¼ï¼ˆæºç åŒ…ã€wheel ç­‰ï¼‰</li><li>è‡ªåŠ¨åŒ…å«é¡¹ç›®æ–‡ä»¶å’Œéä»£ç èµ„æº</li><li>æ”¯æŒå¤æ‚é¡¹ç›®ç»“æ„ï¼ˆå‘½åç©ºé—´åŒ…ã€å¤šåŒ…é¡¹ç›®ï¼‰</li></ul><h3 id="2-ä¾èµ–ç®¡ç†"><a href="#2-ä¾èµ–ç®¡ç†" class="headerlink" title="2. ä¾èµ–ç®¡ç†"></a>2. <strong>ä¾èµ–ç®¡ç†</strong></h3><ul><li>å£°æ˜é¡¹ç›®ä¾èµ–ï¼ˆ<code>install_requires</code>ï¼‰</li><li>æŒ‡å®šå¯é€‰ä¾èµ–ç»„ï¼ˆ<code>extras_require</code>ï¼‰</li><li>è‡ªåŠ¨è§£å†³ä¾èµ–å…³ç³»æ ‘</li></ul><h3 id="3-å…ƒæ•°æ®ç®¡ç†"><a href="#3-å…ƒæ•°æ®ç®¡ç†" class="headerlink" title="3. å…ƒæ•°æ®ç®¡ç†"></a>3. <strong>å…ƒæ•°æ®ç®¡ç†</strong></h3><ul><li>å®šä¹‰é¡¹ç›®å…ƒæ•°æ®ï¼ˆåç§°ã€ç‰ˆæœ¬ã€ä½œè€…ç­‰ï¼‰</li><li>æä¾›åˆ†ç±»ä¿¡æ¯ï¼ˆPyPI åˆ†ç±»å™¨ï¼‰</li><li>æ”¯æŒè®¸å¯è¯å’Œé¡¹ç›®URL</li></ul><h3 id="4-å¯æ‰§è¡Œæ–‡ä»¶åˆ›å»º"><a href="#4-å¯æ‰§è¡Œæ–‡ä»¶åˆ›å»º" class="headerlink" title="4. å¯æ‰§è¡Œæ–‡ä»¶åˆ›å»º"></a>4. <strong>å¯æ‰§è¡Œæ–‡ä»¶åˆ›å»º</strong></h3><ul><li>è‡ªåŠ¨ç”Ÿæˆå¹³å°ç›¸å…³çš„å¯æ‰§è¡Œè„šæœ¬</li><li>é€šè¿‡å…¥å£ç‚¹ï¼ˆentry pointsï¼‰åˆ›å»ºå‘½ä»¤è¡Œå·¥å…·</li></ul><h3 id="5-æ‰©å±•æ„å»º"><a href="#5-æ‰©å±•æ„å»º" class="headerlink" title="5. æ‰©å±•æ„å»º"></a>5. <strong>æ‰©å±•æ„å»º</strong></h3><ul><li>ç¼–è¯‘å’Œæ‰“åŒ… C&#x2F;C++ æ‰©å±•</li><li>é›†æˆ Cython ç­‰å·¥å…·</li></ul><h2 id="æ ¸å¿ƒç»„ä»¶è§£æ"><a href="#æ ¸å¿ƒç»„ä»¶è§£æ" class="headerlink" title="æ ¸å¿ƒç»„ä»¶è§£æ"></a>æ ¸å¿ƒç»„ä»¶è§£æ</h2><h3 id="1-setup-py-é¡¹ç›®æ„å»ºè„šæœ¬"><a href="#1-setup-py-é¡¹ç›®æ„å»ºè„šæœ¬" class="headerlink" title="1. setup.py - é¡¹ç›®æ„å»ºè„šæœ¬"></a>1. <code>setup.py</code> - é¡¹ç›®æ„å»ºè„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup, find_packages</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&quot;my_project&quot;</span>,  <span class="comment"># åŒ…åç§°</span></span><br><span class="line">    version=<span class="string">&quot;1.0.0&quot;</span>,    <span class="comment"># ç‰ˆæœ¬å·</span></span><br><span class="line">    author=<span class="string">&quot;Your Name&quot;</span>,</span><br><span class="line">    author_email=<span class="string">&quot;your@email.com&quot;</span>,</span><br><span class="line">    description=<span class="string">&quot;A short description of your project&quot;</span>,</span><br><span class="line">    long_description=<span class="built_in">open</span>(<span class="string">&quot;README.md&quot;</span>).read(),</span><br><span class="line">    long_description_content_type=<span class="string">&quot;text/markdown&quot;</span>,</span><br><span class="line">    url=<span class="string">&quot;https://github.com/you/my_project&quot;</span>,</span><br><span class="line">    packages=find_packages(where=<span class="string">&quot;src&quot;</span>),  <span class="comment"># è‡ªåŠ¨å‘ç°åŒ…</span></span><br><span class="line">    package_dir=&#123;<span class="string">&quot;&quot;</span>: <span class="string">&quot;src&quot;</span>&#125;,             <span class="comment"># åŒ…ä½ç½®</span></span><br><span class="line">    install_requires=[                   <span class="comment"># ä¾èµ–å£°æ˜</span></span><br><span class="line">        <span class="string">&quot;requests&gt;=2.25.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;numpy&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    extras_require=&#123;                     <span class="comment"># å¯é€‰ä¾èµ–ç»„</span></span><br><span class="line">        <span class="string">&quot;dev&quot;</span>: [<span class="string">&quot;pytest&quot;</span>, <span class="string">&quot;flake8&quot;</span>],</span><br><span class="line">        <span class="string">&quot;plot&quot;</span>: [<span class="string">&quot;matplotlib&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    classifiers=[                        <span class="comment"># PyPI åˆ†ç±»å™¨</span></span><br><span class="line">        <span class="string">&quot;Programming Language :: Python :: 3&quot;</span>,</span><br><span class="line">        <span class="string">&quot;License :: OSI Approved :: MIT License&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Operating System :: OS Independent&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">    python_requires=<span class="string">&quot;&gt;=3.6&quot;</span>,            <span class="comment"># Python ç‰ˆæœ¬è¦æ±‚</span></span><br><span class="line">    entry_points=&#123;                       <span class="comment"># å‘½ä»¤è¡Œå…¥å£ç‚¹</span></span><br><span class="line">        <span class="string">&quot;console_scripts&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;mycli=my_project.cli:main&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    include_package_data=<span class="literal">True</span>,          <span class="comment"># åŒ…å«æ•°æ®æ–‡ä»¶</span></span><br><span class="line">    package_data=&#123;<span class="string">&quot;my_project&quot;</span>: [<span class="string">&quot;data/*.json&quot;</span>]&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="2-setup-cfg-å£°æ˜å¼é…ç½®ï¼ˆæ¨èï¼‰"><a href="#2-setup-cfg-å£°æ˜å¼é…ç½®ï¼ˆæ¨èï¼‰" class="headerlink" title="2. setup.cfg - å£°æ˜å¼é…ç½®ï¼ˆæ¨èï¼‰"></a>2. <code>setup.cfg</code> - å£°æ˜å¼é…ç½®ï¼ˆæ¨èï¼‰</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[metadata]</span></span><br><span class="line"><span class="attr">name</span> = my_project</span><br><span class="line"><span class="attr">version</span> = attr: my_project.__version__</span><br><span class="line"><span class="attr">author</span> = Your Name</span><br><span class="line"><span class="attr">author_email</span> = your@email.com</span><br><span class="line"><span class="attr">description</span> = Project description</span><br><span class="line"><span class="attr">long_description</span> = file: README.md</span><br><span class="line"><span class="attr">long_description_content_type</span> = text/markdown</span><br><span class="line"><span class="attr">url</span> = https://github.com/you/my_project</span><br><span class="line"><span class="attr">license</span> = MIT</span><br><span class="line"><span class="attr">license_file</span> = LICENSE.txt</span><br><span class="line"><span class="attr">classifiers</span> =</span><br><span class="line">    Programming Language :: Python :: 3</span><br><span class="line">    License :: OSI Approved :: MIT License</span><br><span class="line"></span><br><span class="line"><span class="section">[options]</span></span><br><span class="line"><span class="attr">package_dir</span> =</span><br><span class="line">    = src</span><br><span class="line"><span class="attr">packages</span> = find:</span><br><span class="line"><span class="attr">install_requires</span> =</span><br><span class="line">    requests&gt;=2.25.1</span><br><span class="line">    numpy</span><br><span class="line"><span class="attr">python_requires</span> = &gt;=<span class="number">3.6</span></span><br><span class="line"><span class="attr">include_package_data</span> = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="section">[options.packages.find]</span></span><br><span class="line"><span class="attr">where</span> = src</span><br><span class="line"></span><br><span class="line"><span class="section">[options.extras_require]</span></span><br><span class="line"><span class="attr">dev</span> = pytest<span class="comment">; flake8</span></span><br><span class="line"><span class="attr">plot</span> = matplotlib</span><br><span class="line"></span><br><span class="line"><span class="section">[options.entry_points]</span></span><br><span class="line"><span class="attr">console_scripts</span> =</span><br><span class="line">    <span class="attr">mycli</span> = my_project.cli:main</span><br></pre></td></tr></table></figure><h3 id="3-pyproject-toml-ç°ä»£æ„å»ºé…ç½®ï¼ˆPEP-517-518ï¼‰"><a href="#3-pyproject-toml-ç°ä»£æ„å»ºé…ç½®ï¼ˆPEP-517-518ï¼‰" class="headerlink" title="3. pyproject.toml - ç°ä»£æ„å»ºé…ç½®ï¼ˆPEP 517&#x2F;518ï¼‰"></a>3. <code>pyproject.toml</code> - ç°ä»£æ„å»ºé…ç½®ï¼ˆPEP 517&#x2F;518ï¼‰</h3><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;setuptools&gt;=61.0&quot;</span>, <span class="string">&quot;wheel&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;setuptools.build_meta&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[project]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;my_project&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"><span class="attr">authors</span> = [</span><br><span class="line">    &#123;name = <span class="string">&quot;Your Name&quot;</span>, email = <span class="string">&quot;your@email.com&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"><span class="attr">description</span> = <span class="string">&quot;Project description&quot;</span></span><br><span class="line"><span class="attr">readme</span> = <span class="string">&quot;README.md&quot;</span></span><br><span class="line"><span class="attr">requires-python</span> = <span class="string">&quot;&gt;=3.6&quot;</span></span><br><span class="line"><span class="attr">license</span> = &#123;text = <span class="string">&quot;MIT&quot;</span>&#125;</span><br><span class="line"><span class="attr">classifiers</span> = [</span><br><span class="line">    <span class="string">&quot;Programming Language :: Python :: 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;License :: OSI Approved :: MIT License&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="attr">dependencies</span> = [</span><br><span class="line">    <span class="string">&quot;requests&gt;=2.25.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;numpy&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[project.optional-dependencies]</span></span><br><span class="line"><span class="attr">dev</span> = [<span class="string">&quot;pytest&quot;</span>, <span class="string">&quot;flake8&quot;</span>]</span><br><span class="line"><span class="attr">plot</span> = [<span class="string">&quot;matplotlib&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[project.scripts]</span></span><br><span class="line"><span class="attr">mycli</span> = <span class="string">&quot;my_project.cli:main&quot;</span></span><br></pre></td></tr></table></figure><h2 id="å…³é”®åŠŸèƒ½è¯¦è§£"><a href="#å…³é”®åŠŸèƒ½è¯¦è§£" class="headerlink" title="å…³é”®åŠŸèƒ½è¯¦è§£"></a>å…³é”®åŠŸèƒ½è¯¦è§£</h2><h3 id="1-åŒ…å‘ç°ä¸ç»„ç»‡"><a href="#1-åŒ…å‘ç°ä¸ç»„ç»‡" class="headerlink" title="1. åŒ…å‘ç°ä¸ç»„ç»‡"></a>1. åŒ…å‘ç°ä¸ç»„ç»‡</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªåŠ¨å‘ç°æ‰€æœ‰åŒ…</span></span><br><span class="line">packages = find_packages(where=<span class="string">&quot;src&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ…å«æŒ‡å®šåŒ…</span></span><br><span class="line">packages = [<span class="string">&quot;my_pkg&quot;</span>, <span class="string">&quot;my_pkg.subpkg&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½åç©ºé—´åŒ…</span></span><br><span class="line">packages = find_namespace_packages(include=[<span class="string">&quot;my_namespace.*&quot;</span>])</span><br></pre></td></tr></table></figure><h3 id="2-ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ"><a href="#2-ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ" class="headerlink" title="2. ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ"></a>2. ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">install_requires = [</span><br><span class="line">    <span class="comment"># åŸºæœ¬è¦æ±‚</span></span><br><span class="line">    <span class="string">&quot;requests&gt;=2.25.1&quot;</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç‰ˆæœ¬çº¦æŸç¤ºä¾‹</span></span><br><span class="line">    <span class="string">&quot;numpy&gt;=1.18; python_version&gt;&#x27;3.6&#x27;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;numpy&gt;=1.16; python_version&lt;=&#x27;3.6&#x27;&quot;</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¯å¢ƒæ ‡è®°</span></span><br><span class="line">    <span class="string">&quot;pywin32 &gt;= 1.0; platform_system==&#x27;Windows&#x27;&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">extras_require = &#123;</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: [<span class="string">&quot;pytest&quot;</span>, <span class="string">&quot;pytest-cov&quot;</span>],</span><br><span class="line">    <span class="string">&quot;docs&quot;</span>: [<span class="string">&quot;sphinx&quot;</span>, <span class="string">&quot;sphinx-rtd-theme&quot;</span>],</span><br><span class="line">    <span class="string">&quot;all&quot;</span>: [<span class="string">&quot;pandas&quot;</span>, <span class="string">&quot;matplotlib&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å…¥å£ç‚¹æœºåˆ¶"><a href="#3-å…¥å£ç‚¹æœºåˆ¶" class="headerlink" title="3. å…¥å£ç‚¹æœºåˆ¶"></a>3. å…¥å£ç‚¹æœºåˆ¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">entry_points = &#123;</span><br><span class="line">    # å‘½ä»¤è¡Œå·¥å…·</span><br><span class="line">    &quot;console_scripts&quot;: [</span><br><span class="line">        &quot;mycli = my_pkg.cli:main&quot;</span><br><span class="line">    ],</span><br><span class="line">    </span><br><span class="line">    # GUI åº”ç”¨</span><br><span class="line">    &quot;gui_scripts&quot;: [</span><br><span class="line">        &quot;myapp = my_pkg.gui:launch&quot;</span><br><span class="line">    ],</span><br><span class="line">    </span><br><span class="line">    # æ’ä»¶ç³»ç»Ÿ</span><br><span class="line">    &quot;my_framework.plugins&quot;: [</span><br><span class="line">        &quot;csv_import = my_pkg.plugins.csv:CSVImporter&quot;,</span><br><span class="line">        &quot;json_export = my_pkg.plugins.json:JSONExporter&quot;</span><br><span class="line">    ],</span><br><span class="line">    </span><br><span class="line">    # æµ‹è¯•æ¡†æ¶é›†æˆ</span><br><span class="line">    &quot;pytest11&quot;: [</span><br><span class="line">        &quot;myplugin = my_pkg.pytest_plugin&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-æ•°æ®æ–‡ä»¶ä¸èµ„æºç®¡ç†"><a href="#4-æ•°æ®æ–‡ä»¶ä¸èµ„æºç®¡ç†" class="headerlink" title="4. æ•°æ®æ–‡ä»¶ä¸èµ„æºç®¡ç†"></a>4. æ•°æ®æ–‡ä»¶ä¸èµ„æºç®¡ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŒ…å«åŒ…å†…æ•°æ®æ–‡ä»¶</span></span><br><span class="line">package_data = &#123;</span><br><span class="line">    <span class="string">&quot;my_pkg&quot;</span>: [<span class="string">&quot;data/*.csv&quot;</span>, <span class="string">&quot;templates/*.html&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ…å«é¡¹ç›®çº§æ•°æ®æ–‡ä»¶</span></span><br><span class="line">data_files = [</span><br><span class="line">    (<span class="string">&quot;config&quot;</span>, [<span class="string">&quot;conf/app.cfg&quot;</span>]),</span><br><span class="line">    (<span class="string">&quot;/etc/myapp&quot;</span>, [<span class="string">&quot;system/myapp.conf&quot;</span>]),</span><br><span class="line">    (<span class="string">&quot;share/icons&quot;</span>, [<span class="string">&quot;icons/app_icon.png&quot;</span>])</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨MANIFEST.inæ§åˆ¶æºç åˆ†å‘å†…å®¹</span></span><br><span class="line">include_package_data = <span class="literal">True</span></span><br></pre></td></tr></table></figure><h2 id="å·¥ä½œæµç¨‹ä¸å‘½ä»¤"><a href="#å·¥ä½œæµç¨‹ä¸å‘½ä»¤" class="headerlink" title="å·¥ä½œæµç¨‹ä¸å‘½ä»¤"></a>å·¥ä½œæµç¨‹ä¸å‘½ä»¤</h2><h3 id="1-å¼€å‘æ¨¡å¼å®‰è£…"><a href="#1-å¼€å‘æ¨¡å¼å®‰è£…" class="headerlink" title="1. å¼€å‘æ¨¡å¼å®‰è£…"></a>1. å¼€å‘æ¨¡å¼å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯ç¼–è¾‘å®‰è£…ï¼ˆä»£ç å˜æ›´å®æ—¶ç”Ÿæ•ˆï¼‰</span></span><br><span class="line">pip install -e .</span><br></pre></td></tr></table></figure><h3 id="2-æ„å»ºåˆ†å‘åŒ…"><a href="#2-æ„å»ºåˆ†å‘åŒ…" class="headerlink" title="2. æ„å»ºåˆ†å‘åŒ…"></a>2. æ„å»ºåˆ†å‘åŒ…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…æ„å»ºå·¥å…·</span></span><br><span class="line">pip install build</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºæºç åˆ†å‘ï¼ˆsdistï¼‰å’ŒwheelåŒ…</span></span><br><span class="line">python -m build</span><br></pre></td></tr></table></figure><h3 id="3-å‘å¸ƒåˆ°PyPI"><a href="#3-å‘å¸ƒåˆ°PyPI" class="headerlink" title="3. å‘å¸ƒåˆ°PyPI"></a>3. å‘å¸ƒåˆ°PyPI</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…å‘å¸ƒå·¥å…·</span></span><br><span class="line">pip install twine</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ åˆ°PyPI</span></span><br><span class="line">twine upload dist/*</span><br></pre></td></tr></table></figure><h3 id="4-å¸¸ç”¨å¼€å‘å‘½ä»¤"><a href="#4-å¸¸ç”¨å¼€å‘å‘½ä»¤" class="headerlink" title="4. å¸¸ç”¨å¼€å‘å‘½ä»¤"></a>4. å¸¸ç”¨å¼€å‘å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…å¼€å‘ä¾èµ–</span></span><br><span class="line">pip install -e <span class="string">&quot;.[dev]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œæµ‹è¯•</span></span><br><span class="line">pytest</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ–‡æ¡£</span></span><br><span class="line">sphinx-build docs build/docs</span><br></pre></td></tr></table></figure><h2 id="ç°ä»£æ‰“åŒ…æœ€ä½³å®è·µ"><a href="#ç°ä»£æ‰“åŒ…æœ€ä½³å®è·µ" class="headerlink" title="ç°ä»£æ‰“åŒ…æœ€ä½³å®è·µ"></a>ç°ä»£æ‰“åŒ…æœ€ä½³å®è·µ</h2><h3 id="1-é¡¹ç›®ç»“æ„æ¨è"><a href="#1-é¡¹ç›®ç»“æ„æ¨è" class="headerlink" title="1. é¡¹ç›®ç»“æ„æ¨è"></a>1. é¡¹ç›®ç»“æ„æ¨è</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">my_project/</span><br><span class="line">â”œâ”€â”€ src/</span><br><span class="line">â”‚   â””â”€â”€ my_pkg/</span><br><span class="line">â”‚       â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚       â”œâ”€â”€ module.py</span><br><span class="line">â”‚       â””â”€â”€ data/</span><br><span class="line">â”‚           â””â”€â”€ config.json</span><br><span class="line">â”œâ”€â”€ tests/</span><br><span class="line">â”‚   â”œâ”€â”€ test_module.py</span><br><span class="line">â”‚   â””â”€â”€ conftest.py</span><br><span class="line">â”œâ”€â”€ docs/</span><br><span class="line">â”‚   â””â”€â”€ conf.py</span><br><span class="line">â”œâ”€â”€ .gitignore</span><br><span class="line">â”œâ”€â”€ pyproject.toml       # PEP 518 æ„å»ºé…ç½®</span><br><span class="line">â”œâ”€â”€ setup.cfg            # ä¸»è¦é…ç½®</span><br><span class="line">â”œâ”€â”€ setup.py             # æœ€å°åŒ–ï¼ˆå¯é€‰ï¼‰</span><br><span class="line">â”œâ”€â”€ LICENSE</span><br><span class="line">â””â”€â”€ README.md</span><br></pre></td></tr></table></figure><h3 id="2-ç‰ˆæœ¬ç®¡ç†ç­–ç•¥"><a href="#2-ç‰ˆæœ¬ç®¡ç†ç­–ç•¥" class="headerlink" title="2. ç‰ˆæœ¬ç®¡ç†ç­–ç•¥"></a>2. ç‰ˆæœ¬ç®¡ç†ç­–ç•¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ __init__.py ä¸­å®šä¹‰ç‰ˆæœ¬</span></span><br><span class="line">__version__ = <span class="string">&quot;1.2.3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># setup.cfg ä¸­åŠ¨æ€è·å–ç‰ˆæœ¬</span></span><br><span class="line">[metadata]</span><br><span class="line">version = attr: my_pkg.__version__</span><br></pre></td></tr></table></figure><h3 id="3-å…¼å®¹æ€§å¤„ç†"><a href="#3-å…¼å®¹æ€§å¤„ç†" class="headerlink" title="3. å…¼å®¹æ€§å¤„ç†"></a>3. å…¼å®¹æ€§å¤„ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤„ç†ä¸åŒPythonç‰ˆæœ¬çš„ä¾èµ–</span></span><br><span class="line">install_requires = [</span><br><span class="line">    <span class="string">&quot;importlib_metadata; python_version&lt;&#x27;3.8&#x27;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;typing_extensions; python_version&lt;&#x27;3.8&#x27;&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¹³å°ç‰¹å®šä¾èµ–</span></span><br><span class="line">extras_require = &#123;</span><br><span class="line">    <span class="string">&quot;:sys_platform == &#x27;win32&#x27;&quot;</span>: [<span class="string">&quot;pywin32&quot;</span>],</span><br><span class="line">    <span class="string">&quot;:sys_platform == &#x27;darwin&#x27;&quot;</span>: [<span class="string">&quot;pyobjc&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é«˜çº§åŠŸèƒ½"><a href="#é«˜çº§åŠŸèƒ½" class="headerlink" title="é«˜çº§åŠŸèƒ½"></a>é«˜çº§åŠŸèƒ½</h2><h3 id="1-Cæ‰©å±•é›†æˆ"><a href="#1-Cæ‰©å±•é›†æˆ" class="headerlink" title="1. Cæ‰©å±•é›†æˆ"></a>1. Cæ‰©å±•é›†æˆ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> Extension, setup</span><br><span class="line"></span><br><span class="line">module = Extension(</span><br><span class="line">    <span class="string">&quot;my_extension&quot;</span>,</span><br><span class="line">    sources=[<span class="string">&quot;src/extension.c&quot;</span>],</span><br><span class="line">    include_dirs=[<span class="string">&quot;include&quot;</span>],</span><br><span class="line">    libraries=[<span class="string">&quot;m&quot;</span>],  <span class="comment"># é“¾æ¥æ•°å­¦åº“</span></span><br><span class="line">    define_macros=[(<span class="string">&quot;DEBUG&quot;</span>, <span class="string">&quot;1&quot;</span>)],</span><br><span class="line">    extra_compile_args=[<span class="string">&quot;-O3&quot;</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    ...,</span><br><span class="line">    ext_modules=[module]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="2-è‡ªå®šä¹‰æ„å»ºå‘½ä»¤"><a href="#2-è‡ªå®šä¹‰æ„å»ºå‘½ä»¤" class="headerlink" title="2. è‡ªå®šä¹‰æ„å»ºå‘½ä»¤"></a>2. è‡ªå®šä¹‰æ„å»ºå‘½ä»¤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup</span><br><span class="line"><span class="keyword">from</span> setuptools.command.build_py <span class="keyword">import</span> build_py</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomBuild</span>(<span class="title class_ inherited__">build_py</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è‡ªå®šä¹‰æ„å»ºè¿‡ç¨‹&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># é¢„å¤„ç†æ­¥éª¤</span></span><br><span class="line">        <span class="variable language_">self</span>.run_command(<span class="string">&quot;generate_protos&quot;</span>)</span><br><span class="line">        <span class="comment"># æ ‡å‡†æ„å»º</span></span><br><span class="line">        <span class="built_in">super</span>().run()</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    ...,</span><br><span class="line">    cmdclass=&#123;</span><br><span class="line">        <span class="string">&quot;build_py&quot;</span>: CustomBuild,</span><br><span class="line">        <span class="string">&quot;generate_protos&quot;</span>: GenerateProtosCommand</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="3-åŠ¨æ€å…ƒæ•°æ®"><a href="#3-åŠ¨æ€å…ƒæ•°æ®" class="headerlink" title="3. åŠ¨æ€å…ƒæ•°æ®"></a>3. åŠ¨æ€å…ƒæ•°æ®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setup.py ä¸­åŠ¨æ€ç”Ÿæˆå…ƒæ•°æ®</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_version</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä»æ–‡ä»¶è¯»å–ç‰ˆæœ¬å·&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;src/my_pkg/__init__.py&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">r&#x27;__version__ = [&quot;\&#x27;](.+)[&quot;\&#x27;]&#x27;</span>, f.read())</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    version=get_version(),</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§é—®é¢˜è§£å†³"><a href="#å¸¸è§é—®é¢˜è§£å†³" class="headerlink" title="å¸¸è§é—®é¢˜è§£å†³"></a>å¸¸è§é—®é¢˜è§£å†³</h2><h3 id="1-åŒ…æ‰¾ä¸åˆ°é—®é¢˜"><a href="#1-åŒ…æ‰¾ä¸åˆ°é—®é¢˜" class="headerlink" title="1. åŒ…æ‰¾ä¸åˆ°é—®é¢˜"></a>1. åŒ…æ‰¾ä¸åˆ°é—®é¢˜</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­£ç¡®è®¾ç½®åŒ…ç›®å½•</span></span><br><span class="line">package_dir = &#123;<span class="string">&quot;&quot;</span>: <span class="string">&quot;src&quot;</span>&#125;</span><br><span class="line">packages = find_packages(where=<span class="string">&quot;src&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="2-æ•°æ®æ–‡ä»¶æœªåŒ…å«"><a href="#2-æ•°æ®æ–‡ä»¶æœªåŒ…å«" class="headerlink" title="2. æ•°æ®æ–‡ä»¶æœªåŒ…å«"></a>2. æ•°æ®æ–‡ä»¶æœªåŒ…å«</h3><p>ini</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setup.cfg ä¸­å¯ç”¨åŒ…æ•°æ®</span></span><br><span class="line"><span class="section">[options]</span></span><br><span class="line"><span class="attr">include_package_data</span> = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ  MANIFEST.in</span></span><br><span class="line">include *.txt</span><br><span class="line">recursive-include docs *.rst</span><br></pre></td></tr></table></figure><h3 id="3-å…¥å£ç‚¹ä¸å·¥ä½œ"><a href="#3-å…¥å£ç‚¹ä¸å·¥ä½œ" class="headerlink" title="3. å…¥å£ç‚¹ä¸å·¥ä½œ"></a>3. å…¥å£ç‚¹ä¸å·¥ä½œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¡®ä¿å‡½æ•°è·¯å¾„æ­£ç¡®</span></span><br><span class="line">entry_points = &#123;</span><br><span class="line">    <span class="string">&quot;console_scripts&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;mycli = my_pkg.cli:main_function&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæ€ç³»ç»Ÿæ•´åˆ"><a href="#ç”Ÿæ€ç³»ç»Ÿæ•´åˆ" class="headerlink" title="ç”Ÿæ€ç³»ç»Ÿæ•´åˆ"></a>ç”Ÿæ€ç³»ç»Ÿæ•´åˆ</h2><ol><li><strong>ä¸ pip é›†æˆ</strong>ï¼šSetuptools æ˜¯ pip å®‰è£…è¿‡ç¨‹çš„æ ¸å¿ƒç»„ä»¶</li><li><strong>ä¸ virtualenv åä½œ</strong>ï¼šåœ¨éš”ç¦»ç¯å¢ƒä¸­æ„å»ºå’Œæµ‹è¯•</li><li><strong>ä¸ tox é…åˆ</strong>ï¼šè·¨å¤šPythonç‰ˆæœ¬æµ‹è¯•</li><li><strong>ä¸ cibuildwheel é›†æˆ</strong>ï¼šæ„å»ºè·¨å¹³å°äºŒè¿›åˆ¶wheel</li><li><strong>ä¸ Sphinx ç»“åˆ</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</li></ol><h2 id="æ¼”è¿›ä¸æœªæ¥"><a href="#æ¼”è¿›ä¸æœªæ¥" class="headerlink" title="æ¼”è¿›ä¸æœªæ¥"></a>æ¼”è¿›ä¸æœªæ¥</h2><ul><li><strong>PEP 517&#x2F;518</strong>ï¼šç°ä»£æ„å»ºç³»ç»Ÿæ ‡å‡†</li><li><strong><code>pyproject.toml</code> æ”¯æŒ</strong>ï¼šé€æ­¥æ›¿ä»£ setup.py</li><li><strong>é™æ€å…ƒæ•°æ®</strong>ï¼šå‡å°‘åŠ¨æ€æ‰§è¡Œéœ€æ±‚</li><li><strong>æ„å»ºéš”ç¦»</strong>ï¼šæ›´å®‰å…¨çš„æ„å»ºç¯å¢ƒ</li></ul><h1 id="Jupyter-ä»‹ç»"><a href="#Jupyter-ä»‹ç»" class="headerlink" title="Jupyter ä»‹ç»"></a>Jupyter ä»‹ç»</h1><p>Jupyter æ˜¯ä¸€ä¸ªå¼€æºçš„äº¤äº’å¼è®¡ç®—ç¯å¢ƒï¼Œå¹¿æ³›åº”ç”¨äºæ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ ã€ç§‘å­¦è®¡ç®—å’Œæ•™è‚²é¢†åŸŸã€‚å®ƒæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ Pythonã€Rã€Julia ç­‰ï¼‰ï¼Œå…è®¸ç”¨æˆ·ä»¥äº¤äº’å¼çš„æ–¹å¼ç¼–å†™ä»£ç ã€è¿è¡Œå®éªŒã€å¯è§†åŒ–æ•°æ®å¹¶è®°å½•ç»“æœã€‚ä»¥ä¸‹æ˜¯ Jupyter çš„æ ¸å¿ƒç‰¹æ€§å’Œåº”ç”¨åœºæ™¯çš„è¯¦ç»†ä»‹ç»ã€‚</p><hr><h2 id="æ ¸å¿ƒç»„ä»¶-1"><a href="#æ ¸å¿ƒç»„ä»¶-1" class="headerlink" title="æ ¸å¿ƒç»„ä»¶"></a><strong>æ ¸å¿ƒç»„ä»¶</strong></h2><h3 id="1-Jupyter-Notebook"><a href="#1-Jupyter-Notebook" class="headerlink" title="1. Jupyter Notebook"></a>1. <strong>Jupyter Notebook</strong></h3><ul><li><strong>äº¤äº’å¼æ–‡æ¡£</strong>ï¼šä»¥ <code>.ipynb</code> æ–‡ä»¶æ ¼å¼å­˜å‚¨ï¼ŒåŒ…å«ä»£ç ã€æ–‡æœ¬ï¼ˆMarkdownï¼‰ã€å…¬å¼ï¼ˆLaTeXï¼‰ã€å›¾è¡¨å’Œå¤šåª’ä½“å†…å®¹ã€‚</li><li><strong>ä»£ç å•å…ƒæ ¼ï¼ˆCode Cellsï¼‰</strong>ï¼šé€è¡Œæˆ–åˆ†å—æ‰§è¡Œä»£ç ï¼Œå®æ—¶æŸ¥çœ‹è¾“å‡ºç»“æœã€‚</li><li><strong>Markdown å•å…ƒæ ¼</strong>ï¼šæ”¯æŒå¯Œæ–‡æœ¬æ ¼å¼ï¼Œç”¨äºè§£é‡Šä»£ç ã€è®°å½•å®éªŒæ­¥éª¤æˆ–æ’°å†™æŠ¥å‘Šã€‚</li><li><strong>è¾“å‡ºå¯è§†åŒ–</strong>ï¼šç›´æ¥åœ¨ Notebook ä¸­æ˜¾ç¤ºå›¾è¡¨ï¼ˆå¦‚ Matplotlibã€Plotlyï¼‰å’Œäº¤äº’å¼æ§ä»¶ï¼ˆå¦‚ ipywidgetsï¼‰ã€‚</li></ul><h3 id="2-JupyterLab"><a href="#2-JupyterLab" class="headerlink" title="2. JupyterLab"></a>2. <strong>JupyterLab</strong></h3><ul><li><p>ä¸‹ä¸€ä»£ç•Œé¢</p><p>ï¼šåŸºäº Web çš„äº¤äº’å¼å¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼š</p><ul><li>å¤šçª—å£å¸ƒå±€ï¼šåŒæ—¶æ‰“å¼€å¤šä¸ª Notebookã€ç»ˆç«¯ã€æ–‡æœ¬ç¼–è¾‘å™¨ç­‰ã€‚</li><li>æ–‡ä»¶æµè§ˆå™¨ï¼šç›´æ¥ç®¡ç†é¡¹ç›®æ–‡ä»¶å’Œç›®å½•ã€‚</li><li>æ‰©å±•æ”¯æŒï¼šé€šè¿‡æ’ä»¶æ‰©å±•åŠŸèƒ½ï¼ˆå¦‚è°ƒè¯•å™¨ã€Git é›†æˆï¼‰ã€‚</li></ul></li><li><p><strong>å…¼å®¹æ€§</strong>ï¼šå®Œå…¨å…¼å®¹ Jupyter Notebookï¼Œæ”¯æŒæ‰€æœ‰ Notebook æ–‡ä»¶ã€‚</p></li></ul><h3 id="3-Jupyter-Kernel"><a href="#3-Jupyter-Kernel" class="headerlink" title="3. Jupyter Kernel"></a>3. <strong>Jupyter Kernel</strong></h3><ul><li><p>è®¡ç®—å¼•æ“</p><p>ï¼šè´Ÿè´£æ‰§è¡Œä»£ç çš„æ ¸å¿ƒç»„ä»¶ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼š</p><ul><li><strong>IPython Kernel</strong>ï¼šPython çš„é»˜è®¤å†…æ ¸ã€‚</li><li><strong>IRKernel</strong>ï¼šR è¯­è¨€æ”¯æŒã€‚</li><li><strong>IJulia</strong>ï¼šJulia è¯­è¨€æ”¯æŒã€‚</li><li><strong>å…¶ä»–å†…æ ¸</strong>ï¼šå¦‚ Bashã€Scalaã€Go ç­‰ã€‚</li></ul></li></ul><hr><h2 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½"></a><strong>ä¸»è¦åŠŸèƒ½</strong></h2><h3 id="1-äº¤äº’å¼è®¡ç®—"><a href="#1-äº¤äº’å¼è®¡ç®—" class="headerlink" title="1. äº¤äº’å¼è®¡ç®—"></a>1. <strong>äº¤äº’å¼è®¡ç®—</strong></h3><ul><li><strong>å®æ—¶åé¦ˆ</strong>ï¼šä»£ç å•å…ƒæ ¼æ‰§è¡Œåç«‹å³æ˜¾ç¤ºç»“æœï¼Œé€‚åˆå¿«é€Ÿè¿­ä»£å’Œè°ƒè¯•ã€‚</li><li><strong>é­”æ³•å‘½ä»¤ï¼ˆMagic Commandsï¼‰</strong>ï¼šIPython æä¾›çš„ç‰¹æ®Šå‘½ä»¤ï¼ˆå¦‚ <code>%timeit</code> æµ‹é‡ä»£ç æ€§èƒ½ï¼‰ã€‚</li></ul><h3 id="2-æ•°æ®å¯è§†åŒ–"><a href="#2-æ•°æ®å¯è§†åŒ–" class="headerlink" title="2. æ•°æ®å¯è§†åŒ–"></a>2. <strong>æ•°æ®å¯è§†åŒ–</strong></h3><ul><li><strong>é™æ€å›¾è¡¨</strong>ï¼šé€šè¿‡ Matplotlibã€Seaborn ç­‰åº“ç”Ÿæˆã€‚</li><li><strong>äº¤äº’å¼å›¾è¡¨</strong>ï¼šæ”¯æŒ Plotlyã€Bokeh ç­‰åº“ï¼Œå…è®¸ç”¨æˆ·ç¼©æ”¾ã€å¹³ç§»å’Œç­›é€‰æ•°æ®ã€‚</li></ul><h3 id="3-åä½œä¸åˆ†äº«"><a href="#3-åä½œä¸åˆ†äº«" class="headerlink" title="3. åä½œä¸åˆ†äº«"></a>3. <strong>åä½œä¸åˆ†äº«</strong></h3><ul><li><strong>Notebook å¯¼å‡º</strong>ï¼šæ”¯æŒå¯¼å‡ºä¸º HTMLã€PDFã€LaTeXã€Python è„šæœ¬ç­‰æ ¼å¼ã€‚</li><li><strong>åœ¨çº¿å…±äº«</strong>ï¼šé€šè¿‡ JupyterHub æˆ–å¹³å°ï¼ˆå¦‚ Google Colabã€Binderï¼‰å…±äº« Notebookã€‚</li><li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šä¸ Git é›†æˆï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œå’Œä»£ç ç®¡ç†ã€‚</li></ul><h3 id="4-æ•™è‚²ä¸ç ”ç©¶"><a href="#4-æ•™è‚²ä¸ç ”ç©¶" class="headerlink" title="4. æ•™è‚²ä¸ç ”ç©¶"></a>4. <strong>æ•™è‚²ä¸ç ”ç©¶</strong></h3><ul><li><strong>æ•™å­¦å·¥å…·</strong>ï¼šé€šè¿‡ Markdown å•å…ƒæ ¼ç¼–å†™æ•™ç¨‹ï¼Œç»“åˆä»£ç ç¤ºä¾‹å’Œå¯è§†åŒ–ã€‚</li><li><strong>å®éªŒè®°å½•</strong>ï¼šè®°å½•å®éªŒæ­¥éª¤ã€å‚æ•°å’Œç»“æœï¼Œæ–¹ä¾¿å¤ç°å’Œåˆ†äº«ã€‚</li></ul><hr><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a><strong>åº”ç”¨åœºæ™¯</strong></h2><h3 id="1-æ•°æ®ç§‘å­¦"><a href="#1-æ•°æ®ç§‘å­¦" class="headerlink" title="1. æ•°æ®ç§‘å­¦"></a>1. <strong>æ•°æ®ç§‘å­¦</strong></h3><ul><li>æ•°æ®æ¸…æ´—ä¸æ¢ç´¢æ€§åˆ†æï¼ˆEDAï¼‰ã€‚</li><li>æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°ã€‚</li><li>ç»“æœå¯è§†åŒ–ä¸æŠ¥å‘Šç”Ÿæˆã€‚</li></ul><h3 id="2-ç§‘å­¦è®¡ç®—"><a href="#2-ç§‘å­¦è®¡ç®—" class="headerlink" title="2. ç§‘å­¦è®¡ç®—"></a>2. <strong>ç§‘å­¦è®¡ç®—</strong></h3><ul><li>æ•°å€¼æ¨¡æ‹Ÿä¸ç®—æ³•å¼€å‘ã€‚</li><li>ç§‘å­¦å®éªŒæ•°æ®çš„åˆ†æä¸å¯è§†åŒ–ã€‚</li></ul><h3 id="3-æ•™è‚²ä¸åŸ¹è®­"><a href="#3-æ•™è‚²ä¸åŸ¹è®­" class="headerlink" title="3. æ•™è‚²ä¸åŸ¹è®­"></a>3. <strong>æ•™è‚²ä¸åŸ¹è®­</strong></h3><ul><li>ç¼–ç¨‹æ•™å­¦ï¼ˆå¦‚ Pythonã€R å…¥é—¨ï¼‰ã€‚</li><li>æ•°æ®ç§‘å­¦è¯¾ç¨‹å®è·µã€‚</li></ul><h3 id="4-æŠ€æœ¯æ–‡æ¡£"><a href="#4-æŠ€æœ¯æ–‡æ¡£" class="headerlink" title="4. æŠ€æœ¯æ–‡æ¡£"></a>4. <strong>æŠ€æœ¯æ–‡æ¡£</strong></h3><ul><li>ç¼–å†™æŠ€æœ¯æ–‡æ¡£æˆ–æ•™ç¨‹ï¼Œç»“åˆä»£ç ç¤ºä¾‹å’Œè§£é‡Šã€‚</li></ul><hr><h2 id="å®‰è£…ä¸ä½¿ç”¨"><a href="#å®‰è£…ä¸ä½¿ç”¨" class="headerlink" title="å®‰è£…ä¸ä½¿ç”¨"></a><strong>å®‰è£…ä¸ä½¿ç”¨</strong></h2><h3 id="1-å®‰è£…-Jupyter"><a href="#1-å®‰è£…-Jupyter" class="headerlink" title="1. å®‰è£… Jupyter"></a>1. <strong>å®‰è£… Jupyter</strong></h3><ul><li><p>é€šè¿‡ pip å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">pip install notebook</span><br></pre></td></tr></table></figure></li><li><p>é€šè¿‡ conda å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">conda install -c conda-forge notebook</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£… JupyterLab</p><p>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">pip install jupyterlab</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-å¯åŠ¨-Jupyter"><a href="#2-å¯åŠ¨-Jupyter" class="headerlink" title="2. å¯åŠ¨ Jupyter"></a>2. <strong>å¯åŠ¨ Jupyter</strong></h3><ul><li><p>å¯åŠ¨ Notebook</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">jupyter notebook</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ JupyterLab</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">jupyter lab</span><br></pre></td></tr></table></figure></li><li><p>é»˜è®¤ä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>http://localhost:8888</code>ã€‚</p></li></ul><h3 id="3-åˆ›å»º-Notebook"><a href="#3-åˆ›å»º-Notebook" class="headerlink" title="3. åˆ›å»º Notebook"></a>3. <strong>åˆ›å»º Notebook</strong></h3><ul><li>åœ¨ Jupyter ç•Œé¢ä¸­ï¼Œç‚¹å‡» <strong>New</strong> â†’ <strong>Python 3</strong>ï¼ˆæˆ–å…¶ä»–å†…æ ¸ï¼‰åˆ›å»ºæ–° Notebookã€‚</li></ul><hr><h2 id="é«˜çº§åŠŸèƒ½-1"><a href="#é«˜çº§åŠŸèƒ½-1" class="headerlink" title="é«˜çº§åŠŸèƒ½"></a><strong>é«˜çº§åŠŸèƒ½</strong></h2><h3 id="1-JupyterHub"><a href="#1-JupyterHub" class="headerlink" title="1. JupyterHub"></a>1. <strong>JupyterHub</strong></h3><ul><li><strong>å¤šç”¨æˆ·æ”¯æŒ</strong>ï¼šå…è®¸å¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨ Jupyter Notebookï¼Œé€‚åˆæ•™è‚²æœºæ„æˆ–ä¼ä¸šã€‚</li><li><strong>éƒ¨ç½²æ–¹å¼</strong>ï¼šå¯é€šè¿‡ Dockerã€Kubernetes ç­‰å®¹å™¨åŒ–æŠ€æœ¯éƒ¨ç½²ã€‚</li></ul><h3 id="2-Binder"><a href="#2-Binder" class="headerlink" title="2. Binder"></a>2. <strong>Binder</strong></h3><ul><li><strong>å…è´¹åœ¨çº¿ç¯å¢ƒ</strong>ï¼šå°† GitHub ä»“åº“ä¸­çš„ Notebook ç›´æ¥è½¬æ¢ä¸ºå¯äº¤äº’çš„åœ¨çº¿ç¯å¢ƒã€‚</li><li>ç¤ºä¾‹ï¼šè®¿é—® <a href="https://mybinder.org/">mybinder.org</a> å¹¶è¾“å…¥ä»“åº“ URLã€‚</li></ul><h3 id="3-æ‰©å±•ä¸æ’ä»¶"><a href="#3-æ‰©å±•ä¸æ’ä»¶" class="headerlink" title="3. æ‰©å±•ä¸æ’ä»¶"></a>3. <strong>æ‰©å±•ä¸æ’ä»¶</strong></h3><ul><li><strong>JupyterLab æ‰©å±•</strong>ï¼šå¦‚è°ƒè¯•å™¨ã€Git é›†æˆã€è¡¨æ ¼ç¼–è¾‘å™¨ç­‰ã€‚</li><li><strong>Notebook æ‰©å±•</strong>ï¼šå¦‚ä»£ç æŠ˜å ã€ç›®å½•ç”Ÿæˆç­‰ã€‚</li></ul><hr><h2 id="ä¸å…¶ä»–å·¥å…·çš„é›†æˆ"><a href="#ä¸å…¶ä»–å·¥å…·çš„é›†æˆ" class="headerlink" title="ä¸å…¶ä»–å·¥å…·çš„é›†æˆ"></a><strong>ä¸å…¶ä»–å·¥å…·çš„é›†æˆ</strong></h2><h3 id="1-ä¸-Git-é›†æˆ"><a href="#1-ä¸-Git-é›†æˆ" class="headerlink" title="1. ä¸ Git é›†æˆ"></a>1. <strong>ä¸ Git é›†æˆ</strong></h3><ul><li>é€šè¿‡ <code>nbdime</code> å·¥å…·æ¯”è¾ƒå’Œåˆå¹¶ Notebook ç‰ˆæœ¬ã€‚</li><li>åœ¨ JupyterLab ä¸­ç›´æ¥ä½¿ç”¨ Git æ’ä»¶ã€‚</li></ul><h3 id="2-ä¸äº‘å¹³å°é›†æˆ"><a href="#2-ä¸äº‘å¹³å°é›†æˆ" class="headerlink" title="2. ä¸äº‘å¹³å°é›†æˆ"></a>2. <strong>ä¸äº‘å¹³å°é›†æˆ</strong></h3><ul><li><strong>Google Colab</strong>ï¼šå…è´¹åœ¨çº¿ Jupyter ç¯å¢ƒï¼Œæ”¯æŒ GPU&#x2F;TPUã€‚</li><li><strong>AWS SageMaker</strong>ï¼šæ‰˜ç®¡ Jupyter Notebookï¼Œæ”¯æŒå¤§è§„æ¨¡è®¡ç®—ã€‚</li></ul><h3 id="3-ä¸å¤§æ•°æ®å·¥å…·é›†æˆ"><a href="#3-ä¸å¤§æ•°æ®å·¥å…·é›†æˆ" class="headerlink" title="3. ä¸å¤§æ•°æ®å·¥å…·é›†æˆ"></a>3. <strong>ä¸å¤§æ•°æ®å·¥å…·é›†æˆ</strong></h3><ul><li><strong>Spark</strong>ï¼šé€šè¿‡ PySpark å†…æ ¸åœ¨ Jupyter ä¸­è¿è¡Œ Spark ä½œä¸šã€‚</li><li><strong>Dask</strong>ï¼šç”¨äºå¹¶è¡Œè®¡ç®—ï¼Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®å¤„ç†ã€‚</li></ul><hr><h2 id="ä¼˜ç¼ºç‚¹åˆ†æ"><a href="#ä¼˜ç¼ºç‚¹åˆ†æ" class="headerlink" title="ä¼˜ç¼ºç‚¹åˆ†æ"></a><strong>ä¼˜ç¼ºç‚¹åˆ†æ</strong></h2><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h3><ol><li><strong>äº¤äº’æ€§å¼º</strong>ï¼šé€‚åˆå¿«é€Ÿè¿­ä»£å’Œå®éªŒã€‚</li><li><strong>å¯è§†åŒ–ä¸°å¯Œ</strong>ï¼šæ”¯æŒå¤šç§å›¾è¡¨å’Œäº¤äº’å¼æ§ä»¶ã€‚</li><li><strong>æ–‡æ¡£åŒ–</strong>ï¼šç»“åˆä»£ç å’Œæ–‡æœ¬ï¼Œæ–¹ä¾¿è®°å½•å’Œåˆ†äº«ã€‚</li><li><strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼šæ”¯æŒ Pythonã€Rã€Julia ç­‰å¤šç§è¯­è¨€ã€‚</li></ol><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h3><ol><li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šå¯¹äºå¤§è§„æ¨¡æ•°æ®å¤„ç†ï¼ŒNotebook å¯èƒ½ä¸å¦‚è„šæœ¬é«˜æ•ˆã€‚</li><li><strong>ç‰ˆæœ¬æ§åˆ¶å›°éš¾</strong>ï¼šNotebook æ–‡ä»¶æ˜¯ JSON æ ¼å¼ï¼Œç›´æ¥ä½¿ç”¨ Git å¯èƒ½äº§ç”Ÿå†²çªã€‚</li><li><strong>å®‰å…¨æ€§</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒJupyter æœåŠ¡å™¨å¯èƒ½æš´éœ²åœ¨å…¬ç½‘ï¼Œéœ€æ³¨æ„é…ç½®ã€‚</li></ol><hr><h2 id="æ¨èä½¿ç”¨åœºæ™¯"><a href="#æ¨èä½¿ç”¨åœºæ™¯" class="headerlink" title="æ¨èä½¿ç”¨åœºæ™¯"></a><strong>æ¨èä½¿ç”¨åœºæ™¯</strong></h2><ol><li><strong>æ•°æ®ç§‘å­¦åˆå­¦è€…</strong>ï¼šå¿«é€Ÿä¸Šæ‰‹ Python å’Œæ•°æ®åˆ†æã€‚</li><li><strong>å®éªŒæ€§é¡¹ç›®</strong>ï¼šéœ€è¦é¢‘ç¹è°ƒæ•´å‚æ•°å’Œå¯è§†åŒ–ç»“æœã€‚</li><li><strong>æ•™å­¦ä¸åŸ¹è®­</strong>ï¼šç¼–å†™äº¤äº’å¼æ•™ç¨‹ã€‚</li><li><strong>æŠ€æœ¯æ–‡æ¡£</strong>ï¼šç»“åˆä»£ç ç¤ºä¾‹å’Œè§£é‡Šã€‚</li></ol><hr><h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p>Jupyter æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»çš„äº¤äº’å¼è®¡ç®—ç¯å¢ƒï¼Œé€‚åˆæ•°æ®ç§‘å­¦ã€ç§‘å­¦è®¡ç®—å’Œæ•™è‚²é¢†åŸŸã€‚é€šè¿‡ Jupyter Notebook å’Œ JupyterLabï¼Œç”¨æˆ·å¯ä»¥ä»¥äº¤äº’å¼çš„æ–¹å¼ç¼–å†™ä»£ç ã€å¯è§†åŒ–æ•°æ®å¹¶è®°å½•ç»“æœã€‚å°½ç®¡å­˜åœ¨ä¸€äº›æ€§èƒ½å’Œç‰ˆæœ¬æ§åˆ¶çš„æŒ‘æˆ˜ï¼Œä½†é€šè¿‡åˆç†ä½¿ç”¨å·¥å…·å’Œæœ€ä½³å®è·µï¼ŒJupyter å¯ä»¥æ˜¾è‘—æé«˜å·¥ä½œæ•ˆç‡å’Œåä½œèƒ½åŠ›ã€‚</p><h3 id="æ¨èå·¥å…·ç»„åˆ"><a href="#æ¨èå·¥å…·ç»„åˆ" class="headerlink" title="æ¨èå·¥å…·ç»„åˆ"></a><strong>æ¨èå·¥å…·ç»„åˆ</strong></h3><ul><li><strong>æœ¬åœ°å¼€å‘</strong>ï¼šJupyterLab + å¸¸ç”¨æ‰©å±•ï¼ˆå¦‚ Git é›†æˆã€è°ƒè¯•å™¨ï¼‰ã€‚</li><li><strong>åœ¨çº¿åä½œ</strong>ï¼šGoogle Colab æˆ– JupyterHubã€‚</li><li><strong>å¤§è§„æ¨¡è®¡ç®—</strong>ï¼šç»“åˆ Spark&#x2F;Dask æˆ–äº‘å¹³å°ï¼ˆå¦‚ AWS SageMakerï¼‰ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7æ“ä½œç³»ç»Ÿ</title>
      <link href="/2025/05/16/CentOS7%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
      <url>/2025/05/16/CentOS7%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ä»¶ç›®å½•ç±»"><a href="#æ–‡ä»¶ç›®å½•ç±»" class="headerlink" title="æ–‡ä»¶ç›®å½•ç±»"></a>æ–‡ä»¶ç›®å½•ç±»</h1><h2 id="Linuxç›®å½•ç»“æ„"><a href="#Linuxç›®å½•ç»“æ„" class="headerlink" title="Linuxç›®å½•ç»“æ„"></a>Linuxç›®å½•ç»“æ„</h2><ol><li><p>linuxçš„ç›®å½•æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹ç›®å½• &#x2F;</p></li><li><p>linuxçš„å„ä¸ªç›®å½•å­˜æ”¾çš„å†…å®¹çš„è§„åˆ’å¥½çš„, ä¸ç”¨ä¹±æ”¾æ–‡ä»¶</p></li><li><p>linuxæ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼ç®¡ç†æˆ‘ä»¬çš„è®¾å¤‡, å› æ­¤linuxç³»ç»Ÿ, ä¸€åˆ‡çš†ä¸ºæ–‡ä»¶</p></li><li><p>linuxçš„å„ä¸ªç›®å½•ä¸‹å­˜æ”¾ä»€ä¹ˆå†…å®¹, å¤§å®¶å¿…é¡»æœ‰ä¸€ä¸ªè®¤è¯†</p></li><li><p>å­¦ä¹ å, ä½ çš„è„‘æµ·é‡Œåº”è¯¥æœ‰ä¸€æ£µlinuxç›®å½•æ ‘</p></li></ol><table><thead><tr><th>ç›®å½•</th><th>åŠŸèƒ½</th><th>ç›®å½•</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>&#x2F;</td><td>æ ¹ç›®å½•ç³»ç»Ÿçš„èµ·ç‚¹åŒ…å«æ‰€æœ‰å…¶ä»–ç›®å½•</td><td>&#x2F;opt</td><td>å¯é€‰çš„ç¬¬ä¸‰æ–¹è½¯ä»¶</td></tr><tr><td>&#x2F;bin</td><td>å­˜æ”¾åŸºæœ¬å’Œç³»ç»Ÿçº§çš„å¯æ‰§è¡Œæ–‡ä»¶</td><td>&#x2F;proc</td><td>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæä¾›ç³»ç»Ÿä¿¡æ¯</td></tr><tr><td>&#x2F;boot</td><td>å¯åŠ¨ç›¸å…³æ–‡ä»¶</td><td>&#x2F;root</td><td>rootç”¨æˆ·çš„ä¸»ç›®å½•</td></tr><tr><td>&#x2F;dev</td><td>è®¾å¤‡æ–‡ä»¶</td><td>&#x2F;run</td><td>è¿è¡Œæ—¶æ•°æ®</td></tr><tr><td>&#x2F;etc</td><td>ç³»ç»Ÿé…ç½®æ–‡ä»¶</td><td>&#x2F;tmp</td><td>ä¸´æ—¶æ–‡ä»¶</td></tr><tr><td>&#x2F;home</td><td>ç”¨æˆ·çš„ä¸»ç›®å½•</td><td>&#x2F;usr</td><td>ç”¨æˆ·çº§åº”ç”¨ç¨‹åºå’Œæ•°æ®</td></tr><tr><td>&#x2F;lib</td><td>å…±äº«åº“æ–‡ä»¶</td><td>&#x2F;var</td><td>å¯å˜æ•°æ®ï¼Œå¦‚æ—¥å¿—å’Œç¼“å­˜</td></tr><tr><td>&#x2F;mnt</td><td>æŒ‚è½½ç‚¹</td><td></td><td></td></tr></tbody></table><h2 id="optä¸-usrçš„åŒºåˆ«"><a href="#optä¸-usrçš„åŒºåˆ«" class="headerlink" title="&#x2F;optä¸&#x2F;usrçš„åŒºåˆ«"></a>&#x2F;optä¸&#x2F;usrçš„åŒºåˆ«</h2><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<code>/opt</code> å’Œ <code>/usr</code> æ˜¯ä¸¤ä¸ªé‡è¦çš„ç›®å½•ï¼Œä½†å®ƒä»¬çš„ä½œç”¨å’Œä½¿ç”¨åœºæ™¯æœ‰æ˜¾è‘—çš„åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„è¯¦ç»†å¯¹æ¯”ï¼š</p><hr><h3 id="1-usr-ç›®å½•"><a href="#1-usr-ç›®å½•" class="headerlink" title="1. /usr ç›®å½•"></a><strong>1. <code>/usr</code> ç›®å½•</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼š<ul><li><code>/usr</code>ï¼ˆUnix System Resourcesï¼‰æ˜¯ <strong>ç³»ç»Ÿçº§è½¯ä»¶èµ„æº</strong> çš„æ ‡å‡†å­˜æ”¾ç›®å½•ï¼ŒåŒ…å«å¤§å¤šæ•°ç”¨æˆ·åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿå·¥å…·ã€‚</li><li>ç”± <strong>ç³»ç»ŸåŒ…ç®¡ç†å™¨</strong>ï¼ˆå¦‚ <code>apt</code>ã€<code>yum</code>ã€<code>dnf</code>ï¼‰å®‰è£…çš„è½¯ä»¶é€šå¸¸ä¼šæ”¾åœ¨è¿™é‡Œã€‚</li><li>éµå¾ª <strong>Filesystem Hierarchy Standard (FHS)</strong> è§„èŒƒï¼Œç»“æ„ä¸¥æ ¼ï¼ŒæŒ‰æ–‡ä»¶ç±»å‹åˆ†ç›®å½•ã€‚</li></ul></li><li><strong>å…¸å‹å­ç›®å½•</strong>ï¼š<ul><li><code>/usr/bin</code>ï¼šç”¨æˆ·å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚ <code>ls</code>ã€<code>gcc</code>ï¼‰ã€‚</li><li><code>/usr/lib</code>ï¼šå…±äº«åº“æ–‡ä»¶ï¼ˆ<code>.so</code> æ–‡ä»¶ï¼‰ã€‚</li><li><code>/usr/share</code>ï¼šæ¶æ„æ— å…³çš„å…±äº«æ•°æ®ï¼ˆæ–‡æ¡£ã€å›¾æ ‡ã€å­—ä½“ç­‰ï¼‰ã€‚</li><li><code>/usr/include</code>ï¼šå¤´æ–‡ä»¶ï¼ˆç”¨äºå¼€å‘ï¼‰ã€‚</li><li><code>/usr/local</code>ï¼šç”¨æˆ·æ‰‹åŠ¨ç¼–è¯‘å®‰è£…çš„è½¯ä»¶ï¼ˆä¸åŒ…ç®¡ç†å™¨å®‰è£…çš„è½¯ä»¶éš”ç¦»ï¼‰ã€‚</li></ul></li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>ç³»ç»Ÿçº§ç®¡ç†</strong>ï¼šç”±åŒ…ç®¡ç†å™¨ç»´æŠ¤ï¼Œæ›´æ–°æˆ–å¸è½½è½¯ä»¶æ—¶è‡ªåŠ¨å¤„ç†ä¾èµ–ã€‚</li><li><strong>æ ‡å‡†åŒ–ç»“æ„</strong>ï¼šæ–‡ä»¶æŒ‰ç±»å‹åˆ†æ•£åˆ°ä¸åŒå­ç›®å½•ï¼ˆå¦‚äºŒè¿›åˆ¶æ–‡ä»¶ã€åº“æ–‡ä»¶åˆ†å¼€å­˜æ”¾ï¼‰ã€‚</li><li><strong>å†å²åŸå› </strong>ï¼šæ—©æœŸ Unix ç³»ç»Ÿçš„æ ¸å¿ƒç›®å½•ï¼Œè®¾è®¡ç›®æ ‡æ˜¯å…±äº«ã€åªè¯»ï¼ˆå¯ç½‘ç»œæŒ‚è½½ï¼‰ã€‚</li></ul></li></ul><hr><h3 id="2-opt-ç›®å½•"><a href="#2-opt-ç›®å½•" class="headerlink" title="2. /opt ç›®å½•"></a><strong>2. <code>/opt</code> ç›®å½•</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼š<ul><li><code>/opt</code>ï¼ˆOptionalï¼‰ç”¨äºå®‰è£… <strong>ç¬¬ä¸‰æ–¹ç‹¬ç«‹è½¯ä»¶åŒ…</strong> æˆ– <strong>éç³»ç»Ÿé›†æˆçš„åº”ç”¨ç¨‹åº</strong>ã€‚</li><li>é€šå¸¸å­˜æ”¾é‚£äº› <strong>ä¸é€šè¿‡ç³»ç»ŸåŒ…ç®¡ç†å™¨å®‰è£…</strong> çš„è½¯ä»¶ï¼ˆå¦‚å•†ä¸šè½¯ä»¶ã€è‡ªè¡Œç¼–è¯‘çš„å¤§å‹åº”ç”¨ï¼‰ã€‚</li><li>æ¯ä¸ªè½¯ä»¶åœ¨ <code>/opt</code> ä¸‹æœ‰è‡ªå·±çš„ç‹¬ç«‹å­ç›®å½•ï¼ˆå¦‚ <code>/opt/google/chrome</code>ï¼‰ã€‚</li></ul></li><li><strong>å…¸å‹å†…å®¹</strong>ï¼š<ul><li>ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼ˆå¦‚ MATLABã€IntelliJ IDEAã€Google Chromeï¼‰ã€‚</li><li>æŸäº›å®¹å™¨åŒ–å·¥å…·ï¼ˆå¦‚æ—©æœŸ Docker ç‰ˆæœ¬ï¼‰æˆ–é—­æºè½¯ä»¶ã€‚</li></ul></li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>ç‹¬ç«‹å­˜æ”¾</strong>ï¼šæ¯ä¸ªè½¯ä»¶çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶ã€åº“ã€æ•°æ®ï¼‰é›†ä¸­åœ¨ä¸€ä¸ªå­ç›®å½•ä¸­ã€‚</li><li><strong>æ‰‹åŠ¨ç®¡ç†</strong>ï¼šå®‰è£…å’Œå¸è½½é€šå¸¸éœ€æ‰‹åŠ¨æ“ä½œï¼ˆå¦‚è§£å‹æˆ–è¿è¡Œå®‰è£…è„šæœ¬ï¼‰ã€‚</li><li><strong>é¿å…æ±¡æŸ“ç³»ç»Ÿè·¯å¾„</strong>ï¼šä¸ç³»ç»Ÿè½¯ä»¶éš”ç¦»ï¼Œå‡å°‘ä¾èµ–å†²çªé£é™©ã€‚</li></ul></li></ul><hr><h3 id="3-å…³é”®åŒºåˆ«"><a href="#3-å…³é”®åŒºåˆ«" class="headerlink" title="3. å…³é”®åŒºåˆ«"></a><strong>3. å…³é”®åŒºåˆ«</strong></h3><table><thead><tr><th align="left"><strong>å¯¹æ¯”é¡¹</strong></th><th align="left"><code>/usr</code></th><th align="left"><code>/opt</code></th></tr></thead><tbody><tr><td align="left"><strong>ç”¨é€”</strong></td><td align="left">ç³»ç»Ÿçº§è½¯ä»¶ï¼ˆåŒ…ç®¡ç†å™¨å®‰è£…ï¼‰</td><td align="left">ç¬¬ä¸‰æ–¹ç‹¬ç«‹è½¯ä»¶ï¼ˆæ‰‹åŠ¨å®‰è£…ï¼‰</td></tr><tr><td align="left"><strong>ç»“æ„</strong></td><td align="left">æŒ‰æ–‡ä»¶ç±»å‹åˆ†æ•£åˆ°å­ç›®å½•</td><td align="left">æ¯ä¸ªè½¯ä»¶ç‹¬å ä¸€ä¸ªå­ç›®å½•</td></tr><tr><td align="left"><strong>ç®¡ç†æ–¹å¼</strong></td><td align="left">åŒ…ç®¡ç†å™¨è‡ªåŠ¨ç®¡ç†</td><td align="left">æ‰‹åŠ¨ç»´æŠ¤ï¼ˆéœ€ç”¨æˆ·å¹²é¢„ï¼‰</td></tr><tr><td align="left"><strong>éµå¾ª FHS</strong></td><td align="left">ä¸¥æ ¼éµå¾ª</td><td align="left">å…è®¸çµæ´»ç»“æ„</td></tr><tr><td align="left"><strong>å…¸å‹å†…å®¹</strong></td><td align="left">ç³»ç»Ÿå·¥å…·ã€åŸºç¡€æœåŠ¡ï¼ˆå¦‚ <code>gcc</code>ï¼‰</td><td align="left">å•†ä¸šè½¯ä»¶ã€å¤§å‹åº”ç”¨ï¼ˆå¦‚ IDEAï¼‰</td></tr></tbody></table><hr><h3 id="4-ä½¿ç”¨åœºæ™¯å»ºè®®"><a href="#4-ä½¿ç”¨åœºæ™¯å»ºè®®" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯å»ºè®®"></a><strong>4. ä½¿ç”¨åœºæ™¯å»ºè®®</strong></h3><ul><li>**ä½¿ç”¨ <code>/usr</code>**ï¼š<ul><li>é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…çš„è½¯ä»¶ï¼ˆå¦‚ <code>apt install nginx</code>ï¼‰ã€‚</li><li>éœ€è¦ç³»ç»Ÿçº§å…±äº«çš„åº“æˆ–å·¥å…·ï¼ˆå¦‚å¼€å‘å·¥å…·é“¾ï¼‰ã€‚</li></ul></li><li>**ä½¿ç”¨ <code>/opt</code>**ï¼š<ul><li>æ‰‹åŠ¨å®‰è£…çš„ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼ˆå¦‚ä¸‹è½½ <code>.tar.gz</code> è§£å‹åˆ° <code>/opt</code>ï¼‰ã€‚</li><li>å¸Œæœ›ç‹¬ç«‹ç®¡ç†ã€é¿å…ä¾èµ–å†²çªçš„è½¯ä»¶ï¼ˆå¦‚å¤šä¸ªç‰ˆæœ¬å…±å­˜ï¼‰ã€‚</li></ul></li></ul><hr><h3 id="5-è¡¥å……è¯´æ˜"><a href="#5-è¡¥å……è¯´æ˜" class="headerlink" title="5. è¡¥å……è¯´æ˜"></a><strong>5. è¡¥å……è¯´æ˜</strong></h3><ul><li><strong><code>/usr/local</code> ä¸ <code>/opt</code> çš„åŒºåˆ«</strong>ï¼š<ul><li><code>/usr/local</code> ç”¨äº <strong>ç”¨æˆ·æ‰‹åŠ¨ç¼–è¯‘å®‰è£…çš„è½¯ä»¶</strong>ï¼Œç»“æ„æ¨¡ä»¿ <code>/usr</code>ï¼ˆå¦‚ <code>/usr/local/bin</code>ï¼‰ã€‚</li><li><code>/opt</code> æ›´é€‚ç”¨äº <strong>å®Œå…¨ç‹¬ç«‹ã€è‡ªåŒ…å«çš„è½¯ä»¶åŒ…</strong>ï¼ˆæ‰€æœ‰æ–‡ä»¶é›†ä¸­åœ¨ä¸€ä¸ªç›®å½•ï¼‰ã€‚</li></ul></li><li><strong>ç¯å¢ƒå˜é‡</strong>ï¼š<ul><li>å®‰è£…åœ¨ <code>/opt</code> ä¸‹çš„è½¯ä»¶å¯èƒ½éœ€è¦æ‰‹åŠ¨æ·»åŠ è·¯å¾„åˆ° <code>PATH</code>ï¼ˆå¦‚ <code>/opt/myapp/bin</code>ï¼‰ã€‚</li><li><code>/usr/bin</code> é»˜è®¤åœ¨ç³»ç»Ÿ <code>PATH</code> ä¸­ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</li></ul></li></ul><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ul><li><strong>ç³»ç»ŸåŸç”Ÿè½¯ä»¶ã€åŒ…ç®¡ç†å™¨å®‰è£…çš„è½¯ä»¶ â†’ <code>/usr</code></strong></li><li><strong>ç¬¬ä¸‰æ–¹ç‹¬ç«‹è½¯ä»¶ã€æ‰‹åŠ¨å®‰è£…çš„å¤§å‹åº”ç”¨ â†’ <code>/opt</code></strong></li></ul><h1 id="ç”¨ä»€ä¹ˆæƒé™å®‰è£…è½¯ä»¶"><a href="#ç”¨ä»€ä¹ˆæƒé™å®‰è£…è½¯ä»¶" class="headerlink" title="ç”¨ä»€ä¹ˆæƒé™å®‰è£…è½¯ä»¶"></a>ç”¨ä»€ä¹ˆæƒé™å®‰è£…è½¯ä»¶</h1><h2 id="1-å®‰è£…åˆ°ç³»ç»Ÿçº§ç›®å½•ï¼ˆéœ€-root-æƒé™ï¼‰"><a href="#1-å®‰è£…åˆ°ç³»ç»Ÿçº§ç›®å½•ï¼ˆéœ€-root-æƒé™ï¼‰" class="headerlink" title="1. å®‰è£…åˆ°ç³»ç»Ÿçº§ç›®å½•ï¼ˆéœ€ root æƒé™ï¼‰"></a><strong>1. å®‰è£…åˆ°ç³»ç»Ÿçº§ç›®å½•ï¼ˆéœ€ root æƒé™ï¼‰</strong></h2><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œå®‰è£…ç¬¬ä¸‰æ–¹è½¯ä»¶æ—¶ä½¿ç”¨ <strong>root ç”¨æˆ·</strong>è¿˜æ˜¯<strong>æ™®é€šç”¨æˆ·</strong>å–å†³äºè½¯ä»¶çš„å®‰è£…ä½ç½®ã€ç®¡ç†æ–¹å¼ä»¥åŠå®‰å…¨æ€§éœ€æ±‚ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†åˆ†æå’Œå»ºè®®ï¼š</p><hr><p>å¦‚æœè¦å°†è½¯ä»¶å®‰è£…åˆ°ç³»ç»Ÿçº§ç›®å½•ï¼ˆå¦‚ <code>/opt</code>ã€<code>/usr/local</code> æˆ– <code>/usr/bin</code>ï¼‰ï¼Œé€šå¸¸éœ€è¦ <strong>root æƒé™</strong>ï¼Œå› ä¸ºè¿™äº›ç›®å½•é»˜è®¤å±äº <code>root</code> ç”¨æˆ·ï¼Œæ™®é€šç”¨æˆ·æ— æƒä¿®æ”¹ã€‚</p><h3 id="å…¸å‹åœºæ™¯ï¼š"><a href="#å…¸å‹åœºæ™¯ï¼š" class="headerlink" title="å…¸å‹åœºæ™¯ï¼š"></a><strong>å…¸å‹åœºæ™¯</strong>ï¼š</h3><ul><li><p><strong>é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…</strong>ï¼šä¾‹å¦‚ <code>apt</code>ã€<code>yum</code>ã€<code>dnf</code> ç­‰å·¥å…·ä¼šä¿®æ”¹ç³»ç»Ÿç›®å½•ï¼Œå¿…é¡»ä½¿ç”¨ <code>sudo</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install nginx     <span class="comment"># Debian/Ubuntu</span></span><br><span class="line"><span class="built_in">sudo</span> dnf install docker    <span class="comment"># Fedora/CentOS</span></span><br></pre></td></tr></table></figure></li><li><p>**æ‰‹åŠ¨å®‰è£…åˆ° <code>/opt</code> æˆ– <code>/usr/local</code>**ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¤ºä¾‹ï¼šå°†è½¯ä»¶åŒ…è§£å‹åˆ° /opt</span></span><br><span class="line"><span class="built_in">sudo</span> tar -xzf myapp.tar.gz -C /opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹ï¼šç¼–è¯‘å®‰è£…åˆ° /usr/local</span></span><br><span class="line">./configure --prefix=/usr/local</span><br><span class="line">make</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure></li></ul><h3 id="ç‰¹ç‚¹ï¼š"><a href="#ç‰¹ç‚¹ï¼š" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a><strong>ç‰¹ç‚¹</strong>ï¼š</h3><ul><li><strong>ç³»ç»Ÿçº§å…±äº«</strong>ï¼šæ‰€æœ‰ç”¨æˆ·å‡å¯ä½¿ç”¨å®‰è£…çš„è½¯ä»¶ã€‚</li><li><strong>ä¾èµ–é›†ä¸­ç®¡ç†</strong>ï¼šåº“æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ç­‰é›†ä¸­å­˜æ”¾ï¼Œä¾¿äºç³»ç»Ÿç»´æŠ¤ã€‚</li><li><strong>é£é™©æç¤º</strong>ï¼šä½¿ç”¨ <code>root</code> æƒé™éœ€è°¨æ…ï¼Œé¿å…å®‰è£…ä¸å¯ä¿¡æ¥æºçš„è½¯ä»¶ã€‚</li></ul><hr><h2 id="2-å®‰è£…åˆ°ç”¨æˆ·ç›®å½•ï¼ˆæ— éœ€-root-æƒé™ï¼‰"><a href="#2-å®‰è£…åˆ°ç”¨æˆ·ç›®å½•ï¼ˆæ— éœ€-root-æƒé™ï¼‰" class="headerlink" title="2. å®‰è£…åˆ°ç”¨æˆ·ç›®å½•ï¼ˆæ— éœ€ root æƒé™ï¼‰"></a><strong>2. å®‰è£…åˆ°ç”¨æˆ·ç›®å½•ï¼ˆæ— éœ€ root æƒé™ï¼‰</strong></h2><p>å¦‚æœè½¯ä»¶æ”¯æŒå®‰è£…åˆ°ç”¨æˆ·ä¸»ç›®å½•ï¼ˆå¦‚ <code>~/apps</code>ã€<code>~/.local</code> æˆ– <code>~/bin</code>ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨<strong>æ™®é€šç”¨æˆ·æƒé™</strong>ï¼Œæ— éœ€ <code>sudo</code>ã€‚</p><p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p><ul><li><p><strong>ç‹¬ç«‹è½¯ä»¶åŒ…</strong>ï¼šå¦‚ Python çš„ <code>pip install --user</code>ã€Node.js çš„ <code>npm install -g</code>ï¼ˆé…åˆç”¨æˆ·ç›®å½•ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… Python åŒ…åˆ°ç”¨æˆ·ç›®å½• ~/.local</span></span><br><span class="line">  pip install --user requests</span><br><span class="line"></span><br><span class="line">  <span class="comment"># å®‰è£… Node.js å…¨å±€å·¥å…·åˆ°ç”¨æˆ·ç›®å½•</span></span><br><span class="line"></span><br><span class="line">  ```bash</span><br><span class="line">npm install -g typescript --prefix ~/.npm-global</span><br><span class="line">- **æ‰‹åŠ¨è§£å‹åˆ°ä¸»ç›®å½•**ï¼š</span><br><span class="line"><span class="comment"># å°†è½¯ä»¶åŒ…è§£å‹åˆ°ç”¨æˆ·ç›®å½•</span></span><br><span class="line">  tar -xzf myapp.tar.gz -C ~/apps</span><br></pre></td></tr></table></figure></li></ul><h3 id="ç‰¹ç‚¹ï¼š-1"><a href="#ç‰¹ç‚¹ï¼š-1" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a><strong>ç‰¹ç‚¹</strong>ï¼š</h3><ul><li><strong>ç”¨æˆ·éš”ç¦»</strong>ï¼šè½¯ä»¶ä»…å¯¹å½“å‰ç”¨æˆ·å¯ç”¨ï¼Œé¿å…å½±å“å…¶ä»–ç”¨æˆ·ã€‚</li><li><strong>æ— éœ€ç®¡ç†å‘˜æƒé™</strong>ï¼šé€‚åˆæ²¡æœ‰ <code>sudo</code> æƒé™çš„åœºæ™¯ï¼ˆå¦‚å…±äº«æœåŠ¡å™¨ï¼‰ã€‚</li><li><strong>çµæ´»æ€§é«˜</strong>ï¼šå¯è‡ªç”±ç®¡ç†ç‰ˆæœ¬æˆ–å¸è½½ï¼Œä¸æ±¡æŸ“ç³»ç»Ÿç›®å½•ã€‚</li></ul><hr><h2 id="3-é€‰æ‹©-root-è¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼Ÿ"><a href="#3-é€‰æ‹©-root-è¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼Ÿ" class="headerlink" title="3. é€‰æ‹© root è¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼Ÿ"></a><strong>3. é€‰æ‹© root è¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼Ÿ</strong></h2><table><thead><tr><th align="left"><strong>åœºæ™¯</strong></th><th align="left"><strong>æ¨èæ–¹å¼</strong></th><th align="left"><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td align="left">é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ç³»ç»Ÿå·¥å…·</td><td align="left"><code>sudo</code> + root æƒé™</td><td align="left"><code>sudo apt install vim</code></td></tr><tr><td align="left">æ‰‹åŠ¨å®‰è£…åˆ° <code>/opt</code> æˆ–ç³»ç»Ÿç›®å½•</td><td align="left"><code>sudo</code> + root æƒé™</td><td align="left"><code>sudo ./install.sh</code></td></tr><tr><td align="left">å¼€å‘å·¥å…·é“¾æˆ–å…¨å±€æœåŠ¡ï¼ˆå¦‚ Dockerï¼‰</td><td align="left"><code>sudo</code> + root æƒé™</td><td align="left"><code>sudo snap install docker</code></td></tr><tr><td align="left">ç”¨æˆ·çº§åº”ç”¨ï¼ˆå¦‚ Python åŒ…ï¼‰</td><td align="left">æ™®é€šç”¨æˆ·æƒé™</td><td align="left"><code>pip install --user pandas</code></td></tr><tr><td align="left">æµ‹è¯•æˆ–ä¸´æ—¶ä½¿ç”¨</td><td align="left">æ™®é€šç”¨æˆ·æƒé™ï¼ˆç”¨æˆ·ç›®å½•ï¼‰</td><td align="left"><code>./myapp --install-dir ~/apps</code></td></tr></tbody></table><hr><h2 id="4-å®‰å…¨æ€§å»ºè®®"><a href="#4-å®‰å…¨æ€§å»ºè®®" class="headerlink" title="4. å®‰å…¨æ€§å»ºè®®"></a><strong>4. å®‰å…¨æ€§å»ºè®®</strong></h2><ul><li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šå°½é‡ä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™å®‰è£…ï¼Œä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ <code>sudo</code>ã€‚</li><li><strong>éªŒè¯è½¯ä»¶æ¥æº</strong>ï¼šç¡®ä¿ç¬¬ä¸‰æ–¹è½¯ä»¶æ¥è‡ªå¯ä¿¡æ¸ é“ï¼Œé¿å…ææƒæ“ä½œå¼•å…¥æ¶æ„ä»£ç ã€‚</li><li><strong>éš”ç¦»ç¯å¢ƒ</strong>ï¼šå¯¹å¼€å‘æˆ–æµ‹è¯•åœºæ™¯ï¼Œä¼˜å…ˆä½¿ç”¨å®¹å™¨ï¼ˆDockerï¼‰æˆ–è™šæ‹Ÿç¯å¢ƒï¼ˆPython venvã€Node.js nvmï¼‰ã€‚</li></ul><hr><h2 id="5-å¸¸è§é—®é¢˜è§£å†³"><a href="#5-å¸¸è§é—®é¢˜è§£å†³" class="headerlink" title="5. å¸¸è§é—®é¢˜è§£å†³"></a><strong>5. å¸¸è§é—®é¢˜è§£å†³</strong></h2><h3 id="æƒé™è¢«æ‹’ç»ï¼ˆPermission-Deniedï¼‰"><a href="#æƒé™è¢«æ‹’ç»ï¼ˆPermission-Deniedï¼‰" class="headerlink" title="æƒé™è¢«æ‹’ç»ï¼ˆPermission Deniedï¼‰"></a><strong>æƒé™è¢«æ‹’ç»ï¼ˆPermission Deniedï¼‰</strong></h3><ul><li><strong>é—®é¢˜</strong>ï¼šå°è¯•å®‰è£…åˆ°ç³»ç»Ÿç›®å½•æ—¶æç¤ºæƒé™ä¸è¶³ã€‚</li><li><strong>è§£å†³</strong>ï¼šä½¿ç”¨ <code>sudo</code> æå‡æƒé™ï¼Œæˆ–æ›´æ¢å®‰è£…ç›®å½•åˆ°ç”¨æˆ·ä¸»ç›®å½•ã€‚</li></ul><h3 id="å®‰è£…åå‘½ä»¤æœªæ‰¾åˆ°ï¼ˆCommand-Not-Foundï¼‰"><a href="#å®‰è£…åå‘½ä»¤æœªæ‰¾åˆ°ï¼ˆCommand-Not-Foundï¼‰" class="headerlink" title="å®‰è£…åå‘½ä»¤æœªæ‰¾åˆ°ï¼ˆCommand Not Foundï¼‰"></a><strong>å®‰è£…åå‘½ä»¤æœªæ‰¾åˆ°ï¼ˆCommand Not Foundï¼‰</strong></h3><ul><li><p><strong>é—®é¢˜</strong>ï¼šå®‰è£…åˆ°ç”¨æˆ·ç›®å½•çš„è½¯ä»¶æ— æ³•ç›´æ¥è¿è¡Œã€‚</p></li><li><p><strong>è§£å†³</strong>ï¼šå°†ç”¨æˆ·ç›®å½•çš„ <code>bin</code> è·¯å¾„æ·»åŠ åˆ° <code>PATH</code> ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚ï¼Œå°† ~/.local/bin æ·»åŠ åˆ° PATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$HOME/.local/bin:$PATH&quot;&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><ul><li><strong>éœ€è¦ç³»ç»Ÿçº§å®‰è£… â†’ ä½¿ç”¨ <code>sudo</code> æˆ– root ç”¨æˆ·</strong>ï¼ˆå¦‚ <code>/opt</code>ã€<code>/usr/local</code>ï¼‰ã€‚</li><li><strong>ä»…é™å½“å‰ç”¨æˆ·ä½¿ç”¨ â†’ æ™®é€šç”¨æˆ·æƒé™å®‰è£…åˆ°ä¸»ç›®å½•</strong>ã€‚</li><li><strong>ä¼˜å…ˆé€‰æ‹©å®‰å…¨çš„æ–¹å¼</strong>ï¼šé¿å…æ»¥ç”¨ <code>root</code>ï¼Œå°½é‡éš”ç¦»ç”¨æˆ·çº§åº”ç”¨ã€‚</li></ul><table><thead><tr><th><strong>å‘½ä»¤</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>shutdown â€“h now</td><td>ç«‹è¯¥è¿›è¡Œå…³æœº</td></tr><tr><td>shutdown -h 1</td><td>â€œhello, 1 åˆ†é’Ÿåä¼šå…³æœºäº†â€</td></tr><tr><td>shutdown â€“r now</td><td>ç°åœ¨é‡æ–°å¯åŠ¨è®¡ç®—æœº</td></tr><tr><td>halt f</td><td>å…³æœºå‘½ä»¤</td></tr><tr><td>reboot</td><td>ç°åœ¨é‡æ–°å¯åŠ¨è®¡ç®—æœº</td></tr><tr><td>sync</td><td>æŠŠå†…å­˜çš„æ•°æ®åŒæ­¥åˆ°ç£ç›˜.</td></tr><tr><td>init 0</td><td>ç«‹è¯¥è¿›è¡Œå…³æœº</td></tr><tr><td>init 6</td><td>ç°åœ¨é‡æ–°å¯åŠ¨è®¡ç®—æœº</td></tr><tr><td>init 1</td><td>å•ç”¨æˆ·æ¨¡å¼ã€‚ä»…å¯åŠ¨æœ€åŸºæœ¬çš„ç³»ç»ŸæœåŠ¡ï¼ˆæ— ç½‘ç»œã€æ— å¤šç”¨æˆ·ç™»å½•ï¼‰ï¼Œé€šå¸¸ç”¨äºç³»ç»Ÿä¿®å¤ï¼ˆå¦‚å¯†ç æ‰¾å›ã€æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ç­‰ï¼‰ï¼Œæ— éœ€è¾“å…¥å¯†ç å³å¯ç™»å½• root è´¦æˆ·ã€‚</td></tr><tr><td>init 2</td><td>å¤šç”¨æˆ·æ¨¡å¼ã€‚å¯åŠ¨å¤šç”¨æˆ·ç¯å¢ƒï¼Œä½†ä¸åŠ è½½ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼‰æœåŠ¡ï¼Œéƒ¨åˆ†å‘è¡Œç‰ˆä¸­å¯èƒ½ä¸<code>init 3</code>åŠŸèƒ½æ¥è¿‘ï¼ˆéœ€ç»“åˆå…·ä½“ç³»ç»Ÿé…ç½®ï¼‰ã€‚</td></tr><tr><td>init 3</td><td>å®Œå…¨å¤šç”¨æˆ·æ¨¡å¼ï¼ˆæ–‡æœ¬ç•Œé¢ï¼‰ã€‚å¯åŠ¨å®Œæ•´çš„å¤šç”¨æˆ·ç¯å¢ƒï¼Œæ”¯æŒç½‘ç»œæœåŠ¡ï¼Œä½†é»˜è®¤è¿›å…¥æ–‡æœ¬å‘½ä»¤è¡Œç•Œé¢ï¼ˆæ— å›¾å½¢æ¡Œé¢ï¼‰ã€‚</td></tr><tr><td>init 5</td><td>å¤šç”¨æˆ·æ¨¡å¼ï¼ˆå›¾å½¢ç•Œé¢ï¼‰ã€‚åœ¨<code>init 3</code>çš„åŸºç¡€ä¸Šï¼Œé¢å¤–å¯åŠ¨å›¾å½¢æ¡Œé¢ç¯å¢ƒï¼ˆå¦‚ GNOMEã€KDE ç­‰ï¼‰ï¼Œé»˜è®¤è¿›å…¥å›¾å½¢ç™»å½•ç•Œé¢ã€‚</td></tr></tbody></table><h2 id="cd-åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•"><a href="#cd-åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•" class="headerlink" title="cd åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•"></a><strong>cd</strong> <strong>åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~ æˆ–è€…<span class="built_in">cd</span> å›åˆ°è‡ªå·±çš„å®¶ç›®å½•</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ../ å›åˆ°å½“å‰ç›®å½•çš„ä¸Šä¸€çº§ç›®å½•</span><br></pre></td></tr></table></figure><h2 id="pwd-ç°åœ¨æ‰€åœ¨çš„ç›®å½•ä½ç½®"><a href="#pwd-ç°åœ¨æ‰€åœ¨çš„ç›®å½•ä½ç½®" class="headerlink" title="pwd ç°åœ¨æ‰€åœ¨çš„ç›®å½•ä½ç½®"></a><strong>pwd</strong> <strong>ç°åœ¨æ‰€åœ¨çš„ç›®å½•ä½ç½®</strong></h2><h3 id="lsæŸ¥çœ‹å†…å®¹"><a href="#lsæŸ¥çœ‹å†…å®¹" class="headerlink" title="lsæŸ¥çœ‹å†…å®¹"></a><strong>ls</strong>æŸ¥çœ‹å†…å®¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -a all,æ˜¾ç¤ºå…¨éƒ¨åŒ…æ‹¬éšè—æ–‡ä»¶(éšè—æ–‡ä»¶ä»¥.å¼€å¤´)</span><br><span class="line"><span class="built_in">ls</span> -l ç­‰äº ll æ˜¾ç¤ºé•¿æ ¼å¼å±æ€§</span><br><span class="line"><span class="built_in">ls</span> -r åå‘æ’åº</span><br><span class="line"><span class="built_in">ls</span> -S æŒ‰ç…§å ç£ç›˜å¤§å°ä»å¤§åˆ°å°æ’åº</span><br><span class="line"><span class="built_in">ls</span> -t ä»¥æ—¶é—´æ’åºï¼ˆç”±æ–°åˆ°æ—§ï¼‰</span><br><span class="line"><span class="built_in">ls</span> -lh humanæ˜¾ç¤ºå¯è¯»çš„æ–‡ä»¶å¤§å°</span><br><span class="line">æŒ‡å®šè·¯å¾„æŸ¥çœ‹</span><br><span class="line"><span class="built_in">ls</span> /home/test</span><br></pre></td></tr></table></figure><h2 id="mkdir-åˆ›å»ºç›®å½•"><a href="#mkdir-åˆ›å»ºç›®å½•" class="headerlink" title="mkdir åˆ›å»ºç›®å½•"></a><strong>mkdir</strong> <strong>åˆ›å»ºç›®å½•</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> a åˆ›å»ºä¸€ä¸ªç›®å½• <span class="built_in">mkdir</span> b c åŒæ—¶åˆ›å»ºå¤šä¸ªç›®å½•</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p d/e åˆ›å»ºå¤šçº§ç›®å½•æˆ–ç§°ä¸ºé€’å½’åˆ›å»º</span><br></pre></td></tr></table></figure><h2 id="touch-åˆ›å»ºç©ºæ–‡ä»¶"><a href="#touch-åˆ›å»ºç©ºæ–‡ä»¶" class="headerlink" title="touch åˆ›å»ºç©ºæ–‡ä»¶"></a><strong>touch</strong> <strong>åˆ›å»ºç©ºæ–‡ä»¶</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> name.txt</span><br><span class="line"><span class="built_in">touch</span> &#123;1..5&#125;.txt</span><br><span class="line"></span><br><span class="line">é€šé…ç¬¦---é…åˆæ–‡ä»¶ååŠç›®å½•ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">ï¼ŸåŒ¹é…ä¸€ä¸ªå­—ç¬¦ f?.txt</span><br><span class="line">\* åŒ¹é…å…¨éƒ¨å­—ç¬¦ *.txt</span><br><span class="line"></span><br><span class="line">&#123;1..10&#125; 1åˆ°10</span><br><span class="line">&#123;a..z&#125; a b c ...z</span><br><span class="line">&#123;A..Z&#125; A B C .....Z</span><br></pre></td></tr></table></figure><p>##<strong>rm</strong> <strong>åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•åŠå…¶ä¸‹å±çš„æ‰€æœ‰æ–‡ä»¶åŠå…¶å­ç›®å½•å‡åˆ é™¤æ‰;</span><br><span class="line"></span><br><span class="line">å¯¹äºé“¾æ¥æ–‡ä»¶ï¼Œåªæ˜¯åˆ é™¤æ•´ä¸ªé“¾æ¥æ–‡ä»¶ï¼Œè€ŒåŸæœ‰æ–‡ä»¶ä¿æŒä¸å˜</span><br><span class="line"></span><br><span class="line">-fï¼šå¼ºåˆ¶åˆ é™¤ï¼›</span><br><span class="line">-rï¼šé€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸å­ç›®å½•ä¸€å¹¶å¤„ç†ï¼ˆåˆ ç›®å½•ï¼‰ï¼›</span><br><span class="line"><span class="built_in">rm</span> t.txt åˆ é™¤æ–‡ä»¶</span><br><span class="line"><span class="built_in">rm</span> -r a åˆ é™¤aç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰åŠå…¶é‡Œé¢çš„æ–‡ä»¶åŠå­ç›®å½•</span><br><span class="line"><span class="built_in">rm</span> -rf * å¼ºåˆ¶åˆ é™¤æ–‡ä»¶å¤¹ä¸‹é¢çš„å­ç›®å½•å’Œæ–‡ä»¶</span><br><span class="line"><span class="built_in">rm</span> -rf q*å¼ºåˆ¶åˆ é™¤ä»¥qå¼€å¤´çš„æ–‡ä»¶å¤¹åŠä¸‹é¢çš„å­ç›®å½•å’Œæ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="mv-ç§»åŠ¨æ–‡ä»¶å’Œç›®å½•-æˆ–è€…é‡å‘½å"><a href="#mv-ç§»åŠ¨æ–‡ä»¶å’Œç›®å½•-æˆ–è€…é‡å‘½å" class="headerlink" title="mv ç§»åŠ¨æ–‡ä»¶å’Œç›®å½•, æˆ–è€…é‡å‘½å"></a><strong>mv</strong> <strong>ç§»åŠ¨æ–‡ä»¶å’Œç›®å½•</strong>, <strong>æˆ–è€…é‡å‘½å</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> a b</span><br><span class="line"><span class="built_in">mv</span> a c/</span><br><span class="line"><span class="built_in">mv</span> a.txt b.txt</span><br><span class="line"><span class="built_in">mv</span> b.txt ../c.txt</span><br></pre></td></tr></table></figure><h2 id="cp-æ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•"><a href="#cp-æ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•" class="headerlink" title="cp æ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•"></a><strong>cp</strong> <strong>æ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -r é€’å½’æ‹·è´ç›®å½•ï¼ˆå¤åˆ¶åŒ…æ‹¬æ‰€æœ‰å­æ–‡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨ï¼‰</span><br><span class="line"><span class="built_in">cp</span> a.txt b/a.txt</span><br><span class="line"><span class="built_in">cp</span> a.txt b/b.txt</span><br><span class="line"><span class="built_in">cp</span> -r /root/a /root/b</span><br></pre></td></tr></table></figure><h2 id="ln-è½¯è¿æ¥-ç±»ä¼¼winå¿«æ·æ–¹å¼"><a href="#ln-è½¯è¿æ¥-ç±»ä¼¼winå¿«æ·æ–¹å¼" class="headerlink" title="ln è½¯è¿æ¥,ç±»ä¼¼winå¿«æ·æ–¹å¼"></a><strong>ln</strong> <strong>è½¯è¿æ¥</strong>,<em>ç±»ä¼¼</em>winå¿«æ·æ–¹å¼</h2><h3 id="ä»€ä¹ˆæ˜¯è½¯è¿æ¥ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è½¯è¿æ¥ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è½¯è¿æ¥ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è½¯è¿æ¥ï¼Ÿ</h3><p>è½¯è¿æ¥æ˜¯Linuxç³»ç»Ÿä¸Šçš„å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚</p><p>è¿™å’Œ Windows ç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼æœ‰ç‚¹ç±»ä¼¼ï¼Œé“¾æ¥æ–‡ä»¶ä¸­è®°å½•çš„åªæ˜¯åŸå§‹æ–‡ä»¶çš„è·¯å¾„ï¼Œå¹¶ä¸è®°å½•åŸå§‹æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>ä¾‹å­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/test</span><br><span class="line"><span class="built_in">ln</span> -s /home/test ceshi</span><br><span class="line"><span class="built_in">cd</span> ceshi</span><br></pre></td></tr></table></figure><h3 id="ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥ï¼Ÿ</h3><p>ç¡¬é“¾æ¥æ˜¯åŸå§‹æ–‡ä»¶çš„ä¸€ä¸ªé•œåƒå‰¯æœ¬ã€‚åˆ›å»ºç¡¬é“¾æ¥åï¼Œå¦‚æœæŠŠåŸå§‹æ–‡ä»¶åˆ é™¤ï¼Œé“¾æ¥æ–‡ä»¶ä¹Ÿä¸ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºæ­¤æ—¶åŸå§‹æ–‡ä»¶å’Œé“¾æ¥æ–‡ä»¶äº’ä¸ºé•œåƒå‰¯æœ¬ã€‚</p><h2 id="vim-ç¼–è¾‘æ–‡ä»¶"><a href="#vim-ç¼–è¾‘æ–‡ä»¶" class="headerlink" title="vim ç¼–è¾‘æ–‡ä»¶"></a><strong>vim</strong> <strong>ç¼–è¾‘æ–‡ä»¶</strong></h2><p><img src="/2025/05/16/CentOS7%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20250517184224613.png" alt="image-20250517184224613"></p><h3 id="è¿›å…¥ä¸€èˆ¬æ¨¡å¼åï¼Œå¯åœ¨é”®ç›˜è¾“å…¥ï¼Œå®ç°åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ã€‚"><a href="#è¿›å…¥ä¸€èˆ¬æ¨¡å¼åï¼Œå¯åœ¨é”®ç›˜è¾“å…¥ï¼Œå®ç°åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ã€‚" class="headerlink" title="è¿›å…¥ä¸€èˆ¬æ¨¡å¼åï¼Œå¯åœ¨é”®ç›˜è¾“å…¥ï¼Œå®ç°åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ã€‚"></a><strong>è¿›å…¥ä¸€èˆ¬æ¨¡å¼åï¼Œå¯åœ¨é”®ç›˜è¾“å…¥ï¼Œå®ç°åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ã€‚</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„è¡Œ,ä¸”ä¿å­˜åˆ°å‰ªè´´æ¿</span><br><span class="line">3dd åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„ä¸‰è¡Œ,ä¸”ä¿å­˜åˆ°å‰ªè´´æ¿</span><br><span class="line">yyå¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„è¡Œ</span><br><span class="line">4yyå¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„è¿ç»­4è¡Œ</span><br><span class="line">pï¼ˆå°å†™ï¼‰ å°†å·²å¤åˆ¶çš„å†…å®¹åœ¨å…‰æ ‡çš„ä¸‹ä¸€è¡Œç²˜è´´</span><br><span class="line">Pï¼ˆå¤§å†™ï¼‰å°†å·²å¤åˆ¶çš„å†…å®¹åœ¨å…‰æ ‡çš„ä¸Šä¸€è¡Œç²˜è´´</span><br><span class="line">x,Xï¼šåœ¨ä¸€è¡Œå­—ä¸­ï¼Œx ä¸ºå‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼ˆç›¸å½“äº[Del]é”®ï¼‰ï¼ŒX ä¸ºå‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼ˆç›¸å½“äº[Backspace]ï¼‰ä¹Ÿå¯5xç­‰</span><br><span class="line">Gå…‰æ ‡å¿«é€Ÿå®šä½åˆ°æœ€åä¸€è¡Œ</span><br><span class="line">gg å…‰æ ‡å¿«é€Ÿå®šä½åˆ°ç¬¬ä¸€è¡Œ</span><br><span class="line">u æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ</span><br></pre></td></tr></table></figure><h3 id="å‘½ä»¤è¡Œæ¨¡å¼"><a href="#å‘½ä»¤è¡Œæ¨¡å¼" class="headerlink" title="å‘½ä»¤è¡Œæ¨¡å¼"></a><strong>å‘½ä»¤è¡Œæ¨¡å¼</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">q ä¸ä¿å­˜é€€å‡º åé¢åŠ ï¼ä¸ºå¼ºåˆ¶é€€å‡º</span><br><span class="line">wq ä¿å­˜åé€€å‡º åé¢åŠ ï¼ä¸ºå¼ºåˆ¶ä¿å­˜åé€€å‡º</span><br><span class="line">ï¼å¼ºåˆ¶æ‰§è¡Œï¼ˆå¼ºåˆ¶é€€å‡ºï¼Œå¼ºåˆ¶ä¿å­˜ï¼‰</span><br><span class="line">:<span class="built_in">set</span> nu æ˜¾ç¤ºè¡Œå·</span><br><span class="line">:<span class="built_in">set</span> nonu å–æ¶ˆè¡Œå·</span><br><span class="line">:5 å…‰æ ‡å¿«è¯»å®šä½åˆ°ç¬¬5è¡Œ</span><br><span class="line">:nohl å»é™¤é«˜äº®æ˜¾ç¤º</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾ï¼š"><a href="#æŸ¥æ‰¾ï¼š" class="headerlink" title="æŸ¥æ‰¾ï¼š"></a><strong>æŸ¥æ‰¾ï¼š</strong></h3><p>ï¼ˆä»¥ä¸‹ç›´æ¥è¾“å…¥&#x2F;ï¼‰</p><p>&#x2F;hello æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼ŒæŒ‰nå‘ä¸‹æœç´¢ï¼ŒæŒ‰Nå‘ä¸Šæœç´¢</p><h3 id="æ›¿æ¢å­—ç¬¦ä¸²"><a href="#æ›¿æ¢å­—ç¬¦ä¸²" class="headerlink" title="æ›¿æ¢å­—ç¬¦ä¸²"></a><strong>æ›¿æ¢å­—ç¬¦ä¸²</strong></h3><p>æ›¿æ¢å­—ç¬¦ä¸²å‘½ä»¤çš„åŸºæœ¬è¯­æ³•æ˜¯ :[range]s&#x2F;â½¬æ ‡å­—ç¬¦ä¸²&#x2F;æ›¿æ¢å­—ç¬¦ä¸²&#x2F;[option]ï¼Œå…¶ä¸­rangeå’Œoptionå­—æ®µéƒ½å¯ä»¥ç¼ºçœä¸å¡«ï¼Œé—´éš”ç¬¦é™¤äº†&#x2F;è¿˜å¯ä»¥æ˜¯å…¶ä»–çš„ã€‚</p><ul><li><p>rangeï¼šè¡¨â½°æœç´¢èŒƒå›´ï¼Œé»˜è®¤è¡¨â½°å½“å‰â¾; 1,10è¡¨â½°ä»ç¬¬1åˆ°ç¬¬10â¾;</p></li><li><p>g è¡¨ç¤ºå…¨å±€æ›¿æ¢ï¼Œæœ‰å¤šå°‘æ¬¡æ›¿æ¢å¤šå°‘æ¬¡ï¼›æ— g åªæ›¿ä»£æ¯è¡Œç¬¬ä¸€ä¸ª</p></li><li><p>s è¡¨ç¤ºæ›¿æ¢</p></li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">:1,<span class="variable">$s</span>/nologin/88888/g</span><br><span class="line"></span><br><span class="line">:1,<span class="variable">$s</span>#nologin#88888#g</span><br><span class="line"></span><br><span class="line">æŠŠæ•´ä¸ªæ–‡ä»¶çš„nologinæ›¿æ¢æˆ888888</span><br><span class="line"></span><br><span class="line">:1,10s/nologin/88888/g</span><br><span class="line"></span><br><span class="line">æŠŠ1åˆ°10è¡Œçš„nologinæ›¿æ¢æˆ888888</span><br></pre></td></tr></table></figure><h1 id="æœç´¢æŸ¥çœ‹æŸ¥æ‰¾ç±»"><a href="#æœç´¢æŸ¥çœ‹æŸ¥æ‰¾ç±»" class="headerlink" title="æœç´¢æŸ¥çœ‹æŸ¥æ‰¾ç±»"></a>æœç´¢æŸ¥çœ‹æŸ¥æ‰¾ç±»</h1><h2 id="find-ä»æŒ‡å®šç›®å½•æŸ¥æ‰¾æ–‡ä»¶"><a href="#find-ä»æŒ‡å®šç›®å½•æŸ¥æ‰¾æ–‡ä»¶" class="headerlink" title="find ä»æŒ‡å®šç›®å½•æŸ¥æ‰¾æ–‡ä»¶"></a><strong>find</strong> <strong>ä»æŒ‡å®šç›®å½•æŸ¥æ‰¾æ–‡ä»¶</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-name &lt;æŸ¥è¯¢æ–¹å¼&gt; æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶åæŸ¥æ‰¾æ¨¡å¼æŸ¥æ‰¾æ–‡ä»¶</span><br><span class="line">-mtime n æŸ¥æ‰¾nå¤©ä»¥å‰è¢«ä¿®æ”¹è¿‡çš„æ‰€æœ‰æ–‡ä»¶ã€‚</span><br><span class="line">-<span class="built_in">exec</span>&lt;æ‰§è¡ŒæŒ‡ä»¤&gt;ï¼šå‡è®¾findæŒ‡ä»¤çš„å›ä¼ å€¼ä¸ºTrueï¼Œå°±æ‰§è¡Œè¯¥æŒ‡ä»¤ï¼›</span><br><span class="line">-size &lt;æ–‡ä»¶å¤§å°&gt; æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶å¤§å°æŸ¥æ‰¾æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>-exec åªèƒ½æ­é…findä½¿ç”¨ </p><p>ä¾‹å­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">find /root -name <span class="string">&quot;*.pdf&quot;</span></span><br><span class="line">find /root -name <span class="string">&quot;*.pdf&quot;</span> -a -size +1M</span><br><span class="line">find /root -mtime +7 <span class="comment">#ä¸ƒå¤©å‰è¢«ä¿®æ”¹è¿‡çš„æ–‡ä»¶</span></span><br><span class="line">find /root -name <span class="string">&quot;*.sql&quot;</span> -<span class="built_in">exec</span> <span class="built_in">ls</span> -l &#123;&#125; \; <span class="comment">#æŸ¥æ‰¾æ–‡ä»¶å¹¶ä»¥ls -lå½¢å¼æ˜¾ç¤º</span></span><br><span class="line">find /root -name <span class="string">&quot;*.pdf&quot;</span> -<span class="built_in">exec</span> <span class="built_in">rm</span> -f &#123;&#125; \;</span><br></pre></td></tr></table></figure><h3 id="headä¸tailæŸ¥çœ‹è¡Œ"><a href="#headä¸tailæŸ¥çœ‹è¡Œ" class="headerlink" title="headä¸tailæŸ¥çœ‹è¡Œ"></a><em>headä¸</em>tailæŸ¥çœ‹è¡Œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">head</span> -n æ–‡ä»¶å ï¼ˆä¸åŠ é»˜è®¤å¼€å¤´åè¡Œï¼‰</span><br><span class="line"><span class="built_in">tail</span> -n æ–‡ä»¶å ï¼ˆä¸åŠ é»˜è®¤ç»“å°¾åè¡Œï¼‰</span><br><span class="line"><span class="built_in">head</span> 3.txt</span><br><span class="line"><span class="built_in">tail</span> 3.txt</span><br><span class="line"><span class="built_in">head</span> -n +3 3.txt  <span class="comment">#åªæ˜¾ç¤ºå‰ä¸‰è¡Œ</span></span><br><span class="line"><span class="built_in">tail</span> -n -3 3.txt  <span class="comment">#åªæ˜¾ç¤ºåä¸‰è¡Œ</span></span><br></pre></td></tr></table></figure><h2 id="catæŸ¥çœ‹å†…å®¹"><a href="#catæŸ¥çœ‹å†…å®¹" class="headerlink" title="catæŸ¥çœ‹å†…å®¹"></a><strong>cat</strong>æŸ¥çœ‹å†…å®¹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>ï¼ˆè‹±æ–‡å…¨æ‹¼ï¼šconcatenateï¼‰å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚</span><br><span class="line">-n æ˜¾ç¤ºè¡Œå·åŒ…æ‹¬ç©ºè¡Œ</span><br><span class="line">-b è·³è¿‡ç©ºç™½è¡Œç¼–å·</span><br><span class="line">-s å°†æ‰€æœ‰çš„è¿ç»­çš„å¤šä¸ªç©ºè¡Œæ›¿æ¢ä¸ºä¸€ä¸ªç©ºè¡Œï¼ˆå‹ç¼©æˆä¸€ä¸ªç©ºè¡Œï¼‰</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> 1.<span class="built_in">log</span> 2.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">cat</span> -sb test.log</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="moreæŸ¥çœ‹å¤§å†…å®¹"><a href="#moreæŸ¥çœ‹å¤§å†…å®¹" class="headerlink" title="moreæŸ¥çœ‹å¤§å†…å®¹"></a><strong>more</strong>æŸ¥çœ‹å¤§å†…å®¹</h2><p>more åˆ†å±æŸ¥çœ‹æ–‡ä»¶ï¼ˆæ•²ç©ºæ ¼æŸ¥çœ‹ä¸‹ä¸€é¡µï¼‰</p><h2 id="grepè¿‡æ»¤æŸ¥æ‰¾"><a href="#grepè¿‡æ»¤æŸ¥æ‰¾" class="headerlink" title="grepè¿‡æ»¤æŸ¥æ‰¾"></a><strong>grep</strong>è¿‡æ»¤æŸ¥æ‰¾</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ä»¥è¡Œä¸ºå•ä½è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ˜¾ç¤ºç»“æœä¸ºæ»¡è¶³çš„è¡Œ</span><br><span class="line"></span><br><span class="line">-c ç»Ÿè®¡æ»¡è¶³çš„è¡Œæ•°</span><br><span class="line"></span><br><span class="line">-v åè½¬ä¸åŒ…å«</span><br><span class="line"></span><br><span class="line">grep <span class="string">&quot;p&quot;</span> 1.txt å•æ–‡ä»¶æœç´¢åŒ…å«pçš„è¡Œ</span><br><span class="line"></span><br><span class="line">grep <span class="string">&quot;P&quot;</span> 1.txt b.txt å¤šæ–‡ä»¶æœç´¢</span><br><span class="line"></span><br><span class="line">grep -v <span class="string">&quot;p&quot;</span> 1.txt å•æ–‡ä»¶æœç´¢ä¸åŒ…å«pçš„è¡Œ </span><br><span class="line"></span><br><span class="line">grep -c <span class="string">&quot;p&quot;</span> 1.txt <span class="comment">#ç»Ÿè®¡å‡ºç°å¤šå°‘è¡Œ</span></span><br><span class="line"></span><br><span class="line">grep <span class="string">&quot;n$&quot;</span> 1.txt <span class="comment">#ç°å®ä»¥nç»“å°¾çš„è¡Œ</span></span><br><span class="line"></span><br><span class="line">grep <span class="string">&quot;^n&quot;</span> 1.txt <span class="comment">#ç°å®ä»¥nå¼€å¤´çš„è¡Œ</span></span><br></pre></td></tr></table></figure><h2 id="history-æŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤"><a href="#history-æŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤" class="headerlink" title="history æŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤"></a><strong>history</strong> <strong>æŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤</strong></h2><p>history</p><p>history 5 æœ€è¿‘äº”ä¸ªå‘½ä»¤</p><h2 id="wcç»Ÿè®¡æ–‡ä»¶"><a href="#wcç»Ÿè®¡æ–‡ä»¶" class="headerlink" title="wcç»Ÿè®¡æ–‡ä»¶"></a><strong>wc</strong>ç»Ÿè®¡æ–‡ä»¶</h2><p>æŸ¥çœ‹æ–‡ä»¶çš„å­—èŠ‚æ•° wc -c t2.txt</p><p>æŸ¥çœ‹æ–‡ä»¶çš„è¡Œæ•° wc -l t2.txt</p><h2 id="duæŸ¥çœ‹ç©ºé—´"><a href="#duæŸ¥çœ‹ç©ºé—´" class="headerlink" title="duæŸ¥çœ‹ç©ºé—´"></a><strong>du</strong>æŸ¥çœ‹ç©ºé—´</h2><p>du -h äººæ€§åŒ–æ–¹å¼ï¼ˆå¸¦å•ä½ï¼‰</p><p>du -s åªç»Ÿè®¡æ¯ä¸ªå‚æ•°æ‰€å ç”¨ç©ºé—´æ€»çš„å¤§å°</p><p>du -sh &#x2F;etc</p><h2 id="ç®¡é“ç¬¦å·-é…åˆå‘½ä»¤ä½¿ç”¨"><a href="#ç®¡é“ç¬¦å·-é…åˆå‘½ä»¤ä½¿ç”¨" class="headerlink" title="ç®¡é“ç¬¦å· | é…åˆå‘½ä»¤ä½¿ç”¨"></a><strong>ç®¡é“ç¬¦å·</strong> <strong>|</strong> <strong>é…åˆå‘½ä»¤ä½¿ç”¨</strong></h2><p>ç®¡é“ç¬¦ | è¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„å¤„ç†ç»“æœè¾“å‡ºä¼ é€’ç»™åé¢çš„å‘½ä»¤å¤„ç†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l | grep -c <span class="string">&quot;^d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span> -l | grep <span class="string">&quot;^d&quot;</span> | <span class="built_in">wc</span> -l</span><br><span class="line"></span><br><span class="line"><span class="built_in">history</span> | grep -c <span class="string">&quot;ls&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">history</span> | grep <span class="string">&quot;ls&quot;</span> | grep <span class="string">&quot;s$&quot;</span> &gt; ttt.txt</span><br></pre></td></tr></table></figure><h2 id="å’Œ-æŒ‡ä»¤"><a href="#å’Œ-æŒ‡ä»¤" class="headerlink" title="&gt; å’Œ &gt;&gt; æŒ‡ä»¤"></a><strong>&gt;</strong> <strong>å’Œ</strong> <strong>&gt;&gt;</strong> <strong>æŒ‡ä»¤</strong></h2><p>&gt; è¾“å‡ºé‡å®šå‘(è¦†ç›–å†™), &gt;&gt; è¿½åŠ ï¼ˆè¿½åŠ å†™ï¼‰</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> a.txt b.txt &gt;&gt; ttt.txt</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> a.txt b.txt | grep <span class="string">&quot;s&quot;</span> &gt;&gt; ttt.txt</span><br></pre></td></tr></table></figure><h2 id="è¾“å…¥é‡å®šå‘æ“ä½œç¬¦â€"><a href="#è¾“å…¥é‡å®šå‘æ“ä½œç¬¦â€" class="headerlink" title="è¾“å…¥é‡å®šå‘æ“ä½œç¬¦â€&lt;â€"></a>è¾“å…¥é‡å®šå‘æ“ä½œç¬¦â€&lt;â€</h2><p>åœ¨ Shell ç¼–ç¨‹ä¸­ï¼Œ<code>&lt;</code> ç¬¦å·æ˜¯ <strong>è¾“å…¥é‡å®šå‘æ“ä½œç¬¦</strong>ï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯å°†æŸä¸ªæ–‡ä»¶æˆ–æ•°æ®æµçš„å†…å®¹ä½œä¸ºå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š</p><h3 id="ä¸€ã€åŸºæœ¬ä½œç”¨"><a href="#ä¸€ã€åŸºæœ¬ä½œç”¨" class="headerlink" title="ä¸€ã€åŸºæœ¬ä½œç”¨"></a>ä¸€ã€åŸºæœ¬ä½œç”¨</h3><p><strong>å°†æ–‡ä»¶å†…å®¹ä½œä¸ºå‘½ä»¤çš„è¾“å…¥</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &lt; filename</span><br></pre></td></tr></table></figure><ul><li><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt; file.txt   <span class="comment"># å°† file.txt çš„å†…å®¹ä¼ é€’ç»™ cat å‘½ä»¤ï¼ˆæ•ˆæœç­‰åŒäº cat file.txtï¼‰</span></span><br><span class="line"><span class="built_in">wc</span> -l &lt; data.log <span class="comment"># ç»Ÿè®¡ data.log çš„è¡Œæ•°</span></span><br></pre></td></tr></table></figure></li></ul><p>æ­¤æ—¶ï¼Œ<code>&lt;</code> ä¼šæ‰“å¼€æ–‡ä»¶ <code>filename</code>ï¼Œå¹¶å°†å…¶å†…å®¹é‡å®šå‘åˆ° <code>command</code> çš„æ ‡å‡†è¾“å…¥ä¸­ã€‚</p><h3 id="äºŒã€å¸¸è§ä½¿ç”¨åœºæ™¯"><a href="#äºŒã€å¸¸è§ä½¿ç”¨åœºæ™¯" class="headerlink" title="äºŒã€å¸¸è§ä½¿ç”¨åœºæ™¯"></a>äºŒã€å¸¸è§ä½¿ç”¨åœºæ™¯</h3><h4 id="1-æ›¿ä»£ç®¡é“ç¬¦çš„è¾“å…¥"><a href="#1-æ›¿ä»£ç®¡é“ç¬¦çš„è¾“å…¥" class="headerlink" title="1. æ›¿ä»£ç®¡é“ç¬¦çš„è¾“å…¥"></a>1. <strong>æ›¿ä»£ç®¡é“ç¬¦çš„è¾“å…¥</strong></h4><p>å½“å‘½ä»¤éœ€è¦ä»æ–‡ä»¶è€Œéé”®ç›˜è·å–è¾“å…¥æ—¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ–‡ä»¶å†…å®¹ä¼ é€’ç»™éœ€è¦ stdin çš„å‘½ä»¤</span></span><br><span class="line">grep <span class="string">&quot;error&quot;</span> &lt; server.log</span><br></pre></td></tr></table></figure><h4 id="2-Here-Documentï¼ˆæ–‡æ¡£å†…è¾“å…¥ï¼‰"><a href="#2-Here-Documentï¼ˆæ–‡æ¡£å†…è¾“å…¥ï¼‰" class="headerlink" title="2. Here Documentï¼ˆæ–‡æ¡£å†…è¾“å…¥ï¼‰"></a>2. <strong>Here Documentï¼ˆæ–‡æ¡£å†…è¾“å…¥ï¼‰</strong></h4><p>ä½¿ç”¨ <code>&lt;&lt;</code> ç»“åˆ <code>&lt;</code> å®šä¹‰å¤šè¡Œè¾“å…¥å—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">ç¬¬ä¸€è¡Œå†…å®¹</span></span><br><span class="line"><span class="string">ç¬¬äºŒè¡Œå†…å®¹</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><ul><li><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">Hello</span></span><br><span class="line"><span class="string">World</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello</span><br><span class="line">World</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-Here-Stringï¼ˆå­—ç¬¦ä¸²è¾“å…¥ï¼‰"><a href="#3-Here-Stringï¼ˆå­—ç¬¦ä¸²è¾“å…¥ï¼‰" class="headerlink" title="3. Here Stringï¼ˆå­—ç¬¦ä¸²è¾“å…¥ï¼‰"></a>3. <strong>Here Stringï¼ˆå­—ç¬¦ä¸²è¾“å…¥ï¼‰</strong></h4><p>ä½¿ç”¨ <code>&lt;&lt;&lt;</code> ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &lt;&lt;&lt; <span class="string">&quot;string&quot;</span></span><br></pre></td></tr></table></figure><ul><li><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tr</span> <span class="string">&#x27;a-z&#x27;</span> <span class="string">&#x27;A-Z&#x27;</span> &lt;&lt;&lt; <span class="string">&quot;hello&quot;</span>  <span class="comment"># è¾“å‡º HELLO</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="ä¸‰ã€ä¸å…¶ä»–ç¬¦å·çš„åŒºåˆ«"><a href="#ä¸‰ã€ä¸å…¶ä»–ç¬¦å·çš„åŒºåˆ«" class="headerlink" title="ä¸‰ã€ä¸å…¶ä»–ç¬¦å·çš„åŒºåˆ«"></a>ä¸‰ã€ä¸å…¶ä»–ç¬¦å·çš„åŒºåˆ«</h3><table><thead><tr><th align="left">ç¬¦å·</th><th align="left">ä½œç”¨</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left"><code>&lt;</code></td><td align="left">è¾“å…¥é‡å®šå‘ï¼ˆä»æ–‡ä»¶è¯»å–ï¼‰</td><td align="left"><code>sort &lt; input.txt</code></td></tr><tr><td align="left"><code>&gt;</code></td><td align="left">è¾“å‡ºé‡å®šå‘ï¼ˆè¦†ç›–å†™å…¥æ–‡ä»¶ï¼‰</td><td align="left"><code>ls &gt; file_list.txt</code></td></tr><tr><td align="left"><code>&gt;&gt;</code></td><td align="left">è¾“å‡ºé‡å®šå‘ï¼ˆè¿½åŠ åˆ°æ–‡ä»¶ï¼‰</td><td align="left"><code>echo &quot;new&quot; &gt;&gt; log.txt</code></td></tr><tr><td align="left">&#96;</td><td align="left">&#96;</td><td align="left">ç®¡é“ç¬¦ï¼ˆä¼ é€’å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºï¼‰<code>cat file.txt  grep &quot;key&quot;</code></td></tr></tbody></table><h3 id="å››ã€æ³¨æ„äº‹é¡¹"><a href="#å››ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="å››ã€æ³¨æ„äº‹é¡¹"></a>å››ã€æ³¨æ„äº‹é¡¹</h3><ol><li><p><strong>æ–‡ä»¶å¿…é¡»å­˜åœ¨</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &lt; non_existent_file  <span class="comment"># æŠ¥é”™ï¼šNo such file or directory</span></span><br></pre></td></tr></table></figure></li><li><p><strong>ä¸å‘½ä»¤å‚æ•°çš„ä¼˜å…ˆçº§</strong>ï¼š</p><ul><li>å¦‚æœå‘½ä»¤æœ¬èº«æ¥å—æ–‡ä»¶åå‚æ•°ï¼ˆå¦‚ <code>cat file.txt</code>ï¼‰ï¼Œç›´æ¥ä¼ å‚æ¯” <code>&lt;</code> æ›´é«˜æ•ˆï¼Œå› ä¸º <code>&lt;</code> éœ€è¦é¢å¤–æ‰“å¼€æ–‡ä»¶ã€‚</li></ul></li><li><p><strong>è¾“å…¥é‡å®šå‘å’Œç®¡é“çš„åŒºåˆ«</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> file.txt | <span class="built_in">command</span>   <span class="comment"># ç®¡é“ç¬¦ä¼ é€’çš„æ˜¯ cat çš„è¾“å‡º</span></span><br><span class="line"><span class="built_in">command</span> &lt; file.txt       <span class="comment"># ç›´æ¥ä¼ é€’æ–‡ä»¶å†…å®¹åˆ° command çš„ stdin</span></span><br></pre></td></tr></table></figure></li></ol><hr><h3 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h3><p><code>&lt;</code> æ˜¯ Shell ä¸­ <strong>è¾“å…¥æ–¹å‘çš„é‡å®šå‘ç¬¦å·</strong>ï¼Œç”¨äºå°†æ–‡ä»¶æˆ–æ•°æ®æµçš„å†…å®¹ä¼ é€’ç»™å‘½ä»¤çš„æ ‡å‡†è¾“å…¥ã€‚ç†Ÿç»ƒæŒæ¡è¾“å…¥&#x2F;è¾“å‡ºé‡å®šå‘ï¼Œæ˜¯ Shell è„šæœ¬é«˜æ•ˆå¤„ç†æ–‡ä»¶å’Œæ•°æ®æµçš„æ ¸å¿ƒæŠ€èƒ½ï¼</p><h1 id="å‹ç¼©å®‰è£…ç±»"><a href="#å‹ç¼©å®‰è£…ç±»" class="headerlink" title="å‹ç¼©å®‰è£…ç±»"></a>å‹ç¼©å®‰è£…ç±»</h1><h2 id="zip-unzip-å‹ç¼©è§£å‹"><a href="#zip-unzip-å‹ç¼©è§£å‹" class="headerlink" title="zip unzip å‹ç¼©è§£å‹"></a><strong>zip unzip</strong> <strong>å‹ç¼©è§£å‹</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\# å‹ç¼©æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">zip æ–‡ä»¶å.zip å°†è¦å‹ç¼©çš„å†…å®¹</span><br><span class="line"></span><br><span class="line">\# è§£å‹ç¼©æ–‡ä»¶</span><br><span class="line">unzip æ–‡ä»¶å.zip</span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨é€‰é¡¹</strong></p><p>-rï¼šé€’å½’å‹ç¼©ï¼Œå³å‹ç¼©ç›®å½•</p><p>-d&lt;ç›®å½•&gt; ï¼šæŒ‡å®šè§£å‹åæ–‡ä»¶çš„å­˜æ”¾ç›®å½•</p><p>zip test.zip -r a&#x2F;b æ³¨ï¼šç»å¯¹è·¯å¾„å‹ç¼©ä¼šå¸¦å‰é¢çš„è·¯å¾„æ–‡ä»¶å¤¹</p><p>unzip linux.x64_11gR2_database_1of2.zip -d &#x2F;opt&#x2F;app&#x2F;database&#x2F;</p><ul><li><p><strong>å‹ç¼©çš„æ—¶å€™ç”¨ç›¸å¯¹è·¯å¾„</strong></p></li><li><p><strong>è§£å‹çš„æ—¶å€™ç”¨ç»å¯¹è·¯å¾„</strong></p></li></ul><h2 id="tar-å‹ç¼©è§£å‹"><a href="#tar-å‹ç¼©è§£å‹" class="headerlink" title="tar å‹ç¼©è§£å‹"></a><strong>tar</strong> <strong>å‹ç¼©è§£å‹</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-z è°ƒç”¨ gzip ç¨‹åºè¿›è¡Œå‹ç¼©æˆ–è§£å‹</span><br><span class="line">-c åˆ›å»ºï¼ˆCreateï¼‰.tar æ ¼å¼çš„åŒ…æ–‡ä»¶</span><br><span class="line">-x è§£å¼€.tar æ ¼å¼çš„åŒ…æ–‡ä»¶</span><br><span class="line">-C &lt;/è§£å‹æ—¶æŒ‡å®šé‡Šæ”¾çš„ç›®æ ‡æ–‡ä»¶å¤¹ æŒ‡å®šç›®å½•</span><br><span class="line">-v è¾“å‡ºè¯¦ç»†ä¿¡æ¯ï¼ˆVerboseï¼‰</span><br><span class="line">-f è¡¨ç¤ºä½¿ç”¨å½’æ¡£æ–‡ä»¶ï¼ˆä¸€èˆ¬éƒ½è¦å¸¦ä¸Šè¡¨ç¤ºä½¿ç”¨tar,æ”¾åœ¨æœ€åï¼‰</span><br></pre></td></tr></table></figure><p>å‹ç¼©ï¼štar [é€‰é¡¹] â€¦ å½’æ¡£æ–‡ä»¶åï¼ˆå‹ç¼©åŒ…åå­—ï¼‰ æºæ–‡ä»¶æˆ–ç›®å½•</p><p>è§£å‹ï¼štar [é€‰é¡¹] â€¦ å½’æ¡£æ–‡ä»¶å [-C ç›®æ ‡ç›®å½•]</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf abc123.tar.gz abc.txt 123.txt å‹ç¼©æˆabc123.tar.gzçš„å‘½ä»¤</span><br><span class="line"></span><br><span class="line">tar -zcvf abc123.tar.gz m</span><br><span class="line"></span><br><span class="line">tar -zxvf abc123.tar.gz -C <span class="built_in">test</span>/ è§£å‹åˆ°æŒ‡å®šç›®å½•</span><br></pre></td></tr></table></figure><h2 id="YumåŒ…ç®¡ç†"><a href="#YumåŒ…ç®¡ç†" class="headerlink" title="YumåŒ…ç®¡ç†"></a><strong>Yum</strong>åŒ…ç®¡ç†</h2><p>Yumæ˜¯ä¸€ä¸ªShellå‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚åŸºäºRPMåŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½</p><p>RPMåŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä»¶åŒ…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥è¯¢yumæœåŠ¡å™¨æ˜¯å¦æœ‰éœ€è¦å®‰è£…çš„è½¯ä»¶ yum list | grep xxx</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢æŒ‡å®šçš„yumåŒ…ä¿¡æ¯ yum info xxx</span><br><span class="line"></span><br><span class="line">å®‰è£…æŒ‡å®šçš„yumåŒ… yum install xxx</span><br><span class="line"></span><br><span class="line">å¸è½½æŒ‡å®šçš„yumåŒ… yum remove xxxs</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å·²å®‰è£…çš„è½¯ä»¶åŒ… yum list installed</span><br><span class="line"></span><br><span class="line">yum install ntpdate <span class="comment"># å®‰è£…ç½‘ç»œå¯¹æ—¶</span></span><br></pre></td></tr></table></figure><h1 id="ç”¨æˆ·æƒé™ç±»"><a href="#ç”¨æˆ·æƒé™ç±»" class="headerlink" title="ç”¨æˆ·æƒé™ç±»"></a>ç”¨æˆ·æƒé™ç±»</h1><h2 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a><strong>åŸºæœ¬ä»‹ç»</strong></h2><p>ç™»å½•æ—¶å°½é‡å°‘ç”¨rootå¸å·ç™»å½•ï¼Œå› ä¸ºå®ƒæ˜¯ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæœ€å¤§çš„æƒé™ï¼Œé¿å…æ“ä½œå¤±è¯¯ã€‚å¯</p><p>ä»¥åˆ©ç”¨æ™®é€šç”¨æˆ·ç™»å½•ï¼Œç™»å½•åå†ç”¨ su - ç”¨æˆ·å å‘½ä»¤æ¥åˆ‡æ¢</p><h2 id="ç”¨æˆ·åŠç”¨æˆ·ç»„"><a href="#ç”¨æˆ·åŠç”¨æˆ·ç»„" class="headerlink" title="ç”¨æˆ·åŠç”¨æˆ·ç»„"></a><strong>ç”¨æˆ·åŠç”¨æˆ·ç»„</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ç±»ä¼¼äºè§’è‰²ï¼Œç³»ç»Ÿå¯ä»¥å¯¹æœ‰å…±æ€§çš„å¤šä¸ªç”¨æˆ·è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚</span><br><span class="line"></span><br><span class="line">æ–°å¢ç”¨æˆ·ç»„ groupadd xiaoshou</span><br><span class="line"></span><br><span class="line">æ·»åŠ ç”¨æˆ· useradd xiaomei</span><br><span class="line"></span><br><span class="line">æ·»åŠ ç”¨æˆ·æ—¶åŠ ä¸Šç»„ useradd -g xiaoshou xiaomei</span><br><span class="line"></span><br><span class="line">æŒ‡å®š/ä¿®æ”¹å¯†ç  passwd xiaomei</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ <span class="built_in">id</span> xiaomei</span><br><span class="line"></span><br><span class="line">åˆ‡æ¢ç”¨æˆ· su - xiaomei</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å½“å‰ç”¨æˆ· <span class="built_in">whoami</span></span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ç”¨æˆ·çš„ç»„ usermod -g ç”¨æˆ·ç»„ ç”¨æˆ·å</span><br><span class="line"></span><br><span class="line">åˆ é™¤ç”¨æˆ· userdel xiaomei (<span class="built_in">exit</span>é€€å‡ºåå†åˆ é™¤)</span><br><span class="line"></span><br><span class="line">åˆ é™¤ç»„ groupdel xiaoshou</span><br></pre></td></tr></table></figure><h2 id="ç”¨æˆ·å’Œç»„çš„ç›¸å…³æ–‡ä»¶"><a href="#ç”¨æˆ·å’Œç»„çš„ç›¸å…³æ–‡ä»¶" class="headerlink" title="ç”¨æˆ·å’Œç»„çš„ç›¸å…³æ–‡ä»¶"></a><strong>ç”¨æˆ·å’Œç»„çš„ç›¸å…³æ–‡ä»¶</strong></h2><p><strong>&#x2F;etc&#x2F;passwd</strong> <strong>æ–‡ä»¶</strong></p><ul><li><p>ç”¨æˆ·ï¼ˆuserï¼‰çš„é…ç½®æ–‡ä»¶ï¼Œè®°å½•ç”¨æˆ·çš„å„ç§ä¿¡æ¯</p></li><li><p>æ¯è¡Œçš„å«ä¹‰ï¼šç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shell</p></li></ul><p><strong>&#x2F;etc&#x2F;group</strong> <strong>æ–‡ä»¶</strong></p><ul><li><p>ç»„(group)çš„é…ç½®æ–‡ä»¶ï¼Œè®°å½•LinuxåŒ…å«çš„ç»„çš„ä¿¡æ¯</p></li><li><p>æ¯è¡Œå«ä¹‰ï¼šç»„å:å£ä»¤:ç»„æ ‡è¯†å·:ç»„å†…ç”¨æˆ·åˆ—è¡¨</p></li></ul><h2 id="rwxæƒé™è¯¦è§£"><a href="#rwxæƒé™è¯¦è§£" class="headerlink" title="rwxæƒé™è¯¦è§£"></a>rwxæƒé™è¯¦è§£</h2><ul><li><p>[ r ]ä»£è¡¨å¯è¯»(read): å¯ä»¥è¯»å–</p></li><li><p>[ w ]ä»£è¡¨å¯å†™(write): å¯ä»¥ä¿®æ”¹</p></li><li><p>[ x ]ä»£è¡¨å¯æ‰§è¡Œ(execute):å¯ä»¥è¢«æ‰§è¡Œ</p></li><li></li></ul><p><strong>10ä¸ªå­—ç¬¦ç¡®å®šä¸åŒç”¨æˆ·èƒ½å¯¹æ–‡ä»¶å¹²ä»€ä¹ˆ</strong></p><ul><li><p>ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨æ–‡ä»¶ç±»å‹ï¼šæ–‡ä»¶( - ),ç›®å½•( d ),é“¾æ¥( l )</p></li><li><p>ç¬¬ä¸€ç»„ rwx : æ–‡ä»¶æ‹¥æœ‰è€…çš„æƒé™æ˜¯è¯»ã€å†™å’Œæ‰§è¡Œ</p></li><li><p>ç¬¬äºŒç»„ rw- : ä¸æ–‡ä»¶æ‹¥æœ‰è€…åŒä¸€ç»„çš„ç”¨æˆ·çš„æƒé™æ˜¯è¯»ã€å†™ä½†ä¸èƒ½æ‰§è¡Œ</p></li><li><p>ç¬¬ä¸‰ç»„ râ€“ : ä¸ä¸æ–‡ä»¶æ‹¥æœ‰è€…åŒç»„çš„å…¶ä»–ç”¨æˆ·çš„æƒé™æ˜¯è¯»ä¸èƒ½å†™å’Œæ‰§è¡Œ</p></li></ul><p>å¯ç”¨æ•°å­—è¡¨ç¤ºä¸º: r&#x3D;4,w&#x3D;2,x&#x3D;1</p><p>å› æ­¤ rwx&#x3D;4+2+1&#x3D;7</p><h2 id="chmod-ä¿®æ”¹æƒé™"><a href="#chmod-ä¿®æ”¹æƒé™" class="headerlink" title="chmod ä¿®æ”¹æƒé™"></a><strong>chmod</strong> <strong>ä¿®æ”¹æƒé™</strong></h2><p>é€šè¿‡ chmod æŒ‡ä»¤ï¼Œå¯ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™</p><p>-Rè¡¨ç¤ºé€’å½’é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•</p><p>**+ã€-ã€&#x3D; <strong>å˜æ›´æƒé™</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">u:æ‰€æœ‰è€… g:æ‰€æœ‰ç»„ o:å…¶ä»–äºº a:æ‰€æœ‰äºº(uã€gã€oçš„æ€»å’Œ)</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> u=rwx,g=rx,o=x æ–‡ä»¶ç›®å½•å</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> o+w æ–‡ä»¶ç›®å½•å</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> a-x æ–‡ä»¶ç›®å½•å</span><br></pre></td></tr></table></figure><p>ä¾‹å­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> u+x file                ã€€ã€€ã€€   ç»™fileçš„å±ä¸»å¢åŠ æ‰§è¡Œæƒé™</span><br><span class="line"><span class="built_in">chmod</span> 751 file                ã€€ã€€ã€€  </span><br><span class="line"><span class="built_in">chmod</span> u=rwx,g=rx,o=x file      ä¸Šä¾‹çš„å¦ä¸€ç§å½¢å¼</span><br><span class="line"><span class="built_in">chmod</span> 444 file              ã€€ã€€ã€€ã€€ åŒä¸Šä¾‹</span><br><span class="line"><span class="built_in">chmod</span> a-wx,a+r   file   ã€€ã€€   åŒä¸Šä¾‹</span><br><span class="line"><span class="built_in">chmod</span> -R u+r directory         é€’å½’åœ°ç»™directoryç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„å±ä¸»åˆ†é…è¯»çš„æƒé™</span><br></pre></td></tr></table></figure><h2 id="chown-ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…"><a href="#chown-ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…" class="headerlink" title="chown ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…"></a><strong>chown</strong> <strong>ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> [-R] æ‰€æœ‰è€… æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line"></span><br><span class="line">-Rè¡¨ç¤ºé€’å½’é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•</span><br><span class="line"></span><br><span class="line"><span class="built_in">chown</span> test02 /root/test.txt</span><br><span class="line"></span><br><span class="line"><span class="built_in">chown</span> -R ç”¨æˆ·:ç»„ /usr/local/mysql</span><br><span class="line"></span><br><span class="line"><span class="built_in">chown</span> meimei:students 1</span><br></pre></td></tr></table></figure><p>&#x2F;usr&#x2F;local  å°æ–‡ä»¶ï¼Œå°è½¯ä»¶çš„å®‰è£…</p><p>mysql ç«¯å£é»˜è®¤3306</p><p>oracle ç«¯å£é»˜è®¤1521</p><h1 id="ç½‘ç»œé…ç½®ç±»"><a href="#ç½‘ç»œé…ç½®ç±»" class="headerlink" title="ç½‘ç»œé…ç½®ç±»"></a>ç½‘ç»œé…ç½®ç±»</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">clear æ¸…å± ifconfig åˆ—å‡ºç½‘å¡ä¿¡æ¯ ping ipåœ°å€ çœ‹ç½‘ç»œæ˜¯ä¸æ˜¯è¿é€š</span><br><span class="line"></span><br><span class="line">free æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class="line"></span><br><span class="line">**top** **æŸ¥çœ‹ç³»ç»Ÿæ•´ä½“èµ„æº**</span><br><span class="line"></span><br><span class="line">PIDï¼šè¿›ç¨‹çš„æ ‡è¯†ç¬¦ã€‚ USERï¼šè¿è¡Œè¿›ç¨‹çš„ç”¨æˆ·åã€‚</span><br><span class="line"></span><br><span class="line">PRï¼ˆä¼˜å…ˆçº§ï¼‰ï¼šè¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚ NIï¼ˆNiceå€¼ï¼‰ï¼šè¿›ç¨‹çš„ä¼˜å…ˆçº§è°ƒæ•´å€¼ã€‚</span><br><span class="line"></span><br><span class="line">VIRTï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰ï¼šè¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜å¤§å°ã€‚</span><br><span class="line"></span><br><span class="line">RESï¼ˆå¸¸é©»å†…å­˜ï¼‰ï¼šè¿›ç¨‹å®é™…ä½¿ç”¨çš„ç‰©ç†å†…å­˜å¤§å°ã€‚</span><br><span class="line"></span><br><span class="line">SHRï¼ˆå…±äº«å†…å­˜ï¼‰ï¼šè¿›ç¨‹å…±äº«çš„å†…å­˜å¤§å°ã€‚</span><br><span class="line"></span><br><span class="line">%CPUï¼šè¿›ç¨‹å ç”¨ CPU çš„ä½¿ç”¨ç‡ã€‚</span><br><span class="line"></span><br><span class="line">%MEMï¼šè¿›ç¨‹å ç”¨å†…å­˜çš„ä½¿ç”¨ç‡ã€‚</span><br><span class="line"></span><br><span class="line">TIME+ï¼šè¿›ç¨‹çš„ç´¯è®¡ CPU æ—¶é—´ã€‚</span><br></pre></td></tr></table></figure><h2 id="topå‘½ä»¤"><a href="#topå‘½ä»¤" class="headerlink" title="topå‘½ä»¤"></a>topå‘½ä»¤</h2><h3 id="1-è¿›ç¨‹åˆ—è¡¨åŒºå­—æ®µå«ä¹‰"><a href="#1-è¿›ç¨‹åˆ—è¡¨åŒºå­—æ®µå«ä¹‰" class="headerlink" title="1. è¿›ç¨‹åˆ—è¡¨åŒºå­—æ®µå«ä¹‰"></a>1. è¿›ç¨‹åˆ—è¡¨åŒºå­—æ®µå«ä¹‰</h3><p>é»˜è®¤æ˜¾ç¤ºçš„è¿›ç¨‹å­—æ®µå¦‚ä¸‹ï¼ˆå¯é€šè¿‡å¿«æ·é”®è‡ªå®šä¹‰æ˜¾ç¤ºå†…å®¹ï¼‰ï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>PID</code></td><td>è¿›ç¨‹ IDï¼ˆå”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæ€æ­»è¿›ç¨‹ç­‰æ“ä½œï¼‰</td></tr><tr><td><code>USER</code></td><td>è¿›ç¨‹æ‰€å±ç”¨æˆ·</td></tr><tr><td><code>PR</code></td><td>è¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰</td></tr><tr><td><code>NI</code></td><td>nice å€¼ï¼ˆä¼˜å…ˆçº§è°ƒæ•´å€¼ï¼ŒèŒƒå›´ -20~19ï¼Œé»˜è®¤ 0ï¼‰</td></tr><tr><td><code>VIRT</code></td><td>è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼ˆåŒ…æ‹¬æœªä½¿ç”¨çš„ swap ç©ºé—´ï¼‰</td></tr><tr><td><code>RES</code></td><td>è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ï¼ˆä¸åŒ…æ‹¬ swapï¼Œå•ä½ KiBï¼‰</td></tr><tr><td><code>SHR</code></td><td>è¿›ç¨‹å…±äº«çš„å†…å­˜é‡ï¼ˆåŒ…æ‹¬ä¸å…¶ä»–è¿›ç¨‹å…±äº«çš„éƒ¨åˆ†ï¼‰</td></tr><tr><td><code>S</code></td><td>è¿›ç¨‹çŠ¶æ€ï¼ˆRï¼šè¿è¡Œï¼›Sï¼šä¼‘çœ ï¼›Tï¼šåœæ­¢ï¼›Zï¼šåƒµå°¸ï¼›Dï¼šä¸å¯ä¸­æ–­ä¼‘çœ ï¼‰</td></tr><tr><td><code>%CPU</code></td><td>è¿›ç¨‹å ç”¨ CPU çš„ç™¾åˆ†æ¯”ï¼ˆè‡ªä¸Šæ¬¡åˆ·æ–°ä»¥æ¥ï¼‰</td></tr><tr><td><code>%MEM</code></td><td>è¿›ç¨‹å ç”¨ç‰©ç†å†…å­˜çš„ç™¾åˆ†æ¯”</td></tr><tr><td><code>TIME+</code></td><td>è¿›ç¨‹ç´¯è®¡ä½¿ç”¨çš„ CPU æ—¶é—´</td></tr><tr><td><code>COMMAND</code></td><td>è¿›ç¨‹å¯åŠ¨å‘½ä»¤ï¼ˆå¯èƒ½è¢«æˆªæ–­ï¼Œå¯é€šè¿‡ <code>-c</code> å‚æ•°æ˜¾ç¤ºå®Œæ•´å‘½ä»¤ï¼‰</td></tr></tbody></table><h3 id="2-å¸¸ç”¨å¿«æ·é”®ï¼ˆåœ¨-top-ç•Œé¢ä¸­ä½¿ç”¨ï¼‰"><a href="#2-å¸¸ç”¨å¿«æ·é”®ï¼ˆåœ¨-top-ç•Œé¢ä¸­ä½¿ç”¨ï¼‰" class="headerlink" title="2.å¸¸ç”¨å¿«æ·é”®ï¼ˆåœ¨ top ç•Œé¢ä¸­ä½¿ç”¨ï¼‰"></a>2.å¸¸ç”¨å¿«æ·é”®ï¼ˆåœ¨ top ç•Œé¢ä¸­ä½¿ç”¨ï¼‰</h3><ul><li><strong>æ’åºç›¸å…³</strong>ï¼š<ul><li><code>P</code>ï¼šæŒ‰ <code>%CPU</code> ä½¿ç”¨ç‡ä»é«˜åˆ°ä½æ’åºï¼ˆé»˜è®¤ï¼‰</li><li><code>M</code>ï¼šæŒ‰ <code>%MEM</code> ä½¿ç”¨ç‡ä»é«˜åˆ°ä½æ’åº</li><li><code>N</code>ï¼šæŒ‰ <code>PID</code> ä»å°åˆ°å¤§æ’åº</li><li><code>T</code>ï¼šæŒ‰ <code>TIME+</code>ï¼ˆç´¯è®¡ CPU æ—¶é—´ï¼‰ä»é«˜åˆ°ä½æ’åºã€‚</li></ul></li><li><strong>åˆ·æ–°é¢‘ç‡</strong>ï¼š<ul><li><code>s</code>ï¼šä¿®æ”¹åˆ·æ–°é—´éš”æ—¶é—´ï¼ˆè¾“å…¥æ•°å­—åå›è½¦ï¼Œå•ä½ç§’ï¼Œé»˜è®¤ 3 ç§’ï¼‰ã€‚</li></ul></li><li><strong>ç­›é€‰ä¸æŸ¥æ‰¾</strong>ï¼š<ul><li><code>u</code>ï¼šè¾“å…¥ç”¨æˆ·åï¼Œåªæ˜¾ç¤ºè¯¥ç”¨æˆ·çš„è¿›ç¨‹</li><li><code>k</code>ï¼šè¾“å…¥ PID å¹¶å›è½¦ï¼Œå†è¾“å…¥ä¿¡å·ï¼ˆå¦‚ 9 ä»£è¡¨å¼ºåˆ¶ç»ˆæ­¢ï¼‰ï¼Œå¯æ€æ­»æŒ‡å®šè¿›ç¨‹</li><li><code>f</code>ï¼šè¿›å…¥å­—æ®µé€‰æ‹©ç•Œé¢ï¼ŒæŒ‰æ–¹å‘é”®é€‰æ‹©å­—æ®µï¼ŒæŒ‰ç©ºæ ¼é”®å‹¾é€‰ &#x2F; å–æ¶ˆï¼Œå›è½¦è¿”å›ï¼ˆè‡ªå®šä¹‰æ˜¾ç¤ºå“ªäº›å­—æ®µï¼‰</li><li><code>o</code>ï¼šè¿›å…¥æ’åºæ¡ä»¶è®¾ç½®ï¼ŒæŒ‰å­—æ®µé¦–å­—æ¯è®¾ç½®æ’åºè§„åˆ™ï¼ˆå¦‚è¾“å…¥ <code>%MEM</code> æŒ‰å†…å­˜æ’åºï¼‰</li><li><code>/</code>ï¼šè¾“å…¥å…³é”®è¯ï¼Œæœç´¢è¿›ç¨‹å‘½ä»¤ï¼ˆæŒ‰ <code>n</code> åˆ‡æ¢ä¸‹ä¸€ä¸ªç»“æœï¼‰ã€‚</li></ul></li><li><strong>å…¶ä»–æ“ä½œ</strong>ï¼š<ul><li><code>H</code>ï¼šæ˜¾ç¤º &#x2F; éšè—çº¿ç¨‹ï¼ˆé»˜è®¤åªæ˜¾ç¤ºè¿›ç¨‹ï¼Œå¼€å¯åæ˜¾ç¤ºçº¿ç¨‹ï¼‰</li><li><code>c</code>ï¼šåˆ‡æ¢æ˜¾ç¤ºå®Œæ•´å‘½ä»¤ &#x2F; å‘½ä»¤åï¼ˆé»˜è®¤æ˜¾ç¤ºå‘½ä»¤åï¼Œå¼€å¯åæ˜¾ç¤ºå®Œæ•´è·¯å¾„ï¼‰</li><li><code>i</code>ï¼šå¿½ç•¥é—²ç½®è¿›ç¨‹ï¼ˆåªæ˜¾ç¤ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼‰</li><li><code>q</code>ï¼šé€€å‡º top ç•Œé¢ã€‚</li></ul></li></ul><h3 id="3-å¸¸ç”¨å‘½ä»¤å‚æ•°ï¼ˆå¯åŠ¨-top-æ—¶ä½¿ç”¨ï¼‰"><a href="#3-å¸¸ç”¨å‘½ä»¤å‚æ•°ï¼ˆå¯åŠ¨-top-æ—¶ä½¿ç”¨ï¼‰" class="headerlink" title="3. å¸¸ç”¨å‘½ä»¤å‚æ•°ï¼ˆå¯åŠ¨ top æ—¶ä½¿ç”¨ï¼‰"></a>3. å¸¸ç”¨å‘½ä»¤å‚æ•°ï¼ˆå¯åŠ¨ top æ—¶ä½¿ç”¨ï¼‰</h3><ul><li><code>top -d N</code>ï¼šæŒ‡å®šåˆ·æ–°é—´éš”ä¸º N ç§’ï¼ˆå¦‚ <code>top -d 5</code> æ¯ 5 ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰</li><li><code>top -p PID1,PID2</code>ï¼šåªç›‘æ§æŒ‡å®š PID çš„è¿›ç¨‹ï¼ˆå¦‚ <code>top -p 123,456</code>ï¼‰</li><li><code>top -u ç”¨æˆ·å</code>ï¼šåªæ˜¾ç¤ºæŒ‡å®šç”¨æˆ·çš„è¿›ç¨‹ï¼ˆå¦‚ <code>top -u root</code>ï¼‰</li><li><code>top -c</code>ï¼šå¯åŠ¨æ—¶ç›´æ¥æ˜¾ç¤ºå®Œæ•´å‘½ä»¤ï¼ˆæ— éœ€æŒ‰ <code>c</code> åˆ‡æ¢ï¼‰</li><li><code>top -b</code>ï¼šæ‰¹å¤„ç†æ¨¡å¼ï¼ˆéäº¤äº’å¼ï¼Œå¯ç”¨äºè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œå¦‚ <code>top -b -n 1 &gt; top.log</code> ä¿å­˜ä¸€æ¬¡å¿«ç…§ï¼‰</li><li><code>top -n N</code>ï¼šåˆ·æ–° N æ¬¡åè‡ªåŠ¨é€€å‡ºï¼ˆç»“åˆ <code>-b</code> ä½¿ç”¨ï¼Œå¦‚ <code>top -b -n 3</code> åˆ·æ–° 3 æ¬¡åé€€å‡ºï¼‰ã€‚</li></ul><h3 id="4-ç¤ºä¾‹åœºæ™¯"><a href="#4-ç¤ºä¾‹åœºæ™¯" class="headerlink" title="4. ç¤ºä¾‹åœºæ™¯"></a>4. ç¤ºä¾‹åœºæ™¯</h3><ol><li><strong>æŸ¥çœ‹ç³»ç»Ÿä¸­ CPU å ç”¨æœ€é«˜çš„è¿›ç¨‹</strong>ï¼š<br>è¾“å…¥ <code>top</code> åæŒ‰ <code>P</code>ï¼Œé¡¶éƒ¨è¿›ç¨‹å³ä¸º CPU æ¶ˆè€—æœ€é«˜çš„è¿›ç¨‹ã€‚</li><li><strong>æ€æ­»ä¸€ä¸ªå ç”¨å†…å­˜è¿‡é«˜çš„è¿›ç¨‹</strong>ï¼š<br>æ‰¾åˆ°è¯¥è¿›ç¨‹çš„ <code>PID</code>ï¼ŒæŒ‰ <code>k</code>ï¼Œè¾“å…¥ PIDï¼Œå†è¾“å…¥ <code>9</code> å¹¶å›è½¦ï¼ˆå¼ºåˆ¶ç»ˆæ­¢ï¼‰ã€‚</li><li><strong>ç›‘æ§ç‰¹å®šç”¨æˆ·ï¼ˆå¦‚ wwwï¼‰çš„è¿›ç¨‹</strong>ï¼š<br>æ–¹æ³• 1ï¼šå¯åŠ¨æ—¶ä½¿ç”¨ <code>top -u www</code><br>æ–¹æ³• 2ï¼šåœ¨ top ç•Œé¢æŒ‰ <code>u</code>ï¼Œè¾“å…¥ <code>www</code> å›è½¦ã€‚</li><li><strong>å°†è¿›ç¨‹å¿«ç…§ä¿å­˜åˆ°æ–‡ä»¶</strong>ï¼š<br><code>top -b -n 1 -c &gt; process_snapshot.log</code>ï¼ˆä¿å­˜ä¸€æ¬¡å®Œæ•´å‘½ä»¤çš„è¿›ç¨‹å¿«ç…§ï¼‰ã€‚</li></ol><p>é€šè¿‡ç†Ÿç»ƒä½¿ç”¨ <code>top</code> å‘½ä»¤ï¼Œå¯å¿«é€Ÿå®šä½ç³»ç»Ÿèµ„æºç“¶é¢ˆï¼ˆå¦‚ CPU è¿‡é«˜ã€å†…å­˜æ³„æ¼ç­‰ï¼‰ï¼Œæ˜¯ Linux ç³»ç»Ÿç®¡ç†çš„å¿…å¤‡æŠ€èƒ½ã€‚</p><h2 id="ps-æ˜¾ç¤ºç³»ç»Ÿæ‰§è¡Œçš„è¿›ç¨‹"><a href="#ps-æ˜¾ç¤ºç³»ç»Ÿæ‰§è¡Œçš„è¿›ç¨‹" class="headerlink" title="ps æ˜¾ç¤ºç³»ç»Ÿæ‰§è¡Œçš„è¿›ç¨‹"></a><strong>ps</strong> æ˜¾ç¤ºç³»ç»Ÿæ‰§è¡Œçš„è¿›ç¨‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -aux æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·æ‰€æœ‰è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">ps -ef æŸ¥çœ‹å­çˆ¶è¿›ç¨‹ä¹‹é—´çš„å…³ç³»</span><br></pre></td></tr></table></figure><h2 id="pstree-æŸ¥çœ‹è¿›ç¨‹æ ‘"><a href="#pstree-æŸ¥çœ‹è¿›ç¨‹æ ‘" class="headerlink" title="pstree æŸ¥çœ‹è¿›ç¨‹æ ‘"></a><strong>pstree</strong> <strong>æŸ¥çœ‹è¿›ç¨‹æ ‘</strong></h2><p>pstree 1660 # æ ‘çŠ¶çš„å½¢å¼æ˜¾ç¤ºè¿›ç¨‹çš„pid</p><h2 id="kill"><a href="#kill" class="headerlink" title="kill"></a><strong>kill</strong></h2><p>æœ€å¸¸ç”¨çš„ä¿¡å·æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 (HUP)ï¼šé‡æ–°åŠ è½½è¿›ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">9 (KILL)ï¼šå¼ºåˆ¶æ€æ­»ä¸€ä¸ªè¿›ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">15 (TERM)ï¼šæ­£å¸¸åœæ­¢ä¸€ä¸ªè¿›ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="built_in">kill</span> -9 16989 æ€æ­»è¿›ç¨‹</span><br></pre></td></tr></table></figure><h2 id="systemctl-æœåŠ¡ç®¡ç†"><a href="#systemctl-æœåŠ¡ç®¡ç†" class="headerlink" title="systemctl æœåŠ¡ç®¡ç†"></a><strong>systemctl</strong> <strong>æœåŠ¡ç®¡ç†</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">systemctl [ start | stop | restart | status] æœåŠ¡å</span><br><span class="line"></span><br><span class="line">service æœåŠ¡å [ start | stop | restart | status]</span><br><span class="line"></span><br><span class="line">æœåŠ¡åï¼šmysql network firewalldç­‰</span><br><span class="line"></span><br><span class="line">systemctlæ˜¯æ–°ç‰ˆæœ¬å†™æ³•ï¼Œserviceæ˜¯è€ç‰ˆæœ¬å†™æ³•</span><br><span class="line"></span><br><span class="line">é˜²ç«å¢™æ“ä½œï¼šstatus/start/stop/restart/disable/enable å¤šä¸¤ä¸ª</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹é˜²ç«å¢™ï¼š systemctl status firewalld</span><br><span class="line"></span><br><span class="line">åœæ­¢é˜²ç«å¢™ï¼š systemctl <span class="built_in">disable</span> firewalld é‡å¯åç”Ÿæ•ˆ</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šç›´æ¥å…³æ­»å³å¯ï¼Œå•æœºç‰ˆä½¿ç”¨é˜²ç«å¢™</p><h1 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h1><h2 id="ä¸€ã€é˜²ç«å¢™çš„å¼€å¯ã€å…³é—­ã€ç¦ç”¨å‘½ä»¤"><a href="#ä¸€ã€é˜²ç«å¢™çš„å¼€å¯ã€å…³é—­ã€ç¦ç”¨å‘½ä»¤" class="headerlink" title="ä¸€ã€é˜²ç«å¢™çš„å¼€å¯ã€å…³é—­ã€ç¦ç”¨å‘½ä»¤"></a>ä¸€ã€é˜²ç«å¢™çš„å¼€å¯ã€å…³é—­ã€ç¦ç”¨å‘½ä»¤</h2><ol><li><p>è®¾ç½®å¼€æœºå¯ç”¨é˜²ç«å¢™ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> firewalld</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®å¼€æœºç¦ç”¨é˜²ç«å¢™ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨é˜²ç«å¢™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start firewalld</span><br></pre></td></tr></table></figure></li><li><p>å…³é—­é˜²ç«å¢™ï¼š</p></li></ol>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld æˆ– systemctl stop firewalld.service</span><br></pre></td></tr></table></figure><ol start="5"><li><p>æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ </p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure></li></ol><h2 id="äºŒã€ä½¿ç”¨firewall-cmdé…ç½®ç«¯å£"><a href="#äºŒã€ä½¿ç”¨firewall-cmdé…ç½®ç«¯å£" class="headerlink" title="äºŒã€ä½¿ç”¨firewall-cmdé…ç½®ç«¯å£"></a>äºŒã€ä½¿ç”¨firewall-cmdé…ç½®ç«¯å£</h2><ol><li><p>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --state</span><br></pre></td></tr></table></figure></li><li><p>é‡æ–°åŠ è½½é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --list-ports</span><br></pre></td></tr></table></figure></li><li><p>å¼€å¯é˜²ç«å¢™ç«¯å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=9200/tcp --permanent</span><br></pre></td></tr></table></figure></li></ol><p>â€‹å‘½ä»¤å«ä¹‰ï¼š<br>â€‹â€“zone #&#x3D;ä½œç”¨åŸŸ&#x3D;pubic<br>â€‹â€“add-port&#x3D;9200&#x2F;tcp #æ·»åŠ ç«¯å£ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£&#x2F;é€šè®¯åè®®<br>â€‹â€“permanent #æ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆ<br>â€‹æ³¨æ„ï¼šæ·»åŠ ç«¯å£åï¼Œå¿…é¡»ç”¨å‘½ä»¤firewall-cmd â€“reloadé‡æ–°åŠ è½½ä¸€éæ‰ä¼šç”Ÿæ•ˆ</p><ol start="5"><li><p>å…³é—­é˜²ç«å¢™ç«¯å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --remove-port=9200/tcp --permanent</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨å‘½ä»¤<br>1.ç‰ˆæœ¬ä¿¡æ¯</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost]# <span class="built_in">cat</span> /etc/os-release</span><br><span class="line">NAME=â€œopenEulerâ€</span><br><span class="line">VERSION=â€œ22.03 LTSâ€</span><br><span class="line">ID=â€œopenEulerâ€</span><br><span class="line">VERSION_ID=â€œ22.03â€</span><br><span class="line">PRETTY_NAME=â€œopenEuler 22.03 LTSâ€</span><br><span class="line">ANSI_COLOR=â€œ0;31â€</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# <span class="built_in">cat</span> /proc/version</span><br><span class="line">Linux version 5.10.0-60.43.0.72.oe2203.x86_64 (abuild@obs-worker1639015616-x86-0007) (gcc_old (GCC) 10.3.1, GNU ld (GNU Binutils) 2.37) <span class="comment">#1 SMP Tue Jul 12 01:54:24 UTC 2022</span></span><br><span class="line"></span><br><span class="line">[root@iZ2ze9wbetpobdd5izvo9pZ /]# <span class="built_in">uname</span></span><br><span class="line">Linux</span><br></pre></td></tr></table></figure><h2 id="é…ç½®é™æ€ip"><a href="#é…ç½®é™æ€ip" class="headerlink" title="é…ç½®é™æ€ip"></a><strong>é…ç½®é™æ€</strong>ip</h2><p>vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33 ç½‘å¡é…ç½®æ–‡ä»¶</p><p>é‡å¯ç½‘ç»œ service network restart</p><h2 id="netstat-ç«¯å£"><a href="#netstat-ç«¯å£" class="headerlink" title="netstat ç«¯å£"></a><strong>netstat</strong> <strong>ç«¯å£</strong></h2><p>netstat -nltp æŸ¥çœ‹ç½‘ç»œ</p><h2 id="oracleç›‘å¬"><a href="#oracleç›‘å¬" class="headerlink" title="oracleç›‘å¬"></a>oracleç›‘å¬</h2><p>lsnrctl (status çŠ¶æ€ start å¯åŠ¨ stop åœæ­¢)</p><h1 id="å…¶ä»–æ‰©å±•ç±»"><a href="#å…¶ä»–æ‰©å±•ç±»" class="headerlink" title="å…¶ä»–æ‰©å±•ç±»"></a>å…¶ä»–æ‰©å±•ç±»</h1><h2 id="echoè¾“å‡ºå­—ç¬¦ä¸²"><a href="#echoè¾“å‡ºå­—ç¬¦ä¸²" class="headerlink" title="echoè¾“å‡ºå­—ç¬¦ä¸²"></a>echoè¾“å‡ºå­—ç¬¦ä¸²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æ¢è¡Œæ‰“å°è¾“å…¥å­—ç¬¦ è§£é‡Š</span><br><span class="line">-n ä¸æ¢è¡Œæ˜¾ç¤º</span><br><span class="line">-e å‡ºç°è½¬ä¹‰å­—ç¬¦è¿›è¡Œè§£é‡Šå¤„ç†</span><br><span class="line"></span><br><span class="line">è½¬ä¹‰å­—ç¬¦</span><br><span class="line">\n æ¢è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;hello&quot;</span>   ä¸æ¢è¡Œæ˜¾ç¤º</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;test&quot;</span> &gt; t.txt</span><br></pre></td></tr></table></figure><h2 id="dateæ˜¾ç¤ºå½“å‰æ—¥æœŸ-ç”¨äºæ—¥æœŸè½¬å­—ç¬¦ä¸²"><a href="#dateæ˜¾ç¤ºå½“å‰æ—¥æœŸ-ç”¨äºæ—¥æœŸè½¬å­—ç¬¦ä¸²" class="headerlink" title="dateæ˜¾ç¤ºå½“å‰æ—¥æœŸ (ç”¨äºæ—¥æœŸè½¬å­—ç¬¦ä¸²)"></a>dateæ˜¾ç¤ºå½“å‰æ—¥æœŸ (ç”¨äºæ—¥æœŸè½¬å­—ç¬¦ä¸²)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> (æ˜¾ç¤ºå½“å‰æ—¶é—´)</span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> +<span class="string">&quot;%Y&quot;</span> (æ˜¾ç¤ºå½“å‰å¹´ä»½)</span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> +<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span> (æ˜¾ç¤ºå½“å‰æ˜¯å“ªä¸€å¤©)</span><br></pre></td></tr></table></figure><h2 id="date-d-æ—¥æœŸè§£æï¼ˆç”¨äºå­—ç¬¦ä¸²è½¬æ—¥æœŸï¼‰"><a href="#date-d-æ—¥æœŸè§£æï¼ˆç”¨äºå­—ç¬¦ä¸²è½¬æ—¥æœŸï¼‰" class="headerlink" title="date -d æ—¥æœŸè§£æï¼ˆç”¨äºå­—ç¬¦ä¸²è½¬æ—¥æœŸï¼‰"></a><strong>date -d</strong> <strong>æ—¥æœŸè§£æï¼ˆç”¨äºå­—ç¬¦ä¸²è½¬æ—¥æœŸï¼‰</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;2009-12-12&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;2009-12-12 + 1 day&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;+1 day&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;+1 month&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;+1 year&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;2009-12-12 + 1 day&quot;</span> +<span class="string">&quot;%Y/%m/%d %H:%M:%S&quot;</span> &gt; time.txt</span><br></pre></td></tr></table></figure><h2 id="date-è®¾ç½®æ—¥æœŸ"><a href="#date-è®¾ç½®æ—¥æœŸ" class="headerlink" title="date è®¾ç½®æ—¥æœŸ"></a><strong>date</strong> è®¾ç½®æ—¥æœŸ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> -s å­—ç¬¦ä¸²æ—¶é—´</span><br><span class="line"></span><br><span class="line">è®¾ç½®ç³»ç»Ÿå½“å‰æ—¶é—´ <span class="built_in">date</span> -s <span class="string">&quot;2023-08-08 12:34:56&quot;</span></span><br></pre></td></tr></table></figure><h2 id="linuxç½‘ç»œå¯¹æ—¶"><a href="#linuxç½‘ç»œå¯¹æ—¶" class="headerlink" title="linuxç½‘ç»œå¯¹æ—¶"></a>linuxç½‘ç»œå¯¹æ—¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.å®‰è£…netdate</span><br><span class="line">yum install ntpdate</span><br><span class="line"></span><br><span class="line">2.æ‰§è¡Œå‘½ä»¤ï¼ŒåŒæ­¥æ—¶é—´ã€‚</span><br><span class="line">ntpdate us.pool.ntp.org</span><br></pre></td></tr></table></figure><h2 id="calæŸ¥çœ‹æ—¥å†"><a href="#calæŸ¥çœ‹æ—¥å†" class="headerlink" title="calæŸ¥çœ‹æ—¥å†"></a>calæŸ¥çœ‹æ—¥å†</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cal [[[æ—¥] æœˆ] å¹´]</span><br></pre></td></tr></table></figure><ul><li><p>æ˜¾ç¤ºå½“å‰æ—¥å† cal</p></li><li><p>æ˜¾ç¤º2023å¹´æ—¥å† cal 2023</p></li><li><p>æ˜¾ç¤º2023å¹´1æœˆæ—¥å† cal 01 2023</p></li><li><p>æ˜¾ç¤º2023å¹´1æœˆ15æ—¥æ—¥å† cal 15 01 2023</p></li></ul><h2 id="wgetå‘½ä»¤"><a href="#wgetå‘½ä»¤" class="headerlink" title="wgetå‘½ä»¤"></a>wgetå‘½ä»¤</h2><p>ç”¨æ¥ä»æŒ‡å®šçš„URLä¸‹è½½æ–‡ä»¶ã€‚</p><p>pythonä¸‹è½½åœ°å€ï¼š<a href="https://www.python.org/ftp/python">https://www.python.org/ftp/python</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tar.xz</span><br></pre></td></tr></table></figure><h2 id="seqå‘½ä»¤"><a href="#seqå‘½ä»¤" class="headerlink" title="seqå‘½ä»¤"></a>seqå‘½ä»¤</h2><p>ç”¨äºäº§ç”Ÿä»æŸä¸ªæ•°åˆ°å¦å¤–ä¸€ä¸ªæ•°ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°ã€‚</p><ol><li>seq [é€‰é¡¹]â€¦ å°¾æ•°</li><li>seq [é€‰é¡¹]â€¦ é¦–æ•° å°¾æ•°</li><li>seq [é€‰é¡¹]â€¦ é¦–æ•° å¢é‡ å°¾æ•°</li></ol><p>æ­£åºè¾“å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">seq</span> 1 10</span><br><span class="line"></span><br><span class="line"><span class="built_in">seq</span> 1 1 100</span><br></pre></td></tr></table></figure><p>å€’åºè¾“å‡º:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">seq</span> 100 -1 1</span><br></pre></td></tr></table></figure><h2 id="Linux-å®šæ—¶æ‰§è¡Œè®¡åˆ’"><a href="#Linux-å®šæ—¶æ‰§è¡Œè®¡åˆ’" class="headerlink" title="Linux å®šæ—¶æ‰§è¡Œè®¡åˆ’"></a>Linux <strong>å®šæ—¶æ‰§è¡Œè®¡åˆ’</strong></h2><p>æ–¹å¼ä¸€ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š&#x2F;etc&#x2F;crontab ï¼ˆè¦æŒ‡æ˜æ‰§è¡Œç”¨æˆ·ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åˆ† æ—¶ æ—¥ æœˆ å‘¨ ç”¨æˆ·å æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="line"></span><br><span class="line">vim /etc/crontab</span><br><span class="line"></span><br><span class="line">5 * * * * root <span class="built_in">date</span> &gt; /root/time.txt</span><br></pre></td></tr></table></figure><p>æ–¹å¼äºŒï¼šé€šè¿‡crontabå‘½ä»¤ï¼ˆä¸éœ€è¦æŒ‡æ˜æ‰§è¡Œç”¨æˆ·ï¼Œé»˜è®¤å°±æ˜¯å½“å‰ç”¨æˆ·ï¼‰</p><ul><li><p>crontab -e æ³¨ï¼šç¼–è¾‘ç”¨æˆ·çš„croné…ç½®æ–‡ä»¶ï¼›</p></li><li><p>crontab -l æ³¨ï¼šæŸ¥çœ‹ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼›</p></li><li><p>crontab -r æ³¨ï¼šåˆ é™¤ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼›</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5 * * * * <span class="built_in">date</span> &gt; /root/time.txt</span><br></pre></td></tr></table></figure><h3 id="ç‰¹æ®Šç¬¦å·è¯´æ˜"><a href="#ç‰¹æ®Šç¬¦å·è¯´æ˜" class="headerlink" title="ç‰¹æ®Šç¬¦å·è¯´æ˜"></a>ç‰¹æ®Šç¬¦å·è¯´æ˜</h3><table><thead><tr><th><strong>ç¬¦å·</strong></th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>*</td><td>ä»»ä½•æ—¶é—´ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ª * å°±ä»£è¡¨ä¸€å°æ—¶ä¸­æ¯åˆ†é’Ÿéƒ½æ‰§è¡Œä¸€æ¬¡çš„æ„æ€ã€‚</td></tr><tr><td>ï¼Œ</td><td>ä¸è¿ç»­çš„æ—¶é—´ã€‚æ¯”å¦‚ 0 8,12,16 * * * ï¼Œåœ¨æ¯å¤©çš„8ç‚¹0åˆ†ï¼Œ12ç‚¹0åˆ†ï¼Œ16ç‚¹0åˆ†éƒ½æ‰§è¡Œä¸€æ¬¡å‘½ä»¤</td></tr><tr><td>-</td><td>è¿ç»­çš„æ—¶é—´èŒƒå›´ã€‚æ¯”å¦‚ 0 5 * * 1-6 ï¼Œåœ¨å‘¨ä¸€åˆ°å…­å‡Œæ™¨5ç‚¹0åˆ†æ‰§è¡Œå‘½ä»¤</td></tr><tr><td>*&#x2F;n</td><td>æ¯éš”å¤šä¹…æ‰§è¡Œä¸€æ¬¡ã€‚æ¯”å¦‚ *&#x2F;10 * * * * ï¼Œæ¯éš”10åˆ†é’Ÿå°±æ‰§è¡Œä¸€éå‘½ä»¤</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> +<span class="string">&quot;\%Y&quot;</span> &gt; /root/time.txt <span class="comment"># æ³¨ï¼šå®šæ—¶ä»»åŠ¡ä¸­çš„ç‰¹æ®Šç¬¦å·éœ€è¦è½¬ä¹‰%</span></span><br></pre></td></tr></table></figure><h2 id="åˆ†åŒºåŠæŒ‚è½½"><a href="#åˆ†åŒºåŠæŒ‚è½½" class="headerlink" title="åˆ†åŒºåŠæŒ‚è½½"></a><strong>åˆ†åŒºåŠæŒ‚è½½</strong></h2><h3 id="fdisk"><a href="#fdisk" class="headerlink" title="fdisk"></a>fdisk</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰ç¡¬ç›˜çš„åˆ†åŒºæƒ…å†µ</span><br><span class="line"></span><br><span class="line">fdisk /dev/sdb1 å¯ä»¥åˆ†åŒº</span><br></pre></td></tr></table></figure><h3 id="df"><a href="#df" class="headerlink" title="df"></a>df</h3><p>ç”¨äºæ˜¾ç¤º Linux ç³»ç»Ÿä¸­å„æ–‡ä»¶ç³»ç»Ÿçš„ç¡¬ç›˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿæ‰€åœ¨ç¡¬ç›˜åˆ†åŒºçš„æ€»å®¹é‡ã€å·²ä½¿ç”¨çš„å®¹é‡ã€å‰©ä½™å®¹é‡ç­‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h æŸ¥çœ‹ç£ç›˜ä½¿ç”¨åŠæŒ‚è½½æƒ…å†µ</span><br></pre></td></tr></table></figure><h2 id="linuxæ·»åŠ ç¡¬ç›˜åˆ†åŒºæŒ‚è½½"><a href="#linuxæ·»åŠ ç¡¬ç›˜åˆ†åŒºæŒ‚è½½" class="headerlink" title="linuxæ·»åŠ ç¡¬ç›˜åˆ†åŒºæŒ‚è½½"></a>linuxæ·»åŠ ç¡¬ç›˜åˆ†åŒºæŒ‚è½½</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.å…³é—­è™šæ‹Ÿæœºæ·»åŠ ç¡¬ç›˜ï¼šè™šæ‹Ÿæœº-è®¾ç½®-æ·»åŠ -ç¡¬ç›˜-1G-å•ä¸ªæ–‡ä»¶å­˜å‚¨-æ‰“å¼€è™šæ‹Ÿæœº</span><br><span class="line"></span><br><span class="line">è¿›å…¥ç›®å½•/devï¼ŒæŸ¥çœ‹å‡ºç°æ–‡ä»¶sdb</span><br><span class="line"></span><br><span class="line"><span class="built_in">df</span> -h åˆ—å‡ºç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œç›®å‰æ²¡æœ‰æ–°åŠ çš„ç¡¬ç›˜</span><br><span class="line"></span><br><span class="line">fdisk -l å‘ç°å­˜åœ¨å¾…åˆ†åŒºçš„ç£ç›˜</span><br><span class="line"></span><br><span class="line">2.åˆ†åŒºï¼šfdisk /dev/sdb ä¾æ¬¡è¾“å…¥m n p 1 ç©º ç©º w</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /dev çœ‹åˆ°sdb1æ–‡ä»¶å‡ºç°</span><br><span class="line"></span><br><span class="line">3.åˆ›å»ºæ–‡ä»¶æ ¼å¼ï¼šmkfs.ext4 /dev/sdb1</span><br><span class="line"></span><br><span class="line">4.æŒ‚è½½ï¼šå…ˆåˆ›å»ºç›®å½•ï¼Œ<span class="built_in">mkdir</span> -p /mnt/pan1</span><br><span class="line"></span><br><span class="line">vim /etc/fstab æ·»åŠ /dev/sdb1 /mnt/pan1 ext4 defaults 0 0</span><br><span class="line"></span><br><span class="line">é‡å¯è™šæ‹Ÿæœº <span class="built_in">df</span> -h æŸ¥çœ‹æŒ‚è½½æƒ…å†µ <span class="built_in">df</span> -hl /mnt/pan1 æŸ¥çœ‹ç›®å½•ç©ºé—´</span><br></pre></td></tr></table></figure><h1 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h1><h2 id="ç³»ç»Ÿå˜é‡"><a href="#ç³»ç»Ÿå˜é‡" class="headerlink" title="ç³»ç»Ÿå˜é‡"></a><strong>ç³»ç»Ÿå˜é‡</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$HOME</span> :å½“å‰ç™»å½•ç”¨æˆ·çš„ <span class="string">&quot;å®¶ç›®å½•&quot;</span> è·¯å¾„</span><br><span class="line"><span class="variable">$USER</span>ï¼šå½“å‰ç”¨æˆ·å</span><br><span class="line"><span class="variable">$RANDOM</span> å¯ä»¥éšæœºç”Ÿæˆ 0~32767ä¹‹é—´çš„æ•´æ•°æ•°å­—</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰å˜é‡"><a href="#è‡ªå®šä¹‰å˜é‡" class="headerlink" title="è‡ªå®šä¹‰å˜é‡"></a><strong>è‡ªå®šä¹‰å˜é‡</strong></h2><p>å˜é‡å&#x3D;å€¼ï¼›å¸¸é‡ï¼šreadonly</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xm=<span class="string">&quot;ä½ å¥½&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å§“åï¼š<span class="variable">$xm</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;å§“åï¼š$xm&#x27;</span></span><br><span class="line"><span class="built_in">readonly</span> p=3.14</span><br><span class="line">n=`<span class="built_in">cat</span> /etc/passwd | grep -c <span class="string">&quot;root&quot;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$n</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨shellç¼–ç¨‹ä¸­ï¼Œ&#96;&#96;ï¼ˆåå¼•å·ï¼‰çš„ä¸»è¦ä½œç”¨æ˜¯å‘½ä»¤æ›¿æ¢</strong>â€Œã€‚å…·ä½“æ¥è¯´ï¼Œåå¼•å·ä¼šå°†å…¶ä¸­çš„å‘½ä»¤æ‰§è¡Œï¼Œå¹¶å°†è¾“å‡ºç»“æœèµ‹å€¼ç»™å˜é‡ã€‚</p><p>##<strong>ç‰¹æ®Šå˜é‡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ç‰¹æ®Šå˜é‡</span><br><span class="line"><span class="variable">$n</span> nä¸ºnumberï¼Œ</span><br><span class="line"><span class="variable">$0</span>ä»£è¡¨è¯¥è„šæœ¬åç§°ï¼Œ<span class="variable">$1</span>-<span class="variable">$9</span>ä»£è¡¨ç¬¬ä¸€åˆ°ç¬¬ä¹ä¸ªå‚æ•°</span><br><span class="line"><span class="variable">$#</span> è·å–æ‰€æœ‰è¾“å…¥å‚æ•°çš„ä¸ªæ•°ï¼Œå¸¸ç”¨äºå¾ªç¯ï¼›</span><br><span class="line"><span class="variable">$@</span> ä»£è¡¨å‘½ä»¤è¡Œä¸­æ‰€æœ‰çš„å‚æ•°ï¼Œ<span class="variable">$@</span>ä¼šæŠŠæ¯ä¸ªå‚æ•°åŒºåˆ†å¯¹å¾…ï¼›</span><br><span class="line">$? è¿”å›æœ€åä¸€æ¬¡å‘½ä»¤æ‰§è¡Œçš„çŠ¶æ€ï¼Œè¿”å›0ä»£è¡¨æ­£ç¡®æ‰§è¡Œï¼Œè¿”å›é0ä»£è¡¨æ‰§è¡Œä¸æ­£ç¡®ã€‚</span><br><span class="line">$$ è¿›ç¨‹å·</span><br></pre></td></tr></table></figure><h2 id="read-è¯»å–ç»ˆç«¯è¾“å…¥"><a href="#read-è¯»å–ç»ˆç«¯è¾“å…¥" class="headerlink" title="read è¯»å–ç»ˆç«¯è¾“å…¥"></a><strong>read</strong> <strong>è¯»å–ç»ˆç«¯è¾“å…¥</strong></h2><p>-pï¼šæŒ‡å®šè¯»å–å€¼æ—¶çš„æç¤ºç¬¦ï¼›</p><p>-tï¼šæŒ‡å®šè¯»å–å€¼æ—¶ç­‰å¾…çš„æ—¶é—´ï¼ˆç§’ï¼‰ã€‚</p><p>read -p â€œè¯·è¾“å…¥å¯†ç ï¼šâ€ s</p><p>read -p â€œè¯·è¾“å…¥å¯†ç ï¼šâ€ -t 10 mima</p><h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a><strong>è¿ç®—ç¬¦</strong></h2><p><strong>èµ‹å€¼è¿ç®—ç¬¦</strong> <strong>&#x3D;</strong></p><p><strong>ç®—æ•°è¿ç®—ç¬¦</strong> <strong>+ - * &#x2F; %</strong></p><p><strong>æ¯”è¾ƒè¿ç®—ç¬¦</strong></p><p>å­—ç¬¦ä¸²æ¯”è¾ƒï¼š &#x3D;&#x3D; !&#x3D;</p><p>æ•°å€¼æ¯”è¾ƒï¼š-eq ç­‰äº -ne ä¸ç­‰äº -lt å°äº -le å°äºç­‰äº -gt å¤§äº -ge å¤§äºç­‰äº</p><p>ç±»å‹æƒé™ï¼š-f å­˜åœ¨ä¸”æ˜¯æ–‡ä»¶ -d å­˜åœ¨ä¸”æ˜¯ç›®å½•-r è¯» (read) -w å†™(write) -x æ‰§è¡Œ (execute)</p><p><strong>é€»è¾‘è¿ç®—ç¬¦</strong> <strong>-a -o !</strong></p><h2 id="ç®—æ•°è¿ç®—ç¬¦"><a href="#ç®—æ•°è¿ç®—ç¬¦" class="headerlink" title="ç®—æ•°è¿ç®—ç¬¦"></a><strong>ç®—æ•°è¿ç®—ç¬¦</strong></h2><ol><li><p><strong>$((è¿ç®—å¼)) æˆ– $[è¿ç®—å¼]</strong></p></li><li><p>**+, - , <em>, &#x2F;, % åŠ ï¼Œå‡ï¼Œä¹˜ï¼Œé™¤ï¼Œå–ä½™</em>*</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 3 + 4</span><br><span class="line">n1=3</span><br><span class="line">n2=4</span><br><span class="line"><span class="built_in">echo</span> $(((<span class="variable">$n1</span>+<span class="variable">$n2</span>*<span class="number">3</span>)/<span class="number">2</span>%<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> <span class="variable">$a</span> + <span class="variable">$b</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;a + b : <span class="variable">$val</span>&quot;</span></span><br><span class="line"><span class="built_in">let</span> c=(<span class="variable">$a</span> + <span class="variable">$b</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$c</span></span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©ç»“æ„"><a href="#é€‰æ‹©ç»“æ„" class="headerlink" title="é€‰æ‹©ç»“æ„"></a><strong>é€‰æ‹©ç»“æ„</strong></h2><p>æ”¹å˜ç¨‹åºçš„æ‰§è¡Œé¡ºåº</p><p>é€‰æ‹©ä¸€ä¸ªç»“æœ</p><p>æ¡ä»¶ä¸ºboolç±»å‹ï¼Œåªèƒ½é€‰æ‹©ä¸€ä¸ªæ‰§è¡Œï¼Œ</p><p>ifå’Œcaseä¸¤ç§</p><p>ifç»“æ„ï¼Œifã€ if elseã€å¤šé‡if</p><p>å¯ä»¥éšæ„åµŒå¥—ï¼Œä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥äº’ç›¸å®ç°ï¼Œé€‰æ‹©æ›´é€‚åˆçš„æ–¹æ³•å®ç°</p><h3 id="if-é€‰æ‹©ç»“æ„-â€”then-ç‹¬ç«‹ä¸€è¡Œ"><a href="#if-é€‰æ‹©ç»“æ„-â€”then-ç‹¬ç«‹ä¸€è¡Œ" class="headerlink" title="if é€‰æ‹©ç»“æ„ â€”then ç‹¬ç«‹ä¸€è¡Œ"></a><strong>if</strong> <strong>é€‰æ‹©ç»“æ„</strong> <strong>â€”then</strong> <strong>ç‹¬ç«‹ä¸€è¡Œ</strong></h3><p><strong>[  ] å¿…é¡»ç”¨ç©ºæ ¼éš”å¼€æ¡ä»¶åˆ¤æ–­ã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">if</span> [ æ¡ä»¶åˆ¤æ–­ ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">ç¨‹åº</span><br><span class="line"><span class="keyword">elif</span> [ æ¡ä»¶åˆ¤æ–­ ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">ç¨‹åº</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ç¨‹åº</span><br><span class="line">  <span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h2 id="caseè¯­å¥-ç­‰å€¼åˆ¤æ–­"><a href="#caseè¯­å¥-ç­‰å€¼åˆ¤æ–­" class="headerlink" title="caseè¯­å¥ ç­‰å€¼åˆ¤æ–­"></a>caseè¯­å¥ ç­‰å€¼åˆ¤æ–­</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> $å˜é‡å <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;value 1&quot;</span>ï¼‰</span><br><span class="line"></span><br><span class="line">å¦‚æœå˜é‡çš„å€¼ç­‰äºvalue 1ï¼Œåˆ™æ‰§è¡Œç¨‹åº1</span><br><span class="line"></span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;value 2&quot;</span>ï¼‰</span><br><span class="line"></span><br><span class="line">å¦‚æœå˜é‡çš„å€¼ç­‰äºvalue 2ï¼Œåˆ™æ‰§è¡Œç¨‹åº2</span><br><span class="line"></span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">â€¦çœç•¥å…¶ä»–åˆ†æ”¯â€¦</span><br><span class="line"></span><br><span class="line">***ï¼‰**</span><br><span class="line"></span><br><span class="line">å¦‚æœå˜é‡çš„å€¼éƒ½ä¸æ˜¯ä»¥ä¸Šçš„å€¼ï¼Œåˆ™æ‰§è¡Œæ­¤å¤„ç¨‹åº</span><br><span class="line"></span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ifç»“æ„</span></span><br><span class="line">sex=<span class="string">&quot;ç”·&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$sex</span> == <span class="string">&quot;ç”·&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å»åšé¥­&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$sex</span> == <span class="string">&quot;å¥³&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å»é€›è¡—&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å…¶ä»–&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># caseç»“æ„</span></span><br><span class="line">sex=<span class="string">&quot;ç”·&quot;</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$sex</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="string">&quot;å¥³&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2&quot;</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;3&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤šæ¡ä»¶åº”ç”¨</span></span><br><span class="line">a=3</span><br><span class="line">b=4</span><br><span class="line">c=<span class="string">&quot;s&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -lt <span class="variable">$b</span> -a <span class="variable">$c</span> == <span class="string">&quot;s&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;false&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="keyword">if</span> [ -f /root/a.txt ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ˜¯&quot;</span></span><br><span class="line"><span class="built_in">cat</span> /root/a.txt</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä¸æ˜¯&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h2 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a><strong>for</strong> <strong>å¾ªç¯</strong></h2><p>å¾ªç¯è¯­å¥</p><p>å¾ªç¯å…·å¤‡çš„ä¸¤ä¸ªæ¡ä»¶ï¼šå¾ªç¯æ¡ä»¶å’Œå¾ªç¯æ“ä½œ</p><p>æ¡ä»¶ä¸ºboolç±»å‹ï¼Œplsqlçš„å¾ªç¯èƒ½å¤Ÿè®©ä¸€æ®µä»£ç åå¤æ‰§è¡Œï¼Œä¸ºå®ç°è¿™ä¸€åŠŸèƒ½ä¸€å…±æä¾›äº†ä¸‰</p><p>ç§ä¸åŒçš„å¾ªç¯ç»“æ„ï¼š</p><p>loopç®€å•å¾ªç¯æˆ–æ— é™å¾ªç¯ï¼Œå…¶ä»–è¯­è¨€å«do while</p><p>forå¾ªç¯</p><p>whileå¾ªç¯</p><p>å¾ªç¯ç»“æ„</p><p>ä¸‰ç§å¾ªç¯å„æœ‰å·®å¼‚ä½†æ¯ä¸ªç»“æ„éƒ½åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šå¾ªç¯è¾¹ç•Œä»¥åŠå¾ªç¯ä½“ã€‚å¾ªç¯è¾¹ç•Œæœ‰ä¸€äº›</p><p>ä¿ç•™è¯ç»„æˆï¼ŒåŒ…æ‹¬åˆå§‹åŒ–å¾ªç¯ã€ç»ˆæ­¢å¾ªç¯æ¡ä»¶ã€å®Œæˆå¾ªç¯çš„ end loop è¯­å¥ã€‚</p><p>å¾ªç¯ç»“æ„å’Œé€‰æ‹©ç»“æ„éšæ„åµŒå¥—ï¼ŒåŒä¸€åŠŸèƒ½å¯ä»¥äº’ç›¸å®ç°ï¼Œé€‰æ‹©åˆé€‚çš„æ–¹æ³•</p><h2 id="WHILEå¾ªç¯"><a href="#WHILEå¾ªç¯" class="headerlink" title="WHILEå¾ªç¯"></a>WHILEå¾ªç¯</h2><p>whileå¾ªç¯æ—¶ä¸€ä¸ªæ¡ä»¶å¾ªç¯ï¼Œåªè¦å¾ªç¯è¾¹ç•Œå¤„å®šä¹‰çš„å¸ƒå°”æ¡ä»¶çš„å€¼ä¸ºçœŸï¼Œå¾ªç¯å°±ä¼šç»§ç»­ã€‚</p><p>whileå¾ªç¯çš„ç‰¹æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>å¾ªç¯ç»“æŸè¯­å¥</td><td>å½“å¾ªç¯è¾¹ç•Œçš„å¸ƒå°”è¡¨è¾¾å¼ä¸ºfalse æˆ–è€…nullæ—¶å¾ªç¯ç»“æŸã€‚</td></tr><tr><td>ç»“æŸå¾ªç¯è¯­å¥ä½ç½®</td><td>ç»“æŸå¾ªç¯è¯­å¥æ”¾åœ¨whileå…³é”®å­—åï¼Œåœ¨å¾ªç¯ä½“è¦æ‰§è¡Œå‰è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥whileå¾ªç¯å¯èƒ½ä¸€æ¬¡éƒ½ä¸ä¼šæ‰§è¡Œå¾ªç¯ä½“ã€‚</td></tr><tr><td>whileå¾ªç¯ä½¿ç”¨åœºæ™¯</td><td>æ— æ³•æ˜ç¡®å¾ªç¯ä½“ä¼šå¾ªç¯å‡ æ¬¡ï¼Œä½†æœ‰æ˜ç¡®çš„å¾ªç¯åœæ­¢æ¡ä»¶ï¼Œå¹¶ä¸”å¾ªç¯ä½“ä¸æ˜¯ä¸€å®šè¦æ‰§è¡Œçš„æƒ…å†µä½¿ç”¨ whileå¾ªç¯ã€‚</td></tr></tbody></table><h2 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a><strong>for</strong>å¾ªç¯</h2><p>forå¾ªç¯çš„ç‰¹æ€§</p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>å¾ªç¯ç»“æŸè¯­å¥</td><td>forå¾ªç¯è¾¾åˆ°èŒƒå›´åŒºé—´çš„å¾ªç¯æ¬¡æ•°å°±ç»“æŸï¼Œæˆ–è€…åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨exitç­‰è¯­å¥åœæ­¢ã€‚</td></tr><tr><td>ç»“æŸå¾ªç¯è¯­å¥ä½ç½®</td><td>æ¯æ¬¡å¾ªç¯ä½“æ‰§è¡Œåï¼Œç¨‹åºè‡ªåŠ¨é€’å¢å¾ªç¯ç´¢å¼•çš„å€¼ï¼Œç›´åˆ°è¶…è¿‡åŒºé—´èŒƒå›´ååœæ­¢å¾ªç¯ã€‚</td></tr><tr><td>whileå¾ªç¯ä½¿ç”¨åœºæ™¯</td><td>æœ‰æ˜ç¡®å¾ªç¯æ¬¡æ•°ï¼Œå¹¶ä¸æå‰ç»“æŸå¾ªç¯çš„æƒ…å†µä½¿ç”¨forå¾ªç¯ã€‚</td></tr></tbody></table><h3 id="for-i-in-é›†åˆ"><a href="#for-i-in-é›†åˆ" class="headerlink" title="for i in é›†åˆ"></a>for i in é›†åˆ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# åºåˆ—</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">seq</span> 1 5`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">\# ä½ç½®å‚æ•°</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$@</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸²</span></span><br><span class="line">s=<span class="string">&quot;a b c dd e&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$s</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># å‘½ä»¤ç»“æœ</span></span><br><span class="line">s=`<span class="built_in">ls</span> /root` <span class="built_in">echo</span> <span class="variable">$s</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$s</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$s</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h2 id="while-å¾ªç¯"><a href="#while-å¾ªç¯" class="headerlink" title="while å¾ªç¯"></a><strong>while</strong> <strong>å¾ªç¯</strong></h2><p>while [ æ¡ä»¶åˆ¤æ–­ ]</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">i=1</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -le 10 ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">i=$((<span class="variable">$i</span>+<span class="number">1</span>))</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># ä¸ç¡®å®šå¾ªç¯æ¬¡æ•°</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;åŠæ ¼äº†å—ï¼Ÿï¼ˆy/nï¼‰ï¼š&quot;</span> answer</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$answer</span> == <span class="string">&quot;n&quot;</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å­¦ä¹ åšä½œä¸šè€ƒè¯•&quot;</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;åŠæ ¼äº†å—ï¼Ÿï¼ˆy/nï¼‰ï¼š&quot;</span> answer</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ç»ˆäºåŠæ ¼äº†&quot;</span></span><br></pre></td></tr></table></figure><h2 id="ä¹˜æ³•è¡¨-åŒå±‚åµŒå¥—"><a href="#ä¹˜æ³•è¡¨-åŒå±‚åµŒå¥—" class="headerlink" title="ä¹˜æ³•è¡¨(åŒå±‚åµŒå¥—)"></a><strong>ä¹˜æ³•è¡¨</strong>(åŒå±‚åµŒå¥—)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">seq</span> 1 9`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> `<span class="built_in">seq</span> 1 <span class="variable">$i</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot; <span class="variable">$j</span> * <span class="variable">$i</span> = <span class="subst">$(($i * $j)</span>) &quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h2 id="å¾ªç¯æ§åˆ¶"><a href="#å¾ªç¯æ§åˆ¶" class="headerlink" title="å¾ªç¯æ§åˆ¶"></a><strong>å¾ªç¯æ§åˆ¶</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">continue</span></span><br></pre></td></tr></table></figure><h2 id="äºŒé‡å¾ªç¯"><a href="#äºŒé‡å¾ªç¯" class="headerlink" title="äºŒé‡å¾ªç¯"></a><strong>äºŒé‡å¾ªç¯</strong></h2><p>å¾ªç¯é‡Œé¢åµŒå¥—å¾ªç¯ï¼Œå¤–å±‚å¾ªç¯å…ˆå¼€å§‹ï¼Œå†…å±‚å¾ªç¯ç»“æŸåï¼Œå†å¼€å§‹å¤–å±‚çš„ä¸‹ä¸€ä¸ªå¾ªç¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">seq</span> 1 5`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> `<span class="built_in">seq</span> 1 5`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$j</span>&quot;</span>#å†…å±‚å¾ªç¯</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span>#å¤–å±‚å¾ªç¯</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰å‡½æ•°"><a href="#è‡ªå®šä¹‰å‡½æ•°" class="headerlink" title="è‡ªå®šä¹‰å‡½æ•°"></a><strong>è‡ªå®šä¹‰å‡½æ•°</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">name</span></span>()&#123;</span><br><span class="line">action;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> name</span><br><span class="line">&#123;</span><br><span class="line">Action;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">name</span><br></pre></td></tr></table></figure><p>å› ä¸ºshellè„šæœ¬æ˜¯ä»ä¸Šåˆ°ä¸‹é€è¡Œè¿è¡Œï¼Œä¸ä¼šåƒå…¶å®ƒè¯­è¨€ä¸€æ ·å…ˆç¼–è¯‘ï¼Œæ‰€ä»¥å‡½æ•°å¿…é¡»åœ¨è°ƒç”¨ä¹‹å‰ï¼Œå…ˆå£°æ˜ã€‚</p><p>å‡½æ•°è¿”å›å€¼ï¼Œreturnååªèƒ½è·Ÿæ•°å€¼n(0-255)</p><p>æ¥æ”¶è¿”å›å€¼æ–¹æ³•ï¼šåœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ echoå‘½ä»¤å°†ç»“æœè¾“å‡ºï¼Œåœ¨å‡½æ•°å¤–éƒ¨ä½¿ç”¨$()æˆ–è€…&#96;&#96;æ•è·ç»“æœã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ— è¾“å…¥æ— è¿”å›</span></span><br><span class="line"><span class="function"><span class="title">hello</span></span>()&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;test&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">hello</span><br><span class="line"><span class="comment">#å†™ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œè®¡ç®—ä¸¤ä¸ªè¾“å…¥å‚æ•°çš„å’Œ</span></span><br><span class="line"><span class="function"><span class="title">he</span></span>()&#123;</span><br><span class="line">s=0</span><br><span class="line">s=$((<span class="variable">$1</span> + <span class="variable">$2</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$s</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">he 3 65</span><br><span class="line">jieguo=`he 3 65`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å’Œæ˜¯ï¼š<span class="variable">$jieguo</span>&quot;</span></span><br></pre></td></tr></table></figure><p>###<strong>å¯ä»¥è¾“å…¥å‚æ•°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°ï¼š&quot;</span> n1</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°ï¼š&quot;</span> n2</span><br><span class="line"></span><br><span class="line">jieguo=`he <span class="variable">$n1</span> <span class="variable">$n2</span>`</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å’Œæ˜¯ï¼š<span class="variable">$jieguo</span>&quot;</span></span><br><span class="line"></span><br><span class="line">\#ä¹Ÿå¯ä»¥ä½¿ç”¨shellä½ç½®å‚æ•°ä¼ é€’åˆ°å‡½æ•°</span><br></pre></td></tr></table></figure><h3 id="å¯ä»¥äº’ç›¸è°ƒç”¨"><a href="#å¯ä»¥äº’ç›¸è°ƒç”¨" class="headerlink" title="å¯ä»¥äº’ç›¸è°ƒç”¨"></a><strong>å¯ä»¥äº’ç›¸è°ƒç”¨</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">he</span></span>()&#123;</span><br><span class="line"><span class="built_in">date</span></span><br><span class="line">hello</span><br><span class="line">s=0</span><br><span class="line">s=$((<span class="variable">$1</span> + <span class="variable">$2</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$s</span>&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€’å½’è‡ªå·±è°ƒç”¨è‡ªå·±"><a href="#é€’å½’è‡ªå·±è°ƒç”¨è‡ªå·±" class="headerlink" title="é€’å½’è‡ªå·±è°ƒç”¨è‡ªå·±"></a>é€’å½’è‡ªå·±è°ƒç”¨è‡ªå·±</h2><p># è¾“å…¥ä¸€ä¸ªç›®å½•æ˜¾ç¤ºé‡Œé¢çš„æ‰€æœ‰ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">fun</span></span>()&#123;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">ls</span> <span class="variable">$1</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">if</span> [ -d <span class="variable">$1</span>/<span class="variable">$i</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun /root</span><br></pre></td></tr></table></figure><h2 id="Shellå·¥å…·"><a href="#Shellå·¥å…·" class="headerlink" title="Shellå·¥å…·"></a>Shellå·¥å…·</h2><h3 id="sort"><a href="#sort" class="headerlink" title="sort"></a><strong>sort</strong></h3><p>sortå‘½ä»¤æ˜¯åœ¨Linuxé‡Œéå¸¸æœ‰ç”¨ï¼Œå®ƒå°†æ–‡ä»¶è¿›è¡Œæ’åºï¼Œå¹¶å°†æ’åºç»“æœæ ‡å‡†è¾“å‡ºã€‚</p><table><thead><tr><th>é€‰é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-n</td><td>ä¾ç…§æ•°å€¼çš„å¤§å°æ’åº</td></tr><tr><td>-r</td><td>ä»¥ç›¸åçš„é¡ºåºæ¥æ’åº</td></tr><tr><td>-t</td><td>è®¾ç½®æ’åºæ—¶æ‰€ç”¨çš„åˆ†éš”å­—ç¬¦</td></tr><tr><td>-k</td><td>æŒ‡å®šéœ€è¦æ’åºçš„åˆ—</td></tr></tbody></table><p>å‚æ•°ï¼šæŒ‡å®šå¾…æ’åºçš„æ–‡ä»¶åˆ—è¡¨</p><p>shellä¸‹é¢å»ºç«‹å¦‚ä¸‹æ–‡ä»¶sort.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bb:40:5.4</span><br><span class="line">bd:20:4.2</span><br><span class="line">xz:50:2.3</span><br><span class="line">cls:10:3.5</span><br><span class="line">ss:30:1.6</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§â€œï¼šâ€åˆ†å‰²åçš„ç¬¬ä¸‰åˆ—å€’åºæ’åºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> -t <span class="string">&quot;:&quot;</span> -nrk 3 /root/shell/sort.txt</span><br><span class="line"></span><br><span class="line">bb:40:5.4</span><br><span class="line">bd:20:4.2</span><br><span class="line">cls:10:3.5</span><br><span class="line">xz:50:2.3</span><br><span class="line">ss:30:1.6</span><br></pre></td></tr></table></figure><p><strong>grep ã€sedã€awk</strong>è¢«ç§°ä¸ºlinuxä¸­çš„ä¸‰å‰‘å®¢ã€‚</p><p>æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è¿™ä¸‰ä¸ªâ€å‰‘å®¢â€çš„ç‰¹é•¿ã€‚</p><ul><li><p>grep æ›´é€‚åˆå•çº¯çš„<strong>æŸ¥æ‰¾æˆ–åŒ¹é…</strong>æ–‡æœ¬</p></li><li><p>sed  æ›´é€‚åˆ<strong>ç¼–è¾‘åŒ¹é…åˆ°çš„æ–‡æœ¬</strong></p><ul><li>awk  æ›´é€‚åˆ<strong>æ ¼å¼åŒ–æ–‡æœ¬ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œè¾ƒå¤æ‚æ ¼å¼å¤„ç†</strong></li></ul></li></ul><h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a><strong>sed</strong></h3><p>sed: stream editorï¼ˆæµç¼–è¾‘å™¨ï¼‰çš„ç®€ç§°ã€‚</p><p>å®ƒä¸€æ¬¡å¤„ç†ä¸€è¡Œå†…å®¹ã€‚å¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼ˆâ€œæ¨¡å¼ç©ºé—´â€œï¼‰ï¼Œæ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®Œæˆåï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚</p><ul><li><p>p æ‰“å°ï¼Œäº¦å³å°†æŸä¸ªé€‰æ‹©çš„æ•°æ®å°å‡ºã€‚é€šå¸¸ p ä¼šä¸å‚æ•° sed -n ä¸€èµ·è¿è¡Œï½</p></li><li><p>i æ’å…¥ï¼Œ i çš„åé¢å¯ä»¥æ¥å­—ä¸²ï¼Œè€Œè¿™äº›å­—ä¸²ä¼šåœ¨æ–°çš„ä¸€è¡Œå‡ºç°(<strong>ç›®å‰çš„ä¸Šä¸€è¡Œ</strong>)ï¼›</p></li><li><p>a æ–°å¢ï¼Œ a çš„åé¢å¯ä»¥æ¥å­—ä¸²ï¼Œè€Œè¿™äº›å­—ä¸²ä¼šåœ¨æ–°çš„ä¸€è¡Œå‡ºç°(<strong>ç›®å‰çš„ä¸‹ä¸€è¡Œ</strong>)</p></li><li><p>s å–ä»£ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå–ä»£çš„å·¥ä½œå“©ï¼é€šå¸¸è¿™ä¸ª s çš„åŠ¨ä½œå¯ä»¥æ­é…æ­£è§„è¡¨ç¤ºæ³•ï¼</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.æ˜¾ç¤ºæ–‡ä»¶çš„ç¬¬ 2 è¡Œçš„å†…å®¹ï¼š</span><br><span class="line">sed -n <span class="string">&#x27;2 p&#x27;</span> /root/shell/sort.txt</span><br><span class="line">2.æ˜¾ç¤ºæ–‡ä»¶çš„ç¬¬ 2 è¡Œåˆ°ç¬¬ 4 è¡Œçš„å†…å®¹ï¼š</span><br><span class="line">sed -n <span class="string">&#x27;2,4 p&#x27;</span> /root/shell/sort.txt</span><br><span class="line">3.å°†æ–‡ä»¶ä¸­çš„bbå…¨éƒ¨æ›¿æ¢ä¸ºBB</span><br><span class="line">sed <span class="string">&#x27;s/bb/BB/g&#x27;</span> /root/shell/sort.txt</span><br><span class="line">4.ä»¥æ–‡ä»¶bbå¼€å¤´çš„ä¸Šä¸€è¡Œæ·»åŠ </span><br><span class="line">sed <span class="string">&#x27;/^bb/i hello&#x27;</span> /root/shell/sort.txt</span><br><span class="line">5.å°†æ–‡ä»¶ä¸­çš„då…¨éƒ¨åˆ é™¤</span><br><span class="line">sed <span class="string">&#x27;s/d//g&#x27;</span> /root/shell/sort.txt</span><br><span class="line">æ³¨ï¼šå¯ä»¥ä½¿ç”¨ç®¡é“ç¬¦è¿ç»­å¤„ç†,æ¥ç€é‡å®šå‘ä¿å­˜ï¼Œä½¿ç”¨\æ‹¼æ¥æ¢è¡Œ</span><br></pre></td></tr></table></figure><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a><strong>awk</strong></h3><p>ä¸€ä¸ªå®Œæ•´çš„awkå‘½ä»¤å½¢å¼å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk [options] <span class="string">&#x27;BEGIN&#123; commands &#125; &#123; commands &#125; END&#123; commands &#125;&#x27;</span> file</span><br></pre></td></tr></table></figure><p>-v æŒ‡å®š FS å’Œ OFS å­—æ®µåˆ†éš”ç¬¦å’Œè¾“å‡ºå­—æ®µåˆ†éš”ç¬¦</p><p>å†…ç½®å‚æ•°ï¼š</p><ul><li><p>NF åˆ†å‰²å®Œå­—æ®µçš„æ•°é‡</p></li><li><p>$1 ä»£è¡¨æ–‡æœ¬è¡Œä¸­çš„ç¬¬ 1 ä¸ªæ•°æ®å­—æ®µï¼›</p></li><li><p>$2 ä»£è¡¨æ–‡æœ¬è¡Œä¸­çš„ç¬¬ 2 ä¸ªæ•°æ®å­—æ®µï¼›</p></li></ul><p>è¾“å‡ºæŒ‡å®šåˆ—ï¼š{print $1,$2}</p><p>åˆ†éš”ç¬¦ç›¸åŒçš„æƒ…å†µè¾“å‡ºä¸€æ•´è¡Œï¼š{print}</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1.ä»¥:ä¸ºåˆ†éš”ç¬¦ï¼Œæ‰“å°ç¬¬2åˆ—å’Œç¬¬1åˆ—</span><br><span class="line">awk -v FS=<span class="string">&quot;:&quot;</span> <span class="string">&#x27;&#123;print $2,$1&#125;&#x27;</span> /root/shell/sort.txt</span><br><span class="line">2.ä»¥:ä¸ºåˆ†éš”ç¬¦ï¼Œæ‰“å°ç¬¬2åˆ—å’Œç¬¬1åˆ—ï¼Œåˆ—ä¹‹é—´ç”¨,åˆ†å‰²</span><br><span class="line">awk -v FS=<span class="string">&quot;:&quot;</span> -v OFS=<span class="string">&quot;,&quot;</span> <span class="string">&#x27;&#123;print $2,$1&#125;&#x27;</span> /root/shell/sort.txt</span><br><span class="line">3.æ·»åŠ åˆ—ä¿å­˜ä¸ºcsvï¼Œä¸‹è½½ï¼Œä½¿ç”¨excelæŸ¥çœ‹</span><br><span class="line">awk -v FS=<span class="string">&quot;:&quot;</span> -v OFS=<span class="string">&quot;,&quot;</span> <span class="string">&#x27;BEGIN&#123;print &quot;one,two,three&quot;&#125;&#123;print $2,$1,$3&#125;&#x27;</span></span><br><span class="line">/root/shell/sort.txt &gt; /root/shell/sort.csv</span><br><span class="line">4.ç¬¬äºŒåˆ—å¤§äº30</span><br><span class="line">awk -v FS=<span class="string">&quot;:&quot;</span> <span class="string">&#x27;&#123; if($2&gt;30)&#123;print $2&#125;&#125;&#x27;</span> /root/shell/sort.txt</span><br><span class="line">5.è¡Œåˆ—æ€»æ•°é‡</span><br><span class="line">awk -v FS=<span class="string">&quot;:&quot;</span> <span class="string">&#x27;BEGIN&#123;n=0&#125;&#123;for(i=1;i&lt;=NF;i++)&#123;n++&#125; &#125;END&#123;print n&#125;&#x27;</span> /root/shell/sort.txt</span><br><span class="line">æ³¨ï¼šå¯ä»¥ä½¿ç”¨ç®¡é“ç¬¦è¿ç»­å¤„ç†,æ¥ç€é‡å®šå‘ä¿å­˜ï¼Œä½¿ç”¨\æ‹¼æ¥æ¢è¡Œ</span><br></pre></td></tr></table></figure><h4 id="å†…ç½®å˜é‡"><a href="#å†…ç½®å˜é‡" class="headerlink" title="å†…ç½®å˜é‡"></a><strong>å†…ç½®å˜é‡</strong></h4><ol><li><p><strong><code>FS</code></strong><br>è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤ç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦ã€‚<br><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN&#123;FS=&quot;:&quot;&#125; &#123;print $1&#125;&#x27;</span> /etc/passwd  <span class="comment"># ç­‰ä»·äº `-F:`:cite[3]:cite[7]ã€‚</span></span><br></pre></td></tr></table></figure></li><li><p><strong><code>OFS</code></strong><br>è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤ç©ºæ ¼ã€‚<br><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN&#123;OFS=&quot;|&quot;&#125; &#123;print $1, $2&#125;&#x27;</span> data.txt  <span class="comment"># è¾“å‡ºå­—æ®µä»¥ `|` åˆ†éš”:cite[3]:cite[7]ã€‚</span></span><br></pre></td></tr></table></figure></li><li><p><strong><code>RS</code> å’Œ <code>ORS</code></strong></p><ul><li><p><code>RS</code>ï¼šè¾“å…¥è®°å½•åˆ†éš”ç¬¦ï¼ˆé»˜è®¤æ¢è¡Œç¬¦ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN&#123;RS=&quot;;&quot;&#125; &#123;print $0&#125;&#x27;</span> data.txt  <span class="comment"># ä»¥åˆ†å·åˆ†éš”è®°å½•:cite[3]:cite[7]ã€‚</span></span><br></pre></td></tr></table></figure></li><li><p><code>ORS</code>ï¼šè¾“å‡ºè®°å½•åˆ†éš”ç¬¦ï¼ˆé»˜è®¤æ¢è¡Œç¬¦ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN&#123;ORS=&quot;;&quot;&#125; &#123;print $0&#125;&#x27;</span> data.txt  <span class="comment"># è¾“å‡ºä»¥åˆ†å·ç»“å°¾:cite[3]:cite[7]ã€‚</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>NR</code> å’Œ <code>FNR</code></strong></p><ul><li><code>NR</code>ï¼šå…¨å±€è¡Œå·ï¼ˆè·¨æ–‡ä»¶ç´¯è®¡ï¼‰ã€‚</li><li><code>FNR</code>ï¼šå½“å‰æ–‡ä»¶è¡Œå·ï¼ˆæ¯ä¸ªæ–‡ä»¶ä»1å¼€å§‹ï¼‰ã€‚<br><strong>ç¤ºä¾‹</strong>ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print NR, FNR, $0&#125;&#x27;</span> file1.txt file2.txt  <span class="comment"># æ˜¾ç¤ºå…¨å±€å’Œæ–‡ä»¶è¡Œå·:cite[3]:cite[7]ã€‚</span></span><br></pre></td></tr></table></figure></li><li><p><strong><code>NF</code></strong><br>å½“å‰è¡Œçš„å­—æ®µæ•°ã€‚<br><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print NF, $NF&#125;&#x27;</span> data.txt  <span class="comment"># æ‰“å°å­—æ®µæ•°å’Œæœ€åä¸€ä¸ªå­—æ®µ:cite[3]:cite[7]ã€‚</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="mysqldumpå‘½ä»¤"><a href="#mysqldumpå‘½ä»¤" class="headerlink" title="mysqldumpå‘½ä»¤"></a>mysqldumpå‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.å¯¼å‡ºeducationæ•°æ®åº“é‡Œé¢çš„<span class="built_in">users</span>è¡¨çš„è¡¨æ•°æ®å’Œè¡¨ç»“æ„ï¼ˆä¸‹é¢ä»¥<span class="built_in">users</span>è¡¨ä¸ºä¾‹ï¼‰</span><br><span class="line">mysqldump-u[ç”¨æˆ·å]-h[ip]-p[å¯†ç ]-P[ç«¯å£å·]æ•°æ®åº“åè¡¨å&gt;å¯¼å‡ºçš„æ–‡ä»¶å.sql</span><br><span class="line">mysqldump -uroot-h127.0.0.1 -proot -P3306 education <span class="built_in">users</span>&gt;d:/user.sql</span><br><span class="line">å¯¼å‡ºå¤šå¼ è¡¨ï¼š</span><br><span class="line">mysqldump -uroot -proot--databases <span class="built_in">test</span> --tables t1 t2&gt;two.sql</span><br><span class="line">2.åªå¯¼å‡ºè¡¨ç»“æ„ä¸å¯¼è¡¨æ•°æ®ï¼Œæ·»åŠ -dâ€å‘½ä»¤å‚æ•°</span><br><span class="line">mysqldump -uroot -h127.0.0.1 -proot -P3306 -d education <span class="built_in">users</span>&gt;d:/user.sql</span><br><span class="line">3.åªå¯¼å‡ºè¡¨æ•°æ®ä¸å¯¼è¡¨ç»“æ„ï¼Œæ·»åŠ â€tâ€å‘½ä»¤å‚æ•°</span><br><span class="line">mysqldump -uroot -h127.0.0.1 -proot -P3306 -t education <span class="built_in">users</span>&gt;d:/user.sql</span><br><span class="line">4.å¯¼å‡ºæ•°æ®åº“çš„è¡¨ç»“æ„å’Œè¡¨æ•°æ®ï¼ˆå¯¼å…¥çš„æ—¶å€™éœ€è¦æŒ‡å®šæ•°æ®åº“ï¼Œä¿è¯æŒ‡å®šçš„æ•°æ®åº“å­˜åœ¨ï¼‰</span><br><span class="line">å¯¼å‡ºå‘½ä»¤ï¼šmysqldump-h127.0.0.1-P3306-uroot-proot education&gt;d:/database.sql</span><br><span class="line">å¯¼å…¥å‘½ä»¤ï¼šmysql-uroot-proot-h127.0.0.1-P3306 education&lt;d:/database.sql</span><br><span class="line">5.å¯¼å‡ºç‰¹å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨æ ¼çš„è¡¨ç»“æ„åŠå…¶æ•°æ®ï¼Œæ·»åŠ -databases<span class="string">&quot;å‘½ä»¤å‚æ•°ï¼ˆå¯¼å…¥çš„æ—¶ä¾¯ç›´æ¥æ‰§è¡Œå¯¼å‡ºsqlå°±è¡Œï¼‰</span></span><br><span class="line"><span class="string">å¯¼å‡ºå‘½ä»¤ï¼šmysqldump-h127.0.0.1-P3306-uroot-proot education-databases education&gt;database.sql</span></span><br><span class="line"><span class="string">å¯¼å…¥å‘½ä»¤ï¼šmysql-uroot-proot-h127.0.0.1-P3306&lt;d:/all_database.sql</span></span><br></pre></td></tr></table></figure><h1 id="ä¸Šæœºç»ƒä¹ 17"><a href="#ä¸Šæœºç»ƒä¹ 17" class="headerlink" title="ä¸Šæœºç»ƒä¹ 17"></a>ä¸Šæœºç»ƒä¹ 17</h1><p>å®ç°æ¯å¤©å‡Œæ™¨3ç‚¹10åˆ†å¤‡ä»½æ•°æ®åº“teståˆ°&#x2F;root&#x2F;backup&#x2F;,db<br><strong>ä¸€ã€ç¼–å†™shellè„šæœ¬ä¸ºroot&#x2F;shell&#x2F;backdb.sh</strong></p><ol><li>åˆ¤æ–­è·¯å¾„root&#x2F;backup&#x2F;dbæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ›å»ºï¼Œå­˜åœ¨å¼€å§‹å¤‡ä»½</li><li>å¤‡ä»½åçš„æ–‡ä»¶ä»¥æ—¶é—´å‘½åï¼Œå¦‚20230401110101.sal</li><li>åœ¨å¤‡ä»½çš„åŒæ—¶ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰10å¤©å‰çš„å¤‡ä»½æ•°æ®åº“æ–‡ä»¶ï¼Œæœ‰åˆ™åˆ é™¤ä¹‹</li></ol><p><strong>äºŒã€ç¼–å†™å®šæ—¶ä»»åŠ¡ï¼Œä»»åŠ¡æ˜¯æ‰§è¡Œä¸Šé¢çš„sheè„šæœ¬</strong></p><h1 id="Linuxæ ¹ç›®å½•æ‰©å®¹"><a href="#Linuxæ ¹ç›®å½•æ‰©å®¹" class="headerlink" title="Linuxæ ¹ç›®å½•æ‰©å®¹"></a>Linuxæ ¹ç›®å½•æ‰©å®¹</h1><p>ç¬¬ä¸€æ­¥ï¼šå…ˆå…³æœº<br>ç¬¬äºŒæ­¥ï¼šæ·»åŠ ç¡¬ç›˜-SCSI-åˆ›å»ºæ–°è™šæ‹Ÿç£ç›˜-è®¾ç½®éœ€è¦æ·»åŠ çš„ç£ç›˜å¤§å°ï¼ˆå†™ä½œæœ€å¤§ç£ç›˜å¤§å°ï¼‰ï¼ˆ10Gï¼‰ï¼ˆå­˜å‚¨ä¸ºå•ä¸ªæ–‡ä»¶ï¼‰-ä¸‹ä¸€æ­¥-å®Œæˆ</p><p><img src="/2025/05/16/CentOS7%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20250716103919722.png" alt="image-20250716103919722"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç£ç›˜å ç”¨æƒ…å†µ</span></span><br><span class="line"><span class="built_in">df</span> -lh</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–°å¢ç‰©ç†ç£ç›˜ç›˜ç¬¦</span></span><br><span class="line"><span class="built_in">ls</span> /dev/sd*</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–°å¢ç‰©ç†æƒ…å†µç£ç›˜</span></span><br><span class="line">fdisk -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºç‰©ç†å·</span></span><br><span class="line">pvcreate /dev/sdb <span class="comment">#sdbä¸ºä¸Šä¸€æ­¥ä¸­æ–°å¢çš„ç›˜ç¬¦ï¼ŒæŒ‰å®é™…æƒ…å†µè®¾ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ ¹ç›®å½•æ‰€åœ¨å·ç»„åç§°</span></span><br><span class="line">vgdisplay <span class="comment">#vgs  </span></span><br><span class="line">pvdisplay <span class="comment">#pvs</span></span><br><span class="line">lvdisplay <span class="comment">#lvs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬å››æ­¥ï¼šä½¿ç”¨æ–°å¢ç‰©ç†å·æ‰©å®¹æ ¹ç›®å½•å·ç»„</span></span><br><span class="line">vgextend centos /dev/sdb</span><br><span class="line"><span class="comment"># ç¬¬äº”æ­¥ï¼šæ‰©å®¹æ ¹ç›®å½•æ‰€åœ¨é€»è¾‘å·å¤§å°(æŒ‰ç…§Gæ‰©å®¹)</span></span><br><span class="line">lvextend -L +10G /dev/centos/root</span><br><span class="line">lvextend -l +2559 /dev/centos/root <span class="comment">#è‹¥ä»¥ä¸Šä¸è¡Œåˆ™æ‰§è¡Œè¿™æ¡ï¼Œ2559ä¸ºä¸ŠæŠ¥é”™ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># ç¬¬å…­æ­¥ï¼šé‡æ–°è¯»å–æ ¹ç›®å½•é€»è¾‘å·ä¿¡æ¯</span></span><br><span class="line">xfs_growfs /dev/mapper/centos-root</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰©å®¹å ç£ç›˜å ç”¨</span></span><br><span class="line"><span class="built_in">df</span> -lh</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜æŒ‚è½½</span></span><br><span class="line">lsblk</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>![image-20250716103919722](Pasted image 20250715222012.png)</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CentOS </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracleæ•°æ®åº“ç¬”è®°</title>
      <link href="/2025/04/28/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/04/28/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯æ•°æ®åº“"><a href="#ä»€ä¹ˆæ˜¯æ•°æ®åº“" class="headerlink" title="ä»€ä¹ˆæ˜¯æ•°æ®åº“"></a>ä»€ä¹ˆæ˜¯æ•°æ®åº“</h1><ul><li><p>æ•°æ®åº“ï¼ˆDatabaseï¼ŒDBï¼‰</p></li><li><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆBatabase Management Systemï¼ŒDBMSï¼‰</p></li><li><p>ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼ˆStructured Query Languageï¼ŒSQLï¼‰</p></li><li><p>å…³ç³»å‹æ•°æ®åº“ï¼ˆRelational Databaseï¼ŒRDBï¼‰ï¼šç›®å‰åº”ç”¨æœ€å¹¿æ³›çš„æ•°æ®åº“ã€‚</p><p>å¸¸è§çš„äº”ç§å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼š<br>â‘ Oracle Databaseï¼šç”²éª¨æ–‡å…¬å¸<br>â‘¡SQL Serverï¼šå¾®è½¯å…¬å¸<br>â‘¢DB2ï¼šIBM å…¬å¸<br>â‘£PostgreSQLï¼šå¼€æº<br>â‘¤MySQLï¼šå¼€æº</p></li></ul><h2 id="æœ¯è¯­åŠæ¦‚å¿µç®€å•ä»‹ç»"><a href="#æœ¯è¯­åŠæ¦‚å¿µç®€å•ä»‹ç»" class="headerlink" title="æœ¯è¯­åŠæ¦‚å¿µç®€å•ä»‹ç»"></a>æœ¯è¯­åŠæ¦‚å¿µç®€å•ä»‹ç»</h2><ol><li>æœåŠ¡å™¨ï¼šç”¨äºæ¥æ”¶å¹¶å¤„ç†å…¶å®ƒç¨‹åºå‘å‡ºçš„è¯·æ±‚çš„ç¨‹åºï¼ˆè½¯ä»¶ï¼‰ï¼Œæˆ–è€…æ˜¯å®‰è£…æ­¤ç±»ç¨‹åºçš„è®¾å¤‡ï¼ˆè®¡ç®—æœºï¼‰ã€‚</li><li>å®¢æˆ·ç«¯ï¼šå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚çš„ç¨‹åºï¼ˆè½¯ä»¶ï¼‰ï¼Œæˆ–è€…æ˜¯å®‰è£…æ­¤ç±»ç¨‹åºçš„è®¾å¤‡ï¼ˆè®¡ç®—æœºï¼‰ã€‚</li><li><strong>è¡¨ï¼ˆtableï¼‰</strong>ï¼šç±»ä¼¼ Excelï¼Œç”±è¡Œå’Œåˆ—ç»„æˆçš„äºŒç»´è¡¨ã€‚è¡Œï¼ˆRowï¼‰å’Œåˆ—ï¼ˆColumnï¼‰</li><li><strong>å­—æ®µ</strong>ï¼šè¡¨ä¸­çš„åˆ—ï¼ˆå‚ç›´æ–¹å‘ï¼‰ï¼Œå«åšä¸€ä¸ªå­—æ®µ</li><li><strong>è®°å½•</strong>ï¼šè¡¨çš„è¡Œï¼ˆæ°´å¹³æ–¹å‘ï¼‰ï¼Œå«åšä¸€æ¡è®°å½•ã€‚ã€æ³¨æ„ã€‘å…³ç³»æ•°æ®åº“å¿…é¡»ä»¥è¡Œä¸ºå•ä½è¿›è¡Œæ•°æ®è¯»å†™ã€‚</li><li><strong>å•å…ƒæ ¼</strong>ï¼šè¡Œåˆ—äº¤æ±‡å¤„ã€‚ã€æ³¨æ„ã€‘ä¸ Excel ä¸åŒï¼Œä¸€ä¸ªå•å…ƒæ ¼åªèƒ½è¾“å…¥ä¸€ä¸ªæ•°æ®ã€‚</li></ol><h2 id="SQLæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#SQLæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="SQLæ˜¯ä»€ä¹ˆï¼Ÿ"></a>SQLæ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li><p>ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€(Structured Query Language)ï¼Œæ˜¯æ•°æ®åº“ç¼–ç¨‹çš„æ ¸å¿ƒè¯­è¨€ã€‚</p></li><li><p>SQL è¯­å¥ï¼šç”¨å…³é”®å­—ã€è¡¨åå’Œåˆ—åç­‰ç»„åˆè€Œæˆçš„ä¸€æ¡è¯­å¥ã€‚</p></li><li><p>SQLéå¸¸æ¥è¿‘è‹±è¯­ï¼Œå…³é”®å­—å…¶å®éƒ½æ˜¯è‹±æ–‡å•è¯ï¼Œè®°ä½å•è¯çš„æ„æ€ï¼Œä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ã€‚</p></li></ul><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><p>ç¯å¢ƒå˜é‡ä¸€èˆ¬æ˜¯æŒ‡åœ¨æ“ä½œç³»ç»Ÿä¸­ç”¨æ¥&#x3D;&#x3D;æŒ‡å®šæ“ä½œç³»ç»Ÿè¿è¡Œç¯å¢ƒçš„ä¸€äº›å‚æ•°&#x3D;&#x3D;ã€‚</p><h2 id="SQLåˆ†ç±»"><a href="#SQLåˆ†ç±»" class="headerlink" title="SQLåˆ†ç±»"></a>SQLåˆ†ç±»</h2><ol><li><strong>DQL</strong>ï¼ˆData Query Languageï¼Œæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼‰:ä¸€ç§ç”¨äºä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®çš„è¯­<br>è¨€,ä»£è¡¨å…³é”®å­—ä¸ºselectã€‚</li><li><strong>DDL</strong>ï¼ˆData Definition Languageï¼Œæ•°æ®å®šä¹‰è¯­è¨€ï¼‰:ç”¨æ¥åˆ›å»ºæ•°æ®åº“ä¸­çš„å„ç§å¯¹è±¡ï¼Œ<br>åˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹è¡¨çš„ç»“æ„ï¼Œä»£è¡¨å…³é”®å­—ä¸ºcreateã€dropã€alterã€‚</li><li><strong>DML</strong>ï¼ˆData Manipulation Languageï¼Œæ•°æ®æ“ä½œè¯­è¨€ï¼‰:ç”¨äºæ•°æ®åº“ä¸­å¯¹æ•°æ®çš„æ“<br>çºµï¼Œä»£è¡¨å…³é”®å­—ä¸ºinsertã€delete ã€updateã€‚</li><li><strong>DCL</strong>ï¼ˆData Control Languageï¼Œæ•°æ®æ§åˆ¶è¯­è¨€ï¼‰:ç”¨æ¥æˆäºˆæˆ–å›æ”¶è®¿é—®æ•°æ®åº“çš„æŸç§<br>ç‰¹æƒã€‚ä»£è¡¨å…³é”®å­—ä¸ºgrantã€revokeã€‚</li><li><strong>TCL</strong>ï¼ˆTrasactional Control Languag, äº‹åŠ¡æ§åˆ¶è¯­è¨€ï¼‰ï¼šç”¨äºç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ï¼ŒåŒ…<br>æ‹¬commitã€rollbackå’Œsavepointä¸‰æ¡è¯­å¥ã€‚</li></ol><h2 id="å»é‡"><a href="#å»é‡" class="headerlink" title="å»é‡"></a>å»é‡</h2><p>å…³é”®å­—ï¼š<strong>distinct</strong></p><p>å¦‚æœå¸Œæœ›ä¸€ä¸ªåˆ—è¡¨æ²¡æœ‰é‡å¤å€¼ï¼Œå¯ä»¥åˆ©ç”¨distinctå­å¥ä»ç»“æœé›†ä¸­é™¤å»é‡å¤çš„è¡Œã€‚</p><p>æ ¼å¼ï¼šSELECT DISTINCT åˆ—åç§° FROM è¡¨å;</p><p>distinct å®ƒåªèƒ½æ”¾åœ¨æ‰€æœ‰åˆ—çš„æœ€å‰é¢ï¼ˆå®ƒçš„å‰é¢ä¸èƒ½å†™ä»»ä½•åˆ—ï¼‰</p><p>distinct å•åˆ—ï¼šå¯¹å•åˆ—è¿›è¡Œå»é‡<br>distinct å¤šåˆ—ï¼š&#x3D;&#x3D;å½“ä¸”ä»…å½“æ‰€æœ‰åˆ—çš„å€¼åŒæ—¶ç›¸ç­‰æ—¶ï¼Œæ‰æ˜¯é‡å¤æ•°æ®&#x3D;&#x3D;</p><p>select distinct deptno from emp;</p><h2 id="dualè™šæ‹Ÿè¡¨"><a href="#dualè™šæ‹Ÿè¡¨" class="headerlink" title="dualè™šæ‹Ÿè¡¨"></a>dualè™šæ‹Ÿè¡¨</h2><p>dualæ˜¯ä¸ªè™šæ‹Ÿè¡¨ï¼Œ&#x3D;&#x3D;åªæœ‰ä¸€è¡Œä¸€åˆ—ï¼ŒåŸºæœ¬ä¸Šoracleå¼•å…¥dualä¸ºçš„å°±æ˜¯ç¬¦åˆè¯­æ³•ï¼&#x3D;&#x3D;</p><p>å› ä¸ºåœ¨oracleå½“ä¸­æŸ¥è¯¢è¯­å¥å¿…é¡»è¦æœ‰å…³é”®å­— select â€¦.from tablename; åªæœ‰è¿™æ ·è¯­å¥æ‰å®Œ<br>æ•´ï¼Œè¦æ˜¯æ²¡æœ‰è¡¨åå°±æ— æ³•æŸ¥è¯¢ï¼Œè€Œæ—¶é—´ï¼Œæ—¥æœŸç­‰ä¸å­˜åœ¨äºä»»ä½•è¡¨ï¼Œè¿™ä¸ªæ—¶å€™å°±å¼•å…¥äº†<br>dual è™šè¡¨çš„æ¦‚å¿µã€‚</p><h2 id="ä¼ªåˆ—"><a href="#ä¼ªåˆ—" class="headerlink" title="ä¼ªåˆ—"></a>ä¼ªåˆ—</h2><p>rownum:ä¸æ˜¯åœ¨ç‰©ç†ä¸ŠçœŸå®å­˜åœ¨çš„åˆ—ï¼Œå®ƒæ˜¯å¯¹æŸ¥è¯¢ç»“æœç»™äº†ä¸€ä¸ªä»ä¸€å¼€å§‹çš„æ’åˆ—æ•°æ®ï¼Œ<br>è·å–åˆ°ç»“æœé›†ä¹‹åå†åŠ ä¸Šå»çš„ä¸€ä¸ªåˆ—</p><p>ROWNUMä¸ROWIDä¸åŒï¼Œ&#x3D;&#x3D;ROWIDæ˜¯æ’å…¥è®°å½•æ—¶ç”Ÿæˆï¼ŒROWNUMæ˜¯æŸ¥è¯¢æ•°æ®æ—¶ç”Ÿæˆã€‚&#x3D;&#x3D;<br>ROWIDæ ‡è¯†çš„æ˜¯è¡Œçš„<code>ç‰©ç†åœ°å€</code>ã€‚ROWNUMæ ‡è¯†çš„æ˜¯æŸ¥è¯¢ç»“æœä¸­çš„<code>è¡Œçš„æ¬¡åº</code>ã€‚<br>é€šè¿‡ROWNUMä¼ªåˆ—å¯ä»¥é™åˆ¶æŸ¥è¯¢ç»“æœé›†ä¸­è¿”å›çš„è¡Œæ•°</p><h1 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h1><ul><li><strong>char</strong>ç±»å‹ï¼Œæœ€å¤§é•¿åº¦2000ä¸ªå­—èŠ‚ï¼ŒåŒºåˆ«ä¸Cè¯­è¨€çš„charç±»å‹ä¸€ä¸ªå­—èŠ‚ã€‚</li><li><strong>varchar2</strong>å­˜å‚¨å­—ç¬¦ä¸²ç±»å‹ï¼Œæ ¹æ®æ•°æ®å®é™…é•¿åº¦è‡ªåŠ¨è°ƒæ•´ï¼Œæœ€å¤§é•¿åº¦4000ä¸ªå­—èŠ‚ã€‚</li><li><strong>number</strong>ç±»å‹å…·æœ‰ç²¾åº¦ï¼Œæ ¼å¼number(SCALE,PRECISION), ç²¾åº¦æŒ‡å®šæ‰€æœ‰æ•°å­—ä½çš„ä¸ªæ•°ï¼ŒèŒƒå›´æŒ‡å®šå°æ•°çš„ä½æ•°ã€‚</li><li><strong>data</strong>ç±»å‹  å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´çš„ç»„åˆæ•°ã€‚</li><li>**timestamp:**æ—¶é—´æˆ³ç±»å‹,å¯å­˜æ”¾ä¸–çºªã€çºªå…ƒã€å¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€ç§’è¿˜å¯ä»¥å­˜æ”¾ç§’å6ä½ã€‚</li></ul><h2 id="ä¸‰å¤§èŒƒå¼"><a href="#ä¸‰å¤§èŒƒå¼" class="headerlink" title="ä¸‰å¤§èŒƒå¼"></a>ä¸‰å¤§èŒƒå¼</h2><ul><li><p>1NF åŸå­æ€§çš„ï¼Œä¸å¯åˆ†ã€‚å³å®ä½“ä¸­çš„æŸä¸ªå±æ€§ä¸èƒ½æœ‰å¤šä¸ªå€¼æˆ–è€…ä¸èƒ½æœ‰é‡å¤çš„å±æ€§ã€‚</p></li><li><p>2NF å®ä½“çš„å±æ€§å®Œå…¨ä¾èµ–äºä¸»å…³é”®å­—ã€‚ä¸ºå®ç°åŒºåˆ†é€šå¸¸éœ€è¦ä¸ºè¡¨åŠ ä¸Šä¸€ä¸ªåˆ—ï¼Œä»¥å­˜å‚¨å„ä¸ªå®ä¾‹çš„æƒŸä¸€æ ‡è¯†ã€‚</p></li><li><p>3NF è¡¨ä¸­ä¸åŒ…å«å·²åœ¨å…¶å®ƒè¡¨ä¸­å·²åŒ…å«çš„éä¸»å…³é”®å­—ä¿¡æ¯ã€‚</p><p><strong>ç”¨æˆ‘çš„è¯ç†è§£å°±æ˜¯ï¼š</strong></p><ol><li><strong>ç¬¬ä¸€èŒƒå¼ï¼šåŸå­æ€§ä¸å¯åˆ†ã€‚å®ä½“ä¸­çš„å±æ€§ä¸èƒ½æœ‰å¤šä¸ªå€¼æˆ–å¤šä¸ªé‡å¤å±æ€§ã€‚</strong></li><li><strong>ç¬¬äºŒèŒƒå¼ï¼šå®ä½“å±æ€§å®Œå…¨ä¾èµ–ä¸»é”®ã€‚</strong></li><li><strong>ç¬¬ä¸‰èŒƒå¼ï¼šè¡¨ä¸­ä¸å«æœ‰å…¶ä»–è¡¨ä¸­çš„éä¸»é”®ä¿¡æ¯ã€‚</strong></li></ol></li></ul><h2 id="è¡¨å’Œè¡¨ç©ºé—´çš„å…³ç³»"><a href="#è¡¨å’Œè¡¨ç©ºé—´çš„å…³ç³»" class="headerlink" title="è¡¨å’Œè¡¨ç©ºé—´çš„å…³ç³»"></a>è¡¨å’Œè¡¨ç©ºé—´çš„å…³ç³»</h2><ul><li>ä¸€ä¸ªè¡¨åªèƒ½å±äºä¸€ä¸ªè¡¨ç©ºé—´ï¼Œ</li><li>ä¸€ä¸ªè¡¨ç©ºé—´å¯ä»¥æ”¾ä»»æ„å¤šä¸ªè¡¨</li><li>ä¸€ä¸ªè¡¨ç©ºé—´è‡³å°‘æœ‰ä¸€ä¸ªå­˜å‚¨æ–‡ä»¶.dbfæ–‡ä»¶ï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œè€Œä¸”è¿™å¤šä¸ªæ•°æ®æ–‡ä»¶å¯ä»¥åœ¨ä¸åŒ ä½ç½® </li><li>ä¸€ä¸ªç”¨æˆ·æœ‰ä¸€ä¸ªé»˜è®¤çš„è¡¨ç©ºé—´ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥åœ¨é»˜è®¤è¡¨ç©ºé—´å¤–çš„å…¶å®ƒè¡¨ç©ºé—´å»ºè¡¨</li></ul><h3 id="åˆ›å»ºè¡¨ç©ºé—´"><a href="#åˆ›å»ºè¡¨ç©ºé—´" class="headerlink" title="åˆ›å»ºè¡¨ç©ºé—´"></a><strong>åˆ›å»ºè¡¨ç©ºé—´</strong></h3><p>create tablespace è¡¨ç©ºé—´å datafile â€˜æ•°æ®æ–‡ä»¶è·¯å¾„â€™ size åˆå§‹å¤§å°ï¼ˆ2Gï¼‰ autoextend on next æ¯æ¬¡æ‰©å±•çš„å¤§å°(100M) maxsize æœ€å¤§å®¹é‡ï¼ˆunlimitedï¼‰;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> tablespace ora</span><br><span class="line">datafile <span class="string">&#x27;c:\test\tab.dbf&#x27;</span></span><br><span class="line">size <span class="number">2</span>G autoextend <span class="keyword">on</span> next <span class="number">100</span>M maxsize unlimited;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºä¸´æ—¶è¡¨ç©ºé—´ï¼š"><a href="#åˆ›å»ºä¸´æ—¶è¡¨ç©ºé—´ï¼š" class="headerlink" title="åˆ›å»ºä¸´æ—¶è¡¨ç©ºé—´ï¼š"></a><strong>åˆ›å»ºä¸´æ—¶è¡¨ç©ºé—´ï¼š</strong></h3><p>create temporary tablespace ä¸´æ—¶è¡¨ç©ºé—´å tempfile â€˜æ•°æ®æ–‡ä»¶è·¯å¾„â€™ size åˆå§‹å¤§å°</p><p>ï¼ˆ2Gï¼‰ autoextend on next æ¯æ¬¡æ‰©å±•çš„å¤§å°(100M) maxsize æœ€å¤§å®¹é‡ï¼ˆunlimitedï¼‰;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> temporary tablespace tabtemp</span><br><span class="line">tempfile <span class="string">&#x27;c:\test\tabtemp.dbf&#x27;</span></span><br><span class="line">size <span class="number">2</span>G autoextend <span class="keyword">on</span> next <span class="number">100</span>M maxsize unlimited;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="headerlink" title="åˆ›å»ºç”¨æˆ·"></a><strong>åˆ›å»ºç”¨æˆ·</strong></h3><p>create user ç”¨æˆ·å identified by å¯†ç  default tablespace è¡¨ç©ºé—´å temporary tablespace</p><p>ä¸´æ—¶è¡¨ç©ºé—´å;</p><p>defaultåé¢çš„è¯­å¥æ˜¯ä¸ºç”¨æˆ·æŒ‡å®šé»˜è®¤è¡¨ç©ºé—´å’Œä¸´æ—¶è¡¨ç©ºé—´ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤çš„è¡¨ç©ºé—´æ˜¯usersè¡¨ç©ºé—´ï¼Œä¸´æ—¶è¡¨ç©ºé—´æ˜¯temp</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> orastudy</span><br><span class="line">identified <span class="keyword">by</span> oracle <span class="keyword">default</span> tablespace ora temporary tablespace tabtemp;</span><br></pre></td></tr></table></figure><h3 id="ç”¨æˆ·æƒé™èµ‹äºˆ"><a href="#ç”¨æˆ·æƒé™èµ‹äºˆ" class="headerlink" title="ç”¨æˆ·æƒé™èµ‹äºˆ"></a><strong>ç”¨æˆ·æƒé™èµ‹äºˆ</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> æƒé™ <span class="keyword">to</span> ç”¨æˆ·å;</span><br><span class="line"><span class="keyword">grant</span> resource,<span class="keyword">connect</span> <span class="keyword">to</span> ora; <span class="comment">--è¿æ¥æƒé™å’Œèµ„æºæƒé™</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">any</span> <span class="keyword">table</span> <span class="keyword">to</span> ora; <span class="comment">--å»ºè¡¨æƒé™</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">any</span> tablespace <span class="keyword">to</span> ora; <span class="comment">--å»ºè¡¨ç©ºé—´æƒé™</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">any</span> <span class="keyword">table</span> <span class="keyword">to</span> ora; <span class="comment">--åªè¯»æƒ</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">any</span> <span class="keyword">view</span> <span class="keyword">to</span> bw; <span class="comment">--åˆ›å»ºè§†å›¾æƒé™</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">any</span> <span class="keyword">table</span> <span class="keyword">to</span> ora; <span class="comment">--ç»™oraç”¨æˆ·é¢„ç¼–è¯‘è¡¨çš„æƒé™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--æŸ¥çœ‹è§’è‰²æƒé™ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> role_sys_privs;</span><br><span class="line"><span class="keyword">grant</span> dba <span class="keyword">to</span> ora; <span class="comment">--ç®¡ç†å‘˜æƒé™</span></span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤è¡¨ç©ºé—´"><a href="#åˆ é™¤è¡¨ç©ºé—´" class="headerlink" title="åˆ é™¤è¡¨ç©ºé—´"></a><strong>åˆ é™¤è¡¨ç©ºé—´</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> tablespace student1 including contents;</span><br></pre></td></tr></table></figure><p>including contentsé€‰é¡¹ç”¨äºåˆ é™¤è¡¨ç©ºé—´æ—¶åŒ…å«å…¶å†…å®¹ã€‚å¦‚æœä¸ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼Œè¡¨ç©ºé—´ä¼šè¢«åˆ é™¤ï¼Œä½†æ•°æ®æ–‡ä»¶ä»ç„¶å­˜åœ¨ï¼Œç£ç›˜ç©ºé—´ä¸ä¼šè¢«é‡Šæ”¾ã€‚ä½¿ç”¨è¿™ä¸ªé€‰é¡¹å¯ä»¥ç¡®ä¿è¡¨ç©ºé—´åŠå…¶å†…å®¹è¢«å®Œå…¨åˆ é™¤ï¼Œä»è€Œé‡Šæ”¾ç£ç›˜ç©ºé—´</p><h3 id="æ‰©å®¹-è¡¨ç©ºé—´"><a href="#æ‰©å®¹-è¡¨ç©ºé—´" class="headerlink" title="æ‰©å®¹ è¡¨ç©ºé—´"></a><strong>æ‰©å®¹ è¡¨ç©ºé—´</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> tablespace student</span><br><span class="line"><span class="keyword">add</span> datafile <span class="string">&#x27;C:\test\student.dbf&#x27;</span> size <span class="number">100</span>m autoextend <span class="keyword">on</span> next <span class="number">10</span>m maxsize unlimited;</span><br></pre></td></tr></table></figure><h2 id="çº¦æŸ"><a href="#çº¦æŸ" class="headerlink" title="çº¦æŸ"></a>çº¦æŸ</h2><h3 id="1-åˆ—çº§çº¦æŸï¼ˆColumn-Level-Constraintsï¼‰"><a href="#1-åˆ—çº§çº¦æŸï¼ˆColumn-Level-Constraintsï¼‰" class="headerlink" title="1. åˆ—çº§çº¦æŸï¼ˆColumn-Level Constraintsï¼‰"></a><strong>1. åˆ—çº§çº¦æŸï¼ˆColumn-Level Constraintsï¼‰</strong></h3><p> <strong>å®šä¹‰ä½ç½®</strong>ï¼šç›´æ¥åœ¨<strong>åˆ—çš„å®šä¹‰ä¸­</strong>å£°æ˜çº¦æŸã€‚</p><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šçº¦æŸä»…ä½œç”¨äº<strong>å•ä¸ªåˆ—</strong>ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p>ç®€æ´ç›´è§‚ï¼Œé€‚åˆå•åˆ—çº¦æŸã€‚</p></li><li><p>æ— æ³•å®šä¹‰æ¶‰åŠå¤šåˆ—çš„çº¦æŸï¼ˆå¦‚å¤åˆä¸»é”®ï¼‰ã€‚</p></li><li><p>å¤–é”®çº¦æŸçš„åˆ—çº§è¯­æ³•éœ€è¦ç›´æ¥å¼•ç”¨çˆ¶è¡¨åˆ—ã€‚</p></li></ul><h3 id="2-è¡¨çº§çº¦æŸï¼ˆTable-Level-Constraintsï¼‰"><a href="#2-è¡¨çº§çº¦æŸï¼ˆTable-Level-Constraintsï¼‰" class="headerlink" title="2. è¡¨çº§çº¦æŸï¼ˆTable-Level Constraintsï¼‰"></a><strong>2. è¡¨çº§çº¦æŸï¼ˆTable-Level Constraintsï¼‰</strong></h3><ul><li><p><strong>å®šä¹‰ä½ç½®</strong>ï¼šåœ¨<strong>æ‰€æœ‰åˆ—å®šä¹‰ä¹‹å</strong>å•ç‹¬å£°æ˜çº¦æŸã€‚æ‰€æœ‰ä½¿ç”¨alterè¯­å¥æ·»åŠ çš„çº¦æŸåŸºæœ¬éƒ½æ˜¯ è¡¨çº§çº¦æŸã€‚</p></li><li><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><p>çº¦æŸæ¶‰åŠ<strong>å¤šä¸ªåˆ—</strong>ï¼ˆå¦‚å¤åˆä¸»é”®ã€è”åˆå”¯ä¸€é”®ï¼‰ã€‚</p></li><li><p>éœ€è¦æ˜¾å¼å‘½åçº¦æŸï¼ˆä¾¿äºåç»­ç®¡ç†ï¼‰ã€‚</p></li><li><p>å¤–é”®çº¦æŸéœ€è¦æŒ‡å®šçˆ¶è¡¨åˆ—åã€‚<br> [ CONSTRAINT &lt;çº¦æŸå&gt; ] &lt;çº¦æŸç±»å‹&gt; çº¦æŸåï¼šçº¦æŸä¸æŒ‡å®šåç§°æ—¶ï¼Œç³»ç»Ÿä¼šç»™å®šä¸€ä¸ªåç§°ã€‚</p></li></ul></li></ul><h3 id="å…­å¤§çº¦æŸ"><a href="#å…­å¤§çº¦æŸ" class="headerlink" title="å…­å¤§çº¦æŸ"></a>å…­å¤§çº¦æŸ</h3><ol><li><p>éç©ºçº¦æŸ <strong>not null</strong></p></li><li><p>é»˜è®¤çº¦æŸ <strong>default</strong></p></li><li><p>å”¯ä¸€çº¦æŸ <strong>unique</strong></p></li><li><p>ä¸»é”®çº¦æŸ <strong>primary key</strong></p></li><li><p>æ£€æŸ¥çº¦æŸ <strong>check(æ¡ä»¶è¡¨è¾¾å¼)</strong></p></li><li><p>å¤–é”®çº¦æŸ <strong>references ä¸»è¡¨(ä¸»é”®åˆ—)</strong></p><p> &#x3D;&#x3D;å¦èµ·ä¸€è¡Œconstraintå¼€å¤´çš„æ˜¯è¡¨çº§çº¦æŸ&#x3D;&#x3D;</p></li></ol><h1 id="æ“ä½œç¬¦ä¸å¢åˆ æ”¹"><a href="#æ“ä½œç¬¦ä¸å¢åˆ æ”¹" class="headerlink" title="æ“ä½œç¬¦ä¸å¢åˆ æ”¹"></a>æ“ä½œç¬¦ä¸å¢åˆ æ”¹</h1><h2 id="insertæ’å…¥"><a href="#insertæ’å…¥" class="headerlink" title="insertæ’å…¥"></a>insertæ’å…¥</h2><ul><li><p>Insert into è¡¨å(åˆ—å1ï¼Œåˆ—å2ï¼Œåˆ—å3)values(value1ï¼Œvalue2,value3);</p></li><li><p>Insert into è¡¨å values (value1,value2,value3);</p><p>  <strong>å¦‚æœå€¼ä¸­éœ€è¦ç©ºå€¼ï¼Œéœ€è¦åœ¨valueä¸­è¾“å…¥null</strong></p></li><li><p>Insert into è¡¨å(åˆ—å1ï¼Œåˆ—å2ï¼Œåˆ—å3) select * from è¡¨å where</p><p>  æ’å…¥ä¸€æ•´ä¸ªè¡¨</p></li></ul><h2 id="updateä¿®æ”¹"><a href="#updateä¿®æ”¹" class="headerlink" title="updateä¿®æ”¹"></a>updateä¿®æ”¹</h2><ul><li><p>Update è¡¨å set åˆ—å &#x3D;â€™valuesâ€™ ,åˆ—å&#x3D;â€™valuesâ€™ where</p></li><li><p>Update è¡¨å set åˆ—å&#x3D;(select * from è¡¨å) where</p></li></ul><h2 id="deleteåˆ é™¤"><a href="#deleteåˆ é™¤" class="headerlink" title="deleteåˆ é™¤"></a>deleteåˆ é™¤</h2><p><strong>deleteåˆ é™¤çš„æ˜¯ä¸€æ•´æ¡è®°å½•ï¼Œè€Œä¸æ˜¯å…¶ä¸­ä¸€ä¸ªå­—æ®µå€¼ã€‚</strong></p><ul><li>Delete from è¡¨ where æ¡ä»¶</li><li>Delete from è¡¨ where sal&gt;(select avg(hissal) from salgrade where grade&#x3D;4)</li></ul><h2 id="deleteï¼Œdropï¼Œtruncateçš„åŒºåˆ«"><a href="#deleteï¼Œdropï¼Œtruncateçš„åŒºåˆ«" class="headerlink" title="deleteï¼Œdropï¼Œtruncateçš„åŒºåˆ«"></a>deleteï¼Œdropï¼Œtruncateçš„åŒºåˆ«</h2><table><thead><tr><th align="center"></th><th align="center">delete</th><th align="center">turncate</th><th align="center">drop</th></tr></thead><tbody><tr><td align="center">åˆ é™¤è¡¨æ•°æ®</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">åˆ é™¤è¡¨ç»“æ„</td><td align="center">Ã—</td><td align="center">Ã—</td><td align="center">âˆš</td></tr><tr><td align="center">æ˜¯å¦èƒ½å›æ»š</td><td align="center">âˆš</td><td align="center">Ã—</td><td align="center">Ã—</td></tr><tr><td align="center">æ‰§è¡Œé€Ÿåº¦</td><td align="center">æ…¢</td><td align="center">ä¸­</td><td align="center">å¿«</td></tr></tbody></table><h2 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a><strong>Merge</strong></h2><p><strong>æ ¹æ®ä¸æºè¡¨è”æ¥çš„ç»“æœï¼Œå¯¹ç›®æ ‡è¡¨æ‰§è¡Œæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œã€‚</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Merge</span> <span class="keyword">into</span> ç›®æ ‡è¡¨ <span class="keyword">as</span> åˆ«å</span><br><span class="line"><span class="keyword">Using</span> æºè¡¨ <span class="keyword">as</span> åˆ«å</span><br><span class="line"><span class="keyword">On</span> (<span class="keyword">values</span><span class="operator">=</span><span class="keyword">values</span> <span class="operator">|</span><span class="keyword">and</span> )</span><br><span class="line"><span class="keyword">When</span> matched <span class="keyword">then</span> <span class="keyword">update</span> å’Œ <span class="keyword">delete</span> <span class="comment">--åŒ¹é…åˆ™æ›´æ–°å’Œåˆ é™¤</span></span><br><span class="line"><span class="keyword">When</span> <span class="keyword">not</span> matched <span class="keyword">then</span> <span class="keyword">insert</span>       <span class="comment">--ä¸åŒ¹é…åˆ™æ’å…¥</span></span><br></pre></td></tr></table></figure><h2 id="æ“ä½œç¬¦ä¼˜å…ˆçº§"><a href="#æ“ä½œç¬¦ä¼˜å…ˆçº§" class="headerlink" title="æ“ä½œç¬¦ä¼˜å…ˆçº§"></a>æ“ä½œç¬¦ä¼˜å…ˆçº§</h2><p>   <strong>ç®—æœ¯æ“ä½œç¬¦&gt;é“¾æ¥æ“ä½œç¬¦&gt;æ¯”è¾ƒæ“ä½œç¬¦åˆ&gt;noté€»è¾‘æ“ä½œç¬¦&gt;andé€»è¾‘æ“ä½œç¬¦&gt;oré€»è¾‘æ“ä½œç¬¦</strong><br> <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;all: è¡¨ç¤ºå¤§äºæœ€å¤§å€¼        å¤§äºå…¨éƒ¨å€¼</span><br><span class="line">&lt;allï¼šè¡¨ç¤ºå°äºæœ€å°å€¼        å°äºå…¨éƒ¨å€¼</span><br><span class="line">&gt;anyï¼šè¡¨ç¤ºå¤§äºæœ€å°å€¼å¤§äºä»»æ„ä¸€ä¸ªå€¼</span><br><span class="line">&lt;anyï¼šè¡¨ç¤ºå°äºæœ€å¤§å€¼   å°äºä»»æ„ä¸€ä¸ªå€¼</span><br><span class="line">=any: å’Œinç±»ä¼¼ç­‰äºä»»æ„ä¸€ä¸ªå€¼</span><br></pre></td></tr></table></figure><br><strong>andå–äº¤é›†<br>orå–å¹¶é›†<br>notå–åç»“æœ</strong></p><table><thead><tr><th align="center">æ“ä½œç¬¦</th><th align="left">å«ä¹‰</th></tr></thead><tbody><tr><td align="center">betweenâ€¦andâ€¦</td><td align="left">åœ¨ä¸¤ä¸ªå€¼ä¹‹é—´(åŒ…å«è¾¹ç•Œ)</td></tr><tr><td align="center">in(set)</td><td align="left">ç­‰äºå€¼åˆ—è¡¨ä¸­çš„ä¸€ä¸ª</td></tr><tr><td align="center">like</td><td align="left">æ¨¡ç³ŠæŸ¥è¯¢</td></tr><tr><td align="center">is null</td><td align="left">ç©ºå€¼</td></tr></tbody></table><p>likeï¼š<br>åœ¨whereå­å¥ä¸­ä½¿ç”¨likeå…³é”®å­—æŸ¥è¯¢æ•°æ®çš„æ–¹å¼ä¹Ÿç§°ä¸º<strong>å­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…</strong>æˆ–å­—ç¬¦ä¸²æ¨¡ç³ŠæŸ¥è¯¢ï¼Œlikeå…³é”®å­—éœ€è¦ä½¿ç”¨é€šé…ç¬¦åœ¨å­—ç¬¦ä¸²å†…æŸ¥æ‰¾æŒ‡å®šçš„æ¨¡å¼ã€‚</p><p><em>è¦æŸ¥è¯¢çš„å­—ç¬¦ä¸²ä¸­å«æœ‰<strong>â€œ%â€</strong>æˆ–__â€œ</em>â€æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è½¬ä¹‰ï¼ˆescapeï¼‰å…³é”®å­—å®ç°ã€‚</p><p>åœ¨â€œ\â€ä¹‹åçš„â€œ<em>â€<strong>å­—ç¬¦å·²ä¸æ˜¯é€šé…ç¬¦ï¼Œè€Œæ˜¯ä»–</strong>æœ¬æ¥çš„å«ä¹‰</em></p><h1 id="æ’åˆ—ã€åˆ†ç»„æŸ¥è¯¢"><a href="#æ’åˆ—ã€åˆ†ç»„æŸ¥è¯¢" class="headerlink" title="æ’åˆ—ã€åˆ†ç»„æŸ¥è¯¢"></a>æ’åˆ—ã€åˆ†ç»„æŸ¥è¯¢</h1><h2 id="æ’åˆ—æŸ¥è¯¢"><a href="#æ’åˆ—æŸ¥è¯¢" class="headerlink" title="æ’åˆ—æŸ¥è¯¢"></a>æ’åˆ—æŸ¥è¯¢</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> col_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> col_name1,col_name2....(<span class="keyword">asc</span><span class="operator">/</span><span class="keyword">desc</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">order</span>:æ’åˆ—æŸ¥è¯¢çš„å…³é”®å­—</span><br><span class="line"><span class="keyword">by</span>:ä»‹è¯ï¼Œåé¢è·Ÿåˆ—å</span><br><span class="line"><span class="keyword">asc</span>:å‡åºï¼ˆé»˜è®¤ï¼‰</span><br><span class="line"><span class="keyword">desc</span>:é™åº</span><br></pre></td></tr></table></figure><p><strong>order by æ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥ä½¿ç”¨åˆ«åçš„å…³é”®è¯,ä¸sqlè¯­å¥çš„æ‰§è¡Œé¡ºåºæœ‰å…³</strong> </p><p>&#96;æ³¨æ„ï¼š</p><p><code>é™åºæ’åºæ—¶å¦‚æœæœ‰ç©ºå€¼ï¼Œé‚£ä¹ˆç©ºå€¼ä¼šä½œä¸ºæœ€å¤§å€¼æ’åœ¨æœ€å‰é¢</code></p><p><code>å¯ä»¥åœ¨order byåé€šè¿‡æ•°å­—æŒ‡å®šåˆ—è¿›è¡Œæ’åºï¼Œé€šå¸¸ä¸ä½¿ç”¨è¿™ç§æ–¹æ³•</code></p><h2 id="åˆ†ç»„æŸ¥è¯¢"><a href="#åˆ†ç»„æŸ¥è¯¢" class="headerlink" title="åˆ†ç»„æŸ¥è¯¢"></a>åˆ†ç»„æŸ¥è¯¢</h2><p>ç›®çš„æ˜¯ç”¨æ¥<strong>æ±‡æ€»æ•°æ®æˆ–ä¸ºæŸä¸ªåˆ†ç»„æ˜¾ç¤ºå•è¡Œçš„æ±‡æ€»ä¿¡æ¯</strong>ï¼Œé€šå¸¸åœ¨æŸ¥è¯¢ç»“æœé›†</p><p>ä¸­ä½¿ç”¨group by å­å¥å¯¹è®°å½•è¿›è¡Œåˆ†ç»„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> col_name <span class="keyword">from</span> table_name <span class="keyword">group</span> <span class="keyword">by</span> col_name</span><br><span class="line"><span class="keyword">group</span>:åˆ†ç»„çš„å…³é”®å­—</span><br><span class="line"><span class="keyword">by</span>:ä»‹è¯ï¼Œåé¢åŠ åˆ—å</span><br><span class="line"><span class="keyword">Having</span>ï¼šè¿‡æ»¤ç»„å…³é”®å­—</span><br></pre></td></tr></table></figure><p>èšåˆå‡½æ•°ï¼šå®šä¹‰ï¼šä¹Ÿå«ç»„å‡½æ•°ï¼Œ<strong>å¯¹ä¸€ç»„æ•°æ®ï¼ˆä¸€åˆ—æˆ–å¤šåˆ—ï¼‰è¿›è¡Œå¤„ç†ï¼Œè¿”å›å•ä¸ªç»“æœ</strong></p><p>ä½¿ç”¨group byå­å¥å’Œèšåˆå‡½æ•°ï¼Œå¯ä»¥å®ç°å¯¹æŸ¥è¯¢ç»“æœä¸­æ¯ä¸€ç»„æ•°æ®è¿›è¡Œåˆ†ç±»ç»Ÿè®¡ã€‚</p><h3 id="where-å’Œ-havingçš„åŒºåˆ«"><a href="#where-å’Œ-havingçš„åŒºåˆ«" class="headerlink" title="where å’Œ havingçš„åŒºåˆ«"></a>where å’Œ havingçš„åŒºåˆ«</h3><table><thead><tr><th align="center"></th><th align="center">where</th><th align="center">having</th></tr></thead><tbody><tr><td align="center">å¤„ç†ç›®æ ‡</td><td align="center">è¡Œè¿‡æ»¤</td><td align="center">åˆ†ç»„è¿‡æ»¤</td></tr><tr><td align="center">ä¹¦å†™ä½ç½®</td><td align="center">fromå</td><td align="center">ä¸€èˆ¬åœ¨group byå</td></tr><tr><td align="center">æ‰§è¡Œä¼˜å…ˆ</td><td align="center">åˆ†ç»„å‰è¿‡æ»¤</td><td align="center">åˆ†ç»„åè¿‡æ»¤</td></tr><tr><td align="center">æ˜¯å¦åŠ è¿‡æ»¤æ¡ä»¶</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">åŠ èšä¼šå‡½æ•°è¿‡æ»¤æ¡ä»¶</td><td align="center">Ã—</td><td align="center">âˆš</td></tr><tr><td align="center">æ•ˆç‡</td><td align="center">å¿«</td><td align="center">æ…¢</td></tr></tbody></table><h3 id="whereæ¡ä»¶é‡Œä¸ºä»€ä¹ˆä¸èƒ½æœ‰èšåˆå‡½æ•°"><a href="#whereæ¡ä»¶é‡Œä¸ºä»€ä¹ˆä¸èƒ½æœ‰èšåˆå‡½æ•°" class="headerlink" title="whereæ¡ä»¶é‡Œä¸ºä»€ä¹ˆä¸èƒ½æœ‰èšåˆå‡½æ•°"></a>whereæ¡ä»¶é‡Œä¸ºä»€ä¹ˆä¸èƒ½æœ‰èšåˆå‡½æ•°</h3><p>åŸºäºæ•´åˆ—æ•°æ®è¿›è¡Œè®¡ç®—çš„ï¼Œè€Œwhereå­å¥åˆ™æ˜¯å¯¹æ•°æ®è¡Œè¿›è¡Œè¿‡æ»¤çš„(è¿™é‡Œè¿‡æ»¤æ˜¯åœ¨ä¸€ä¸ªè®°å½•é‡Œè¾¹è¿‡æ»¤çš„,åŸºäºâ€è¡Œâ€<br>ä¸ºèšé›†å‡½æ•°è¦å¯¹å…¨åˆ—æ•°æ®æ—¶è¡Œè®¡ç®—ï¼Œå› è€Œ<strong>ä½¿ç”¨å®ƒçš„å‰ææ˜¯ï¼šç»“æœé›†å·²ç»ç¡®å®š</strong>ï¼</p><h1 id="é€’å½’æŸ¥è¯¢"><a href="#é€’å½’æŸ¥è¯¢" class="headerlink" title="é€’å½’æŸ¥è¯¢"></a>é€’å½’æŸ¥è¯¢</h1><p>é€’å½’æŸ¥è¯¢çš„ä¹¦å†™æ–¹æ¡ˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TO</span> <span class="type">DATE</span>(<span class="number">2017</span><span class="number">-12</span><span class="number">-01</span><span class="string">&#x27;,&#x27;</span>YYYY <span class="operator">-</span> MM <span class="operator">-</span> DD<span class="string">&#x27;)+LEVEL * INTERVAL&#x27;</span><span class="number">1</span><span class="string">&#x27;day</span></span><br><span class="line"><span class="string">FROM dual</span></span><br><span class="line"><span class="string">CONNECT BY LEVEL &lt;=24</span></span><br></pre></td></tr></table></figure><h1 id="åŒç¯æ¯”"><a href="#åŒç¯æ¯”" class="headerlink" title="åŒç¯æ¯”"></a>åŒç¯æ¯”</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.dat,a.amount,b.amount,c.amount</span><br><span class="line"><span class="keyword">from</span> tab a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tab b <span class="keyword">on</span> to_date (a.dat,<span class="string">&#x27;yyyymm&#x27;</span>)<span class="operator">=</span>add_months(to_date(b.dat,<span class="string">&#x27;yyyymm&#x27;</span>),<span class="number">1</span>)</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tab c <span class="keyword">on</span> to_date(a.dat,<span class="string">&#x27;yyyymm&#x27;</span>)<span class="operator">=</span>add_months(to_date(c.dat,<span class="string">&#x27;yyyymm&#x27;</span>),<span class="number">12</span>)</span><br><span class="line">                                                               </span><br><span class="line">                                                               </span><br><span class="line"><span class="keyword">select</span> a.dat,a.year,a.month a.amount</span><br><span class="line"><span class="keyword">from</span> tab a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tab b <span class="keyword">on</span> ta.year<span class="operator">=</span>b.year <span class="keyword">and</span> a.month<span class="operator">=</span>b.month<span class="operator">+</span><span class="number">1</span>)<span class="keyword">or</span> (a.year<span class="operator">=</span>b.year<span class="operator">+</span><span class="number">1</span> <span class="keyword">and</span> a.month<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> b.month<span class="operator">=</span><span class="number">12</span>)</span><br><span class="line"><span class="keyword">Left</span> <span class="keyword">join</span> tab c <span class="keyword">on</span> a.month<span class="operator">=</span>c.month <span class="keyword">and</span> a.year<span class="operator">=</span>c.year<span class="operator">+</span><span class="number">1</span></span><br></pre></td></tr></table></figure><h1 id="å…³é”®è¯æ‰§è¡Œé¡ºåº"><a href="#å…³é”®è¯æ‰§è¡Œé¡ºåº" class="headerlink" title="å…³é”®è¯æ‰§è¡Œé¡ºåº"></a>å…³é”®è¯æ‰§è¡Œé¡ºåº</h1><table><thead><tr><th align="center"></th><th align="center">ç›®æ ‡</th><th align="center">ä¹¦å†™é¡ºåº</th><th align="center">æ‰§è¡Œé¡ºåº</th></tr></thead><tbody><tr><td align="center">select</td><td align="center">åˆ—</td><td align="center">1</td><td align="center">5</td></tr><tr><td align="center">from</td><td align="center">è¡¨</td><td align="center">2</td><td align="center">1</td></tr><tr><td align="center">where</td><td align="center">æ¡ä»¶</td><td align="center">3</td><td align="center">2</td></tr><tr><td align="center">group by</td><td align="center">åˆ—</td><td align="center">4</td><td align="center">3</td></tr><tr><td align="center">having</td><td align="center">æ¡ä»¶:èšåˆ</td><td align="center">5</td><td align="center">4</td></tr><tr><td align="center">order by</td><td align="center">åˆ—</td><td align="center">6</td><td align="center">6</td></tr></tbody></table><p><strong>åˆ†ç»„åselect åé¢åªèƒ½è·Ÿåˆ†äº†ç»„çš„åˆ—å’Œèšåˆå‡½æ•°<br>group byåé¢äº§ç”Ÿæ‰€æœ‰çš„èšåˆå‡½æ•°ï¼Œselectåªæ˜¯å±•ç¤º</strong></p><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a><strong>å‡½æ•°</strong></h1><p><strong>å‡½æ•°:SQL å‡½æ•°ä¼šå¯¹ä¼ é€’è¿›æ¥çš„å‚æ•°è¿›è¡Œå¤„ç†ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¤„ç†ç»“æœï¼Œä¹Ÿå°±æ˜¯è¿”å›ä¸€ä¸ªå€¼ã€‚</strong></p><h2 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h2><table><thead><tr><th>åºå·</th><th>å‡½æ•°å</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>1</td><td>length(str)</td><td>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦</td></tr><tr><td>2</td><td>concat(str1,str2)</td><td>å­—ç¬¦ä¸²è¿æ¥å‡½æ•°</td></tr><tr><td>3</td><td>chr()</td><td>å°†ä¸€ä¸ªASCIIç è½¬æ¢ä¸ºå­—ç¬¦</td></tr><tr><td>4</td><td>ascii(å­—ç¬¦)</td><td>å°†ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºASCIIç å€¼ï¼ŒASCIIç è½¬æ¢çš„æ˜¯é”®ç›˜äº¤äº’çš„æ‰€æœ‰çš„é”®</td></tr><tr><td>5</td><td>instr(str1,str2,start,n)</td><td>instr(æºå­—ç¬¦ä¸²,ç›®æ ‡å­—ç¬¦ä¸²,å¼€å§‹ä½ç½®,åŒ¹é…åºå·)ï¼Œè¿”å›åŒ¹é…ä½ç½®çš„ä¸‹æ ‡ã€‚æ›¿æ¢like æŸ¥æ‰¾ç¬¬å‡ ä½æœ‰ä»€ä¹ˆå­—ç¬¦ï¼Œç¡®å®šåŸå§‹å­—ç¬¦é‡Œæœ‰å¤šå°‘ä¸ªå­—ç¬¦ã€‚å¦‚æœstartæ˜¯è´Ÿæ•°ï¼Œåˆ™ä»åå¾€å‰æ•°ï¼Œä»å‰å¾€åæˆªå–ã€‚</td></tr><tr><td>6</td><td>substr(str,start,len)</td><td>ä»startä½ç½®å¼€å§‹æˆªå–é•¿åº¦ä¸ºlençš„å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœstartæ˜¯è´Ÿæ•°ï¼Œåˆ™ä»åå¾€å‰æ•°ï¼Œåˆ°å¼€å§‹ä½ç½®åœä¸‹äº†å¾€åæˆªå–ã€‚</td></tr><tr><td>7</td><td>initcap(str)</td><td>å°†é¦–å­—æ¯å¤§å†™å…¶ä»–å­—æ¯å°å†™(ä»¥ç©ºæ ¼æ¥åŒºåˆ†å•è¯çš„)</td></tr><tr><td>8</td><td>lower&#x2F;upper()</td><td>å¤§å°å†™è½¬æ¢å‡½æ•°</td></tr><tr><td>9</td><td>replace(str,s,d)</td><td>å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²strä¸­çš„så­—ç¬¦æ›¿æ¢æˆå­—ç¬¦dã€‚ä½¿ç”¨åŠŸèƒ½: 1. æ›¿æ¢ 2.åˆ é™¤ 3.è„±æ•</td></tr><tr><td>10</td><td>translate(char, from,to)</td><td>è¿”å›å°†å‡ºç°åœ¨fromä¸­çš„æ¯ä¸ªå­—ç¬¦æ›¿æ¢ä¸ºtoä¸­çš„ç›¸åº”å­—ç¬¦</td></tr><tr><td>11</td><td>round(num,[num1,])</td><td>å››èˆäº”å…¥å‡½æ•°ï¼Œnum1æ˜¯æ­£æ•°æ—¶ç²¾åº¦æ˜¯æ­£æ•°å°æ•°ç‚¹ä¹‹åï¼Œæ˜¯è´Ÿæ•°æ—¶å°æ•°ç‚¹ä¹‹å‰</td></tr><tr><td>12</td><td>mod(num1ï¼Œnum2)</td><td>æ±‚ä½™å‡½æ•°</td></tr><tr><td>13</td><td>trunc()</td><td>æˆªå–å‡½æ•°</td></tr><tr><td>14</td><td>floor()</td><td>å‘ä¸‹å–æ•´</td></tr><tr><td>15</td><td>ceil()</td><td>å‘ä¸Šå–æ•´</td></tr><tr><td>16</td><td>power(n, m)</td><td>è¿”å›nçš„mæ¬¡å¹‚</td></tr><tr><td>17</td><td>sqrt(n)</td><td>è¿”å›æ•°å­—nçš„å¹³æ–¹æ ¹</td></tr><tr><td>18</td><td>to_date(str)</td><td>å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ—¥æœŸyyyy,MM,dd,hh24,mi,ss</td></tr><tr><td>19</td><td>to_number()</td><td>å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—</td></tr><tr><td>20</td><td>to_char()</td><td>å­—ç¬¦ä¸²è½¬æ¢å‡½æ•°ã€‚è·Ÿæ—¥æœŸæœ‰å…³çš„ä¸ç®¡æ˜¯æ—¥æœŸè½¬å­—ç¬¦è¿˜æ˜¯å­—ç¬¦è½¬æ—¥æœŸéƒ½è¦å¸¦æ—¥æœŸæ ¼å¼ã€‚to_char()çš„ç«™ä½ç”¨æ³•ï¼šâ€™990.99â€™:9ä»£è¡¨å ä¸€ä¸ªä½ç½®ï¼Œ0ä»£è¡¨æŠŠå°æ•°ç‚¹ä¹‹å‰çš„0è¡¥é½</td></tr><tr><td>21</td><td>last_day(æ—¥æœŸ)</td><td>å–å½“å‰æ—¥æœŸæœˆçš„æœ€åä¸€å¤©</td></tr><tr><td>22</td><td>next_day(sysdate,n)</td><td>å–ä¸‹ä¸€ä¸ª(æœ€è¿‘çš„)ä¸€å‘¨çš„ç¬¬å‡ å¤©ï¼Œ1æ˜¯æ˜ŸæœŸæ—¥</td></tr><tr><td>23</td><td>add_months(æ—¥æœŸ,æœˆ)</td><td>ç»™ä¸€ä¸ªæ—¥æœŸåŠ ä¸Šè‹¥å¹²ä¸ªæœˆ</td></tr><tr><td>24</td><td>months_between(date1,date2)</td><td>å–ä¸¤ä¸ªæ—¥æœŸç›¸å·®çš„æœˆæ•°</td></tr><tr><td>25</td><td>nvl2(åˆ—å,å€¼1,å€¼2)</td><td>ç©ºå€¼è½¬æ¢å‡½æ•°ï¼Œå½“ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼æ˜¯ç©ºæ—¶ï¼Œè¿”å›ç»“æœæ˜¯ç¬¬3ä¸ªå‚æ•°çš„å€¼ï¼Œå½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸ä¸ºç©ºæ—¶ï¼Œè¿”å›ç»“æœæ˜¯ç¬¬2ä¸ªå‚æ•°çš„å€¼</td></tr></tbody></table><h2 id="æ•°æ®ç±»å‹è½¬æ¢"><a href="#æ•°æ®ç±»å‹è½¬æ¢" class="headerlink" title="æ•°æ®ç±»å‹è½¬æ¢"></a>æ•°æ®ç±»å‹è½¬æ¢</h2><ol><li><p>éšå¼è½¬æ¢<br> æŒ‡Oracleåœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶è‡ªåŠ¨å°†æ•°æ®ç±»å‹è½¬æ¢æˆéœ€è¦çš„æ•°æ®ç±»å‹ã€‚<strong>éšå¼è½¬æ¢å¯èƒ½ä¼šå¯¼è‡´ç²¾åº¦æŸå¤±æˆ–æ•°æ®ä¸å‡†ç¡®ï¼Œ</strong>å› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦è°¨æ…ã€‚</p></li><li><p>æ˜¾ç¤ºè½¬æ¢<br> æ˜¾å¼è½¬æ¢æ˜¯æŒ‡åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨ä¸€äº›å‡½æ•°<strong>å¼ºåˆ¶å°†æŸä¸ªæ•°æ®ç±»å‹è½¬æ¢æˆå¦ä¸€ä¸ªæ•°æ®ç±»å‹</strong>ã€‚<br> to_number ï¼šå­—ç¬¦è½¬æ¢ä¸ºæ•°å­—<br> to_date()ï¼šä½œç”¨å°†å­—ç¬¦ç±»å‹æŒ‰ä¸€å®šæ ¼å¼è½¬åŒ–ä¸ºæ—¥æœŸç±»å‹ã€‚<br> to_char æ•°å­—è½¬åŒ–ä¸ºå­—ç¬¦<br> to_char æ—¥æœŸè½¬åŒ–ä¸ºå­—ç¬¦,<strong>å¿…é¡»åŠ å•å¼•å·,å¹¶ä¸”åŒºåˆ†å¤§å°å†™</strong></p></li></ol><h3 id="è½¬æ¢å‡½æ•°ç¤ºä¾‹"><a href="#è½¬æ¢å‡½æ•°ç¤ºä¾‹" class="headerlink" title="è½¬æ¢å‡½æ•°ç¤ºä¾‹"></a>è½¬æ¢å‡½æ•°ç¤ºä¾‹</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span> to_number(<span class="string">&#x27;0.9890&#x27;</span>)<span class="operator">+</span><span class="number">3</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_date(<span class="string">&#x27;1999-09-09 &#x27;</span>,<span class="string">&#x27;yyyy/MM/dd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_date(<span class="string">&#x27;19990909&#x27;</span>,<span class="string">&#x27;yyyyMMdd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_date(<span class="string">&#x27;1999/09/09 22:56:18&#x27;</span>,<span class="string">&#x27;yyyy/MM/dd hh24:mi:ss&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_date(<span class="number">19990909</span>,<span class="string">&#x27;yyyyMMdd&#x27;</span>) <span class="keyword">from</span> dual;<span class="comment">---æ•°å­—ä¹Ÿå¯ä»¥å»è½¬</span></span><br><span class="line"><span class="keyword">select</span> to_char(<span class="string">&#x27;.83&#x27;</span>,<span class="string">&#x27;0.99&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(sysdate,<span class="string">&#x27;dd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(sysdate,<span class="string">&#x27;mm&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(sysdate,<span class="string">&#x27;yyyy&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(sysdate,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(sysdate,<span class="string">&#x27;yyyy/MM/dd hh24:mi:ss&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> last_day(sysdate) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> next_day(sysdate,<span class="number">4</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> add_months(sysdate,<span class="number">-3</span>) <span class="keyword">from</span> dual<span class="comment">--æ±‚3ä¸ªæœˆå‰çš„ä»Šå¤©</span></span><br><span class="line"><span class="keyword">select</span> sysdate<span class="operator">-</span>hiredate <span class="keyword">from</span> emp;<span class="comment">----å¾—å‡ºç»“æœä»¥å¤©ä¸ºå•ä½çš„</span></span><br><span class="line"><span class="keyword">select</span> months_between(sysdate,to_date(<span class="string">&#x27;2020-3-3&#x27;</span>,<span class="string">&#x27;yyyy/MM/dd&#x27;</span>)) <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">select</span> comm,nvl2(comm,comm,<span class="number">1</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><h2 id="ç©ºå€¼èµ‹å€¼nvl"><a href="#ç©ºå€¼èµ‹å€¼nvl" class="headerlink" title="ç©ºå€¼èµ‹å€¼nvl"></a>ç©ºå€¼èµ‹å€¼nvl</h2><p>ã€è¯­æ³•ã€‘NVL (expr1, expr2)<br>ã€åŠŸèƒ½ã€‘è‹¥expr1ä¸ºNULLï¼Œè¿”å›expr2ï¼›expr1ä¸ä¸ºNULLï¼Œè¿”å›expr1ã€‚</p><p>æ³¨æ„ä¸¤è€…çš„ç±»å‹è¦ä¸€è‡´</p><p>ã€è¯­æ³•ã€‘NVL2 (expr1, expr2, expr3)<br>ã€åŠŸèƒ½ã€‘expr1ä¸ä¸ºNULLï¼Œè¿”å›expr2ï¼›expr2ä¸ºNULLï¼Œè¿”å›expr3ã€‚</p><p>expr2å’Œexpr3ç±»å‹ä¸åŒçš„è¯ï¼Œexpr3ä¼šè½¬æ¢ä¸ºexpr2çš„ç±»å‹</p><h2 id="TRANSLATE-c1-c2-c3"><a href="#TRANSLATE-c1-c2-c3" class="headerlink" title="TRANSLATE(c1,c2,c3)"></a>TRANSLATE(c1,c2,c3)</h2><p>ã€åŠŸèƒ½ã€‘å°†å­—ç¬¦è¡¨è¾¾å¼å€¼ä¸­ï¼ŒæŒ‡å®šå­—ç¬¦æ›¿æ¢ä¸ºæ–°å­—ç¬¦</p><p>c1 å¸Œæœ›è¢«æ›¿æ¢çš„å­—ç¬¦æˆ–å˜é‡<br>c2 æŸ¥è¯¢åŸå§‹çš„å­—ç¬¦é›†<br>c3 æ›¿æ¢æ–°çš„å­—ç¬¦é›†ï¼Œå°†c2å¯¹åº”é¡ºåºå­—ç¬¦ï¼Œæ›¿æ¢ä¸ºc3å¯¹åº”é¡ºåºå­—ç¬¦</p><p>å¦‚æœc3é•¿åº¦å¤§äºc2ï¼Œåˆ™c3é•¿å‡ºåé¢çš„å­—ç¬¦æ— æ•ˆ<br>å¦‚æœc3é•¿åº¦å°äºc2ï¼Œåˆ™c2é•¿å‡ºåé¢çš„å­—ç¬¦å‡æ›¿æ¢ä¸ºç©º(åˆ é™¤)<br>å¦‚æœc3é•¿åº¦ä¸º0ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚<br>å¦‚æœc2é‡Œå­—ç¬¦é‡å¤ï¼ŒæŒ‰é¦–æ¬¡ä½ç½®ä¸ºæ›¿æ¢ä¾æ®</p><h2 id="Case-when"><a href="#Case-when" class="headerlink" title="Case when"></a>Case when</h2><ol><li><p>ç¿»è¯‘</p></li><li><p>è¡Œè½¬åˆ—</p></li><li><p>åˆ¤æ–­è¾“å‡º</p></li><li><p>ç®€å•Caseå‡½æ•°</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="keyword">case</span> deptno</span><br><span class="line"><span class="keyword">when</span> <span class="number">10</span> <span class="keyword">then</span> <span class="string">&#x27;ç¬¬ä¸€éƒ¨é—¨&#x27;</span></span><br><span class="line"><span class="keyword">when</span> <span class="number">20</span> <span class="keyword">then</span> <span class="string">&#x27;ç¬¬äºŒéƒ¨é—¨&#x27;</span></span><br><span class="line"><span class="keyword">when</span> <span class="number">30</span> <span class="keyword">then</span> <span class="string">&#x27;ç¬¬ä¸‰éƒ¨é—¨&#x27;</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">&#x27;ç¬¬å››éƒ¨é—¨&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><ol start="2"><li>Caseæœç´¢å‡½æ•°</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> deptno<span class="operator">=</span><span class="number">10</span> <span class="keyword">then</span> <span class="string">&#x27;ç¬¬ä¸€éƒ¨é—¨&#x27;</span></span><br><span class="line"> <span class="keyword">when</span> deptno<span class="operator">=</span><span class="number">20</span> <span class="keyword">then</span> <span class="string">&#x27;ç¬¬äºŒéƒ¨é—¨&#x27;</span></span><br><span class="line"> <span class="keyword">when</span> deptno<span class="operator">=</span><span class="number">30</span> <span class="keyword">then</span> <span class="string">&#x27;ç¬¬ä¸‰éƒ¨é—¨&#x27;</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">&#x27;ç¬¬å››éƒ¨é—¨&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="keyword">Case</span>å‡½æ•°åªè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å€¼ï¼Œå‰©ä¸‹çš„<span class="keyword">Case</span>éƒ¨åˆ†å°†ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ã€‚<span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ol><li><p>*<strong>Case when ç”Ÿæˆçš„åˆ—ä¹Ÿå¯ä»¥ä¸¢åˆ°group by åé¢å»åˆ†ç»„çš„,where,havingéƒ½å¯ä»¥ä½¿ç”¨CASEè¡¨è¾¾å¼éœ€æ³¨æ„çš„ç‚¹</strong></p></li><li><p>&#x3D;&#x3D;Caseå‡½æ•°åªè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å€¼ï¼Œå‰©ä¸‹çš„Caseéƒ¨åˆ†å°†ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ã€‚&#x3D;&#x3D;</p></li></ol><h2 id="decode-ç­‰å€¼ç¿»è¯‘"><a href="#decode-ç­‰å€¼ç¿»è¯‘" class="headerlink" title="decode ç­‰å€¼ç¿»è¯‘"></a>decode ç­‰å€¼ç¿»è¯‘</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,deptno,</span><br><span class="line">decode(deptno,<span class="number">10</span>,<span class="string">&#x27;åå·éƒ¨é—¨&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;äºŒåå·éƒ¨é—¨&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;ä¸‰åå·éƒ¨é—¨&#x27;</span>,<span class="string">&#x27;å…¶ä»–éƒ¨é—¨&#x27;</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><h2 id="decodeä¸case-when-çš„æ¯”è¾ƒ"><a href="#decodeä¸case-when-çš„æ¯”è¾ƒ" class="headerlink" title="decodeä¸case when çš„æ¯”è¾ƒ"></a>decodeä¸case when çš„æ¯”è¾ƒ</h2><table><thead><tr><th align="center">å‡½æ•°</th><th align="center">Oracle</th><th align="center">SQL Server</th><th align="center">MySQL</th><th align="center">informix</th></tr></thead><tbody><tr><td align="center">decodeæ”¯æŒ</td><td align="center">âˆš</td><td align="center">Ã—</td><td align="center">Ã—</td><td align="center">âˆš</td></tr><tr><td align="center">case whenæ”¯æŒ</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center">âˆš</td><td align="center">âˆš</td></tr></tbody></table><ol><li><strong>decode åªèƒ½ç”¨åšç›¸ç­‰åˆ¤æ–­ï¼Œä½†æ˜¯å¯ä»¥é…åˆsignå‡½æ•°è¿›è¡Œå¤§äºï¼Œå°äºï¼Œç­‰äºçš„åˆ¤æ–­</strong></li><li><strong>CASE whenå¯ç”¨äº&#x3D;,&gt;&#x3D;,&lt;,&lt;&#x3D;,&lt;&gt;,is null,is not null ç­‰çš„åˆ¤æ–­ï¼›</strong></li></ol><h2 id="èšåˆcaseå®ç°è¡Œè½¬åˆ—"><a href="#èšåˆcaseå®ç°è¡Œè½¬åˆ—" class="headerlink" title="èšåˆcaseå®ç°è¡Œè½¬åˆ—"></a><strong>èšåˆ</strong>caseå®ç°è¡Œè½¬åˆ—</h2><ol><li>è¡Œè½¬åˆ—æ–¹æ³•ä¸€</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,</span><br><span class="line"><span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> job<span class="operator">=</span><span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">then</span> sal <span class="keyword">end</span>) salesman,</span><br><span class="line"><span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span> <span class="keyword">then</span> sal <span class="keyword">end</span>) manager,</span><br><span class="line"><span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">then</span> sal <span class="keyword">end</span>) clerk</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br></pre></td></tr></table></figure><h2 id="è¡Œè½¬åˆ—-åˆ—è½¬è¡Œ-å‡½æ•°"><a href="#è¡Œè½¬åˆ—-åˆ—è½¬è¡Œ-å‡½æ•°" class="headerlink" title="è¡Œè½¬åˆ— åˆ—è½¬è¡Œ å‡½æ•°"></a>è¡Œè½¬åˆ— åˆ—è½¬è¡Œ å‡½æ•°</h2><p><strong>pivotæ ¼å¼</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> ï¼ˆæ•°æ®æŸ¥è¯¢é›†ï¼‰</span><br><span class="line">PIVOT</span><br><span class="line">(</span><br><span class="line"><span class="built_in">SUM</span>(Score<span class="operator">/</span>è¡Œè½¬åˆ—å åˆ—çš„å€¼<span class="operator">/</span>) <span class="keyword">FOR</span></span><br><span class="line">coursename<span class="operator">/</span>éœ€è¦è¡Œè½¬åˆ—çš„åˆ—<span class="operator">/</span> <span class="keyword">IN</span> (è½¬æ¢ååˆ—çš„å€¼)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ol start="2"><li>è¡Œè½¬åˆ—æ–¹æ³•äºŒ</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> deptno,job,sal <span class="keyword">from</span> emp)</span><br><span class="line">pivot</span><br><span class="line">(</span><br><span class="line"><span class="built_in">max</span>(sal) <span class="keyword">for</span> job <span class="keyword">in</span> (<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¡Œè½¬åˆ— åˆ—è½¬è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> deptno,job,sal <span class="keyword">from</span> emp)</span><br><span class="line">pivot</span><br><span class="line">(</span><br><span class="line"><span class="built_in">max</span>(sal) <span class="keyword">for</span> job <span class="keyword">in</span> (<span class="string">&#x27;SALESMAN&#x27;</span> salesman,<span class="string">&#x27;MANAGER&#x27;</span> manager,<span class="string">&#x27;CLERK&#x27;</span> clerk)</span><br><span class="line">)</span><br><span class="line">unpivot</span><br><span class="line">(</span><br><span class="line">newsal <span class="keyword">for</span> job <span class="keyword">in</span>(salesman,manager,clerk)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="å¼€çª—å‡½æ•°over"><a href="#å¼€çª—å‡½æ•°over" class="headerlink" title="å¼€çª—å‡½æ•°over()"></a><strong>å¼€çª—å‡½æ•°</strong>over()</h2><h3 id="çª—å£å‡½æ•°"><a href="#çª—å£å‡½æ•°" class="headerlink" title="çª—å£å‡½æ•°"></a><strong>çª—å£å‡½æ•°</strong></h3><p>ï¼ˆåˆ†æå‡½æ•°ï¼‰ï¼ˆä¸»è¦åšæ’åºï¼‰</p><p>å¼€çª—å‡½æ•°æ ¼å¼ï¼š å‡½æ•°å(åˆ—) OVER(é€‰é¡¹)</p><p><strong>over(partition by åˆ†ç»„åˆ— order by æ’åºåˆ—)</strong></p><p><code>æ³¨ï¼šorder byåé¢å¯ä»¥æ˜¯å¤„ç†åçš„åˆ—</code></p><p>over å…³é”®å­—è¡¨ç¤ºæŠŠå‡½æ•°å½“æˆå¼€çª—å‡½æ•°è€Œä¸æ˜¯èšåˆå‡½æ•°ã€‚SQL æ ‡å‡†å…è®¸å°†æ‰€æœ‰èšåˆå‡½æ•°ç”¨åšå¼€çª—å‡½æ•°ï¼Œ&#x3D;&#x3D;ä½¿ç”¨ over å…³é”®å­—æ¥åŒºåˆ†è¿™ä¸¤ç§ç”¨æ³•ã€‚&#x3D;&#x3D;</p><h3 id="ROW-NUMBER"><a href="#ROW-NUMBER" class="headerlink" title="ROW_NUMBER()"></a>ROW_NUMBER()</h3><p>ROW_NUMBER()å‡½æ•°ä½œç”¨å°±æ˜¯å°†selectæŸ¥è¯¢åˆ°çš„æ•°æ®è¿›è¡Œæ’åºï¼Œæ¯ä¸€æ¡æ•°æ®åŠ ä¸€ä¸ªåºå·ã€‚æ’åºçš„åºå·å’Œrownumä¼ªåˆ—ç›¸åŒï¼Œè¿ç»­åºå·ï¼Œä¸è€ƒè™‘å€¼ç›¸ç­‰çš„æƒ…å†µï¼ˆå€¼ç›¸åŒåºå·ä¸ç›¸åŒï¼‰</p><h3 id="RANK-â€“å¹¶åˆ—è·³å·"><a href="#RANK-â€“å¹¶åˆ—è·³å·" class="headerlink" title="RANK()â€“å¹¶åˆ—è·³å·"></a>RANK()â€“å¹¶åˆ—è·³å·</h3><p>RANK()å‡½æ•°ï¼Œé¡¾åæ€ä¹‰æ’åå‡½æ•°ï¼Œå¯ä»¥å¯¹æŸä¸€ä¸ªå­—æ®µè¿›è¡Œæ’åï¼Œå¯ä»¥ç”¨æ¥åšæ’åºï¼Œ<strong>å®ƒåºå·ä¸è¿ç»­</strong>ï¼Œè€ƒè™‘é‡å¤æ•°æ®ï¼Œ<strong>å¦‚æœå€¼ç›¸ç­‰åºå·ç›¸åŒ</strong></p><h3 id="DENSE-RANK-â€“å¹¶åˆ—ä¸è·³å·"><a href="#DENSE-RANK-â€“å¹¶åˆ—ä¸è·³å·" class="headerlink" title="DENSE_RANK()â€“å¹¶åˆ—ä¸è·³å·"></a>DENSE_RANK()â€“å¹¶åˆ—ä¸è·³å·</h3><p>DENSE_RANK()å¯†é›†çš„æ’åï¼Œç´§å¯†æ’åºï¼Œå¯ä»¥ç”¨æ¥åšæ’åºï¼Œå®ƒåºå·è¿ç»­ï¼Œè€ƒè™‘é‡å¤æ•°æ®ï¼Œå¦‚æœå€¼ç›¸ç­‰åºå·å°±ç›¸åŒä»–å’ŒRANK()åŒºåˆ«åœ¨äºï¼Œæ’åçš„è¿ç»­æ€§ï¼Œ<strong>DENSE_RANK()æ’åæ˜¯è¿ç»­çš„ï¼ŒRANK()æ˜¯è·³è·ƒçš„æ’å</strong></p><h3 id="ç”¨èšåˆå‡½æ•°æ¥å¼€çª—"><a href="#ç”¨èšåˆå‡½æ•°æ¥å¼€çª—" class="headerlink" title="ç”¨èšåˆå‡½æ•°æ¥å¼€çª—"></a><strong>ç”¨èšåˆå‡½æ•°æ¥å¼€çª—</strong></h3><p>avg() max() count() sum() min()</p><p>å¯ä»¥ä¸åŠ ä»»ä½•æ¡ä»¶ï¼Œå¦‚æœåŠ order by åˆ™æ˜¯æŒ‰ç…§é¡ºåºä¾æ¬¡è¿›è¡Œè®¡ç®—ï¼Œä¸€èˆ¬ä¸åŠ order by</p><h3 id="wm-concatå‡½æ•°"><a href="#wm-concatå‡½æ•°" class="headerlink" title="wm_concatå‡½æ•°"></a><strong>wm_concat</strong>å‡½æ•°</h3><p>wm_concat(åˆ—å),è¯¥å‡½æ•°å¯ä»¥æŠŠåˆ—å€¼ä»¥â€,â€å·åˆ†éš”èµ·æ¥,å¹¶æ˜¾ç¤ºæˆä¸€è¡Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> wm_concat(ename) <span class="keyword">from</span> emp</span><br></pre></td></tr></table></figure><h3 id="listaggå‡½æ•°"><a href="#listaggå‡½æ•°" class="headerlink" title="listaggå‡½æ•°"></a><strong>listagg</strong>å‡½æ•°</h3><p>LISTAGG å°†å¤šè¡Œåˆå¹¶æˆä¸€è¡Œ</p><ol><li>ä½œä¸ºæ™®é€šå‡½æ•°ï¼Œå¯¹å·¥èµ„è¿›è¡Œæ’åºï¼Œç”¨é€—å·è¿›è¡Œæ‹¼æ¥ã€‚</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">listagg</span>(ename,<span class="string">&#x27;,&#x27;</span>)<span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal)name <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal;</span><br></pre></td></tr></table></figure><ol start="2"><li>ä½œä¸ºåˆ†ç»„å‡½æ•°ï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">listagg</span>(ename,<span class="string">&#x27;,&#x27;</span>)<span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal)name <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure><ol start="3"><li>ä½œä¸ºåˆ†æå‡½æ•°ï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,ename,sal,<span class="built_in">listagg</span>(ename,<span class="string">&#x27;,&#x27;</span>)<span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal)<span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span></span><br><span class="line">   deptno)name <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><p>listagg()é‡Œé¢çš„order byè¯­æ³•æ˜¯å¿…å¸¦çš„ï¼Œæ­é…å¼€çª—ï¼Œå¼€çª—é‡Œçš„order by ä¸ç”¨å¸¦</p><h3 id="åç§»åˆ†æå‡½æ•°"><a href="#åç§»åˆ†æå‡½æ•°" class="headerlink" title="åç§»åˆ†æå‡½æ•°"></a><strong>åç§»åˆ†æå‡½æ•°</strong></h3><p><strong>lead(params,m,n) ä»¥paramsä¸ºç›®æ ‡å‘ä¸‹mä½å–æ•°ï¼Œå½“å–ä¸åˆ°æ—¶é»˜è®¤ä¸º n</strong></p><p><strong>lag(params,m,n) ä»¥paramsä¸ºç›®æ ‡å‘ä¸Šmä½å–æ•°ï¼Œå½“å–ä¸åˆ°æ—¶é»˜è®¤ä¸º n</strong></p><p>ä¾‹å¦‚ï¼šlead(field, num, defaultvalue) fieldéœ€è¦æŸ¥æ‰¾çš„å­—æ®µï¼Œnumå¾€åæŸ¥æ‰¾çš„numè¡Œçš„æ•°æ®ï¼Œdefaultvalueæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„é»˜è®¤å€¼ã€‚</p><h2 id="group-by-å’Œpartition-by"><a href="#group-by-å’Œpartition-by" class="headerlink" title="group by å’Œpartition by"></a>group by å’Œpartition by</h2><p>åœ¨ SQL ä¸­ï¼Œ<code>PARTITION BY</code> å’Œ <code>GROUP BY</code> éƒ½ç”¨äºå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œä½†å®ƒä»¬çš„ <strong>æ ¸å¿ƒç›®çš„</strong>ã€<strong>ä½¿ç”¨åœºæ™¯</strong> å’Œ <strong>ç»“æœå½¢æ€</strong> æœ‰æœ¬è´¨åŒºåˆ«ã€‚</p><h3 id="1-æ ¸å¿ƒä½œç”¨"><a href="#1-æ ¸å¿ƒä½œç”¨" class="headerlink" title="1. æ ¸å¿ƒä½œç”¨"></a>1. æ ¸å¿ƒä½œç”¨</h3><table><thead><tr><th align="left"><strong><code>GROUP BY</code></strong></th><th align="left"><strong><code>PARTITION BY</code></strong></th></tr></thead><tbody><tr><td align="left">å¯¹æ•°æ®è¿›è¡Œ <strong>èšåˆåˆ†ç»„</strong>ï¼Œç”Ÿæˆæ±‡æ€»ç»“æœï¼ˆæ¯ä¸ªåˆ†ç»„è¿”å›ä¸€è¡Œï¼‰ã€‚</td><td align="left">å¯¹æ•°æ®è¿›è¡Œ <strong>åˆ†åŒº</strong>ï¼Œå®šä¹‰çª—å£å‡½æ•°çš„è®¡ç®—èŒƒå›´ï¼ˆä¸å‡å°‘è¡Œæ•°ï¼‰ã€‚</td></tr><tr><td align="left">å¸¸ä¸èšåˆå‡½æ•°ï¼ˆ<code>SUM</code>, <code>AVG</code>, <code>COUNT</code>ï¼‰ç»“åˆä½¿ç”¨ã€‚</td><td align="left">å¸¸ä¸çª—å£å‡½æ•°ï¼ˆ<code>ROW_NUMBER</code>, <code>RANK</code>, <code>SUM OVER</code>ï¼‰ç»“åˆä½¿ç”¨ã€‚</td></tr></tbody></table><hr><h3 id="2-ç»“æœé›†å½¢æ€"><a href="#2-ç»“æœé›†å½¢æ€" class="headerlink" title="2. ç»“æœé›†å½¢æ€"></a><strong>2. ç»“æœé›†å½¢æ€</strong></h3><table><thead><tr><th align="left"><strong><code>GROUP BY</code></strong></th><th align="left"><strong><code>PARTITION BY</code></strong></th></tr></thead><tbody><tr><td align="left">ç»“æœé›†ä¸­çš„è¡Œæ•° <strong>å‡å°‘</strong>ï¼Œæ¯ä¸ªåˆ†ç»„è¿”å›ä¸€è¡Œã€‚</td><td align="left">ç»“æœé›†ä¸­çš„è¡Œæ•° <strong>ä¸å˜</strong>ï¼ŒåŸå§‹æ•°æ®è¡Œå…¨éƒ¨ä¿ç•™ã€‚</td></tr><tr><td align="left"><strong>ç¤ºä¾‹</strong>ï¼šæŒ‰éƒ¨é—¨åˆ†ç»„ç»Ÿè®¡æ€»å·¥èµ„ï¼Œæ¯ä¸ªéƒ¨é—¨ä¸€è¡Œã€‚</td><td align="left"><strong>ç¤ºä¾‹</strong>ï¼šæŒ‰éƒ¨é—¨åˆ†åŒºï¼Œè®¡ç®—æ¯ä¸ªå‘˜å·¥çš„éƒ¨é—¨å†…å·¥èµ„æ’åã€‚</td></tr></tbody></table><hr><ol><li><p>&#x3D;&#x3D;group byæœ‰å»é‡æ•ˆæœ&#x3D;&#x3D;</p></li><li><p>&#x3D;&#x3D;partition byæ²¡æœ‰å»é‡æ•ˆæœ&#x3D;&#x3D;</p><p>æ±‚æ¯ä¸ªéƒ¨é—¨æœ€é«˜å·¥èµ„çš„äººå‘˜ä¿¡æ¯ï¼Œmax()å‡½æ•°å°‘ç”¨ï¼Œä¸æ­¢ä¸€ä¸ªå·¥èµ„æœ€é«˜ä¹Ÿå¯èƒ½å­˜åœ¨å…¶ä»–æ¼æ´</p></li></ol><h3 id="3-è¯­æ³•ä¸ä½¿ç”¨åœºæ™¯"><a href="#3-è¯­æ³•ä¸ä½¿ç”¨åœºæ™¯" class="headerlink" title="3. è¯­æ³•ä¸ä½¿ç”¨åœºæ™¯"></a><strong>3. è¯­æ³•ä¸ä½¿ç”¨åœºæ™¯</strong></h3><h4 id="1-GROUP-BY"><a href="#1-GROUP-BY" class="headerlink" title="(1) GROUP BY"></a><strong>(1) <code>GROUP BY</code></strong></h4><ul><li><p><strong>è¯­æ³•</strong>ï¼šé…åˆèšåˆå‡½æ•°ï¼Œç”Ÿæˆæ±‡æ€»ç»Ÿè®¡ç»“æœã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">SELECT</span> department, <span class="built_in">SUM</span>(salary) <span class="keyword">AS</span> total_salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department;  <span class="comment">-- æ¯ä¸ªéƒ¨é—¨è¿”å›ä¸€è¡Œæ±‡æ€»æ•°æ®</span></span><br></pre></td></tr></table></figure></li><li><p><strong>ç»“æœç¤ºä¾‹</strong>ï¼š</p><table><thead><tr><th align="left">department</th><th align="left">total_salary</th></tr></thead><tbody><tr><td align="left">HR</td><td align="left">250000</td></tr><tr><td align="left">IT</td><td align="left">380000</td></tr></tbody></table></li></ul><h4 id="2-PARTITION-BY"><a href="#2-PARTITION-BY" class="headerlink" title="(2) PARTITION BY"></a><strong>(2) <code>PARTITION BY</code></strong></h4><ul><li><p><strong>è¯­æ³•</strong>ï¼šåœ¨çª—å£å‡½æ•°ä¸­å®šä¹‰æ•°æ®åˆ†åŒºèŒƒå›´ï¼Œä¿ç•™æ‰€æœ‰åŸå§‹è¡Œã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  employee_id, </span><br><span class="line">  department, </span><br><span class="line">  salary,</span><br><span class="line">  <span class="built_in">RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>) <span class="keyword">AS</span> dept_rank</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure></li><li><p><strong>ç»“æœç¤ºä¾‹</strong>ï¼š</p><table><thead><tr><th align="left">employee_id</th><th align="left">department</th><th align="left">salary</th><th align="left">dept_rank</th></tr></thead><tbody><tr><td align="left">101</td><td align="left">HR</td><td align="left">80000</td><td align="left">1</td></tr><tr><td align="left">102</td><td align="left">HR</td><td align="left">75000</td><td align="left">2</td></tr><tr><td align="left">201</td><td align="left">IT</td><td align="left">95000</td><td align="left">1</td></tr></tbody></table></li></ul><hr><h3 id="4-å…³é”®åŒºåˆ«æ€»ç»“"><a href="#4-å…³é”®åŒºåˆ«æ€»ç»“" class="headerlink" title="4. å…³é”®åŒºåˆ«æ€»ç»“"></a><strong>4. å…³é”®åŒºåˆ«æ€»ç»“</strong></h3><table><thead><tr><th align="left"><strong>ç‰¹æ€§</strong></th><th align="left"><strong><code>GROUP BY</code></strong></th><th align="left"><strong><code>PARTITION BY</code></strong></th></tr></thead><tbody><tr><td align="left"><strong>è¡Œæ•°å˜åŒ–</strong></td><td align="left">å‡å°‘ï¼ˆæ¯ä¸ªåˆ†ç»„ä¸€è¡Œï¼‰</td><td align="left">ä¸å˜ï¼ˆä¿ç•™æ‰€æœ‰åŸå§‹è¡Œï¼‰</td></tr><tr><td align="left"><strong>å‡½æ•°ç±»å‹</strong></td><td align="left">èšåˆå‡½æ•°ï¼ˆ<code>SUM</code>, <code>AVG</code>ï¼‰</td><td align="left">çª—å£å‡½æ•°ï¼ˆ<code>RANK</code>, <code>ROW_NUMBER</code>ï¼‰</td></tr><tr><td align="left"><strong>ç»“æœå†…å®¹</strong></td><td align="left">åˆ†ç»„é”® + èšåˆå€¼</td><td align="left">åŸå§‹æ•°æ® + çª—å£è®¡ç®—ç»“æœ</td></tr><tr><td align="left"><strong>å…¸å‹ç”¨é€”</strong></td><td align="left">ç”Ÿæˆæ±‡æ€»ç»Ÿè®¡æŠ¥è¡¨</td><td align="left">æ’åã€ç´¯è®¡å€¼ã€å‰åè¡Œå¯¹æ¯”åˆ†æ</td></tr></tbody></table><h3 id="5-å¦‚ä½•é€‰æ‹©ï¼Ÿ"><a href="#5-å¦‚ä½•é€‰æ‹©ï¼Ÿ" class="headerlink" title="5. å¦‚ä½•é€‰æ‹©ï¼Ÿ"></a><strong>5. å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></h3><ul><li>**ç”¨ <code>GROUP BY</code>**ï¼š<br>éœ€è¦ç”Ÿæˆæ±‡æ€»ç»Ÿè®¡ç»“æœï¼ˆå¦‚éƒ¨é—¨æ€»å·¥èµ„ã€è®¢å•æ€»æ•°ï¼‰ï¼Œä¸”ä¸éœ€è¦ä¿ç•™åŸå§‹æ˜ç»†æ•°æ®ã€‚</li><li>**ç”¨ <code>PARTITION BY</code>**ï¼š<br>éœ€è¦åœ¨ä¿ç•™æ‰€æœ‰åŸå§‹è¡Œçš„åŸºç¡€ä¸Šï¼Œæ·»åŠ åˆ†ç»„è®¡ç®—åˆ—ï¼ˆå¦‚éƒ¨é—¨å†…æ’åã€ç´¯è®¡é”€å”®é¢ï¼‰ã€‚</li></ul><hr><h3 id="ä¸€å¥è¯æ€»ç»“"><a href="#ä¸€å¥è¯æ€»ç»“" class="headerlink" title="ä¸€å¥è¯æ€»ç»“"></a><strong>ä¸€å¥è¯æ€»ç»“</strong></h3><ul><li><code>GROUP BY</code> æ˜¯ <strong>çºµå‘å‹ç¼©</strong>ï¼ˆèšåˆåˆ†ç»„ï¼Œå‡å°‘è¡Œæ•°ï¼‰ã€‚</li><li><code>PARTITION BY</code> æ˜¯ <strong>æ¨ªå‘æ‰©å±•</strong>ï¼ˆåˆ†åŒºè®¡ç®—ï¼Œä¿ç•™æ‰€æœ‰è¡Œï¼‰ã€‚</li></ul><h1 id="å­æŸ¥è¯¢ã€è”åˆæŸ¥è¯¢"><a href="#å­æŸ¥è¯¢ã€è”åˆæŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢ã€è”åˆæŸ¥è¯¢"></a><strong>å­æŸ¥è¯¢ã€è”åˆæŸ¥è¯¢</strong></h1><h2 id="å­æŸ¥è¯¢-æœ€å¥½åŠ åˆ«å"><a href="#å­æŸ¥è¯¢-æœ€å¥½åŠ åˆ«å" class="headerlink" title="å­æŸ¥è¯¢(æœ€å¥½åŠ åˆ«å)"></a>å­æŸ¥è¯¢(æœ€å¥½åŠ åˆ«å)</h2><p>&#x3D;&#x3D;å­æŸ¥è¯¢å°±æ˜¯åµŒå¥—åœ¨æŸ¥è¯¢ä¸­çš„æŸ¥è¯¢ã€‚&#x3D;&#x3D;</p><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¯¹æ•°æ®çš„æŸ¥è¯¢å¤„ç†ä¸æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥å°±å¯ä»¥å®Œæˆçš„ï¼›</p><p>ä¸èƒ½å®Œæˆçš„åŸå› ï¼Œå¯èƒ½æ˜¯æŸ¥è¯¢æ¡ä»¶æ¯”è¾ƒå¤æ‚ï¼Œä¹Ÿå¯èƒ½æ˜¯å—å›°äºSQLè‡ªèº«è¯­æ³•çš„é™åˆ¶ï¼›</p><h3 id="å•è¡Œå­æŸ¥è¯¢"><a href="#å•è¡Œå­æŸ¥è¯¢" class="headerlink" title="å•è¡Œå­æŸ¥è¯¢"></a><strong>å•è¡Œå­æŸ¥è¯¢</strong></h3><p><strong>å•è¡Œå­æŸ¥è¯¢æ˜¯æŒ‡è¿”å›ä¸€è¡Œæ•°æ®çš„å­æŸ¥è¯¢è¯­å¥ã€‚</strong>å½“whereå­å¥å¼•ç”¨å•è¡Œå­æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ&#x3D; ã€&gt;ã€&lt;ç­‰ï¼‰ã€‚</p><p>æŸ¥è¯¢ç»“æœè¡¨ç°å½¢å¼ï¼šå•è¡Œå•åˆ— å¤šè¡Œå•åˆ— å¤šè¡Œå¤šåˆ— å•è¡Œå¤šåˆ—</p><p>â€‹   å•è¡Œå•åˆ—ï¼Œä¸€ä¸ªå€¼ ä¸€ä¸ªåˆ— ä¸€ä¸ªè¡¨</p><h3 id="å¤šè¡Œå­æŸ¥è¯¢"><a href="#å¤šè¡Œå­æŸ¥è¯¢" class="headerlink" title="å¤šè¡Œå­æŸ¥è¯¢"></a><strong>å¤šè¡Œå­æŸ¥è¯¢</strong></h3><p>å¤šè¡Œå­æŸ¥è¯¢<strong>æ˜¯æŒ‡è¿”å›å¤šè¡Œæ•°æ®çš„å­æŸ¥è¯¢è¯­å¥ã€‚</strong>å½“whereå­å¥å¼•ç”¨å¤šè¡Œå­æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å¤šè¡Œæ¯”è¾ƒç¬¦ï¼ˆinã€anyã€allã€existç­‰ï¼‰</p><p>æŸ¥è¯¢ç»“æœè¡¨ç°å½¢å¼:å¤šè¡Œå•åˆ— ä¸€ä¸ªåˆ— ä¸€ä¸ªè¡¨</p><p>ä¾‹å­ï¼š</p><p>å¤šæ¡ä»¶æŸ¥è¯¢ï¼Œå¤§å¤šæ•°å¯ä»¥ä½¿ç”¨å¼€çª—ä»£æ›¿</p><p>æŸ¥çœ‹æ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥å§“åå’Œä»–çš„å·¥èµ„</p><p>å¼€çª—çš„åšæ³•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> ename,sal,deptno,<span class="built_in">rank</span>()<span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) r <span class="keyword">from</span> emp</span><br><span class="line">)</span><br><span class="line"><span class="keyword">where</span> r<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><ul><li>å¤šæ¡ä»¶å¤šè¡Œæ“ä½œ</li></ul><figure class="highlight plaintext"><figcaption><span>ename,sal,deptno from emp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where (deptno,sal) in (select deptno,max(sal) from emp group by deptno)</span><br></pre></td></tr></table></figure><ul><li>å¤šè¡Œå¤šåˆ— å•è¡Œå¤šåˆ— ä¸€ä¸ªè¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal,<span class="built_in">rank</span>()<span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> ename,sal,<span class="built_in">rank</span>()<span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) paiming <span class="keyword">from</span> emp</span><br><span class="line">)</span><br><span class="line"><span class="keyword">where</span> paiming<span class="operator">&lt;=</span><span class="number">3</span>;</span><br></pre></td></tr></table></figure><h2 id="è”åˆæŸ¥è¯¢"><a href="#è”åˆæŸ¥è¯¢" class="headerlink" title="è”åˆæŸ¥è¯¢"></a><strong>è”åˆæŸ¥è¯¢</strong></h2><p>SQLè”åˆæŸ¥è¯¢ä¸»è¦æ˜¯æ¶‰åŠä¸¤ä¸ªè¡¨æˆ–è€…å¤šä¸ªè¡¨ï¼ˆè‡ªèº«è¡¨å¤šæ¬¡ï¼‰çš„æŸ¥è¯¢ã€‚</p><p>ä¸»è¦åˆ†ä¸ºè¿æ¥æŸ¥è¯¢å’Œé›†åˆæŸ¥è¯¢ä¸¤å¤§ç±»ï¼Œå…¶ä¸­ï¼Œ</p><p><strong>è¿æ¥æŸ¥è¯¢</strong>åˆ†ï¼š</p><ul><li><p>å†…è¿æ¥ï¼ˆinner Join æˆ– Joinï¼‰</p></li><li><p>å·¦å¤–è¿æ¥ï¼ˆleft outer Join æˆ– left Joinï¼‰</p></li><li><p>å³å¤–è¿æ¥ï¼ˆright outer Join æˆ– right Joinï¼‰</p></li><li><p>å…¨å¤–è¿æ¥ï¼ˆfull outer Join æˆ– full Joinï¼‰</p></li></ul><p><strong>é›†åˆæŸ¥è¯¢</strong>åˆ†:</p><ul><li><p>minusï¼ˆå·®é›†ï¼‰</p></li><li><p>intersectï¼ˆäº¤é›†ï¼‰</p></li><li><p>union ï¼ˆå¹¶é›†ï¼‰æ’åºå»é‡</p></li><li><p>union allï¼ˆå¹¶é›†ï¼‰ä¸æ’åºå»é‡</p></li></ul><h2 id="è¿æ¥æŸ¥è¯¢ï¼ˆJOINï¼‰"><a href="#è¿æ¥æŸ¥è¯¢ï¼ˆJOINï¼‰" class="headerlink" title="è¿æ¥æŸ¥è¯¢ï¼ˆJOINï¼‰"></a>è¿æ¥æŸ¥è¯¢ï¼ˆJOINï¼‰</h2><ul><li><p>inner join ï¼ˆç­‰å€¼è¿æ¥æˆ–è€…å«å†…è¿æ¥ï¼‰ï¼šåªè¿”å›ä¸¤ä¸ªè¡¨ä¸­è¿æ¥å­—æ®µç›¸ç­‰çš„è¡Œã€‚</p></li><li><p>left join ï¼ˆå·¦è¿æ¥ï¼Œå·¦å¤–è¿æ¥ï¼‰ï¼šè¿”å›åŒ…æ‹¬å·¦è¡¨ä¸­çš„æ‰€æœ‰è®°å½•å’Œå³è¡¨ä¸­è¿æ¥å­—æ®µç›¸ç­‰çš„è®°å½•ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…ä¸Šï¼Œä»¥nullå€¼ä»£è¡¨å³è¾¹è¡¨çš„åˆ—ã€‚</p></li><li><p>right join ï¼ˆå³è¿æ¥ï¼Œå³å¤–è¿æ¥ï¼‰ï¼šè¿”å›åŒ…æ‹¬å³è¡¨ä¸­çš„æ‰€æœ‰è®°å½•å’Œå·¦è¡¨ä¸­è¿æ¥å­—æ®µç›¸ç­‰çš„è®°å½•ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œä»¥nullå€¼ä»£è¡¨å·¦è¾¹è¡¨çš„åˆ—</p></li><li><p>full join ï¼ˆå…¨å¤–è¿æ¥ï¼‰ï¼šè¿”å›å·¦å³è¡¨ä¸­æ‰€æœ‰çš„è®°å½•å’Œå·¦å³è¡¨ä¸­è¿æ¥å­—æ®µç›¸ç­‰çš„è®°å½•ï¼Œæ²¡æœ‰åŒ¹é…ä¸Šï¼Œä»¥nullå€¼ä»£è¡¨å·¦å³è¾¹è¡¨çš„åˆ—ã€‚</p></li></ul><p><img src="/2025/04/28/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/image-20250509164008543.png" alt="image-20250509164008543"></p><p><img src="/2025/04/28/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/image-20250509164028422.png" alt="image-20250509164028422"></p><h3 id="ç¬›å¡å°”è¿æ¥-äº¤å‰è¿æ¥-ï¼š"><a href="#ç¬›å¡å°”è¿æ¥-äº¤å‰è¿æ¥-ï¼š" class="headerlink" title="ç¬›å¡å°”è¿æ¥(äº¤å‰è¿æ¥)ï¼š"></a>ç¬›å¡å°”è¿æ¥(äº¤å‰è¿æ¥)ï¼š</h3><p>æŠŠç¬›å¡å°”ç§¯æ‰€æœ‰çš„ç»“æœç»™æ˜¾ç¤ºå‡ºæ¥äº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A <span class="keyword">cross</span> <span class="keyword">join</span> B</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">cross</span> <span class="keyword">join</span> dept;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp,dept;</span><br></pre></td></tr></table></figure><p><strong>äº¤å‰è¿æ¥çš„å·¦å¤–å³å¤–å†™æ³•(+)å†™åœ¨å·¦è¾¹å°±æ˜¯å³å¤–ï¼Œå†™åœ¨å³è¾¹å°±æ˜¯å·¦å¤–</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">from</span> emp,dept <span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno(<span class="operator">+</span>)</span><br></pre></td></tr></table></figure><h3 id="è‡ªç„¶è¿æ¥ï¼šä¸€ç§ç‰¹æ®Šçš„å†…è¿æ¥"><a href="#è‡ªç„¶è¿æ¥ï¼šä¸€ç§ç‰¹æ®Šçš„å†…è¿æ¥" class="headerlink" title="è‡ªç„¶è¿æ¥ï¼šä¸€ç§ç‰¹æ®Šçš„å†…è¿æ¥"></a>è‡ªç„¶è¿æ¥ï¼šä¸€ç§ç‰¹æ®Šçš„å†…è¿æ¥</h3><p>æ²¡æœ‰é“¾æ¥æ¡ä»¶onï¼Œå¦‚æœä¸¤ä¸ªè¡¨é‡Œé¢æœ‰ä¸€åˆ—ç›¸ç­‰ï¼Œ<strong>ç³»ç»Ÿé»˜è®¤æŠŠè¿™ä¸€åˆ—ä½œä¸ºé“¾æ¥æ¡ä»¶ï¼Œå¹¶ä¸”æŠŠè¿™ä¸¤åˆ—åˆæˆä¸€åˆ—æ”¾åˆ°è¡¨çš„æœ€é¢</strong>,é€‚ç”¨äºçŸ¥é“è¡¨é‡Œé¢æœ‰è¿™æ ·ä¸€åˆ—ï¼Œå¹¶ä¸”è¦ç”¨è¿™ä¸€åˆ—çš„æ—¶å€™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">natural</span> <span class="keyword">join</span> dept</span><br><span class="line"><span class="keyword">using</span>:è·Ÿè‡ªç„¶è¿æ¥ä½œç”¨ç›¸åŒï¼Œä¸åŒåœ¨äºå®ƒï¼Œå½“æœ‰å¤šä¸ªåˆ—ç›¸åŒæ—¶ï¼Œå¯ä»¥æŒ‡å®šç”¨å“ªä¸€åˆ—æ¥åšé“¾æ¥</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">join</span> dept <span class="keyword">using</span>(deptno)</span><br></pre></td></tr></table></figure><h3 id="å†…è¿æ¥"><a href="#å†…è¿æ¥" class="headerlink" title="å†…è¿æ¥"></a>å†…è¿æ¥</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp,dept <span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">inner</span> <span class="keyword">join</span> dept <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptn</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è‡ªè¿æ¥"><a href="#è‡ªè¿æ¥" class="headerlink" title="è‡ªè¿æ¥"></a>è‡ªè¿æ¥</h3><p>â€“æŸ¥è¯¢å‡ºæ¯ä¸ªå‘˜å·¥çš„ä¸Šçº§é¢†å¯¼(æŸ¥è¯¢å†…å®¹ï¼šå‘˜å·¥ç¼–å·ã€å‘˜å·¥å§“åã€é¢†å¯¼ç¼–å·ã€é¢†å¯¼å§“å)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> yg.empno,yg.ename,ld.empno,ld.ename</span><br><span class="line"><span class="keyword">from</span> emp yg <span class="keyword">inner</span> <span class="keyword">join</span> emp ld <span class="keyword">on</span> yg.mgr<span class="operator">=</span>ld.empno</span><br></pre></td></tr></table></figure><h3 id="ä¸ç­‰å€¼è¿æ¥ï¼šï¼ˆè¿‡æ»¤æ¡ä»¶çš„ç¬¦å·ä¸æ˜¯ç­‰å·ï¼‰"><a href="#ä¸ç­‰å€¼è¿æ¥ï¼šï¼ˆè¿‡æ»¤æ¡ä»¶çš„ç¬¦å·ä¸æ˜¯ç­‰å·ï¼‰" class="headerlink" title="ä¸ç­‰å€¼è¿æ¥ï¼šï¼ˆè¿‡æ»¤æ¡ä»¶çš„ç¬¦å·ä¸æ˜¯ç­‰å·ï¼‰"></a>ä¸ç­‰å€¼è¿æ¥ï¼šï¼ˆè¿‡æ»¤æ¡ä»¶çš„ç¬¦å·ä¸æ˜¯ç­‰å·ï¼‰</h3><p>â€“æŸ¥è¯¢å‘˜å·¥çš„å·¥èµ„çº§åˆ«</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,grade,sal <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> salgrade <span class="keyword">on</span> emp.sal <span class="keyword">between</span> losal <span class="keyword">and</span> hisal</span><br></pre></td></tr></table></figure><h3 id="å¤šè¡¨è¿æ¥"><a href="#å¤šè¡¨è¿æ¥" class="headerlink" title="å¤šè¡¨è¿æ¥"></a>å¤šè¡¨è¿æ¥</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> yg.empno,yg.ename,ld.empno,ld.ename,dname</span><br><span class="line"><span class="keyword">from</span> emp yg <span class="keyword">inner</span> <span class="keyword">join</span> emp ld <span class="keyword">on</span> yg.mgr<span class="operator">=</span>ld.empno</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept <span class="keyword">on</span> ld.deptno<span class="operator">=</span>dept.deptno</span><br></pre></td></tr></table></figure><h3 id="å¤–è¿æ¥"><a href="#å¤–è¿æ¥" class="headerlink" title="å¤–è¿æ¥"></a>å¤–è¿æ¥</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> emp <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> emp <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br></pre></td></tr></table></figure><p>â€“ç­›é€‰å‡ºæ¥empè¡¨ä¸­ä¸æ»¡è¶³æ¡ä»¶çš„æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">left</span> <span class="keyword">join</span> dept <span class="keyword">on</span> emp.deptno<span class="operator">=</span>dept.deptno</span><br><span class="line"><span class="keyword">where</span> dept.deptno <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure><p>â€“ç­›é€‰å‡ºDEPTè¡¨ä¸­ä¸æ»¡è¶³æ¡ä»¶æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno</span><br><span class="line"><span class="keyword">where</span> e.deptno <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure><p>â€“ç­›é€‰å‡ºempå’Œdeptè¡¨ä¸­ä¸æ»¡è¶³æ¡ä»¶çš„æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">full</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno</span><br><span class="line"><span class="keyword">where</span> d.deptno <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> e.deptno <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure><h3 id="onå’Œwhereä½¿ç”¨åŒºåˆ«"><a href="#onå’Œwhereä½¿ç”¨åŒºåˆ«" class="headerlink" title="onå’Œwhereä½¿ç”¨åŒºåˆ«"></a><strong>on</strong>å’Œ<strong>where</strong>ä½¿ç”¨åŒºåˆ«</h3><p>å†…è¿æ¥æ— å·®åˆ«ï¼Œå¤–è¿æ¥ç”¨onæ•ˆç‡é«˜</p><h4 id="1-ON-çš„ä½œç”¨"><a href="#1-ON-çš„ä½œç”¨" class="headerlink" title="1. ON çš„ä½œç”¨"></a><strong>1. <code>ON</code> çš„ä½œç”¨</strong></h4><ul><li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šä¸“é—¨ç”¨äº <strong><code>JOIN</code> æ“ä½œ</strong>ï¼ˆå¦‚ <code>INNER JOIN</code>ã€<code>LEFT JOIN</code> ç­‰ï¼‰ã€‚</p></li><li><p><strong>ä½œç”¨æ—¶æœº</strong>ï¼šåœ¨ <strong>è¡¨è¿æ¥è¿‡ç¨‹ä¸­</strong> å®šä¹‰è¿æ¥æ¡ä»¶ã€‚</p></li><li><p><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼š</p><ul><li><p>å†³å®šä¸¤å¼ è¡¨çš„è¡Œå¦‚ä½•åŒ¹é…ã€‚</p></li><li><p>å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œ<strong>ä»å¯èƒ½ä¿ç•™ä¸»è¡¨çš„è¡Œ</strong>ï¼ˆå–å†³äº <code>JOIN</code> ç±»å‹ï¼‰ã€‚</p></li></ul></li></ul><h4 id="2-WHERE-çš„ä½œç”¨"><a href="#2-WHERE-çš„ä½œç”¨" class="headerlink" title="2. WHERE çš„ä½œç”¨"></a><strong>2. <code>WHERE</code> çš„ä½œç”¨</strong></h4><ul><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šç”¨äº <strong>æœ€ç»ˆç»“æœé›†çš„å…¨å±€è¿‡æ»¤</strong>ã€‚</li><li><strong>ä½œç”¨æ—¶æœº</strong>ï¼šåœ¨ <strong>æ‰€æœ‰è¡¨è¿æ¥å®Œæˆå</strong> ç­›é€‰æ•°æ®ã€‚</li><li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼š<ul><li>è¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„è¡Œã€‚</li><li>å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œ<strong>ç›´æ¥ä¸¢å¼ƒæ•´è¡Œæ•°æ®</strong>ã€‚</li></ul></li></ul><h4 id="3-å…³é”®åŒºåˆ«æ€»ç»“"><a href="#3-å…³é”®åŒºåˆ«æ€»ç»“" class="headerlink" title="3. å…³é”®åŒºåˆ«æ€»ç»“"></a><strong>3. å…³é”®åŒºåˆ«æ€»ç»“</strong></h4><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left"><code>ON</code></th><th align="left"><code>WHERE</code></th></tr></thead><tbody><tr><td align="left"><strong>ä½œç”¨é˜¶æ®µ</strong></td><td align="left">è¡¨è¿æ¥è¿‡ç¨‹ä¸­</td><td align="left">è¡¨è¿æ¥å®Œæˆå</td></tr><tr><td align="left"><strong>å½±å“èŒƒå›´</strong></td><td align="left">å®šä¹‰è¡¨ä¹‹é—´çš„åŒ¹é…è§„åˆ™</td><td align="left">å…¨å±€è¿‡æ»¤ç»“æœé›†</td></tr><tr><td align="left"><strong>ä¿ç•™ä¸»è¡¨æ•°æ®</strong></td><td align="left">æ˜¯ï¼ˆå¦‚ <code>LEFT JOIN</code>ï¼‰</td><td align="left">å¦ï¼ˆä¸æ»¡è¶³æ¡ä»¶åˆ™ä¸¢å¼ƒæ‰€æœ‰è¡Œï¼‰</td></tr><tr><td align="left"><strong>æ€§èƒ½å½±å“</strong></td><td align="left">å¯èƒ½å‡å°‘è¿æ¥çš„æ•°æ®é‡</td><td align="left">å¯¹æœ€ç»ˆç»“æœè¿‡æ»¤</td></tr><tr><td align="left"><strong>å…¸å‹ç”¨é€”</strong></td><td align="left">æŒ‡å®šè¿æ¥æ¡ä»¶</td><td align="left">ç­›é€‰æœ€ç»ˆç»“æœ</td></tr></tbody></table><h4 id="4-ä¸åŒ-JOIN-ç±»å‹ä¸‹çš„è¡Œä¸º"><a href="#4-ä¸åŒ-JOIN-ç±»å‹ä¸‹çš„è¡Œä¸º" class="headerlink" title="4. ä¸åŒ JOIN ç±»å‹ä¸‹çš„è¡Œä¸º"></a><strong>4. ä¸åŒ <code>JOIN</code> ç±»å‹ä¸‹çš„è¡Œä¸º</strong></h4><p><strong>åœºæ™¯ï¼šå·¦è¡¨æœ‰æ•°æ®ï¼Œå³è¡¨æ— åŒ¹é…</strong></p><ul><li><strong><code>LEFT JOIN</code> + <code>ON</code> æ¡ä»¶ä¸æ»¡è¶³</strong><ul><li>å·¦è¡¨è¡Œä¿ç•™ï¼Œå³è¡¨å­—æ®µå¡«å…… <code>NULL</code>ã€‚</li></ul></li><li><strong><code>LEFT JOIN</code> + <code>WHERE</code> æ¡ä»¶ä¸æ»¡è¶³</strong><ul><li>æ•´è¡Œè¢«ä¸¢å¼ƒã€‚</li></ul></li></ul><h4 id="5-ä½•æ—¶ç”¨-ON-æˆ–-WHEREï¼Ÿ"><a href="#5-ä½•æ—¶ç”¨-ON-æˆ–-WHEREï¼Ÿ" class="headerlink" title="5. ä½•æ—¶ç”¨ ON æˆ– WHEREï¼Ÿ"></a><strong>5. ä½•æ—¶ç”¨ <code>ON</code> æˆ– <code>WHERE</code>ï¼Ÿ</strong></h4><ul><li>**ç”¨ <code>ON</code>**ï¼š<ul><li>å®šä¹‰è¡¨ä¹‹é—´çš„è¿æ¥é€»è¾‘ã€‚</li><li>åœ¨ <code>JOIN</code> è¿‡ç¨‹ä¸­è¿‡æ»¤å³è¡¨æ•°æ®ï¼ˆåŒæ—¶ä¿ç•™ä¸»è¡¨æ•°æ®ï¼‰ã€‚</li></ul></li><li>**ç”¨ <code>WHERE</code>**ï¼š<ul><li>å¯¹æœ€ç»ˆç»“æœé›†è¿›è¡Œå…¨å±€è¿‡æ»¤ã€‚</li><li>éœ€è¦ä¸¥æ ¼ç­›é€‰æ‰€æœ‰è¡Œæ—¶ã€‚</li></ul></li></ul><h4 id="6-ä¸€å¥è¯æ€»ç»“"><a href="#6-ä¸€å¥è¯æ€»ç»“" class="headerlink" title="6. ä¸€å¥è¯æ€»ç»“"></a><strong>6. ä¸€å¥è¯æ€»ç»“</strong></h4><ul><li><strong><code>ON</code> å†³å®šå¦‚ä½•è¿æ¥è¡¨</strong>ï¼Œ<code>WHERE</code> å†³å®šæœ€ç»ˆæ˜¾ç¤ºä»€ä¹ˆã€‚</li><li>åœ¨ <code>LEFT JOIN</code> ä¸­ï¼Œè‹¥å¸Œæœ›ä¿ç•™ä¸»è¡¨æ•°æ®ï¼Œå³è¡¨çš„è¿‡æ»¤æ¡ä»¶åº”å†™åœ¨ <code>ON</code> ä¸­ï¼›è‹¥æƒ³ä¸¥æ ¼è¿‡æ»¤ç»“æœï¼Œåˆ™ç”¨ <code>WHERE</code>ã€‚</li></ul><h2 id="é›†åˆæŸ¥è¯¢"><a href="#é›†åˆæŸ¥è¯¢" class="headerlink" title="é›†åˆæŸ¥è¯¢"></a><strong>é›†åˆæŸ¥è¯¢</strong></h2><ol><li><p>é›†åˆæŸ¥è¯¢åçš„ç»“æœå­—æ®µå<strong>æ˜¾ç¤ºä¸ºç¬¬ä¸€æ¡selectè¯­å¥å­—æ®µå</strong></p></li><li><p>union&#x2F;union all,intersect æ²¡æœ‰ä¸Šä¸‹å…³ç³»ï¼Œminusæœ‰<strong>ï¼ˆæ°¸è¿œæ˜¯ä¸Šå‡ä¸‹ï¼‰</strong></p></li><li><p>é›†åˆåšè¿ç®—çš„æ—¶å€™ï¼Œå¯ä»¥ä¸ä»…æ˜¯ä¸€åˆ—ï¼Œå¤šåˆ—åšè¿ç®—æ—¶ï¼Œè¦æ±‚åˆ—æ•°é‡ç›¸ç­‰ï¼Œå¹¶ä¸”åˆ—çš„æ•°æ®ç±»å‹ç›¸åŒ</p></li><li><p>unionã€union allã€intersectã€minusè¿ç®—å¯ä»¥è¿›è¡Œæ··åˆè¿ç®—ã€å®ƒä»¬ä¹‹é—´ä¼˜å…ˆçº§ç›¸åŒã€‚</p></li><li><p>å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·æ§åˆ¶é›†åˆè¿ç®—çš„ä¼˜å…ˆçº§ï¼Œå®ƒå…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§</p></li><li><p><strong>unionæ‹¼æ¥åç»“æœæ’åºï¼Œå»é‡ï¼Œunion all ï¼Œä¸æ’åºï¼Œä¸å»é‡ï¼Œunion all æ•ˆç‡æ›´é«˜</strong></p></li></ol><h4 id="å¹¶é›†"><a href="#å¹¶é›†" class="headerlink" title="å¹¶é›†"></a>å¹¶é›†</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> dept</span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> dept</span><br></pre></td></tr></table></figure><h4 id="union-all-å¹¶é›†å…¨éƒ¨æ˜¾ç¤º"><a href="#union-all-å¹¶é›†å…¨éƒ¨æ˜¾ç¤º" class="headerlink" title="union all å¹¶é›†å…¨éƒ¨æ˜¾ç¤º"></a>union all å¹¶é›†å…¨éƒ¨æ˜¾ç¤º</h4><p>ï¼ˆåˆ—åå¯ä»¥ä¸ä¸€æ ·ï¼Œç±»å‹ä¸€æ ·å°±å¯ä»¥äº†ï¼‰è¦</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> sal <span class="keyword">from</span> emp</span><br></pre></td></tr></table></figure><h4 id="äº¤é›†"><a href="#äº¤é›†" class="headerlink" title="äº¤é›†"></a>äº¤é›†</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">intersect</span></span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> dept</span><br></pre></td></tr></table></figure><h4 id="å·®é›†minus"><a href="#å·®é›†minus" class="headerlink" title="å·®é›†minus"></a>å·®é›†minus</h4><p><strong>æ°¸è¿œéƒ½æ˜¯ä¸Šå‡ä¸‹</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> dept</span><br><span class="line">minus</span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br><span class="line">(<span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> dept)</span><br><span class="line">minus</span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">from</span> emp</span><br></pre></td></tr></table></figure><h4 id="çµæ´»åº”ç”¨"><a href="#çµæ´»åº”ç”¨" class="headerlink" title="çµæ´»åº”ç”¨"></a>çµæ´»åº”ç”¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">333</span>,<span class="string">&#x27;test&#x27;</span> <span class="keyword">from</span> dual</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> empno <span class="keyword">desc</span>; </span><br></pre></td></tr></table></figure><h1 id="exits-å’Œ-exit"><a href="#exits-å’Œ-exit" class="headerlink" title="exits å’Œ exit"></a>exits å’Œ exit</h1><h3 id="ä¸€ã€EXITï¼šé€€å‡ºæµç¨‹æ§åˆ¶"><a href="#ä¸€ã€EXITï¼šé€€å‡ºæµç¨‹æ§åˆ¶" class="headerlink" title="ä¸€ã€EXITï¼šé€€å‡ºæµç¨‹æ§åˆ¶"></a><strong>ä¸€ã€<code>EXIT</code>ï¼šé€€å‡ºæµç¨‹æ§åˆ¶</strong></h3><h4 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a><strong>é€‚ç”¨åœºæ™¯</strong></h4><p>ä¸»è¦ç”¨äº <strong>PL&#x2F;SQL</strong>ï¼ˆOracle çš„è¿‡ç¨‹åŒ– SQLï¼‰ä¸­ï¼Œæ§åˆ¶å¾ªç¯æˆ–ä»£ç å—çš„æ‰§è¡Œæµç¨‹ã€‚</p><h4 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a><strong>åŠŸèƒ½</strong></h4><ul><li><strong>ç»ˆæ­¢å¾ªç¯</strong>ï¼šç«‹å³é€€å‡º <code>LOOP</code>ã€<code>WHILE</code> æˆ– <code>FOR</code> å¾ªç¯ã€‚</li><li><strong>é€€å‡ºä»£ç å—</strong>ï¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æå‰ç»“æŸç¨‹åºæ‰§è¡Œã€‚</li></ul><h4 id="è¯­æ³•ç¤ºä¾‹"><a href="#è¯­æ³•ç¤ºä¾‹" class="headerlink" title="*è¯­æ³•ç¤ºä¾‹"></a>*<em>è¯­æ³•ç¤ºä¾‹</em></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.10</span> LOOP</span><br><span class="line">    EXIT <span class="keyword">WHEN</span> i <span class="operator">=</span> <span class="number">5</span>;  <span class="comment">-- å½“ i=5 æ—¶é€€å‡ºå¾ªç¯</span></span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(i);</span><br><span class="line">  <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º</strong>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure><hr><h3 id="äºŒã€EXISTSï¼šå­˜åœ¨æ€§æ£€æŸ¥"><a href="#äºŒã€EXISTSï¼šå­˜åœ¨æ€§æ£€æŸ¥" class="headerlink" title="äºŒã€EXISTSï¼šå­˜åœ¨æ€§æ£€æŸ¥"></a><strong>äºŒã€<code>EXISTS</code>ï¼šå­˜åœ¨æ€§æ£€æŸ¥</strong></h3><h4 id="é€‚ç”¨åœºæ™¯-1"><a href="#é€‚ç”¨åœºæ™¯-1" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a><strong>é€‚ç”¨åœºæ™¯</strong></h4><p>ç”¨äº <strong>SQL æŸ¥è¯¢</strong> ä¸­ï¼Œæ£€æŸ¥å­æŸ¥è¯¢æ˜¯å¦è¿”å›è‡³å°‘ä¸€è¡Œæ•°æ®ã€‚</p><h4 id="åŠŸèƒ½-1"><a href="#åŠŸèƒ½-1" class="headerlink" title="åŠŸèƒ½"></a><strong>åŠŸèƒ½</strong></h4><ul><li><strong>æ¡ä»¶è¿‡æ»¤</strong>ï¼šç»“åˆ <code>WHERE</code> å­å¥ï¼Œåˆ¤æ–­å­æŸ¥è¯¢æ˜¯å¦æœ‰ç»“æœã€‚</li><li><strong>é«˜æ•ˆéªŒè¯</strong>ï¼šå­æŸ¥è¯¢ä¸€æ—¦æ‰¾åˆ°åŒ¹é…è®°å½•å³ç»ˆæ­¢æ‰«æï¼Œæ€§èƒ½ä¼˜äº <code>IN</code> æˆ– <code>JOIN</code>ã€‚</li></ul><h4 id="è¯­æ³•ç¤ºä¾‹-1"><a href="#è¯­æ³•ç¤ºä¾‹-1" class="headerlink" title="è¯­æ³•ç¤ºä¾‹"></a><strong>è¯­æ³•ç¤ºä¾‹</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- æŸ¥è¯¢æœ‰è®¢å•çš„å®¢æˆ·</span><br><span class="line">SELECT customer_id, name</span><br><span class="line">FROM customers c</span><br><span class="line">WHERE EXISTS (</span><br><span class="line">  SELECT 1</span><br><span class="line">  FROM orders o</span><br><span class="line">  WHERE o.customer_id = c.customer_id</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong>ï¼šä»…è¿”å›è‡³å°‘æœ‰ä¸€ä¸ªè®¢å•çš„å®¢æˆ·ã€‚</p><hr><h3 id="ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“"><a href="#ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“" class="headerlink" title="ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“"></a><strong>ä¸‰ã€æ ¸å¿ƒåŒºåˆ«æ€»ç»“</strong></h3><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left"><code>EXIT</code></th><th align="left"><code>EXISTS</code></th></tr></thead><tbody><tr><td align="left"><strong>ç”¨é€”</strong></td><td align="left">æ§åˆ¶æµç¨‹ï¼ˆé€€å‡ºå¾ªç¯&#x2F;ä»£ç å—ï¼‰</td><td align="left">æ£€æŸ¥å­æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ç»“æœ</td></tr><tr><td align="left"><strong>è¯­å¢ƒ</strong></td><td align="left">PL&#x2F;SQL ç¼–ç¨‹</td><td align="left">SQL æŸ¥è¯¢</td></tr><tr><td align="left"><strong>æ‰§è¡Œé€»è¾‘</strong></td><td align="left">ç»ˆæ­¢å½“å‰å¾ªç¯æˆ–ä»£ç å—</td><td align="left">å¿«é€ŸéªŒè¯å­æŸ¥è¯¢æ˜¯å¦è¿”å›æ•°æ®</td></tr><tr><td align="left"><strong>å¸¸è§åœºæ™¯</strong></td><td align="left">å¾ªç¯ä¸­çš„æ¡ä»¶ç»ˆæ­¢</td><td align="left">ç­›é€‰å…³è”æ•°æ®ã€ä¼˜åŒ–å¤æ‚æŸ¥è¯¢</td></tr></tbody></table><hr><h3 id="å››ã€å¸¸è§è¯¯åŒº"><a href="#å››ã€å¸¸è§è¯¯åŒº" class="headerlink" title="å››ã€å¸¸è§è¯¯åŒº"></a><strong>å››ã€å¸¸è§è¯¯åŒº</strong></h3><h4 id="1-è¯¯å°†-EXIT-ç”¨äº-SQL-æŸ¥è¯¢"><a href="#1-è¯¯å°†-EXIT-ç”¨äº-SQL-æŸ¥è¯¢" class="headerlink" title="1. è¯¯å°† EXIT ç”¨äº SQL æŸ¥è¯¢"></a>1. <strong>è¯¯å°† <code>EXIT</code> ç”¨äº SQL æŸ¥è¯¢</strong></h4><ul><li><code>EXIT</code> æ˜¯ PL&#x2F;SQL çš„å…³é”®å­—ï¼Œ<strong>ä¸èƒ½ç›´æ¥åœ¨çº¯ SQL è¯­å¥ä¸­ä½¿ç”¨</strong>ï¼ˆå¦‚ <code>SELECT</code> æŸ¥è¯¢ï¼‰ã€‚</li></ul><h4 id="2-æ··æ·†-EXISTS-å’Œ-IN"><a href="#2-æ··æ·†-EXISTS-å’Œ-IN" class="headerlink" title="2. æ··æ·† EXISTS å’Œ IN"></a>2. <strong>æ··æ·† <code>EXISTS</code> å’Œ <code>IN</code></strong></h4><ul><li><code>EXISTS</code> å…³æ³¨å­æŸ¥è¯¢æ˜¯å¦æœ‰ç»“æœï¼Œè€Œ <code>IN</code> ç”¨äºåŒ¹é…å…·ä½“å€¼åˆ—è¡¨ã€‚</li><li><strong>æ€§èƒ½å·®å¼‚</strong>ï¼š<code>EXISTS</code> é€šå¸¸æ¯” <code>IN</code> é«˜æ•ˆï¼Œå°¤å…¶æ˜¯å­æŸ¥è¯¢æ•°æ®é‡å¤§æ—¶ã€‚</li></ul><h3 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a><strong>äº”ã€æ€»ç»“</strong></h3><ul><li><p><strong><code>EXIT</code></strong> æ˜¯ PL&#x2F;SQL çš„æµç¨‹æ§åˆ¶å·¥å…·ï¼Œç”¨äºç»ˆæ­¢å¾ªç¯æˆ–ä»£ç å—ã€‚</p></li><li><p><strong><code>EXISTS</code></strong> æ˜¯ SQL çš„é€»è¾‘è¿ç®—ç¬¦ï¼Œç”¨äºé«˜æ•ˆéªŒè¯å­æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æ•°æ®ã€‚</p></li></ul><h3 id="existså’Œinçš„åŒºåˆ«"><a href="#existså’Œinçš„åŒºåˆ«" class="headerlink" title="existså’Œinçš„åŒºåˆ«"></a><strong>exists</strong>å’Œ<strong>in</strong>çš„åŒºåˆ«</h3><p>  INé€‚åˆäºå¤–è¡¨å¤§è€Œå†…è¡¨å°çš„æƒ…å†µ;EXISTSé€‚åˆäºå¤–è¡¨å°è€Œå†…è¡¨å¤§çš„æƒ…å†µ,è¿™æ ·æ•ˆç‡ä¼šé«˜çš„ã€‚</p><h4 id="å¸¦ç´¢å¼•åˆ†æexistså’Œinçš„åŒºåˆ«"><a href="#å¸¦ç´¢å¼•åˆ†æexistså’Œinçš„åŒºåˆ«" class="headerlink" title="å¸¦ç´¢å¼•åˆ†æexistså’Œinçš„åŒºåˆ«"></a><em>å¸¦ç´¢å¼•åˆ†æexistså’Œ</em>inçš„åŒºåˆ«</h4><pre><code> inæ˜¯æŠŠå¤–è¡¨å’Œå†…è¡¨ä½œhashè¿æ¥ï¼Œè€Œexistsæ˜¯å¯¹å¤–è¡¨ä½œloopå¾ªç¯ï¼Œæ¯æ¬¡loopå¾ªç¯å†å¯¹å†…è¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸€ç›´ä»¥æ¥è®¤ä¸ºexistsæ¯”inæ•ˆç‡é«˜çš„è¯´æ³•æ˜¯ä¸å‡†ç¡®çš„ã€‚å¦‚æœæŸ¥è¯¢çš„ä¸¤ä¸ªè¡¨å¤§å°ç›¸å½“ï¼Œé‚£ä¹ˆç”¨inå’Œexistså·®åˆ«ä¸å¤§ï¼›å¦‚æœä¸¤ä¸ªè¡¨ä¸­ä¸€ä¸ªè¾ƒå°ä¸€ä¸ªè¾ƒå¤§ï¼Œåˆ™å­æŸ¥è¯¢è¡¨å¤§çš„ç”¨existsï¼Œå­æŸ¥è¯¢è¡¨å°çš„ç”¨inï¼›</code></pre><h4 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a><strong>ç»“è®º</strong></h4><p>â€‹æ­£å¦‚æ‰€çœ‹åˆ°çš„ï¼Œnot inå‡ºç°äº†ä¸æœŸæœ›çš„ç»“æœé›†ï¼Œå­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œæ‰€ä»¥ï¼Œè¯·å°½é‡ä¸è¦ä½¿ç”¨not in(å®ƒä¼šè°ƒç”¨å­æŸ¥è¯¢)ï¼Œè€Œå°½é‡ä½¿ç”¨not existsï¼ˆå®ƒä¼šè°ƒç”¨å…³è”å­æŸ¥è¯¢ï¼‰ã€‚<strong>å¦‚æœå­æŸ¥è¯¢ä¸­è¿”å›çš„ä»»æ„ä¸€æ¡è®°å½•å«æœ‰ç©ºå€¼ï¼Œåˆ™æŸ¥è¯¢å°†ä¸è¿”å›ä»»ä½•è®°å½•ã€‚</strong>å¦‚æœå­æŸ¥è¯¢å­—æ®µæœ‰éç©ºé™åˆ¶ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨not inã€‚<strong>å¦‚æœæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†not inï¼Œé‚£ä¹ˆå¯¹å†…å¤–è¡¨éƒ½è¿›è¡Œå…¨è¡¨æ‰«æï¼Œæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼›è€Œnotexistsçš„å­æŸ¥è¯¢ä¾ç„¶èƒ½ç”¨åˆ°è¡¨ä¸Šçš„ç´¢å¼•ã€‚</strong>æ‰€ä»¥æ— è®ºå“ªä¸ªè¡¨å¤§ï¼Œç”¨not existséƒ½æ¯”not in è¦å¿«ã€‚</p><h1 id="2ç§æ‰¹é‡æ’å…¥æ–¹å¼"><a href="#2ç§æ‰¹é‡æ’å…¥æ–¹å¼" class="headerlink" title="2ç§æ‰¹é‡æ’å…¥æ–¹å¼"></a>2ç§æ‰¹é‡æ’å…¥æ–¹å¼</h1><h2 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><ol><li>æ‰§è¡Œåˆ›è¡¨è¯­å¥ï¼Œå¦‚ä¸‹ï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> shuiguo <span class="keyword">for</span> <span class="keyword">update</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ç‚¹å‡»å¼€é”ï¼Œé¼ æ ‡å›¾æ ‡å‘å³ï¼Œå³æ»‘å…¨é€‰ä¸­å…¨è“è‰²ï¼Œé€‰æ‹©éœ€è¦è´Ÿè´£çš„æ•°æ®ï¼Œåˆ°å·¥å…·é‡Œé¢ç²˜è´´ï¼Œæ‰“é’©âˆšã€‚</li></ol><h2 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><ol><li>å·¥å…·-&gt;ODBCå¯¼å…¥å™¨-&gt;å¡«ç”¨&#x2F;ç³»ç»ŸExcel Files-&gt;è¿æ¥-&gt;å¡«å†™è·¯å¾„å¹¶é€‰æ‹©æ–‡ä»¶-&gt;é€‰æ‹©æ’å…¥çš„è¡¨-&gt;é€‰æ‹©å®Œè¯´æœ‰å­—æ®µå¹¶è®¾ç½®æ ¼å¼-&gt;å¯¼å…¥</li></ol><h1 id="å®šä¹‰æ“ä½œæ§åˆ¶ç­‰è¯­å¥"><a href="#å®šä¹‰æ“ä½œæ§åˆ¶ç­‰è¯­å¥" class="headerlink" title="å®šä¹‰æ“ä½œæ§åˆ¶ç­‰è¯­å¥"></a><strong>å®šä¹‰æ“ä½œæ§åˆ¶ç­‰è¯­å¥</strong></h1><h2 id="ç´¢å¼•è§†å›¾åºåˆ—"><a href="#ç´¢å¼•è§†å›¾åºåˆ—" class="headerlink" title="ç´¢å¼•è§†å›¾åºåˆ—"></a><strong>ç´¢å¼•è§†å›¾åºåˆ—</strong></h2><p>åœ¨å¯¹åŒ…å«å¾ˆå¤šè¡Œçš„è¡¨è¿›è¡Œæ£€ç´¢å…¶ä¸­å‡ è¡Œæ•°æ®æ—¶ï¼Œéƒ½åº”è¯¥åˆ›å»ºç´¢å¼•ï¼Œä»¥åŠ å¿«æ£€ç´¢é€Ÿåº¦ã€‚</p><ol><li><p>ç´¢å¼•æ˜¯æ•°æ®åº“å¯¹è±¡ä¹‹ä¸€ï¼Œ<strong>ç”¨äºåŠ å¿«æ•°æ®çš„æ£€ç´¢</strong>ï¼Œç±»ä¼¼äºä¹¦ç±çš„ç´¢å¼•ã€‚åœ¨æ•°æ®åº“ä¸­ç´¢å¼•<strong>å¯ä»¥å‡å°‘æ•°æ®åº“ç¨‹åºæŸ¥è¯¢ç»“æœæ—¶éœ€è¦è¯»å–çš„æ•°æ®é‡</strong>ï¼Œç±»ä¼¼äºåœ¨ä¹¦ç±ä¸­æˆ‘ä»¬åˆ©ç”¨ç´¢å¼•å¯ä»¥ä¸ç”¨ç¿»é˜…æ•´æœ¬ä¹¦å³å¯æ‰¾åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚</p></li><li><p><strong>ç´¢å¼•æ˜¯å»ºç«‹åœ¨è¡¨ä¸Šçš„å¯é€‰å¯¹è±¡</strong>ï¼›ç´¢å¼•çš„å…³é”®åœ¨äºé€šè¿‡ä¸€ç»„æ’åºåçš„ç´¢å¼•é”®æ¥å–ä»£é»˜è®¤çš„å…¨è¡¨æ‰«ææ£€ç´¢æ–¹å¼ï¼Œä»è€Œæé«˜æ£€ç´¢æ•ˆç‡</p></li><li><p>ç´¢å¼•åœ¨é€»è¾‘ä¸Šå’Œç‰©ç†ä¸Šéƒ½ä¸ç›¸å…³çš„è¡¨å’Œæ•°æ®æ— å…³ï¼Œå½“åˆ›å»ºæˆ–è€…åˆ é™¤ä¸€ä¸ªç´¢å¼•æ—¶ï¼Œä¸ä¼šå½±å“åŸºæœ¬çš„è¡¨ï¼›</p></li><li><p>ç´¢å¼•<strong>ä¸€æ—¦å»ºç«‹ï¼Œä¼šè‡ªåŠ¨ç®¡ç†ç´¢å¼•</strong>ï¼Œç´¢å¼•åˆ é™¤ï¼Œä¸ä¼šå¯¹è¡¨äº§ç”Ÿå½±å“</p></li><li><p>oracleåˆ›å»ºä¸»é”®æ—¶ä¼š<strong>è‡ªåŠ¨</strong>åœ¨è¯¥åˆ—ä¸Šåˆ›å»ºç´¢å¼•</p></li></ol><h3 id="ç´¢å¼•çš„åˆ†ç±»"><a href="#ç´¢å¼•çš„åˆ†ç±»" class="headerlink" title="ç´¢å¼•çš„åˆ†ç±»"></a><strong>ç´¢å¼•çš„åˆ†ç±»</strong></h3><h4 id="ä¸€ã€æŒ‰å­˜å‚¨å½¢å¼ï¼ˆå³ç´¢å¼•ä¸­å­˜å‚¨çš„å†…å®¹ä¸åŒï¼‰"><a href="#ä¸€ã€æŒ‰å­˜å‚¨å½¢å¼ï¼ˆå³ç´¢å¼•ä¸­å­˜å‚¨çš„å†…å®¹ä¸åŒï¼‰" class="headerlink" title="ä¸€ã€æŒ‰å­˜å‚¨å½¢å¼ï¼ˆå³ç´¢å¼•ä¸­å­˜å‚¨çš„å†…å®¹ä¸åŒï¼‰"></a><strong>ä¸€ã€æŒ‰å­˜å‚¨å½¢å¼ï¼ˆå³ç´¢å¼•ä¸­å­˜å‚¨çš„å†…å®¹ä¸åŒï¼‰</strong></h4><ol><li><p>B-TREEç´¢å¼•(ç´¢å¼•åˆ—åŸå§‹æ•°æ®+ROWID)</p></li><li><p>ä½å›¾ç´¢å¼•(ä½å›¾+ROWID)</p></li><li><p>åå‘é”®ç´¢å¼•(ç´¢å¼•åˆ—åŸå§‹æ•°æ®çš„åå‘å­˜å‚¨+ROWID)</p></li><li><p>åŸºäºå‡½æ•°çš„ç´¢å¼•(å°†ç´¢å¼•åˆ—åŸå§‹æ•°æ®ç»å‡½æ•°å¤„ç†åå­˜å‚¨+ROWID)</p></li></ol><p>ç´¢å¼•çš„å‘½åè§„èŒƒï¼šIND_TBNAME_COLNAME</p><table><thead><tr><th></th><th>B-TREEç´¢å¼•</th><th>ä½å›¾ç´¢å¼•</th><th>åå‘é”®ç´¢å¼•</th><th>åŸºäºå‡½æ•°çš„ç´¢å¼•</th></tr></thead><tbody><tr><td>è¯´æ˜</td><td>ORACLEçš„<strong>é»˜è®¤ç´¢å¼•ç±»</strong>å‹ï¼Œå·¥ä½œä¸­æœ€å¸¸è§ã€ä½¿ç”¨èŒƒå›´æœ€å¹¿çš„ç´¢å¼•</td><td>ä½å›¾ç´¢å¼•åœ¨åˆ›å»ºæ—¶ï¼Œä¼šæ‰«ææ•´å¼ è¡¨ï¼Œä¸ºç´¢å¼•åˆ—çš„æ¯ä¸ªå–å€¼å»ºç«‹ä¸€ä¸ª<strong>ä¸é‡å¤çš„ä½å›¾ï¼ˆ</strong>BITMAPï¼‰æ¥æè¿°è¯¥å–å€¼</td><td>å¯ä»¥è§†ä½œä¸€ç§ç‰¹æ®Šçš„B-TREEç´¢å¼•ï¼Œ<strong>å­˜å‚¨ç´¢å¼•åˆ—çš„åå‘å€¼</strong></td><td>å¯ä»¥è§†ä½œä¸€ç§ç‰¹æ®Šçš„B-TREEç´¢å¼•ï¼Œ<strong>å­˜å‚¨å‡½æ•°å¤„ç†åçš„æ•°æ®</strong></td></tr><tr><td>è¯­æ³•</td><td><strong>create</strong> <strong>index</strong> ind_name <strong>on</strong> TB_NAME(COL_NAME);</td><td><strong>CREATE</strong> <strong>BITMAP</strong> <strong>INDEX</strong> IND_NAME <strong>ON</strong> TB_NAME(COL_NAME);</td><td><strong>CREATE INDEX</strong> IND_NAME <strong>ON</strong> TB_NAME(COL_NAME) <strong>REVERSE</strong>;</td><td><strong>CREATE INDEX</strong> IND_NAME <strong>ON</strong> TB_NAME(<strong>FUNCTION</strong>(COL_NAME));</td></tr><tr><td>èƒŒæ™¯</td><td><strong>åˆ—åŸºæ•°æ¯”è¾ƒå¤§</strong>çš„æ—¶å€™ä½¿ç”¨ï¼ˆè¡Œä¸šã€èº«é«˜ï¼‰</td><td><strong>åˆ—åŸºæ•°æ¯”è¾ƒå°</strong>çš„æ—¶å€™ä½¿ç”¨ï¼ˆæ€§åˆ«ã€å©šå§»çŠ¶å†µï¼‰</td><td>ä¸ºé˜²æ­¢B-TREEç´¢å¼•åœ¨æŸå¶ä¸Š<strong>æ•°æ®é‡å æ¯”è¿‡é«˜</strong>è€Œä½¿ç”¨çš„ä¸€ç§ç´¢å¼•</td><td>åœ¨æŸä¸ªå­—æ®µä¸Šä»¥åŸå€¼å»ºç«‹äº†ç´¢å¼•ï¼Œä½†æ˜¯åœ¨ç­›é€‰æ—¶åœ¨è¯¥å­—æ®µä¸Š<strong>ç»å¸¸åŠ å‡½æ•°ï¼Œå¯¼è‡´ç´¢å¼•æ— æ³•ç”Ÿæ•ˆ</strong></td></tr></tbody></table><p><strong>äºŒã€æŒ‰å”¯ä¸€æ€§ï¼ˆç´¢å¼•åˆ—ä¸­çš„æ•°æ®æ˜¯å¦æœ‰é‡å¤å€¼ï¼‰</strong></p><ol><li><strong>å”¯ä¸€ç´¢å¼•</strong> â€“ç´¢å¼•åˆ—ä¸­<strong>ä¸å¯èƒ½å‡ºç°é‡å¤å€¼</strong></li></ol><p>è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> INDEX IND_NAME <span class="keyword">ON</span> TB_NAME(COL_NAME);</span><br></pre></td></tr></table></figure><p>æ³¨æ„ç‚¹ï¼š</p><ol><li><p>B-TREEç´¢å¼•å¯ä»¥å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼Œä½å›¾ç´¢å¼•ä¸èƒ½å»ºç«‹å”¯ä¸€ç´¢å¼•</p></li><li><p>å¦‚æœåœ¨æŸåˆ—ä¸Šå»ºç«‹äº†å”¯ä¸€çº¦æŸæˆ–ä¸»é”®çº¦æŸï¼ŒORACLEä¼šè‡ªåŠ¨åœ¨è¯¥åˆ—ä¸Šå»ºç«‹ä¸€ä¸ªåŒåçš„å”¯ä¸€ç´¢å¼•</p></li><li><p><strong>éå”¯ä¸€ç´¢å¼•</strong> â€“ç´¢å¼•åˆ—ä¸­<strong>å¯èƒ½å‡ºç°é‡å¤å€¼</strong></p></li></ol><p>è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX IND_NAME <span class="keyword">ON</span> TB_NAME(COL_NAME);</span><br></pre></td></tr></table></figure><p><strong>ä¸‰ã€æŒ‰åˆ—çš„ä¸ªæ•°ï¼ˆç´¢å¼•è¦†ç›–çš„åˆ—çš„ä¸ªæ•°ï¼‰</strong></p><ol><li>å•åˆ—ç´¢å¼• â€“åŸºäºä¸€ä¸ªåˆ—å»ºç«‹çš„ç´¢å¼•</li></ol><p>è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX IND_NAME <span class="keyword">ON</span> TB_NAME(COL_NAME);</span><br></pre></td></tr></table></figure><ol start="2"><li>å¤åˆç´¢å¼•(ä¹Ÿç§°ä¸ºè”åˆç´¢å¼•ï¼‰ â€“åŸºäºä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šåˆ—å»ºç«‹çš„ç´¢å¼•</li></ol><p>è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX IND_NAME <span class="keyword">ON</span> TB_NAME(COL_NAME1,COL_NAME2...);</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a><strong>åˆ›å»ºç´¢å¼•</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> [<span class="keyword">unique</span><span class="operator">|</span>BITMAP] index ç´¢å¼•åç§° <span class="keyword">on</span> è¡¨åï¼ˆåˆ—å[ï¼Œåˆ—å]ï¼‰ tablespace è¡¨ç©ºé—´åï¼›</span><br></pre></td></tr></table></figure><ol><li><p>Unique ç”¨äºæŒ‡å®šæ˜¯å¦å¼ºåˆ¶è¦æ±‚ç´¢å¼•åˆ—ä¸ºå”¯ä¸€æ€§æ•°æ®ï¼Œè¡¨ç©ºé—´å¯é€‰æ‹©æ˜¯å¦æŒ‡å®šï¼Œä¸æŒ‡å®šåˆ™ç”¨é»˜è®¤è¡¨ç©ºé—´ã€‚</p></li><li><p>å‡ºäºæ€§èƒ½è€ƒè™‘ç´¢å¼•è¡¨ç©ºé—´å’Œè¡¨çš„è¡¨ç©ºé—´è¦åˆ†å¼€ã€‚</p></li></ol><h3 id="ä¿®æ”¹ç´¢å¼•"><a href="#ä¿®æ”¹ç´¢å¼•" class="headerlink" title="ä¿®æ”¹ç´¢å¼•"></a><strong>ä¿®æ”¹ç´¢å¼•</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> index ç´¢å¼•å rename <span class="keyword">to</span> æ–°ç´¢å¼•åï¼›</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a><strong>åˆ é™¤ç´¢å¼•</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡<span class="keyword">drop</span> index ç´¢å¼•åï¼›</span><br></pre></td></tr></table></figure><h3 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a><strong>è§†å›¾</strong></h3><p>è§†å›¾å®é™…ä¸Šæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨çš„é¢„å®šä¹‰æŸ¥è¯¢ï¼Œè§†å›¾çš„ä½¿ç”¨æ–¹æ³•å’Œè¡¨ä¸€æ ·ã€‚è§†å›¾ä¸å­˜å‚¨æ•°æ®ï¼Œä»–ä»¬åªè®¿é—®åŸºè¡¨ä¸­çš„è¡Œã€‚</p><p>åˆ›å»ºè§†å›¾</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> è§†å›¾å <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> è¡¨å <span class="keyword">with</span> read <span class="keyword">only</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Drop</span> <span class="keyword">view</span> è§†å›¾åï¼›åˆ é™¤è§†å›¾</span><br></pre></td></tr></table></figure><p>scottè´¦å·è¦ä½¿ç”¨systemè´¦å·èµ‹äºˆæƒé™æ‰èƒ½åˆ›å»ºè§†å›¾</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">any</span> <span class="keyword">view</span> <span class="keyword">to</span> scott</span><br></pre></td></tr></table></figure><h2 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a><strong>äº‹åŠ¡</strong></h2><p>äº‹åŠ¡ï¼š<strong>å®ƒæ˜¯æ•°æ®åº“åœ¨æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œæ—¶ï¼Œä¿è¯æ‰€æœ‰çš„æ“ä½œéƒ½æ­£ç¡®å®Œæˆï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§</strong>ã€‚</p><p>å¿…é¡»å…·å¤‡ä»¥ä¸‹å››ä¸ªå±æ€§ï¼Œç®€ç§°<strong>ACID å±æ€§</strong>ï¼š</p><p>A:åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ“ä½œã€‚äº‹åŠ¡çš„å„æ­¥æ“ä½œæ˜¯ä¸å¯åˆ†çš„ï¼ˆåŸå­çš„ï¼‰ï¼›è¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚</p><p>C:ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœå¿…é¡»ä¸æ•°æ®åº“åœ¨æŸ¥è¯¢å¼€å§‹æ—¶çš„çŠ¶æ€ä¿æŒä¸€è‡´ï¼ˆè¯»ä¸ç­‰å¾…å†™ï¼Œå†™ä¸ç­‰å¾…è¯»ï¼‰ã€‚</p><p>I:éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šæ•°æ®åº“ä¸­æ¯ä¸€ä¸ªç”¨æˆ·çš„æ“ä½œéƒ½æ˜¯äº’ä¸å½±å“çš„ï¼Œå¯¹äºå…¶ä»–ä¼šè¯æ¥è¯´ï¼Œæœªå®Œæˆçš„ï¼ˆä¹Ÿå°±æ˜¯æœªæäº¤çš„ï¼‰äº‹åŠ¡å¿…é¡»ä¸è§ã€‚</p><p>D:æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤å®Œæˆåï¼Œæ•°æ®åº“å°±ä¸å¯ä»¥ä¸¢å¤±è¿™ä¸ªäº‹åŠ¡çš„ç»“æœï¼Œæ•°æ®å°±æ°¸ä¹…çš„ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p><h3 id="äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸ"><a href="#äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸ" class="headerlink" title="äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸ"></a><strong>äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸ</strong></h3><p>äº‹åŠ¡é‡‡ç”¨éšæ€§çš„æ–¹å¼ï¼Œèµ·å§‹äºsessionçš„ç¬¬ä¸€æ¡DMLè¯­å¥ï¼Œ</p><p>äº‹åŠ¡ç»“æŸäºï¼š</p><ol><li><p>COMMITï¼ˆæäº¤ï¼‰æˆ–ROLLBACKï¼ˆå›æ»šï¼‰</p></li><li><p>DDLè¯­å¥è¢«æ‰§è¡Œï¼ˆæäº¤ï¼‰</p></li><li><p>DCLè¯­å¥è¢«æ‰§è¡Œï¼ˆæäº¤ï¼‰</p></li><li><p>ç”¨æˆ·é€€å‡ºSQLPLUSï¼ˆæ­£å¸¸é€€å‡ºæ˜¯æäº¤ï¼Œéæ­£å¸¸é€€å‡ºæ˜¯å›æ»šï¼‰</p></li><li><p>æœåŠ¡å™¨æ•…éšœæˆ–ç³»ç»Ÿå´©æºƒï¼ˆå›æ»šï¼‰</p></li><li><p>shutdowm immediate(å›æ»šï¼‰</p></li></ol><p>åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œå¦‚æœæŸä¸ªDMLè¯­å¥å¤±è´¥ï¼Œä¹‹å‰å…¶ä»–ä»»ä½•DMLè¯­å¥å°†ä¿æŒå®Œå¥½ï¼Œè€Œä¸”ä¸ä¼šæäº¤ï¼</p><h3 id="Oracle-çš„äº‹åŠ¡ä¿å­˜ç‚¹åŠŸèƒ½"><a href="#Oracle-çš„äº‹åŠ¡ä¿å­˜ç‚¹åŠŸèƒ½" class="headerlink" title="Oracle çš„äº‹åŠ¡ä¿å­˜ç‚¹åŠŸèƒ½"></a><strong>Oracle</strong> <strong>çš„äº‹åŠ¡ä¿å­˜ç‚¹åŠŸèƒ½</strong></h3><p>savepointå‘½ä»¤å…è®¸åœ¨äº‹åŠ¡è¿›è¡Œä¸­è®¾ç½®ä¸€ä¸ªæ ‡è®°ï¼ˆä¿å­˜ç‚¹ï¼‰ï¼Œè¿™ä¸ªæ ‡è®°å¯ä»¥æ§åˆ¶rollbackçš„æ•ˆæœï¼Œå³åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å›æ»šæ‰æœ€è¿‘çš„éƒ¨åˆ†dmlè¯­å¥ï¼Œä¿ç•™ä¸‹ä¿å­˜ç‚¹ä¹‹å‰çš„çš„dmlè¯­å¥ï¼Œå¹¶ä½¿äº‹åŠ¡æœ¬èº«ç»§ç»­æ‰§è¡Œ(è€ƒç‚¹ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´å›æ»šåˆ°ä¿å­˜ç‚¹è¿™ä¸ªåŠ¨ä½œå¹¶ä¸ä½¿äº‹åŠ¡ç»“æŸã€‚</p><p>commit æäº¤</p><p>rollback å›æ»š</p><p>ä¿å­˜ç‚¹ï¼šsavepoint å¯ä»¥æŠŠåœ¨ä¿å­˜ç‚¹ä¹‹åçš„äº‹åŠ¡ç»™æ’¤é”€æ‰</p><p>æ“ä½œå®Œä¹‹å-&gt;savepoint ä¿å­˜ç‚¹åå­—</p><p>å›é€€åˆ°ä¿å­˜ç‚¹-&gt;rollback to ä¿å­˜ç‚¹åå­—</p><h3 id="æ’å®ƒé”å’Œå…±äº«é”"><a href="#æ’å®ƒé”å’Œå…±äº«é”" class="headerlink" title="æ’å®ƒé”å’Œå…±äº«é”"></a>æ’å®ƒé”å’Œå…±äº«é”</h3><p>æ•°æ®åº“ä¸­ä¸¤ç§åŸºæœ¬ç±»å‹çš„é”ï¼šæ’å®ƒé”å’Œå…±äº«é”ã€‚å½“æ•°æ®è¢«ä¸Šäº†æ’å®ƒé”ï¼Œå°±ä¸èƒ½è¢«å…¶ä»–äº‹</p><p>åŠ¡è¯»å–å’Œä¿®æ”¹ï¼›è€Œä¸Šäº†å…±äº«é”ï¼Œåªèƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼Œä½†æ˜¯ä¸èƒ½è¢«ä¿®æ”¹æ•°æ®åº“ã€‚</p><p>update emp set sal&#x3D;sal*1.1 where deptno&#x3D;10;â€“è¡Œçº§æ’ä»–é”</p><p>æŸ¥çœ‹è‡ªå·±çš„sessionid</p><p>select userenv(â€˜sidâ€™) from dual;</p><p>è§£å†³é”å®šå†²çª</p><ol><li><p>æ‰§è¡Œcommitæˆ–è€…rollbackç»“æŸäº‹åŠ¡</p></li><li><p>ç»ˆæ­¢ä¼šè¯</p></li><li><p>ç®¡ç†å‘˜æ€æ­»è¿›ç¨‹</p></li></ol><h3 id="Oracleé”è¡¨è§£é”-systemç”¨æˆ·ç™»å½•"><a href="#Oracleé”è¡¨è§£é”-systemç”¨æˆ·ç™»å½•" class="headerlink" title="Oracleé”è¡¨è§£é” systemç”¨æˆ·ç™»å½•"></a>Oracleé”è¡¨è§£é” systemç”¨æˆ·ç™»å½•</h3><p>æ—¢ç„¶æ¸…æ¥šäº†é”è¡¨å¦‚ä½•å½¢æˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦å¼€å§‹è§£é”ã€‚è§£é”çš„æ–¹æ³•å¾ˆç®€å•ï¼Œé€šè¿‡Sqlè¯­å¥</p><p>å°±å¯å®ç°ã€‚</p><p>1.æŸ¥çœ‹è¢«é”çš„è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> b.owner,b.object_name,a.session_id,a.locked_mode</span><br><span class="line"><span class="keyword">From</span> v$locked_object a,dba_objects b</span><br><span class="line"><span class="keyword">Where</span> b.object_id <span class="operator">=</span> a.object_id;</span><br></pre></td></tr></table></figure><p>2.æŸ¥çœ‹é‚£ä¸ªç”¨æˆ·é‚£ä¸ªè¿›ç¨‹é€ æˆæ­»é”</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.sid, q.sql_text</span><br><span class="line"><span class="keyword">FROM</span> v$sqltext q, v$session s</span><br><span class="line"><span class="keyword">WHERE</span> q.address <span class="operator">=</span> s.sql_address <span class="keyword">AND</span> s.sid <span class="operator">=</span> <span class="operator">&amp;</span>sid <span class="comment">-- è¿™ä¸ª&amp;sid æ˜¯ç¬¬ä¸€æ­¥æŸ¥è¯¢å‡ºæ¥çš„</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> piece;<span class="comment">--æŸ¥çœ‹å¯¼è‡´é”æ­»çš„SQL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Select</span></span><br><span class="line">b.username,b.sid,b.serial#,logon_time</span><br><span class="line"><span class="keyword">From</span> v$locked_object a,v$session b</span><br><span class="line"><span class="keyword">Where</span> a.session_id <span class="operator">=</span> b.sid <span class="keyword">order</span> <span class="keyword">by</span> b.logon_time;</span><br></pre></td></tr></table></figure><p>3.æ€æ‰è¿›ç¨‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;alter system kill session &#x27;&#x27;&#x27;</span> <span class="operator">||</span> sid <span class="operator">||</span> <span class="string">&#x27;,&#x27;</span> <span class="operator">||</span> serial# <span class="operator">||</span> <span class="string">&#x27;&#x27;&#x27;;&#x27;</span> &quot;Deadlock&quot; <span class="keyword">FROM</span> v$session</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="keyword">IN</span> (<span class="keyword">SELECT</span> sid <span class="keyword">FROM</span> v$lock <span class="keyword">WHERE</span> block <span class="operator">=</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®æ•°æ®åº“æ•°æ®æ—¶å¯èƒ½å­˜åœ¨çš„é—®é¢˜</p><ol><li>å¹»æƒ³è¯»ï¼š</li></ol><p>ã€€ã€€<strong>äº‹åŠ¡T1è¯»å–ä¸€æ¡æŒ‡å®šwhereæ¡ä»¶çš„è¯­å¥ï¼Œè¿”å›ç»“æœé›†ã€‚æ­¤æ—¶äº‹åŠ¡T2æ’å…¥ä¸€è¡Œæ–°è®°å½•</strong></p><p><strong>å¹¶commitï¼Œæ°å¥½æ»¡è¶³T1çš„whereæ¡ä»¶ã€‚ç„¶åT1ä½¿ç”¨ç›¸åŒçš„æ¡ä»¶å†æ¬¡æŸ¥è¯¢ï¼Œç»“æœé›†ä¸­å¯ä»¥</strong></p><p><strong>çœ‹åˆ°T2æ’å…¥çš„è®°å½•ï¼Œè¿™æ¡æ–°çºªå½•å°±æ˜¯å¹»æƒ³ã€‚</strong></p><ol start="2"><li>ä¸å¯é‡å¤è¯»å–ï¼š</li></ol><p>ã€€ã€€äº‹åŠ¡T1è¯»å–ä¸€è¡Œè®°å½•ï¼Œç´§æ¥ç€äº‹åŠ¡T2ä¿®æ”¹äº†T1åˆšåˆšè¯»å–çš„è®°å½•å¹¶commitï¼Œç„¶åT1å†</p><p>æ¬¡æŸ¥è¯¢ï¼Œå‘ç°ä¸ç¬¬ä¸€æ¬¡è¯»å–çš„è®°å½•ä¸åŒï¼Œè¿™ç§°ä¸ºä¸å¯é‡å¤è¯»ã€‚</p><ol start="3"><li>è„è¯»ï¼š</li></ol><p>ã€€ã€€<strong>äº‹åŠ¡T1æ›´æ–°äº†ä¸€è¡Œè®°å½•ï¼Œè¿˜æœªæäº¤æ‰€åšçš„ä¿®æ”¹ï¼Œè¿™ä¸ªT2è¯»å–äº†æ›´æ–°åçš„æ•°æ®ï¼Œç„¶å</strong></p><p><strong>T1æ‰§è¡Œå›æ»šæ“ä½œï¼Œå–æ¶ˆåˆšæ‰çš„ä¿®æ”¹ï¼Œæ‰€ä»¥T2æ‰€è¯»å–çš„è¡Œå°±æ— æ•ˆï¼Œä¹Ÿå°±æ˜¯è„æ•°æ®</strong></p><h2 id="åŒä¹‰è¯"><a href="#åŒä¹‰è¯" class="headerlink" title="åŒä¹‰è¯"></a><strong>åŒä¹‰è¯</strong></h2><p>åŒä¹‰è¯ï¼šå®ƒæ˜¯ç»™æ•°æ®åº“ä¸­çš„å¯¹è±¡èµ·ä¸€ä¸ªåˆ«åï¼Œå¯ä»¥å’Œä½¿ç”¨åŸå¯¹è±¡ä¸€æ ·å»ä½¿ç”¨åŒä¹‰è¯</p><p>åŒä¹‰è¯ä¸€èˆ¬æ˜¯ç»™åŸå¯¹è±¡å–ä¸€ä¸ªç®€å•æ˜“è®°çš„åå­—ï¼Œç®¡ç†å‘˜systemåˆ›å»ºåŒä¹‰è¯</p><p>åˆ›å»ºè¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace synonym åŒä¹‰è¯å <span class="keyword">for</span> å¯¹è±¡å;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> synonym e <span class="keyword">for</span> scott.emp; <span class="comment">--ç»™è¡¨åˆ›å»ºåŒä¹‰è¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> e;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> scott.emp;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace synonym de <span class="keyword">for</span> scott.dept_emp; <span class="comment">--ç»™è§†å›¾åˆ›å»ºåŒä¹‰è¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> de;</span><br></pre></td></tr></table></figure><p><strong>åŒä¹‰è¯å¯ä»¥ç”¨æ¥åšåªè¯»ç”¨æˆ·ï¼ŒåŒä¹‰è¯å¯ä»¥ç”¨æ¥åšåªè¯»ç”¨æˆ·æé«˜å®‰å…¨æ€§</strong></p><p>Oracleæ•°æ®åº“ä¸­æä¾›äº†åŒä¹‰è¯ç®¡ç†çš„åŠŸèƒ½ã€‚</p><p><strong>åŒä¹‰è¯æ˜¯æ•°æ®åº“æ–¹æ¡ˆå¯¹è±¡çš„ä¸€ä¸ªåˆ«åï¼Œç»å¸¸ç”¨äºç®€åŒ–å¯¹è±¡è®¿é—®å’Œæé«˜å¯¹è±¡è®¿é—®çš„å®‰å…¨æ€§ã€‚</strong>åœ¨ä½¿ç”¨åŒä¹‰è¯æ—¶ï¼ŒOracleæ•°æ®åº“å°†å®ƒç¿»è¯‘æˆå¯¹åº”æ–¹æ¡ˆå¯¹è±¡çš„åå­—ã€‚<strong>ä¸è§†å›¾ç±»ä¼¼ï¼ŒåŒä¹‰è¯å¹¶ä¸å ç”¨å®é™…å­˜å‚¨ç©ºé—´</strong>ï¼Œ<strong>åªåœ¨æ•°æ®å­—å…¸ä¸­ä¿å­˜äº†åŒä¹‰è¯çš„å®šä¹‰ã€‚</strong>åœ¨Oracleæ•°æ®åº“ä¸­çš„å¤§éƒ¨åˆ†æ•°æ®åº“å¯¹è±¡ï¼Œå¦‚è¡¨ã€è§†å›¾ã€åŒä¹‰è¯ã€åºåˆ—ã€å­˜å‚¨è¿‡ç¨‹ã€åŒ…ç­‰ç­‰ï¼Œæ•°æ®åº“ç®¡ç†å‘˜éƒ½å¯ä»¥æ ¹æ®å®é™…æƒ…å†µä¸ºä»–ä»¬å®šä¹‰åŒä¹‰è¯</p><h2 id="æ•°æ®å­—å…¸"><a href="#æ•°æ®å­—å…¸" class="headerlink" title="æ•°æ®å­—å…¸"></a><strong>æ•°æ®å­—å…¸</strong></h2><p><strong>æ•°æ®åº“å­—å…¸ï¼šæ˜¯æ•°æ®åº“è‡ªå·±ç»´æŠ¤ä¸€ç»„è¡¨ï¼Œå®ƒå­˜æ”¾äº†ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„ä¿¡æ¯ã€‚</strong></p><p><strong>æ•°æ®åº“å­—å…¸è§†å›¾ï¼šå°±æ˜¯æ•°æ®åº“å­—å…¸è§†å›¾</strong></p><p><strong>dba_:ç®¡ç†å‘˜æ•°æ®åº“å­—å…¸è§†å›¾</strong></p><p><strong>user_:ç”¨æˆ·çš„æ•°æ®åº“å­—å…¸è§†å›¾</strong></p><p><strong>all_:æ‰€æœ‰ç”¨æˆ·éƒ½å¯è§çš„æ•°æ®åº“å­—å…¸è§†å›¾</strong></p><h2 id="æ•°æ®å¯¼å…¥å¯¼å‡º"><a href="#æ•°æ®å¯¼å…¥å¯¼å‡º" class="headerlink" title="æ•°æ®å¯¼å…¥å¯¼å‡º"></a><strong>æ•°æ®å¯¼å…¥å¯¼å‡º</strong></h2><p>æ•°æ®çš„è¿ç§»å’Œå¤‡ä»½ï¼Œå¯¼å…¥å¯¼å‡ºï¼Œè™šæ‹Ÿæœºcmdè¿›è¡Œæ“ä½œ</p><p>exp è´¦å·&#x2F;å¯†ç @æ•°æ®åº“å file&#x3D;æ–‡ä»¶å­˜æ”¾è·¯å¾„ full&#x3D;y â€“å…¨åº“å¯¼å‡ºï¼Œå‘½ä»¤è¡Œè¯­å¥ï¼Œä¸éœ€è¦ç™»å½•æ•°æ®ï¼Œåªéœ€è¦åœ¨å‘½ä»¤è¡Œè¿è¡Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŒ‰ç”¨æˆ·å¯¼å‡ºï¼š</span></span><br><span class="line">exp scott<span class="operator">/</span>oracle<span class="variable">@orcl</span> file<span class="operator">=</span>c:\test\exp_0512_scott.bak OWNER<span class="operator">=</span>scott</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å¯¼å…¥</span></span><br><span class="line">imp scott<span class="operator">/</span>oracle<span class="variable">@orcl</span> file<span class="operator">=</span>c:\test\exp_0711_scott.bak ignore<span class="operator">=</span>y</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><h1 id="with-as-å­æŸ¥è¯¢"><a href="#with-as-å­æŸ¥è¯¢" class="headerlink" title="with..as å­æŸ¥è¯¢"></a><strong>with..as</strong> <strong>å­æŸ¥è¯¢</strong></h1><p>with..aså…³é”®å­—ï¼Œæ˜¯ä»¥â€˜withâ€™å…³é”®å­—å¼€å¤´çš„sqlè¯­å¥ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°åŒä¸€ä¸ªæŸ¥è¯¢sqlä¼šåŒæ—¶æŸ¥è¯¢å¤šä¸ªç›¸åŒçš„ç»“æœé›†ï¼Œå³sqlä¸€æ¨¡ä¸€æ ·ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥<strong>å°†è¿™äº›ç›¸åŒçš„sqlæŠ½å–å‡ºæ¥ï¼Œä½¿ç”¨with..aså®šä¹‰ã€‚with..asç›¸å½“äºä¸€å¼ ä¸­é—´è¡¨ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºsqlç‰‡æ®µã€‚</strong></p><p>â€“<strong>with as å¯ä»¥ç†è§£ä¸ºä¸€å¼ ä¸´æ—¶è¡¨æˆ–è€…ç†è§£æˆsqlç‰‡æ®µï¼Œåœ¨å¤šæ¬¡æŸ¥è¯¢è¯­å¥ç›¸åŒçš„æ—¶å€™å¯ä»¥æŠ½å–å‡ºæ¥ï¼Œè¾¾åˆ°â€™ä¸€æ¬¡è§£æï¼Œå¤šæ¬¡ä½¿ç”¨â€™</strong></p><p>â€“<strong>å¦‚æœæ¯ä¸ªéƒ¨åˆ†éƒ½å»æ‰§è¡Œä¸€éçš„è¯ï¼Œåˆ™æˆæœ¬æ¯”è¾ƒé«˜ï¼Œå¯ä»¥ä½¿ç”¨with asçŸ­è¯­ï¼Œåˆ™åªè¦æ‰§è¡Œä¸€éå³å¯</strong></p><p>ä¾‹å­ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> temp <span class="keyword">as</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) a,<span class="built_in">max</span>(deptno) m <span class="keyword">from</span> emp)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&lt;</span>(<span class="keyword">select</span> a <span class="keyword">from</span> temp) <span class="keyword">and</span> deptno<span class="operator">=</span>(<span class="keyword">select</span> m <span class="keyword">from</span> temp)</span><br><span class="line"></span><br><span class="line"><span class="comment">--with as éå¸¸é€‚åˆåœ¨union è¯­å¥ä¸­</span></span><br><span class="line"><span class="comment">--æ³¨æ„ï¼šwith as è¯­å¥æœ€åé¢ä¸èƒ½åŠ åˆ†å·ï¼Œå¦åˆ™æŠ¥ç¼ºå¤±selectå…³é”®å­—é”™è¯¯ã€‚</span></span><br><span class="line"><span class="keyword">with</span> temp1 <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> <span class="string">&#x27;female&#x27;</span> sex, <span class="string">&#x27;zhangsan&#x27;</span> stu_name <span class="keyword">from</span> dual),</span><br><span class="line">temp2 <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> <span class="string">&#x27;male&#x27;</span> sex, <span class="string">&#x27;lisi&#x27;</span> stu_name <span class="keyword">from</span> dual),</span><br><span class="line">temp3 <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> <span class="string">&#x27;female&#x27;</span> sex, <span class="string">&#x27;wangwu&#x27;</span> stu_name <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> temp1</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> temp2</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> temp3</span><br><span class="line"></span><br><span class="line"><span class="comment">--å‰é¢å®šä¹‰çš„with..asè¯­å¥å¯ä»¥åœ¨åé¢å®šä¹‰çš„with..asè¯­å¥ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">with</span> temp1 <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> <span class="string">&#x27;female&#x27;</span> sex, <span class="string">&#x27;zhangsan&#x27;</span> stu_name <span class="keyword">from</span> dual),</span><br><span class="line">temp2 <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> <span class="string">&#x27;male&#x27;</span> sex, <span class="string">&#x27;lisi&#x27;</span> stu_name <span class="keyword">from</span> dual),</span><br><span class="line">temp3 <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> temp2)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> temp1</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> temp2</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> temp3</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
