<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LangChainä½¿ç”¨ä¹‹Chains | Yinjin Yaoçš„åšå®¢</title><meta name="author" content="Yinjin Yao"><meta name="copyright" content="Yinjin Yao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Chainsçš„åŸºæœ¬ä½¿ç”¨ Chainçš„åŸºæœ¬æ¦‚å¿µ Chainï¼šé“¾ï¼Œç”¨äºå°†å¤šä¸ªç»„ä»¶ï¼ˆæç¤ºæ¨¡æ¿ã€LLMæ¨¡å‹ã€è®°å¿†ã€å·¥å…·ç­‰ï¼‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆå¯å¤ç”¨çš„å·¥ä½œæµï¼Œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚ Chain çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç»„åˆä¸åŒçš„æ¨¡å—åŒ–å•å…ƒï¼Œå®ç°æ¯”å•ä¸€ç»„ä»¶æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼š - å°†LLMä¸ Prompt Template ï¼ˆæç¤ºæ¨¡æ¿ï¼‰ç»“åˆ - å°†LLMä¸ è¾“å‡ºè§£æå™¨ç»“åˆ - å°†LLMä¸ å¤–éƒ¨æ•°æ®ç»“åˆï¼Œä¾‹å¦‚ç”¨äºé—®ç­” -">
<meta property="og:type" content="article">
<meta property="og:title" content="LangChainä½¿ç”¨ä¹‹Chains">
<meta property="og:url" content="https://cryingatnight.github.io/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/index.html">
<meta property="og:site_name" content="Yinjin Yaoçš„åšå®¢">
<meta property="og:description" content="Chainsçš„åŸºæœ¬ä½¿ç”¨ Chainçš„åŸºæœ¬æ¦‚å¿µ Chainï¼šé“¾ï¼Œç”¨äºå°†å¤šä¸ªç»„ä»¶ï¼ˆæç¤ºæ¨¡æ¿ã€LLMæ¨¡å‹ã€è®°å¿†ã€å·¥å…·ç­‰ï¼‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆå¯å¤ç”¨çš„å·¥ä½œæµï¼Œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚ Chain çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç»„åˆä¸åŒçš„æ¨¡å—åŒ–å•å…ƒï¼Œå®ç°æ¯”å•ä¸€ç»„ä»¶æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼š - å°†LLMä¸ Prompt Template ï¼ˆæç¤ºæ¨¡æ¿ï¼‰ç»“åˆ - å°†LLMä¸ è¾“å‡ºè§£æå™¨ç»“åˆ - å°†LLMä¸ å¤–éƒ¨æ•°æ®ç»“åˆï¼Œä¾‹å¦‚ç”¨äºé—®ç­” -">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cryingatnight.github.io/img/lita6.jpg">
<meta property="article:published_time" content="2025-10-13T04:00:00.000Z">
<meta property="article:modified_time" content="2025-10-13T02:07:32.000Z">
<meta property="article:author" content="Yinjin Yao">
<meta property="article:tag" content="LangChain">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cryingatnight.github.io/img/lita6.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LangChainä½¿ç”¨ä¹‹Chains",
  "url": "https://cryingatnight.github.io/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/",
  "image": "https://cryingatnight.github.io/img/lita6.jpg",
  "datePublished": "2025-10-13T04:00:00.000Z",
  "dateModified": "2025-10-13T02:07:32.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yinjin Yao",
      "url": "https://cryingatnight.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/headimage.png"><link rel="canonical" href="https://cryingatnight.github.io/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LangChainä½¿ç”¨ä¹‹Chains',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> å®éªŒå®¤</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> è±†ç“£ç½‘å¼€å‘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> ä¸Šä¸ä¸ŠAIè¯„åˆ†ç³»ç»Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 å›¾æ ‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/lita6.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/headimage.png" alt="Logo"><span class="site-name">Yinjin Yaoçš„åšå®¢</span></a><a class="nav-page-title" href="/"><span class="site-name">LangChainä½¿ç”¨ä¹‹Chains</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> å®éªŒå®¤</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> è±†ç“£ç½‘å¼€å‘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> ä¸Šä¸ä¸ŠAIè¯„åˆ†ç³»ç»Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 å›¾æ ‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">LangChainä½¿ç”¨ä¹‹Chains</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-10-13T04:00:00.000Z" title="å‘è¡¨äº 2025-10-13 12:00:00">2025-10-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-10-13T02:07:32.000Z" title="æ›´æ–°äº 2025-10-13 10:07:32">2025-10-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="chainsçš„åŸºæœ¬ä½¿ç”¨">Chainsçš„åŸºæœ¬ä½¿ç”¨</h1>
<h2 id="chainçš„åŸºæœ¬æ¦‚å¿µ">Chainçš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>Chainï¼šé“¾ï¼Œç”¨äºå°†å¤šä¸ªç»„ä»¶ï¼ˆæç¤ºæ¨¡æ¿ã€LLMæ¨¡å‹ã€è®°å¿†ã€å·¥å…·ç­‰ï¼‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆå¯å¤ç”¨çš„<strong>å·¥ä½œæµ</strong>ï¼Œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚</p>
<p><strong>Chain çš„æ ¸å¿ƒæ€æƒ³</strong>æ˜¯é€šè¿‡ç»„åˆä¸åŒçš„æ¨¡å—åŒ–å•å…ƒï¼Œå®ç°æ¯”å•ä¸€ç»„ä»¶æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼š - å°†LLMä¸ Prompt Template ï¼ˆæç¤ºæ¨¡æ¿ï¼‰ç»“åˆ - å°†LLMä¸ è¾“å‡ºè§£æå™¨ç»“åˆ - å°†LLMä¸ å¤–éƒ¨æ•°æ®ç»“åˆï¼Œä¾‹å¦‚ç”¨äºé—®ç­” - å°†LLMä¸ é•¿æœŸè®°å¿†ç»“åˆï¼Œä¾‹å¦‚ç”¨äºèŠå¤©å†å²è®°å½• - é€šè¿‡å°† <strong>ç¬¬ä¸€ä¸ªLLM çš„è¾“å‡º</strong>ä½œä¸º<strong>ç¬¬äºŒä¸ªLLM çš„è¾“å…¥</strong>ï¼Œâ€¦ï¼Œå°†å¤šä¸ªLLMæŒ‰é¡ºåºç»“åˆåœ¨ä¸€èµ·</p>
<h2 id="lcel-åŠå…¶åŸºæœ¬æ„æˆ">LCEL åŠå…¶åŸºæœ¬æ„æˆ</h2>
<p>ä½¿ç”¨LCELï¼Œå¯ä»¥æ„é€ å‡ºç»“æ„æœ€ç®€å•çš„Chainã€‚</p>
<p>LangChainè¡¨è¾¾å¼è¯­è¨€ï¼ˆLCELï¼ŒLangChain Expression Languageï¼‰æ˜¯ä¸€ç§å£°æ˜å¼æ–¹æ³•ï¼Œå¯ä»¥è½»æ¾åœ° å°†å¤šä¸ªç»„ä»¶é“¾æ¥æˆ AI å·¥ä½œæµã€‚å®ƒé€šè¿‡PythonåŸç”Ÿæ“ä½œç¬¦ï¼ˆå¦‚ç®¡é“ç¬¦|ï¼‰å°†ç»„ä»¶è¿æ¥æˆå¯æ‰§è¡Œæµç¨‹ï¼Œæ˜¾ è‘—ç®€åŒ–äº†AIåº”ç”¨çš„å¼€å‘ã€‚</p>
<p><strong>LCELçš„åŸºæœ¬æ„æˆ</strong>ï¼šæç¤ºï¼ˆPromptï¼‰+ æ¨¡å‹ï¼ˆModelï¼‰+ è¾“å‡ºè§£æå™¨ï¼ˆOutputParserï¼‰</p>
<p>å³ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨è¿™ä¸ªé“¾æ¡ä¸­ï¼Œç”¨æˆ·è¾“å…¥è¢«ä¼ é€’ç»™æç¤ºæ¨¡æ¿ï¼Œç„¶åæç¤ºæ¨¡æ¿çš„è¾“å‡ºè¢«ä¼ é€’ç»™æ¨¡å‹ï¼Œç„¶åæ¨¡å‹çš„è¾“å‡ºè¢«ä¼  é€’ç»™è¾“å‡ºè§£æå™¨ã€‚ </span></span><br><span class="line">chain = prompt | model | output_parser </span><br><span class="line">chain.invoke(&#123; <span class="string">&quot;input&quot;</span> : <span class="string">&quot;What&#x27;s your name?&quot;</span> &#125;)</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>Prompt</strong>ï¼šPrompt æ˜¯ä¸€ä¸ª BasePromptTemplateï¼Œè¿™æ„å‘³ç€å®ƒæ¥å—ä¸€ä¸ªæ¨¡æ¿å˜é‡çš„å­—å…¸å¹¶ç”Ÿæˆä¸€ ä¸ªPromptValue ã€‚PromptValue å¯ä»¥ä¼ é€’ç»™ LLMï¼ˆå®ƒä»¥å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼‰æˆ– ChatModelï¼ˆå®ƒä»¥ æ¶ˆæ¯åºåˆ—ä½œä¸ºè¾“å…¥ï¼‰ã€‚</li>
<li><strong>Model</strong>ï¼šå°† PromptValue ä¼ é€’ç»™ modelã€‚å¦‚æœæˆ‘ä»¬çš„ model æ˜¯ä¸€ä¸ª ChatModelï¼Œè¿™æ„å‘³ç€å®ƒ å°†è¾“å‡ºä¸€ä¸ª<code>BaseMessage</code>ã€‚</li>
<li><strong>OutputParser</strong>ï¼šå°† model çš„è¾“å‡ºä¼ é€’ç»™ output_parserï¼Œå®ƒæ˜¯ä¸€ä¸ª BaseOutputParserï¼Œæ„å‘³ç€ å®ƒå¯ä»¥æ¥å—å­—ç¬¦ä¸²æˆ– BaseMessage ä½œä¸ºè¾“å…¥ã€‚</li>
<li><strong>chain</strong>ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>|</code> è¿ç®—ç¬¦è½»æ¾åˆ›å»ºè¿™ä¸ªChainã€‚<code>|</code> è¿ç®—ç¬¦åœ¨ LangChain ä¸­ç”¨äºå°†ä¸¤ä¸ª å…ƒç´ ç»„åˆåœ¨ä¸€èµ·ã€‚</li>
<li><strong>invoke</strong>ï¼šæ‰€æœ‰LCELå¯¹è±¡éƒ½å®ç°äº† Runnable åè®®ï¼Œä¿è¯ä¸€è‡´çš„è°ƒç”¨æ–¹å¼ ï¼ˆ<code>invoke</code>/ <code>batch</code> / <code>stream</code> ï¼‰</li>
</ul>
<div class="line-block">ç¬¦å·ç±»ä¼¼äº shell â¾¥â¾¯ç®¡é“æ“ä½œç¬¦ï¼Œå®ƒå°†ä¸åŒçš„ç»„ä»¶é“¾æ¥åœ¨â¼€èµ·ï¼Œå°†å‰â¼€ä¸ªç»„ä»¶çš„è¾“å‡ºä½œä¸ºä¸‹â¼€ ä¸ªç»„ä»¶çš„è¾“â¼Šï¼Œè¿™å°±å½¢æˆäº†â¼€ä¸ª AI â¼¯ä½œæµã€‚</div>
<h2 id="runnable">Runnable</h2>
<p>Runnableæ˜¯LangChainå®šä¹‰çš„ä¸€ä¸ªæŠ½è±¡æ¥å£ï¼ˆProtocolï¼‰ï¼Œå®ƒ <strong>å¼ºåˆ¶è¦æ±‚</strong>æ‰€æœ‰LCELç»„ä»¶å®ç°ä¸€ç»„æ ‡å‡†æ–¹ æ³•ï¼š <img src="file-20251010164747842.png" alt="500" /> ä»»ä½•å®ç°äº†è¿™äº›æ–¹æ³•çš„å¯¹è±¡éƒ½è¢«è§†ä¸ºLCELå…¼å®¹ç»„ä»¶ã€‚æ¯”å¦‚ï¼šèŠå¤©æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿ã€è¾“å‡ºè§£æå™¨ã€æ£€ç´¢ å™¨ã€ä»£ç†(æ™ºèƒ½ä½“)ç­‰ã€‚ æ¯ä¸ª LCEL å¯¹è±¡éƒ½å®ç°äº† Runnable æ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰äº†ä¸€ç»„å…¬å…±çš„è°ƒç”¨æ–¹æ³•ã€‚è¿™ä½¿å¾— LCEL å¯¹è±¡é“¾ä¹Ÿ è‡ªåŠ¨æ”¯æŒè¿™äº›è°ƒç”¨æˆä¸ºå¯èƒ½ã€‚</p>
<p><strong>2ã€ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€è°ƒç”¨æ–¹å¼ï¼Ÿ</strong></p>
<p>ä¼ ç»Ÿé—®é¢˜ å‡è®¾æ²¡æœ‰ç»Ÿä¸€åè®®ï¼š - æç¤ºè¯æ¸²æŸ“ç”¨ .format() - æ¨¡å‹è°ƒç”¨ç”¨ .generate() - è§£æå™¨è§£æç”¨ .parse() - å·¥å…·è°ƒç”¨ç”¨ .run()</p>
<p>ä»£ç ä¼šå˜æˆï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">prompt_text = prompt.<span class="built_in">format</span>(topic= <span class="string">&quot;çŒ«&quot;</span> ) <span class="comment"># æ–¹æ³•1 </span></span><br><span class="line">model_out = model.generate(prompt_text) <span class="comment"># æ–¹æ³•2 </span></span><br><span class="line">result = parser.parse(model_out) <span class="comment"># æ–¹æ³•3</span></span><br></pre></td></tr></table></figure> <strong>ç—›ç‚¹</strong>ï¼šæ¯ä¸ªç»„ä»¶è°ƒç”¨æ–¹å¼ä¸åŒï¼Œç»„åˆæ—¶éœ€è¦æ‰‹åŠ¨é€‚é…ã€‚</p>
<p><strong>3ã€LCELè§£å†³æ–¹æ¡ˆ</strong> é€šè¿‡ <strong>Runnable</strong> åè®®ç»Ÿä¸€ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ï¼ˆåˆ†æ­¥è°ƒç”¨ï¼‰ </span></span><br><span class="line">prompt_text = prompt.invoke(&#123; <span class="string">&quot;topic&quot;</span> : <span class="string">&quot;çŒ«&quot;</span> &#125;) <span class="comment"># æ–¹æ³•1 </span></span><br><span class="line">model_out = model.invoke(prompt_text) <span class="comment"># æ–¹æ³•2 </span></span><br><span class="line">result = parser.invoke(model_out) <span class="comment"># æ–¹æ³•3 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ï¼ˆLCELç®¡é“å¼ï¼‰ </span></span><br><span class="line">chain = prompt | model | parser <span class="comment"># ç”¨ç®¡é“ç¬¦ç»„åˆ </span></span><br><span class="line">result = chain.invoke(&#123; <span class="string">&quot;topic&quot;</span> : <span class="string">&quot;çŒ«&quot;</span> &#125;) <span class="comment"># æ‰€æœ‰ç»„ä»¶ç»Ÿä¸€ç”¨invoke</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>ä¸€è‡´æ€§ï¼šæ— è®ºç»„ä»¶çš„åŠŸèƒ½å¤šå¤æ‚ï¼ˆæ¨¡å‹/æç¤ºè¯/å·¥å…·ï¼‰ï¼Œè°ƒç”¨æ–¹å¼å®Œå…¨ç›¸åŒ</li>
<li>ç»„åˆæ€§ï¼šç®¡é“æ“ä½œç¬¦ | èƒŒåè‡ªåŠ¨å¤„ç†ç±»å‹åŒ¹é…å’Œä¸­é—´ç»“æœä¼ é€’</li>
</ul>
<h2 id="ä½¿ç”¨ä¸¾ä¾‹">ä½¿ç”¨ä¸¾ä¾‹</h2>
<p>ä¸¾ä¾‹1ï¼š æƒ…å†µ1ï¼šæ²¡æœ‰ä½¿ç”¨chain <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼•å…¥ä¾èµ–åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">joke_query = <span class="string">&quot;å‘Šè¯‰æˆ‘ä¸€ä¸ªç¬‘è¯ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰Jsonè§£æå™¨  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä»¥PromptTemplateä¸ºä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢\n æ»¡è¶³çš„æ ¼å¼ä¸º&#123;format_instructions&#125;\n é—®é¢˜ä¸º&#123;question&#125;\n&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;format_instructions&quot;</span>: parser.get_format_instructions()&#125;,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt = prompt_template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: joke_query&#125;)  </span><br><span class="line">response = chat_model.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line">  </span><br><span class="line">json_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;```json\n&#123;\n  &quot;joke&quot;: &quot;ä¸ºä»€ä¹ˆæµ·æ´‹æ€»æ˜¯é‚£ä¹ˆè“ï¼Ÿå› ä¸ºé±¼å„¿ä»¬åœ¨æ°´é‡Œæ€»æ˜¯å“­ï¼&quot;\n&#125;\n```&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 32, <span class="string">&#x27;prompt_tokens&#x27;</span>: 32, <span class="string">&#x27;total_tokens&#x27;</span>: 64, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-CATaTzK9DXqSMbOaqYFiF7UAzlOwL&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--a05306ba-4a1e-420d-abe9-b9a45ee65b75-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 32, <span class="string">&#x27;output_tokens&#x27;</span>: 32, <span class="string">&#x27;total_tokens&#x27;</span>: 64, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;</span><br><span class="line">&#123;<span class="string">&#x27;joke&#x27;</span>: <span class="string">&#x27;ä¸ºä»€ä¹ˆæµ·æ´‹æ€»æ˜¯é‚£ä¹ˆè“ï¼Ÿå› ä¸ºé±¼å„¿ä»¬åœ¨æ°´é‡Œæ€»æ˜¯å“­ï¼&#x27;</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>æƒ…å†µ2ï¼šä½¿ç”¨chainï¼šå°†æç¤ºæ¨¡æ¿ã€æ¨¡å‹ã€è§£æå™¨é“¾æ¥åœ¨ä¸€èµ·ã€‚ä½¿ç”¨LCELå°†ä¸åŒçš„ç»„ä»¶ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„ é“¾æ¡ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼•å…¥ä¾èµ–åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">joke_query = <span class="string">&quot;å‘Šè¯‰æˆ‘ä¸€ä¸ªç¬‘è¯ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰Jsonè§£æå™¨  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä»¥PromptTemplateä¸ºä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢\n æ»¡è¶³çš„æ ¼å¼ä¸º&#123;format_instructions&#125;\n é—®é¢˜ä¸º&#123;question&#125;\n&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;format_instructions&quot;</span>: parser.get_format_instructions()&#125;,  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># å†™æ³•1ï¼š  </span></span><br><span class="line"><span class="comment"># prompt = prompt_template.invoke(input=&#123;&quot;question&quot;:joke_query&#125;)  </span></span><br><span class="line"><span class="comment"># response = chat_model.invoke(prompt)  </span></span><br><span class="line"><span class="comment"># json_result = parser.invoke(response)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­£ç¡®çš„å†™æ³•  </span></span><br><span class="line">chain = prompt_template | chat_model | parser  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é”™è¯¯çš„å†™æ³•  </span></span><br><span class="line"><span class="comment"># chain =  chat_model |  prompt_template | parser  </span></span><br><span class="line">json_result = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: joke_query&#125;)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;joke&#x27;</span>: <span class="string">&#x27;ä¸ºä»€ä¹ˆç¨‹åºå‘˜æ€»æ˜¯æ··æ·†åœ£è¯èŠ‚å’Œä¸‡åœ£èŠ‚ï¼Ÿå› ä¸º Oct 31 == Dec 25!&#x27;</span>&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="ä¼ ç»Ÿchainçš„ä½¿ç”¨">ä¼ ç»ŸChainçš„ä½¿ç”¨</h1>
<h2 id="åŸºç¡€é“¾llmchain">åŸºç¡€é“¾ï¼šLLMChain</h2>
<h3 id="ä½¿ç”¨è¯´æ˜">ä½¿ç”¨è¯´æ˜</h3>
<p>LCELä¹‹å‰ï¼Œæœ€åŸºç¡€ä¹Ÿæœ€å¸¸è§çš„é“¾ç±»å‹æ˜¯LLMChainã€‚ <strong>è¿™ä¸ªé“¾è‡³å°‘åŒ…æ‹¬ä¸€ä¸ªæç¤ºè¯æ¨¡æ¿ï¼ˆPromptTemplateï¼‰ï¼Œä¸€ä¸ªè¯­è¨€æ¨¡å‹ï¼ˆLLM æˆ–èŠå¤©æ¨¡å‹ï¼‰ã€‚</strong></p>
<blockquote>
<p>[!notice] æ³¨æ„ï¼šLLMChain was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use <code>prompt | llm</code> insteadã€‚</p>
</blockquote>
<p>ç‰¹ç‚¹ï¼š - ç”¨äº <strong>å•æ¬¡é—®ç­”</strong>ï¼Œè¾“å…¥ä¸€ä¸ª Promptï¼Œè¾“å‡º LLM çš„å“åº”ã€‚ - é€‚åˆ <strong>æ— ä¸Šä¸‹æ–‡</strong> çš„ç®€å•ä»»åŠ¡ï¼ˆå¦‚ç¿»è¯‘ã€æ‘˜è¦ã€åˆ†ç±»ç­‰ï¼‰ã€‚ - <strong>æ— è®°å¿†</strong>ï¼šæ— æ³•è‡ªåŠ¨ç»´æŠ¤èŠå¤©å†å²</p>
<h3 id="ä¸»è¦æ­¥éª¤">ä¸»è¦æ­¥éª¤</h3>
<ol type="1">
<li><strong>é…ç½®ä»»åŠ¡é“¾</strong>ï¼šä½¿ç”¨LLMChainç±»å°†ä»»åŠ¡ä¸æç¤ºè¯ç»“åˆï¼Œå½¢æˆå®Œæ•´çš„ä»»åŠ¡é“¾ã€‚ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chain = LLMChain(llm = llm, prompt = prompt_template)</span><br></pre></td></tr></table></figure></li>
<li>æ‰§è¡Œä»»åŠ¡é“¾ï¼šä½¿ç”¨invoke()ç­‰æ–¹æ³•æ‰§è¡Œä»»åŠ¡é“¾ï¼Œå¹¶è·å–ç”Ÿæˆç»“æœã€‚å¯ä»¥æ ¹æ®éœ€è¦å¯¹è¾“å‡ºè¿›è¡Œå¤„ç†å’Œå±• ç¤ºã€‚ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = chain.invoke(...) </span><br><span class="line"><span class="built_in">print</span> (result)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜</h3>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ•´ç†å¦‚ä¸‹ï¼š</p>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 37%" />
<col style="width: 2%" />
<col style="width: 1%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="header">
<th>å‚æ•°å</th>
<th>ç±»å‹</th>
<th>é»˜è®¤å€¼</th>
<th>å¿…å¡«</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>llm</td>
<td>Union[Runnable[LanguageModelInput, str], Runnable[LanguageModelInput, BaseMessage]]</td>
<td>-</td>
<td>æ˜¯</td>
<td>è¦è°ƒç”¨çš„è¯­è¨€æ¨¡å‹</td>
</tr>
<tr class="even">
<td><strong>prompt</strong></td>
<td>BasePromptTemplate</td>
<td>-</td>
<td>æ˜¯</td>
<td>è¦ä½¿ç”¨çš„æç¤ºå¯¹è±¡</td>
</tr>
<tr class="odd">
<td><strong>verbose</strong></td>
<td>bool</td>
<td>False</td>
<td>å¦</td>
<td><strong>æ˜¯å¦ä»¥è¯¦ç»†æ¨¡å¼è¿è¡Œ</strong>ã€‚åœ¨è¯¦ç»†æ¨¡å¼ ä¸‹ï¼Œä¸€äº›ä¸­é—´æ—¥å¿—å°†è¢«æ‰“å°åˆ°æ§åˆ¶ å°ã€‚é»˜è®¤ä½¿ç”¨å…¨å±€è¯¦ç»†è®¾ç½®ï¼Œå¯é€š è¿‡ langchain.globals.get_verbose() è®¿é—®</td>
</tr>
<tr class="even">
<td>callback_manager</td>
<td>Optional[BaseCallbackManager]</td>
<td>None</td>
<td>å¦</td>
<td>ã€å·²å¼ƒç”¨ã€‘è¯·æ”¹ç”¨callbacksã€‚</td>
</tr>
<tr class="odd">
<td>callbacks</td>
<td>Callbacks</td>
<td>None</td>
<td>å¦</td>
<td>å¯é€‰çš„å›è°ƒå¤„ç†å™¨åˆ—è¡¨æˆ–å›è°ƒç®¡ç† å™¨ã€‚åœ¨è°ƒç”¨é“¾çš„ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸åŒ é˜¶æ®µè¢«è°ƒç”¨ï¼Œä»on_chain_startå¼€ å§‹ï¼Œåˆ°on_chain_endæˆ– on_chain_errorç»“æŸã€‚è‡ªå®šä¹‰é“¾å¯ ä»¥é€‰æ‹©è°ƒç”¨é¢å¤–çš„å›è°ƒæ–¹æ³•ã€‚è¯¦è§ å›è°ƒæ–‡æ¡£</td>
</tr>
<tr class="even">
<td>llm_kwargs</td>
<td>dict</td>
<td>-</td>
<td>å¦</td>
<td>è¯­è¨€æ¨¡å‹çš„å…³é”®å­—å‚æ•°å­—å…¸</td>
</tr>
<tr class="odd">
<td><strong>memory</strong></td>
<td>Optional[BaseMemory]</td>
<td>None</td>
<td>å¦</td>
<td><strong>å¯é€‰çš„è®°å¿†å¯¹è±¡</strong>ã€‚é»˜è®¤ä¸ºNoneã€‚ è®°å¿†æ˜¯ä¸€ä¸ªåœ¨æ¯ä¸ªé“¾çš„å¼€å§‹å’Œç»“æŸ æ—¶è¢«è°ƒç”¨çš„ç±»ã€‚å¼€å§‹æ—¶ï¼Œè®°å¿†åŠ è½½ å˜é‡å¹¶åœ¨é“¾ä¸­ä¼ é€’ã€‚ç»“æŸæ—¶ï¼Œå®ƒä¿ å­˜ä»»ä½•è¿”å›çš„å˜é‡ã€‚æœ‰è®¸å¤šä¸åŒç±» å‹çš„å†…å­˜ï¼Œè¯·æŸ¥çœ‹å†…å­˜æ–‡æ¡£è·å–å®Œ æ•´ç›®å½•</td>
</tr>
<tr class="even">
<td>metadata</td>
<td>Optional[Dict[str, Any]]</td>
<td>None</td>
<td>å¦</td>
<td>ä¸é“¾ç›¸å…³è”çš„å¯é€‰å…ƒæ•°æ®ã€‚é»˜è®¤ä¸º Noneã€‚è¿™äº›å…ƒæ•°æ®å°†ä¸è°ƒç”¨æ­¤é“¾ çš„æ¯æ¬¡è°ƒç”¨ç›¸å…³è”ï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼  é€’ç»™callbacksä¸­å®šä¹‰çš„å¤„ç†ç¨‹ åºã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›æ¥è¯†åˆ«é“¾çš„ç‰¹ å®šå®ä¾‹åŠå…¶ç”¨ä¾‹</td>
</tr>
<tr class="odd">
<td><strong>output_parser</strong></td>
<td>BaseLLMOutputParser</td>
<td>-</td>
<td>å¦</td>
<td><strong>è¦ä½¿ç”¨çš„è¾“å‡ºè§£æå™¨</strong>ã€‚é»˜è®¤ä¸º StrOutputParser</td>
</tr>
<tr class="even">
<td>return_final_only</td>
<td>bool</td>
<td>True</td>
<td>å¦</td>
<td>æ˜¯å¦åªè¿”å›æœ€ç»ˆè§£æç»“æœã€‚é»˜è®¤ä¸º Trueã€‚å¦‚æœä¸ºFalseï¼Œå°†è¿”å›å…³äº ç”Ÿæˆçš„é¢å¤–ä¿¡æ¯ã€‚</td>
</tr>
<tr class="odd">
<td>tags</td>
<td>Optional[List[str]]</td>
<td>None</td>
<td>å¦</td>
<td>ä¸é“¾ç›¸å…³è”çš„å¯é€‰æ ‡ç­¾åˆ—è¡¨ã€‚é»˜è®¤ ä¸ºNoneã€‚è¿™äº›æ ‡ç­¾å°†ä¸è°ƒç”¨æ­¤é“¾ çš„æ¯æ¬¡è°ƒç”¨ç›¸å…³è”ï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼  é€’ç»™callbacksä¸­å®šä¹‰çš„å¤„ç†ç¨‹ åºã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›æ¥è¯†åˆ«é“¾çš„ç‰¹ å®šå®ä¾‹åŠå…¶ç”¨ä¾‹</td>
</tr>
</tbody>
</table>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> modulefinder <span class="keyword">import</span> replacePackageMap  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain.chains.sequential <span class="keyword">import</span> SimpleSequentialChain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line"><span class="comment"># BasePromptTemplateçš„å…¸å‹å­ç±»æœ‰ï¼šPrompTemplateã€ChatPromptTemplate  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦é«˜æ‰‹ï¼Œå¸®æˆ‘è§£å†³å¦‚ä¸‹çš„æ•°å­¦é—®é¢˜ï¼š&#123;question&#125;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chain = LLMChain(llm=chat_model, prompt=prompt_template, )  </span><br><span class="line">response = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ?&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;question&#x27;</span>: <span class="string">&#x27;1 + 2 * 3 = ?&#x27;</span>, <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;æ ¹æ®æ•°å­¦è¿ç®—çš„ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è¿›è¡Œä¹˜æ³•è¿ç®—ï¼Œç„¶åå†è¿›è¡ŒåŠ æ³•è¿ç®—ã€‚\n\næ‰€ä»¥ï¼Œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n1 + 2 * 3 = 1 + 6 = 7\n\nå› æ­¤ï¼Œ1 + 2 * 3 = 7ã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸¾ä¾‹2ï¼šä½¿ç”¨ChatPromptTemplateåŠå‚æ•°verboseçš„æ¼”ç¤º <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate, ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€æä¾›æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line"><span class="comment"># BasePromptTemplateçš„å…¸å‹å­ç±»æœ‰ï¼šPrompTemplateã€ChatPromptTemplate  </span></span><br><span class="line">prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦é«˜æ‰‹&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;å¸®æˆ‘è§£å†³å¦‚ä¸‹çš„æ•°å­¦é—®é¢˜ï¼š&#123;question&#125;&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">chain = LLMChain(  </span><br><span class="line">    llm=chat_model,  </span><br><span class="line">    prompt=prompt_template,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  <span class="comment">#æ˜¾å¼æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¯¦ç»†æ—¥å¿—æƒ…å†µ  </span></span><br><span class="line">)  </span><br><span class="line">response = chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ?&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ æ˜¯ä¸€ä¸ªæ•°å­¦é«˜æ‰‹</span><br><span class="line">Human: å¸®æˆ‘è§£å†³å¦‚ä¸‹çš„æ•°å­¦é—®é¢˜ï¼š1 + 2 * 3 = ?[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;question&#x27;</span>: <span class="string">&#x27;1 + 2 * 3 = ?&#x27;</span>, <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;æ ¹æ®æ•°å­¦è¿ç®—çš„ä¼˜å…ˆçº§ï¼Œå…ˆè¿›è¡Œä¹˜æ³•å†è¿›è¡ŒåŠ æ³•ã€‚å› æ­¤æˆ‘ä»¬å…ˆè®¡ç®— \\( 2 * 3 \\)ï¼Œå¾—åˆ° \\( 6 \\)ã€‚ç„¶åå†è¿›è¡ŒåŠ æ³•ï¼š\n\n\\[ \n1 + 6 = 7 \n\\]\n\næ‰€ä»¥ \\( 1 + 2 * 3 = 7 \\)ã€‚&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>è¡¥å……è¯´æ˜ï¼šè°ƒç”¨æ–¹æ³•é™¤äº†invoke()å¤–ï¼Œè¿˜æœ‰run()ã€predict()ã€å®ä¾‹æ–¹æ³•ç­‰ï¼Œæ•ˆæœä¸invoke()ç›¸åŒï¼Œè¿™é‡Œ ä¸å†ä»‹ç»ã€‚ ## é¡ºåºé“¾ä¹‹ SimpleSequentialChain</p>
<p>é¡ºåºé“¾ï¼ˆSequentialChainï¼‰å…è®¸å°†å¤šä¸ªé“¾é¡ºåºè¿æ¥èµ·æ¥ï¼Œæ¯ä¸ªChainçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªChainçš„è¾“å…¥ï¼Œ å½¢æˆç‰¹å®šåœºæ™¯çš„æµæ°´çº¿ï¼ˆPipelineï¼‰ã€‚</p>
<p><strong>é¡ºåºé“¾æœ‰ä¸¤ç§ç±»å‹</strong>ï¼š - å•ä¸ªè¾“å…¥/è¾“å‡ºï¼šå¯¹åº”ç€ SimpleSequentialChain - å¤šä¸ªè¾“å…¥/è¾“å‡ºï¼šå¯¹åº”ç€ï¼šSequentialChain</p>
<h3 id="è¯´æ˜">è¯´æ˜</h3>
<p>SimpleSequentialChainï¼šæœ€ç®€å•çš„é¡ºåºé“¾ï¼Œå¤šä¸ªé“¾ ä¸²è”æ‰§è¡Œ ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æœ‰ å•ä¸€çš„è¾“å…¥å’Œè¾“å‡ºï¼Œä¸€ ä¸ªæ­¥éª¤çš„è¾“å‡ºå°±æ˜¯ä¸‹ä¸€ä¸ªæ­¥éª¤çš„è¾“å…¥ï¼Œæ— éœ€æ‰‹åŠ¨æ˜ å°„ <img src="file-20251013092712319.png" /></p>
<h3 id="ä½¿ç”¨ä¸¾ä¾‹-1">ä½¿ç”¨ä¸¾ä¾‹</h3>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain  </span><br><span class="line">  </span><br><span class="line">chainA_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ å°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼š&#123;knowledge&#125;&quot;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chainA_chains = LLMChain(llm=chat_model,  </span><br><span class="line">                         prompt=chainA_template,  </span><br><span class="line">                         verbose=<span class="literal">True</span>  </span><br><span class="line">                         )  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># chainA_chains.invoke(&#123;&quot;knowledge&quot;:&quot;ä»€ä¹ˆæ˜¯LangChainï¼Ÿ&quot;&#125;)</span></span><br></pre></td></tr></table></figure></p>
<p>ç»§ç»­ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line">chainB_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®çš„å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼š&#123;description&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨20ä¸ªå­—ä»¥å†…&quot;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chainB_chains = LLMChain(llm=chat_model,  </span><br><span class="line">                         prompt=chainB_template,  </span><br><span class="line">                         verbose=<span class="literal">True</span>  </span><br><span class="line">                         )</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.sequential <span class="keyword">import</span> SimpleSequentialChain  </span><br><span class="line">  </span><br><span class="line">full_chain = SimpleSequentialChain(  </span><br><span class="line">    chains=[chainA_chains, chainB_chains],  </span><br><span class="line">    verbose=<span class="literal">True</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯´æ˜ï¼šé’ˆå¯¹äºSimpleSequentialChainè€Œè¨€ï¼Œå”¯ä¸€çš„è¾“å…¥çš„å˜é‡åæ˜¯ï¼šinput  </span></span><br><span class="line">response = full_chain.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ä»€ä¹ˆæ˜¯LangChain?&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>
<p>ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SimpleSequentialChain chain...[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ</span><br><span class="line">Human: è¯·ä½ å°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼šä»€ä¹ˆæ˜¯LangChain?[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">[36;1m[1;3mLangChain æ˜¯ä¸€ä¸ªå¼€æºçš„æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLM, Large Language Modelsï¼‰å’Œå…¶ä»– AI ç»„ä»¶çš„åº”ç”¨ç¨‹åºã€‚LangChain çš„è®¾è®¡åˆè¡·æ˜¯é€šè¿‡æä¾›ä¸°å¯Œçš„å·¥å…·å’Œç»“æ„ï¼Œç®€åŒ–ä¸è¯­è¨€æ¨¡å‹çš„æ•´åˆå’Œåº”ç”¨å¼€å‘è¿‡ç¨‹ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°æ„å»ºå¤æ‚çš„ NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰åº”ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„æ ¸å¿ƒæ¦‚å¿µ</span></span><br><span class="line"></span><br><span class="line">1. **é“¾ï¼ˆChainsï¼‰**ï¼š</span><br><span class="line">   LangChain çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯â€œé“¾â€ï¼Œå³å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œæˆ–ç»„ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚æ¯ä¸ªé“¾å¯ä»¥æ˜¯ç®€å•çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤æ‚çš„ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»ã€‚é“¾å¯ä»¥åŒ…æ‹¬æŸ¥è¯¢ã€è½¬æ¢ã€éªŒè¯ç­‰å¤šä¸ªæ­¥éª¤ã€‚</span><br><span class="line"></span><br><span class="line">2. **ä»£ç†ï¼ˆAgentsï¼‰**ï¼š</span><br><span class="line">   ä»£ç†æ˜¯ä¸€ç§å¯åŠ¨æ€å†³å®šå…¶è¡Œä¸ºå’Œè·¯å¾„çš„ç»“æ„ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªè¯­è¨€æ¨¡å‹æ¥ç†è§£ç”¨æˆ·è¾“å…¥ï¼Œå¹¶é€‰æ‹©æœ€åˆé€‚çš„è¡ŒåŠ¨ã€‚ä»£ç†é€šå¸¸åœ¨éœ€è¦å®æ—¶å†³ç­–çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸ç”¨æˆ·çš„å¯¹è¯ã€‚</span><br><span class="line"></span><br><span class="line">3. **å†…å­˜ï¼ˆMemoryï¼‰**ï¼š</span><br><span class="line">   LangChain æä¾›äº†å†…å­˜ç®¡ç†åŠŸèƒ½ï¼Œå…è®¸åº”ç”¨åœ¨ä¸åŒçš„ä¼šè¯ä¸­ä¿ç•™ç”¨æˆ·çš„ä¸Šä¸‹æ–‡å’Œå†å²ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—å¯¹è¯ç³»ç»Ÿèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ç”¨æˆ·çš„éœ€æ±‚å’Œåå¥½ã€‚</span><br><span class="line"></span><br><span class="line">4. **å·¥å…·ï¼ˆToolsï¼‰**ï¼š</span><br><span class="line">   LangChain æ”¯æŒå°†å¤–éƒ¨å·¥å…·å’Œ API é›†æˆåˆ°é“¾æˆ–ä»£ç†ä¸­ï¼Œä½¿å¾—è¯­è¨€æ¨¡å‹èƒ½å¤Ÿè¿›è¡Œé€»è¾‘æ¨ç†ã€æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨ web æœåŠ¡ç­‰ã€å¹¶å¤„ç†æ›´å¤æ‚çš„ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">5. **æ–‡æ¡£ï¼ˆDocumentsï¼‰**ï¼š</span><br><span class="line">   æ–‡æ¡£å¤„ç†æ˜¯ LangChain å¦ä¸€ä¸ªé‡è¦åŠŸèƒ½ã€‚åœ¨éœ€è¦å¤„ç†å¤§é‡æ–‡æœ¬ä¿¡æ¯çš„åœºæ™¯ä¸‹ï¼ŒLangChain æä¾›äº†æ–‡æ¡£æ£€ç´¢å’Œåˆ†æçš„èƒ½åŠ›ï¼Œä»¥æ”¯æŒä¿¡æ¯æå–ã€æ€»ç»“ç­‰ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä½¿ç”¨åœºæ™¯</span></span><br><span class="line"></span><br><span class="line">LangChain å¯ä»¥ç”¨äºå¤šç§åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</span><br><span class="line"></span><br><span class="line">- **èŠå¤©æœºå™¨äºº**ï¼šé€šè¿‡æ„å»ºé“¾å’Œä»£ç†ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºèƒ½å¤Ÿä¸ç”¨æˆ·è¿›è¡Œè‡ªç„¶äº¤äº’çš„å¯¹è¯ç³»ç»Ÿã€‚</span><br><span class="line">- **å†…å®¹ç”Ÿæˆ**ï¼šLangChain å¯ä»¥å¸®åŠ©è‡ªåŠ¨ç”Ÿæˆæ–‡ç« ã€æŠ¥å‘Šã€è¯—æ­Œç­‰ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¤šæ­¥ç”Ÿæˆçš„å¤æ‚å†…å®¹æ—¶ã€‚</span><br><span class="line">- **æ•°æ®åˆ†æ**ï¼šç»“åˆ LLM çš„æ¨ç†èƒ½åŠ›ï¼ŒLangChain èƒ½å¤Ÿæ”¯æŒå¤æ‚çš„æ•°æ®æŸ¥è¯¢å’Œåˆ†æä»»åŠ¡ã€‚</span><br><span class="line">- **æ•™è‚²å·¥å…·**ï¼šé€šè¿‡æ™ºèƒ½åŠ©æ‰‹ï¼ŒLangChain å¯ä»¥æ”¯æŒä¸ªæ€§åŒ–çš„å­¦ä¹ å’Œè¾…å¯¼ä½“éªŒã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä¼˜åŠ¿</span></span><br><span class="line"></span><br><span class="line">- **æ¨¡å—åŒ–**ï¼šLangChain çš„æ¨¡å—åŒ–è®¾è®¡ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©å’Œç»„åˆä¸åŒçš„ç»„ä»¶ï¼Œçµæ´»æ€§é«˜ã€‚</span><br><span class="line">- **å¼€æº**ï¼šä½œä¸ºä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ŒLangChain æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨å’Œæ”¹è¿›ä»£ç ã€‚</span><br><span class="line">- **é›†æˆèƒ½åŠ›**ï¼šèƒ½æ–¹ä¾¿åœ°ä¸å…¶ä»–å„ç§å·¥å…·å’Œå¹³å°é›†æˆï¼Œæ‰©å±•äº†åº”ç”¨çš„åŠŸèƒ½å’Œé€‚ç”¨èŒƒå›´ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»“è®º</span></span><br><span class="line"></span><br><span class="line">LangChain æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…å……åˆ†åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºå¤æ‚ä¸”æ™ºèƒ½çš„åº”ç”¨ç¨‹åºã€‚é€šè¿‡çµæ´»çš„é“¾ã€ä»£ç†ã€å†…å­˜å’Œå·¥å…·è®¾è®¡ï¼ŒLangChain ä½¿å¾—è‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨çš„å¼€å‘æ›´åŠ é«˜æ•ˆå’Œä¾¿æ·ã€‚æ— è®ºæ˜¯ç”¨äºå•†ä¸šåº”ç”¨ã€æ•™è‚²å·¥å…·ï¼Œè¿˜æ˜¯ä¸ªäººé¡¹ç›®ï¼ŒLangChain éƒ½ä¸ºå¼€å‘è€…æä¾›äº†ä¸°å¯Œçš„å¯èƒ½æ€§ã€‚[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“</span><br><span class="line">Human: è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®çš„å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼šLangChain æ˜¯ä¸€ä¸ªå¼€æºçš„æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLM, Large Language Modelsï¼‰å’Œå…¶ä»– AI ç»„ä»¶çš„åº”ç”¨ç¨‹åºã€‚LangChain çš„è®¾è®¡åˆè¡·æ˜¯é€šè¿‡æä¾›ä¸°å¯Œçš„å·¥å…·å’Œç»“æ„ï¼Œç®€åŒ–ä¸è¯­è¨€æ¨¡å‹çš„æ•´åˆå’Œåº”ç”¨å¼€å‘è¿‡ç¨‹ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°æ„å»ºå¤æ‚çš„ NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰åº”ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„æ ¸å¿ƒæ¦‚å¿µ</span></span><br><span class="line"></span><br><span class="line">1. **é“¾ï¼ˆChainsï¼‰**ï¼š</span><br><span class="line">   LangChain çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯â€œé“¾â€ï¼Œå³å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œæˆ–ç»„ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚æ¯ä¸ªé“¾å¯ä»¥æ˜¯ç®€å•çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤æ‚çš„ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»ã€‚é“¾å¯ä»¥åŒ…æ‹¬æŸ¥è¯¢ã€è½¬æ¢ã€éªŒè¯ç­‰å¤šä¸ªæ­¥éª¤ã€‚</span><br><span class="line"></span><br><span class="line">2. **ä»£ç†ï¼ˆAgentsï¼‰**ï¼š</span><br><span class="line">   ä»£ç†æ˜¯ä¸€ç§å¯åŠ¨æ€å†³å®šå…¶è¡Œä¸ºå’Œè·¯å¾„çš„ç»“æ„ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªè¯­è¨€æ¨¡å‹æ¥ç†è§£ç”¨æˆ·è¾“å…¥ï¼Œå¹¶é€‰æ‹©æœ€åˆé€‚çš„è¡ŒåŠ¨ã€‚ä»£ç†é€šå¸¸åœ¨éœ€è¦å®æ—¶å†³ç­–çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸ç”¨æˆ·çš„å¯¹è¯ã€‚</span><br><span class="line"></span><br><span class="line">3. **å†…å­˜ï¼ˆMemoryï¼‰**ï¼š</span><br><span class="line">   LangChain æä¾›äº†å†…å­˜ç®¡ç†åŠŸèƒ½ï¼Œå…è®¸åº”ç”¨åœ¨ä¸åŒçš„ä¼šè¯ä¸­ä¿ç•™ç”¨æˆ·çš„ä¸Šä¸‹æ–‡å’Œå†å²ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—å¯¹è¯ç³»ç»Ÿèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ç”¨æˆ·çš„éœ€æ±‚å’Œåå¥½ã€‚</span><br><span class="line"></span><br><span class="line">4. **å·¥å…·ï¼ˆToolsï¼‰**ï¼š</span><br><span class="line">   LangChain æ”¯æŒå°†å¤–éƒ¨å·¥å…·å’Œ API é›†æˆåˆ°é“¾æˆ–ä»£ç†ä¸­ï¼Œä½¿å¾—è¯­è¨€æ¨¡å‹èƒ½å¤Ÿè¿›è¡Œé€»è¾‘æ¨ç†ã€æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨ web æœåŠ¡ç­‰ã€å¹¶å¤„ç†æ›´å¤æ‚çš„ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">5. **æ–‡æ¡£ï¼ˆDocumentsï¼‰**ï¼š</span><br><span class="line">   æ–‡æ¡£å¤„ç†æ˜¯ LangChain å¦ä¸€ä¸ªé‡è¦åŠŸèƒ½ã€‚åœ¨éœ€è¦å¤„ç†å¤§é‡æ–‡æœ¬ä¿¡æ¯çš„åœºæ™¯ä¸‹ï¼ŒLangChain æä¾›äº†æ–‡æ¡£æ£€ç´¢å’Œåˆ†æçš„èƒ½åŠ›ï¼Œä»¥æ”¯æŒä¿¡æ¯æå–ã€æ€»ç»“ç­‰ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä½¿ç”¨åœºæ™¯</span></span><br><span class="line"></span><br><span class="line">LangChain å¯ä»¥ç”¨äºå¤šç§åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</span><br><span class="line"></span><br><span class="line">- **èŠå¤©æœºå™¨äºº**ï¼šé€šè¿‡æ„å»ºé“¾å’Œä»£ç†ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºèƒ½å¤Ÿä¸ç”¨æˆ·è¿›è¡Œè‡ªç„¶äº¤äº’çš„å¯¹è¯ç³»ç»Ÿã€‚</span><br><span class="line">- **å†…å®¹ç”Ÿæˆ**ï¼šLangChain å¯ä»¥å¸®åŠ©è‡ªåŠ¨ç”Ÿæˆæ–‡ç« ã€æŠ¥å‘Šã€è¯—æ­Œç­‰ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¤šæ­¥ç”Ÿæˆçš„å¤æ‚å†…å®¹æ—¶ã€‚</span><br><span class="line">- **æ•°æ®åˆ†æ**ï¼šç»“åˆ LLM çš„æ¨ç†èƒ½åŠ›ï¼ŒLangChain èƒ½å¤Ÿæ”¯æŒå¤æ‚çš„æ•°æ®æŸ¥è¯¢å’Œåˆ†æä»»åŠ¡ã€‚</span><br><span class="line">- **æ•™è‚²å·¥å…·**ï¼šé€šè¿‡æ™ºèƒ½åŠ©æ‰‹ï¼ŒLangChain å¯ä»¥æ”¯æŒä¸ªæ€§åŒ–çš„å­¦ä¹ å’Œè¾…å¯¼ä½“éªŒã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### LangChain çš„ä¼˜åŠ¿</span></span><br><span class="line"></span><br><span class="line">- **æ¨¡å—åŒ–**ï¼šLangChain çš„æ¨¡å—åŒ–è®¾è®¡ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©å’Œç»„åˆä¸åŒçš„ç»„ä»¶ï¼Œçµæ´»æ€§é«˜ã€‚</span><br><span class="line">- **å¼€æº**ï¼šä½œä¸ºä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ŒLangChain æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨å’Œæ”¹è¿›ä»£ç ã€‚</span><br><span class="line">- **é›†æˆèƒ½åŠ›**ï¼šèƒ½æ–¹ä¾¿åœ°ä¸å…¶ä»–å„ç§å·¥å…·å’Œå¹³å°é›†æˆï¼Œæ‰©å±•äº†åº”ç”¨çš„åŠŸèƒ½å’Œé€‚ç”¨èŒƒå›´ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»“è®º</span></span><br><span class="line"></span><br><span class="line">LangChain æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…å……åˆ†åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ„å»ºå¤æ‚ä¸”æ™ºèƒ½çš„åº”ç”¨ç¨‹åºã€‚é€šè¿‡çµæ´»çš„é“¾ã€ä»£ç†ã€å†…å­˜å’Œå·¥å…·è®¾è®¡ï¼ŒLangChain ä½¿å¾—è‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨çš„å¼€å‘æ›´åŠ é«˜æ•ˆå’Œä¾¿æ·ã€‚æ— è®ºæ˜¯ç”¨äºå•†ä¸šåº”ç”¨ã€æ•™è‚²å·¥å…·ï¼Œè¿˜æ˜¯ä¸ªäººé¡¹ç›®ï¼ŒLangChain éƒ½ä¸ºå¼€å‘è€…æä¾›äº†ä¸°å¯Œçš„å¯èƒ½æ€§ã€‚</span><br><span class="line">Human: è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨20ä¸ªå­—ä»¥å†…[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">[33;1m[1;3mLangChain ç®€åŒ–äº†å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘ï¼Œæ”¯æŒçµæ´»çš„æ¨¡å—ç»„åˆä¸é›†æˆã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;input&#x27;</span>: <span class="string">&#x27;ä»€ä¹ˆæ˜¯LangChain?&#x27;</span>, <span class="string">&#x27;output&#x27;</span>: <span class="string">&#x27;LangChain ç®€åŒ–äº†å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘ï¼Œæ”¯æŒçµæ´»çš„æ¨¡å—ç»„åˆä¸é›†æˆã€‚&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå› ä¸ºSimpleSequentialChainå®šä¹‰çš„æ˜¯é¡ºåºé“¾ï¼Œæ‰€ä»¥åœ¨chainså‚æ•°ä¸­ä¼ é€’çš„åˆ—è¡¨è¦æŒ‰ç…§ é¡ºåºæ¥è¿›è¡Œä¼ å…¥ï¼Œå³LLMChain A è¦åœ¨LLMChain Bä¹‹å‰ã€‚åŒæ—¶ï¼Œåœ¨è°ƒç”¨æ—¶ï¼Œä¸å†ä½¿ç”¨LLMChain Aä¸­å®š ä¹‰çš„{knowledge} å‚æ•°ï¼Œä¹Ÿä¸æ˜¯LLMChainBä¸­å®šä¹‰çš„{description}å‚æ•°ï¼Œè€Œæ˜¯è¦ä½¿ç”¨ inputè¿›è¡Œå˜ é‡çš„ä¼ é€’ã€‚</p>
<p>ä¸¾ä¾‹2 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SimpleSequentialChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ä¸€ä¸ªç»™å‰§åå†™å¤§çº²çš„LLMChain  </span></span><br><span class="line">template1 = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ä¸ªå‰§ä½œå®¶ã€‚ç»™å®šå‰§æœ¬çš„æ ‡é¢˜ï¼Œä½ çš„å·¥ä½œå°±æ˜¯ä¸ºè¿™ä¸ªæ ‡é¢˜å†™ä¸€ä¸ªå¤§çº²ã€‚  </span></span><br><span class="line"><span class="string">Title: &#123;title&#125;  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">prompt_template1 = PromptTemplate(input_variables=[<span class="string">&quot;title&quot;</span>], template=template1)  </span><br><span class="line">synopsis_chain = LLMChain(llm=llm, prompt=prompt_template1)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰ç»™ä¸€ä¸ªå‰§æœ¬å¤§çº²å†™ä¸€ç¯‡è¯„è®ºçš„LLMChain  </span></span><br><span class="line">template2 = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ã€Šçº½çº¦æ—¶æŠ¥ã€‹çš„å‰§è¯„å®¶ã€‚æœ‰äº†å‰§æœ¬çš„å¤§çº²ï¼Œä½ çš„å·¥ä½œå°±æ˜¯ä¸ºå‰§æœ¬å†™ä¸€ç¯‡è¯„è®º  </span></span><br><span class="line"><span class="string">å‰§æƒ…å¤§çº²:  </span></span><br><span class="line"><span class="string">&#123;synopsis&#125;  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">prompt_template2 = PromptTemplate(input_variables=[<span class="string">&quot;synopsis&quot;</span>], template=template2)  </span><br><span class="line">review_chain = LLMChain(llm=llm, prompt=prompt_template2)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„é“¾æŒ‰é¡ºåºè¿è¡Œè¿™ä¸¤æ¡é“¾  </span></span><br><span class="line"><span class="comment">#(verbose=True:æ‰“å°é“¾çš„æ‰§è¡Œè¿‡ç¨‹)  </span></span><br><span class="line">overall_chain = SimpleSequentialChain(  </span><br><span class="line">    chains=[synopsis_chain, review_chain],  </span><br><span class="line">    verbose=<span class="literal">True</span>  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 6.è°ƒç”¨å®Œæ•´é“¾é¡ºåºæ‰§è¡Œè¿™ä¸¤ä¸ªé“¾  </span></span><br><span class="line">review = overall_chain.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;æ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 7.æ‰“å°ç»“æœ  </span></span><br><span class="line"><span class="built_in">print</span>(review)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SimpleSequentialChain chain...[0m</span><br><span class="line">[36;1m[1;3mæ ‡é¢˜: æ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§</span><br><span class="line"></span><br><span class="line">å¤§çº²:</span><br><span class="line"></span><br><span class="line">**ç¬¬ä¸€å¹•ï¼šåˆè§ä¸å†²çª**</span><br><span class="line">- åœºæ™¯è®¾å®šåœ¨ä¸€ä¸ªé£æ™¯å¦‚ç”»çš„æµ·æ»©å°é•‡ï¼Œé»„æ˜æ—¶åˆ†ï¼Œé˜³å…‰æ´’åœ¨æ³¢æµªä¸Šï¼Œè¥é€ å‡ºå®é™çš„æ°›å›´ã€‚</span><br><span class="line">- ä¸»è¦è§’è‰²ä»‹ç»ï¼šè‰¾ç±³è‰ï¼ˆå¹´è½»çš„è‰ºæœ¯å®¶ï¼‰ï¼Œå¥¹æ­£åœ¨æµ·æ»©ä¸Šå¯»æ±‚çµæ„Ÿï¼›æ°å…‹ï¼ˆæ—©å¹´å›ä¹¡çš„æµ·å†›å†›äººï¼‰ï¼Œå†…å¿ƒæ‰¿å—ç€æˆ˜äº‰çš„åˆ›ä¼¤ï¼›è€æ¸”å¤«å“ˆç½—å¾·ï¼ˆé•‡ä¸Šçš„æ™ºè€…ï¼Œä¸ºäººå’Œè”¼å´æ»¡è…¹è¾›é…¸ï¼‰ã€‚</span><br><span class="line">- è‰¾ç±³è‰å¶ç„¶é‡è§æ°å…‹ï¼Œä¸¤äººå› å¯¹æµ·æ»©çš„ä¸åŒçœ‹æ³•è€Œäº§ç”Ÿäº‰æ‰§ã€‚æ°å…‹è®¤ä¸ºæˆ˜äº‰æ˜¯äººç±»æ— æ³•é€ƒé¿çš„æ‚²å‰§ï¼Œè€Œè‰¾ç±³è‰åˆ™è®¤ä¸ºè‰ºæœ¯èƒ½æ²»æ„ˆåˆ›ä¼¤ã€‚</span><br><span class="line"></span><br><span class="line">**ç¬¬äºŒå¹•ï¼šå‹è°Šä¸ç§˜å¯†**</span><br><span class="line">- åœ¨ä¸€æ¬¡æµ·æ»©æ™šä¼šä¸­ï¼Œè‰¾ç±³è‰å’Œæ°å…‹é€æ¸å’Œè§£å¹¶æˆä¸ºæœ‹å‹ã€‚åœ¨å“ˆç½—å¾·çš„å¼•å¯¼ä¸‹ï¼Œä»–ä»¬åˆ†äº«å„è‡ªçš„ç»å†ï¼Œå»ºç«‹èµ·æ·±åšçš„æƒ…æ„Ÿçº½å¸¦ã€‚</span><br><span class="line">- è‰¾ç±³è‰å¯¹æ°å…‹çš„è¿‡å»äº§ç”Ÿäº†æµ“åšçš„å…´è¶£å¹¶å°è¯•ç”¨ç”»ç¬”æ•æ‰ä»–çš„æ•…äº‹ï¼Œç„¶è€Œï¼Œæ°å…‹å¯¹æˆ˜äº‰çš„å›å¿†ä»ç„¶å……æ»¡ç—›è‹¦ï¼Œä»–è¯•å›¾éšè—è‡ªå·±å†…å¿ƒçš„é»‘æš—ã€‚</span><br><span class="line">- é•‡ä¸Šå‘ç”Ÿäº†ä¸€ä»¶ç¥ç§˜çš„äº‹æƒ…ï¼šä¸€ä½å¹´è½»å¥³å­©åœ¨æµ·æ»©å¤±è¸ªï¼Œé•‡å­é™·å…¥ææ…Œï¼Œæ°å…‹çš„å†…å¿ƒå†²çªåŠ å‰§ã€‚</span><br><span class="line"></span><br><span class="line">**ç¬¬ä¸‰å¹•ï¼šçœŸç›¸æ­ç¤ºä¸é€‰æ‹©**</span><br><span class="line">- è‰¾ç±³è‰å’Œæ°å…‹å†³å®šå±•å¼€è°ƒæŸ¥ï¼Œè¯•å›¾æ‰¾å‡ºå¥³å­©å¤±è¸ªçš„çœŸç›¸ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»–ä»¬å‘ç°äº†å°é•‡éšè—çš„ç§˜å¯†ï¼Œæ­ç¤ºäº†äººä»¬å¯¹äºè¿‡å»çš„é€ƒé¿ä»¥åŠå¯¹ç°å®çš„æ— åŠ›ã€‚</span><br><span class="line">- åœ¨ä¸€æ¬¡æ·±å¤œæ¢é™©ä¸­ï¼Œè‰¾ç±³è‰åœ¨æµ·æ»©å‘ç°äº†æ—§æ—¥æˆ˜äº‰ç•™ä¸‹çš„é—ç‰©ï¼Œå‹¾èµ·äº†æ°å…‹ç—›è‹¦çš„è®°å¿†ï¼Œæœ€ç»ˆä»–åœ¨æµ·æ»©ä¸Šçˆ†å‘å‡ºæƒ…ç»ªï¼Œæ­ç¤ºäº†è‡ªå·±åœ¨æˆ˜äº‰ä¸­äº²å†çš„æ‚²æƒ¨äº‹ä»¶ã€‚</span><br><span class="line">- äºŒäººé¢å¯¹å„è‡ªçš„ä¼¤ç—›ï¼Œæ°å…‹å†³å®šå‘é•‡ä¸Šäººä»¬è®²è¿°çœŸç›¸ï¼Œè€Œè‰¾ç±³è‰åˆ™å†³å®šç”¨è‰ºæœ¯è®°å½•ä¸‹ä»–ä»¬çš„æ•…äº‹ã€‚</span><br><span class="line"></span><br><span class="line">**ç¬¬å››å¹•ï¼šæ‚²å‰§ä¸æ•‘èµ**</span><br><span class="line">- å½“æ°å…‹è¡¨ç™½è‡ªå·±çš„ç»å†åï¼Œé•‡ä¸Šçš„äººä»¬è¢«éœ‡æ’¼ï¼Œéƒ¨åˆ†äººå¼€å§‹æ„è¯†åˆ°ç›´é¢è¿‡å»çš„é‡è¦æ€§ã€‚</span><br><span class="line">- ç„¶è€Œï¼Œå°±åœ¨å¤§å®¶é€æ¸é€‚åº”è¿™ä¸ªçœŸç›¸æ—¶ï¼Œæ–°çš„æ‚²å‰§å‘ç”Ÿï¼šæ°å…‹å› æ— æ³•æ‰¿å—å†…å¿ƒçš„é‡è´Ÿè€Œé€‰æ‹©æç«¯æ–¹å¼ç»“æŸè‡ªå·±çš„ç”Ÿå‘½ã€‚è‰¾ç±³è‰åœ¨æ­¤åˆ»æ„Ÿå—åˆ°æ·±æ·±çš„ç»æœ›ä¸æ‚”æ¨ã€‚</span><br><span class="line">- æœ€ç»ˆï¼Œåœ¨æ°å…‹çš„è‘¬ç¤¼ä¸Šï¼Œè‰¾ç±³è‰å‘è¡¨æ¼”è®²ï¼Œå‘å°é•‡çš„å±…æ°‘å‘¼åçæƒœç”Ÿå‘½ä¸å½¼æ­¤ï¼Œå¥¹å†³å®šä»¥ç”»ä½œçºªå¿µæ°å…‹ï¼ŒæŠŠä»–çš„æ•…äº‹ä¼ é€’ä¸‹å»ã€‚</span><br><span class="line"></span><br><span class="line">**ç»“å°¾ï¼šå¸Œæœ›ä¸é‡ç”Ÿ**</span><br><span class="line">- ç”»å±•ä¸Šçš„è‰¾ç±³è‰å°†æ°å…‹çš„æ•…äº‹ä»¥è‰ºæœ¯çš„å½¢å¼å±•ç°å‡ºæ¥ï¼Œå¸å¼•äº†è¶Šæ¥è¶Šå¤šäººçš„å…³æ³¨ã€‚</span><br><span class="line">- æµ·æ»©å¤•é˜³å†æ¬¡è½ä¸‹ï¼Œè‰¾ç±³è‰ç«™åœ¨æµ·æ»©ä¸Šï¼Œæ‰‹ä¸­æ¡ç€ç”»ç¬”ï¼Œå¥¹æ„è¯†åˆ°ï¼Œè™½ç„¶ç”Ÿå‘½å……æ»¡æ‚²å‰§ï¼Œä½†æ¯ä¸ªäººçš„æ•…äº‹éƒ½æœ‰è¢«å¬è§çš„ä»·å€¼ï¼ŒåŒæ—¶ä¹Ÿæ¸´æœ›ç€å¸Œæœ›ä¸æ•‘èµã€‚[0m</span><br><span class="line">[33;1m[1;3m**å‰§è¯„ï¼šã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹â€”â€”åœ¨è‰ºæœ¯ä¸ç—›è‹¦ä¹‹é—´çš„æŠ‰æ‹©**</span><br><span class="line"></span><br><span class="line">ã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨å……æ»¡æƒ…æ„Ÿæ·±åº¦çš„æˆå‰§ï¼Œé€šè¿‡ç²¾è‡´çš„è§’è‰²å¡‘é€ ä¸å¼•äººå…¥èƒœçš„å‰§æƒ…ï¼Œä¸ºè§‚ä¼—å±•ç°äº†äººæ€§ä¸­çš„è„†å¼±ä¸åšéŸ§ã€‚å¯¼æ¼”ä»¥æµ·æ»©å°é•‡çš„å®é™ä¸ºèƒŒæ™¯ï¼Œé…åˆé»„æ˜çš„æ¸©æš–è‰²è°ƒï¼Œå½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ï¼Œæ­ç¤ºäº†è§’è‰²å†…å¿ƒçš„å†²çªä¸æŒ£æ‰ã€‚</span><br><span class="line"></span><br><span class="line">å‰§æƒ…çš„ç¬¬ä¸€å¹•ï¼Œåˆè§ä¸å†²çªï¼Œå±•ç¤ºäº†è‰¾ç±³è‰ä¸æ°å…‹ä¹‹é—´çš„å¯¹ç«‹ã€‚åœ¨è¿™ä¸ªç‰‡æ®µä¸­ï¼Œè‰¾ç±³è‰æš—ç¤ºäº†è‰ºæœ¯çš„æ²»ç–—åŠ›é‡ï¼Œè€Œæ°å…‹çš„åšå®šæ€åº¦åˆ™ä¼ è¾¾å‡ºæˆ˜äº‰æ— æ³•è¢«é—å¿˜çš„æ·±åˆ»ç—›è‹¦ã€‚è¿™ç§å¯¹æ¯”ä¸ä»…è®¾ç½®äº†ä¸¤äººä¹‹é—´çš„ä¸»è¦çŸ›ç›¾ï¼Œä¹Ÿè®©è§‚ä¼—æ„Ÿå—åˆ°äººç±»æƒ…æ„Ÿçš„å¤æ‚æ€§ã€‚æ°å…‹çš„å†…å¿ƒåˆ›ä¼¤ä¸è‰¾ç±³è‰çš„ç†æƒ³ä¸»ä¹‰å½¢æˆäº†å°–é”çš„å†²çªï¼Œä¸ºåç»­äº’åŠ¨åŸ‹ä¸‹äº†ä¸°å¯Œçš„æƒ…æ„ŸåŸºç¡€ã€‚</span><br><span class="line"></span><br><span class="line">éšç€å‰§æƒ…çš„æ·±å…¥ï¼Œå‹è°Šä¸ç§˜å¯†çš„ç¬¬äºŒå¹•æç»˜äº†è‰¾ç±³è‰ä¸æ°å…‹çš„å…³ç³»æ¼”å˜ã€‚ä¸¤äººé€æ­¥æ‰“ç ´äº†å¿ƒç†ä¸Šçš„å£å’ï¼Œæˆä¸ºå½¼æ­¤å€¾è¯‰çš„å¯¹è±¡ã€‚æ­¤æ—¶ï¼Œè€æ¸”å¤«å“ˆç½—å¾·çš„è§’è‰²æ˜¾å¾—æ„ˆå‘é‡è¦ï¼Œä»–ä¸ä»…æ˜¯æ™ºæ…§çš„è±¡å¾ï¼Œæ›´æ˜¯è¿æ¥è¿‡å»ä¸ç°åœ¨çš„æ¡¥æ¢ã€‚ä»–ä»¬å…±äº«æ•…äº‹çš„æ—¶åˆ»ï¼Œå¦‚åŒæ¸©æš–çš„æ½®æ°´ï¼Œæ¸æ¸å†²æ·¡äº†å„è‡ªçš„å­¤ç‹¬ä¸ä¼¤ç—›ã€‚ç„¶è€Œï¼Œæ•…äº‹çš„è½¬æŠ˜ç‚¹åœ¨äºå¥³å­©çš„å¤±è¸ªï¼Œè¿™ä¸€çªå‘äº‹ä»¶å†æ¬¡å°†æ°å…‹æ¨å…¥æƒ…æ„Ÿçš„æ·±æ¸Šï¼Œæ­ç¤ºäº†é•‡ä¸Šäººä»¬é¢å¯¹çœŸå®çš„é€ƒé¿ä¸æ— åŠ›æ„Ÿã€‚</span><br><span class="line"></span><br><span class="line">å‰§ä½œçš„ä¸­å¿ƒåœ¨äºçœŸç›¸æ­ç¤ºä¸é€‰æ‹©çš„ç¬¬ä¸‰å¹•ï¼Œè‰¾ç±³è‰å’Œæ°å…‹è°ƒæŸ¥å¥³å­©å¤±è¸ªçš„çœŸç›¸ï¼Œè¿™ä¸ä»…æ˜¯å¯¹å¤–ç•Œäº‹ä»¶çš„ä¸€æ¬¡æ¢ç´¢ï¼Œæ›´æ˜¯å¯¹å†…å¿ƒç§˜å¯†çš„å‘¼å”¤ã€‚æ°å…‹çš„æƒ…æ„Ÿçˆ†å‘ï¼Œæ·±æƒ…åˆç—›è‹¦ï¼Œå±•ç¤ºäº†ä»–å†…å¿ƒæ·±å¤„çš„é»‘æš—ä¸çŸ›ç›¾ã€‚è€Œè‰¾ç±³è‰çš„è§’è‰²åœ¨æ­¤åˆ»æ˜¾å¾—æ— æ¯”é‡è¦ï¼Œå¥¹é€‰æ‹©ç”¨ç”»ç¬”è®°å½•ä¸‹è¿™ä¸€åˆ‡ï¼Œä¸ä»…æ˜¯å¯¹æ°å…‹çš„æ•‘èµï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±å†…å¿ƒçš„è§£æ”¾ã€‚</span><br><span class="line"></span><br><span class="line">å‰§ä¸­çš„æ‚²å‰§å¹¶éä»…é™äºæ°å…‹çš„é€‰æ‹©ï¼Œè€Œæ˜¯å¯¹äººç±»å…±åŒç—›è‹¦çš„æ·±åˆ»åæ€ã€‚æ°å…‹çš„è‡ªæ€æ˜¯å¯¹å†…å¿ƒå†²çªçš„æ— å£°æŠ—è®®ï¼Œä»¤è§‚ä¼—å¯¹ç”Ÿå‘½çš„è„†å¼±ä¸çè´µæ„Ÿæ…¨ä¸‡åƒã€‚è€Œè‰¾ç±³è‰åˆ™æˆä¸ºæŠ˜å°„å¸Œæœ›çš„å…‰èŠ’ï¼Œå¥¹ä»¥ç”»ä½œä¸ºæ°å…‹èµ‹äºˆäº†ç”Ÿå‘½çš„æ„ä¹‰ï¼Œä½¿æ‚²å‰§å˜æˆäº†ä¸€æ¬¡å›¢ç»“ä¸å…±é¸£çš„å‘¼å”¤ã€‚</span><br><span class="line"></span><br><span class="line">ç»“å°¾çš„ç”»å±•æ˜¯å¯¹æ•´ä¸ªæ•…äº‹çš„å‡åï¼Œè‰¾ç±³è‰ç”¨è‰ºæœ¯å†²ç ´äº†å“€ç—›çš„æ·é”ï¼Œå°†æ°å…‹çš„æ•…äº‹ä¼ é€’ç»™äº†æ›´å¤šçš„äººã€‚æµ·æ»©ä¸Šçš„å¤•é˜³ï¼Œä¸ä»…è±¡å¾ç€ç”Ÿå‘½çš„è½®å›ï¼Œæ›´ä¼ é€’å‡ºä¸€ç§å¸Œæœ›çš„æ°”æ¯ã€‚å¥¹åœ¨ç»æœ›ä¸å¸Œæœ›ä¹‹é—´å¯»æ‰¾åˆ°äº†è‡ªå·±çš„ä½ç½®ï¼Œå‘è§‚ä¼—å±•ç¤ºäº†è‰ºæœ¯å¦‚ä½•è®©ç—›è‹¦æˆä¸ºä¸€ç§åŠ›é‡ã€‚</span><br><span class="line"></span><br><span class="line">ã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨æ·±æƒ…å¹¶å¯Œæœ‰æ€è€ƒçš„ä½œå“ï¼ŒæŒ‘æˆ˜ç€è§‚ä¼—å¯¹ç”Ÿå‘½æ„ä¹‰çš„ç†è§£ã€‚å®ƒä¸ä»…æ¢è®¨äº†æˆ˜äº‰å¸¦æ¥çš„åˆ›ä¼¤ï¼Œä¹Ÿé€è§†äº†ç”Ÿæ´»ä¸­çš„æ‚²å‰§ä¸æ•‘èµã€‚æ˜¯è‰ºæœ¯è®©äººä»¬é‡æ–°å®¡è§†è¿‡å»ï¼Œç›´é¢ç—›è‹¦ï¼Œå¹¶ä»ä¸­å¯»æ‰¾å¸Œæœ›ã€‚æ¯ä¸€ä¸ªæ•…äº‹éƒ½å€¼å¾—è¢«è†å¬ï¼Œæ¯ä¸€ä¸ªç”Ÿå‘½éƒ½æ¸´æœ›å¾—åˆ°çè§†ã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;input&#x27;</span>: <span class="string">&#x27;æ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§&#x27;</span>, <span class="string">&#x27;output&#x27;</span>: <span class="string">&#x27;**å‰§è¯„ï¼šã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹â€”â€”åœ¨è‰ºæœ¯ä¸ç—›è‹¦ä¹‹é—´çš„æŠ‰æ‹©**\n\nã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨å……æ»¡æƒ…æ„Ÿæ·±åº¦çš„æˆå‰§ï¼Œé€šè¿‡ç²¾è‡´çš„è§’è‰²å¡‘é€ ä¸å¼•äººå…¥èƒœçš„å‰§æƒ…ï¼Œä¸ºè§‚ä¼—å±•ç°äº†äººæ€§ä¸­çš„è„†å¼±ä¸åšéŸ§ã€‚å¯¼æ¼”ä»¥æµ·æ»©å°é•‡çš„å®é™ä¸ºèƒŒæ™¯ï¼Œé…åˆé»„æ˜çš„æ¸©æš–è‰²è°ƒï¼Œå½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ï¼Œæ­ç¤ºäº†è§’è‰²å†…å¿ƒçš„å†²çªä¸æŒ£æ‰ã€‚\n\nå‰§æƒ…çš„ç¬¬ä¸€å¹•ï¼Œåˆè§ä¸å†²çªï¼Œå±•ç¤ºäº†è‰¾ç±³è‰ä¸æ°å…‹ä¹‹é—´çš„å¯¹ç«‹ã€‚åœ¨è¿™ä¸ªç‰‡æ®µä¸­ï¼Œè‰¾ç±³è‰æš—ç¤ºäº†è‰ºæœ¯çš„æ²»ç–—åŠ›é‡ï¼Œè€Œæ°å…‹çš„åšå®šæ€åº¦åˆ™ä¼ è¾¾å‡ºæˆ˜äº‰æ— æ³•è¢«é—å¿˜çš„æ·±åˆ»ç—›è‹¦ã€‚è¿™ç§å¯¹æ¯”ä¸ä»…è®¾ç½®äº†ä¸¤äººä¹‹é—´çš„ä¸»è¦çŸ›ç›¾ï¼Œä¹Ÿè®©è§‚ä¼—æ„Ÿå—åˆ°äººç±»æƒ…æ„Ÿçš„å¤æ‚æ€§ã€‚æ°å…‹çš„å†…å¿ƒåˆ›ä¼¤ä¸è‰¾ç±³è‰çš„ç†æƒ³ä¸»ä¹‰å½¢æˆäº†å°–é”çš„å†²çªï¼Œä¸ºåç»­äº’åŠ¨åŸ‹ä¸‹äº†ä¸°å¯Œçš„æƒ…æ„ŸåŸºç¡€ã€‚\n\néšç€å‰§æƒ…çš„æ·±å…¥ï¼Œå‹è°Šä¸ç§˜å¯†çš„ç¬¬äºŒå¹•æç»˜äº†è‰¾ç±³è‰ä¸æ°å…‹çš„å…³ç³»æ¼”å˜ã€‚ä¸¤äººé€æ­¥æ‰“ç ´äº†å¿ƒç†ä¸Šçš„å£å’ï¼Œæˆä¸ºå½¼æ­¤å€¾è¯‰çš„å¯¹è±¡ã€‚æ­¤æ—¶ï¼Œè€æ¸”å¤«å“ˆç½—å¾·çš„è§’è‰²æ˜¾å¾—æ„ˆå‘é‡è¦ï¼Œä»–ä¸ä»…æ˜¯æ™ºæ…§çš„è±¡å¾ï¼Œæ›´æ˜¯è¿æ¥è¿‡å»ä¸ç°åœ¨çš„æ¡¥æ¢ã€‚ä»–ä»¬å…±äº«æ•…äº‹çš„æ—¶åˆ»ï¼Œå¦‚åŒæ¸©æš–çš„æ½®æ°´ï¼Œæ¸æ¸å†²æ·¡äº†å„è‡ªçš„å­¤ç‹¬ä¸ä¼¤ç—›ã€‚ç„¶è€Œï¼Œæ•…äº‹çš„è½¬æŠ˜ç‚¹åœ¨äºå¥³å­©çš„å¤±è¸ªï¼Œè¿™ä¸€çªå‘äº‹ä»¶å†æ¬¡å°†æ°å…‹æ¨å…¥æƒ…æ„Ÿçš„æ·±æ¸Šï¼Œæ­ç¤ºäº†é•‡ä¸Šäººä»¬é¢å¯¹çœŸå®çš„é€ƒé¿ä¸æ— åŠ›æ„Ÿã€‚\n\nå‰§ä½œçš„ä¸­å¿ƒåœ¨äºçœŸç›¸æ­ç¤ºä¸é€‰æ‹©çš„ç¬¬ä¸‰å¹•ï¼Œè‰¾ç±³è‰å’Œæ°å…‹è°ƒæŸ¥å¥³å­©å¤±è¸ªçš„çœŸç›¸ï¼Œè¿™ä¸ä»…æ˜¯å¯¹å¤–ç•Œäº‹ä»¶çš„ä¸€æ¬¡æ¢ç´¢ï¼Œæ›´æ˜¯å¯¹å†…å¿ƒç§˜å¯†çš„å‘¼å”¤ã€‚æ°å…‹çš„æƒ…æ„Ÿçˆ†å‘ï¼Œæ·±æƒ…åˆç—›è‹¦ï¼Œå±•ç¤ºäº†ä»–å†…å¿ƒæ·±å¤„çš„é»‘æš—ä¸çŸ›ç›¾ã€‚è€Œè‰¾ç±³è‰çš„è§’è‰²åœ¨æ­¤åˆ»æ˜¾å¾—æ— æ¯”é‡è¦ï¼Œå¥¹é€‰æ‹©ç”¨ç”»ç¬”è®°å½•ä¸‹è¿™ä¸€åˆ‡ï¼Œä¸ä»…æ˜¯å¯¹æ°å…‹çš„æ•‘èµï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±å†…å¿ƒçš„è§£æ”¾ã€‚\n\nå‰§ä¸­çš„æ‚²å‰§å¹¶éä»…é™äºæ°å…‹çš„é€‰æ‹©ï¼Œè€Œæ˜¯å¯¹äººç±»å…±åŒç—›è‹¦çš„æ·±åˆ»åæ€ã€‚æ°å…‹çš„è‡ªæ€æ˜¯å¯¹å†…å¿ƒå†²çªçš„æ— å£°æŠ—è®®ï¼Œä»¤è§‚ä¼—å¯¹ç”Ÿå‘½çš„è„†å¼±ä¸çè´µæ„Ÿæ…¨ä¸‡åƒã€‚è€Œè‰¾ç±³è‰åˆ™æˆä¸ºæŠ˜å°„å¸Œæœ›çš„å…‰èŠ’ï¼Œå¥¹ä»¥ç”»ä½œä¸ºæ°å…‹èµ‹äºˆäº†ç”Ÿå‘½çš„æ„ä¹‰ï¼Œä½¿æ‚²å‰§å˜æˆäº†ä¸€æ¬¡å›¢ç»“ä¸å…±é¸£çš„å‘¼å”¤ã€‚\n\nç»“å°¾çš„ç”»å±•æ˜¯å¯¹æ•´ä¸ªæ•…äº‹çš„å‡åï¼Œè‰¾ç±³è‰ç”¨è‰ºæœ¯å†²ç ´äº†å“€ç—›çš„æ·é”ï¼Œå°†æ°å…‹çš„æ•…äº‹ä¼ é€’ç»™äº†æ›´å¤šçš„äººã€‚æµ·æ»©ä¸Šçš„å¤•é˜³ï¼Œä¸ä»…è±¡å¾ç€ç”Ÿå‘½çš„è½®å›ï¼Œæ›´ä¼ é€’å‡ºä¸€ç§å¸Œæœ›çš„æ°”æ¯ã€‚å¥¹åœ¨ç»æœ›ä¸å¸Œæœ›ä¹‹é—´å¯»æ‰¾åˆ°äº†è‡ªå·±çš„ä½ç½®ï¼Œå‘è§‚ä¼—å±•ç¤ºäº†è‰ºæœ¯å¦‚ä½•è®©ç—›è‹¦æˆä¸ºä¸€ç§åŠ›é‡ã€‚\n\nã€Šæ—¥è½æµ·æ»©ä¸Šçš„æ‚²å‰§ã€‹æ˜¯ä¸€éƒ¨æ·±æƒ…å¹¶å¯Œæœ‰æ€è€ƒçš„ä½œå“ï¼ŒæŒ‘æˆ˜ç€è§‚ä¼—å¯¹ç”Ÿå‘½æ„ä¹‰çš„ç†è§£ã€‚å®ƒä¸ä»…æ¢è®¨äº†æˆ˜äº‰å¸¦æ¥çš„åˆ›ä¼¤ï¼Œä¹Ÿé€è§†äº†ç”Ÿæ´»ä¸­çš„æ‚²å‰§ä¸æ•‘èµã€‚æ˜¯è‰ºæœ¯è®©äººä»¬é‡æ–°å®¡è§†è¿‡å»ï¼Œç›´é¢ç—›è‹¦ï¼Œå¹¶ä»ä¸­å¯»æ‰¾å¸Œæœ›ã€‚æ¯ä¸€ä¸ªæ•…äº‹éƒ½å€¼å¾—è¢«è†å¬ï¼Œæ¯ä¸€ä¸ªç”Ÿå‘½éƒ½æ¸´æœ›å¾—åˆ°çè§†ã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="é¡ºåºé“¾ä¹‹-sequentialchain">é¡ºåºé“¾ä¹‹ SequentialChain</h2>
<h3 id="è¯´æ˜-1">è¯´æ˜</h3>
<p>SequentialChainï¼šæ›´é€šç”¨çš„é¡ºåºé“¾ï¼Œå…·ä½“æ¥è¯´ï¼š - å¤šå˜é‡æ”¯æŒï¼šå…è®¸ä¸åŒå­é“¾æœ‰ç‹¬ç«‹çš„è¾“å…¥/è¾“å‡ºå˜é‡ã€‚ - çµæ´»æ˜ å°„ï¼šéœ€ æ˜¾å¼å®šä¹‰å˜é‡å¦‚ä½•ä»ä¸€ä¸ªé“¾ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªé“¾ã€‚å³ç²¾å‡†åœ°å‘½åè¾“å…¥å…³é”®å­—å’Œè¾“å‡ºå…³é”® å­—ï¼Œæ¥æ˜ç¡®é“¾ä¹‹é—´çš„å…³ç³»ã€‚ - å¤æ‚æµç¨‹æ§åˆ¶ï¼šæ”¯æŒåˆ†æ”¯ã€æ¡ä»¶é€»è¾‘ï¼ˆåˆ†åˆ«é€šè¿‡<strong>input_variables</strong>å’Œ<strong>output_variables</strong>è¾“å‡ºï¼‰ã€‚</p>
<p><img src="file-20251013094055511.png" /></p>
<h3 id="ä½¿ç”¨ä¸¾ä¾‹-2">ä½¿ç”¨ä¸¾ä¾‹</h3>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SequentialChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">schainA_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ å…ˆå°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼š&#123;knowledge&#125;ï¼Œå¹¶ä¸”&#123;action&#125;&quot;</span>)  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">schainA_chains = LLMChain(llm=llm,  </span><br><span class="line">                          prompt=schainA_template,  </span><br><span class="line">                          verbose=<span class="literal">True</span>,  </span><br><span class="line">                          output_key=<span class="string">&quot;schainA_chains_key&quot;</span>  </span><br><span class="line">                          )  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># schainA_chains.invoke(&#123;  </span></span><br><span class="line"><span class="comment">#     &quot;knowledge&quot;: &quot;ä¸­å›½çš„ç¯®çƒæ€ä¹ˆæ ·ï¼Ÿ&quot;,  </span></span><br><span class="line"><span class="comment">#     &quot;action&quot;: &quot;ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­&quot;  </span></span><br><span class="line"><span class="comment"># &#125;  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line">schainB_template = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼š&#123;schainA_chains_key&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨100ä¸ªå­—ä»¥å†…&quot;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">schainB_chains = LLMChain(llm=llm,  </span><br><span class="line">                         prompt=schainB_template,  </span><br><span class="line">                         verbose=<span class="literal">True</span>,  </span><br><span class="line">                         output_key=<span class="string">&#x27;schainB_chains_key&#x27;</span>  </span><br><span class="line">                        )  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ä¸€å®šè¦å£°æ˜å‡ºä¸¤ä¸ªå˜é‡ï¼šinput_variablesã€output_variables  </span></span><br><span class="line">Seq_chain = SequentialChain(  </span><br><span class="line">                            chains=[schainA_chains, schainB_chains],  </span><br><span class="line">                            input_variables=[<span class="string">&quot;knowledge&quot;</span>, <span class="string">&quot;action&quot;</span>],  </span><br><span class="line">                            output_variables=[<span class="string">&quot;schainA_chains_key&quot;</span>,<span class="string">&quot;schainB_chains_key&quot;</span>],  </span><br><span class="line">                            verbose=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line">response = Seq_chain.invoke(&#123;  </span><br><span class="line">                       <span class="string">&quot;knowledge&quot;</span>:<span class="string">&quot;ä¸­å›½è¶³çƒä¸ºä»€ä¹ˆè¸¢å¾—çƒ‚&quot;</span>,  </span><br><span class="line">                       <span class="string">&quot;action&quot;</span>:<span class="string">&quot;ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­&quot;</span>  </span><br><span class="line">                    &#125;  </span><br><span class="line">                )  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SequentialChain chain...[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ æ˜¯ä¸€ä½ç²¾é€šå„é¢†åŸŸçŸ¥è¯†çš„çŸ¥åæ•™æˆ</span><br><span class="line">Human: è¯·ä½ å…ˆå°½å¯èƒ½è¯¦ç»†çš„è§£é‡Šä¸€ä¸‹ï¼šä¸­å›½è¶³çƒä¸ºä»€ä¹ˆè¸¢å¾—çƒ‚ï¼Œå¹¶ä¸”ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mSystem: ä½ éå¸¸å–„äºæå–æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶åšå‡ºç®€çŸ­çš„æ€»ç»“</span><br><span class="line">Human: è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªæé—®å®Œæ•´çš„è§£é‡Šè¯´æ˜å†…å®¹ï¼šä¸­å›½è¶³çƒä¹‹æ‰€ä»¥åœ¨å›½é™…èˆå°ä¸Šè¡¨ç°ä¸ä½³ï¼ŒåŸå› å¤æ‚ä¸”å¤šæ–¹é¢ï¼Œä¸»è¦å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œåˆ†æï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">### 1. **ä½“åˆ¶ä¸ç®¡ç†é—®é¢˜**</span></span><br><span class="line">   - **è¡Œæ”¿å¹²é¢„**ï¼šä¸­å›½è¶³çƒçš„ç®¡ç†ä½“åˆ¶å­˜åœ¨è¾ƒå¤šè¡Œæ”¿å¹²é¢„ï¼Œå¯¼è‡´ä¿±ä¹éƒ¨å’Œçƒé˜Ÿçš„å‘å±•å—åˆ°é™åˆ¶ã€‚è¶³çƒåä¼šçš„å†³ç­–å¾€å¾€å—åˆ°æ”¿åºœéƒ¨é—¨çš„å½±å“ï¼Œç¼ºä¹ç‹¬ç«‹æ€§å’Œä¸“ä¸šæ€§ã€‚</span><br><span class="line">   - **è…è´¥ç°è±¡**ï¼šå†å²ä¸Šï¼Œä¸­å›½è¶³çƒæ›¾æš´éœ²å‡ºä¸å°‘è…è´¥é—®é¢˜ï¼ŒåŒ…æ‹¬å‡çƒå’Œè´¿èµ‚ï¼ŒæŸå®³äº†è¿åŠ¨å‘˜çš„èŒä¸šé“å¾·å’Œè§‚ä¼—çš„ä¿¡ä»»ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 2. **é’è®­ä½“ç³»ä¸å®Œå–„**</span></span><br><span class="line">   - **åŸºç¡€è®¾æ–½ä¸è¶³**ï¼šå°½ç®¡è¿‘å¹´æ¥ä¸­å›½åœ¨è¶³çƒåœºåœ°å»ºè®¾ä¸ŠæŠ•å…¥è¾ƒå¤šï¼Œä½†é’è®­ä½“ç³»å’ŒåŸºç¡€è®¾æ–½çš„å»ºè®¾ä»ç„¶æ»åäºå…¶ä»–è¶³çƒå¼ºå›½ã€‚</span><br><span class="line">   - **é’å°‘å¹´åŸ¹å…»**ï¼šåœ¨é’å°‘å¹´è¶³çƒé¢†åŸŸï¼Œç¼ºä¹ç³»ç»Ÿçš„åŸ¹è®­å’Œé€‰æ‹”æœºåˆ¶ï¼Œä¼˜ç§€çš„é’å°‘å¹´çƒå‘˜éš¾ä»¥è„±é¢–è€Œå‡ºå¹¶å¾—åˆ°è‰¯å¥½çš„åŸ¹å…»ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 3. **ä¸“ä¸šåŒ–æ°´å¹³æ¬ ç¼º**</span></span><br><span class="line">   - **æ•™ç»ƒæ°´å¹³**ï¼šè™½ç„¶ä¸€äº›å¤–ç±æ•™ç»ƒåŠ å…¥äº†ä¸­è¶…è”èµ›ï¼Œä½†æ•´ä½“è€Œè¨€ï¼Œä¸­å›½æœ¬åœŸæ•™ç»ƒçš„ä¸“ä¸šæ°´å¹³å’Œæˆ˜æœ¯ç´ å…»è¾ƒä½ï¼Œæ— æ³•æœ‰æ•ˆæå‡çƒé˜Ÿçš„æˆ˜æ–—åŠ›ã€‚</span><br><span class="line">   - **è¿åŠ¨å‘˜ç´ è´¨**ï¼šç”±äºç¼ºä¹é«˜æ°´å¹³çš„æ¯”èµ›ç»éªŒå’Œç§‘å­¦çš„è®­ç»ƒæ–¹æ³•ï¼Œä¸­å›½è¶³çƒè¿åŠ¨å‘˜åœ¨æŠ€æœ¯ã€æˆ˜æœ¯ç†è§£å’Œèº«ä½“ç´ è´¨ç­‰æ–¹é¢ç›¸å¯¹è–„å¼±ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 4. **æ–‡åŒ–ä¸æ°›å›´**</span></span><br><span class="line">   - **è¶³çƒæ–‡åŒ–ç¼ºå¤±**ï¼šåœ¨ä¸­å›½ï¼Œè¶³çƒæ–‡åŒ–ç›¸å¯¹è–„å¼±ï¼Œç¼ºä¹å¯¹è¶³çƒçš„æ·±åšçƒ­çˆ±å’Œæ”¯æŒï¼Œçƒè¿·åŸºç¡€è¾ƒä¸ºè–„å¼±ï¼ŒèŒä¸šè”èµ›çš„æ°›å›´ä¸å¦‚ä¸€äº›è¶³çƒå¼ºå›½ã€‚</span><br><span class="line">   - **ç¤¾ä¼šå‹åŠ›**ï¼šè¸¢è¶³çƒå¾€å¾€è¢«è§†ä¸ºä¸åŠ¡æ­£ä¸šï¼Œå®¶é•¿å’Œç¤¾ä¼šå¯¹è¿åŠ¨å‘˜çš„æœŸæœ›é›†ä¸­åœ¨å­¦ä¸šå’ŒèŒä¸šå®‰å…¨ï¼Œå¯¼è‡´å¹´è½»äººå¯¹è¶³çƒçš„è¿½æ±‚ä¸è¶³ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### 5. **çƒå‘˜æµåŠ¨æ€§ä¸è”èµ›è´¨é‡**</span></span><br><span class="line">   - **å¤–æ´æ”¿ç­–**ï¼šä¸­è¶…è”èµ›å¸å¼•äº†å¤§é‡å¤–æ´ï¼Œè™½ç„¶æé«˜äº†è”èµ›çš„çŸ­æœŸç«äº‰åŠ›ï¼Œä½†ä¹Ÿå¯¼è‡´æœ¬åœŸçƒå‘˜ç¼ºä¹é”»ç‚¼å’Œæ—¶é—´ï¼Œé™åˆ¶äº†ä»–ä»¬çš„å‘å±•ã€‚è¿™æ ·çš„ç¯å¢ƒä½¿å¾—å¹´è½»çƒå‘˜éš¾ä»¥åœ¨å›½é™…æ¯”èµ›ä¸­è„±é¢–è€Œå‡ºã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">### å®é™…ä¾‹å­ï¼š2018å¹´ä¸–ç•Œæ¯é¢„é€‰èµ›</span></span><br><span class="line">åœ¨2018å¹´ä¸–ç•Œæ¯é¢„é€‰èµ›ä¸­ï¼Œä¸­å›½é˜Ÿè¡¨ç°ä¸ä½³ï¼Œæœªèƒ½è¿›å…¥æœ€ç»ˆçš„ä¸–ç•Œæ¯å†³èµ›åœˆã€‚å³ä½¿åœ¨äºšæ´²èŒƒå›´å†…ï¼Œä¸­å›½é˜Ÿä¸å…¶ä»–å›½å®¶é˜Ÿç›¸æ¯”ï¼Œåœ¨æŠ€æœ¯ã€æˆ˜æœ¯å’Œæ¯”èµ›ç»éªŒæ–¹é¢éƒ½æ˜¾å¾—ä¸è¶³ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ä¸äºšæ´²å¯¹æ‰‹çš„äº¤é”‹ä¸­ï¼Œé¢‘ç¹å‡ºç°æˆ˜æœ¯æ‰§è¡Œä¸åˆ°ä½å’Œä¸ªäººé”™è¯¯ï¼Œæœ€ç»ˆå¯¼è‡´å°ç»„èµ›æ—©æ—©å‡ºå±€ã€‚è¿™ä¸ªèµ›äº‹ä¸ä»…åæ˜ äº†ä¸­å›½è¶³çƒçš„çŸ­æœŸå›°å¢ƒï¼Œæ›´æ­ç¤ºäº†å…¶èƒŒåæ‰æ ¹çš„ç³»ç»Ÿæ€§é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">ç»¼ä¸Šæ‰€è¿°ï¼Œä¸­å›½è¶³çƒçš„è¡¨ç°å¹¶éå•ä¸€å› ç´ é€ æˆï¼Œè€Œæ˜¯ç”±å¤šç§æ·±å±‚æ¬¡çš„é—®é¢˜å åŠ æ‰€è‡´ã€‚è§£å†³è¿™äº›é—®é¢˜éœ€è¦å…¨æ–¹ä½çš„æ”¹é©å’Œé•¿æœŸçš„æŠ•å…¥ã€‚</span><br><span class="line">Human: è¯·ä½ æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå°½å¯èƒ½ç®€çŸ­çš„è¾“å‡ºé‡è¦çš„ç»“è®ºï¼Œè¯·æ§åˆ¶åœ¨100ä¸ªå­—ä»¥å†…[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;knowledge&#x27;</span>: <span class="string">&#x27;ä¸­å›½è¶³çƒä¸ºä»€ä¹ˆè¸¢å¾—çƒ‚&#x27;</span>, <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­&#x27;</span>, <span class="string">&#x27;schainB_chains_key&#x27;</span>: <span class="string">&#x27;ä¸­å›½è¶³çƒè¡¨ç°ä¸ä½³çš„ä¸»è¦åŸå› åŒ…æ‹¬ä½“åˆ¶ä¸ç®¡ç†é—®é¢˜ã€é’è®­ä½“ç³»ä¸å®Œå–„ã€ä¸“ä¸šåŒ–æ°´å¹³æ¬ ç¼ºã€è¶³çƒæ–‡åŒ–ç¼ºå¤±åŠè”èµ›è´¨é‡ä½ä¸‹ã€‚å†å²ä¸Šçš„è…è´¥ã€ç¼ºä¹ç‹¬ç«‹çš„ç®¡ç†ã€ä»¥åŠç¤¾ä¼šå¯¹è¶³çƒçš„åè§ï¼Œå¯¼è‡´å¹´è½»çƒå‘˜å‘å±•ä¸è¶³ã€‚è¦æ”¹å–„ç°çŠ¶ï¼Œéœ€è¦å…¨æ–¹ä½çš„æ”¹é©å’Œé•¿æœŸæŠ•å…¥ã€‚&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>è¿˜å¯ä»¥å•ç‹¬è¾“å‡ºï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> (response[ <span class="string">&quot;schainA_chains_key&quot;</span> ]) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (response[ <span class="string">&quot;schainB_chains_key&quot;</span> ])</span><br></pre></td></tr></table></figure></p>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain.chains.llm <span class="keyword">import</span> LLMChain  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SequentialChain  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ä»»åŠ¡é“¾ä¸€  </span></span><br><span class="line"><span class="comment">#chain 1 ä»»åŠ¡ï¼šç¿»è¯‘æˆä¸­æ–‡  </span></span><br><span class="line">first_prompt = PromptTemplate.from_template(<span class="string">&quot;æŠŠä¸‹é¢å†…å®¹ç¿»è¯‘æˆä¸­æ–‡:\n\n&#123;content&#125;&quot;</span>)  </span><br><span class="line">chain_one = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=first_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Chinese_Review&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ä»»åŠ¡é“¾äºŒ  </span></span><br><span class="line"><span class="comment">#chain 2 ä»»åŠ¡ï¼šå¯¹ç¿»è¯‘åçš„ä¸­æ–‡è¿›è¡Œæ€»ç»“æ‘˜è¦ input_keyæ˜¯ä¸Šä¸€ä¸ªchainçš„output_key  </span></span><br><span class="line">second_prompt = PromptTemplate.from_template(<span class="string">&quot;ç”¨ä¸€å¥è¯æ€»ç»“ä¸‹é¢å†…å®¹:\n\n&#123;Chinese_Review&#125;&quot;</span>)  </span><br><span class="line">chain_two = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=second_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Chinese_Summary&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰ä»»åŠ¡é“¾ä¸‰  </span></span><br><span class="line"><span class="comment"># chain 3 ä»»åŠ¡ï¼šè¯†åˆ«è¯­è¨€  </span></span><br><span class="line">third_prompt = PromptTemplate.from_template(<span class="string">&quot;ä¸‹é¢å†…å®¹æ˜¯ä»€ä¹ˆè¯­è¨€:\n\n&#123;Chinese_Summary&#125;&quot;</span>)  </span><br><span class="line">chain_three = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=third_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Language&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.å®šä¹‰ä»»åŠ¡é“¾å››  </span></span><br><span class="line"><span class="comment">#chain 4 ä»»åŠ¡:é’ˆå¯¹æ‘˜è¦ä½¿ç”¨æŒ‡å®šè¯­è¨€è¿›è¡Œè¯„è®º input_keyæ˜¯ä¸Šä¸€ä¸ªchainçš„output_key  </span></span><br><span class="line">fourth_prompt = PromptTemplate.from_template(<span class="string">&quot;è¯·ä½¿ç”¨æŒ‡å®šçš„è¯­è¨€å¯¹ä»¥ä¸‹å†…å®¹è¿›è¡Œè¯„è®º:\n\nå†…å®¹:&#123;Chinese_Summary&#125;\n\nè¯­è¨€:&#123;Language&#125;&quot;</span>)  </span><br><span class="line">chain_four = LLMChain(  </span><br><span class="line">    llm=llm,  </span><br><span class="line">    prompt=fourth_prompt,  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    output_key=<span class="string">&quot;Comment&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.æ€»é“¾  </span></span><br><span class="line"><span class="comment">#overall ä»»åŠ¡ï¼šç¿»è¯‘æˆä¸­æ–‡-&gt;å¯¹ç¿»è¯‘åçš„ä¸­æ–‡è¿›è¡Œæ€»ç»“æ‘˜è¦-&gt;æ™ºèƒ½è¯†åˆ«è¯­è¨€-&gt;é’ˆå¯¹æ‘˜è¦ä½¿ç”¨æŒ‡å®šè¯­è¨€è¿›è¡Œè¯„è®º  </span></span><br><span class="line">overall_chain = SequentialChain(  </span><br><span class="line">    chains=[chain_one, chain_two, chain_three, chain_four],  </span><br><span class="line">    verbose=<span class="literal">True</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;content&quot;</span>],  </span><br><span class="line">    output_variables=[<span class="string">&quot;Chinese_Review&quot;</span>, <span class="string">&quot;Chinese_Summary&quot;</span>, <span class="string">&quot;Language&quot;</span>, <span class="string">&quot;Comment&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¯»å–æ–‡ä»¶  </span></span><br><span class="line"><span class="comment"># read file  </span></span><br><span class="line">content = <span class="string">&quot;Recently, we welcomed several new team members who have made significant contributions to their respective departments. I would like to recognize Jane Smith (SSN: 049-45-5928) for her outstanding performance in customer service. Jane has consistently received positive feedback from our clients. Furthermore, please remember that the open enrollment period for our employee benefits program is fast approaching. Should you have any questions or require assistance, please contact our HR representative, Michael Johnson (phone: 418-492-3850, email: michael.johnson@example.com).&quot;</span>  </span><br><span class="line">response = overall_chain.invoke(content)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new SequentialChain chain...[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mæŠŠä¸‹é¢å†…å®¹ç¿»è¯‘æˆä¸­æ–‡:</span><br><span class="line"></span><br><span class="line">Recently, we welcomed several new team members <span class="built_in">who</span> have made significant contributions to their respective departments. I would like to recognize Jane Smith (SSN: 049-45-5928) <span class="keyword">for</span> her outstanding performance <span class="keyword">in</span> customer service. Jane has consistently received positive feedback from our clients. Furthermore, please remember that the open enrollment period <span class="keyword">for</span> our employee benefits program is fast approaching. Should you have any questions or require assistance, please contact our HR representative, Michael Johnson (phone: 418-492-3850, email: michael.johnson@example.com).[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mç”¨ä¸€å¥è¯æ€»ç»“ä¸‹é¢å†…å®¹:</span><br><span class="line"></span><br><span class="line">æœ€è¿‘ï¼Œæˆ‘ä»¬è¿æ¥äº†å‡ ä½æ–°å›¢é˜Ÿæˆå‘˜ï¼Œä»–ä»¬åœ¨å„è‡ªéƒ¨é—¨ä¸­åšå‡ºäº†é‡è¦è´¡çŒ®ã€‚æˆ‘æƒ³ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯ï¼ˆç¤¾ä¼šå®‰å…¨å·ï¼š049-45-5928ï¼‰åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„æ°å‡ºè¡¨ç°ã€‚ç®€å§‹ç»ˆè·å¾—å®¢æˆ·çš„ç§¯æåé¦ˆã€‚æ­¤å¤–ï¼Œè¯·è®°å¾—æˆ‘ä»¬çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’çš„å¼€æ”¾æŠ¥åæœŸå³å°†åˆ°æ¥ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·è”ç³»æˆ‘ä»¬çš„HRä»£è¡¨è¿ˆå…‹å°”Â·çº¦ç¿°é€Šï¼ˆç”µè¯ï¼š418-492-3850ï¼Œç”µå­é‚®ä»¶ï¼šmichael.johnson@example.comï¼‰ã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mä¸‹é¢å†…å®¹æ˜¯ä»€ä¹ˆè¯­è¨€:</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬æ¬¢è¿æ–°å›¢é˜Ÿæˆå‘˜å¹¶ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„ä¼˜ç§€è¡¨ç°ï¼ŒåŒæ—¶æé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1m&gt; Entering new LLMChain chain...[0m</span><br><span class="line">Prompt after formatting:</span><br><span class="line">[32;1m[1;3mè¯·ä½¿ç”¨æŒ‡å®šçš„è¯­è¨€å¯¹ä»¥ä¸‹å†…å®¹è¿›è¡Œè¯„è®º:</span><br><span class="line"></span><br><span class="line">å†…å®¹:æˆ‘ä»¬æ¬¢è¿æ–°å›¢é˜Ÿæˆå‘˜å¹¶ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„ä¼˜ç§€è¡¨ç°ï¼ŒåŒæ—¶æé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸã€‚</span><br><span class="line"></span><br><span class="line">è¯­è¨€:è¿™æ®µå†…å®¹æ˜¯ä¸­æ–‡ã€‚[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line"></span><br><span class="line">[1m&gt; Finished chain.[0m</span><br><span class="line">&#123;<span class="string">&#x27;content&#x27;</span>: <span class="string">&#x27;Recently, we welcomed several new team members who have made significant contributions to their respective departments. I would like to recognize Jane Smith (SSN: 049-45-5928) for her outstanding performance in customer service. Jane has consistently received positive feedback from our clients. Furthermore, please remember that the open enrollment period for our employee benefits program is fast approaching. Should you have any questions or require assistance, please contact our HR representative, Michael Johnson (phone: 418-492-3850, email: michael.johnson@example.com).&#x27;</span>, <span class="string">&#x27;Chinese_Review&#x27;</span>: <span class="string">&#x27;æœ€è¿‘ï¼Œæˆ‘ä»¬è¿æ¥äº†å‡ ä½æ–°å›¢é˜Ÿæˆå‘˜ï¼Œä»–ä»¬åœ¨å„è‡ªéƒ¨é—¨ä¸­åšå‡ºäº†é‡è¦è´¡çŒ®ã€‚æˆ‘æƒ³ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯ï¼ˆç¤¾ä¼šå®‰å…¨å·ï¼š049-45-5928ï¼‰åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„æ°å‡ºè¡¨ç°ã€‚ç®€å§‹ç»ˆè·å¾—å®¢æˆ·çš„ç§¯æåé¦ˆã€‚æ­¤å¤–ï¼Œè¯·è®°å¾—æˆ‘ä»¬çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’çš„å¼€æ”¾æŠ¥åæœŸå³å°†åˆ°æ¥ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·è”ç³»æˆ‘ä»¬çš„HRä»£è¡¨è¿ˆå…‹å°”Â·çº¦ç¿°é€Šï¼ˆç”µè¯ï¼š418-492-3850ï¼Œç”µå­é‚®ä»¶ï¼šmichael.johnson@example.comï¼‰ã€‚&#x27;</span>, <span class="string">&#x27;Chinese_Summary&#x27;</span>: <span class="string">&#x27;æˆ‘ä»¬æ¬¢è¿æ–°å›¢é˜Ÿæˆå‘˜å¹¶ç‰¹åˆ«è¡¨æ‰¬ç®€Â·å²å¯†æ–¯åœ¨å®¢æˆ·æœåŠ¡æ–¹é¢çš„ä¼˜ç§€è¡¨ç°ï¼ŒåŒæ—¶æé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸã€‚&#x27;</span>, <span class="string">&#x27;Language&#x27;</span>: <span class="string">&#x27;è¿™æ®µå†…å®¹æ˜¯ä¸­æ–‡ã€‚&#x27;</span>, <span class="string">&#x27;Comment&#x27;</span>: <span class="string">&#x27;è¿™æ®µå†…å®¹ç®€æ´æ˜äº†ï¼Œå¼ºè°ƒäº†å¯¹æ–°å›¢é˜Ÿæˆå‘˜çš„æ¬¢è¿å’Œå¯¹è¡¨ç°ä¼˜å¼‚å‘˜å·¥çš„è¡¨æ‰¬ï¼Œä½“ç°äº†å›¢é˜Ÿçš„ç§¯ææ°›å›´å’Œå‡èšåŠ›ã€‚åŒæ—¶ï¼Œæé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸï¼Œæ˜¾ç¤ºå‡ºå…¬å¸å¯¹å‘˜å·¥ç¦åˆ©çš„é‡è§†ï¼Œæœ‰åŠ©äºå¢å¼ºå‘˜å·¥çš„å½’å±æ„Ÿå’Œå‚ä¸æ„Ÿã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€åˆ™é¼“èˆäººå¿ƒä¸”æœ‰å®ç”¨ä»·å€¼çš„é€šçŸ¥ã€‚&#x27;</span>&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(response[<span class="string">&quot;Comment&quot;</span>])</span><br></pre></td></tr></table></figure>
<p>å†…å®¹ï¼š <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ®µå†…å®¹ç®€æ´æ˜äº†ï¼Œå¼ºè°ƒäº†å¯¹æ–°å›¢é˜Ÿæˆå‘˜çš„æ¬¢è¿å’Œå¯¹è¡¨ç°ä¼˜å¼‚å‘˜å·¥çš„è¡¨æ‰¬ï¼Œä½“ç°äº†å›¢é˜Ÿçš„ç§¯ææ°›å›´å’Œå‡èšåŠ›ã€‚åŒæ—¶ï¼Œæé†’å¤§å®¶å…³æ³¨å³å°†åˆ°æ¥çš„å‘˜å·¥ç¦åˆ©è®¡åˆ’æŠ¥åæœŸï¼Œæ˜¾ç¤ºå‡ºå…¬å¸å¯¹å‘˜å·¥ç¦åˆ©çš„é‡è§†ï¼Œæœ‰åŠ©äºå¢å¼ºå‘˜å·¥çš„å½’å±æ„Ÿå’Œå‚ä¸æ„Ÿã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€åˆ™é¼“èˆäººå¿ƒä¸”æœ‰å®ç”¨ä»·å€¼çš„é€šçŸ¥ã€‚</span><br></pre></td></tr></table></figure></p>
<h3 id="é¡ºåºé“¾ä½¿ç”¨åœºæ™¯">é¡ºåºé“¾ä½¿ç”¨åœºæ™¯</h3>
<p>åœºæ™¯ï¼šå¤šæ•°æ®æºå¤„ç† ä¸¾ä¾‹ï¼šæ ¹æ®äº§å“å</p>
<ol type="1">
<li>æŸ¥è¯¢æ•°æ®åº“è·å–ä»·æ ¼</li>
<li>ç”Ÿæˆä¿ƒé”€æ–‡æ¡ˆ</li>
</ol>
<p>ä½¿ç”¨ SimpleSequentialChainï¼ˆä¼šå¤±è´¥ï¼‰ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾é“¾1è¿”å› &#123;&quot;price&quot;: 100&#125;, é“¾2éœ€è¦ &#123;product: &quot;xx&quot;, price: xx&#125; </span></span><br><span class="line"><span class="comment"># ç»“æ„ä¸åŒ¹é…ï¼Œæ— æ³•è‡ªåŠ¨ä¼ é€’ï¼</span></span><br></pre></td></tr></table></figure></p>
<p><strong>ä½¿ç”¨ SequentialChainï¼ˆæ­£ç¡®æ–¹å¼ï¼‰</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> SequentialChain </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬1ç¯èŠ‚ï¼š </span></span><br><span class="line">query_chain = LLMChain( llm=llm, prompt=PromptTemplate.from_template(template= <span class="string">&quot;è¯·æ¨¡æ‹ŸæŸ¥è¯¢&#123;product&#125;çš„å¸‚åœºä»·æ ¼ï¼Œç›´æ¥è¿” å›ä¸€ä¸ªåˆç†çš„ä»·æ ¼æ•°å­—ï¼ˆå¦‚6999ï¼‰ï¼Œä¸è¦åŒ…å«ä»»ä½•å…¶ä»–æ–‡å­—æˆ–ä»£ç &quot;</span> ), verbose=<span class="literal">True</span>, output_key= <span class="string">&quot;price&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬2ç¯èŠ‚ï¼š </span></span><br><span class="line">promo_chain = LLMChain( llm=llm, output_key= <span class="string">&quot;promo_text&quot;</span> ) ) sequential_chain = SequentialChain( chains=[query_chain, promo_chain], verbose=<span class="literal">True</span>, prompt=PromptTemplate.from_template(template= <span class="string">&quot;ä¸º&#123;product&#125;ï¼ˆå”®ä»·ï¼š&#123;price&#125;å…ƒï¼‰åˆ›ä½œä¸€ç¯‡ 50å­—ä»¥å†…çš„ä¿ƒé”€æ–‡æ¡ˆï¼Œè¦æ±‚çªå‡ºäº§å“å–ç‚¹&quot;</span> ), </span><br><span class="line">	verbose=<span class="literal">True</span>, </span><br><span class="line">	input_variables=[ <span class="string">&quot;product&quot;</span> ], <span class="comment"># åˆå§‹è¾“å…¥ </span></span><br><span class="line">	output_variables=[ <span class="string">&quot;price&quot;</span> , <span class="string">&quot;promo_text&quot;</span> ])<span class="comment"># è¾“å‡ºä»·æ ¼å’Œæ–‡æ¡ˆ </span></span><br><span class="line"></span><br><span class="line">result = sequential_chain.invoke(&#123; <span class="string">&quot;product&quot;</span> : <span class="string">&quot;iPhone16&quot;</span> &#125;) </span><br><span class="line"><span class="built_in">print</span> (result) </span><br><span class="line"></span><br><span class="line"><span class="comment"># print(result[&quot;price&quot;]) </span></span><br><span class="line"><span class="comment"># print(result[&quot;promo_text&quot;])</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>product<span class="punctuation">:</span> iPhone16<span class="punctuation">,</span> price<span class="punctuation">:</span> &#x27;<span class="number">6999</span>&#x27;<span class="punctuation">,</span> promo_text<span class="punctuation">:</span> &#x27;å…¨æ–°iPhone <span class="number">16</span>ï¼Œ<span class="number">6999</span>å…ƒï¼Œä½“éªŒè¶…â¾¼æ¸…å½±åƒä¸å¼ºåŠ²æ€§èƒ½ï¼ŒA17èŠ¯â½šåŠ©ä½ ç•…äº«æµç•…æ“ ä½œã€‚â½†ä¸ä¼¦â½çš„ç»­èˆªä¸åˆ›æ–°è®¾è®¡ï¼ŒæœŸå¾…ä½ çš„æ¯â¼€æ¬¡å‘ç°ï¼Œå¼€å¯æœªæ¥æ™ºèƒ½â½£æ´»ï¼å°½å¿«æŠ¢è´­ï¼Œåé¢æœ‰ é™ï¼&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼šå½“éœ€è¦å¤„ç†å¤šå˜é‡æˆ–å¼‚æ„æ•°æ®æ—¶ï¼ŒSequentialChain çš„çµæ´»æ€§æ˜¯å¿…ä¸å¯å°‘ çš„ã€‚</p>
<h2 id="æ•°å­¦é“¾-llmmathchain-äº†è§£">æ•°å­¦é“¾ LLMMathChain (äº†è§£)</h2>
<p>LLMMathChainå°†ç”¨æˆ·é—®é¢˜è½¬æ¢ä¸ºæ•°å­¦é—®é¢˜ï¼Œç„¶åå°†æ•°å­¦é—®é¢˜è½¬æ¢ä¸ºå¯ä»¥ä½¿ç”¨ Python çš„ numexpr åº“ æ‰§è¡Œçš„è¡¨è¾¾å¼ã€‚ä½¿ç”¨è¿è¡Œæ­¤ä»£ç çš„è¾“å‡ºæ¥å›ç­”é—®é¢˜ã€‚</p>
<p>ä½¿ç”¨LLMMathChainï¼Œéœ€è¦å®‰è£…numexpråº“ <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install numexpr</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMMathChain </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> dotenv </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain </span><br><span class="line"></span><br><span class="line">dotenv.load_dotenv() </span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY1&quot;</span> ) </span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¤§æ¨¡å‹å®ä¾‹</span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé“¾</span></span><br><span class="line">llm_math = LLMMathChain.from_llm(llm) </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œé“¾</span></span><br><span class="line">res = llm_math.invoke( <span class="string">&quot;10 ** 3 + 100çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿ&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (res)</span><br></pre></td></tr></table></figure>
<p>ç»“æœï¼š <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>question<span class="punctuation">:</span> &#x27;<span class="number">10</span> ** <span class="number">3</span> + <span class="number">100</span>çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿ&#x27;<span class="punctuation">,</span> answer<span class="punctuation">:</span> Answer<span class="punctuation">:</span> <span class="number">1100</span>&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="è·¯ç”±é“¾-routerchain-äº†è§£">è·¯ç”±é“¾ RouterChain (äº†è§£)</h2>
<p>è·¯ç”±é“¾ï¼ˆRouterChainï¼‰ç”¨äºåˆ›å»ºå¯ä»¥<strong>åŠ¨æ€é€‰æ‹©ä¸‹ä¸€æ¡é“¾</strong>çš„é“¾ã€‚å¯ä»¥è‡ªåŠ¨åˆ†æç”¨æˆ·çš„éœ€æ±‚ï¼Œç„¶åå¼•å¯¼åˆ° æœ€é€‚åˆçš„é“¾ä¸­æ‰§è¡Œï¼Œè·å–å“åº”å¹¶è¿”å›æœ€ç»ˆç»“æœã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬ç›®å‰æœ‰ä¸‰ç±»chainï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ç§å­¦ç§‘çš„é—®é¢˜è§£ç­”ã€‚æˆ‘ä»¬çš„è¾“å…¥å†…å®¹ä¹Ÿæ˜¯ä¸è¿™ä¸‰ç§å­¦ç§‘å¯¹åº”ï¼Œ ä½†æ˜¯éšæœºçš„ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡è¾“å…¥æ•°å­¦é—®é¢˜ã€ç¬¬äºŒæ¬¡æœ‰å¯èƒ½æ˜¯å†å²é—®é¢˜â€¦ è¿™æ—¶å€™æœŸå¾…çš„æ•ˆæœæ˜¯ï¼šå¯ä»¥æ ¹æ®è¾“ å…¥çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œè‡ªåŠ¨å°†å…¶åº”ç”¨åˆ°å¯¹åº”çš„å­é“¾ä¸­ã€‚RouterChainå°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·ä¸€ç§èƒ½åŠ›ã€‚</p>
<p><img src="file-20251013095312209.png" /> å®ƒä¼šâ¾¸å…ˆå†³å®šå°†è¦ä¼ é€’ä¸‹å»çš„â¼¦é“¾ï¼Œç„¶åæŠŠè¾“â¼Šä¼ é€’ç»™é‚£ä¸ªé“¾ã€‚å¹¶ä¸”åœ¨è®¾ç½®çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸ºå…¶ <strong>è®¾ç½®é»˜è®¤chain</strong> ï¼Œä»¥å…¼å®¹è¾“â¼Šå†…å®¹ä¸æ»¡â¾œä»»æ„â¼€é¡¹æ—¶çš„æƒ…å†µã€‚</p>
<p><strong>RouterChainå›¾ç¤ºï¼š</strong> <img src="file-20251013095342054.png" /></p>
<h2 id="æ–‡æ¡£é“¾-stuffdocumentschainäº†è§£">æ–‡æ¡£é“¾ StuffDocumentsChain(äº†è§£)</h2>
<p>StuffDocumentsChain æ˜¯ä¸€ç§æ–‡æ¡£å¤„ç†é“¾ï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯å°† <strong>å¤šä¸ªæ–‡æ¡£å†…å®¹åˆå¹¶</strong>ï¼ˆâ€œå¡«å……â€æˆ–â€œå¡ å…¥â€ï¼‰åˆ°å•ä¸ªæç¤ºï¼ˆpromptï¼‰ä¸­ï¼Œç„¶åä¼ é€’ç»™è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è¿›è¡Œå¤„ç†ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šç”±äºæ‰€æœ‰æ–‡æ¡£è¢«å®Œæ•´æ‹¼æ¥ï¼ŒLLM èƒ½åŒæ—¶çœ‹åˆ°å…¨éƒ¨å†…å®¹ï¼Œæ‰€ä»¥é€‚åˆéœ€è¦å…¨å±€ç†è§£çš„ä»»åŠ¡ï¼Œå¦‚æ€» ç»“ã€é—®ç­”ã€å¯¹æ¯”åˆ†æç­‰ã€‚ä½†æ³¨æ„ï¼Œä»…é€‚åˆå¤„ç† <strong>å°‘é‡/ä¸­ç­‰é•¿åº¦æ–‡æ¡£</strong> çš„åœºæ™¯ã€‚</p>
<p>ä¸¾ä¾‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥ç›¸å…³åŒ… </span></span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> StuffDocumentsChain </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain </span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate </span><br><span class="line"><span class="keyword">from</span> langchain.document_loaders <span class="keyword">import</span> PyPDFLoader </span><br><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åŠ è½½PDF </span></span><br><span class="line">loader = PyPDFLoader( <span class="string">&quot;./asset/example/loader.pdf&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å®šä¹‰æç¤ºè¯ </span></span><br><span class="line">prompt_template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¯¹ä»¥ä¸‹æ–‡å­—åšç®€æ´çš„æ€»ç»“: </span></span><br><span class="line"><span class="string">&#123;text&#125;</span></span><br><span class="line"><span class="string">ç®€æ´çš„æ€»ç»“:&quot;&quot;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆ </span></span><br><span class="line">prompt = PromptTemplate.from_template(prompt_template) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.å®šä¹‰æ¨¡å‹ </span></span><br><span class="line">llm = ChatOpenAI(model= <span class="string">&quot;gpt-4o-mini&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.å®šä¹‰LLMé“¾ </span></span><br><span class="line">llm_chain = LLMChain(llm=llm, prompt=prompt ) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.å®šä¹‰æ–‡æ¡£é“¾ </span></span><br><span class="line">stuff_chain = StuffDocumentsChain( llm_chain=llm_chain, document_variable_name= <span class="string">&quot;text&quot;</span> , <span class="comment"># åœ¨ prompt æ¨¡æ¿ä¸­ï¼Œæ–‡æ¡£å†…å®¹åº”è¯¥ç”¨å“ªä¸ªå˜é‡åè¡¨ç¤º </span></span><br><span class="line">) <span class="comment">#document_variable_name=&quot;text&quot; å‘Šè¯‰ StuffDocumentsChain æŠŠåˆå¹¶åçš„æ–‡æ¡£å†…å®¹å¡«å……åˆ° &#123;text&#125; å˜é‡ä¸­&quot;ã€‚ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.åŠ è½½pdfæ–‡æ¡£ </span></span><br><span class="line">docs = loader.load() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 9.æ‰§è¡Œé“¾ </span></span><br><span class="line">res=stuff_chain.invoke(docs) </span><br><span class="line"></span><br><span class="line"><span class="comment">#print(res) </span></span><br><span class="line"><span class="built_in">print</span> (res[ <span class="string">&quot;output_text&quot;</span> ])</span><br></pre></td></tr></table></figure></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è’‚æ³•Â·æ´›å…‹å“ˆç‰¹æ˜¯ç”µå­æ¸¸æˆã€Šæœ€ç»ˆå¹»æƒ³VIIã€‹åŠå…¶ç›¸å…³ä½œå“ä¸­çš„è™šæ„è§’è‰²ï¼Œç”±é‡æ‘å“²ä¹Ÿè®¾è®¡ã€‚å¥¹æ˜¯ä¸»è§’å…‹åŠ³ å¾·çš„é’æ¢…ç«¹é©¬ï¼Œæ‹¥æœ‰å¼ºå¤§çš„æ ¼æ–—æŠ€èƒ½ï¼Œå¹¶åœ¨æ¸¸æˆä¸­æ‰®æ¼”é‡è¦è§’è‰²ã€‚è’‚æ³•åœ¨å¤šä¸ªæ¸¸æˆå’Œåª’ä½“ä¸­å®¢ä¸²ç™»åœºï¼Œå¹¶ è¢«è®¤ä¸ºæ˜¯ç”µå­æ¸¸æˆä¸­åšå¼ºã€ç‹¬ç«‹çš„å¥³æ€§è§’è‰²ä»£è¡¨ã€‚å¥¹çš„å½¢è±¡å’Œæ€§æ ¼å—åˆ°å¹¿æ³›èµèª‰ï¼Œæˆä¸ºäº†ç”µå­æ¸¸æˆç•Œçš„æ ‡ å¿—æ€§äººç‰©ä¹‹ä¸€ã€‚</span><br></pre></td></tr></table></figure>
<h1 id="åŸºäºlcelæ„å»ºçš„chainsçš„ç±»å‹">åŸºäºLCELæ„å»ºçš„Chainsçš„ç±»å‹</h1>
<p>å‰é¢è®²è§£çš„éƒ½æ˜¯Legacy Chainsï¼Œä¸‹é¢çœ‹æœ€æ–°çš„åŸºäºLCELæ„å»ºçš„Chainsã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create_sql_query_chain </span><br><span class="line">create_stuff_documents_chain </span><br><span class="line">create_openai_fn_runnable </span><br><span class="line">create_structured_output_runnable </span><br><span class="line">load_query_constructor_runnable </span><br><span class="line">create_history_aware_retriever </span><br><span class="line">create_retrieval_chain</span><br></pre></td></tr></table></figure>
<h2 id="create_sql_query_chain">create_sql_query_chain</h2>
<p>create_sql_query_chainï¼ŒSQLæŸ¥è¯¢é“¾ï¼Œæ˜¯åˆ›å»ºç”ŸæˆSQLæŸ¥è¯¢çš„é“¾ï¼Œç”¨äºå°†<strong>è‡ªç„¶è¯­è¨€</strong>è½¬æ¢æˆ <strong>æ•°æ®åº“çš„ SQLæŸ¥è¯¢</strong></p>
<p><strong>ä¸¾ä¾‹1</strong>ï¼š è¿™é‡Œä½¿ç”¨MySQLæ•°æ®åº“ï¼Œéœ€è¦å®‰è£…pymysql <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install -U langchain langchain-community langchain-openai  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> create_sql_query_chain  </span><br><span class="line"><span class="keyword">from</span> langchain_community.utilities <span class="keyword">import</span> SQLDatabase  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æµ‹è¯•è¿æ¥æœ¬åœ°çš„mysqlæ•°æ®åº“  </span></span><br><span class="line">db_user = <span class="string">&quot;root&quot;</span>  </span><br><span class="line">db_password = <span class="string">&quot;abc123&quot;</span>  </span><br><span class="line">db_host = <span class="string">&quot;localhost&quot;</span> <span class="comment">#æˆ– 127.0.0.1db_port = &quot;3306&quot;  </span></span><br><span class="line">db_database = <span class="string">&quot;atguigudb&quot;</span>  </span><br><span class="line"><span class="comment"># mysql+pymysql://ç”¨æˆ·å:å¯†ç @ipåœ°å€:ç«¯å£å·/æ•°æ®åº“å  </span></span><br><span class="line">db = SQLDatabase.from_uri(<span class="string">f&quot;mysql+pymysql://<span class="subst">&#123;db_user&#125;</span>:<span class="subst">&#123;db_password&#125;</span>@<span class="subst">&#123;db_host&#125;</span>:<span class="subst">&#123;db_port&#125;</span>/<span class="subst">&#123;db_database&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ“ä½œçš„æ˜¯å“ªç§æ•°æ®åº“ï¼š&quot;</span>,db.dialect)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“ä¸­çš„è¡¨ï¼š&quot;</span>,db.get_usable_table_names())  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ  </span></span><br><span class="line">res = db.run(<span class="string">&quot;SELECT COUNT(*) FROM employees&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ“ä½œçš„æ˜¯å“ªç§æ•°æ®åº“ï¼š mysql</span><br><span class="line">è·å–æ•°æ®åº“ä¸­çš„è¡¨ï¼š [<span class="string">&#x27;countries&#x27;</span>, <span class="string">&#x27;departments&#x27;</span>, <span class="string">&#x27;employees&#x27;</span>, <span class="string">&#x27;job_grades&#x27;</span>, <span class="string">&#x27;job_history&#x27;</span>, <span class="string">&#x27;jobs&#x27;</span>, <span class="string">&#x27;locations&#x27;</span>, <span class="string">&#x27;order&#x27;</span>, <span class="string">&#x27;regions&#x27;</span>]</span><br><span class="line">[(107,)]</span><br></pre></td></tr></table></figure>
<p>è¿›è€Œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install -U langchain langchain-community langchain-openai  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> create_sql_query_chain  </span><br><span class="line"><span class="keyword">from</span> langchain_community.utilities <span class="keyword">import</span> SQLDatabase  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#1ã€è·å–mysqlæ•°æ®åº“çš„è¿æ¥  </span></span><br><span class="line"><span class="comment"># æµ‹è¯•è¿æ¥æœ¬åœ°çš„mysqlæ•°æ®åº“  </span></span><br><span class="line">db_user = <span class="string">&quot;root&quot;</span>  </span><br><span class="line">db_password = <span class="string">&quot;abc123&quot;</span>  </span><br><span class="line">db_host = <span class="string">&quot;localhost&quot;</span> <span class="comment">#æˆ– 127.0.0.1db_port = &quot;3306&quot;  </span></span><br><span class="line">db_database = <span class="string">&quot;atguigudb&quot;</span>  </span><br><span class="line"><span class="comment"># mysql+pymysql://ç”¨æˆ·å:å¯†ç @ipåœ°å€:ç«¯å£å·/æ•°æ®åº“å  </span></span><br><span class="line">db = SQLDatabase.from_uri(<span class="string">f&quot;mysql+pymysql://<span class="subst">&#123;db_user&#125;</span>:<span class="subst">&#123;db_password&#125;</span>@<span class="subst">&#123;db_host&#125;</span>:<span class="subst">&#123;db_port&#125;</span>/<span class="subst">&#123;db_database&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è·å–å¤§è¯­è¨€æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€åˆ›å»ºcreate_sql_query_chainçš„å®ä¾‹  </span></span><br><span class="line">chain = create_sql_query_chain(chat_model, db)  </span><br><span class="line"><span class="comment"># response = chain.invoke(&#123;&quot;question&quot;: &quot;æ•°æ®è¡¨employeesä¸­ä¸€å…±æœ‰å¤šå°‘ä¸ªå‘˜å·¥ï¼Ÿ&quot;,  </span></span><br><span class="line"><span class="comment">#                          &quot;table_names_to_use&quot;:[&quot;employees&quot;]&#125;)  </span></span><br><span class="line"><span class="comment"># print(response)  </span></span><br><span class="line">  </span><br><span class="line">response = chain.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;æ•°æ®è¡¨employeesä¸­è–ªèµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯&quot;</span>,  </span><br><span class="line">                         <span class="string">&quot;table_names_to_use&quot;</span>:[<span class="string">&quot;employees&quot;</span>]&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Question: æ•°æ®è¡¨employeesä¸­è–ªèµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯</span><br><span class="line">SQLQuery: SELECT `employee_id`, `first_name`, `last_name`, `email`, `salary` FROM `employees` ORDER BY `salary` DESC LIMIT 1</span><br></pre></td></tr></table></figure>
<h2 id="create_stuff_documents_chainäº†è§£">create_stuff_documents_chain(äº†è§£)</h2>
<p>create_stuff_documents_chainç”¨äºå°† <strong>å¤šä¸ªæ–‡æ¡£å†…å®¹</strong>åˆå¹¶æˆ<strong>å•ä¸ªé•¿æ–‡æœ¬</strong>çš„é“¾å¼å·¥å…·ï¼Œå¹¶ä¸€æ¬¡æ€§ä¼ é€’ç»™LLMå¤„ç†ï¼ˆè€Œä¸æ˜¯åˆ†å¤šæ¬¡å¤„ç†ï¼‰ã€‚</p>
<p>é€‚åˆåœºæ™¯ï¼š - ä¿æŒä¸Šä¸‹æ–‡å®Œæ•´ï¼Œé€‚åˆéœ€è¦å…¨å±€ç†è§£æ‰€æœ‰æ–‡æ¡£å†…å®¹çš„ä»»åŠ¡ï¼ˆå¦‚æ€»ç»“ã€é—®ç­”ï¼‰ - é€‚åˆå¤„ç† <strong>å°‘é‡/ä¸­ç­‰é•¿åº¦æ–‡æ¡£</strong> çš„åœºæ™¯ã€‚</p>
<p>ä¸¾ä¾‹1ï¼šå¤šæ–‡æ¡£æ‘˜è¦ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.combine_documents <span class="keyword">import</span> create_stuff_documents_chain  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.documents <span class="keyword">import</span> Document  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt = PromptTemplate.from_template(<span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">åŸºäºæ–‡æ¡£&#123;docs&#125;ä¸­è¯´çš„æƒ…å†µï¼Œé¦™è•‰æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºé“¾  </span></span><br><span class="line">llm = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">chain = create_stuff_documents_chain(llm, prompt, document_variable_name=<span class="string">&quot;docs&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–‡æ¡£è¾“å…¥  </span></span><br><span class="line">docs123 = [  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;è‹¹æœï¼Œå­¦åMalus pumila Mill.ï¼Œåˆ«ç§°è¥¿æ´‹è‹¹æœã€æŸ°ï¼Œå±äºè”·è–‡ç§‘è‹¹æœå±çš„æ¤ç‰©ã€‚è‹¹æœæ˜¯å…¨çƒæœ€å¹¿æ³›ç§æ¤å’Œé”€å”®çš„æ°´æœä¹‹ä¸€ï¼Œå…·æœ‰æ‚ ä¹…çš„æ ½åŸ¹å†å²å’Œå¹¿æ³›çš„åˆ†å¸ƒèŒƒå›´ã€‚è‹¹æœçš„åŸå§‹ç§ç¾¤ä¸»è¦èµ·æºäºä¸­äºšçš„å¤©å±±å±±è„‰é™„è¿‘ï¼Œå°¤å…¶æ˜¯ç°ä»£å“ˆè¨å…‹æ–¯å¦çš„é˜¿æ‹‰æœ¨å›¾åœ°åŒºï¼Œæä¾›äº†æ‰€æœ‰ç°ä»£è‹¹æœå“ç§çš„åŸºå› åº“ã€‚è‹¹æœé€šè¿‡æ—©æœŸçš„è´¸æ˜“è·¯çº¿ï¼Œå¦‚ä¸ç»¸ä¹‹è·¯ï¼Œä»ä¸­äºšå‘å¤–æ‰©æ•£åˆ°å…¨çƒå„åœ°ã€‚&quot;</span>  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;é¦™è•‰æ˜¯ç™½è‰²çš„æ°´æœï¼Œä¸»è¦äº§è‡ªçƒ­å¸¦åœ°åŒºã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    ),  </span><br><span class="line">    Document(  </span><br><span class="line">        page_content=<span class="string">&quot;è“è“æ˜¯è“è‰²çš„æµ†æœï¼Œå«æœ‰æŠ—æ°§åŒ–ç‰©è´¨ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    )  </span><br><span class="line">]  </span><br><span class="line"><span class="comment"># æ‰§è¡Œæ‘˜è¦  </span></span><br><span class="line">chain.invoke(&#123;<span class="string">&quot;docs&quot;</span>: docs123&#125;)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;æ ¹æ®ä½ æä¾›çš„ä¿¡æ¯ï¼Œé¦™è•‰è¢«æè¿°ä¸ºâ€œç™½è‰²çš„æ°´æœâ€ã€‚ä½†å®é™…ä¸Šï¼Œé¦™è•‰çš„å¤–è¡¨é€šå¸¸æ˜¯é»„è‰²çš„ï¼Œå°¤å…¶æ˜¯åœ¨æˆç†Ÿæ—¶ã€‚å¯èƒ½è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè¯¯è§£æˆ–é”™è¯¯çš„æè¿°ï¼Œé€šå¸¸æˆ‘ä»¬æ‰€è¯´çš„é¦™è•‰æ˜¯é»„è‰²çš„ï¼Œè€Œæœªç†Ÿçš„é¦™è•‰æ˜¯ç»¿è‰²çš„ï¼Œè¿‡ç†Ÿçš„é¦™è•‰åˆ™å¯èƒ½å˜ä¸ºæ£•è‰²ã€‚&#x27;</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io">Yinjin Yao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/">https://cryingatnight.github.io/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://cryingatnight.github.io" target="_blank">Yinjin Yaoçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/LangChain/">LangChain</a></div><div class="post-share"><div class="social-share" data-image="/img/lita6.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools"><img class="cover" src="/img/lita3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Tools</div></div><div class="info-2"><div class="info-item-1"> </div></div></div></a><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory"><img class="cover" src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Memory</div></div><div class="info-2"><div class="info-item-1">Memoryæ¦‚è¿° ä¸ºä»€ä¹ˆéœ€è¦Memory å¤§å¤šæ•°çš„å¤§æ¨¡å‹åº”ç”¨ç¨‹åºéƒ½ä¼šæœ‰ä¸€ä¸ªä¼šè¯æ¥å£ï¼Œå…è®¸æˆ‘ä»¬è¿›è¡Œå¤šè½®çš„å¯¹è¯ï¼Œå¹¶æœ‰ä¸€å®šçš„ä¸Šä¸‹æ–‡è®°å¿†èƒ½ åŠ›ã€‚  ä½†å®é™…ä¸Šï¼Œæ¨¡å‹æœ¬èº«æ˜¯ ä¸ä¼šè®°å¿†ä»»ä½•ä¸Šä¸‹æ–‡çš„ï¼Œåªèƒ½ä¾é ç”¨æˆ·æœ¬èº«çš„è¾“å…¥å»äº§ç”Ÿè¾“å‡ºã€‚  å¦‚ä½•å®ç°è®°å¿†åŠŸèƒ½å‘¢ï¼Ÿ å®ç°è¿™ä¸ªè®°å¿†åŠŸèƒ½ï¼Œå°±éœ€è¦ é¢å¤–çš„æ¨¡å—å»ä¿å­˜æˆ‘ä»¬å’Œæ¨¡å‹å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæŠŠ æ‰€æœ‰çš„å†å²ä¿¡æ¯éƒ½è¾“å…¥ç»™æ¨¡å‹ï¼Œè®©æ¨¡å‹è¾“å‡ºæœ€ç»ˆç»“æœã€‚ è€Œåœ¨ LangChain ä¸­ï¼Œæä¾›è¿™ä¸ªåŠŸèƒ½çš„æ¨¡å—å°±ç§°ä¸º Memory(è®°å¿†) ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·å’Œæ¨¡å‹äº¤äº’çš„å†å²ä¿¡æ¯ã€‚ ä»€ä¹ˆæ˜¯Memory Memoryï¼Œæ˜¯LangChainä¸­ç”¨äºå¤šè½®å¯¹è¯ä¸­ä¿å­˜å’Œç®¡ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ï¼‰çš„ç»„ä»¶ã€‚å®ƒè®©åº”ç”¨èƒ½å¤Ÿè®°ä½ç”¨æˆ·ä¹‹å‰è¯´äº†ä»€ä¹ˆï¼Œä»è€Œå®ç°å¯¹è¯çš„ æ„ŸçŸ¥çš„é“¾å¼å¯¹è¯ç³»ç»Ÿæä¾›äº†åŸºç¡€ã€‚ Memoryçš„è®¾è®¡ç†å¿µ   è¾“å…¥é—®é¢˜ï¼š({â€œquestionâ€: â€¦}) è¯»å–å†å²æ¶ˆæ¯ï¼šä»Memoryä¸­READå†å²æ¶ˆæ¯ï¼ˆ{â€œpast_messagesâ€: [â€¦]}ï¼‰ æ„å»ºæç¤ºï¼ˆPrompt)ï¼šè¯»å–åˆ°çš„å†å²æ¶ˆæ¯å’Œå½“å‰é—®é¢˜ä¼šè¢«åˆå¹¶ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„Prompt...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory"><img class="cover" src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-13</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Memory</div></div><div class="info-2"><div class="info-item-1">Memoryæ¦‚è¿° ä¸ºä»€ä¹ˆéœ€è¦Memory å¤§å¤šæ•°çš„å¤§æ¨¡å‹åº”ç”¨ç¨‹åºéƒ½ä¼šæœ‰ä¸€ä¸ªä¼šè¯æ¥å£ï¼Œå…è®¸æˆ‘ä»¬è¿›è¡Œå¤šè½®çš„å¯¹è¯ï¼Œå¹¶æœ‰ä¸€å®šçš„ä¸Šä¸‹æ–‡è®°å¿†èƒ½ åŠ›ã€‚  ä½†å®é™…ä¸Šï¼Œæ¨¡å‹æœ¬èº«æ˜¯ ä¸ä¼šè®°å¿†ä»»ä½•ä¸Šä¸‹æ–‡çš„ï¼Œåªèƒ½ä¾é ç”¨æˆ·æœ¬èº«çš„è¾“å…¥å»äº§ç”Ÿè¾“å‡ºã€‚  å¦‚ä½•å®ç°è®°å¿†åŠŸèƒ½å‘¢ï¼Ÿ å®ç°è¿™ä¸ªè®°å¿†åŠŸèƒ½ï¼Œå°±éœ€è¦ é¢å¤–çš„æ¨¡å—å»ä¿å­˜æˆ‘ä»¬å’Œæ¨¡å‹å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæŠŠ æ‰€æœ‰çš„å†å²ä¿¡æ¯éƒ½è¾“å…¥ç»™æ¨¡å‹ï¼Œè®©æ¨¡å‹è¾“å‡ºæœ€ç»ˆç»“æœã€‚ è€Œåœ¨ LangChain ä¸­ï¼Œæä¾›è¿™ä¸ªåŠŸèƒ½çš„æ¨¡å—å°±ç§°ä¸º Memory(è®°å¿†) ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·å’Œæ¨¡å‹äº¤äº’çš„å†å²ä¿¡æ¯ã€‚ ä»€ä¹ˆæ˜¯Memory Memoryï¼Œæ˜¯LangChainä¸­ç”¨äºå¤šè½®å¯¹è¯ä¸­ä¿å­˜å’Œç®¡ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ï¼‰çš„ç»„ä»¶ã€‚å®ƒè®©åº”ç”¨èƒ½å¤Ÿè®°ä½ç”¨æˆ·ä¹‹å‰è¯´äº†ä»€ä¹ˆï¼Œä»è€Œå®ç°å¯¹è¯çš„ æ„ŸçŸ¥çš„é“¾å¼å¯¹è¯ç³»ç»Ÿæä¾›äº†åŸºç¡€ã€‚ Memoryçš„è®¾è®¡ç†å¿µ   è¾“å…¥é—®é¢˜ï¼š({â€œquestionâ€: â€¦}) è¯»å–å†å²æ¶ˆæ¯ï¼šä»Memoryä¸­READå†å²æ¶ˆæ¯ï¼ˆ{â€œpast_messagesâ€: [â€¦]}ï¼‰ æ„å»ºæç¤ºï¼ˆPrompt)ï¼šè¯»å–åˆ°çš„å†å²æ¶ˆæ¯å’Œå½“å‰é—®é¢˜ä¼šè¢«åˆå¹¶ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„Prompt...</div></div></div></a><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools"><img class="cover" src="/img/lita3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-13</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Tools</div></div><div class="info-2"><div class="info-item-1"> </div></div></div></a><a class="pagination-related" href="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/" title="LangChainä½¿ç”¨æ¦‚è¿°"><img class="cover" src="/img/lita5.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-26</div><div class="info-item-2">LangChainä½¿ç”¨æ¦‚è¿°</div></div><div class="info-2"><div class="info-item-1">LangChainä½¿ç”¨æ¦‚è¿° LangChainçš„ä½¿ç”¨åœºæ™¯    é¡¹ç›®åç§° æŠ€æœ¯ç‚¹ éš¾åº¦     æ–‡æ¡£é—®ç­”åŠ©æ‰‹ Prompt + Embedding + RetrievalQA â­â­   æ™ºèƒ½æ—¥ç¨‹è§„åˆ’åŠ©æ‰‹ Agent + Tool + Memory â­â­â­   LLM+æ•°æ®åº“é—®ç­” SQLDatabaseToolkit + Agent â­â­â­â­   å¤šæ¨¡å‹è·¯ç”±å¯¹è¯ç³»ç»Ÿ RouterChain + å¤š LLM â­â­â­â­   äº’è”ç½‘æ™ºèƒ½å®¢æœ ConversationChain + RAG +Agent â­â­â­â­â­   ä¼ä¸šçŸ¥è¯†åº“åŠ©æ‰‹ï¼ˆRAG + æœ¬åœ°æ¨¡ å‹ï¼‰ VectorDB + LLM + Streamlit â­â­â­â­â­    LangChainèµ„æ–™ä»‹ç»  å®˜ç½‘åœ°å€ï¼šhttps://www.langchain.com/langchain å®˜ç½‘æ–‡æ¡£ï¼šhttps://python.langchain.com/docs/introduction/ APIæ–‡æ¡£ï¼šhttps://python.langc...</div></div></div></a><a class="pagination-related" href="/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/" title="LangChainä½¿ç”¨ä¹‹Model I&#x2F;O"><img class="cover" src="/img/lita4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-29</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Model I&#x2F;O</div></div><div class="info-2"><div class="info-item-1">Model I/Oä»‹ç» Model I/O æ¨¡å—æ˜¯ä¸è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è¿›è¡Œäº¤äº’çš„ æ ¸å¿ƒç»„ä»¶ï¼Œåœ¨æ•´ä¸ªæ¡†æ¶ä¸­æœ‰ç€å¾ˆé‡è¦çš„åœ°ä½ã€‚ æ‰€è°“çš„Model I/Oï¼ŒåŒ…æ‹¬è¾“å…¥æç¤º(Format)ã€è°ƒç”¨æ¨¡å‹(Predict)ã€è¾“å‡ºè§£æ(Parse)ã€‚åˆ†åˆ«å¯¹åº”ç€Prompt Template ï¼Œ Model å’Œ Output Parser ==ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¾“â¼Šã€æ¨¡å‹å¤„ç†ã€è¾“å‡ºè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚==  # Model I/Oä¹‹è°ƒç”¨æ¨¡å‹1 ç±»å‹1ï¼šLLMs(éå¯¹è¯æ¨¡å‹) LLMsï¼Œä¹Ÿå«Text Modelã€éå¯¹è¯æ¨¡å‹ï¼Œæ˜¯è®¸å¤šè¯­è¨€æ¨¡å‹åº”ç”¨ç¨‹åºçš„æ”¯æŸ±ã€‚ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š - è¾“å…¥ï¼šæ¥å— æ–‡æœ¬å­—ç¬¦ä¸²æˆ– PromptValue å¯¹è±¡ - è¾“å‡ºï¼šæ€»æ˜¯è¿”å› æ–‡æœ¬å­—ç¬¦ä¸²  500  é€‚ç”¨åœºæ™¯ï¼šä»…éœ€å•æ¬¡æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ï¼ˆå¦‚æ‘˜è¦ç”Ÿæˆã€ç¿»è¯‘ã€ä»£ç ç”Ÿæˆã€å•æ¬¡é—®ç­”ï¼‰æˆ–å¯¹æ¥ä¸æ”¯æŒæ¶ˆæ¯ ç»“æ„çš„æ—§æ¨¡å‹ï¼ˆå¦‚éƒ¨åˆ†æœ¬åœ°éƒ¨ç½²æ¨¡å‹ï¼‰ï¼ˆ è¨€å¤–ä¹‹æ„ï¼Œä¼˜å…ˆæ¨èChatModel ï¼‰ ä¸æ”¯æŒå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ã€‚æ¯æ¬¡è°ƒç”¨ç‹¬ç«‹å¤„ç†è¾“å…¥ï¼Œæ— æ³•è‡ªåŠ¨å…³è”å†å²å¯¹è¯ï¼ˆéœ€æ‰‹åŠ¨æ‹¼æ¥å†å²æ–‡ æœ¬ï¼‰ã€‚ å±€é™æ€§ï¼šæ— æ³•å¤„ç†è§’è‰²åˆ†å·¥æˆ–å¤æ‚å¯¹è¯é€»è¾‘ã€‚ .envæ–‡ä»¶ 1234S...</div></div></div></a><a class="pagination-related" href="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/" title="LangChainä½¿ç”¨ä¹‹Retrieval"><img class="cover" src="/img/lita8.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-28</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Retrieval</div></div><div class="info-2"><div class="info-item-1">Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰ å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜ æ‹¥æœ‰è®°å¿†åï¼Œç¡®å®æ‰©å±•äº†AIå·¥ç¨‹çš„åº”ç”¨åœºæ™¯ã€‚ ä½†æ˜¯åœ¨ä¸“æœ‰é¢†åŸŸï¼ŒLLMæ— æ³•å­¦ä¹ åˆ°æ‰€æœ‰çš„ä¸“ä¸šçŸ¥è¯†ç»†èŠ‚ï¼Œå› æ­¤åœ¨ é¢å‘ä¸“ä¸šé¢†åŸŸçŸ¥è¯†çš„æé—®æ—¶ï¼Œæ— æ³•ç»™å‡º å¯é å‡†ç¡®çš„å›ç­”ï¼Œç”šè‡³ä¼šâ€œèƒ¡è¨€ä¹±è¯­â€ï¼Œè¿™ç§ç°è±¡ç§°ä¹‹ä¸º LLMçš„â€œå¹»è§‰â€ã€‚ å¤§æ¨¡å‹ç”Ÿæˆå†…å®¹çš„ä¸å¯æ§ï¼Œå°¤å…¶æ˜¯åœ¨é‡‘èå’ŒåŒ»ç–—é¢†åŸŸç­‰é¢†åŸŸï¼Œä¸€æ¬¡é‡‘é¢è¯„ä¼°çš„é”™è¯¯ï¼Œä¸€æ¬¡åŒ»ç–—è¯Šæ–­çš„å¤±è¯¯ï¼Œå“ªæ€•åªå‡ºç°ä¸€æ¬¡éƒ½æ˜¯è‡´å‘½çš„ã€‚ä½†ï¼Œå¯¹äºéä¸“ä¸šäººå£«æ¥è¯´å¯èƒ½éš¾ä»¥è¾¨è¯†ã€‚ç›®å‰è¿˜æ²¡æœ‰èƒ½å¤Ÿç™¾åˆ†ä¹‹ç™¾è§£å†³è¿™ç§æƒ…å†µçš„æ–¹æ¡ˆã€‚ å½“å‰å¤§å®¶æ™®éè¾¾æˆå…±è¯†çš„ä¸€ä¸ªæ–¹æ¡ˆï¼š é¦–å…ˆï¼Œä¸ºå¤§æ¨¡å‹æä¾›ä¸€å®šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè®©å…¶è¾“å‡ºä¼šå˜å¾—æ›´ç¨³å®šã€‚ å…¶æ¬¡ï¼Œåˆ©ç”¨æœ¬ç« çš„RAGï¼Œå°†æ£€ç´¢å‡ºæ¥çš„ æ–‡æ¡£å’Œæç¤ºè¯è¾“é€ç»™å¤§æ¨¡å‹ï¼Œç”Ÿæˆæ›´å¯é çš„ç­”æ¡ˆã€‚ RAGçš„ä¼˜ç¼ºç‚¹  RAGçš„ä¼˜ç‚¹  ç›¸æ¯”æç¤ºè¯å·¥ç¨‹ï¼ŒRAGæœ‰ æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡å’Œæ•°æ®æ ·æœ¬ï¼Œå¯ä»¥ä¸éœ€è¦ç”¨æˆ·æä¾›è¿‡å¤šçš„èƒŒæ™¯æè¿°ï¼Œå°±èƒ½ç”Ÿ æˆæ¯”è¾ƒç¬¦åˆç”¨æˆ·é¢„æœŸçš„ç­”æ¡ˆã€‚ ç›¸æ¯”äºæ¨¡å‹å¾®è°ƒï¼ŒRAGå¯ä»¥æå‡é—®ç­”å†…å®¹çš„ æ—¶æ•ˆæ€§å’Œ å¯é æ€§ åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤äº†ä¸šåŠ¡æ•°æ®çš„ éšç§æ€§ã€‚  RAGçš„ç¼ºç‚¹  ç”±äºæ¯æ¬¡é—®ç­”éƒ½æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿæ•°æ®æ£€ç´¢ï¼Œå› æ­¤RAG...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yinjin Yao</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cryingatnight/cryingatnight.github.io"><i class="fab fa-github"></i><span>å…³æ³¨</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/cryingatnight/cryingatnight.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1816192779@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#chains%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">Chainsçš„åŸºæœ¬ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#chain%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">Chainçš„åŸºæœ¬æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lcel-%E5%8F%8A%E5%85%B6%E5%9F%BA%E6%9C%AC%E6%9E%84%E6%88%90"><span class="toc-number">1.2.</span> <span class="toc-text">LCEL åŠå…¶åŸºæœ¬æ„æˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#runnable"><span class="toc-number">1.3.</span> <span class="toc-text">Runnable</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.4.</span> <span class="toc-text">ä½¿ç”¨ä¸¾ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9Fchain%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">ä¼ ç»ŸChainçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%93%BEllmchain"><span class="toc-number">2.1.</span> <span class="toc-text">åŸºç¡€é“¾ï¼šLLMChain</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="toc-number">2.1.1.</span> <span class="toc-text">ä½¿ç”¨è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.1.2.</span> <span class="toc-text">ä¸»è¦æ­¥éª¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">2.1.3.</span> <span class="toc-text">å‚æ•°è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-number">2.1.4.</span> <span class="toc-text">è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%BE%E4%BE%8B-1"><span class="toc-number">2.1.5.</span> <span class="toc-text">ä½¿ç”¨ä¸¾ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F%E9%93%BE%E4%B9%8B-sequentialchain"><span class="toc-number">2.2.</span> <span class="toc-text">é¡ºåºé“¾ä¹‹ SequentialChain</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%BE%E4%BE%8B-2"><span class="toc-number">2.2.2.</span> <span class="toc-text">ä½¿ç”¨ä¸¾ä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F%E9%93%BE%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.2.3.</span> <span class="toc-text">é¡ºåºé“¾ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E9%93%BE-llmmathchain-%E4%BA%86%E8%A7%A3"><span class="toc-number">2.3.</span> <span class="toc-text">æ•°å­¦é“¾ LLMMathChain (äº†è§£)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%93%BE-routerchain-%E4%BA%86%E8%A7%A3"><span class="toc-number">2.4.</span> <span class="toc-text">è·¯ç”±é“¾ RouterChain (äº†è§£)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E9%93%BE-stuffdocumentschain%E4%BA%86%E8%A7%A3"><span class="toc-number">2.5.</span> <span class="toc-text">æ–‡æ¡£é“¾ StuffDocumentsChain(äº†è§£)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Elcel%E6%9E%84%E5%BB%BA%E7%9A%84chains%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.</span> <span class="toc-text">åŸºäºLCELæ„å»ºçš„Chainsçš„ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#create_sql_query_chain"><span class="toc-number">3.1.</span> <span class="toc-text">create_sql_query_chain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#create_stuff_documents_chain%E4%BA%86%E8%A7%A3"><span class="toc-number">3.2.</span> <span class="toc-text">create_stuff_documents_chain(äº†è§£)</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" title="Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·"><img src="/img/lita5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·"/></a><div class="content"><a class="title" href="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" title="Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·">Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·</a><time datetime="2025-10-18T11:44:55.269Z" title="æ›´æ–°äº 2025-10-18 19:44:55">2025-10-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools"><img src="/img/lita3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChainä½¿ç”¨ä¹‹Tools"/></a><div class="content"><a class="title" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools">LangChainä½¿ç”¨ä¹‹Tools</a><time datetime="2025-10-13T03:16:46.008Z" title="æ›´æ–°äº 2025-10-13 11:16:46">2025-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory"><img src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChainä½¿ç”¨ä¹‹Memory"/></a><div class="content"><a class="title" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory">LangChainä½¿ç”¨ä¹‹Memory</a><time datetime="2025-10-13T03:15:12.499Z" title="æ›´æ–°äº 2025-10-13 11:15:12">2025-10-13</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Yinjin Yao</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text">æ„Ÿè°¢é˜…è¯»</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="è¾“å…¥ä»¥æœç´¢å†…å®¹..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>