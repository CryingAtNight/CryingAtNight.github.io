<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hive | Yinjin Yao的博客</title><meta name="author" content="Yinjin Yao"><meta name="copyright" content="Yinjin Yao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="什么是HIVEHive 是基于 Hadoop 的一个数据仓库工具。以下是具体介绍:  功能特点：Hive 可以将结构化的数据文件映射为一张数据库表，并提供完整的 SQL 查询功能，能将 SQL 语句转换为 MapReduce 任务进行运行。它允许熟悉 SQL 的用户方便地查询数据，也支持熟悉 MapReduce 的开发者自定义 mapper 和 reducer，以处理复杂的分析工作。 优势：学习成">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive">
<meta property="og:url" content="https://cryingatnight.github.io/2025/06/27/Hive/index.html">
<meta property="og:site_name" content="Yinjin Yao的博客">
<meta property="og:description" content="什么是HIVEHive 是基于 Hadoop 的一个数据仓库工具。以下是具体介绍:  功能特点：Hive 可以将结构化的数据文件映射为一张数据库表，并提供完整的 SQL 查询功能，能将 SQL 语句转换为 MapReduce 任务进行运行。它允许熟悉 SQL 的用户方便地查询数据，也支持熟悉 MapReduce 的开发者自定义 mapper 和 reducer，以处理复杂的分析工作。 优势：学习成">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cryingatnight.github.io/img/lita9.jpg">
<meta property="article:published_time" content="2025-06-27T04:00:00.000Z">
<meta property="article:modified_time" content="2025-08-10T07:04:51.174Z">
<meta property="article:author" content="Yinjin Yao">
<meta property="article:tag" content="Hive">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="Oracle">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cryingatnight.github.io/img/lita9.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hive",
  "url": "https://cryingatnight.github.io/2025/06/27/Hive/",
  "image": "https://cryingatnight.github.io/img/lita9.jpg",
  "datePublished": "2025-06-27T04:00:00.000Z",
  "dateModified": "2025-08-10T07:04:51.174Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yinjin Yao",
      "url": "https://cryingatnight.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/headimage.png"><link rel="canonical" href="https://cryingatnight.github.io/2025/06/27/Hive/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hive',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> 豆瓣网开发</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> 上不上AI评分系统</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 图标</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/lita9.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/headimage.png" alt="Logo"><span class="site-name">Yinjin Yao的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">Hive</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> 豆瓣网开发</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> 上不上AI评分系统</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 图标</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Hive</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-27T04:00:00.000Z" title="发表于 2025-06-27 12:00:00">2025-06-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-10T07:04:51.174Z" title="更新于 2025-08-10 15:04:51">2025-08-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="什么是HIVE"><a href="#什么是HIVE" class="headerlink" title="什么是HIVE"></a>什么是HIVE</h1><p>Hive 是<strong>基于 Hadoop 的一个数据仓库工具</strong>。以下是具体介绍:</p>
<ul>
<li><strong>功能特点</strong>：Hive 可以<strong>将结构化的数据文件映射为一张数据库表</strong>，并提供完整的 SQL 查询功能，能将 SQL 语句转换为 MapReduce 任务进行运行。它允许熟悉 SQL 的用户方便地查询数据，也支持熟悉 MapReduce 的开发者自定义 mapper 和 reducer，以处理复杂的分析工作。</li>
<li><strong>优势</strong>：学习成本低，通过类 SQL 语句可快速实现简单的 MapReduce 统计，无需开发专门的 MapReduce 应用，十分适合数据仓库的统计分析。</li>
<li><strong>应用场景</strong>：常用于对时效性要求不高的数据分析场景。由于 <strong>Hive 底层依赖 Hadoop 的 HDFS 存储数据</strong>，利用 MapReduce 进行计算，因此能够处理大规模的数据，在处理海量结构化日志的数据统计等方面应用广泛。</li>
<li><strong>与数据库的区别</strong>：<ol>
<li>数据库一般用于在线应用，支持对某一行或某些行数据的更新、删除等操作，采用 “写时模式”，数据加载慢但查询快。</li>
<li>而 Hive 不支持对具体行的操作，也不支持事务和索引，采用 “读时模式”，适合处理非结构化或存储模式未知的数据，更侧重于对海量数据的批量处理和分析。</li>
</ol>
</li>
</ul>
<h1 id="HIVE安装"><a href="#HIVE安装" class="headerlink" title="HIVE安装"></a><a href="Hadoop.md#HIVE%E5%AE%89%E8%A3%85">HIVE安装</a></h1><h2 id="配置mysql安装源"><a href="#配置mysql安装源" class="headerlink" title="配置mysql安装源"></a>配置mysql安装源</h2><p>（在线安装方法）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#下载安装源</span></span><br><span class="line">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 mysql 源</span></span><br><span class="line">yum localinstall mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="comment"># 导入key</span></span><br><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br><span class="line"><span class="comment"># 修改国内源</span></span><br><span class="line">vim /etc/yum.repos.d/mysql-community.repo</span><br><span class="line">修改 baseurl 为 https://mirrors.cloud.tencent.com/mysql/yum/mysql-5.7-community-el7-x86_64/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#安装mysql</span></span><br><span class="line">yum install -y mysql-community-server</span><br></pre></td></tr></table></figure>

<ol>
<li>安装mysql （本地安装方法）</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">00#rpm包安装</span><br><span class="line"><span class="comment">#tar -zvxf mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz  -C /usr/local/mysql</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.解压：</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line">tar -zxvf mysql-5.7.22-linux-glibc2.12-x86_64.tar</span><br><span class="line"><span class="built_in">mv</span> mysql-5.7.22-linux-glibc2.12-x86_64 mysql-5.7.22</span><br><span class="line"><span class="built_in">ln</span> -s mysql-5.7.22 mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.添加用户组和用户</span></span><br><span class="line"><span class="comment">#添加用户组</span></span><br><span class="line">groupadd mysql</span><br><span class="line"><span class="comment">#添加用户mysql 到用户组mysql</span></span><br><span class="line">useradd -g mysql mysql</span><br><span class="line"><span class="comment">#4.安装</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/mysql</span><br><span class="line"><span class="built_in">mkdir</span> data</span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql ./</span><br><span class="line">./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql/m<span class="string">&#x27;y&#x27;</span>s<span class="string">&#x27;q --datadir=/usr/local/mysql/data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#将mysql/目录下除了data/目录的所有文件，改回root用户所有</span></span><br><span class="line"><span class="string">chown -R root .</span></span><br><span class="line"><span class="string">#mysql用户只需作为mysql-5.7.22/data/目录下所有文件的所有者</span></span><br><span class="line"><span class="string">chown -R mysql data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#5.复制启动文件</span></span><br><span class="line"><span class="string">cp support-files/mysql.server /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">chmod 755 /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">cp bin/my_print_defaults /usr/bin/ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.修改启动脚本</span></span><br><span class="line"><span class="string">vi /etc/init.d/mysqld</span></span><br><span class="line"><span class="string">#修改项：</span></span><br><span class="line"><span class="string">basedir=/usr/local/mysql-5.7.22/</span></span><br><span class="line"><span class="string">datadir=/usr/local/mysql-5.7.22/data</span></span><br><span class="line"><span class="string">port=3306</span></span><br><span class="line"><span class="string">#加入环境变量，编辑 /etc/profile，这样可以在任何地方用mysql命令了</span></span><br><span class="line"><span class="string">vi ~/.bash_profile</span></span><br><span class="line"><span class="string">#添加mysql路径，加入下面内容，按ESC--&gt;:wq保存</span></span><br><span class="line"><span class="string">export PATH=$PATH:/usr/local/mysql-5.7.22/bin</span></span><br><span class="line"><span class="string">#刷新立即生效</span></span><br><span class="line"><span class="string">source ~/.bash_profile</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#7.修改mysql配置项</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vi /etc/my.cnf</span></span><br><span class="line"><span class="string">#配置如下：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string">basedir = /usr/local/mysql</span></span><br><span class="line"><span class="string">datadir = /usr/local/mysql/data</span></span><br><span class="line"><span class="string">socket = /tmp/mysql.sock</span></span><br><span class="line"><span class="string">user = mysql</span></span><br><span class="line"><span class="string">tmpdir = /tmp</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld_safe]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">log-error = /usr/local/mysql/data/error.log</span></span><br><span class="line"><span class="string">pid-file = /usr/local/mysql/data/mysql.pid</span></span><br><span class="line"><span class="string">#!includedir /etc/my.cnf.d</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#8.启动mysql</span></span><br><span class="line"><span class="string">service mysqld start</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#如启动失败，删除 /usr/local/mysql-5.7.22/data下所有文件，重新执行./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data，再启动</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#9.进入mysql修改初始密码，修改远程连接的用户权限问题</span></span><br><span class="line"><span class="string">mysql -uroot -p</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ALTER USER &#x27;</span>root<span class="string">&#x27;@&#x27;</span>localhost<span class="string">&#x27; IDENTIFIED BY &#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">use mysql;</span></span><br><span class="line"><span class="string">UPDATE user SET host=&#x27;</span>%<span class="string">&#x27; WHERE user=&#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">flush privileges;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#开机自启动</span></span><br><span class="line"><span class="string">chkconfig --add mysqld</span></span><br><span class="line"><span class="string">chkconfig mysqld on</span></span><br><span class="line"><span class="string">chkconfig --list</span></span><br><span class="line"><span class="string">  mysqld          0:关    1:关    2:开    3:开    4:开    5:开    6:关</span></span><br></pre></td></tr></table></figure>

<ol>
<li>配置mysql</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启动mysql 服务</span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"><span class="comment">#设置开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld</span><br><span class="line"><span class="comment"># 重载所有修改过的配置文件</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="comment"># 关闭密码验证</span></span><br><span class="line">vim /etc/my.cnf</span><br><span class="line"><span class="comment"># mysqld选项下加入</span></span><br><span class="line">validate_password=OFF</span><br><span class="line"><span class="comment">#重启mysql服务</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="comment"># 得到临时密码</span></span><br><span class="line">grep <span class="string">&#x27;temporary password&#x27;</span> /var/log/mysqld.log</span><br><span class="line"><span class="comment">#登录mysql</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="comment"># 开发环境 修改密码为root</span></span><br><span class="line">ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="comment">#修改root账号登录限制</span></span><br><span class="line">use mysql;</span><br><span class="line">UPDATE user SET host=<span class="string">&#x27;%&#x27;</span> WHERE user=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">flush privileges; </span><br><span class="line"><span class="comment">#创建metastore元数据库</span></span><br><span class="line">create database metastore</span><br><span class="line">DEFAULT CHARACTER SET utf8</span><br><span class="line">DEFAULT COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure>

<h2 id="安装HIVE"><a href="#安装HIVE" class="headerlink" title="安装HIVE"></a>安装HIVE</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#解压apache-hive-3.1.2-bin.tar.gz到/opt/module/目录下面</span></span><br><span class="line">   tar -zxvf apache-hive-3.1.2-bin.tar.gz -C /opt/module/</span><br><span class="line"><span class="comment">#修改`/etc/profile.d/my_env.sh`，添加环境变量</span></span><br><span class="line">   vim /etc/profile.d/my_env.sh</span><br><span class="line"><span class="comment">#添加内容</span></span><br><span class="line"><span class="comment">#HIVE_HOME</span></span><br><span class="line">   <span class="built_in">export</span> HIVE_HOME=/opt/module/apache-hive-3.1.2-bin</span><br><span class="line">   <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br><span class="line"><span class="comment">#刷新环境变量</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<ol>
<li>hive基础配置</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#解决日志Jar包冲突</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.10.0.jar <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.10.0.bak</span><br><span class="line"></span><br><span class="line"><span class="comment">#拷贝mysql-connector.jar到lib库</span></span><br><span class="line"><span class="built_in">cp</span> /opt/software/mysql-connector-java-5.1.27-bin.jar <span class="variable">$HIVE_HOME</span>/lib</span><br></pre></td></tr></table></figure>

<ol>
<li><p>配置hive-site.xml</p>
<p>挑转到<code>/opt/module/apache-hive-3.1.2-bin/conf/</code>目录新建文件 hive-site.xml</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!--jdbc连接的URL--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://hadoop100:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbc连接的Driver--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbc连接的username--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--jdbc连接的password--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Hive元数据存储版本的验证--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--元数据存储授权--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Hive默认在HDFS的工作目录--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.enable.doAs<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--取消本地模式改为false--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.mode.local.auto<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.map.child.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx2048m<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>初始化Hive元数据库</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql -verbose</span><br></pre></td></tr></table></figure>

<h2 id="优化mapreduce"><a href="#优化mapreduce" class="headerlink" title="优化mapreduce"></a>优化mapreduce</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure>

<p>增加配置</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1536<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx1024M<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3072<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx2560M<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="配置beeline"><a href="#配置beeline" class="headerlink" title="配置beeline"></a>配置beeline</h2><p>配置core-site.xml 使其任意节点都可以访问hadoop</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;*&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;*&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>启动 hiveserver2</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#前端启动</span></span><br><span class="line">hiveserver2</span><br><span class="line"><span class="comment">#后台启动</span></span><br><span class="line"><span class="built_in">nohup</span> hiveserver2 &amp;</span><br></pre></td></tr></table></figure>

<ol>
<li>登录命令</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beeline -u jdbc:hive2://localhost:10000 -n root -p 123456 [密码随意]</span><br><span class="line">beeline -u jdbc:hive2://localhost:10000 -n root -p 123456  -e <span class="string">&#x27;show tables;&#x27;</span> </span><br></pre></td></tr></table></figure>

<ol>
<li>dbeaver登录</li>
</ol>
<ul>
<li>获取文件 hadoop-common-3.1.3.jar</li>
<li>获取文件 hive-jdbc-3.1.2-standalone.jar</li>
<li>添加hive数据库链接</li>
</ul>
<h1 id="hive-数据操作语句"><a href="#hive-数据操作语句" class="headerlink" title="hive 数据操作语句"></a><strong>hive</strong> 数据操作语句</h1><h2 id="元数据查看语句"><a href="#元数据查看语句" class="headerlink" title="元数据查看语句"></a>元数据查看语句</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--查看数据库</span></span><br><span class="line"><span class="keyword">show</span>  database db_hive</span><br><span class="line"><span class="comment">--过滤查看数据库</span></span><br><span class="line"><span class="keyword">show</span> databases <span class="keyword">like</span> <span class="string">&#x27;db_hive*&#x27;</span>;</span><br><span class="line"><span class="comment">--查看详情</span></span><br><span class="line"><span class="keyword">desc</span> database db_hive</span><br><span class="line"><span class="keyword">desc</span> database extended db_hive;</span><br><span class="line"><span class="comment">--查看表</span></span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="comment">--查看表列详情</span></span><br><span class="line"><span class="keyword">desc</span> dept;</span><br><span class="line"><span class="comment">--查看表所有详细信息</span></span><br><span class="line"><span class="keyword">desc</span> extended emp;</span><br><span class="line"><span class="keyword">show</span> formatted emp;</span><br><span class="line"><span class="comment">--查看分区信息</span></span><br><span class="line"><span class="keyword">show</span> partitions emp;</span><br></pre></td></tr></table></figure>

<h2 id="建库操作"><a href="#建库操作" class="headerlink" title="建库操作"></a>建库操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] database_name</span><br><span class="line">[COMMENT database_comment]</span><br><span class="line">[LOCATION hdfs_path]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="建表操作"><a href="#建表操作" class="headerlink" title="建表操作"></a>建表操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name <span class="comment">--内部表</span></span><br><span class="line">[(col_name data_type [COMMENT col_comment], ...)] <span class="comment">--数据类型 </span></span><br><span class="line">[COMMENT table_comment] </span><br><span class="line">[PARTITIONED <span class="keyword">BY</span> (col_name data_type [COMMENT col_comment], ...)] <span class="comment">--分区表</span></span><br><span class="line">[CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) </span><br><span class="line">[SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], ...)] <span class="keyword">INTO</span> num_buckets BUCKETS] <span class="comment">--分桶表</span></span><br><span class="line">[<span class="type">ROW</span> FORMAT DELIMITED <span class="comment">--数据格式</span></span><br><span class="line">[FIELDS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--列分隔</span></span><br><span class="line">[COLLECTION ITEMS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--复合数据item分隔</span></span><br><span class="line">[MAP KEYS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] <span class="comment">--复合数据key分隔</span></span><br><span class="line">[LINES TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]] <span class="comment">--行分隔</span></span><br><span class="line">[STORED <span class="keyword">AS</span> file_format] <span class="comment">--压缩格式</span></span><br><span class="line">[LOCATION hdfs_path] <span class="comment">--表数据文件存储路径</span></span><br><span class="line">[TBLPROPERTIES (property_name<span class="operator">=</span>property_value, ...)] <span class="comment">--内外部表转换</span></span><br><span class="line">[<span class="keyword">AS</span> select_statement]</span><br></pre></td></tr></table></figure>

<h2 id="上传数据"><a href="#上传数据" class="headerlink" title="上传数据"></a>上传数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--load</span></span><br><span class="line">load data [<span class="keyword">local</span>] inpath <span class="string">&#x27;数据的path&#x27;</span> [overwrite] <span class="keyword">into</span> <span class="keyword">table</span> student [<span class="keyword">partition</span> (partcol1<span class="operator">=</span>val1,…)];</span><br><span class="line"></span><br><span class="line"><span class="comment">--上传hdfs</span></span><br><span class="line">dfs <span class="operator">-</span>put <span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>hive<span class="operator">/</span>datas<span class="operator">/</span>student.txt <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>atguigu<span class="operator">/</span>hive;</span><br><span class="line"></span><br><span class="line"><span class="comment">--插入数据</span></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span>  student_par <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;wangwu&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;zhaoliu&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--覆盖插入并且使用结果集进行插入</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> student_par <span class="keyword">select</span> id, name <span class="keyword">from</span> student ;</span><br></pre></td></tr></table></figure>

<h2 id="下载数据"><a href="#下载数据" class="headerlink" title="下载数据"></a>下载数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;数据的path&#x27;</span></span><br><span class="line"><span class="type">ROW</span> FORMAT DELIMITED FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\t&#x27;</span> dql_command;</span><br><span class="line"></span><br><span class="line"><span class="comment">--hadoop 导出</span></span><br><span class="line">dfs <span class="operator">-</span><span class="keyword">get</span> <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>hive<span class="operator">/</span>warehouse<span class="operator">/</span>student<span class="operator">/</span>student.txt</span><br><span class="line"><span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>datas<span class="operator">/</span>export<span class="operator">/</span>student3.txt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--hive shell导出</span></span><br><span class="line">bin<span class="operator">/</span>hive <span class="operator">-</span>e <span class="string">&#x27;select * from default.student;&#x27;</span> <span class="operator">&gt;</span></span><br><span class="line"><span class="operator">/</span>opt<span class="operator">/</span><span class="keyword">module</span><span class="operator">/</span>hive<span class="operator">/</span>datas<span class="operator">/</span>export<span class="operator">/</span>student4.txt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--export导出</span></span><br><span class="line"> export <span class="keyword">table</span> default.student <span class="keyword">to</span></span><br><span class="line"> <span class="string">&#x27;/user/hive/warehouse/export/student&#x27;</span>; </span><br></pre></td></tr></table></figure>

<h2 id="select语句"><a href="#select语句" class="headerlink" title="select语句"></a>select语句</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>] select_expr, select_expr, ...</span><br><span class="line">  <span class="keyword">FROM</span> table_reference</span><br><span class="line">  [<span class="keyword">WHERE</span> where_condition]</span><br><span class="line">  [<span class="keyword">GROUP</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">  [<span class="keyword">ORDER</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">  [CLUSTER <span class="keyword">BY</span> col_list</span><br><span class="line">    <span class="operator">|</span> [DISTRIBUTE <span class="keyword">BY</span> col_list] [SORT <span class="keyword">BY</span> col_list]</span><br><span class="line">  ]</span><br><span class="line"> [LIMIT number]</span><br></pre></td></tr></table></figure>



<h1 id="Hive复合数据类型"><a href="#Hive复合数据类型" class="headerlink" title="Hive复合数据类型"></a>Hive复合数据类型</h1><ul>
<li><p><strong>数组array</strong>: 			<strong>array&lt;value数据类型&gt;</strong></p>
<ol>
<li>相同数据类型</li>
<li>有序的排列</li>
<li>下标为数字</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--查询复合数据</span></span><br><span class="line"><span class="keyword">select</span>  a_score[<span class="number">0</span>] <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--构造复合数据-array</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">array</span>(值,值) <span class="keyword">from</span> student</span><br></pre></td></tr></table></figure>


</li>
<li><p><strong>集合struct</strong>:                         <strong>struct&lt;key值:value数据类型,key值:value数据类型&gt;</strong></p>
<ol>
<li><p>预定义个数</p>
</li>
<li><p>预定义顺序</p>
</li>
<li><p>key预定义</p>
</li>
<li><p>数据类型可不同</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--查询复合数据</span></span><br><span class="line"><span class="keyword">select</span>  s_score.chinese <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--构造复合数据</span></span><br><span class="line"><span class="keyword">select</span> named_struct(key,<span class="keyword">value</span>,key,<span class="keyword">value</span>)</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure>


</li>
<li><p><strong>字典map</strong>:                              <strong>map&lt;key数据类型,value数据类型&gt;</strong></p>
<ol>
<li><p>标准字典类型</p>
</li>
<li><p>key自定义</p>
</li>
<li><p>数据类型可不同</p>
</li>
<li><p>个数不限</p>
</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--查询复合数据</span></span><br><span class="line"><span class="keyword">select</span>  m_score[<span class="string">&#x27;语文&#x27;</span>] <span class="keyword">from</span> student2</span><br><span class="line"></span><br><span class="line"><span class="comment">--构造复合数据</span></span><br><span class="line"><span class="keyword">select</span> map(key,<span class="keyword">value</span>,key,<span class="keyword">value</span>)</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure>
<h2 id="hive-内置函数"><a href="#hive-内置函数" class="headerlink" title="hive 内置函数"></a><strong>hive</strong> 内置函数</h2>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看系统自带的函数</span></span><br><span class="line"><span class="keyword">show</span> functions;</span><br><span class="line"><span class="comment">-- 显示自带的函数的用法</span></span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">function</span> upper;</span><br><span class="line"><span class="comment">-- 详细显示自带的函数的用法</span></span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">function</span> extended upper;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="python连接hive"><a href="#python连接hive" class="headerlink" title="python连接hive"></a>python连接hive</h1><h2 id="linux环境安装python"><a href="#linux环境安装python" class="headerlink" title="linux环境安装python"></a>linux环境安装python</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载安装包 或上传安装包</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.9.9/Python-3.9.9.tgz</span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar -zxvf Python-3.9.10.tgz -C /opt/module/</span><br><span class="line"><span class="comment"># 支撑包</span></span><br><span class="line">yum install openssl-devel libffi-devel bzip2-devel gcc gcc-c++ wget -y</span><br><span class="line"><span class="comment"># 配置</span></span><br><span class="line">./configure --enable-optimizations</span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">make altinstall</span><br></pre></td></tr></table></figure>

<h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置环境变量</span></span><br><span class="line">vim  /etc/profile.d/my_env.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$PATH</span>:/opt/python39/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#生效 环境变量</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#或者进行软连接 配置 </span></span><br><span class="line"><span class="built_in">cp</span> libpython3.9.a  /usr/lib64/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">ln</span> -s /root/software/python3.9/Python-3.9.10/python /usr/bin/python3</span><br><span class="line"><span class="built_in">ln</span> -s /opt/module/Python-3.9.10/python /usr/bin/python3</span><br></pre></td></tr></table></figure>

<h2 id="安装pyhive库"><a href="#安装pyhive库" class="headerlink" title="安装pyhive库"></a>安装pyhive库</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pip3 install  -i https://mirrors.aliyun.com/pypi/simple/  thrift</span><br><span class="line">pip3 install  -i https://mirrors.aliyun.com/pypi/simple/  thrift-sasl</span><br><span class="line">pip3 install   -i https://mirrors.aliyun.com/pypi/simple/ PyHive</span><br><span class="line">pip3 install   -i https://mirrors.aliyun.com/pypi/simple/ PyM</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyhive <span class="keyword">import</span> hive</span><br><span class="line">conn=hive.connect(host=<span class="string">&#x27;localhost&#x27;</span>,port=<span class="number">10000</span>,username=<span class="string">&#x27;root&#x27;</span>,database=<span class="string">&#x27;db_hive&#x27;</span>)</span><br><span class="line">cursor=conn.cursor()</span><br><span class="line">sql=<span class="string">&#x27;show tables&#x27;</span></span><br><span class="line">cursor.execute(sql)</span><br><span class="line"><span class="built_in">print</span>(cursor.fetchall())</span><br></pre></td></tr></table></figure>

<h1 id="分区表"><a href="#分区表" class="headerlink" title="分区表"></a>分区表</h1><ul>
<li><p>分区是将一个表或索引物理地分解为多个更小、更可管理的部分。</p>
</li>
<li><p>分区对应用透明，即对访问数据库的应用而言，逻辑上讲只有一个表或一个索引（相当于应用“看到”的只是一个表或索引），但在物理上这个表或索引可能由数十个物理分区组成。</p>
</li>
</ul>
<h2 id="分区应用场景"><a href="#分区应用场景" class="headerlink" title="分区应用场景"></a>分区应用场景</h2><p><img src="/Hadoop/image-20250701152059542.png" alt="image-20250701152059542"></p>
<h2 id="oracle分区表种类"><a href="#oracle分区表种类" class="headerlink" title="oracle分区表种类"></a><strong>oracle</strong>分区表种类</h2><ol>
<li><strong>范围分区</strong>(range)</li>
<li><strong>列表分区</strong>(list)</li>
<li><strong>散列分区</strong>(hash)</li>
<li><strong>组合组合分区</strong>(subpartition)</li>
</ol>
<h2 id="oracle分区-范围分区"><a href="#oracle分区-范围分区" class="headerlink" title="oracle分区-范围分区"></a><em>oracle</em>分区-范围分区</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> ORDER_ACTIVITIES   </span><br><span class="line">(  ORDER_ID      NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span>,   </span><br><span class="line">    ORDER_DATE    <span class="type">DATE</span>,   </span><br><span class="line">    TOTAL_AMOUNT NUMBER,   </span><br><span class="line">    CUSTOTMER_ID NUMBER(<span class="number">7</span>),   </span><br><span class="line">    PAID   <span class="type">CHAR</span>(<span class="number">1</span>)   </span><br><span class="line">)   <span class="comment">-- 建表语句不变</span></span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (ORDER_DATE) <span class="comment">-- 范围分区创建 语句 关键字 range(列名)</span></span><br><span class="line">(  </span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART01 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;01- MAY -2003&#x27;</span>,<span class="string">&#x27;DD-MON-YYYY&#x27;</span>)) TABLESPACE ORD_TS01,  </span><br><span class="line">    <span class="comment">-- 分区名 （时间值）表空间</span></span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART02 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;01-JUN-2003&#x27;</span>,<span class="string">&#x27;DD-MON-YYYY&#x27;</span>)) TABLESPACE ORD_TS02,  </span><br><span class="line">  <span class="keyword">PARTITION</span> ORD_ACT_PART02 <span class="keyword">VALUES</span> LESS THAN (MAXVALUE) TABLESPACE ORD_TS03   <span class="comment">--使用maxvalue 将其他不符合上述范围的值放入其中</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h2 id="oracle分区-列表分区"><a href="#oracle分区-列表分区" class="headerlink" title="oracle分区-列表分区"></a>oracle分区-列表分区</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> ORDER_ACTIVITIES  </span><br><span class="line">(  PROBLEM_ID   NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span> <span class="keyword">PRIMARY KEY</span>,   </span><br><span class="line">    CUSTOMER_ID  NUMBER(<span class="number">7</span>) <span class="keyword">NOT NULL</span>,     </span><br><span class="line">    STATUS       VARCHAR2(<span class="number">20</span>))   </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> LIST (STATUS)    <span class="comment">-- 范围分区创建 语句 关键字 LIST(列名)</span></span><br><span class="line">(    <span class="keyword">PARTITION</span> PROB_ACTIVE   <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE PROB_TS01,  <span class="comment">-- </span></span><br><span class="line">      <span class="keyword">PARTITION</span> PROB_INACTIVE <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>,<span class="string">&#x27;unknow&#x27;</span>) TABLESPACE PROB_TS02  </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="oracle分区-散列分区"><a href="#oracle分区-散列分区" class="headerlink" title="oracle分区-散列分区"></a>oracle分区-散列分区</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> HASH_TABLE   </span><br><span class="line">( COL NUMBER(<span class="number">8</span>),   </span><br><span class="line">  INF VARCHAR2(<span class="number">100</span>)   </span><br><span class="line">)   </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> HASH (COL)    <span class="comment">-- 范围分区创建 语句 关键字 HASH(列名) </span></span><br><span class="line">(   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART01 TABLESPACE HASH_TS01,   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART02 TABLESPACE HASH_TS02,   </span><br><span class="line">  <span class="keyword">PARTITION</span> PART03 TABLESPACE HASH_TS03   </span><br><span class="line">) </span><br></pre></td></tr></table></figure>

<h2 id="oracle分区-组合分区"><a href="#oracle分区-组合分区" class="headerlink" title="oracle分区-组合分区"></a><strong>oracle</strong>分区-组合分区</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> SALES   </span><br><span class="line">(  </span><br><span class="line">PRODUCT_ID VARCHAR2(<span class="number">5</span>),  </span><br><span class="line">SALES_DATE <span class="type">DATE</span>,  </span><br><span class="line">SALES_COST NUMBER(<span class="number">10</span>),  </span><br><span class="line">STATUS VARCHAR2(<span class="number">20</span>)  </span><br><span class="line">)  </span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(SALES_DATE) SUBPARTITION <span class="keyword">BY</span> LIST (STATUS)  </span><br><span class="line">(  </span><br><span class="line">   <span class="keyword">PARTITION</span> P1 <span class="keyword">VALUES</span> LESS THAN(TO_DATE(<span class="string">&#x27;2003-01-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>))TABLESPACE rptfact2009   </span><br><span class="line">  (   </span><br><span class="line">      SUBPARTITION P1SUB1 <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE rptfact2009,   </span><br><span class="line">      SUBPARTITION P1SUB2 <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>) TABLESPACE rptfact2009   </span><br><span class="line">  ),   </span><br><span class="line">   <span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> LESS THAN (TO_DATE(<span class="string">&#x27;2003-03-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>)) TABLESPACE rptfact2009   </span><br><span class="line">  (   </span><br><span class="line">      SUBPARTITION P2SUB1 <span class="keyword">VALUES</span> (<span class="string">&#x27;ACTIVE&#x27;</span>) TABLESPACE rptfact2009,   </span><br><span class="line">      SUBPARTITION P2SUB2 <span class="keyword">VALUES</span> (<span class="string">&#x27;INACTIVE&#x27;</span>) TABLESPACE rptfact2009   </span><br><span class="line">  )   </span><br><span class="line">)  </span><br></pre></td></tr></table></figure>

<h2 id="oracle分区-分区表操作"><a href="#oracle分区-分区表操作" class="headerlink" title="oracle分区-分区表操作"></a><em>oracle</em>分区-分区表操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加分区</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> P3 <span class="keyword">VALUES</span> LESS THAN(TO_DATE(<span class="string">&#x27;2003-06-01&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>));  </span><br><span class="line"><span class="comment">--注意：以上添加的分区界限应该高于最后一个 分区界限。</span></span><br><span class="line"><span class="comment">-- 添加了一个P3SUB1子分区</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES MODIFY <span class="keyword">PARTITION</span> P3 <span class="keyword">ADD</span> SUBPARTITION P3SUB1 <span class="keyword">VALUES</span>(<span class="string">&#x27;COMPLETE&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除分区</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">DROP</span> <span class="keyword">PARTITION</span> P3;  </span><br><span class="line"><span class="keyword">ALTER TABLE</span> SALES <span class="keyword">DROP</span> SUBPARTITION P4SUB1;</span><br><span class="line"><span class="comment">-- 注意：如果删除的分区是表中唯一的分区，那么此分区将不能被删除，要想删除此分区，必须删除表。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 交换分区</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name EXCHANGE <span class="keyword">PARTITION</span> partition_name <span class="keyword">WITH</span> <span class="keyword">TABLE</span> nonpartition_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--将一个分区(子分区)和非分区表进行数据交换，oracle交换的方法是其实是对逻辑存储段进行交换。使用INCLUDEING INDEXES子句可以同步将本地索引也进行交换，使用WITH VALIDATATION子句还可以实现行数据的验证。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--交换分区时如果不带UPDATE INDEXES子句，则全局索引或全局索引基于的分区将变为不可用。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="hive分区-创建分区表"><a href="#hive分区-创建分区表" class="headerlink" title="hive分区-创建分区表"></a>hive分区-创建分区表</h2><p><strong>在 Hadoop 中，Hive 分区表通常以特定的目录结构来存储。</strong></p>
<p><strong>每个分区对应一个独立的目录，目录名通常包含分区列的值。数据文件会存储在相应的分区目录下。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建分区表</span></span><br><span class="line"><span class="keyword">create table</span> dept_partition(</span><br><span class="line">deptno <span class="type">int</span>, dname string, loc string</span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (<span class="keyword">day</span> string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="hive分区-分区表操作"><a href="#hive分区-分区表操作" class="headerlink" title="hive分区-分区表操作"></a>hive分区-分区表操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分区表数据导入</span></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/opt/module/hive/datas/dept_20200401.log&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> dept_partition <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200401&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--select分区表插入数据</span></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span> log_list_6 <span class="keyword">partition</span>(dat<span class="operator">=</span><span class="string">&#x27;20221231&#x27;</span>) <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> log_list_tmp</span><br><span class="line"><span class="comment">--多表分区插入 </span></span><br><span class="line"><span class="keyword">from</span> student </span><br><span class="line">  <span class="keyword">insert</span> overwrite <span class="keyword">table</span> student <span class="keyword">partition</span>(<span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201707&#x27;</span>)<span class="keyword">select</span> id, name <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201707&#x27;</span></span><br><span class="line">  <span class="keyword">insert</span> overwrite <span class="keyword">table</span> student <span class="keyword">partition</span>(<span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201706&#x27;</span>)<span class="keyword">select</span> id, name <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="string">&#x27;201706&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查看分区</span></span><br><span class="line"><span class="keyword">show</span> partitions tab_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--添加分区</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200404&#x27;</span>) ;</span><br><span class="line"><span class="comment">--添加多分区</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200405&#x27;</span>) <span class="keyword">partition</span>(<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200406&#x27;</span>);</span><br><span class="line"><span class="comment">--删除分区</span></span><br><span class="line"><span class="keyword">alter table</span> dept_partition <span class="keyword">drop</span> <span class="keyword">partition</span> (<span class="keyword">day</span><span class="operator">=</span><span class="string">&#x27;20200406&#x27;</span>);</span><br><span class="line"><span class="comment">--查看分区表信息</span></span><br><span class="line"><span class="keyword">show</span> partitions dept_partition;</span><br><span class="line"><span class="comment">--查看分区表结构</span></span><br><span class="line"><span class="keyword">desc</span> formatted dept_partition;</span><br><span class="line"><span class="comment">--修改分区表</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>) <span class="keyword">SET</span> LOCATION &quot;new location&quot;;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> table_name <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>) RENAME <span class="keyword">TO</span> <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;20080808&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="超市分区表示例"><a href="#超市分区表示例" class="headerlink" title="超市分区表示例"></a>超市分区表示例</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> supermarket_p (</span><br><span class="line">id string, <span class="comment">-- 行 ID  </span></span><br><span class="line">ord_id string comment <span class="string">&#x27;订单 ID&#x27;</span>,  </span><br><span class="line">ord_date string comment <span class="string">&#x27;订单日期&#x27;</span>, </span><br><span class="line">exch_date string comment <span class="string">&#x27;发货日期&#x27;</span>,</span><br><span class="line">exch_type string comment <span class="string">&#x27;邮寄方式&#x27;</span>,</span><br><span class="line">cust_id string comment <span class="string">&#x27;客户 ID &#x27;</span>,</span><br><span class="line">cust_name string comment <span class="string">&#x27;客户名称&#x27;</span>,</span><br><span class="line">d_type string comment <span class="string">&#x27;细分&#x27;</span>,</span><br><span class="line">city string comment <span class="string">&#x27;城市&#x27;</span>, </span><br><span class="line">prov string comment <span class="string">&#x27;省/自治区&#x27;</span>,  </span><br><span class="line">country string comment<span class="string">&#x27;国家&#x27;</span>,</span><br><span class="line">area string comment <span class="string">&#x27;地区&#x27;</span>, </span><br><span class="line">pro_id string comment <span class="string">&#x27;产品 ID&#x27;</span>,  </span><br><span class="line">type1 string comment <span class="string">&#x27;类别&#x27;</span>,</span><br><span class="line">type2 string comment <span class="string">&#x27;子类别&#x27;</span>, </span><br><span class="line">pro_name string comment <span class="string">&#x27;产品名称&#x27;</span>,</span><br><span class="line">sales <span class="type">float</span> comment <span class="string">&#x27;销售额&#x27;</span>,  </span><br><span class="line">count1 <span class="type">int</span> comment <span class="string">&#x27;数量  &#x27;</span>,</span><br><span class="line">discount <span class="type">float</span> comment <span class="string">&#x27;折扣  &#x27;</span>,</span><br><span class="line">profit <span class="type">float</span> comment <span class="string">&#x27;利润&#x27;</span></span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (c_type1 string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="动态分区配置"><a href="#动态分区配置" class="headerlink" title="动态分区配置"></a>动态分区配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">--开启动态分区(默认开启)</span><br><span class="line"><span class="built_in">set</span> hive.exec.dynamic.partition=<span class="literal">true</span></span><br><span class="line">--指定非严格模式 nonstrict模式表示允许所有的分区字段都可以使用动态分区</span><br><span class="line"><span class="built_in">set</span> hive.exec.dynamic.partition.mode=nonstrict</span><br><span class="line">--在所有执行MR的节点上，最大一共可以创建多少个动态分区。默认1000</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.dynamic.partitions=1000</span><br><span class="line">--在每个执行MR的节点上，最大可以创建多少个动态分区(分区字段有多少种设多少个)</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.dynamic.partitions.pernode=100</span><br><span class="line">--整个MR Job中，最大可以创建多少个HDFS文件。默认100000</span><br><span class="line"><span class="built_in">set</span> hive.exec.max.created.files=100000</span><br><span class="line">--当有空分区生成时，是否抛出异常</span><br><span class="line"><span class="built_in">set</span> hive.error.on.empty.partition=<span class="literal">false</span></span><br><span class="line">--打开正则查询模式`(dt|hr)?+.+`</span><br><span class="line"><span class="built_in">set</span> hive.support.quoted.identifiers=none</span><br></pre></td></tr></table></figure>

<h1 id="分桶表"><a href="#分桶表" class="headerlink" title="分桶表"></a>分桶表</h1><ul>
<li><p>分区提供一个隔离数据和优化查询的便利方式。不过，并非所有的数据集都可形成合理的分区。对于一张表或者分区，Hive 可以进一步组织成桶，也就是更为细粒度的数据范围划分。</p>
</li>
<li><p>分桶是将数据集分解成更容易管理的若干部分的另一个技术。</p>
</li>
<li><p>分区<strong>针对的是数据的存储路径</strong>；分桶<strong>针对的是数据文件</strong>。</p>
</li>
</ul>
<h2 id="分桶表注意事项"><a href="#分桶表注意事项" class="headerlink" title="分桶表注意事项"></a><strong>分桶表注意事项</strong></h2><ul>
<li><p><strong>分桶策略</strong></p>
</li>
<li><p><strong>Hive的分桶采用对分桶字段的值进行哈希，然后除以桶的个数求余的方 式决定该条记录存放在哪个桶当中</strong></p>
<p>&#x3D;&#x3D;reduce的个数设置为-1,让Job自行决定需要用多少个reduce或者将reduce的个数设置为大于等于分桶表的桶数&#x3D;&#x3D;</p>
<p>&#x3D;&#x3D;<strong>从hdfs中load数据到分桶表中，避免本地文件找不到问题</strong>&#x3D;&#x3D;</p>
<p>&#x3D;&#x3D;<strong>不要使用本地模式</strong>&#x3D;&#x3D;</p>
</li>
</ul>
<h2 id="hive分桶表-创建分桶表"><a href="#hive分桶表-创建分桶表" class="headerlink" title="hive分桶表-创建分桶表"></a>hive分桶表-创建分桶表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建4个分桶的分桶表</span></span><br><span class="line"><span class="keyword">create table</span> stu_bucket(id <span class="type">int</span>, name string)</span><br><span class="line">clustered <span class="keyword">by</span>(id) </span><br><span class="line"><span class="keyword">into</span> <span class="number">4</span> buckets</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--设置mapreduce数量(二选一)</span></span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces<span class="operator">=</span><span class="number">3</span></span><br><span class="line"> <span class="keyword">set</span> mapred.reduce.tasks<span class="operator">=</span><span class="number">3</span></span><br><span class="line"><span class="comment">--向分桶表导入数据</span></span><br><span class="line">load data inpath   <span class="string">&#x27;/student.txt&#x27;</span> </span><br><span class="line"><span class="keyword">into</span> <span class="keyword">table</span> stu_bucket;</span><br></pre></td></tr></table></figure>

<h2 id="hive排序关键字"><a href="#hive排序关键字" class="headerlink" title="hive排序关键字"></a>hive排序关键字</h2><p><img src="/Hadoop/image-20250701153814791.png" alt="image-20250701153814791"></p>
<hr>
<p>##<strong>hive****排序语句</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--使用order by 排序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 <span class="keyword">order</span> <span class="keyword">by</span> id</span><br><span class="line"><span class="comment">--使用sort by 排序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 sort <span class="keyword">by</span> class_name <span class="keyword">desc</span></span><br><span class="line"><span class="comment">--使用distribute by 分组</span></span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces<span class="operator">=</span><span class="number">15</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 distribute <span class="keyword">by</span> class_name sort <span class="keyword">by</span> id <span class="keyword">desc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite  <span class="keyword">local</span> directory <span class="string">&#x27;/root/student2/&#x27;</span></span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2_b </span><br><span class="line">distribute <span class="keyword">by</span> sex </span><br><span class="line">sort <span class="keyword">by</span> chinese <span class="keyword">desc</span></span><br><span class="line"><span class="comment">--使用cluster by 分组并排序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student2 cluster <span class="keyword">by</span> class_name</span><br></pre></td></tr></table></figure>



<h2 id="使用awk-清洗-log"><a href="#使用awk-清洗-log" class="headerlink" title="使用awk 清洗 log"></a>使用awk 清洗 log</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> 2021-05-20.<span class="built_in">log</span> | awk -F <span class="string">&quot;\&quot;-\&quot;&quot;</span> <span class="string">&#x27;&#123;split($1, arr, &quot; &quot;);\</span></span><br><span class="line"><span class="string">split(substr(arr[4],2),dd,&quot;:&quot;);\</span></span><br><span class="line"><span class="string">split(dd[1],ee,&quot;/&quot;);\</span></span><br><span class="line"><span class="string">print arr[1]&quot;\t&quot;ee[1]&quot;-</span></span><br><span class="line"><span class="string">&quot;ee[2]&quot;-&quot;ee[3]&quot; &quot;dd[2]&quot;:&quot;dd[3]&quot;:&quot;dd[4]&quot;\t&quot;arr[7]&quot;\t&quot;$2&#125;&#x27;</span> | \</span><br><span class="line">awk -F <span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;&quot;date -d \&quot;&quot;$2&quot;\&quot; +%Y%m%d%H%M%S&quot; | getline d;print</span></span><br><span class="line"><span class="string">$1&quot;\t&quot;d&quot;\t&quot;$3&quot;\t&quot;$4 &#125;&#x27;</span> | \</span><br><span class="line">awk -F <span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;print $1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;(index($4,&quot;Windows&quot;)?&quot;Windows&quot;:</span></span><br><span class="line"><span class="string">(index($4,&quot;Linux&quot;)?&quot;Linux&quot;:&quot;Mac&quot;))&quot;\t&quot;(index($4,&quot;Chrome&quot;)?&quot;Chrome&quot;:</span></span><br><span class="line"><span class="string">(index($4,&quot;Version&quot;)?&quot;Safari&quot;:(index($4,&quot;Firefox&quot;)?&quot;Firefox&quot;:&quot;Opera&quot;)))&#125;&#x27;</span> &gt;</span><br><span class="line">new_2021-05-20.log</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io">Yinjin Yao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io/2025/06/27/Hive/">https://cryingatnight.github.io/2025/06/27/Hive/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://cryingatnight.github.io" target="_blank">Yinjin Yao的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hive/">Hive</a><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/Oracle/">Oracle</a></div><div class="post-share"><div class="social-share" data-image="/img/lita9.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/07/hadoop%E9%97%AE%E7%AD%94%E5%B0%8F%E6%B5%8B%E9%AA%8C/" title="hadoop问答小测验"><img class="cover" src="/img/lita7.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">hadoop问答小测验</div></div><div class="info-2"><div class="info-item-1">hadoop问答小测验1. hadoop组件有哪些?分别有什么功能一、核心组件由三个基础组件构成，它们是整个框架的基石：  Hadoop Distributed File System（HDFS）—— 分布式文件系统  功能： 专为存储海量数据设计的分布式文件系统，具有高容错性和高吞吐量。  将大文件分割成固定大小的 “块”（默认 128MB），分散存储在集群的多个节点上，每个块会有多个副本（默认 3 个），确保数据安全。适合处理 “一次写入、多次读取” 的场景，不支持频繁的文件修改（更适合静态数据）。      MapReduce—— 分布式计算框架  功能：    ​		基于 “分而治之” 思想的编程模型，用于并行处理大规模数据。  Map 阶段：将输入数据分割成多个子任务，并行处理后生成中间结果（键值对）。 Reduce 阶段：汇总 Map 阶段的中间结果，合并计算得到最终输出。   YARN（Yet Another Resource Negotiator）—— 资源管理器   功能 ：负责集群资源（CPU、内存等）的统一管理和任务调度，替代了早期 Hadoop 中的 Jo...</div></div></div></a><a class="pagination-related" href="/2025/06/24/Hadoop/" title="Hadoop"><img class="cover" src="/img/lita2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Hadoop</div></div><div class="info-2"><div class="info-item-1">Hadoop简介 Hadoop是一个由Apache基金会所开发的分布式系统基础架构 主要解决，海量数据的存储和海量数据的分析计算问题 广义上来说，Hadoop通常是指一个更广泛的概念-Hadoop生态圈  分布式存储Hadoop 的分布式存储主要基于 HDFS（分布式文件系统）:HDFS将数据分割成多个数据块（block），这些数据块分散存储在集群中的不同节点上。每个数据块会有多个副本，通常默认是 3 个副本.采用分布式存储在不同的节点上，提高了数据的可靠性和容错性。  Hadoop的分布式核心组件是MapReduce编程模型:在MapReduce任务中，数据被切分为多个任务，每个任务由或多个节点并行。每个节点负责将输入数据映射为键-值对生成中间结果。最后，中间结果按照键的排序进行合并和归并。   Hadoop组件(面试重点)hadoop问答小测验 HDFS 架构概述HDFS组件用于存储数据,主要由NameNode,DataNode,SecondaryNameNode 组成  NameNode (nn): 存储文件的元数据，如文件名，文件目录结构，文件属性 (生成时间、副本数、文...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/31/%E5%B7%A5%E4%BD%9C%E6%B5%81-%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5/" title="工作流 定时同步"><img class="cover" src="/img/lita2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-31</div><div class="info-item-2">工作流 定时同步</div></div><div class="info-2"><div class="info-item-1">业务上的 爬虫的 文件的数据 graph LR   数据源-->定时同步;   定时同步-->Hive数仓;  定时同步工具 DataXhttps://github.com/alibaba/DataX 初始化个人开发环境创建开发目录 - 遵循规范 每个人的代码要在自己的目录下去开发 12345678910# 创建个人目录mkdir -p /zhiyun/lijinquancd /zhiyun/lijinquan# 创建5个功能目录# data - 存放数据文件# jobs - 存放datax的配置文件# sql - sql脚本# shell - shell脚本# python - python脚本mkdir data jobs sql shell python 存储的规范和要求按要求每个月存储一份历史数据, 至少保留24个月的版本数据 graph LR    源表-->|DataX|Hive-ODS;    Hive-ODS-->2025-05;    Hive-ODS-->2025-06;    Hive-ODS-->2025-07-当月就覆盖;    Hive-ODS-->2...</div></div></div></a><a class="pagination-related" href="/2025/12/10/Nextcloud%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%81%E7%A7%BB/" title="Nextcloud私有网盘的备份与迁移"><img class="cover" src="/img/lita9.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-10</div><div class="info-item-2">Nextcloud私有网盘的备份与迁移</div></div><div class="info-2"><div class="info-item-1">一、虚拟机环境搭建 本次实践是通过Vmware虚拟机是实现的，  基于CentOS 7 64位系统， 1核1G 20G 网络桥接 使用1panel面版 docker部署的mysql和nextcloud  接下来开始 创建第一台虚拟机打开VMware虚拟机–&gt;新建虚拟机–&gt;典型–&gt;下一步–&gt;选择自己准备好的映像文件（CentOS-7-x86_64-DVD-2009.iso）–&gt;下一步–&gt;自己取名字和位置–&gt;下一步–&gt;20G,将虚拟磁盘拆分为多个文件–&gt;下一步–&gt;自定义硬件–&gt;网络适配器–&gt;桥接模式，复制物理网络连接状态–&gt;完成 编辑–&gt;虚拟网络编辑器–&gt;更改设置–&gt;桥接模式–&gt;以桥接至WiFi–&gt;应用，完成 自己初始化开机用户：root密码：123456  关闭防火墙 1systemctl disable firewalld  编写网络配置 1vi /etc/sysconfig/network-scripts/ifcfg-ens33  ifcfg-ens33文件内容 1234...</div></div></div></a><a class="pagination-related" href="/2025/08/10/datax/" title="datax"><img class="cover" src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-10</div><div class="info-item-2">datax</div></div><div class="info-2"><div class="info-item-1">DataX简介DataX概述DataX 是阿里巴巴开源的一个异构数据源离线同步工具，致力于实现包括关系型数据库(MySQL、Oracle等)、HDFS、Hive、ODPS、HBase、FTP等各种异构数据源之间稳定高效的数据同步功能。 datax源码地址：https://github.com/alibaba/DataX DataX支持的数据源DataX目前已经有了比较全面的插件体系，主流的RDBMS数据库、NOSQL、大数据计算系统都已经接入，目前支持数据如下图。    类型 数据源 Reader(读) Writer(写) 文档    RDBMS 关系型数据库 MySQL √ √ 读 、写    Oracle √ √ 读 、写    OceanBase √ √ 读 、写    SQLServer √ √ 读 、写    PostgreSQL √ √ 读 、写    DRDS √ √ 读 、写    Kingbase √ √ 读 、写    通用RDBMS(支持所有关系型数据库) √ √ 读 、写   阿里云数仓数据存储 ODPS √ √ 读 、写    ADB  √ 写    A...</div></div></div></a><a class="pagination-related" href="/2025/04/28/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/" title="Oracle数据库笔记"><img class="cover" src="/img/lita4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-28</div><div class="info-item-2">Oracle数据库笔记</div></div><div class="info-2"><div class="info-item-1">什么是数据库 数据库（Database，DB）  数据库管理系统（Batabase Management System，DBMS）  结构化查询语言（Structured Query Language，SQL）  关系型数据库（Relational Database，RDB）：目前应用最广泛的数据库。 常见的五种关系型数据库管理系统：①Oracle Database：甲骨文公司②SQL Server：微软公司③DB2：IBM 公司④PostgreSQL：开源⑤MySQL：开源   术语及概念简单介绍 服务器：用于接收并处理其它程序发出的请求的程序（软件），或者是安装此类程序的设备（计算机）。 客户端：向服务器发出请求的程序（软件），或者是安装此类程序的设备（计算机）。 表（table）：类似 Excel，由行和列组成的二维表。行（Row）和列（Column） 字段：表中的列（垂直方向），叫做一个字段 记录：表的行（水平方向），叫做一条记录。【注意】关系数据库必须以行为单位进行数据读写。 单元格：行列交汇处。【注意】与 Excel 不同，一个单元格只能输入一个数据。  SQL是什么...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yinjin Yao</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cryingatnight/cryingatnight.github.io"><i class="fab fa-github"></i><span>关注</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/cryingatnight/cryingatnight.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1816192779@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFHIVE"><span class="toc-text">什么是HIVE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HIVE%E5%AE%89%E8%A3%85"><span class="toc-text">HIVE安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEmysql%E5%AE%89%E8%A3%85%E6%BA%90"><span class="toc-text">配置mysql安装源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85HIVE"><span class="toc-text">安装HIVE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96mapreduce"><span class="toc-text">优化mapreduce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEbeeline"><span class="toc-text">配置beeline</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hive-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E8%AF%AD%E5%8F%A5"><span class="toc-text">hive 数据操作语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE%E6%9F%A5%E7%9C%8B%E8%AF%AD%E5%8F%A5"><span class="toc-text">元数据查看语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-text">建库操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-text">建表操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%95%B0%E6%8D%AE"><span class="toc-text">上传数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="toc-text">下载数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#select%E8%AF%AD%E5%8F%A5"><span class="toc-text">select语句</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hive%E5%A4%8D%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">Hive复合数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hive-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">hive 内置函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#python%E8%BF%9E%E6%8E%A5hive"><span class="toc-text">python连接hive</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85python"><span class="toc-text">linux环境安装python</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">配置环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85pyhive%E5%BA%93"><span class="toc-text">安装pyhive库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-text">分区表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">分区应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle%E5%88%86%E5%8C%BA%E8%A1%A8%E7%A7%8D%E7%B1%BB"><span class="toc-text">oracle分区表种类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle%E5%88%86%E5%8C%BA-%E8%8C%83%E5%9B%B4%E5%88%86%E5%8C%BA"><span class="toc-text">oracle分区-范围分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle%E5%88%86%E5%8C%BA-%E5%88%97%E8%A1%A8%E5%88%86%E5%8C%BA"><span class="toc-text">oracle分区-列表分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle%E5%88%86%E5%8C%BA-%E6%95%A3%E5%88%97%E5%88%86%E5%8C%BA"><span class="toc-text">oracle分区-散列分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle%E5%88%86%E5%8C%BA-%E7%BB%84%E5%90%88%E5%88%86%E5%8C%BA"><span class="toc-text">oracle分区-组合分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle%E5%88%86%E5%8C%BA-%E5%88%86%E5%8C%BA%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-text">oracle分区-分区表操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hive%E5%88%86%E5%8C%BA-%E5%88%9B%E5%BB%BA%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-text">hive分区-创建分区表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hive%E5%88%86%E5%8C%BA-%E5%88%86%E5%8C%BA%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-text">hive分区-分区表操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E5%B8%82%E5%88%86%E5%8C%BA%E8%A1%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">超市分区表示例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA%E9%85%8D%E7%BD%AE"><span class="toc-text">动态分区配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E6%A1%B6%E8%A1%A8"><span class="toc-text">分桶表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%A1%B6%E8%A1%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">分桶表注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hive%E5%88%86%E6%A1%B6%E8%A1%A8-%E5%88%9B%E5%BB%BA%E5%88%86%E6%A1%B6%E8%A1%A8"><span class="toc-text">hive分桶表-创建分桶表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hive%E6%8E%92%E5%BA%8F%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">hive排序关键字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8awk-%E6%B8%85%E6%B4%97-log"><span class="toc-text">使用awk 清洗 log</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/09/CSS3%E6%95%99%E7%A8%8B/" title="CSS3教程"><img src="/img/lita2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSS3教程"/></a><div class="content"><a class="title" href="/2026/02/09/CSS3%E6%95%99%E7%A8%8B/" title="CSS3教程">CSS3教程</a><time datetime="2026-02-06T08:35:41.509Z" title="更新于 2026-02-06 16:35:41">2026-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/06/HTML5%E6%95%99%E7%A8%8B/" title="HTML5教程"><img src="/img/lita6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTML5教程"/></a><div class="content"><a class="title" href="/2026/02/06/HTML5%E6%95%99%E7%A8%8B/" title="HTML5教程">HTML5教程</a><time datetime="2026-02-06T02:12:31.659Z" title="更新于 2026-02-06 10:12:31">2026-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/26/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="数据结构与算法"><img src="/img/lita3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与算法"/></a><div class="content"><a class="title" href="/2026/01/26/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="数据结构与算法">数据结构与算法</a><time datetime="2026-01-26T03:25:02.725Z" title="更新于 2026-01-26 11:25:02">2026-01-26</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 - 2026 By Yinjin Yao</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text">感谢阅读</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="输入以搜索内容..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>