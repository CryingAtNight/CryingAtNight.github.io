<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>docker | Yinjin Yao的博客</title><meta name="author" content="Yinjin Yao"><meta name="copyright" content="Yinjin Yao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="docker介绍 在安装部署程序过程中存在的问题：  版本依赖  典型案例：java环境有很多的jre版本  环境依赖  典型案例：oracle安装需要大量支撑包  安全风险  典型案例：多个应用无法安装一个服务器  性能瓶颈  典型案例：硬件设备扩展困难   什么是虚拟化技术 在计算机技术中，虚拟化是一种资源管理技术，是将计算机的各种实体资源，如服务器，">
<meta property="og:type" content="article">
<meta property="og:title" content="docker">
<meta property="og:url" content="https://cryingatnight.github.io/2025/07/14/docker/index.html">
<meta property="og:site_name" content="Yinjin Yao的博客">
<meta property="og:description" content="docker介绍 在安装部署程序过程中存在的问题：  版本依赖  典型案例：java环境有很多的jre版本  环境依赖  典型案例：oracle安装需要大量支撑包  安全风险  典型案例：多个应用无法安装一个服务器  性能瓶颈  典型案例：硬件设备扩展困难   什么是虚拟化技术 在计算机技术中，虚拟化是一种资源管理技术，是将计算机的各种实体资源，如服务器，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cryingatnight.github.io/img/lita5.jpg">
<meta property="article:published_time" content="2025-07-14T04:00:00.000Z">
<meta property="article:modified_time" content="2025-08-03T10:08:33.588Z">
<meta property="article:author" content="Yinjin Yao">
<meta property="article:tag" content="docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cryingatnight.github.io/img/lita5.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "docker",
  "url": "https://cryingatnight.github.io/2025/07/14/docker/",
  "image": "https://cryingatnight.github.io/img/lita5.jpg",
  "datePublished": "2025-07-14T04:00:00.000Z",
  "dateModified": "2025-08-03T10:08:33.588Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yinjin Yao",
      "url": "https://cryingatnight.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/headimage.png"><link rel="canonical" href="https://cryingatnight.github.io/2025/07/14/docker/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'docker',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> 豆瓣网开发</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> 上不上AI评分系统</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 图标</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/lita5.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/headimage.png" alt="Logo"><span class="site-name">Yinjin Yao的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">docker</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> 豆瓣网开发</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> 上不上AI评分系统</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 图标</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">docker</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-14T04:00:00.000Z" title="发表于 2025-07-14 12:00:00">2025-07-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-03T10:08:33.588Z" title="更新于 2025-08-03 18:08:33">2025-08-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="docker介绍">docker介绍</h1>
<p>在安装部署程序过程中存在的问题：</p>
<ol type="1">
<li>版本依赖
<ul>
<li>典型案例：java环境有很多的jre版本</li>
</ul></li>
<li>环境依赖
<ul>
<li>典型案例：oracle安装需要大量支撑包</li>
</ul></li>
<li>安全风险
<ul>
<li>典型案例：多个应用无法安装一个服务器</li>
</ul></li>
<li>性能瓶颈
<ul>
<li>典型案例：硬件设备扩展困难</li>
</ul></li>
</ol>
<h2 id="什么是虚拟化技术">什么是虚拟化技术</h2>
<p>在计算机技术中，虚拟化<strong>是一种资源管理技术</strong>，是将计算机的各种实体资源，如服务器，网络，内存以及存储等予以抽象转换后呈现出来，<strong>打破实体实体结构间不可切割的障碍</strong>，使用户可以用比原本的组态更好的方式来应用这些资源</p>
<h2 id="docekr容器技术的发展">docekr容器技术的发展</h2>
<ul>
<li>Docker是基于Go语言实现的开原容器项目它诞生于2013年年初.现在主流的操作系统包括引inux各大发行版本，Mac OS,windows等都支持Docker..各大云服务提供商也纷纷推出了基于Docker的服务</li>
<li>Docker的构想是要实现“<strong>Build ship and run any App,Anywhere</strong>’”即通过对应用的封装(packaging),分发(distribution),部署(deploymen).运行(runtime)生命周期进行管理，达到应用组件级别的”<strong>一次封装，到处运行</strong>"的目的</li>
<li>这些应用组件即可以是一个Wb应用，一个编译环境，也可以是套数据库平台服务，甚至是一个操作系统或集群.可以说Dockeri首次为应用的开发，运行和部署提供了“一站式”的实用解决方案</li>
</ul>
<h2 id="docker本质">docker本质</h2>
<p>Docker的诞生基于linux的容器技术(Linux Containers,LXC)</p>
<ul>
<li>容器将应用进行沙盒封装，进行隔离，并独立分配硬件资源。</li>
<li>容器在核心CPU本地运行指令，不需要任何专门的解释机制.</li>
</ul>
<p>Docker在LXC基础上，优化了容器的使用体验</p>
<ul>
<li>Docker指令让用户无须关注底层操作，直接管理和使用容器</li>
<li>Dock通过引入分层文件系统和镜像机制，降低了迁移难度</li>
</ul>
<h2 id="docekr容器技术的优势">docekr容器技术的优势</h2>
<ol type="1">
<li>更快的交付和部署</li>
<li>更高效的资源利用</li>
<li>更轻松的迁移和扩展</li>
<li>良好的隔离性</li>
<li>完整的技术生态</li>
</ol>
<h2 id="docekr容器技术和vmware的比较">docekr容器技术和VMware的比较</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">docker</th>
<th style="text-align: center;">VMware</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">启动</td>
<td style="text-align: center;">秒级</td>
<td style="text-align: center;">分钟级</td>
</tr>
<tr class="even">
<td style="text-align: center;">性能</td>
<td style="text-align: center;">接近宿主机</td>
<td style="text-align: center;">较弱</td>
</tr>
<tr class="odd">
<td style="text-align: center;">资源</td>
<td style="text-align: center;">资源占用小</td>
<td style="text-align: center;">资源占用大</td>
</tr>
<tr class="even">
<td style="text-align: center;">隔离</td>
<td style="text-align: center;">安全隔离</td>
<td style="text-align: center;">完全隔离</td>
</tr>
</tbody>
</table>
<h1 id="docker扩展组件">docker扩展组件</h1>
<ol type="1">
<li><p><strong>Docker Machine</strong></p>
<p>Docker Machine 是 Docker 官方提供的一个命令行工具，用于在<strong>远程虚拟主机上安装和管理</strong> <strong>Docker</strong>。它简化了在不同平台（如虚拟机、云服务等）上部署 Docker 环境的流程，可以快速创建、管理多个虚拟主机上的 Docker 环境，提供了一种便捷的方式来搭建分布式的 Docker 部署环境。</p></li>
<li><p><strong>Docker Swarm</strong></p>
<p>DockerSwarm是Docker官方提供的<strong>容器编排工具</strong>，用于<strong>管理多个Docker主机并将它们组成一个虚拟的容器集群</strong>，实现容器的自动化部署、伸缩和管理。通过 Docker Swarm，用户可以轻松地在多个主机上部署容器应用，并在需要时进行扩展或收缩，实现高可用性和负载均衡。</p></li>
<li><p><strong>Docker Compose</strong></p>
<p>Docker Compose是Docker官方提供的工具，用于<strong>定义和运行多个容器的应用程序</strong>。通过一个简单的YAML文件，可以定义应用程序的服务、网络和卷等配置并使用命令启动、停止、构建和管理整个应用程序的容器。Docker Compose简化了容器化应用程序的部署和管理流程，使开发人员可以更快速地搭建和运行复杂的多容器应用。</p></li>
<li><p><strong>Docker File</strong></p>
<p>Dockerfile是用于<strong>构建Docker镜像的文本文件</strong>，通过Dockerfile可以定义镜像的构建过程和内容。在Dockerfile中可以指定基础镜像、运行命令、复制文件、设置环境变量等操作，最终通过构建命令将Dockerfile转换为可执行的Docker镜像。使用Dockerfile可以实现自动化、可重复的镜像构建过程，帮助开发人员快速、方便地创建定制化的镜像。</p></li>
<li><p><strong>kubernetes</strong></p>
<p>Kubernetes最初是由Google公司发起并开源的<strong>容器编排平台</strong>，用于自动部署、扩展和管理容器化应用程序。它提供了一个高度可扩展的集群管理工具，支持多个容器化应用程序的部署、更新、维护和伸缩。Kubernetes提供了强大的自动化功能，帮助用户简化容器化应用程序的部署和管理，提高应用程序的可靠性和可扩展性。</p></li>
</ol>
<h1 id="docker安装centos">docker安装（CentOS）</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#关闭防火墙</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line"><span class="comment">#关闭selinux</span></span><br><span class="line">vim /etc/selinux/config</span><br><span class="line"><span class="comment"># 将SELINUX=enforcing改为</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.拷贝一份新的阿里云的 下载源 到 /etc/yum.repos.d/下 </span></span><br><span class="line"><span class="built_in">mv</span> /root/CentOS-Base.repo /etc/yum.repos.d/</span><br><span class="line"><span class="comment">#2.清空原下载池</span></span><br><span class="line"><span class="built_in">sudo</span> yum clean all</span><br><span class="line"><span class="comment">#3. 加载新源</span></span><br><span class="line"><span class="built_in">sudo</span> yum makecache</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装工具包</span></span><br><span class="line">yum install -y epel-release</span><br><span class="line"><span class="comment">#安装基础软件</span></span><br><span class="line">yum install -y net-tools rsync vim wget ntp</span><br><span class="line"></span><br><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加阿里yum源</span></span><br><span class="line">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装docker</span></span><br><span class="line">yum -y install docker-ce</span><br><span class="line"></span><br><span class="line"><span class="comment">#启动docker</span></span><br><span class="line">systemctl <span class="built_in">enable</span> --now docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看状态</span></span><br><span class="line">systemctl status docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看本地镜像列表</span></span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line"><span class="comment">#镜像加速</span></span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"><span class="comment">#添加内容</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://dockerhub.icu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.registry.cyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker-cf.registry.cyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://dockercf.jsdelivr.fyi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.jsdelivr.fyi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://dockertest.jsdelivr.fyi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.aliyuncs.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://dockerproxy.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.baidubce.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.m.daocloud.io&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.nju.edu.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.iscas.ac.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://docker.rainbond.cc&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#使文件生效</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#验证 docker 是否安装成功并在容器中执行一个测试的镜像。</span></span><br><span class="line"><span class="built_in">sudo</span> docker run hello-world</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716110709919.png" alt="image-20250716110709919" /><figcaption aria-hidden="true">image-20250716110709919</figcaption>
</figure>
<h2 id="从镜像仓库获取">从镜像仓库获取</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis <span class="comment">#默认最新版本latest</span></span><br><span class="line">docker pull mysql:5.7 <span class="comment">#指定版本</span></span><br><span class="line">docker pull tomcat:9.0.44-jdk8</span><br><span class="line"></span><br><span class="line">docker rmi mysql:5.7 <span class="comment">#删除镜像</span></span><br><span class="line">docker rmi -f mysql:5.7 <span class="comment">#强制删除</span></span><br></pre></td></tr></table></figure>
<h2 id="容器">容器</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看容器列表</span></span><br><span class="line">docker container <span class="built_in">ls</span> -a</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.创建容器</span></span><br><span class="line">docker create  centos </span><br><span class="line"></span><br><span class="line"><span class="comment">#2.创建并启动容器</span></span><br><span class="line">docker run -d tomcat:9.0.44-jdk8</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.生成容器常用参数</span></span><br><span class="line">docker run --name mysql_new -d -p 3306:3306 \</span><br><span class="line">--net mysql-test \</span><br><span class="line">-v /usr/mysql/conf:/etc/my.cnf.d \ </span><br><span class="line">-v /usr/mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">--restart always \</span><br><span class="line">--privileged=<span class="literal">true</span> \</span><br><span class="line">--network-alias mysql \</span><br><span class="line">mysql:5.7</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.进入容器命令</span></span><br><span class="line">docker <span class="built_in">exec</span> -it  mysql_new bash</span><br><span class="line">docker attach mysql_new</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.删除容器</span></span><br><span class="line">docker container <span class="built_in">rm</span> mysql_new</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.启停容器</span></span><br><span class="line">docker container start|stop|restart mysql_new</span><br><span class="line">docker container pause|unpause mysql_new</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.容器文件传输(拷出)</span></span><br><span class="line">docker container <span class="built_in">cp</span> mysql_new:/root/test /root/test</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.导出容器</span></span><br><span class="line">docker container <span class="built_in">export</span>  -o /root/mysql.tar mysql_new</span><br></pre></td></tr></table></figure>
<h2 id="拉取-tomcat-镜像并启动容器">拉取 Tomcat 镜像并启动容器</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum install -y unzip</span><br><span class="line">unzip webroot.zip <span class="comment">#解压应用包</span></span><br><span class="line"></span><br><span class="line">docker pull tomcat:9.0.44-jdk8 <span class="comment">#之前已执行可略过</span></span><br><span class="line"></span><br><span class="line">docker run -d \</span><br><span class="line">--name=fr_tomcat \</span><br><span class="line">-p 8888:8080 \</span><br><span class="line">-v /root/webroot:/usr/local/tomcat/webapps/webroot \</span><br><span class="line">tomcat:9.0.44-jdk8</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716111050408.png" alt="image-20250716111050408" /><figcaption aria-hidden="true">image-20250716111050408</figcaption>
</figure>
<h1 id="docekr使用">docekr使用</h1>
<h2 id="docekr-image">1.docekr image</h2>
<h3 id="镜像获取">镜像获取</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.从镜像仓库获取</span></span><br><span class="line">    docker image pull tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#2.从tar压缩包获取 </span></span><br><span class="line">    docker image load  -i /root/oracle.tar</span><br><span class="line"><span class="comment">#3.从export导出包获取</span></span><br><span class="line">    docker image import mysql_image.tar mysql:5.7</span><br><span class="line"><span class="comment">#4.从dockerFile 文件构建</span></span><br><span class="line">    docker image build -t centos7:7 /root/Dockerfile</span><br><span class="line"><span class="comment">#5.从container容器转化</span></span><br><span class="line">    docker commit mysqlmaster mysql_master:5.7</span><br></pre></td></tr></table></figure>
<h3 id="镜像操作">镜像操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.保存迁移镜像</span></span><br><span class="line">    docker image save  -o /root/tomcat.tar tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#2.删除镜像 </span></span><br><span class="line">    docker image <span class="built_in">rm</span> mysql:5.7</span><br><span class="line"><span class="comment">#3.删除无用镜像</span></span><br><span class="line">    docker image prune</span><br><span class="line"><span class="comment">#4.上传镜像到仓库</span></span><br><span class="line">    docker image push tomcat:9.0.44-jdk8</span><br></pre></td></tr></table></figure>
<h3 id="镜像查看">镜像查看</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.查看镜像列表</span></span><br><span class="line">    docker images <span class="built_in">ls</span></span><br><span class="line"><span class="comment">#2.显示一个或多个映像的详细信息 </span></span><br><span class="line">    docker image inspect mysql:5.7</span><br><span class="line"><span class="comment">#3.到仓库检索镜像</span></span><br><span class="line">    docker  search  mysql</span><br><span class="line"><span class="comment">#4.上传镜像到仓库</span></span><br><span class="line">    docker image push tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#5.查看镜像历史</span></span><br><span class="line">    docker image <span class="built_in">history</span> mysql:5.7</span><br></pre></td></tr></table></figure>
<h3 id="镜像分层结构">镜像分层结构</h3>
<figure>
<img src="image-20250714151231302.png" alt="image-20250714151231302" /><figcaption aria-hidden="true">image-20250714151231302</figcaption>
</figure>
<h2 id="docker-container-容器">2.<strong>Docker container</strong> <strong>容器</strong></h2>
<h2 id="生成容器">生成容器</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.创建容器</span></span><br><span class="line">    docker create  centos  </span><br><span class="line"><span class="comment">#2.创建并启动容器 </span></span><br><span class="line">    docker run -d tomcat:9.0.44-jdk8</span><br><span class="line"><span class="comment">#3.生成容器常用参数</span></span><br><span class="line">docker run --name mysql_new -d -p 3306:3306 \</span><br><span class="line">--net mysql-test \</span><br><span class="line">-v /usr/mysql/conf:/etc/my.cnf.d \</span><br><span class="line">-v /usr/mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">--restart always \</span><br><span class="line">--privileged=<span class="literal">true</span> \</span><br><span class="line">--network-alias mysql \</span><br><span class="line">mysql:5.7</span><br></pre></td></tr></table></figure>
<h3 id="容器操作">容器操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.进入容器命令</span></span><br><span class="line">    docker <span class="built_in">exec</span> -it  mysql_new bash</span><br><span class="line">    docker attach mysql_new</span><br><span class="line"><span class="comment">#2.删除容器 </span></span><br><span class="line">    docker container <span class="built_in">rm</span> mysql_new</span><br><span class="line"><span class="comment">#3.启停容器</span></span><br><span class="line">    docker container start|stop|restart mysql_new</span><br><span class="line">    docker container pause|unpause mysql_new</span><br><span class="line"><span class="comment">#4.容器文件传输(拷出)</span></span><br><span class="line">    docker container <span class="built_in">cp</span> mysql_new:/root/test /root/test</span><br><span class="line"><span class="comment">#5.导出容器</span></span><br><span class="line">    docker container <span class="built_in">export</span>  -o /root/mysql.tar mysql_new</span><br></pre></td></tr></table></figure>
<h3 id="容器查看">容器查看</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.查看容器列表</span></span><br><span class="line">    docker container <span class="built_in">ls</span> -a</span><br><span class="line"><span class="comment">#2.查看容器详情 </span></span><br><span class="line">    docker container inspect mysql_new</span><br><span class="line"><span class="comment">#3.查看容器执行日志</span></span><br><span class="line">    docker container logs mysql_new</span><br><span class="line"><span class="comment">#4.查看容器进程</span></span><br><span class="line">    docker container ps mysql_new</span><br><span class="line">    docker container top mysql_new</span><br><span class="line"><span class="comment">#6.查看容器资源占用</span></span><br><span class="line">    docker container stats</span><br><span class="line"><span class="comment">#5.查看docker 网络\卷</span></span><br><span class="line">    docker network <span class="built_in">ls</span></span><br><span class="line">    docker volume <span class="built_in">ls</span></span><br></pre></td></tr></table></figure>
<h2 id="docker-network网络">docker network网络</h2>
<h3 id="docker端口">docker端口</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.随机暴露容器所有端口(危险)</span></span><br><span class="line">    docker run -P -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#2.将容器指定端口随机映射到宿主机一个端口上 </span></span><br><span class="line">    docker run -P 80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#3.将容器指定端口指定映射到宿主机的一个端口上</span></span><br><span class="line">    docker run -p 8000:80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#4.将容器ip和端口，随机映射到宿主机上</span></span><br><span class="line">    docker run -P 192.168.0.100::80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#5.将容器ip和端口，指定映射到宿主机上</span></span><br><span class="line">    docker run -p 192.168.0.100:8000:80 -it ubuntu /bin/bash</span><br><span class="line"><span class="comment">#6.指定协议</span></span><br><span class="line">    docker run -d -p 8080:80/tcp nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250714151751936.png" alt="image-20250714151751936" /><figcaption aria-hidden="true">image-20250714151751936</figcaption>
</figure>
<h3 id="docker网络">docker网络</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.使用host网络</span></span><br><span class="line">    docker container run --network=host nginx</span><br><span class="line"><span class="comment">#2.使用macvlan 网络 </span></span><br><span class="line">  <span class="comment">#创建:</span></span><br><span class="line">    docker network create -d macvlan --subnet=192.168.10.0/24 \</span><br><span class="line">--gateway=192.168.100.1  -o parent=ens33 mac1</span><br><span class="line">  <span class="comment">#使用:</span></span><br><span class="line">    docker run --ip =192.168.100.2 --network mac1 nginx</span><br><span class="line"><span class="comment">#3.使用自定义桥接网络</span></span><br><span class="line">  <span class="comment">#创建:</span></span><br><span class="line">    docker network create --driver bridge \</span><br><span class="line">--subnet 192.168.10.0/24 --gateway 192.168.10.1 mybridge</span><br><span class="line">  <span class="comment">#使用:</span></span><br><span class="line">    docker run --network=mybridge -d nginx</span><br></pre></td></tr></table></figure>
<h1 id="docker-compose介绍以及应用">docker compose介绍以及应用</h1>
<p>​ Docker Compose 是 Docker 官方推出的工具，用于<strong>定义和运行多容器 Docker 应用</strong>。通过单个 YAML 文件（通常命名为 <code>docker-compose.yml</code>），可以配置应用的服务、网络和卷，一键启动或停止整个应用栈，无需逐个操作容器。 Docker Compose 是管理多容器应用的必备工具，通过 YAML 配置简化部署流程，尤其适合开发和测试环境。对于生产环境，可结合 Kubernetes 等更强大的编排工具。</p>
<h2 id="yaml文件编辑规范">yaml文件编辑规范</h2>
<ul>
<li>第一：YAML是一种标记性语言，类似于json数据描述语言，可读性高；　</li>
<li>第二：YAML数据结构通过缩进来表示，连续项目通过减号表示，键值对用冒号分隔，数组使用中括号<code>[]</code>括起来，bash用花括号<code>&#123;&#125;</code>括起来；　</li>
<li>第三：不支持制表符TAB缩进，只能使用空格缩进；</li>
<li>第四：字符后缩进一个空格(如冒号、逗号、横杠后须加空格)；</li>
<li>第五：使用#号表示注释；</li>
<li>第六：如果包含特殊字符用单引号<code>' '</code> 标记为普通字符,用双引号表示特殊字符本身的意思,布尔值必须使用双引号<code>" "</code>括起来；</li>
<li>第七：YAML 区分大小写；</li>
</ul>
<h2 id="docker-compose-yaml文件指令">docker compose yaml文件指令</h2>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">version：指定此yml文件基于的compose的版本</span></span><br><span class="line"><span class="string">services：指定创建容器的服务选项</span></span><br><span class="line"><span class="comment">#服务名：例如nginx等</span></span><br><span class="line"><span class="attr">network:</span> <span class="string">网络服务创建</span></span><br><span class="line"><span class="attr">volume:</span> <span class="string">数据卷服务创建</span></span><br><span class="line"><span class="string">hostname：容器主机名</span></span><br><span class="line"><span class="string">build</span> <span class="string">：指定构建镜像上下文路径</span></span><br><span class="line"><span class="string">context：上下文路径</span></span><br><span class="line"><span class="string">dockerfile：指定构建镜像的</span> <span class="string">Dockerfile</span> <span class="string">文件名</span></span><br><span class="line"><span class="string">ports：暴露容器端口，与-p相同，但端口不能低于60；例如：-</span> <span class="number">1234</span><span class="string">:80</span></span><br><span class="line"><span class="string">networks：加入顶级networks下配置的网络</span></span><br><span class="line"><span class="string">deploy：指定部署和运行服务相关配置，只能在Swarm模式使用</span></span><br><span class="line"><span class="string">volumes：挂载宿主机路径或命令卷</span></span><br><span class="line"><span class="string">image：指定容器运行的镜像</span></span><br><span class="line"><span class="string">command：执行命令，覆盖默认命令</span></span><br><span class="line"><span class="string">container_name：指定容器名称，由于容器名称是唯一的，如果指定自定义名称，则无法scale（扩展）</span></span><br><span class="line"><span class="string">environment：添加环境变量</span></span><br><span class="line"><span class="string">restart：重启策略，重启策略是no，always，no-failure，unless-stoped</span></span><br><span class="line">		<span class="literal">no</span><span class="string">，默认策略，在容器退出时不重启容器。</span></span><br><span class="line">					<span class="string">on-failure，在容器非正常退出时（退出状态非0），才会重启容器。可加(:3)</span> <span class="string">规定重启次数</span></span><br><span class="line">					<span class="string">always，在容器退出时总是重启容器。</span></span><br><span class="line">		<span class="string">unless-stopped，在容器退出时总是重启容器</span></span><br><span class="line"><span class="string">networks：配置网络，指定网卡设备等</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="compose命令">compose命令</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.创建和启动服务</span></span><br><span class="line">docker compose up</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.删除和停止服务</span></span><br><span class="line">docker compose down</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.服务启动/停止/重启</span></span><br><span class="line">docker compose start/stop/restart</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.指定启动数量</span></span><br><span class="line">docker compose up --scale master=2 --scale slave=2</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.查看日志</span></span><br><span class="line">docker compose logs [ -f 容器名称 --<span class="built_in">tail</span> =50 ]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="mysql主从部署">mysql主从部署</h1>
<h2 id="日志介绍">日志介绍</h2>
<figure>
<img src="image-20250716105104999.png" alt="image-20250716105104999" /><figcaption aria-hidden="true">image-20250716105104999</figcaption>
</figure>
<h3 id="binlog-日志undo-日志redo-日志relay-日志的作用与区别">binlog 日志、undo 日志、redo 日志、relay 日志的作用与区别：</h3>
<p>在 MySQL 主从部署中，以下是几种关键日志的作用及区别：</p>
<h3 id="binlog-日志二进制日志"><strong>binlog 日志（二进制日志）</strong></h3>
<ul>
<li><strong>作用</strong>：记录数据库执行的变更（如 INSERT、UPDATE、DELETE 等），用于主从复制和数据恢复。</li>
<li><strong>主从复制中的角色</strong>：主库将 binlog 发送给从库，从库通过解析 binlog 来同步数据。</li>
<li>特点：
<ul>
<li>逻辑格式（记录 SQL 语句）或二进制格式（记录物理变更）。</li>
<li>可通过<code>log_bin</code>参数启用，日志文件通常位于<code>datadir</code>目录下（如<code>mysql-bin.xxxxxx</code>）。</li>
</ul></li>
</ul>
<h3 id="undo-日志回滚日志"><strong>undo 日志（回滚日志）</strong></h3>
<ul>
<li><strong>作用</strong>：记录事务执行前的数据状态，用于回滚未提交的事务或 MVCC（多版本并发控制）。</li>
<li><strong>主从复制中的角色</strong>：不直接参与复制，仅用于本地事务回滚。</li>
<li>特点：
<ul>
<li>保证事务的原子性（Atomicity）和一致性（Consistency）。</li>
<li>存储在<code>undo tablespace</code>中，可通过<code>innodb_undo_tablespaces</code>参数配置。</li>
</ul></li>
</ul>
<h3 id="redo-日志重做日志"><strong>redo 日志（重做日志）</strong></h3>
<ul>
<li><strong>作用</strong>：记录事务对数据页的物理修改，用于崩溃恢复（保证已提交事务不丢失）。</li>
<li><strong>主从复制中的角色</strong>：不直接参与复制，确保主库数据持久化后才通知从库。</li>
<li>特点：
<ul>
<li>顺序写入，效率高，避免随机 IO。</li>
<li>存储在<code>ib_logfile*</code>文件中，可通过<code>innodb_log_files_in_group</code>和<code>innodb_log_file_size</code>参数配置。</li>
</ul></li>
</ul>
<h3 id="relay-日志中继日志"><strong>relay 日志（中继日志）</strong></h3>
<ul>
<li><strong>作用</strong>：从库用于存储从主库接收的 binlog 事件，供 SQL 线程执行。</li>
<li><strong>主从复制中的角色</strong>：从库 IO 线程将主库的 binlog 写入 relay log，SQL 线程从中读取并执行。</li>
<li>特点：
<ul>
<li>临时存储，执行后可删除。</li>
<li>文件通常位于<code>datadir</code>目录下（如<code>relay-bin.xxxxxx</code>），可通过<code>relay_log</code>参数指定路径。</li>
</ul></li>
</ul>
<h3 id="主从复制流程中的协作"><strong>主从复制流程中的协作</strong></h3>
<ol type="1">
<li><strong>主库</strong>：执行事务 → 写入 binlog → 发送 binlog 到从库。</li>
<li>从库：
<ul>
<li>IO 线程接收 binlog → 写入 relay log。</li>
<li>SQL 线程读取 relay log → 执行 SQL 语句 → 更新数据。</li>
<li>写入 redo/undo 日志保证本地事务的持久性和一致性。</li>
</ul></li>
</ol>
<h3 id="总结对比"><strong>总结对比</strong></h3>
<table>
<thead>
<tr class="header">
<th>日志类型</th>
<th>用途</th>
<th>主从复制中的角色</th>
<th>存储位置</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>binlog</strong></td>
<td>记录变更，用于复制和恢复</td>
<td>主库生成，从库同步</td>
<td>主库<code>mysql-bin.*</code></td>
</tr>
<tr class="even">
<td><strong>undo</strong></td>
<td>回滚事务，支持 MVCC</td>
<td>不参与复制</td>
<td><code>undo tablespace</code></td>
</tr>
<tr class="odd">
<td><strong>redo</strong></td>
<td>崩溃恢复，保证持久化</td>
<td>确保主库数据持久化</td>
<td><code>ib_logfile*</code></td>
</tr>
<tr class="even">
<td><strong>relay</strong></td>
<td>临时存储主库 binlog，供从库执行</td>
<td>从库接收主库 binlog 后生成</td>
<td>从库<code>relay-bin.*</code></td>
</tr>
</tbody>
</table>
<p>合理配置这些日志对主从复制的性能和可靠性至关重要。例如，调整 binlog 格式（<code>binlog_format</code>）、redo 日志大小（<code>innodb_log_file_size</code>）等参数可优化复制效率。</p>
<h2 id="部署">部署</h2>
<figure>
<img src="image-20250716105032843.png" alt="image-20250716105032843" /><figcaption aria-hidden="true">image-20250716105032843</figcaption>
</figure>
<h3 id="docker-compose.yaml">docker-compose.yaml</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2.27&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql_m:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql_m</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">mysql_m</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3336</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./my_m.conf:/etc/mysql/conf.d/my.cnf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_m_volume:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_m_volume:/var/log/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root</span> </span><br><span class="line">  </span><br><span class="line">  <span class="attr">mysql_s:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql_s</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">mysql_s</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3337</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./my_s.conf:/etc/mysql/conf.d/my.cnf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_s_volume:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_s_volume:/var/log/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root</span> </span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">mysql_net:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mysql_net</span></span><br><span class="line">    <span class="attr">ipam:</span></span><br><span class="line">      <span class="attr">driver:</span> <span class="string">default</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">subnet:</span> <span class="number">192.168</span><span class="number">.100</span><span class="number">.0</span><span class="string">/24</span></span><br><span class="line">          <span class="attr">gateway:</span> <span class="number">192.168</span><span class="number">.100</span><span class="number">.1</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql_m_volume:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mysql_m_volume</span></span><br><span class="line">  <span class="attr">mysql_s_volume:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mysql_s_volume</span></span><br></pre></td></tr></table></figure>
<h3 id="修改主服务配置文件my_m.conf">修改主服务配置文件：my_m.conf</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">mysqld</span>]</span><br><span class="line"> <span class="comment">#主服务器唯一ID</span></span><br><span class="line"><span class="string">server_id=1</span></span><br><span class="line"> <span class="comment">#启用二进制日志</span></span><br><span class="line"><span class="string">log-bin=mysql-bin</span></span><br><span class="line"><span class="comment">#上面两行最重要，下面的可以不配置# 设置不要复制的数据库(可设置多个)</span></span><br><span class="line"><span class="string">binlog-ignore-db=mysql</span></span><br><span class="line"><span class="string">binlog-ignore-db=information_schema</span></span><br><span class="line"> <span class="comment">#设置需要复制的数据库 需要复制的主数据库名字</span></span><br><span class="line"><span class="string">binlog-do-db=test</span></span><br><span class="line"> <span class="comment">#设置logbin格式 Row、Statement、Mixed</span></span><br><span class="line"><span class="string">binlog_format=STATEMENT</span></span><br><span class="line"> <span class="comment"># Disabling symbolic-links is recommended to prevent assorted security risks 关闭配置外存储</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="修改从服务配置文件my_s.conf">修改从服务配置文件：my_s.conf</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">mysqld</span>]</span><br><span class="line"><span class="string">server-id=2</span></span><br><span class="line"><span class="string">relay-log=relay-bin</span> <span class="comment">#启用二进制日志</span></span><br><span class="line"><span class="string">log-bin=mysql-bin</span> <span class="comment">#上面两行最重要，下面的可以不配置# 设置不要复制的数据库(可设置多个)</span></span><br><span class="line"><span class="comment"># read_only=1 #从服务器只读</span></span><br><span class="line"><span class="string">slave-skip-errors=</span> <span class="number">1032</span><span class="string">,1062,1007,1050</span> <span class="comment">#忽略报错</span></span><br></pre></td></tr></table></figure>
<h3 id="执行验证">执行验证</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> mysql_service/</span><br><span class="line">docker compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入主机容器</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql_m bash</span><br><span class="line"><span class="comment"># 登录mysql</span></span><br><span class="line">mysql -uroot -proot</span><br><span class="line"></span><br><span class="line">show master status;</span><br><span class="line"><span class="comment"># 出现以下内容说明my_m.conf、my_s.conf配置单已生效</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716110119283.png" alt="image-20250716110119283" /><figcaption aria-hidden="true">image-20250716110119283</figcaption>
</figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个账号（用户名：worker 密码：root）</span></span><br><span class="line">create user <span class="string">&#x27;worker&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="comment"># 给权限</span></span><br><span class="line">grant replication slave,replication client on *.* to <span class="string">&#x27;worker&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="comment"># 建库</span></span><br><span class="line">create database <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要在执行以下配置前再查看一下状态（会变）</span></span><br><span class="line">show master status;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新开一个终端窗口进入从机容器</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql_s bash</span><br><span class="line"><span class="comment"># 登录mysql</span></span><br><span class="line">mysql -uroot -proot</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.登录从服务器配置执行</span></span><br><span class="line">CHANGE MASTER TO MASTER_HOST=<span class="string">&#x27;mysql_m&#x27;</span>,</span><br><span class="line">MASTER_USER=<span class="string">&#x27;worker&#x27;</span>,</span><br><span class="line">MASTER_PASSWORD=<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">MASTER_PORT=3306, </span><br><span class="line">MASTER_LOG_FILE=<span class="string">&#x27;mysql-bin.000001&#x27;</span>,MASTER_LOG_POS=778;</span><br><span class="line"></span><br><span class="line"><span class="comment">#起服务</span></span><br><span class="line">start slave;</span><br><span class="line"><span class="comment">#查看状态</span></span><br><span class="line">show slave status\G;</span><br><span class="line"></span><br><span class="line"><span class="comment">#从机建库不会同步，需要先手动建库</span></span><br><span class="line">create database <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#在主机test库中键一张表</span></span><br><span class="line">use <span class="built_in">test</span>;</span><br><span class="line">create table <span class="built_in">test</span> (<span class="built_in">id</span> int);</span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line"><span class="comment">#在从机中验证，会同步创建该表</span></span><br><span class="line">use <span class="built_in">test</span>;</span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line"><span class="comment">#若之前同步失败，修正后可用以下命令重新同步</span></span><br><span class="line">stop slave;</span><br><span class="line">reset master;</span><br><span class="line">start slave;</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看状态</span></span><br><span class="line">show slave status\G;</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716110205604.png" alt="image-20250716110205604" /><figcaption aria-hidden="true">image-20250716110205604</figcaption>
</figure>
<h1 id="redis">redis</h1>
<h2 id="redis介绍">redis介绍</h2>
<p>​ REmote DIctionary Server(Redis) 是一个由 Salvatore Sanfilippo 写的 <strong>key-value 存储系统</strong>，是跨平台的<strong>非关系型数据库</strong>。</p>
<p>​ Redis 是一个开源的使用 ANSI C 语言编写、遵守 BSD 协议、支持网络、可基于内存、分布式、可选持久性的键值对(Key-Value)存储数据库，并提供多种语言的 API。</p>
<p>​ Redis 通常被称为<strong>数据结构服务器，因为值（value）可以是字符串(String)、哈希(Hash)、列表(list)、集合(sets)和有序集合(sorted sets)等类型</strong>。</p>
<h2 id="redis部署方案介绍">redis部署方案介绍</h2>
<table>
<thead>
<tr class="header">
<th>特性/配置</th>
<th><strong>Redis</strong> <strong>主从复制</strong></th>
<th><strong>Redis</strong> <strong>哨兵</strong></th>
<th><strong>Redis</strong> <strong>集群</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>主要目的</strong></td>
<td>数据备份与读写分离</td>
<td>高可用性和故障自动切换</td>
<td>高并发和数据分散处理</td>
</tr>
<tr class="even">
<td><strong>架构</strong></td>
<td>一个主节点和多个从节点</td>
<td>监控主从结构并自动切换</td>
<td>多个主节点，数据分片</td>
</tr>
<tr class="odd">
<td><strong>数据复制</strong></td>
<td>主节点到从节点</td>
<td>监控并管理主从复制</td>
<td>每个主节点管理自己的数据集</td>
</tr>
<tr class="even">
<td><strong>故障转移机制</strong></td>
<td>手动或哨兵自动切换</td>
<td>自动故障转移</td>
<td>自动处理节点故障</td>
</tr>
<tr class="odd">
<td><strong>可伸缩性</strong></td>
<td>有限，依赖主节点</td>
<td>为主从结构增加高可用性</td>
<td>高，因为数据分布式处理</td>
</tr>
<tr class="even">
<td><strong>使用场景</strong></td>
<td>数据备份和读扩展</td>
<td>关键应用的高可用性</td>
<td>大规模应用的高性能需求</td>
</tr>
<tr class="odd">
<td><strong>设置复杂度</strong></td>
<td>相对简单</td>
<td>中等，需配置哨兵</td>
<td>复杂，需规划数据分区</td>
</tr>
</tbody>
</table>
<h2 id="redis一主两从三哨兵部署方案">redis一主两从三哨兵部署方案</h2>
<figure>
<img src="image-20250716191145724.png" alt="image-20250716191145724" /><figcaption aria-hidden="true">image-20250716191145724</figcaption>
</figure>
<h2 id="部署-1">部署</h2>
<h3 id="配置docker-compose.yaml文件">配置docker-compose.yaml文件</h3>
<ol type="1">
<li><p>创建文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> redis_service</span><br><span class="line">vim redis_service/docker-compose.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis1:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis1</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">redis1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6379</span><span class="string">:6379</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">16379</span><span class="string">:16379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis1/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis1/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-server</span> <span class="string">/etc/conf/redis.conf</span></span><br><span class="line">  <span class="attr">redis2:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis2</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">redis2</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6380</span><span class="string">:6380</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">16380</span><span class="string">:16380</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis2/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis2/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-server</span> <span class="string">/etc/conf/redis.conf</span></span><br><span class="line">  <span class="attr">redis3:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis3</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">redis3</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6381</span><span class="string">:6381</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">16381</span><span class="string">:16381</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis3/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./redis3/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-server</span> <span class="string">/etc/conf/redis.conf</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">sentinel1:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">sentinel1</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">sentinel1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">26379</span><span class="string">:26379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sentinel1/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./setinel1/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-sentinel</span> <span class="string">/etc/conf/sentinel.conf</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">sentinel2:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">sentinel2</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">sentinel2</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">26380</span><span class="string">:26379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sentinel2/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./setinel2/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-sentinel</span> <span class="string">/etc/conf/sentinel.conf</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">sentinel3:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">sentinel3</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">sentinel3</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">26381</span><span class="string">:26379</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sentinel3/conf:/etc/conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./setinel3/data:/data</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="string">redis-sentinel</span> <span class="string">/etc/conf/sentinel.conf</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">redis_net:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">redis_net</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure></li>
<li><p>查看是否创建成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /redis_service</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="redis_master配置文件">redis_master配置文件</h3>
<p>配置文件名redis.conf，在redis1/conf/redis.conf</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">databases</span> <span class="number">10</span> </span><br><span class="line"><span class="string">bind</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">#监听 </span></span><br><span class="line"><span class="string">port</span> <span class="number">6379</span></span><br><span class="line"><span class="comment">#访问密码 </span></span><br><span class="line"><span class="string">requirepass</span> <span class="number">123456</span></span><br><span class="line"><span class="string">masterauth</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#持久化文件路径</span></span><br><span class="line"><span class="string">dir</span> <span class="string">/data</span> </span><br><span class="line"><span class="comment">#持久化文件</span></span><br><span class="line"><span class="string">dbfilename</span> <span class="string">dump.rdb</span></span><br><span class="line"><span class="comment">#启用 RDB 持久化文件的压缩</span></span><br><span class="line"><span class="string">rdbcompression</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment">#如果后台保存出错则停止写入</span></span><br><span class="line"><span class="string">stop-writes-on-bgsave-error</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment">#关闭保护模式</span></span><br><span class="line"><span class="string">protected-mode</span> <span class="literal">no</span></span><br><span class="line"><span class="comment">#在空数据库时进行无盘复制加载</span></span><br><span class="line"><span class="string">repl-diskless-load</span> <span class="string">on-empty-db</span></span><br><span class="line"><span class="comment">#守护进程的方式运行</span></span><br><span class="line"><span class="comment">#daemonize yes</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#持久化策略</span></span><br><span class="line"><span class="comment">#表示如果在 900 秒（15 分钟）内有至少 1 次数据修改操作，则执行一次 RDB 持久化。</span></span><br><span class="line"><span class="string">save</span> <span class="number">900</span> <span class="number">1</span> </span><br><span class="line"><span class="comment">#在 300 秒（5 分钟）内有至少 10 次数据修改操作，就执行一次 RDB 持久化。</span></span><br><span class="line"><span class="string">save</span> <span class="number">300</span> <span class="number">10</span>     </span><br><span class="line"><span class="string">save</span> <span class="number">60</span> <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#日志</span></span><br><span class="line"><span class="string">logfile</span> <span class="string">redis.log</span></span><br></pre></td></tr></table></figure>
<h3 id="redis_slave配置文件">redis_slave配置文件</h3>
<p>redis2和redis3</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例化数据库</span></span><br><span class="line"><span class="string">databases</span> <span class="number">10</span></span><br><span class="line"><span class="string">bind</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> </span><br><span class="line"><span class="comment">#监听</span></span><br><span class="line"><span class="string">port</span> <span class="number">6380</span></span><br><span class="line"><span class="comment">#访问密码和主机密码</span></span><br><span class="line"><span class="string">requirepass</span> <span class="number">123456</span></span><br><span class="line"><span class="string">masterauth</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#持久化文件路径</span></span><br><span class="line"><span class="string">dir</span> <span class="string">/data</span> </span><br><span class="line"><span class="comment">#持久化文件</span></span><br><span class="line"><span class="string">dbfilename</span> <span class="string">dump.rdb</span></span><br><span class="line"><span class="comment">#指定本地数据存储压缩</span></span><br><span class="line"><span class="string">rdbcompression</span> <span class="literal">yes</span></span><br><span class="line"><span class="string">stop-writes-on-bgsave-error</span> <span class="literal">yes</span></span><br><span class="line"><span class="string">protected-mode</span> <span class="literal">no</span></span><br><span class="line"><span class="string">repl-diskless-load</span> <span class="string">on-empty-db</span></span><br><span class="line"><span class="comment">#daemonize yes</span></span><br><span class="line"><span class="comment">#protected-mode</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#持久化策略</span></span><br><span class="line"><span class="string">save</span> <span class="number">900</span> <span class="number">1</span></span><br><span class="line"><span class="string">save</span> <span class="number">300</span> <span class="number">10</span></span><br><span class="line"><span class="string">save</span> <span class="number">60</span> <span class="number">10000</span></span><br><span class="line"><span class="comment">#日志路径</span></span><br><span class="line"><span class="string">logfile</span> <span class="string">redis.log</span></span><br><span class="line"><span class="string">replicaof</span> <span class="string">redis1</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure>
<h3 id="sentinel配置文件">sentinel配置文件</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#vim /usr/local/redis/etc/sentinel.conf</span></span><br><span class="line"> <span class="comment">#操作端口</span></span><br><span class="line"> <span class="comment">#绑定所有网络接口</span></span><br><span class="line"><span class="string">bind</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">#哨兵服务监听的端口。</span></span><br><span class="line"><span class="string">port</span> <span class="number">26379</span></span><br><span class="line"><span class="comment">#指定进程 ID 文件的路径</span></span><br><span class="line"><span class="string">pidfile</span> <span class="string">&quot;/data/redis-sentinel.pid&quot;</span></span><br><span class="line"><span class="comment">#工作目录</span></span><br><span class="line"><span class="string">dir</span> <span class="string">&quot;/tmp&quot;</span> </span><br><span class="line"><span class="comment">#设置访问哨兵的密码</span></span><br><span class="line"><span class="string">requirepass</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#docker必关 不以后台进程方式运行</span></span><br><span class="line"><span class="string">daemonize</span> <span class="literal">no</span> </span><br><span class="line"><span class="comment">#关闭保护模式</span></span><br><span class="line"><span class="string">protected-mode</span> <span class="literal">no</span> </span><br><span class="line"><span class="comment">#指定日志文件路径</span></span><br><span class="line"><span class="string">logfile</span> <span class="string">&quot;/data/redis-sentinel.log&quot;</span></span><br><span class="line"><span class="comment">#启用主机名解析</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">resolve-hostnames</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment">#监控名为redisMaster的主节点，节点名为redis1，端口为 6379，需要至少 2 个哨兵</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">monitor</span> <span class="string">redisMaster</span> <span class="string">redis1</span> <span class="number">6379 </span><span class="number">2</span></span><br><span class="line"><span class="comment">#该主节点的认证密码</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">auth-pass</span> <span class="string">redisMaster</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#在指定毫秒数后认为该主节点主观下线。</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">down-after-milliseconds</span> <span class="string">redisMaster</span> <span class="number">100</span> </span><br><span class="line"><span class="comment">#故障转移时同时同步的从节点数量为 1 个</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">parallel-syncs</span> <span class="string">redisMaster</span> <span class="number">1</span></span><br><span class="line"><span class="comment">#故障转移超时时间</span></span><br><span class="line"><span class="string">sentinel</span> <span class="string">failover-timeout</span> <span class="string">redisMaster</span> <span class="number">600</span> </span><br></pre></td></tr></table></figure>
<h2 id="验证">验证</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> redis_service</span><br><span class="line">docker compose down </span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716193050241.png" alt="image-20250716193050241" /><figcaption aria-hidden="true">image-20250716193050241</figcaption>
</figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container <span class="built_in">ls</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716194121868.png" alt="image-20250716194121868" /><figcaption aria-hidden="true">image-20250716194121868</figcaption>
</figure>
<ol type="1">
<li>查看从机</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# docker <span class="built_in">exec</span> -it redis1 redis-cli -p 6379</span><br><span class="line">127.0.0.1:6380&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716194621403.png" alt="image-20250716194621403" /><figcaption aria-hidden="true">image-20250716194621403</figcaption>
</figure>
<ol start="2" type="1">
<li>查看从机</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# docker <span class="built_in">exec</span> -it redis2 redis-cli -p 6380</span><br><span class="line">127.0.0.1:6380&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716195916911.png" alt="image-20250716195916911" /><figcaption aria-hidden="true">image-20250716195916911</figcaption>
</figure>
<ol start="3" type="1">
<li>查看哨兵</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 redis_service]# docker <span class="built_in">exec</span> -it sentinel1 redis-cli -p 26379 </span><br><span class="line">127.0.0.1:26379&gt; info</span><br><span class="line">NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:26379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:26379&gt; info</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716195114095.png" alt="image-20250716195114095" /><figcaption aria-hidden="true">image-20250716195114095</figcaption>
</figure>
<ol start="4" type="1">
<li>人为停掉一个redis</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker container redis1 stop</span><br><span class="line"><span class="comment"># 再次查看哨兵</span></span><br><span class="line">[root@CentOS7 redis_service]# docker <span class="built_in">exec</span> -it sentinel1 redis-cli -p 26379 </span><br><span class="line">127.0.0.1:26379&gt; info</span><br><span class="line">NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:26379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:26379&gt; info</span><br></pre></td></tr></table></figure>
<figure>
<img src="image-20250716200102571.png" alt="image-20250716200102571" /><figcaption aria-hidden="true">image-20250716200102571</figcaption>
</figure>
<h1 id="kubernetes介绍以及应用">kubernetes介绍以及应用</h1>
<ul>
<li><p>Kubernetes（简称k8s）是一个<strong>开源的容器编排平台</strong>，用于<strong>自动化部署、扩展和管理容器化应用</strong>。</p></li>
<li><p>它的核心功能包括<strong>自动化容器部署、负载均衡、自我修复、存储编排以及跨集群资源管理</strong>。</p></li>
<li><p>通过Kubernetes，企业能够高效管理大规模的容器化应用，确保应用的高可用性和弹性扩展。</p></li>
</ul>
<p>核心功能：</p>
<ol type="1">
<li><strong>自动调度</strong>：将容器放到K8S集群的任意节点中，并根据容器需要和节点负载决定目标节点。</li>
<li><strong>自动修复</strong>：当健康检查发现节点问题，系统会自动将节点上的资源进行转移，并恢复功能。</li>
<li><strong>自动缩扩容</strong>：通过预定义负载指标，根据指标自动触发动态缩扩容行为。</li>
</ol>
<h3 id="架构">架构</h3>
<h4 id="master">Master</h4>
<p>Master为控制节点，负责整个集群的管理控制。</p>
<p>Master节点由：APIserver、ETCD 、controller Manager、schedule等组件构成。</p>
<h4 id="node">Node</h4>
<p>Node的作用是承接工作负载。</p>
<p>Node节点有由：kubelet、rumtime、kube-proxy组成。</p>
<figure>
<img src="image-20250717202918467.png" alt="image-20250717202918467" /><figcaption aria-hidden="true">image-20250717202918467</figcaption>
</figure>
<p>客户端：Kubectl、UI：负责给API-Server发送指令。</p>
<p>API-Server：接受指令，K8s集群的核心，是集群的API入口。它负责处理来自各种客户端的REST API请求资源并对其进行验证、授权，并将有效的请求持久化到etcd数据库。</p>
<p>ETCD：分布式键值存储系统，用于保存Kubernetes集群的所有配置数据和状态信息。它存储了集群中的各种资源对象的元数据。</p>
<p>Scheduler：负责将未调度的Pods分配到合适的Node节点上运行。它根据一系列的调度算法和策略来进行决策。</p>
<p>Controller-Manager、controller：运行着一系列的控制器，这些控制器负责维护集群的状态。Controller-Manager负责容器数量。controller保证运行状态。</p>
<p>Kubelet：负责与kube-api通信，获取节点的Pods的信息,管理其生命周期,并按照Pod的定义创建、启停监控容器的运行状态等。并将状态上报给controller。</p>
<p>Kube-proxy：主要负责实现K8s Service的网络代理功能.它在每个Node节点上运行，维护网络规则，将对Service的请求转发到对应的Pod上。</p>
<p>RunTime：负责k8s中的资源隔离,确保每个容器有独立的网络,文件系统,进程空间从而避免相互干扰。</p>
<p>Pod：Pod是最小的可部署和可管理的计算单元。容器在同一主机上可以相互通信。多个容器封装成一个Pod，一般一个容器只放一个应用，为了让服务高可用，需要多个容器，满足使用需求，所以用Pod</p>
<p>打包多个容器统一管理。</p>
<p>Container：用于将应用程序以及所有依赖打包在一起,确保所有程序运行环境相同。</p>
<h3 id="资源">资源</h3>
<h4 id="namespace">Namespace</h4>
<h5 id="工作负载类负责接受客户访问请求返回客户需要的数据">工作负载类：负责接受客户访问请求，返回客户需要的数据</h5>
<p>Pod、Deployment、ReplicaSet、StatefulSet、DaemonSet、Job、CronJob</p>
<h5 id="网络类">网络类</h5>
<p>Service、Ingress、NetworkPolicy</p>
<h5 id="储存类">储存类</h5>
<p>Volume、PersistentVolume (PV)、Persistent VolumeClaim (PVC)</p>
<h5 id="配置类">配置类</h5>
<p>ConfigMap、Secret</p>
<h5 id="安全类">安全类</h5>
<h5 id="扩展类">扩展类</h5>
<h5 id="自动缩扩容类">自动缩扩容类</h5>
<h5 id="层级关系">层级关系</h5>
<figure>
<img src="image-20250717203132808.png" alt="image-20250717203132808" /><figcaption aria-hidden="true">image-20250717203132808</figcaption>
</figure>
<p>pod：最小的部署单元，包含一个或多个容器。</p>
<p>Deployment：管理Pod的副本和滚动更新策略。</p>
<p>replicaSet：确保指定数量的Pod副本运行（Deployment的底层实现）。</p>
<p>DaemonSet：管理有状态应用的Pod，提供有序部署和唯一网络标识。</p>
<p>StatefulSet：确保每个节点运行一个Pod的副本。</p>
<p>Service：为Pod提供稳定的网络访问（如负载均衡、服务发现）</p>
<p>Ingress：管理外部访问集群内服务的路由规则（如 HTTP/HTTPS 路由）。</p>
<p>Secret：存储敏感数据（如密码、Token），以 Base64 编码存储非敏感的配置数据（如环境变量、配置文件）。</p>
<p>Job/CronJob：运行一次性任务，任务完成后 Pod 终止定时运行的 Job。</p>
<p>PV：集群中的持久化存储资源。</p>
<p>PVC：用户对存储资源的请求声明，绑定到 PV。</p>
<h2 id="kubernetes-集群信息查看">kubernetes-集群信息查看</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods <span class="comment"># 查看所有 Pod</span></span><br><span class="line"></span><br><span class="line">kubectl get deployments <span class="comment"># 查看所有 Deployment</span></span><br><span class="line"></span><br><span class="line">kubectl get services <span class="comment"># 查看所有 Service</span></span><br><span class="line"></span><br><span class="line">kubectl get pvc <span class="comment"># 查看所有 PVC</span></span><br><span class="line"></span><br><span class="line">kubectl get nodes <span class="comment"># 查看所有 Node</span></span><br><span class="line"></span><br><span class="line">kubectl get namespaces <span class="comment"># 查看所有命名空间</span></span><br><span class="line"></span><br><span class="line">kubectl get configmap &lt;name&gt; -o yaml <span class="comment"># 查看 ConfigMap 内容</span></span><br><span class="line"></span><br><span class="line">kubectl logs &lt;pod-name&gt;	<span class="comment"># 查看 Pod 日志</span></span><br></pre></td></tr></table></figure>
<h2 id="kubernetes-资源创建命">kubernetes-资源创建命</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1. 创建 Pod</span></span><br><span class="line">kubectl create deployment my-pod --image=nginx</span><br><span class="line"><span class="comment">#2. 创建 Deployment</span></span><br><span class="line">kubectl create deployment my-deployment --image=nginx --replicas=3</span><br><span class="line"><span class="comment">#3. 创建 Service</span></span><br><span class="line">kubectl create service clusterip my-service --tcp=80:8080</span><br><span class="line"><span class="comment">#4. 创建 ConfigMap</span></span><br><span class="line">kubectl create configmap my-config --from-literal=key1=value1 --from-literal=key2=value2</span><br><span class="line"><span class="comment">#5. 创建 Secret</span></span><br><span class="line">kubectl create secret generic my-secret --from-literal=username=admin --from-literal=password=secret</span><br><span class="line"><span class="comment">#6. 创建 Namespace</span></span><br><span class="line">kubectl create namespace my-namespace</span><br></pre></td></tr></table></figure>
<h2 id="kubernetes-pod信息查看">kubernetes-Pod信息查看</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. 列出特定命名空间中的 pod：</span><br><span class="line">kubectl get pods -n &lt;namespace&gt;</span><br><span class="line">2. 查看一个 Pod 详情：</span><br><span class="line">kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;</span><br><span class="line">3. 查看 Pod 日志：</span><br><span class="line">kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt;</span><br><span class="line">4. 尾部 Pod 日志：</span><br><span class="line">kubectl logs -f &lt;pod-name&gt; -n &lt;namespace&gt;</span><br><span class="line">5. 在 pod 中执行命令：</span><br><span class="line">kubectl <span class="built_in">exec</span> -it &lt;pod-name&gt; -n &lt;namespace&gt; -- &lt;<span class="built_in">command</span>&gt;	</span><br></pre></td></tr></table></figure>
<h2 id="kubernetes-deploymen信息">kubernetes-deploymen信息</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 列出命名空间中的所有Deployment：kubectl get deployments -n &lt;namespace&gt;</span><br><span class="line">2. 查看一个Deployment详情：kubectl describe deployment &lt;deployment-name&gt; -n &lt;namespace&gt;</span><br><span class="line">3. 查看滚动发布状态：kubectl rollout status deployment/&lt;deployment-name&gt; -n &lt;namespace&gt;</span><br><span class="line">4. 查看滚动发布历史记录：kubectl rollout <span class="built_in">history</span> deployment/&lt;deployment-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>
<h2 id="kubernetes-label指令">kubernetes-label指令</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 给名为foo的Pod添加label unhealthy=true</span></span><br><span class="line">$ kubectl label pods foo unhealthy=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给名为foo的Pod修改label 为 &#x27;status&#x27; value &#x27;unhealthy&#x27;，且覆盖现有的value</span></span><br><span class="line">$ kubectl label --overwrite pods foo status=unhealthy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给 namespace 中的所有 pod 添加 label</span></span><br><span class="line">$ kubectl label  pods --all status=unhealthy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仅当resource-version=1时才更新 名为foo的Pod上的label</span></span><br><span class="line">$ kubectl label pods foo status=unhealthy --resource-version=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除名为“bar”的label 。（使用“ - ”减号相连）</span></span><br><span class="line">$ kubectl label pods foo bar-</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="kubernetes-基础指令">kubernetes-基础指令</h2>
<p><strong>create，delete，get，run，expose，set，explain，edit</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建Deployment和Service资源</span></span><br><span class="line">$ kubectl create -f demo-deployment.yaml</span><br><span class="line">$ kubectl create -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据yaml文件删除对应的资源，但是yaml文件并不会被删除，这样更加高效</span></span><br><span class="line">$ kubectl delete -f demo-deployment.yaml </span><br><span class="line">$ kubectl delete -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以通过具体的资源名称来进行删除，使用这个删除资源，同时删除deployment和service资源</span></span><br><span class="line">$ kubectl delete 具体的资源名称</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="kubernetes-基础指令-1">kubernetes-基础指令</h2>
<p><strong>https://kubernetes.io/zh-cn/docs/reference/kubectl/quick-reference/</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建Deployment和Service资源</span></span><br><span class="line">$ kubectl create -f demo-deployment.yaml</span><br><span class="line">$ kubectl create -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据yaml文件删除对应的资源，但是yaml文件并不会被删除，这样更加高效</span></span><br><span class="line">$ kubectl delete -f demo-deployment.yaml </span><br><span class="line">$ kubectl delete -f demo-service.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以通过具体的资源名称来进行删除，使用这个删除资源，同时删除deployment和service资源</span></span><br><span class="line">$ kubectl delete 具体的资源名称</span><br></pre></td></tr></table></figure>
<h1 id="nginx反向代理">Nginx反向代理</h1>
<h2 id="代理服务器">代理服务器</h2>
<figure>
<img src="image-20250717203940718.png" alt="image-20250717203940718" /><figcaption aria-hidden="true">image-20250717203940718</figcaption>
</figure>
<h3 id="代理服务器功能">代理服务器功能</h3>
<p>1.隐藏客户端身份： 正向代理可以隐藏客户端的真实IP地址，保护客户端的隐私。</p>
<p>2.访问控制： 正向代理可以根据一定的规则限制或允许客户端的访问请求，实现访问控制功能。</p>
<p>3.缓存加速： 正向代理可以缓存经常访问的页面或资源，提高访问速度，减轻服务器负担。</p>
<h3 id="目的">目的</h3>
<p>1.突破网络限制</p>
<p>2.监控和管理员工的网络访问行为</p>
<p>3.隐藏客户端真实IP</p>
<p>4.防止敏感数据泄露</p>
<p>5.内容过滤</p>
<p>6.提高访问速度</p>
<h2 id="反向代理">反向代理</h2>
<figure>
<img src="image-20250717204042655.png" alt="image-20250717204042655" /><figcaption aria-hidden="true">image-20250717204042655</figcaption>
</figure>
<h3 id="作用">作用</h3>
<p>1.负载均衡： 反向代理可以根据后端服务器的负载情况，将请求分发到不同的服务器上，提高系统的整体性能。</p>
<p>2.安全性增强：隐藏后端服务器的真实地址和端口，防止直接攻击。同时，还可以实现SSL加密、访问控制等安全功能。</p>
<p>3.缓存优化：可以缓存静态资源，减少后端服务器的负载，提高响应速度。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io">Yinjin Yao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io/2025/07/14/docker/">https://cryingatnight.github.io/2025/07/14/docker/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://cryingatnight.github.io" target="_blank">Yinjin Yao的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/docker/">docker</a></div><div class="post-share"><div class="social-share" data-image="/img/lita5.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/20/Hexo%20and%20Typora/" title="Hexo and Typora: 完美的写作组合"><img class="cover" src="/img/lita6.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hexo and Typora: 完美的写作组合</div></div><div class="info-2"><div class="info-item-1">github + Hexo + Typora 博客创建 参考教程 从0开始到部署到github  hexo史上最全搭建教程 文档 | Hexo Hexo + Typora + 开发Hexo插件 解决图片路径不一致 图片插件开源地址 本文大部分内容出处  基本步骤 1. 安装git 2. 安装nodejs 3. 安装hexo 前面git和nodejs安装好后，就可以安装hexo了，你可以先创建一个文件夹Blog，然后cd到这个文件夹下（或者在这个文件夹下直接右键git bash打开）。 输入命令安装： 1npm install -g hexo-cli 查看版本命令：hexo -v 初始化hexo 1hexo init myblog 这个myblog可以自己取什么名字都行，会在当前文件夹（Blog）目录下创建一个myblog文件夹 12cd myblog #进入这个myblog文件夹npm install 新建完成后，指定文件夹目录下有： 12345678910111213YaoYinjin@LAPTOP-3VRKRFG2 MINGW64...</div></div></div></a><a class="pagination-related" href="/2025/07/07/hadoop%E9%97%AE%E7%AD%94%E5%B0%8F%E6%B5%8B%E9%AA%8C/" title="hadoop问答小测验"><img class="cover" src="/img/lita2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">hadoop问答小测验</div></div><div class="info-2"><div class="info-item-1">hadoop问答小测验 ## 1. hadoop组件有哪些?分别有什么功能 ### 一、核心组件 由三个基础组件构成，它们是整个框架的基石：  Hadoop Distributed File System（HDFS）—— 分布式文件系统  功能：  专为存储海量数据设计的分布式文件系统，具有高容错性和高吞吐量。 将大文件分割成固定大小的 “块”（默认 128MB），分散存储在集群的多个节点上，每个块会有多个副本（默认 3 个），确保数据安全。 适合处理 “一次写入、多次读取” 的场景，不支持频繁的文件修改（更适合静态数据）。   MapReduce—— 分布式计算框架  功能：   ​ 基于 “分而治之” 思想的编程模型，用于并行处理大规模数据。  Map 阶段：将输入数据分割成多个子任务，并行处理后生成中间结果（键值对）。 Reduce 阶段：汇总 Map 阶段的中间结果，合并计算得到最终输出。   YARN（Yet Another Resource Negotiator）—— 资源管理器   功能 ： 负责集群资源（CPU、...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/08/07/docker-compose/" title="docker-compose"><img class="cover" src="/img/lita5.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-07</div><div class="info-item-2">docker-compose</div></div><div class="info-2"><div class="info-item-1">官方文档 本文参考《docker-compose教程（安装，使用, 快速入门）》 # Compose介绍 Docker Compose是一个用来定义和运行复杂应用的Docker工具。一个使用Docker容器的应用，通常由多个容器组成。使用Docker Compose不再需要使用shell脚本来启动容器。 Compose 通过一个配置文件来管理多个Docker容器，在配置文件中，所有的容器通过services来定义，然后使用docker-compose脚本来启动，停止和重启应用，和应用中的服务以及所有依赖服务的容器，非常适合组合使用多个容器进行开发的场景。 查看是否安装 12docker compose versiondocker compose  docker-compose文件结构和示例 docker-compose文件结构 docker-compose.yaml: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455...</div></div></div></a><a class="pagination-related" href="/2025/08/07/docker%E5%85%A5%E9%97%A8/" title="docekr入门"><img class="cover" src="/img/lita4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-07</div><div class="info-item-2">docekr入门</div></div><div class="info-2"><div class="info-item-1">本文大部分参考《docekr入门,这一篇就够了》 # docekr背景介绍 ## 什么是docekr Docker是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可抑制的容器中，然后发布到任何流行的Linux机器上，也可以实现虚拟化。容器完全使用沙盒机制，相互之间不会存在任何接口。几乎没有性能开销，可以很容易的在机器和数据中心运行。最重要的是，他们不依赖于任何语言、框架或者包装系统。 小知识：沙盒也叫沙箱（sandbox）。在计算机领域指一种虚拟技术，而且多用于计算机安全技术。安全软件可以让它在沙盒中运行，如果含有恶意行为，则禁止程序的进一步运行，而这不会对系统造成任何危害。 官网：https://www.docker.com/ Docker容器技术与虚拟机的区别 Docker 容器技术和虚拟机（VM）都是实现资源隔离和环境一致性的技术，但它们的底层实现和特性有显著区别，主要体现在架构、性能、启动速度等方面。以下是两者的核心区别： 1. 架构原理  虚拟机（VM）： 基于硬件虚拟化，需要在宿主机（Host）上安装Hypervisor（如 VMwa...</div></div></div></a><a class="pagination-related" href="/2025/08/17/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E4%BD%BF%E7%94%A8astrbot%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8deepseek%E6%A8%A1%E5%9E%8B%E7%9A%84QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/" title="手把手教你使用astrbot搭建使用deepseek模型的QQ机器人"><img class="cover" src="/img/lita9.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-17</div><div class="info-item-2">手把手教你使用astrbot搭建使用deepseek模型的QQ机器人</div></div><div class="info-2"><div class="info-item-1">旧博客地址：《使用astrbot搭建使用deepseek模型的QQ机器人》 #### astrbot官网 # 什么是 AstrBot？ - AstrBot 是一个易于上手的多平台聊天机器人及开发框架。通过它，你能够在多种消息平台上部署一个支持大语言模型（LLM）的聊天机器人。并以此实现但不限于 AI 知识库问答、角色扮演、群聊管理、LLM Agent 等功能。它有如下特性  松耦合：AstrBot 历经 3 次大代码重构。每一次都在向着松耦合、模块化的方向迈进。目前，AstrBot 采用了事件总线和消息事件流水线的架构设计，实现近乎完全的模块化。 异步：AstrBot 采用了异步编程模型，使得 AstrBot 在处理多个消息平台的消息时，能够更加高效。 多消息平台部署：AstrBot 默认支持接入 QQ、QQ频道、微信。通过插件，还可以接入 Telegram 等任何消息平台。 完善的插件系统：AstrBot 提供了完善、及其易于上手的插件系统，你可以通过插件实现自己的功能。开发一个插件，只需要几行代码。  它是如何实现的？ 下面的拓扑图简述了 AstrBot 与插...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yinjin Yao</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cryingatnight/cryingatnight.github.io"><i class="fab fa-github"></i><span>关注</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/cryingatnight/cryingatnight.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1816192779@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">docker介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF"><span class="toc-number">1.1.</span> <span class="toc-text">什么是虚拟化技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docekr%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E7%9A%84%E5%8F%91%E5%B1%95"><span class="toc-number">1.2.</span> <span class="toc-text">docekr容器技术的发展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E6%9C%AC%E8%B4%A8"><span class="toc-number">1.3.</span> <span class="toc-text">docker本质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docekr%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">1.4.</span> <span class="toc-text">docekr容器技术的优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docekr%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E5%92%8Cvmware%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">1.5.</span> <span class="toc-text">docekr容器技术和VMware的比较</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E6%89%A9%E5%B1%95%E7%BB%84%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">docker扩展组件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E5%AE%89%E8%A3%85centos"><span class="toc-number">3.</span> <span class="toc-text">docker安装（CentOS）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E8%8E%B7%E5%8F%96"><span class="toc-number">3.1.</span> <span class="toc-text">从镜像仓库获取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8"><span class="toc-number">3.2.</span> <span class="toc-text">容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%89%E5%8F%96-tomcat-%E9%95%9C%E5%83%8F%E5%B9%B6%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-number">3.3.</span> <span class="toc-text">拉取 Tomcat 镜像并启动容器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docekr%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">docekr使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docekr-image"><span class="toc-number">4.1.</span> <span class="toc-text">1.docekr image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E8%8E%B7%E5%8F%96"><span class="toc-number">4.1.1.</span> <span class="toc-text">镜像获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%93%8D%E4%BD%9C"><span class="toc-number">4.1.2.</span> <span class="toc-text">镜像操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%9F%A5%E7%9C%8B"><span class="toc-number">4.1.3.</span> <span class="toc-text">镜像查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%88%86%E5%B1%82%E7%BB%93%E6%9E%84"><span class="toc-number">4.1.4.</span> <span class="toc-text">镜像分层结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-container-%E5%AE%B9%E5%99%A8"><span class="toc-number">4.2.</span> <span class="toc-text">2.Docker container 容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%AE%B9%E5%99%A8"><span class="toc-number">4.3.</span> <span class="toc-text">生成容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.1.</span> <span class="toc-text">容器操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E6%9F%A5%E7%9C%8B"><span class="toc-number">4.3.2.</span> <span class="toc-text">容器查看</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-network%E7%BD%91%E7%BB%9C"><span class="toc-number">4.4.</span> <span class="toc-text">docker network网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker%E7%AB%AF%E5%8F%A3"><span class="toc-number">4.4.1.</span> <span class="toc-text">docker端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker%E7%BD%91%E7%BB%9C"><span class="toc-number">4.4.2.</span> <span class="toc-text">docker网络</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-compose%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%BA%94%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">docker compose介绍以及应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E8%A7%84%E8%8C%83"><span class="toc-number">5.1.</span> <span class="toc-text">yaml文件编辑规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-compose-yaml%E6%96%87%E4%BB%B6%E6%8C%87%E4%BB%A4"><span class="toc-number">5.2.</span> <span class="toc-text">docker compose yaml文件指令</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#compose%E5%91%BD%E4%BB%A4"><span class="toc-number">6.</span> <span class="toc-text">compose命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql%E4%B8%BB%E4%BB%8E%E9%83%A8%E7%BD%B2"><span class="toc-number">7.</span> <span class="toc-text">mysql主从部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.1.</span> <span class="toc-text">日志介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#binlog-%E6%97%A5%E5%BF%97undo-%E6%97%A5%E5%BF%97redo-%E6%97%A5%E5%BF%97relay-%E6%97%A5%E5%BF%97%E7%9A%84%E4%BD%9C%E7%94%A8%E4%B8%8E%E5%8C%BA%E5%88%AB"><span class="toc-number">7.1.1.</span> <span class="toc-text">binlog 日志、undo 日志、redo 日志、relay 日志的作用与区别：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#binlog-%E6%97%A5%E5%BF%97%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97"><span class="toc-number">7.1.2.</span> <span class="toc-text">binlog 日志（二进制日志）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undo-%E6%97%A5%E5%BF%97%E5%9B%9E%E6%BB%9A%E6%97%A5%E5%BF%97"><span class="toc-number">7.1.3.</span> <span class="toc-text">undo 日志（回滚日志）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redo-%E6%97%A5%E5%BF%97%E9%87%8D%E5%81%9A%E6%97%A5%E5%BF%97"><span class="toc-number">7.1.4.</span> <span class="toc-text">redo 日志（重做日志）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#relay-%E6%97%A5%E5%BF%97%E4%B8%AD%E7%BB%A7%E6%97%A5%E5%BF%97"><span class="toc-number">7.1.5.</span> <span class="toc-text">relay 日志（中继日志）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%B5%81%E7%A8%8B%E4%B8%AD%E7%9A%84%E5%8D%8F%E4%BD%9C"><span class="toc-number">7.1.6.</span> <span class="toc-text">主从复制流程中的协作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%E5%AF%B9%E6%AF%94"><span class="toc-number">7.1.7.</span> <span class="toc-text">总结对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-number">7.2.</span> <span class="toc-text">部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose.yaml"><span class="toc-number">7.2.1.</span> <span class="toc-text">docker-compose.yaml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6my_m.conf"><span class="toc-number">7.2.2.</span> <span class="toc-text">修改主服务配置文件：my_m.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%BB%8E%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6my_s.conf"><span class="toc-number">7.2.3.</span> <span class="toc-text">修改从服务配置文件：my_s.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E9%AA%8C%E8%AF%81"><span class="toc-number">7.2.4.</span> <span class="toc-text">执行验证</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#redis"><span class="toc-number">8.</span> <span class="toc-text">redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E4%BB%8B%E7%BB%8D"><span class="toc-number">8.1.</span> <span class="toc-text">redis介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E4%BB%8B%E7%BB%8D"><span class="toc-number">8.2.</span> <span class="toc-text">redis部署方案介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E4%B8%80%E4%B8%BB%E4%B8%A4%E4%BB%8E%E4%B8%89%E5%93%A8%E5%85%B5%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88"><span class="toc-number">8.3.</span> <span class="toc-text">redis一主两从三哨兵部署方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2-1"><span class="toc-number">8.4.</span> <span class="toc-text">部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEdocker-compose.yaml%E6%96%87%E4%BB%B6"><span class="toc-number">8.4.1.</span> <span class="toc-text">配置docker-compose.yaml文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis_master%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">8.4.2.</span> <span class="toc-text">redis_master配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis_slave%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">8.4.3.</span> <span class="toc-text">redis_slave配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sentinel%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">8.4.4.</span> <span class="toc-text">sentinel配置文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81"><span class="toc-number">8.5.</span> <span class="toc-text">验证</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#kubernetes%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%BA%94%E7%94%A8"><span class="toc-number">9.</span> <span class="toc-text">kubernetes介绍以及应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">9.0.1.</span> <span class="toc-text">架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#master"><span class="toc-number">9.0.1.1.</span> <span class="toc-text">Master</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#node"><span class="toc-number">9.0.1.2.</span> <span class="toc-text">Node</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90"><span class="toc-number">9.0.2.</span> <span class="toc-text">资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#namespace"><span class="toc-number">9.0.2.1.</span> <span class="toc-text">Namespace</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E7%B1%BB%E8%B4%9F%E8%B4%A3%E6%8E%A5%E5%8F%97%E5%AE%A2%E6%88%B7%E8%AE%BF%E9%97%AE%E8%AF%B7%E6%B1%82%E8%BF%94%E5%9B%9E%E5%AE%A2%E6%88%B7%E9%9C%80%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">9.0.2.1.1.</span> <span class="toc-text">工作负载类：负责接受客户访问请求，返回客户需要的数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%B1%BB"><span class="toc-number">9.0.2.1.2.</span> <span class="toc-text">网络类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%82%A8%E5%AD%98%E7%B1%BB"><span class="toc-number">9.0.2.1.3.</span> <span class="toc-text">储存类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">9.0.2.1.4.</span> <span class="toc-text">配置类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%B1%BB"><span class="toc-number">9.0.2.1.5.</span> <span class="toc-text">安全类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E7%B1%BB"><span class="toc-number">9.0.2.1.6.</span> <span class="toc-text">扩展类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%BC%A9%E6%89%A9%E5%AE%B9%E7%B1%BB"><span class="toc-number">9.0.2.1.7.</span> <span class="toc-text">自动缩扩容类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%82%E7%BA%A7%E5%85%B3%E7%B3%BB"><span class="toc-number">9.0.2.1.8.</span> <span class="toc-text">层级关系</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-%E9%9B%86%E7%BE%A4%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B"><span class="toc-number">9.1.</span> <span class="toc-text">kubernetes-集群信息查看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-%E8%B5%84%E6%BA%90%E5%88%9B%E5%BB%BA%E5%91%BD"><span class="toc-number">9.2.</span> <span class="toc-text">kubernetes-资源创建命</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-pod%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B"><span class="toc-number">9.3.</span> <span class="toc-text">kubernetes-Pod信息查看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-deploymen%E4%BF%A1%E6%81%AF"><span class="toc-number">9.4.</span> <span class="toc-text">kubernetes-deploymen信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-label%E6%8C%87%E4%BB%A4"><span class="toc-number">9.5.</span> <span class="toc-text">kubernetes-label指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4"><span class="toc-number">9.6.</span> <span class="toc-text">kubernetes-基础指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubernetes-%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4-1"><span class="toc-number">9.7.</span> <span class="toc-text">kubernetes-基础指令</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">Nginx反向代理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">10.1.</span> <span class="toc-text">代理服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%9F%E8%83%BD"><span class="toc-number">10.1.1.</span> <span class="toc-text">代理服务器功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84"><span class="toc-number">10.1.2.</span> <span class="toc-text">目的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">10.2.</span> <span class="toc-text">反向代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">10.2.1.</span> <span class="toc-text">作用</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/" title="LangChain使用概述"><img src="/img/lita6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChain使用概述"/></a><div class="content"><a class="title" href="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/" title="LangChain使用概述">LangChain使用概述</a><time datetime="2025-09-26T03:37:36.148Z" title="更新于 2025-09-26 11:37:36">2025-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/23/chromadb%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" title="chromadb向量数据库"><img src="/img/lita7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="chromadb向量数据库"/></a><div class="content"><a class="title" href="/2025/09/23/chromadb%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" title="chromadb向量数据库">chromadb向量数据库</a><time datetime="2025-09-23T16:37:51.853Z" title="更新于 2025-09-24 00:37:51">2025-09-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/" title="逐层分解Transformer"><img src="/img/lita2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="逐层分解Transformer"/></a><div class="content"><a class="title" href="/2025/09/19/%E9%80%90%E5%B1%82%E5%88%86%E8%A7%A3Transformer/" title="逐层分解Transformer">逐层分解Transformer</a><time datetime="2025-09-22T06:53:55.325Z" title="更新于 2025-09-22 14:53:55">2025-09-22</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Yinjin Yao</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text">感谢阅读</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="输入以搜索内容..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>