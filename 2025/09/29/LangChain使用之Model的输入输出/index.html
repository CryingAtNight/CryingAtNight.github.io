<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LangChainä½¿ç”¨ä¹‹Model I/O | Yinjin Yaoçš„åšå®¢</title><meta name="author" content="Yinjin Yao"><meta name="copyright" content="Yinjin Yao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Model I&#x2F;Oä»‹ç» Model I&#x2F;O æ¨¡å—æ˜¯ä¸è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è¿›è¡Œäº¤äº’çš„ æ ¸å¿ƒç»„ä»¶ï¼Œåœ¨æ•´ä¸ªæ¡†æ¶ä¸­æœ‰ç€å¾ˆé‡è¦çš„åœ°ä½ã€‚ æ‰€è°“çš„Model I&#x2F;Oï¼ŒåŒ…æ‹¬è¾“å…¥æç¤º(Format)ã€è°ƒç”¨æ¨¡å‹(Predict)ã€è¾“å‡ºè§£æ(Parse)ã€‚åˆ†åˆ«å¯¹åº”ç€Prompt Template ï¼Œ Model å’Œ Output Parser &#x3D;&#x3D;ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¾“â¼Šã€æ¨¡å‹å¤„ç†ã€è¾“å‡ºè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚&#x3D;&#x3D;  # Mode">
<meta property="og:type" content="article">
<meta property="og:title" content="LangChainä½¿ç”¨ä¹‹Model I&#x2F;O">
<meta property="og:url" content="https://cryingatnight.github.io/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/index.html">
<meta property="og:site_name" content="Yinjin Yaoçš„åšå®¢">
<meta property="og:description" content="Model I&#x2F;Oä»‹ç» Model I&#x2F;O æ¨¡å—æ˜¯ä¸è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è¿›è¡Œäº¤äº’çš„ æ ¸å¿ƒç»„ä»¶ï¼Œåœ¨æ•´ä¸ªæ¡†æ¶ä¸­æœ‰ç€å¾ˆé‡è¦çš„åœ°ä½ã€‚ æ‰€è°“çš„Model I&#x2F;Oï¼ŒåŒ…æ‹¬è¾“å…¥æç¤º(Format)ã€è°ƒç”¨æ¨¡å‹(Predict)ã€è¾“å‡ºè§£æ(Parse)ã€‚åˆ†åˆ«å¯¹åº”ç€Prompt Template ï¼Œ Model å’Œ Output Parser &#x3D;&#x3D;ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¾“â¼Šã€æ¨¡å‹å¤„ç†ã€è¾“å‡ºè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚&#x3D;&#x3D;  # Mode">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cryingatnight.github.io/img/lita4.jpg">
<meta property="article:published_time" content="2025-09-29T04:00:00.000Z">
<meta property="article:modified_time" content="2025-10-09T03:28:14.280Z">
<meta property="article:author" content="Yinjin Yao">
<meta property="article:tag" content="LangChain">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cryingatnight.github.io/img/lita4.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LangChainä½¿ç”¨ä¹‹Model I/O",
  "url": "https://cryingatnight.github.io/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/",
  "image": "https://cryingatnight.github.io/img/lita4.jpg",
  "datePublished": "2025-09-29T04:00:00.000Z",
  "dateModified": "2025-10-09T03:28:14.280Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yinjin Yao",
      "url": "https://cryingatnight.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/headimage.png"><link rel="canonical" href="https://cryingatnight.github.io/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LangChainä½¿ç”¨ä¹‹Model I/O',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> å®éªŒå®¤</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> è±†ç“£ç½‘å¼€å‘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> ä¸Šä¸ä¸ŠAIè¯„åˆ†ç³»ç»Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 å›¾æ ‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/lita4.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/headimage.png" alt="Logo"><span class="site-name">Yinjin Yaoçš„åšå®¢</span></a><a class="nav-page-title" href="/"><span class="site-name">LangChainä½¿ç”¨ä¹‹Model I/O</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> å®éªŒå®¤</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> è±†ç“£ç½‘å¼€å‘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> ä¸Šä¸ä¸ŠAIè¯„åˆ†ç³»ç»Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 å›¾æ ‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">LangChainä½¿ç”¨ä¹‹Model I/O</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-09-29T04:00:00.000Z" title="å‘è¡¨äº 2025-09-29 12:00:00">2025-09-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-10-09T03:28:14.280Z" title="æ›´æ–°äº 2025-10-09 11:28:14">2025-10-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="model-ioä»‹ç»">Model I/Oä»‹ç»</h1>
<p>Model I/O æ¨¡å—æ˜¯ä¸è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è¿›è¡Œäº¤äº’çš„ <strong>æ ¸å¿ƒç»„ä»¶</strong>ï¼Œåœ¨æ•´ä¸ªæ¡†æ¶ä¸­æœ‰ç€å¾ˆé‡è¦çš„åœ°ä½ã€‚ æ‰€è°“çš„Model I/Oï¼ŒåŒ…æ‹¬è¾“å…¥æç¤º(Format)ã€è°ƒç”¨æ¨¡å‹(Predict)ã€è¾“å‡ºè§£æ(Parse)ã€‚åˆ†åˆ«å¯¹åº”ç€<code>Prompt Template</code> ï¼Œ <code>Model</code> å’Œ <code>Output Parser</code></p>
<p>==ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¾“â¼Šã€æ¨¡å‹å¤„ç†ã€è¾“å‡ºè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚==</p>
<p><img src="file-20250929143233797.png" alt="file-20250929143233797.png" /> # Model I/Oä¹‹è°ƒç”¨æ¨¡å‹1</p>
<h2 id="ç±»å‹1llmséå¯¹è¯æ¨¡å‹">ç±»å‹1ï¼šLLMs(éå¯¹è¯æ¨¡å‹)</h2>
<p>LLMsï¼Œä¹Ÿå«Text Modelã€éå¯¹è¯æ¨¡å‹ï¼Œæ˜¯è®¸å¤šè¯­è¨€æ¨¡å‹åº”ç”¨ç¨‹åºçš„æ”¯æŸ±ã€‚ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š - <strong>è¾“å…¥</strong>ï¼šæ¥å— <strong>æ–‡æœ¬å­—ç¬¦ä¸²æˆ–</strong> <strong>PromptValue</strong> å¯¹è±¡ - <strong>è¾“å‡º</strong>ï¼šæ€»æ˜¯è¿”å› <strong>æ–‡æœ¬å­—ç¬¦ä¸²</strong></p>
<figure>
<img src="file-20250929143912905.png" alt="500" /><figcaption aria-hidden="true">500</figcaption>
</figure>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä»…éœ€å•æ¬¡æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ï¼ˆå¦‚æ‘˜è¦ç”Ÿæˆã€ç¿»è¯‘ã€ä»£ç ç”Ÿæˆã€å•æ¬¡é—®ç­”ï¼‰æˆ–å¯¹æ¥ä¸æ”¯æŒæ¶ˆæ¯ ç»“æ„çš„æ—§æ¨¡å‹ï¼ˆå¦‚éƒ¨åˆ†æœ¬åœ°éƒ¨ç½²æ¨¡å‹ï¼‰ï¼ˆ <strong>è¨€å¤–ä¹‹æ„ï¼Œä¼˜å…ˆæ¨èChatModel</strong> ï¼‰ <strong>ä¸æ”¯æŒå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡</strong>ã€‚æ¯æ¬¡è°ƒç”¨ç‹¬ç«‹å¤„ç†è¾“å…¥ï¼Œæ— æ³•è‡ªåŠ¨å…³è”å†å²å¯¹è¯ï¼ˆéœ€æ‰‹åŠ¨æ‹¼æ¥å†å²æ–‡ æœ¬ï¼‰ã€‚ <strong>å±€é™æ€§</strong>ï¼šæ— æ³•å¤„ç†è§’è‰²åˆ†å·¥æˆ–å¤æ‚å¯¹è¯é€»è¾‘ã€‚</p>
<p>.envæ–‡ä»¶ <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">SILICONFLOW_API_KEY=&#x27;sk-spyqlkfbgpdeijbbauaaawhgjexgwxarXXXXXXXXXXXXXXX&#x27;</span>  </span><br><span class="line"><span class="string">BASE_URL=&#x27;https://api.siliconflow.cn/v1&#x27;</span>  </span><br><span class="line"><span class="string">OPENAI_MODEL_NAME=&#x27;deepseek-ai/DeepSeek-V3&#x27;</span>  </span><br><span class="line"><span class="string">OPENAI_EMBEDDING_MODEL_NAME=&#x27;Qwen/Qwen3-Embedding-0.6B&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸¾ä¾‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAI  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">###########æ ¸å¿ƒä»£ç ############  </span></span><br><span class="line">llm = OpenAI(  </span><br><span class="line">    model=os.getenv(<span class="string">&quot;OPENAI_MODEL_NAME&quot;</span>),  </span><br><span class="line">)  </span><br><span class="line"><span class="built_in">str</span> = llm.invoke(<span class="string">&quot;å†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—&quot;</span>)  <span class="comment"># ç›´æ¥è¾“å…¥å­—ç¬¦ä¸²  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">str</span>))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">æ˜¥â»›æ‹‚è¿‡â¼¤åœ° </span><br><span class="line">ä¸‡ç‰©å¤è‹æ¬£æ¬£å‘è£ </span><br><span class="line">èŠ±å¼€æ»¡â¼­â¾• </span><br><span class="line">â»¦â¼‰å•å•¾æ­Œå£°é£˜ </span><br><span class="line">æ˜¥â¾¬æ»‹æ¶¦â½¥é‡ </span><br><span class="line">å†œå¤«æ¬¢å‘¼æ”¶è·ä¸° </span><br><span class="line">æ˜¥â½‡æš–é˜³æ¸©æŸ” </span><br><span class="line">â¼ˆä»¬â¼¼æƒ…ä¹Ÿéšä¹‹èˆ’ </span><br><span class="line">æ˜¥å¤©æ¥äº† </span><br><span class="line">å¸¦æ¥æ–°çš„å¼€å§‹ </span><br><span class="line">å¸¦èµ°å†¬â½‡çš„å¯’å†· </span><br><span class="line">å¸¦æ¥â½£æœºä¸å¸Œæœ› </span><br><span class="line">æ˜¥å¤©å•Šï¼Œç¾ä¸½çš„å­£èŠ‚ </span><br><span class="line">è®©æˆ‘ä»¬â¼€èµ·æ¬¢åº† </span><br><span class="line">è¿æ¥æ˜¥å¤©çš„åˆ°æ¥ </span><br><span class="line">è®©å¿«ä¹æ°¸è¿œé©»ç•™â¼¼ä¸­ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="ç±»å‹2chat-modelså¯¹è¯æ¨¡å‹">ç±»å‹2ï¼šChat Models(å¯¹è¯æ¨¡å‹)</h2>
<p>ChatModelsï¼Œä¹Ÿå«èŠå¤©æ¨¡å‹ã€å¯¹è¯æ¨¡å‹ï¼Œåº•å±‚ä½¿ç”¨LLMsã€‚ <strong>å¤§è¯­è¨€æ¨¡å‹è°ƒç”¨ï¼Œä»¥ ChatModel ä¸ºä¸»ï¼</strong> ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š - <strong>è¾“å…¥</strong>ï¼šæ¥æ”¶æ¶ˆæ¯åˆ—è¡¨ <strong>List[BaseMessage]</strong> æˆ– PromptValue ï¼Œæ¯æ¡æ¶ˆæ¯éœ€æŒ‡å®šè§’è‰²ï¼ˆå¦‚ SystemMessageã€HumanMessageã€AIMessageï¼‰ - <strong>è¾“å‡º</strong>ï¼šæ€»æ˜¯è¿”å›å¸¦è§’è‰²çš„ <strong>æ¶ˆæ¯å¯¹è±¡</strong>ï¼ˆ <strong>BaseMessage å­ç±»</strong>ï¼‰ï¼Œé€šå¸¸æ˜¯ <strong>AIMessage</strong></p>
<figure>
<img src="file-20250929144543733.png" alt="500" /><figcaption aria-hidden="true">500</figcaption>
</figure>
<ul>
<li><strong>åŸç”Ÿæ”¯æŒå¤šè½®å¯¹è¯</strong>ã€‚é€šè¿‡æ¶ˆæ¯åˆ—è¡¨ç»´æŠ¤ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼š[SystemMessage, HumanMessage, AIMessage, â€¦]ï¼‰ï¼Œæ¨¡å‹å¯åŸºäºå®Œæ•´å¯¹è¯å†å²ç”Ÿæˆå›å¤ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¯¹è¯ç³»ç»Ÿï¼ˆå¦‚å®¢æœæœºå™¨äººã€é•¿æœŸäº¤äº’çš„AIåŠ©æ‰‹ï¼‰</li>
</ul>
<p>ä¸¾ä¾‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">########æ ¸å¿ƒä»£ç ############  </span></span><br><span class="line">chat_model = ChatOpenAI(model=os.getenv(<span class="string">&quot;OPENAI_MODEL_NAME&quot;</span>))  </span><br><span class="line">  </span><br><span class="line">messages = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ˜ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>)  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è¾“å…¥ï¼šlist[basemessage]  </span></span><br><span class="line"><span class="comment">#è¾“å‡ºï¼šAIMessage  </span></span><br><span class="line">response = chat_model.invoke(messages)  <span class="comment"># è¾“å…¥æ¶ˆæ¯åˆ—è¡¨  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment"># &lt;class &#x27;langchain_core.messages.ai.AIMessage&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;langchain_core.messages.ai.AIMessage&#x27;</span>&gt;</span><br><span class="line">ä½ å¥½å°æ˜ï¼ğŸ˜Šæˆ‘æ˜¯å°æ™ºï¼Œä¹Ÿè¶…çº§é«˜å…´è®¤è¯†ä½ ï¼ä»Šå¤©æœ‰ä»€ä¹ˆæƒ³èŠçš„è¯é¢˜ï¼Œæˆ–è€…éœ€è¦å¸®å¿™çš„åœ°æ–¹å—ï¼Ÿæ— è®ºæ˜¯è§£é—·è¿˜æ˜¯è§£å†³é—®é¢˜ï¼Œæˆ‘éƒ½åœ¨è¿™é‡Œå“¦ï½</span><br></pre></td></tr></table></figure>
<h2 id="ç±»å‹3embedding-modelåµŒå…¥æ¨¡å‹">ç±»å‹3ï¼š<a href="./LangChainä½¿ç”¨ä¹‹Retrieval#ç¯èŠ‚4ï¼šEmbedï¼ˆåµŒå…¥ï¼‰">Embedding Model(åµŒå…¥æ¨¡å‹)</a></h2>
<p>Embedding Modelï¼šä¹Ÿå«æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹å°† æ–‡æœ¬ä½œä¸ºè¾“å…¥å¹¶è¿”å› Embeddingã€‚</p>
<p><img src="file-20250929145213254.png" /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#############  </span></span><br><span class="line">embeddings_model = OpenAIEmbeddings(  </span><br><span class="line">    model=os.getenv(<span class="string">&quot;OPENAI_EMBEDDING_MODEL_NAME&quot;</span>),  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">res1 = embeddings_model.embed_query(<span class="string">&#x27;æˆ‘æ˜¯æ–‡æ¡£ä¸­çš„æ•°æ®&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(res1)  </span><br><span class="line"><span class="comment"># æ‰“å°ç»“æœï¼š[-0.004306625574827194, 0.003083756659179926, -0.013916781172156334, ...., ]</span></span><br></pre></td></tr></table></figure>
<h2 id="è§’åº¦2å‡ºå‘å‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹">è§’åº¦2å‡ºå‘ï¼šå‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹</h2>
<p>è¿™é‡Œä»¥ LangChain çš„APIä¸ºå‡†ï¼Œä½¿ç”¨å¯¹è¯æ¨¡å‹ï¼Œè¿›è¡Œæµ‹è¯•ã€‚</p>
<h3 id="æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°">æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°</h3>
<p>ç›¸å…³æ–¹æ³•åŠå±æ€§ï¼š - <strong>OpenAI(â€¦) / ChatOpenAI(â€¦)</strong> ï¼šåˆ›å»ºä¸€ä¸ªæ¨¡å‹å¯¹è±¡ï¼ˆéå¯¹è¯ç±»/å¯¹è¯ç±»ï¼‰ - <strong>model.invoke(xxx)</strong> ï¼šæ‰§è¡Œè°ƒç”¨ï¼Œå°†ç”¨æˆ·è¾“å…¥å‘é€ç»™æ¨¡å‹ - <strong>.content</strong> ï¼šæå–æ¨¡å‹è¿”å›çš„å®é™…æ–‡æœ¬å†…å®¹ æ¨¡å‹è°ƒç”¨å‡½æ•°ä½¿ç”¨æ—¶éœ€åˆå§‹åŒ–æ¨¡å‹ï¼Œå¹¶è®¾ç½®å¿…è¦çš„å‚æ•°ã€‚</p>
<ol type="1">
<li>å¿…é¡»è®¾ç½®çš„å‚æ•°ï¼š
<ul>
<li><strong>base_url</strong> ï¼šå¤§æ¨¡å‹ API æœåŠ¡çš„æ ¹åœ°å€</li>
<li><strong>api_key</strong> ï¼šç”¨äºèº«ä»½éªŒè¯çš„å¯†é’¥ï¼Œç”±å¤§æ¨¡å‹æœåŠ¡å•†ï¼ˆå¦‚ OpenAIã€ç™¾åº¦åƒå¸†ï¼‰æä¾›</li>
<li><strong>model/model_name</strong> ï¼šæŒ‡å®šè¦è°ƒç”¨çš„å…·ä½“å¤§æ¨¡å‹åç§°ï¼ˆå¦‚ gpt-4-turbo ã€ ERNIE-3.5-8K ç­‰ï¼‰</li>
</ul></li>
<li>å…¶å®ƒå‚æ•°ï¼š
<ul>
<li><p><strong>temperature</strong> ï¼šæ¸©åº¦ï¼Œæ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„â€œéšæœºæ€§â€ï¼Œå–å€¼èŒƒå›´ä¸º0ï½1ã€‚</p>
<ul>
<li>å€¼è¶Šä½â†’ è¾“å‡ºè¶Šç¡®å®šã€ä¿å®ˆï¼ˆé€‚åˆäº‹å®å›ç­”ï¼‰</li>
<li>å€¼è¶Šé«˜â†’ è¾“å‡ºè¶Šå¤šæ ·ã€æœ‰åˆ›æ„ï¼ˆé€‚åˆåˆ›æ„å†™ä½œï¼‰</li>
</ul>
<p>é€šå¸¸ï¼Œæ ¹æ®éœ€è¦è®¾ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç²¾ç¡®æ¨¡å¼ï¼ˆ0.5æˆ–æ›´ä½ï¼‰ï¼šç”Ÿæˆçš„æ–‡æœ¬æ›´åŠ å®‰å…¨å¯é ï¼Œä½†å¯èƒ½ç¼ºä¹åˆ›æ„å’Œå¤šæ ·æ€§ã€‚</li>
<li>å¹³è¡¡æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯0.8ï¼‰ï¼šç”Ÿæˆçš„æ–‡æœ¬é€šå¸¸æ—¢æœ‰ä¸€å®šçš„å¤šæ ·æ€§ï¼Œåˆèƒ½ä¿æŒè¾ƒå¥½çš„è¿è´¯æ€§å’Œå‡†ç¡® æ€§ã€‚</li>
<li>åˆ›æ„æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯1ï¼‰ï¼šç”Ÿæˆçš„æ–‡æœ¬æ›´æœ‰åˆ›æ„ï¼Œä½†ä¹Ÿæ›´å®¹æ˜“å‡ºç°è¯­æ³•é”™è¯¯æˆ–ä¸åˆé€»è¾‘çš„å†…å®¹ã€‚</li>
</ul></li>
<li><p><strong>max_tokens</strong> ï¼šé™åˆ¶ç”Ÿæˆæ–‡æœ¬çš„æœ€å¤§é•¿åº¦ï¼Œé˜²æ­¢è¾“å‡ºè¿‡é•¿ã€‚</p>
<p><strong>Tokenæ˜¯ä»€ä¹ˆ</strong>ï¼Ÿ <strong>åŸºæœ¬å•ä½</strong>: å¤§æ¨¡å‹å¤„ç†æ–‡æœ¬çš„æœ€å°å•ä½æ˜¯tokenï¼ˆç›¸å½“äºè‡ªç„¶è¯­è¨€ä¸­çš„è¯æˆ–å­—ï¼‰ï¼Œè¾“å‡ºæ—¶é€ä¸ªtoken ä¾æ¬¡ç”Ÿæˆã€‚ <strong>æ”¶è´¹ä¾æ®</strong>ï¼šå¤§è¯­è¨€æ¨¡å‹(LLM)é€šå¸¸ä¹Ÿæ˜¯ä»¥tokençš„æ•°é‡ä½œä¸ºå…¶è®¡é‡(æˆ–æ”¶è´¹)çš„ä¾æ®ã€‚</p>
<ul>
<li>1ä¸ªTokenâ‰ˆ1-1.8ä¸ªæ±‰å­—ï¼Œ1ä¸ªTokenâ‰ˆ3-4ä¸ªè‹±æ–‡å­—æ¯</li>
<li>Tokenä¸å­—ç¬¦è½¬åŒ–çš„å¯è§†åŒ–å·¥å…·ï¼š
<ul>
<li>OpenAIæä¾›ï¼šhttps://platform.openai.com/tokenizer</li>
<li>ç™¾åº¦æ™ºèƒ½äº‘æä¾›ï¼šhttps://console.bce.baidu.com/support/#/tokenizer</li>
</ul></li>
</ul>
<p><strong>max_tokens</strong>è®¾ç½®å»ºè®®ï¼š</p>
<ul>
<li>å®¢æœçŸ­å›å¤ï¼š128-256ã€‚æ¯”å¦‚ï¼šç”Ÿæˆä¸€å¥å®¢æœå›å¤ï¼ˆå¦‚â€œè®¢å•å·²å‘è´§ï¼Œé¢„è®¡æ˜å¤©é€è¾¾â€ï¼‰</li>
<li>å¸¸è§„å¯¹è¯ã€å¤šè½®å¯¹è¯ï¼š512-1024</li>
<li>é•¿å†…å®¹ç”Ÿæˆï¼š1024-4096ã€‚æ¯”å¦‚ï¼šç”Ÿæˆä¸€ç¯‡äº§å“è¯´æ˜ä¹¦ï¼ˆåŒ…å«åŠŸèƒ½ã€ä½¿ç”¨æ–¹æ³•ç­‰ç»“æ„ï¼‰</li>
</ul></li>
</ul></li>
</ol>
<h3 id="æ–¹å¼1ç¡¬ç¼–ç ">æ–¹å¼1ï¼šç¡¬ç¼–ç </h3>
<p>ç›´æ¥å°† API Key å’Œæ¨¡å‹å‚æ•°å†™å…¥ä»£ç ï¼Œä»…é€‚ç”¨äºä¸´æ—¶æµ‹è¯•ï¼Œå­˜åœ¨å¯†é’¥æ³„éœ²é£é™©ï¼Œåœ¨ å…·ä½“è´¹ç”¨è‡ª ç”Ÿäº§ç¯å¢ƒä¸æ¨èã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¡¬ç¼–ç  API Key å’Œæ¨¡å‹å‚æ•° </span></span><br><span class="line">llm = ChatOpenAI( </span><br><span class="line">	api_key= <span class="string">&quot;sk-xxxxxxxxx&quot;</span> , <span class="comment"># æ˜æ–‡æš´éœ²å¯†é’¥ </span></span><br><span class="line">	base_url= <span class="string">&quot;https://api.openai-proxy.org/v1&quot;</span> , </span><br><span class="line">	model= <span class="string">&quot;gpt-3.5-turbo&quot;</span> , ) </span><br><span class="line">	</span><br><span class="line"><span class="comment"># è°ƒç”¨ç¤ºä¾‹ </span></span><br><span class="line">response = llm.invoke( <span class="string">&quot;è§£é‡Šç¥ç»ç½‘ç»œåŸç†&quot;</span> ) </span><br><span class="line"><span class="built_in">print</span> (response.content)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¥ç»â½¹ç»œæ˜¯â¼€ç§æ¨¡æ‹Ÿâ¼ˆè„‘ç¥ç»å…ƒä¹‹é—´ä¿¡æ¯ä¼ é€’çš„æ•°å­¦æ¨¡å‹ã€‚ç¥ç»â½¹ç»œç”±å¤šå±‚ç¥ç»å…ƒç»„æˆï¼Œæ¯ä¸ªç¥ç» å…ƒæ¥æ”¶æ¥â¾ƒä¸Šâ¼€å±‚ç¥ç»å…ƒçš„è¾“â¼Šä¿¡å·ï¼Œå¹¶é€šè¿‡æ¿€æ´»å‡½æ•°å°†è¾“â¼Šä¿¡å·è¿›â¾åŠ æƒæ±‚å’Œå¹¶è¾“å‡ºâ¼€ä¸ªç»“æœã€‚ åœ¨ç¥ç»â½¹ç»œä¸­ï¼Œæ•°æ®é€šè¿‡è¾“â¼Šå±‚ä¼ é€’åˆ°éšè—å±‚ï¼Œæœ€ç»ˆåˆ°è¾“å‡ºå±‚ã€‚åœ¨æ¯â¼€å±‚ä¸­ï¼Œç¥ç»å…ƒé€šè¿‡å­¦ä¹ ç®—æ³• ä¸æ–­è°ƒæ•´è¿æ¥æƒé‡ï¼Œä»¥ä½¿ç¥ç»â½¹ç»œèƒ½å¤Ÿå‡†ç¡®åœ°å¯¹è¾“â¼Šæ•°æ®è¿›â¾åˆ†ç±»æˆ–é¢„æµ‹ã€‚ ç¥ç»â½¹ç»œçš„è®­ç»ƒè¿‡ç¨‹æ˜¯é€šè¿‡åå‘ä¼ æ’­ç®—æ³•è¿›â¾çš„ã€‚è¯¥ç®—æ³•é€šè¿‡è®¡ç®—ç¥ç»â½¹ç»œè¾“å‡ºç»“æœä¸å®é™…ç»“æœä¹‹ é—´çš„è¯¯å·®ï¼Œç„¶åæ ¹æ®è¯¯å·®è°ƒæ•´ç¥ç»å…ƒä¹‹é—´çš„è¿æ¥æƒé‡ï¼Œä»¥æâ¾¼ç¥ç»â½¹ç»œçš„å‡†ç¡®æ€§ã€‚ æ€»çš„æ¥è¯´ï¼Œç¥ç»â½¹ç»œé€šè¿‡æ¨¡æ‹Ÿâ¼ˆè„‘ç¥ç»å…ƒä¹‹é—´çš„ä¿¡æ¯ä¼ é€’è¿‡ç¨‹ï¼Œåˆ©â½¤æ•°å­¦æ¨¡å‹æ¥å®ç°å¯¹å¤æ‚é—®é¢˜çš„ å­¦ä¹ å’Œé¢„æµ‹ã€‚ç¥ç»â½¹ç»œçš„åŸç†æ˜¯åŸºäºç¥ç»å…ƒä¹‹é—´çš„è¿æ¥æƒé‡è°ƒæ•´å’Œè¯¯å·®åå‘ä¼ æ’­çš„æœºåˆ¶ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="æ–¹å¼2é…ç½®ç¯å¢ƒå˜é‡">æ–¹å¼2ï¼šé…ç½®ç¯å¢ƒå˜é‡</h3>
<p>é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥ï¼Œé¿å…ä»£ç æ˜æ–‡æš´éœ²ã€‚</p>
<p>æ–¹å¼1ï¼šç»ˆç«¯è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰ï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> OPENAI_API_KEY= <span class="string">&quot;sk-xxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="comment"># Linux/Mac </span></span><br><span class="line"><span class="built_in">set</span> OPENAI_API_KEY= <span class="string">&quot;sk-xxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="comment"># Windows</span></span><br></pre></td></tr></table></figure></p>
<h3 id="æ–¹å¼3ä½¿ç”¨.envé…ç½®æ–‡ä»¶">æ–¹å¼3ï¼šä½¿ç”¨.envé…ç½®æ–‡ä»¶</h3>
<p>ä½¿ç”¨ python-dotenv åŠ è½½æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒå¤šç¯å¢ƒç®¡ç†ï¼ˆå¼€å‘/ç”Ÿäº§ï¼‰ã€‚</p>
<ol type="1">
<li><p>å®‰è£…ä¾èµ– <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install python-dotenv </span><br><span class="line"><span class="comment">#æˆ–è€…</span></span><br><span class="line">conda install python-dotenv</span><br></pre></td></tr></table></figure></p></li>
<li><p>åˆ›å»º .env æ–‡ä»¶ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼š <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">OPENAI_API_KEY=</span> <span class="string">&quot;sk-xxxxxxxxx&quot;</span> <span class="comment"># éœ€å¡«å†™è‡ªå·±çš„API KEY </span></span><br><span class="line"><span class="string">OPENAI_BASE_URL=</span> <span class="string">&quot;https://api.openai-proxy.org/v1&quot;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>ä¸¾ä¾‹ æ–¹å¼1 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    <span class="comment">#å¿…é¡»è¦è®¾ç½®çš„3ä¸ªå‚æ•°  </span></span><br><span class="line">     <span class="comment">#å¿…é¡»è¦è®¾ç½®çš„3ä¸ªå‚æ•°  </span></span><br><span class="line">    model_name=os.getenv(<span class="string">&#x27;OPENAI_MODEL_NAME&#x27;</span>),   <span class="comment">#é»˜è®¤ä½¿ç”¨çš„æ˜¯gpt-3.5-turboæ¨¡å‹  </span></span><br><span class="line">    base_url=os.getenv(<span class="string">&#x27;BASE_URL&#x27;</span>),  </span><br><span class="line">    api_key=os.getenv(<span class="string">&#x27;SILICONFLOW_API_KEY&#x27;</span>),  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è°ƒç”¨æ¨¡å‹  </span></span><br><span class="line">response = chat_model.invoke(<span class="string">&quot;ä»€ä¹ˆæ˜¯langchain?&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æŸ¥çœ‹å“åº”çš„æ–‡æœ¬  </span></span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure></p></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ä¸è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPT-3ã€GPT-4 ç­‰ï¼‰äº’åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—å·¥å…·å’Œç»„ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾æ„å»ºå¼ºå¤§çš„è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰åº”ç”¨ã€‚LangChain çš„åŠŸèƒ½åŒ…æ‹¬ï¼š\n\n1. **é“¾ï¼ˆChainsï¼‰**ï¼šå¯ä»¥å°†å¤šä¸ªæ“ä½œæ­¥éª¤é“¾æ¥åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚å°†ç”¨æˆ·è¾“å…¥ä¼ é€’ç»™è¯­è¨€æ¨¡å‹ï¼Œç„¶åå°†æ¨¡å‹çš„è¾“å‡ºä¼ é€’ç»™å…¶ä»–å¤„ç†æ­¥éª¤ã€‚\n\n2. **æ–‡æ¡£åŠ è½½å™¨ï¼ˆDocument Loadersï¼‰**ï¼šç”¨äºä»ä¸åŒæºï¼ˆå¦‚ PDFã€æ–‡æœ¬æ–‡ä»¶ã€ç½‘é¡µç­‰ï¼‰åŠ è½½å’Œå¤„ç†æ–‡æ¡£ï¼Œä½¿å…¶èƒ½è¢«è¯­è¨€æ¨¡å‹å¤„ç†ã€‚\n\n3. **å†…å­˜ï¼ˆMemoryï¼‰**ï¼šå…è®¸åº”ç”¨ç¨‹åºä¿æŒå¯¹è¯çš„ä¸Šä¸‹æ–‡ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿè®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œä»è€Œæä¾›æ›´è¿è´¯çš„äº¤äº’ã€‚\n\n4. **ä»£ç†ï¼ˆAgentsï¼‰**ï¼šæ ¹æ®éœ€æ±‚åŠ¨æ€é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·å’Œæ¨¡å‹è¿›è¡Œå¤„ç†ï¼Œæé«˜äº†ç³»ç»Ÿçš„çµæ´»æ€§å’Œè‡ªé€‚åº”èƒ½åŠ›ã€‚\n\n5. **å·¥å…·ï¼ˆToolsï¼‰**ï¼šæä¾›å„ç§å®ç”¨åŠŸèƒ½ï¼Œå¦‚ API è°ƒç”¨ã€æ•°æ®åº“æŸ¥è¯¢ç­‰ï¼Œå¢å¼ºäº†è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ã€‚\n\nLangChain çš„è®¾è®¡ç›®æ ‡æ˜¯é™ä½æ„å»ºå¤æ‚ NLP åº”ç”¨çš„é—¨æ§›ï¼Œä½¿å¾—æ— è®ºæ˜¯æ™®é€šå¼€å‘è€…è¿˜æ˜¯æ•°æ®ç§‘å­¦å®¶éƒ½èƒ½å¤Ÿå®ç°ä»–ä»¬çš„æƒ³æ³•ã€‚æ— è®ºæ˜¯å¼€å‘èŠå¤©æœºå™¨äººã€é—®ç­”ç³»ç»Ÿï¼Œè¿˜æ˜¯å…¶ä»–åŸºäºè¯­è¨€æ¨¡å‹çš„åº”ç”¨ï¼ŒLangChain éƒ½æä¾›äº†ä¸°å¯Œçš„æ”¯æŒã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 311, <span class="string">&#x27;prompt_tokens&#x27;</span>: 12, <span class="string">&#x27;total_tokens&#x27;</span>: 323, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7KtQzBvG5gwJX9h550F2dmb9W3uQ&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--3179f561-e4fe-420a-ad83-6b845b65600a-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 12, <span class="string">&#x27;output_tokens&#x27;</span>: 311, <span class="string">&#x27;total_tokens&#x27;</span>: 323, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ–¹å¼2ï¼šç»™oså†…éƒ¨çš„ç¯å¢ƒå˜é‡èµ‹å€¼ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1ã€è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    <span class="comment">#å¿…é¡»è¦è®¾ç½®çš„3ä¸ªå‚æ•°  </span></span><br><span class="line">    <span class="comment">#model_name=&quot;gpt-4o-mini&quot;,   #é»˜è®¤ä½¿ç”¨çš„æ˜¯gpt-3.5-turboæ¨¡å‹  </span></span><br><span class="line">    <span class="comment">#å½“æ²¡æœ‰æ˜¾å¼çš„å£°æ˜base_urlå’Œapi_keyçš„æ—¶å€™ï¼Œé»˜è®¤ä¼šä»ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è°ƒç”¨æ¨¡å‹  </span></span><br><span class="line">response = chat_model.invoke(<span class="string">&quot;ä»€ä¹ˆæ˜¯langchain?&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€æŸ¥çœ‹å“åº”çš„æ–‡æœ¬  </span></span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;LangChainæ˜¯ä¸€ä¸ªåŸºäºåŒºå—é“¾æŠ€æœ¯çš„è¯­è¨€æœåŠ¡å¹³å°ï¼Œæ—¨åœ¨æä¾›å…¨çƒé€æ˜ã€å¿«é€Ÿå’Œå®‰å…¨çš„è¯­è¨€äº’è¯‘æœåŠ¡ã€‚ç”¨æˆ·å¯ä»¥åœ¨è¯¥å¹³å°ä¸Šå¯»æ‰¾ç¿»è¯‘äººå‘˜å¹¶è¿›è¡Œè¯­è¨€äº¤æµï¼ŒåŒæ—¶é€šè¿‡æ™ºèƒ½åˆçº¦æ–¹å¼æ¥ç¡®ä¿äº¤æ˜“çš„å®‰å…¨å’Œå¯é ã€‚LangChainæ—¨åœ¨æ¶ˆé™¤è¯­è¨€éšœç¢ï¼Œä¿ƒè¿›å…¨çƒäº¤æµå’Œåˆä½œã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 116, <span class="string">&#x27;prompt_tokens&#x27;</span>: 14, <span class="string">&#x27;total_tokens&#x27;</span>: 130, <span class="string">&#x27;completion_tokens_details&#x27;</span>: None, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: None&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-3.5-turbo-0125&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_0165350fbb&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7KxkXUF0pqZoe3fYnf1WwjXWs1yk&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--0d0d9ed6-8a15-4eaa-b40b-ce1671d5e9aa-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 14, <span class="string">&#x27;output_tokens&#x27;</span>: 116, <span class="string">&#x27;total_tokens&#x27;</span>: 130, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;&#125;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å°ç»“è·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼">å°ç»“ï¼šè·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼</h3>
<p>åç»­çš„å„ç§æ¨¡å‹æµ‹è¯•ï¼Œéƒ½åŸºäºå¦‚ä¸‹çš„æ¨¡å‹å±•å¼€ï¼š <strong>éå¯¹è¯æ¨¡å‹</strong>ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os <span class="keyword">import</span> dotenv </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAI </span><br><span class="line">dotenv.load_dotenv() </span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY&quot;</span> ) </span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line">llm = OpenAI( </span><br><span class="line">	<span class="comment">#éå¯¹è¯æ¨¡å‹ </span></span><br><span class="line">	<span class="comment">#max_tokens=512, </span></span><br><span class="line">	<span class="comment">#temperature=0.7, </span></span><br><span class="line">	)</span><br></pre></td></tr></table></figure></p>
<p><strong>å¯¹è¯æ¨¡å‹</strong>ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os <span class="keyword">import</span> dotenv </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI </span><br><span class="line">dotenv.load_dotenv() </span><br><span class="line"></span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_API_KEY&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_API_KEY&quot;</span> ) </span><br><span class="line">os.environ[ <span class="string">&#x27;OPENAI_BASE_URL&#x27;</span> ] = os.getenv( <span class="string">&quot;OPENAI_BASE_URL&quot;</span> ) </span><br><span class="line"></span><br><span class="line">chat_model = ChatOpenAI( </span><br><span class="line">	<span class="comment">#å¯¹è¯æ¨¡å‹ </span></span><br><span class="line">	model= <span class="string">&quot;gpt-4o-mini&quot;</span> , </span><br><span class="line">	<span class="comment">#max_tokens=512,</span></span><br><span class="line">	<span class="comment">#temperature=0.7, </span></span><br><span class="line">	)</span><br></pre></td></tr></table></figure></p>
<h1 id="model-ioä¹‹è°ƒç”¨æ¨¡å‹2">Model I/Oä¹‹è°ƒç”¨æ¨¡å‹2</h1>
<h2 id="å…³äºå¯¹è¯æ¨¡å‹çš„messageæ¶ˆæ¯">å…³äºå¯¹è¯æ¨¡å‹çš„Message(æ¶ˆæ¯)</h2>
<p>èŠå¤©æ¨¡å‹ï¼Œå‡ºäº†å°†å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>èŠå¤©æ¶ˆæ¯</code>ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å› <code>èŠå¤©æ¶ˆæ¯</code>ä½œä¸ºè¾“å‡ºã€‚</p>
<p>LangChainæœ‰ä¸€äº›å†…ç½®çš„æ¶ˆæ¯ç±»å‹ï¼š - ğŸ”¥<strong>SystemMessage</strong> ï¼šè®¾å®šAIè¡Œä¸ºè§„åˆ™æˆ–èƒŒæ™¯ä¿¡æ¯ã€‚æ¯”å¦‚è®¾å®šAIçš„åˆå§‹çŠ¶æ€ã€è¡Œä¸ºæ¨¡å¼æˆ–å¯¹è¯çš„æ€» ä½“ç›®æ ‡ã€‚æ¯”å¦‚â€œä½œä¸ºä¸€ä¸ªä»£ç ä¸“å®¶â€ï¼Œæˆ–è€…â€œè¿”å›jsonæ ¼å¼â€ã€‚é€šå¸¸ä½œä¸ºè¾“å…¥æ¶ˆæ¯åºåˆ—ä¸­çš„ç¬¬ä¸€ä¸ª ä¼ é€’ã€‚ - ğŸ”¥<strong>HumanMessage</strong> ï¼šè¡¨ç¤ºæ¥è‡ªç”¨æˆ·è¾“å…¥ã€‚æ¯”å¦‚â€œå®ç° ä¸€ä¸ªå¿«é€Ÿæ’åºæ–¹æ³•â€ - ğŸ”¥<strong>AI Message</strong> ï¼šå­˜å‚¨AIå›å¤çš„å†…å®¹ã€‚è¿™å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨å·¥å…·çš„è¯·æ±‚ - <strong>ChatMessage</strong> ï¼šå¯ä»¥è‡ªå®šä¹‰è§’è‰²çš„é€šç”¨æ¶ˆæ¯ç±»å‹ - <strong>FunctionMessage/ToolMessage</strong> ï¼šå‡½æ•°è°ƒç”¨/å·¥å…·æ¶ˆæ¯ï¼Œç”¨äºå‡½æ•°è°ƒç”¨ç»“æœçš„æ¶ˆæ¯ç±»å‹</p>
<blockquote>
<p>[!notice] æ³¨æ„ï¼š FunctionMessageå’ŒToolMessageåˆ†åˆ«æ˜¯åœ¨å‡½æ•°è°ƒâ½¤å’Œâ¼¯å…·è°ƒâ½¤åœºæ™¯ä¸‹æ‰ä¼šä½¿â½¤çš„ç‰¹æ®Šæ¶ˆæ¯ç±» å‹ï¼ŒHumanMessageã€AIMessageå’ŒSystemMessageæ‰æ˜¯æœ€å¸¸â½¤çš„æ¶ˆæ¯ç±»å‹ã€‚</p>
</blockquote>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">system_message = SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&quot;</span>)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [system_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(messages)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¤§æ¨¡å‹ï¼Œè°ƒç”¨æ¶ˆæ¯åˆ—è¡¨ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure> ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;langchain_core.messages.ai.AIMessage&#x27;</span>&gt;</span><br><span class="line">åˆ¶å®šä¸€ä»½é«˜æ•ˆçš„è‹±è¯­å…­çº§ï¼ˆCET-6ï¼‰å­¦ä¹ è®¡åˆ’éœ€è¦ç»“åˆè€ƒè¯•é¢˜å‹ï¼ˆå¬åŠ›ã€é˜…è¯»ã€å†™ä½œã€ç¿»è¯‘ï¼‰å’Œä¸ªäººè–„å¼±é¡¹ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª**6-8å‘¨å†²åˆºè®¡åˆ’**çš„æ¨¡æ¿ï¼Œå¯æ ¹æ®è‡ªèº«æ—¶é—´çµæ´»è°ƒæ•´ï¼š</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **ä¸€ã€å¤¯å®åŸºç¡€ï¼ˆç¬¬1-2å‘¨ï¼‰**</span></span><br><span class="line">**ç›®æ ‡ï¼šç†Ÿæ‚‰é¢˜å‹ + æ ¸å¿ƒè¯æ±‡ + åŸºç¡€è®­ç»ƒ**</span><br><span class="line">1. **æ¯æ—¥ä»»åŠ¡ï¼š**</span><br><span class="line">   - **è¯æ±‡ï¼ˆ30åˆ†é’Ÿï¼‰**  </span><br><span class="line">     - èƒŒè¯µ30-50ä¸ªå…­çº§é«˜é¢‘è¯ï¼ˆæ¨èã€Šå…­çº§æ ¸å¿ƒè¯æ±‡ä¹±åºç‰ˆã€‹æˆ–APPå¦‚<span class="string">&quot;ä¸èƒŒå•è¯&quot;</span>ï¼‰ã€‚  </span><br><span class="line">     - é‡ç‚¹æŒæ¡è¯æ±‡çš„**æ­é…ç”¨æ³•**ï¼ˆå¦‚åŠ¨è¯çŸ­è¯­ã€å¸¸è§ä»‹è¯æ­é…ï¼‰ã€‚</span><br><span class="line">   - **å¬åŠ›ï¼ˆ20åˆ†é’Ÿï¼‰**  </span><br><span class="line">     - ç²¾å¬1ç¯‡çŸ­ç¯‡æ–°é—»/é•¿å¯¹è¯ï¼ˆVOAå¸¸é€Ÿæˆ–å…­çº§çœŸé¢˜ï¼‰ï¼Œå¬å†™å…³é”®å¥ã€‚</span><br><span class="line">   - **é˜…è¯»ï¼ˆ30åˆ†é’Ÿï¼‰**  </span><br><span class="line">     - ç²¾è¯»1ç¯‡å…­çº§çœŸé¢˜é€‰è¯å¡«ç©ºæˆ–åŒ¹é…é¢˜ï¼Œåˆ†æé•¿éš¾å¥ç»“æ„ã€‚</span><br><span class="line">2. **æ¯å‘¨ä»»åŠ¡ï¼š**  </span><br><span class="line">   - å®Œæˆ1å¥—çœŸé¢˜ï¼ˆä¸è®¡æ—¶ï¼‰ï¼Œæ ‡æ³¨é”™é¢˜ï¼Œåˆ†æé”™è¯¯åŸå› ï¼ˆå¦‚ï¼šè¯æ±‡ç›²åŒºã€é€»è¾‘åå·®ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **äºŒã€ä¸“é¡¹çªç ´ï¼ˆç¬¬3-5å‘¨ï¼‰**</span></span><br><span class="line">**ç›®æ ‡ï¼šåˆ†é¢˜å‹å¼ºåŒ–æŠ€å·§ + æé€Ÿ**</span><br><span class="line">1. **å¬åŠ›ï¼ˆæ¯æ—¥25åˆ†é’Ÿï¼‰ï¼š**</span><br><span class="line">   - **æŠ€å·§**ï¼šæ³¨æ„è½¬æŠ˜è¯ï¼ˆbut, howeverï¼‰ã€è§‚ç‚¹è¯ï¼ˆthink, believeï¼‰ã€æ•°å­—/æ—¶é—´ã€‚  </span><br><span class="line">   - **è®­ç»ƒ**ï¼šæ¯å¤©1ç¯‡è®²åº§/é•¿å¯¹è¯ï¼Œå½±å­è·Ÿè¯»æ³•æ¨¡ä»¿è¯­éŸ³è¯­è°ƒã€‚</span><br><span class="line">2. **é˜…è¯»ï¼ˆæ¯æ—¥40åˆ†é’Ÿï¼‰ï¼š**</span><br><span class="line">   - **é€‰è¯å¡«ç©º**ï¼šæ ¹æ®è¯æ€§ã€ä¸Šä¸‹æ–‡é€»è¾‘æ’é™¤é”™è¯¯é€‰é¡¹ã€‚  </span><br><span class="line">   - **é•¿ç¯‡é˜…è¯»**ï¼šå…ˆè¯»é¢˜å¹²åˆ’å…³é”®è¯ï¼Œé€Ÿè¯»æ–‡ç« å®šä½ã€‚  </span><br><span class="line">   - **ä»”ç»†é˜…è¯»**ï¼šé‡ç‚¹åˆ†æé¦–å°¾æ®µã€æ®µè½ä¸»æ—¨å¥ã€‚</span><br><span class="line">3. **å†™ä½œç¿»è¯‘ï¼ˆéš”æ—¥30åˆ†é’Ÿï¼‰ï¼š**</span><br><span class="line">   - **å†™ä½œ**ï¼šèƒŒè¯µ3-4ä¸ªä¸‡èƒ½æ¨¡æ¿ï¼ˆç°è±¡åˆ†æã€è§‚ç‚¹å¯¹æ¯”ç­‰ï¼‰ï¼Œæ¯å‘¨å†™1ç¯‡å¹¶æ‰¹æ”¹ï¼ˆå¯ç”¨Grammarlyï¼‰ã€‚  </span><br><span class="line">   - **ç¿»è¯‘**ï¼šæ¯æ—¥ç»ƒä¹ 1å¥**ä¸­å›½æ–‡åŒ–/ç»æµç±»**å¥å­ï¼ˆå‚è€ƒã€Šä¸­å›½æ–‡åŒ–æ¦‚è§ˆã€‹ï¼‰ï¼Œç§¯ç´¯å›ºå®šè¡¨è¾¾ï¼ˆå¦‚<span class="string">&quot;è¢«èª‰ä¸º&quot;</span>â†’be hailed asï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **ä¸‰ã€å†²åˆºæ¨¡æ‹Ÿï¼ˆç¬¬6-8å‘¨ï¼‰**</span></span><br><span class="line">**ç›®æ ‡ï¼šå…¨çœŸæ¨¡è€ƒ + æŸ¥æ¼è¡¥ç¼º**</span><br><span class="line">1. **æ¯å‘¨2å¥—çœŸé¢˜ï¼ˆä¸¥æ ¼è®¡æ—¶ï¼‰**ï¼š  </span><br><span class="line">   - æŒ‰è€ƒè¯•æ—¶é—´ï¼ˆ15:00-17:25ï¼‰æ¨¡æ‹Ÿï¼Œè®­ç»ƒæ—¶é—´åˆ†é…ï¼ˆå»ºè®®é˜…è¯»40åˆ†é’Ÿã€ç¿»è¯‘30åˆ†é’Ÿï¼‰ã€‚  </span><br><span class="line">   - é”™é¢˜å½’ç±»æ•´ç†ï¼ˆå¦‚<span class="string">&quot;å¬åŠ›ä¸»æ—¨é¢˜é”™è¯¯&quot;</span>ã€<span class="string">&quot;ç¿»è¯‘å¥å‹å•ä¸€&quot;</span>ï¼‰ã€‚</span><br><span class="line">2. **é‡ç‚¹å¼ºåŒ–ï¼š**  </span><br><span class="line">   - **è–„å¼±é¢˜å‹åŠ ç»ƒ**ï¼šä¾‹å¦‚å¬åŠ›å¼±åˆ™æ¯å¤©å¢åŠ 1ç¯‡ç²¾å¬ã€‚  </span><br><span class="line">   - **é«˜é¢‘è¯é¢˜çªå‡»**ï¼šå†™ä½œå…³æ³¨äººå·¥æ™ºèƒ½ã€ç¯ä¿ç­‰çƒ­ç‚¹ï¼›ç¿»è¯‘ç§¯ç´¯ä¼ ç»ŸèŠ‚æ—¥ã€æ”¿ç­–ç±»è¯æ±‡ã€‚</span><br><span class="line">3. **è€ƒå‰3å¤©ï¼š**  </span><br><span class="line">   - å¤ä¹ é”™é¢˜æœ¬ + èƒŒè¯µä½œæ–‡æ¨¡æ¿å¥ã€‚  </span><br><span class="line">   - å¬1å¥—å¬åŠ›ä¿æŒè¯­æ„Ÿï¼Œé¿å…ç”Ÿç–ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **å››ã€å¿…å¤‡èµ„æºæ¨è**</span></span><br><span class="line">1. **çœŸé¢˜**ï¼šã€Šæ˜Ÿç«å…­çº§çœŸé¢˜è¯¦è§£ã€‹ã€Šåç ”å¤–è¯­å…­çº§çœŸé¢˜ã€‹  </span><br><span class="line">2. **APP**ï¼šæ¯æ—¥è‹±è¯­å¬åŠ›ï¼ˆçœŸé¢˜éŸ³é¢‘ï¼‰ã€China Dailyï¼ˆç§¯ç´¯ç¿»è¯‘è¯æ±‡ï¼‰  </span><br><span class="line">3. **å†™ä½œç´ æ**ï¼šå…¬ä¼—å·<span class="string">&quot;LearnAndRecord&quot;</span>ã€èŒƒæ–‡ä¹¦ã€Šå…­çº§æ»¡åˆ†å†™ä½œ30å¤©é€Ÿæˆã€‹</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">### **äº”ã€å…³é”®æé†’**</span></span><br><span class="line">1. **å¬åŠ›ç­”æ¡ˆè§„å¾‹**ï¼š25é“é¢˜æ™®éåˆ†å¸ƒä¸º6A+6B+6C+6D+1éšæœºï¼Œå¯è¾…åŠ©æ£€æŸ¥ã€‚  </span><br><span class="line">2. **é˜…è¯»é¡ºåº**ï¼šå»ºè®®å…ˆåšä»”ç»†é˜…è¯»â†’é•¿ç¯‡é˜…è¯»â†’é€‰è¯å¡«ç©ºï¼ˆä¿å¤§åˆ†ï¼‰ã€‚  </span><br><span class="line">3. **ç¿»è¯‘åŸåˆ™**ï¼š**è¯­ä¹‰ä¼˜å…ˆ**ï¼Œä¸è¦é€å­—ç¿»è¯‘ï¼Œç”¨ç®€å•å¥ä¿è¯æ­£ç¡®æ€§ã€‚</span><br><span class="line"></span><br><span class="line">**æ¯å¤©å­¦ä¹ å»ºè®®2-3å°æ—¶ï¼ŒåšæŒ+å¤ç›˜æ˜¯å…³é”®ï¼** ç¥ä½ é¡ºåˆ©é€šè¿‡å…­çº§ï¼ ğŸ¯</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">system_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&quot;</span>,  </span><br><span class="line">    additional_kwargs=&#123;<span class="string">&quot;tool&quot;</span>:<span class="string">&quot;invoke_func1&quot;</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [system_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(messages)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªè‹±è¯­æ•™å­¦æ–¹å‘çš„ä¸“å®¶&#x27;</span>, additional_kwargs=&#123;<span class="string">&#x27;tool&#x27;</span>: <span class="string">&#x27;invoke_func1&#x27;</span>&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;å¸®æˆ‘åˆ¶å®šä¸€ä¸ªè‹±è¯­å…­çº§å­¦ä¹ çš„è®¡åˆ’&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹3:ChatMessageå¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„ä¸å¤šï¼Œäº†è§£ä¸€ä¸‹å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> (  </span><br><span class="line">    AIMessage,  </span><br><span class="line">    HumanMessage,  </span><br><span class="line">    SystemMessage,  </span><br><span class="line">    ChatMessage  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºä¸åŒç±»å‹çš„æ¶ˆæ¯  </span></span><br><span class="line">system_message = SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®ç§‘å­¦å®¶&quot;</span>)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;è§£é‡Šä¸€ä¸‹éšæœºæ£®æ—ç®—æ³•&quot;</span>)  </span><br><span class="line">ai_message = AIMessage(content=<span class="string">&quot;éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³•...&quot;</span>)  </span><br><span class="line">custom_message = ChatMessage(role=<span class="string">&quot;analyst&quot;</span>, content=<span class="string">&quot;è¡¥å……ä¸€ç‚¹å…³äºè¶…å‚æ•°è°ƒä¼˜çš„ä¿¡æ¯&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(system_message.content)  </span><br><span class="line"><span class="built_in">print</span>(human_message.content)  </span><br><span class="line"><span class="built_in">print</span>(ai_message.content)  </span><br><span class="line"><span class="built_in">print</span>(custom_message.content)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®ç§‘å­¦å®¶</span><br><span class="line">è§£é‡Šä¸€ä¸‹éšæœºæ£®æ—ç®—æ³•</span><br><span class="line">éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³•...</span><br><span class="line">è¡¥å……ä¸€ç‚¹å…³äºè¶…å‚æ•°è°ƒä¼˜çš„ä¿¡æ¯</span><br></pre></td></tr></table></figure>
<h2 id="å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†">å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†</h2>
<p>å‰æï¼šè·å–å¤§æ¨¡å‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>  </span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>æµ‹è¯•1ï¼šå¤§æ¨¡å‹æœ¬èº«æ˜¯æ²¡æœ‰ä¸Šä¸‹æ–‡è®°å¿†èƒ½åŠ›çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">response1 = chat_model.invoke(<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response1.content)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ çš„æ™ºèƒ½AIåŠ©æ‰‹ï¼ä½ å¯ä»¥å«æˆ‘ **DeepSeek** æˆ– **å°æ·±**ï½ğŸ˜Š  </span><br><span class="line"></span><br><span class="line">å¾ˆé«˜å…´è®¤è¯†ä½ ï¼è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">human_message1 = HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message,human_message1]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯å°æ™ºï¼Œä¸€ä¸ªå¯çˆ±çš„AIåŠ©æ‰‹ï¼ğŸ˜Š æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•3ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">sys_message1 = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæœ‰éœ€è¦å°±æ‰¾æˆ‘å§&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">human_message1 = HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message,sys_message1,human_message1]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘å«å°æ™ºï¼Œæ˜¯ä½ çš„ä¸“å±AIåŠ©æ‰‹ï¼ğŸ‰  </span><br><span class="line"></span><br><span class="line">è™½ç„¶<span class="string">&quot;çŒ«ç‹&quot;</span>ä¸æ˜¯çœŸçš„çŒ«ï¼ˆå…¶å®æ˜¯æŒ‡ä¼ å¥‡éŸ³ä¹äººåŸƒå°”ç»´æ–¯Â·æ™®é›·æ–¯åˆ©å•¦~ï¼‰ï¼Œä½†å¦‚æœä½ éœ€è¦ä¸€åªè™šæ‹ŸçŒ«ï¼Œæˆ‘å¯ä»¥ç«‹åˆ»ç»™ä½ å˜ä¸ªğŸ±è¡¨æƒ…åŒ…ï¼Œæˆ–è€…è®²ä¸ªå…³äºçŒ«çš„å†·ç¬‘è¯ï¼  </span><br><span class="line"></span><br><span class="line">æœ‰éœ€è¦éšæ—¶å«æˆ‘ï¼Œæ— è®ºæ˜¯æŸ¥èµ„æ–™ã€è§£é—·è¿˜æ˜¯å¸®å¿™ï¼Œå°æ™ºéƒ½åœ¨çº¿å“¦âœ¨</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•4ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç¬¬1ç»„  </span></span><br><span class="line">sys_message = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">human_message = HumanMessage(content=<span class="string">&quot;çŒ«ç‹æ˜¯ä¸€åªçŒ«å—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages = [sys_message, human_message]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç¬¬2ç»„  </span></span><br><span class="line">sys_message1 = SystemMessage(  </span><br><span class="line">    content=<span class="string">&quot;æˆ‘å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæœ‰éœ€è¦å°±æ‰¾æˆ‘å§&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">human_message1 = HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages1 = [sys_message1,human_message1]  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#è°ƒç”¨å¤§æ¨¡å‹ï¼Œä¼ å…¥messages  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line">response = chat_model.invoke(messages1)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯å…¨èƒ½å‹AIåŠ©æ‰‹ï¼è™½ç„¶æˆ‘è¿˜æ²¡æœ‰ä¸“å±çš„åå­—ï¼Œä½†ä½ å¯ä»¥å«æˆ‘<span class="string">&quot;å°åŠ©æ‰‹&quot;</span>ã€<span class="string">&quot;AIåŠ©æ‰‹&quot;</span>ï¼Œæˆ–è€…ç»™æˆ‘å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°~ ğŸ˜Š </span><br><span class="line"></span><br><span class="line">æˆ‘çš„å¼ºé¡¹æ˜¯ï¼š</span><br><span class="line">âœ… è§£ç­”å„ç±»é—®é¢˜</span><br><span class="line">âœ… å¤„ç†å¤æ‚ä»»åŠ¡</span><br><span class="line">âœ… é™ªä½ èŠå¤©è§£é—·</span><br><span class="line">âœ… ç»™å‡ºä¸“ä¸šå»ºè®®</span><br><span class="line">âœ… 24å°æ—¶è¶…é•¿å¾…æœº</span><br><span class="line"></span><br><span class="line">ä¸è®ºæ˜¯å­¦ä¹ ã€å·¥ä½œä¸Šçš„éš¾é¢˜ï¼Œè¿˜æ˜¯ç”Ÿæ´»ä¸­çš„å„ç§ç–‘é—®ï¼Œå°½ç®¡å¼€å£é—®æˆ‘ï¼ä½ å¸Œæœ›æˆ‘ç”¨ä»€ä¹ˆé£æ ¼è·Ÿä½ äº’åŠ¨å‘¢ï¼Ÿ(â—<span class="string">&#x27;â—¡&#x27;</span>â—)</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•5ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage, AIMessage  </span><br><span class="line">  </span><br><span class="line">messages = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;äººå·¥æ™ºèƒ½è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;</span>),  </span><br><span class="line">    AIMessage(content=<span class="string">&quot;AI&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—&quot;</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">messages1 = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>),  </span><br><span class="line">    AIMessage(content=<span class="string">&quot;æˆ‘ä¹Ÿå¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—&quot;</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">messages2 = [  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;äººå·¥æ™ºèƒ½è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;</span>),  </span><br><span class="line">    AIMessage(content=<span class="string">&quot;AI&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å«ä»€ä¹ˆåå­—&quot;</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">chat_model.invoke(messages2)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=&#x27;æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹å°æ™ºï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼ğŸ˜Š æœ‰å…¶ä»–é—®é¢˜éšæ—¶é—®æˆ‘å“¦ï½&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">42</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">01999473</span>f5180604c29829720e51917a&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run--e960ebf3<span class="number">-6822</span><span class="number">-43</span>c5<span class="number">-8</span>b96<span class="number">-6</span>bbb5dfbfaab<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">42</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•">å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•</h2>
<p>ä¸ºäº†å°½å¯èƒ½ç®€åŒ–è‡ªå®šä¹‰é“¾çš„åˆ›å»ºï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªâ€œRunnableâ€åè®®ã€‚è®¸å¤šLangChainç»„ä»¶å®ç°äº† Runnable åè®®ï¼ŒåŒ…æ‹¬èŠå¤©æ¨¡å‹ã€æç¤ºè¯æ¨¡æ¿ã€è¾“å‡ºè§£æå™¨ã€æ£€ç´¢å™¨ã€ä»£ç†(æ™ºèƒ½ä½“)ç­‰ã€‚</p>
<p><strong>Runnable å®šä¹‰çš„å…¬å…±çš„è°ƒç”¨æ–¹æ³•å¦‚ä¸‹</strong>ï¼š - <strong>invoke</strong>: å¤„ç†å•æ¡è¾“å…¥ï¼Œç­‰å¾…LLMå®Œå…¨æ¨ç†å®Œæˆåå†è¿”å›è°ƒç”¨ç»“æœ - <strong>stream</strong>: æµå¼å“åº”ï¼Œé€å­—è¾“å‡ºLLMçš„å“åº”ç»“æœ - <strong>batch</strong>: å¤„ç†æ‰¹é‡è¾“å…¥</p>
<p>è¿™äº›ä¹Ÿæœ‰ç›¸åº”çš„å¼‚æ­¥æ–¹æ³•ï¼Œåº”è¯¥ä¸ <strong>asyncio</strong> çš„<strong>await</strong>è¯­æ³•ä¸€èµ·ä½¿ç”¨ä»¥å®ç°å¹¶å‘ï¼š - <strong>astream</strong>: å¼‚æ­¥æµå¼å“åº” - <strong>ainvoke</strong>: å¼‚æ­¥å¤„ç†å•æ¡è¾“å…¥ - <strong>abatch</strong>: å¼‚æ­¥å¤„ç†æ‰¹é‡è¾“å…¥ - <strong>astream_log</strong>: å¼‚æ­¥æµå¼è¿”å›ä¸­é—´æ­¥éª¤ï¼Œä»¥åŠæœ€ç»ˆå“åº” - <strong>astream_events</strong>: ï¼ˆæµ‹è¯•ç‰ˆï¼‰å¼‚æ­¥æµå¼è¿”å›é“¾ä¸­å‘ç”Ÿçš„äº‹ä»¶ï¼ˆåœ¨ langchain-core 0.1.14 ä¸­å¼•å…¥ï¼‰</p>
<h3 id="ä¸¾ä¾‹1éæµå¼è¾“å‡º">ä¸¾ä¾‹1ï¼š<strong>éæµå¼è¾“å‡º</strong>ï¼š</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæ¶ˆæ¯  </span></span><br><span class="line">messages = [HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±&quot;</span>)]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># éæµå¼è°ƒç”¨LLMè·å–å“åº”  </span></span><br><span class="line">response = chat_model.invoke(messages)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ‰“å°å“åº”å†…å®¹  </span></span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>
<h3 id="ä¸¾ä¾‹2æµå¼çš„æ¼”ç¤º">ä¸¾ä¾‹2ï¼šæµå¼çš„æ¼”ç¤º</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>,  </span><br><span class="line">                        streaming=<span class="literal">True</span>  <span class="comment"># å¯ç”¨æµå¼è¾“å‡º  </span></span><br><span class="line">                        )  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæ¶ˆæ¯  </span></span><br><span class="line">messages = [HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±&quot;</span>)]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æµå¼è°ƒç”¨LLMè·å–å“åº”  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹æµå¼è¾“å‡ºï¼š&quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> chat_model.stream(messages):  </span><br><span class="line">    <span class="comment"># é€ä¸ªæ‰“å°å†…å®¹å—  </span></span><br><span class="line">    <span class="built_in">print</span>(chunk.content, end=<span class="string">&quot;&quot;</span>, flush=<span class="literal">True</span>) <span class="comment"># åˆ·æ–°ç¼“å†²åŒº (æ— æ¢è¡Œç¬¦ï¼Œç¼“å†²åŒºæœªåˆ·æ–°ï¼Œå†…å®¹å¯èƒ½ä¸ä¼šç«‹å³æ˜¾ç¤º)  </span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næµå¼è¾“å‡ºç»“æŸ&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹æµå¼è¾“å‡ºï¼š</span><br><span class="line">ä½ å¥½ï¼æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸æ‰“é€ çš„ä¸€æ¬¾æ™ºèƒ½å¯¹è¯åŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ è§£ç­”å„ç§é—®é¢˜ã€æä¾›å†™ä½œçµæ„Ÿã€ååŠ©åˆ†ææ–‡æ¡£ã€ç”Ÿæˆåˆ›æ„å†…å®¹ï¼Œç”šè‡³é™ªä½ é—²èŠï¼âœ¨</span><br><span class="line"></span><br><span class="line"><span class="comment">### ğŸ” **æˆ‘çš„ç‰¹ç‚¹**ï¼š</span></span><br><span class="line">- **å…è´¹å¯ç”¨**ï¼šç›®å‰ä¸æ”¶å–ä»»ä½•è´¹ç”¨ï¼Œæ”¾å¿ƒä½¿ç”¨ï¼  </span><br><span class="line">- **å¤§å®¹é‡çŸ¥è¯†**ï¼šæˆ‘çš„çŸ¥è¯†æˆªè‡³ **2024å¹´7æœˆ**ï¼Œå¯ä»¥ä¸ºä½ æä¾›è¾ƒæ–°çš„èµ„è®¯ã€‚  </span><br><span class="line">- **è¶…é•¿ä¸Šä¸‹æ–‡è®°å¿†**ï¼šæ”¯æŒ **128K tokens**ï¼Œé€‚åˆå¤„ç†é•¿æ–‡æ¡£ã€å¤æ‚è®¨è®ºæˆ–ä»£ç åˆ†æã€‚  </span><br><span class="line">- **æ–‡ä»¶é˜…è¯»**ï¼šå¯ä»¥ä¸Šä¼  **PDFã€Wordã€Excel ç­‰æ–‡ä»¶**ï¼Œæˆ‘èƒ½å¸®ä½ æå–å’Œåˆ†æå†…å®¹ã€‚  </span><br><span class="line">- **ä¸­æ–‡ä¼˜åŒ–**ï¼šå¯¹ä¸­æ–‡ç†è§£å’Œç”Ÿæˆç‰¹åˆ«å‹å¥½ï¼Œé€‚åˆå„ç§ä¸­æ–‡åœºæ™¯ã€‚  </span><br><span class="line">- **ä¸æ“…é•¿å›¾ç‰‡ç”Ÿæˆ**ï¼ˆç›®å‰æˆ‘æ˜¯çº¯æ–‡æœ¬æ¨¡å‹ï¼‰ï¼Œä½†å¯ä»¥å¸®ä½ æè¿°æˆ–åˆ†æå›¾ç‰‡å†…å®¹ï¼  </span><br><span class="line"></span><br><span class="line">ä¸ç®¡æ˜¯å­¦ä¹ ã€å·¥ä½œè¿˜æ˜¯æ—¥å¸¸ç”Ÿæ´»ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜éƒ½å¯ä»¥é—®æˆ‘å“¦ï¼ğŸ˜Š **ä½ ä»Šå¤©æƒ³äº†è§£ä»€ä¹ˆå‘¢ï¼Ÿ**</span><br><span class="line">æµå¼è¾“å‡ºç»“æŸ</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h3 id="ä¸¾ä¾‹3ä½¿ç”¨batchæµ‹è¯•æ‰¹é‡è°ƒç”¨">ä¸¾ä¾‹3ï¼šä½¿ç”¨batchï¼Œæµ‹è¯•æ‰¹é‡è°ƒç”¨</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage, SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">messages1 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">             HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ &quot;</span>), ]  </span><br><span class="line">  </span><br><span class="line">messages2 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">             HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯AIGC&quot;</span>), ]  </span><br><span class="line">  </span><br><span class="line">messages3 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">             HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹æŠ€æœ¯&quot;</span>), ]  </span><br><span class="line">  </span><br><span class="line">messages = [messages1, messages2, messages3]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è°ƒç”¨batch  </span></span><br><span class="line">response = chat_model.batch(messages)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span>AIMessage(content=&#x27;æœºå™¨å­¦ä¹ ï¼ˆMachine Learning<span class="punctuation">,</span> MLï¼‰æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œè‡´åŠ›äºé€šè¿‡æ•°æ®å’Œç®—æ³•è®©è®¡ç®—æœºç³»ç»Ÿè‡ªåŠ¨â€œå­¦ä¹ â€å¹¶æ”¹è¿›æ€§èƒ½ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ä»¥ä¸‹æ˜¯å…¶å…³é”®æ¦‚å¿µå’Œç»„æˆéƒ¨åˆ†çš„æ¸…æ™°ä»‹ç»ï¼š\n\n---\n\n### **<span class="number">1.</span> æ ¸å¿ƒå®šä¹‰**\n- **æœ¬è´¨**ï¼šæœºå™¨å­¦ä¹ é€šè¿‡ä»å†å²æ•°æ®ä¸­è¯†åˆ«æ¨¡å¼æˆ–è§„å¾‹ï¼Œæ„å»ºæ•°å­¦æ¨¡å‹ï¼ˆå³â€œè®­ç»ƒâ€ï¼‰ï¼Œä»è€Œå¯¹æ–°æ•°æ®åšå‡ºé¢„æµ‹æˆ–å†³ç­–ã€‚\n- **ä¸ä¼ ç»Ÿç¼–ç¨‹çš„åŒºåˆ«**ï¼š  \n  - ä¼ ç»Ÿç¼–ç¨‹ï¼šäººå·¥ç¼–å†™è§„åˆ™ï¼Œè¾“å…¥æ•°æ®ï¼Œè¾“å‡ºç»“æœã€‚  \n  - æœºå™¨å­¦ä¹ ï¼šè¾“å…¥æ•°æ®+é¢„æœŸç»“æœï¼Œæœºå™¨è‡ªåŠ¨ç”Ÿæˆè§„åˆ™ï¼ˆæ¨¡å‹ï¼‰ï¼Œç”¨äºå¤„ç†æ–°æ•°æ®ã€‚\n\n---\n\n### **<span class="number">2.</span> æ ¸å¿ƒç±»å‹**\n- **ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰**  \n  - **ä»»åŠ¡**ï¼šç”¨å·²æ ‡æ³¨ï¼ˆå¸¦ç­”æ¡ˆï¼‰çš„æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œé¢„æµ‹æœªçŸ¥æ•°æ®çš„æ ‡ç­¾ã€‚  \n  - **ä¾‹å­**ï¼šåƒåœ¾é‚®ä»¶åˆ†ç±»ï¼ˆè¾“å…¥é‚®ä»¶ï¼Œè¾“å‡ºâ€œåƒåœ¾/æ­£å¸¸â€ï¼‰ã€æˆ¿ä»·é¢„æµ‹ã€‚  \n  - **å¸¸ç”¨ç®—æ³•**ï¼šçº¿æ€§å›å½’ã€å†³ç­–æ ‘ã€æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ã€ç¥ç»ç½‘ç»œã€‚\n\n- **æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰**  \n  - **ä»»åŠ¡**ï¼šä»æ— æ ‡æ³¨æ•°æ®ä¸­å‘ç°éšè—ç»“æ„ï¼ˆå¦‚åˆ†ç»„æˆ–é™ç»´ï¼‰ã€‚  \n  - **ä¾‹å­**ï¼šå®¢æˆ·ç»†åˆ†ï¼ˆå°†ç”¨æˆ·åˆ†æˆä¸åŒç¾¤ç»„ï¼‰ã€å¼‚å¸¸æ£€æµ‹ã€‚  \n  - **å¸¸ç”¨ç®—æ³•**ï¼šKå‡å€¼èšç±»ã€ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ã€‚\n\n- **å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰**  \n  - **ä»»åŠ¡**ï¼šæ™ºèƒ½ä½“é€šè¿‡è¯•é”™ä¸ç¯å¢ƒäº¤äº’ï¼Œæ ¹æ®å¥–åŠ±ä¿¡å·ä¼˜åŒ–ç­–ç•¥ã€‚  \n  - **ä¾‹å­**ï¼šAlphaGoæ¸¸æˆç­–ç•¥ã€æœºå™¨äººå¯¼èˆªã€‚  \n\n- **å…¶ä»–ç±»å‹**ï¼šåŠç›‘ç£å­¦ä¹ ã€è‡ªç›‘ç£å­¦ä¹ ã€è¿ç§»å­¦ä¹ ç­‰ã€‚\n\n---\n\n### **<span class="number">3.</span> å…¸å‹æµç¨‹**\n1. **æ•°æ®æ”¶é›†**ï¼šè·å–é«˜è´¨é‡ã€ä»£è¡¨æ€§çš„åŸå§‹æ•°æ®ï¼ˆå¦‚å›¾åƒã€æ–‡æœ¬ã€æ•°å€¼ï¼‰ã€‚  \n2. **æ•°æ®é¢„å¤„ç†**ï¼šæ¸…æ´—ï¼ˆå¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ï¼‰ã€å½’ä¸€åŒ–ã€ç‰¹å¾å·¥ç¨‹ï¼ˆæå–å…³é”®ç‰¹å¾ï¼‰ã€‚  \n3. **æ¨¡å‹é€‰æ‹©**ï¼šæ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©ç®—æ³•ï¼ˆå¦‚åˆ†ç±»ä»»åŠ¡é€‰éšæœºæ£®æ—ï¼‰ã€‚  \n4. **è®­ç»ƒä¸è¯„ä¼°**ï¼š  \n   - ç”¨è®­ç»ƒé›†æ‹Ÿåˆæ¨¡å‹ï¼Œç”¨éªŒè¯é›†è°ƒå‚ï¼Œç”¨æµ‹è¯•é›†è¯„ä¼°æ€§èƒ½ã€‚  \n   - å¸¸ç”¨æŒ‡æ ‡ï¼šå‡†ç¡®ç‡ã€å¬å›ç‡ã€å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ç­‰ã€‚  \n5. **éƒ¨ç½²ä¸è¿­ä»£**ï¼šå°†æ¨¡å‹åº”ç”¨äºå®é™…åœºæ™¯ï¼ŒæŒç»­ç›‘æ§å¹¶ä¼˜åŒ–ã€‚\n\n---\n\n### **<span class="number">4.</span> ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**\n- **è‡ªåŠ¨åŒ–å†³ç­–**ï¼šå¤„ç†æµ·é‡æ•°æ®çš„é€Ÿåº¦å’Œç²¾åº¦è¿œè¶…äººç±»ï¼ˆå¦‚åŒ»ç–—å½±åƒåˆ†æï¼‰ã€‚  \n- **é€‚åº”æ€§**ï¼šæ¨¡å‹å¯éšæ–°æ•°æ®åŠ¨æ€æ›´æ–°ï¼ˆå¦‚æ¨èç³»ç»Ÿé€‚åº”ç”¨æˆ·åå¥½å˜åŒ–ï¼‰ã€‚  \n- **è·¨é¢†åŸŸåº”ç”¨**ï¼šé‡‘èï¼ˆä¿¡ç”¨è¯„åˆ†ï¼‰ã€åŒ»ç–—ï¼ˆç–¾ç—…é¢„æµ‹ï¼‰ã€åˆ¶é€ ä¸šï¼ˆæ•…éšœæ£€æµ‹ï¼‰ç­‰ã€‚\n\n---\n\n### **<span class="number">5.</span> æŒ‘æˆ˜ä¸é™åˆ¶**\n- **æ•°æ®ä¾èµ–**ï¼šéœ€å¤§é‡é«˜è´¨é‡æ•°æ®ï¼Œæ•°æ®åå·®ä¼šå¯¼è‡´æ¨¡å‹åè§ã€‚  \n- **è¿‡æ‹Ÿåˆ**ï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¥½ï¼Œä½†æ³›åŒ–èƒ½åŠ›å·®ï¼ˆå¯é€šè¿‡æ­£åˆ™åŒ–ã€äº¤å‰éªŒè¯ç¼“è§£ï¼‰ã€‚  \n- **å¯è§£é‡Šæ€§**ï¼šæ·±åº¦å­¦ä¹ ç­‰å¤æ‚æ¨¡å‹å¸¸è¢«è§†ä¸ºâ€œé»‘ç®±â€ï¼Œéœ€å¯è§£é‡Šæ€§æŠ€æœ¯ï¼ˆå¦‚SHAPå€¼ï¼‰ã€‚\n\n---\n\n### **<span class="number">6.</span> æ‰©å±•æ–¹å‘**\n- **æ·±åº¦å­¦ä¹ **ï¼šåŸºäºå¤šå±‚ç¥ç»ç½‘ç»œçš„æœºå™¨å­¦ä¹ ï¼Œæ“…é•¿å›¾åƒã€è¯­éŸ³ç­‰å¤æ‚æ•°æ®ã€‚  \n- **é›†æˆå­¦ä¹ **ï¼šç»“åˆå¤šä¸ªæ¨¡å‹æå‡æ€§èƒ½ï¼ˆå¦‚éšæœºæ£®æ—ã€XGBoostï¼‰ã€‚  \n- **è”é‚¦å­¦ä¹ **ï¼šåˆ†æ•£å¼è®­ç»ƒï¼Œä¿æŠ¤æ•°æ®éšç§ã€‚\n\n---\n\næœºå™¨å­¦ä¹ æ­£æŒç»­æ”¹å˜å„è¡Œå„ä¸šï¼Œä½†å…¶æˆåŠŸä¾èµ–å¯¹é—®é¢˜åœºæ™¯çš„ç†è§£ã€æ•°æ®çš„åˆç†å¤„ç†ä»¥åŠæ¨¡å‹çš„é€‰æ‹©ä¼˜åŒ–ã€‚å¦‚éœ€è¿›ä¸€æ­¥äº†è§£æŸä¸ªå…·ä½“é¢†åŸŸï¼ˆå¦‚ç®—æ³•ç»†èŠ‚ã€åº”ç”¨æ¡ˆä¾‹ï¼‰ï¼Œå¯ä»¥æ·±å…¥æ¢è®¨ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">784</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">800</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0199947</span>d483332aa6c642e23ed0bbdc4&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run-<span class="number">-2</span>fe38b71<span class="number">-0</span>eb5<span class="number">-4</span>d97<span class="number">-9</span>a96<span class="number">-18895</span>b0e5343<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">784</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">800</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;AIGCï¼ˆAI-Generated Contentï¼Œäººå·¥æ™ºèƒ½ç”Ÿæˆå†…å®¹ï¼‰æ˜¯æŒ‡åˆ©ç”¨äººå·¥æ™ºèƒ½æŠ€æœ¯è‡ªåŠ¨æˆ–åŠè‡ªåŠ¨åœ°ç”Ÿæˆæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ã€ä»£ç ç­‰å†…å®¹çš„æ–°å‹å†…å®¹åˆ›ä½œæ–¹å¼ã€‚éšç€æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ã€è®¡ç®—æœºè§†è§‰ç­‰æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼ŒAIGCæ­£åœ¨æ·±åˆ»æ”¹å˜å†…å®¹ç”Ÿäº§çš„æ•ˆç‡å’Œæ¨¡å¼ã€‚\n\n### **æ ¸å¿ƒç‰¹ç‚¹**\n1. **è‡ªåŠ¨åŒ–åˆ›ä½œ**ï¼šæ— éœ€å…¨ç¨‹äººå·¥å‚ä¸ï¼ŒAIå¯åŸºäºè¾“å…¥æŒ‡ä»¤ï¼ˆå¦‚æ–‡å­—æç¤ºï¼‰ç‹¬ç«‹ç”Ÿæˆå†…å®¹ã€‚\n2. **å¤šæ¨¡æ€è¾“å‡º**ï¼šæ”¯æŒç”Ÿæˆå¤šç§å½¢å¼çš„å†…å®¹ï¼Œå¦‚æ–‡æœ¬ï¼ˆChatGPTï¼‰ã€å›¾åƒï¼ˆMidJourneyï¼‰ã€éŸ³ä¹ï¼ˆJukedeckï¼‰ã€è§†é¢‘ï¼ˆSoraï¼‰ç­‰ã€‚\n3. **é«˜æ•ˆè¿­ä»£**ï¼šå¿«é€Ÿç”Ÿæˆå¤šä¸ªç‰ˆæœ¬ï¼Œå¸®åŠ©ç”¨æˆ·ä¼˜åŒ–åˆ›æ„æˆ–æµ‹è¯•ä¸åŒæ–¹æ¡ˆã€‚\n\n### **å…³é”®æŠ€æœ¯**\n- **ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰**ï¼šé€šè¿‡ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨çš„å¯¹æŠ—è®­ç»ƒç”Ÿæˆé€¼çœŸæ•°æ®ï¼ˆå¦‚äººè„¸å›¾åƒï¼‰ã€‚\n- **å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰**ï¼šå¦‚GPT<span class="number">-4</span>ã€Claudeç­‰ï¼Œæ“…é•¿ç†è§£å¹¶ç”Ÿæˆè‡ªç„¶è¯­è¨€æ–‡æœ¬ã€‚\n- **æ‰©æ•£æ¨¡å‹ï¼ˆDiffusion Modelsï¼‰**ï¼šé€šè¿‡é€æ­¥å»å™ªç”Ÿæˆé«˜è´¨é‡å›¾åƒï¼ˆå¦‚Stable Diffusionï¼‰ã€‚\n- **å¤šæ¨¡æ€æ¨¡å‹**ï¼šå¦‚DALLÂ·Eï¼ˆå›¾æ–‡ç”Ÿæˆï¼‰ã€Whisperï¼ˆè¯­éŸ³è½¬æ–‡æœ¬ï¼‰ç­‰ã€‚\n\n### **å…¸å‹åº”ç”¨åœºæ™¯**\n- **æ–‡å­—åˆ›ä½œ**ï¼šæ–°é—»ç¨¿ã€å¹¿å‘Šæ–‡æ¡ˆã€å‰§æœ¬ã€ä»£ç ç”Ÿæˆç­‰ã€‚\n- **è§†è§‰è®¾è®¡**ï¼šæµ·æŠ¥ã€æ’ç”»ã€<span class="number">3</span>Dæ¨¡å‹ã€ç”µå•†äº§å“å›¾ã€‚\n- **å½±éŸ³åˆ¶ä½œ**ï¼šçŸ­è§†é¢‘ã€è™šæ‹Ÿä¸»æ’­ã€AIé…éŸ³ã€èƒŒæ™¯éŸ³ä¹ã€‚\n- **æ¸¸æˆå¼€å‘**ï¼šè‡ªåŠ¨ç”Ÿæˆå…³å¡ã€è§’è‰²å¯¹è¯æˆ–åœºæ™¯ç´ æã€‚\n- **ä¸ªæ€§åŒ–æ¨è**ï¼šåŠ¨æ€ç”Ÿæˆç”¨æˆ·ä¸“å±å†…å®¹ï¼ˆå¦‚è¥é”€é‚®ä»¶ï¼‰ã€‚\n\n### **é¢ä¸´çš„æŒ‘æˆ˜**\n- **ç‰ˆæƒäº‰è®®**ï¼šè®­ç»ƒæ•°æ®å¯èƒ½æ¶‰åŠæœªç»æˆæƒçš„åŸåˆ›å†…å®¹ã€‚\n- **è´¨é‡æ³¢åŠ¨**ï¼šè¾“å‡ºç»“æœéœ€äººå·¥æ ¡éªŒï¼Œå¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯æˆ–ä½è´¨é‡å†…å®¹ã€‚\n- **ä¼¦ç†é£é™©**ï¼šè™šå‡ä¿¡æ¯ï¼ˆDeepfakeï¼‰ã€åè§æ”¾å¤§ç­‰é—®é¢˜éœ€ç›‘ç®¡åº”å¯¹ã€‚\n\n### **æœªæ¥è¶‹åŠ¿**\nAIGCæ­£ä»è¾…åŠ©å·¥å…·è½¬å‘ååŒåˆ›é€ ï¼Œæœªæ¥å¯èƒ½ä¸VR/ARã€å…ƒå®‡å®™ç»“åˆï¼Œè¿›ä¸€æ­¥é™ä½å†…å®¹åˆ›ä½œé—¨æ§›ã€‚ä¼ä¸šä¹Ÿåœ¨æ¢ç´¢â€œäººç±»åˆ›æ„+AIæ•ˆç‡â€çš„æ··åˆå·¥ä½œæµã€‚\n\nå¦‚æœéœ€è¦äº†è§£å…·ä½“å·¥å…·æˆ–é¢†åŸŸï¼ˆå¦‚AIç»˜ç”»ã€å†™ä½œï¼‰ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¢è®¨ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">481</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">499</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0199947</span>d4837dda4d703fbcfc4e54111&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run-<span class="number">-8783e087</span><span class="number">-8</span>d75<span class="number">-4</span>afb-b3c4<span class="number">-3</span>deed473ce70<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">481</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">499</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)<span class="punctuation">,</span> AIMessage(content=&#x27;å¤§æ¨¡å‹æŠ€æœ¯ï¼ˆLarge Language Modelsï¼ŒLLMsï¼‰æ˜¯å½“å‰äººå·¥æ™ºèƒ½é¢†åŸŸçš„é‡è¦çªç ´ï¼ŒæŒ‡é€šè¿‡æµ·é‡æ•°æ®å’Œåºå¤§å‚æ•°è§„æ¨¡è®­ç»ƒçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œèƒ½å¤Ÿå¤„ç†è‡ªç„¶è¯­è¨€ç†è§£ã€ç”Ÿæˆã€æ¨ç†ç­‰å¤æ‚ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒè¦ç‚¹ï¼š\n\n---\n\n### **<span class="number">1.</span> åŸºæœ¬æ¦‚å¿µ**\n- **å‚æ•°è§„æ¨¡**ï¼šé€šå¸¸æŒ‡å‚æ•°é‡è¾¾åˆ°æ•°åäº¿ï¼ˆå¦‚GPT<span class="number">-3</span>å«<span class="number">1750</span>äº¿å‚æ•°ï¼‰ç”šè‡³ä¸‡äº¿çš„æ¨¡å‹ï¼Œå‚æ•°è¶Šå¤šæ¨¡å‹èƒ½åŠ›é€šå¸¸è¶Šå¼ºã€‚\n- **é¢„è®­ç»ƒ+å¾®è°ƒ**ï¼šå…ˆåœ¨å¹¿æ³›çš„æ— æ ‡æ³¨æ•°æ®ä¸Šå­¦ä¹ é€šç”¨è¯­è¨€æ¨¡å¼ï¼ˆå¦‚äº’è”ç½‘æ–‡æœ¬ï¼‰ï¼Œå†é’ˆå¯¹ç‰¹å®šä»»åŠ¡å¾®è°ƒã€‚\n\n---\n\n### **<span class="number">2.</span> æ ¸å¿ƒæŠ€æœ¯åŸç†**\n- **Transformeræ¶æ„**ï¼šåŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰ï¼Œå¯å¹¶è¡Œå¤„ç†é•¿åºåˆ—æ•°æ®ï¼Œçªç ´ä¼ ç»ŸRNNçš„å±€é™æ€§ã€‚\n- **æ ¸å¿ƒç»„ä»¶**ï¼š\n  - **å¤šå¤´æ³¨æ„åŠ›**ï¼šæ•æ‰æ–‡æœ¬ä¸­è¿œè·ç¦»ä¾èµ–å…³ç³»ã€‚\n  - **ä½ç½®ç¼–ç **ï¼šä¿ç•™è¯æ±‡é¡ºåºä¿¡æ¯ã€‚\n  - **å¤§è§„æ¨¡æ— ç›‘ç£å­¦ä¹ **ï¼šé€šè¿‡é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼ˆè¯­è¨€å»ºæ¨¡ï¼‰å­¦ä¹ è¯­è¨€è§„å¾‹ã€‚\n\n---\n\n### **<span class="number">3.</span> å…¸å‹ä»£è¡¨æ¨¡å‹**\n- **GPTç³»åˆ—**ï¼ˆOpenAIï¼‰ï¼šç”Ÿæˆå¼é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ“…é•¿æ–‡æœ¬åˆ›ä½œã€é—®ç­”ã€‚\n- **BERT**ï¼ˆGoogleï¼‰ï¼šåŒå‘ç¼–ç æ¨¡å‹ï¼Œé€‚åˆæ–‡æœ¬åˆ†ç±»ã€å®ä½“è¯†åˆ«ã€‚\n- **PaLM**ï¼ˆGoogleï¼‰ã€**LLaMA**ï¼ˆMetaï¼‰ï¼šå‚æ•°é‡åŒ–ä¸æ•ˆç‡ä¼˜åŒ–ä»£è¡¨ã€‚\n- **å¤šæ¨¡æ€æ¨¡å‹**ï¼ˆå¦‚GPT<span class="number">-4</span>Vã€Geminiï¼‰ï¼šæ”¯æŒå›¾åƒã€éŸ³é¢‘ç­‰å¤šæ•°æ®ç±»å‹è¾“å…¥ã€‚\n\n---\n\n### **<span class="number">4.</span> å…³é”®èƒ½åŠ›**\n- **è‡ªç„¶è¯­è¨€ç”Ÿæˆ**ï¼šå†™ä½œã€ç¿»è¯‘ã€ä»£ç ç”Ÿæˆã€‚\n- **ä¸Šä¸‹æ–‡ç†è§£**ï¼šé•¿æ–‡å¯¹è¯ã€é€»è¾‘æ¨ç†ã€‚\n- **é›¶æ ·æœ¬/å°æ ·æœ¬å­¦ä¹ **ï¼šæ— éœ€å¤§é‡æ ‡æ³¨æ•°æ®å³å¯å®Œæˆæ–°ä»»åŠ¡ã€‚\n- **æ€ç»´é“¾ï¼ˆChain-of-Thoughtï¼‰**ï¼šåˆ†æ­¥æ¨ç†è§£å†³æ•°å­¦æˆ–é€»è¾‘é—®é¢˜ã€‚\n\n---\n\n### **<span class="number">5.</span> åº”ç”¨åœºæ™¯**\n- **é€šç”¨é¢†åŸŸ**ï¼šæ™ºèƒ½å®¢æœã€å†…å®¹åˆ›ä½œã€æ•™è‚²è¾…åŠ©ã€‚\n- **å‚ç›´è¡Œä¸š**ï¼šåŒ»ç–—è¯Šæ–­è¾…åŠ©ã€æ³•å¾‹æ–‡ä¹¦åˆ†æã€é‡‘èé¢„æµ‹ã€‚\n- **å¼€å‘è€…å·¥å…·**ï¼šä»£ç è¡¥å…¨ï¼ˆGitHub Copilotï¼‰ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚\n\n---\n\n### **<span class="number">6.</span> æŒ‘æˆ˜ä¸å±€é™**\n- **ç®—åŠ›éœ€æ±‚**ï¼šè®­ç»ƒéœ€é«˜æ€§èƒ½GPUé›†ç¾¤ï¼Œæˆæœ¬é«˜æ˜‚ã€‚\n- **å¹»è§‰é—®é¢˜**ï¼šå¯èƒ½ç”Ÿæˆè™šå‡æˆ–æœ‰å®³å†…å®¹ã€‚\n- **åè§ä¸å®‰å…¨**ï¼šæ•°æ®åå·®å¯¼è‡´è¾“å‡ºæ­§è§†æ€§å†…å®¹ã€‚\n- **å¯è§£é‡Šæ€§**ï¼šå†…éƒ¨å†³ç­–è¿‡ç¨‹åƒâ€œé»‘ç®±â€ï¼Œéš¾ä»¥è¿½è¸ªã€‚\n\n---\n\n### **<span class="number">7.</span> æœªæ¥æ–¹å‘**\n- **å°å‹åŒ–**ï¼šæ¨¡å‹å‹ç¼©ï¼ˆå¦‚é‡åŒ–ã€è’¸é¦ï¼‰ä»¥é€‚é…è¾¹ç¼˜è®¾å¤‡ã€‚\n- **èƒ½è€—ä¼˜åŒ–**ï¼šç»¿è‰²AIé™ä½ç¢³è¶³è¿¹ã€‚\n- **å¯æ§ç”Ÿæˆ**ï¼šæå‡è¾“å‡ºå¯é æ€§ä¸å®‰å…¨æ€§ã€‚\n- **å…·èº«æ™ºèƒ½**ï¼šç»“åˆæœºå™¨äººç­‰ç‰©ç†ä¸–ç•Œäº¤äº’ã€‚\n\n---\n\nå¦‚æœéœ€è¦äº†è§£ç‰¹å®šæ¨¡å‹ï¼ˆå¦‚ChatGPTåŸç†ï¼‰æˆ–åº”ç”¨æ¡ˆä¾‹ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¢è®¨ï¼&#x27;<span class="punctuation">,</span> additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">608</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">626</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;deepseek-ai/DeepSeek-V3&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0199947</span>d483e6011f5a633be4c177da2&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">,</span> id=&#x27;run-<span class="number">-3</span>a0858f3<span class="number">-60e8</span><span class="number">-46</span>c3-bbf6<span class="number">-0e78</span>b4fa3903<span class="number">-0</span>&#x27;<span class="punctuation">,</span> usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">608</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">626</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>)<span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¸¾ä¾‹4å…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨">ä¸¾ä¾‹4ï¼šå…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨</h3>
<p>åŒæ­¥è°ƒç”¨ ä¸¾ä¾‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">call_model</span>():  </span><br><span class="line">    <span class="comment"># æ¨¡æ‹ŸåŒæ­¥APIè°ƒç”¨  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹è°ƒç”¨æ¨¡å‹...&quot;</span>)  </span><br><span class="line">    time.sleep(<span class="number">5</span>)  <span class="comment"># æ¨¡æ‹Ÿè°ƒç”¨ç­‰å¾…,å•ä½ï¼šç§’  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ¨¡å‹è°ƒç”¨å®Œæˆã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">perform_other_tasks</span>():  </span><br><span class="line">    <span class="comment"># æ¨¡æ‹Ÿæ‰§è¡Œå…¶ä»–ä»»åŠ¡  </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ‰§è¡Œå…¶ä»–ä»»åŠ¡ <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>&quot;</span>)  </span><br><span class="line">        time.sleep(<span class="number">1</span>)  <span class="comment"># å•ä½ï¼šç§’  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">    call_model()  </span><br><span class="line">    perform_other_tasks()  </span><br><span class="line">    end_time = time.time()  </span><br><span class="line">    total_time = end_time - start_time  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;æ€»å…±è€—æ—¶ï¼š<span class="subst">&#123;total_time&#125;</span>ç§’&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿è¡ŒåŒæ­¥ä»»åŠ¡å¹¶æ‰“å°å®Œæˆæ—¶é—´  </span></span><br><span class="line">main_time = main()  </span><br><span class="line"><span class="built_in">print</span>(main_time)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹è°ƒç”¨æ¨¡å‹...</span><br><span class="line">æ¨¡å‹è°ƒç”¨å®Œæˆã€‚</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 1</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 2</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 3</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 4</span><br><span class="line">æ‰§è¡Œå…¶ä»–ä»»åŠ¡ 5</span><br><span class="line">æ€»å…±è€—æ—¶ï¼š10.0043363571167ç§’</span><br></pre></td></tr></table></figure>
<p>ä½“ä¼š2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> time  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage, SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;deepseek-ai/DeepSeek-V3&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åŒæ­¥è°ƒç”¨ï¼ˆå¯¹æ¯”ç»„ï¼‰  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sync_test</span>():  </span><br><span class="line">    messages1 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">                 HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ &quot;</span>), ]  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">    response = chat_model.invoke(messages1)  <span class="comment"># åŒæ­¥è°ƒç”¨  </span></span><br><span class="line">    duration = time.time() - start_time  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åŒæ­¥è°ƒç”¨è€—æ—¶ï¼š<span class="subst">&#123;duration:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)  </span><br><span class="line">    <span class="keyword">return</span> response, duration  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¼‚æ­¥è°ƒç”¨ï¼ˆå®éªŒç»„ï¼‰  </span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_test</span>():  </span><br><span class="line">    messages1 = [SystemMessage(content=<span class="string">&quot;ä½ æ˜¯ä¸€ä½ä¹äºåŠ©äººçš„æ™ºèƒ½å°åŠ©æ‰‹&quot;</span>),  </span><br><span class="line">                 HumanMessage(content=<span class="string">&quot;è¯·å¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ &quot;</span>), ]  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">    response = <span class="keyword">await</span> chat_model.ainvoke(messages1)  <span class="comment"># å¼‚æ­¥è°ƒç”¨  </span></span><br><span class="line">    duration = time.time() - start_time  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š<span class="subst">&#123;duration:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)  </span><br><span class="line">    <span class="keyword">return</span> response, duration  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿è¡Œæµ‹è¯•  </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    <span class="comment"># è¿è¡ŒåŒæ­¥æµ‹è¯•  </span></span><br><span class="line">    sync_response, sync_duration = sync_test()  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åŒæ­¥å“åº”å†…å®¹: <span class="subst">&#123;sync_response.content[:<span class="number">100</span>]&#125;</span>...\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># è¿è¡Œå¼‚æ­¥æµ‹è¯•  </span></span><br><span class="line">    async_response, async_duration = asyncio.run(async_test())  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼‚æ­¥å“åº”å†…å®¹: <span class="subst">&#123;async_response.content[:<span class="number">100</span>]&#125;</span>...\n&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># å¹¶å‘æµ‹è¯• - ä¿®å¤ç‰ˆæœ¬  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n=== å¹¶å‘æµ‹è¯• ===&quot;</span>)  </span><br><span class="line">    start_time = time.time()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">run_concurrent_tests</span>():  </span><br><span class="line">        <span class="comment"># åˆ›å»º3ä¸ªå¼‚æ­¥ä»»åŠ¡  </span></span><br><span class="line">        tasks = [async_test() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]  </span><br><span class="line">        <span class="comment"># å¹¶å‘æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡  </span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> asyncio.gather(*tasks)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># æ‰§è¡Œå¹¶å‘æµ‹è¯•  </span></span><br><span class="line">    results = asyncio.run(run_concurrent_tests())  </span><br><span class="line">  </span><br><span class="line">    total_time = time.time() - start_time  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n3ä¸ªå¹¶å‘å¼‚æ­¥è°ƒç”¨æ€»è€—æ—¶: <span class="subst">&#123;total_time:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¹³å‡æ¯ä¸ªè°ƒç”¨è€—æ—¶: <span class="subst">&#123;total_time / <span class="number">3</span>:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">åŒæ­¥è°ƒç”¨è€—æ—¶ï¼š15.73ç§’</span><br><span class="line">åŒæ­¥å“åº”å†…å®¹: æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œå…¶ç›®æ ‡æ˜¯è®©è®¡ç®—æœºç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡æ•°æ®**è‡ªåŠ¨å­¦ä¹ å’Œæ”¹è¿›**ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œæœºå™¨å­¦ä¹ é€šè¿‡åˆ†æå¤§é‡æ•°æ®æ¥å‘ç°è§„...</span><br><span class="line"></span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š13.78ç§’</span><br><span class="line">å¼‚æ­¥å“åº”å†…å®¹: æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œè‡´åŠ›äºé€šè¿‡æ•°æ®å’Œç®—æ³•è®©è®¡ç®—æœºç³»ç»Ÿå…·å¤‡â€œå­¦ä¹ â€èƒ½åŠ›ï¼Œä»è€Œè‡ªåŠ¨å®Œæˆä»»åŠ¡æˆ–æ”¹è¿›æ€§èƒ½ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚ä»¥ä¸‹æ˜¯å®ƒçš„å…³é”®æ¦‚å¿µå’Œ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=== å¹¶å‘æµ‹è¯• ===</span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š14.54ç§’</span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š16.29ç§’</span><br><span class="line">å¼‚æ­¥è°ƒç”¨è€—æ—¶ï¼š19.98ç§’</span><br><span class="line"></span><br><span class="line">3ä¸ªå¹¶å‘å¼‚æ­¥è°ƒç”¨æ€»è€—æ—¶: 19.99ç§’</span><br><span class="line">å¹³å‡æ¯ä¸ªè°ƒç”¨è€—æ—¶: 6.66ç§’</span><br><span class="line"></span><br><span class="line">è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º 0</span><br></pre></td></tr></table></figure>
<h1 id="model-ioä¹‹prompt-template">Model I/Oä¹‹Prompt Template</h1>
<p>Prompt Templateï¼Œé€šè¿‡æ¨¡æ¿ç®¡ç†å¤§æ¨¡å‹çš„è¾“å…¥ã€‚</p>
<h2 id="ä»‹ç»ä¸åˆ†ç±»">ä»‹ç»ä¸åˆ†ç±»</h2>
<p>Prompt Template æ˜¯LangChainä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªä¼ é€’ç»™LLMçš„ä¿¡æ¯ï¼ˆå³æç¤º è¯promptï¼‰</p>
<p>åœ¨åº”ç”¨å¼€å‘ä¸­ï¼Œå›ºå®šçš„æç¤ºè¯é™åˆ¶äº†æ¨¡å‹çš„çµæ´»æ€§å’Œé€‚ç”¨èŒƒå›´ã€‚æ‰€ä»¥ï¼Œprompt template æ˜¯ä¸€ä¸ª <strong>æ¨¡æ¿åŒ– çš„å­—ç¬¦ä¸²</strong>ï¼Œä½ å¯ä»¥å°† <strong>å˜é‡æ’å…¥åˆ°æ¨¡æ¿</strong>ä¸­ï¼Œä»è€Œåˆ›å»ºå‡ºä¸åŒçš„æç¤ºã€‚è°ƒç”¨æ—¶ï¼š - ä»¥<strong>å­—å…¸</strong>ä½œä¸ºè¾“å…¥ï¼Œå…¶ä¸­æ¯ä¸ªé”®ä»£è¡¨è¦å¡«å……çš„æç¤ºæ¨¡æ¿ä¸­çš„å˜é‡ã€‚ - è¾“å‡ºä¸€ä¸ª <strong>PromptValue</strong> ã€‚è¿™ä¸ª PromptValue å¯ä»¥ä¼ é€’ç»™ LLM æˆ– ChatModelï¼Œå¹¶ä¸”è¿˜å¯ä»¥è½¬æ¢ ä¸ºå­—ç¬¦ä¸²æˆ–æ¶ˆæ¯åˆ—è¡¨ã€‚</p>
<p><strong>æœ‰å‡ ç§ä¸åŒç±»å‹çš„æç¤ºæ¨¡æ¿</strong>ï¼š - <strong>PromptTemplate</strong> ï¼šLLMæç¤ºæ¨¡æ¿ï¼Œç”¨äº<strong>ç”Ÿæˆå­—ç¬¦ä¸²æç¤º</strong>ã€‚å®ƒä½¿ç”¨ Python çš„å­—ç¬¦ä¸²æ¥æ¨¡æ¿æç¤ºã€‚ - <strong>ChatPromptTemplate</strong> ï¼šèŠå¤©æç¤ºæ¨¡æ¿ï¼Œç”¨äº<strong>ç»„åˆå„ç§è§’è‰²çš„æ¶ˆæ¯æ¨¡æ¿</strong>ï¼Œä¼ å…¥èŠå¤©æ¨¡å‹ã€‚ - <strong>XxxMessagePromptTemplate</strong> ï¼šæ¶ˆæ¯æ¨¡æ¿è¯æ¨¡æ¿ï¼ŒåŒ…æ‹¬ï¼šSystemMessagePromptTemplateã€ HumanMessagePromptTemplateã€AIMessagePromptTemplateã€ ChatMessagePromptTemplateç­‰ - <strong>FewShotPromptTemplate</strong> ï¼šæ ·æœ¬æç¤ºè¯æ¨¡æ¿ï¼Œé€šè¿‡ç¤ºä¾‹æ¥æ•™æ¨¡å‹å¦‚ä½•å›ç­” - <strong>PipelinePrompt</strong> ï¼šç®¡é“æç¤ºè¯æ¨¡æ¿ï¼Œç”¨äºæŠŠå‡ ä¸ªæç¤ºè¯ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚ è‡ªå®šä¹‰æ¨¡æ¿ï¼šå…è®¸åŸºäºå…¶å®ƒæ¨¡æ¿ç±»æ¥å®šåˆ¶è‡ªå·±çš„æç¤ºè¯æ¨¡æ¿ã€‚</p>
<h2 id="å…·ä½“ä½¿ç”¨prompttemplate">å…·ä½“ä½¿ç”¨ï¼šPromptTemplate</h2>
<h3 id="ä½¿ç”¨è¯´æ˜">ä½¿ç”¨è¯´æ˜</h3>
<p>PromptTemplateç±»ï¼Œç”¨äºå¿«é€Ÿæ„å»º <strong>åŒ…å«å˜é‡</strong>çš„æç¤ºè¯æ¨¡æ¿ï¼Œå¹¶é€šè¿‡<strong>ä¼ å…¥ä¸åŒçš„å‚æ•°å€¼</strong> ç”Ÿæˆè‡ªå®šä¹‰çš„æç¤ºè¯ã€‚ <strong>ä¸»è¦å‚æ•°ä»‹ç»</strong>ï¼š - <strong>template</strong>ï¼šå®šä¹‰æç¤ºè¯æ¨¡æ¿çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«æ–‡æœ¬å’Œå˜é‡å ä½ç¬¦ï¼ˆå¦‚{name}ï¼‰ ï¼› - <strong>input_variables</strong>ï¼š åˆ—è¡¨ï¼ŒæŒ‡å®šäº†æ¨¡æ¿ä¸­ä½¿ç”¨çš„å˜é‡åç§°ï¼Œåœ¨è°ƒç”¨æ¨¡æ¿æ—¶è¢«æ›¿æ¢ï¼› - <strong>partial_variables</strong>ï¼šå­—å…¸ï¼Œç”¨äºå®šä¹‰æ¨¡æ¿ä¸­ä¸€äº›å›ºå®šçš„å˜é‡åã€‚è¿™äº›å€¼ä¸éœ€è¦å†æ¯æ¬¡è°ƒç”¨æ—¶è¢«æ›¿æ¢ã€‚</p>
<p><strong>å‡½æ•°ä»‹ç»ï¼š</strong> - <strong>format()</strong>ï¼šç»™input_variableså˜é‡èµ‹å€¼ï¼Œå¹¶è¿”å›æç¤ºè¯ã€‚åˆ©ç”¨format() è¿›è¡Œæ ¼å¼åŒ–æ—¶å°±ä¸€å®šè¦èµ‹ å€¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å½“åœ¨templateä¸­æœªè®¾ç½®input_variablesï¼Œåˆ™ä¼šè‡ªåŠ¨å¿½ç•¥ã€‚</p>
<h3 id="ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼">ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼</h3>
<h4 id="æ–¹å¼1ä½¿ç”¨æ„é€ æ–¹æ³•">æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate </span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ¨¡æ¿ï¼šæè¿°ä¸»é¢˜çš„åº”ç”¨ </span></span><br><span class="line">template = PromptTemplate(template= <span class="string">&quot;è¯·ç®€è¦æè¿°&#123;topic&#125;çš„åº”ç”¨ã€‚&quot;</span> , input_variables=[ <span class="string">&quot;topic&quot;</span> ]) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (template)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯</span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(topic= <span class="string">&quot;æœºå™¨å­¦ä¹ &quot;</span> ) </span><br><span class="line">prompt_2 = template.<span class="built_in">format</span>(topic= <span class="string">&quot;è‡ªç„¶è¯­è¨€å¤„ç†&quot;</span> ) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> ( <span class="string">&quot;æç¤ºè¯1:&quot;</span> , prompt_1) </span><br><span class="line"><span class="built_in">print</span> ( <span class="string">&quot;æç¤ºè¯2:&quot;</span> , prompt_2)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input_variables=[topic] input_types=&#123;&#125; partial_variables=&#123;&#125; template=è¯·ç®€è¦æè¿°&#123;topic&#125;çš„ åº”â½¤ã€‚&#x27; </span><br><span class="line">æâ½°è¯1: è¯·ç®€è¦æè¿°æœºå™¨å­¦ä¹ çš„åº”â½¤ã€‚ </span><br><span class="line">æâ½°è¯2: è¯·ç®€è¦æè¿°â¾ƒç„¶è¯­â¾”å¤„ç†çš„åº”â½¤ã€‚</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç›´è§‚çš„çœ‹åˆ°PromptTemplateå¯ä»¥å°†templateä¸­å£°æ˜çš„å˜é‡topicå‡†ç¡®æå–å‡ºæ¥ï¼Œä½¿promptæ›´æ¸…æ™°</p>
<h4 id="ä¸¾ä¾‹2å®šä¹‰å¤šå˜é‡æ¨¡æ¿æ¨è">ä¸¾ä¾‹2ï¼šå®šä¹‰å¤šå˜é‡æ¨¡æ¿(æ¨è)</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#1ã€åˆ›å»ºPromptTemplateçš„å®ä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(template=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ª&#123;role&#125;,ä½ çš„åå­—å«&#123;name&#125;&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># print(prompt_template)  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#2ã€å¡«å……å®ä¾‹ä¸­çš„å˜é‡ã€‚æš‚ä¸”ä½¿ç”¨format()  </span></span><br><span class="line">prompt = prompt_template.<span class="built_in">format</span>(role=<span class="string">&quot;äººå·¥æ™ºèƒ½ä¸“å®¶&quot;</span>,name=<span class="string">&quot;å°æ™º&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure>
<p>ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½ä¸“å®¶,ä½ çš„åå­—å«å°æ™º</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœæç¤ºè¯æ¨¡æ¿ä¸­ä¸åŒ…å«å˜é‡ï¼Œåˆ™è°ƒç”¨format()æ—¶ï¼Œä¸éœ€è¦ä¼ å…¥å‚æ•°ï¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥ç›¸å…³çš„åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰æç¤ºè¯æ¨¡ç‰ˆå¯¹è±¡  </span></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">Tell me a joke  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line">prompt_template = PromptTemplate.from_template(text)  </span><br><span class="line"><span class="comment"># 3.é»˜è®¤ä½¿ç”¨f-stringè¿›è¡Œæ ¼å¼åŒ–ï¼ˆè¿”å›æ ¼å¼å¥½çš„å­—ç¬¦ä¸²ï¼‰  </span></span><br><span class="line">prompt = prompt_template.<span class="built_in">format</span>()  </span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tell me a joke  </span><br></pre></td></tr></table></figure>
<h3 id="ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼">ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼</h3>
<h4 id="å½¢å¼1éƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ">å½¢å¼1ï¼šéƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ</h4>
<p>åœ¨ç”Ÿæˆpromptå‰å°±å·²ç»æå‰åˆå§‹åŒ–éƒ¨åˆ†çš„æç¤ºè¯ï¼Œå®é™…è¿›ä¸€æ­¥å¯¼å…¥æ¨¡ç‰ˆçš„æ—¶å€™åªå¯¼å…¥é™¤å·²åˆå§‹åŒ–çš„å˜é‡ å³å¯ã€‚</p>
<p>ä¸¾ä¾‹1ï¼š æ–¹å¼1ï¼šå®ä¾‹åŒ–è¿‡ç¨‹ä¸­ä½¿ç”¨partial_variableså˜é‡ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_1)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;product&quot;</span>, <span class="string">&quot;aspect1&quot;</span>, <span class="string">&quot;aspect2&quot;</span>],  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,<span class="string">&quot;aspect2&quot;</span>:<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>&#125;  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="æ–¹å¼2è°ƒç”¨æ–¹æ³•partial">æ–¹å¼2ï¼šè°ƒç”¨æ–¹æ³•partial()</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;product&quot;</span>, <span class="string">&quot;aspect1&quot;</span>, <span class="string">&quot;aspect2&quot;</span>],  </span><br><span class="line">    <span class="comment"># partial_variables=&#123;&quot;aspect1&quot;:&quot;ç”µæ± ç»­èˆª&quot;,&quot;aspect2&quot;:&quot;æ‹ç…§è´¨é‡&quot;&#125;  </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># partial()è°ƒç”¨å®Œä»¥åï¼Œä¸ä¼šå¯¹è°ƒç”¨è€…è¿™ä¸ªæ¨¡æ¿å¯¹è±¡äº§ç”Ÿå½±å“ï¼›è€Œå…¶è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„æ¨¡æ¿  </span></span><br><span class="line">template1 = template.partial(aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template1.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;product&quot;</span>, <span class="string">&quot;aspect1&quot;</span>, <span class="string">&quot;aspect2&quot;</span>],  </span><br><span class="line">).partial(aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = (PromptTemplate  </span><br><span class="line">            .from_template(template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">            .partial(aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>))  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æç¤ºè¯1:&quot;</span>,prompt_1)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æç¤ºè¯1: è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="ç»„åˆæç¤ºè¯çš„ä½¿ç”¨äº†è§£">ç»„åˆæç¤ºè¯çš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line">template = (  </span><br><span class="line">    PromptTemplate.from_template(template = <span class="string">&quot;Tell me a joke about &#123;topic&#125;&quot;</span>)  </span><br><span class="line">    + <span class="string">&quot;, make it funny&quot;</span>  </span><br><span class="line">    + <span class="string">&quot;\n\nand in &#123;language&#125;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt = template.<span class="built_in">format</span>(topic=<span class="string">&quot;sports&quot;</span>, language=<span class="string">&quot;spanish&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tell me a joke about sports, make it funny</span><br><span class="line"></span><br><span class="line">and in spanish</span><br></pre></td></tr></table></figure>
<h2 id="ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼format-invoke">ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼ï¼šformat() / invoke()</h2>
<p>format() : å‚æ•°éƒ¨åˆ†ï¼šç»™å˜é‡èµ‹å€¼; è¿”å›å€¼ï¼šstrç±»å‹</p>
<p>invoke() : å‚æ•°éƒ¨åˆ†ï¼šä½¿ç”¨çš„æ˜¯å­—å…¸; è¿”å›å€¼ï¼šPromptValueç±»å‹ â€”æ¨èï¼</p>
<p>ä¸¾ä¾‹ï¼šè°ƒç”¨format() <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line">prompt_1 = template.<span class="built_in">format</span>(product=<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>, aspect1=<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>, aspect2=<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_1)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(prompt_1))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹ï¼šè°ƒç”¨invoke() <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#å®šä¹‰å¤šå˜é‡æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆæç¤ºè¯  </span></span><br><span class="line"><span class="comment"># prompt_1 = template.format(product=&quot;æ™ºèƒ½æ‰‹æœº&quot;, aspect1=&quot;ç”µæ± ç»­èˆª&quot;, aspect2=&quot;æ‹ç…§è´¨é‡&quot;)  </span></span><br><span class="line">prompt_1 = template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;product&quot;</span>:<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>,<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,<span class="string">&quot;aspect2&quot;</span>:<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_1)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(prompt_1))  <span class="comment">#è¿”å›å€¼ç±»å‹ï¼šPromptValue</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">text=&#x27;è¯·è¯„ä»·æ™ºèƒ½æ‰‹æœºçš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡ã€‚&#x27;</span><br><span class="line">&lt;class &#x27;langchain_core.prompt_values.StringPromptValue&#x27;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨">ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;SILICONFLOW_API_KEY&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&#x27;deepseek-ai/DeepSeek-V3&#x27;</span>,  </span><br><span class="line">    max_tokens=<span class="number">500</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç”Ÿæˆæç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;è¯·è¯„ä»·&#123;product&#125;çš„ä¼˜ç¼ºç‚¹ï¼ŒåŒ…æ‹¬&#123;aspect1&#125;å’Œ&#123;aspect2&#125;ã€‚&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç»™æ¨¡æ¿çš„å˜é‡èµ‹å€¼  </span></span><br><span class="line">prompt = template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;product&quot;</span>:<span class="string">&quot;æ™ºèƒ½æ‰‹æœº&quot;</span>,<span class="string">&quot;aspect1&quot;</span>:<span class="string">&quot;ç”µæ± ç»­èˆª&quot;</span>,<span class="string">&quot;aspect2&quot;</span>:<span class="string">&quot;æ‹ç…§è´¨é‡&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è°ƒç”¨å¤§æ¨¡å‹ï¼Œå°†æç¤ºè¯ä¼ å…¥  </span></span><br><span class="line">response= chat_model.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))</span><br></pre></td></tr></table></figure>
<p>ç»“æœï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;æ™ºèƒ½æ‰‹æœºå·²æˆä¸ºç°ä»£ç”Ÿæ´»çš„æ ¸å¿ƒå·¥å…·ï¼Œå…¶ä¼˜ç¼ºç‚¹åœ¨ä¸åŒåœºæ™¯ä¸‹è¡¨ç°å„å¼‚ï¼Œå°¤å…¶åœ¨ç”µæ± ç»­èˆªå’Œæ‹ç…§è´¨é‡è¿™ä¸¤ä¸ªç”¨æˆ·æœ€å…³æ³¨çš„æ–¹é¢å°¤ä¸ºæ˜æ˜¾ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š\n\n---\n\n### **ä¸€ã€ä¼˜ç‚¹**\n1. **æ‹ç…§è´¨é‡**  \n   - **æŠ€æœ¯çªç ´**ï¼šå¤šæ‘„åƒå¤´ç³»ç»Ÿï¼ˆè¶…å¹¿è§’ã€é•¿ç„¦ã€å¾®è·ï¼‰ã€å¤§åº•ä¼ æ„Ÿå™¨ã€è®¡ç®—æ‘„å½±ï¼ˆå¦‚å¤œæ™¯æ¨¡å¼ã€HDRï¼‰è®©æ‰‹æœºæ‘„å½±æ¥è¿‘ä¸“ä¸šè®¾å¤‡æ°´å¹³ã€‚  \n   - **AIä¼˜åŒ–**ï¼šè‡ªåŠ¨åœºæ™¯è¯†åˆ«ã€äººåƒè™šåŒ–ç®—æ³•ã€å®æ—¶æ»¤é•œå¤§å¤§é™ä½ç”¨æˆ·æ“ä½œé—¨æ§›ã€‚  \n   - **ä¾¿æºæ€§**ï¼šç›¸æ¯”å•åç›¸æœºï¼Œæ‰‹æœºèƒ½éšæ—¶éšåœ°æ•æ‰ç”»é¢ï¼Œé€‚åˆæ—¥å¸¸è®°å½•å’Œç¤¾äº¤åª’ä½“åˆ†äº«ã€‚\n\n2. **å…¶ä»–æ ¸å¿ƒä¼˜åŠ¿**  \n   - **å¤šåŠŸèƒ½æ•´åˆ**ï¼šé€šè®¯ã€æ”¯ä»˜ã€å¯¼èˆªã€å¨±ä¹ä¸€ä½“åŒ–ï¼Œå‡å°‘æºå¸¦å¤šç§è®¾å¤‡çš„éº»çƒ¦ã€‚  \n   - **é«˜æ€§èƒ½å¤„ç†å™¨**ï¼šæµç•…è¿è¡Œå¤§å‹åº”ç”¨å’Œæ¸¸æˆï¼Œ5Gç½‘ç»œæå‡å®æ—¶äº¤äº’ä½“éªŒã€‚  \n   - **ç”Ÿæ€äº’è”**ï¼šä¸æ™ºèƒ½å®¶å±…ã€ç©¿æˆ´è®¾å¤‡æ— ç¼è¿æ¥ï¼ˆå¦‚Appleç”Ÿæ€ã€åä¸ºé¸¿è’™ï¼‰ã€‚\n\n---\n\n### **äºŒã€ç¼ºç‚¹**\n1. **ç”µæ± ç»­èˆª**  \n   - **ç¡¬ä»¶ç“¶é¢ˆ**ï¼šå±å¹•é«˜åˆ·æ–°ç‡ï¼ˆ120Hz+ï¼‰ã€5Gç½‘ç»œã€é«˜æ€§èƒ½èŠ¯ç‰‡åŠ å‰§è€—ç”µï¼Œé‡åº¦ä½¿ç”¨éœ€æ¯æ—¥1-2å……ã€‚  \n   - **å……ç”µä¾èµ–**ï¼šå¿«å……æŠ€æœ¯ï¼ˆå¦‚200Wï¼‰ç¼©çŸ­å……ç”µæ—¶é—´ï¼Œä½†é¢‘ç¹å……ç”µä»å¯èƒ½åŠ é€Ÿç”µæ± è€åŒ–ï¼ˆ2å¹´åå®¹é‡æ˜¾è‘—ä¸‹é™ï¼‰ã€‚  \n   - **ä½¿ç”¨åœºæ™¯é™åˆ¶**ï¼šæˆ·å¤–æ´»åŠ¨æˆ–é•¿é€”æ—…è¡Œæ—¶ï¼Œè‹¥æ— ç”µæºéœ€ä¾èµ–å……ç”µå®ã€‚\n\n2. **æ‹ç…§çš„å±€é™æ€§**  \n   - **ç¡¬ä»¶å¤©èŠ±æ¿**ï¼šå°å°ºå¯¸ä¼ æ„Ÿå™¨åœ¨æš—å…‰ç¯å¢ƒä¸‹å™ªç‚¹æ˜æ˜¾ï¼Œå…‰å­¦å˜ç„¦èŒƒå›´æœ‰é™ï¼ˆä¸»æµæœºå‹ä»…3-5å€æ— æŸå˜ç„¦ï¼‰ã€‚  \n   - **ç®—æ³•ç—•è¿¹**ï¼šè¿‡åº¦é”åŒ–æˆ–AIç¾åŒ–å¯èƒ½å¯¼è‡´ç…§ç‰‡å¤±çœŸï¼ˆå¦‚è™šå‡çš„å¤©ç©ºå¢å¼ºï¼‰ã€‚  \n   - **ä¸“ä¸šåŠŸèƒ½ç¼ºå¤±**ï¼šæ‰‹åŠ¨è°ƒèŠ‚å‚æ•°ï¼ˆå¦‚å¿«é—¨é€Ÿåº¦ã€RAWæ ¼å¼ï¼‰ä¸å¦‚ä¸“ä¸šç›¸æœºç›´è§‚ã€‚\n\n3. **å…¶ä»–é—®é¢˜**  \n   - **éšç§é£é™©**ï¼šæ‘„åƒå¤´æƒé™æ»¥ç”¨å¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€‚  \n   - **ä»·æ ¼åˆ†å±‚**ï¼šé«˜ç«¯æœºå‹ï¼ˆå¦‚iPhone Proã€ä¸‰æ˜ŸUltraï¼‰ä¸ä¸­ä½ç«¯æœºæ‹ç…§æ€§èƒ½å·®è·æ˜¾è‘—ã€‚\n\n---\n\n### **ä¸‰ã€å¹³è¡¡ä¸å»ºè®®**\n- **é€‰è´­ç­–ç•¥**ï¼š  \n  - æ³¨é‡ç»­èˆªï¼šé€‰æ‹©ç”µæ± â‰¥5000mAh + ä½åŠŸè€—èŠ¯ç‰‡ï¼ˆå¦‚å¤©ç‘9000ï¼‰çš„æœºå‹ã€‚  \n  - è¿½æ±‚æ‹ç…§ï¼šä¼˜å…ˆè€ƒè™‘å¤§åº•ä¸»æ‘„ï¼ˆå¦‚1è‹±å¯¸ä¼ æ„Ÿå™¨ï¼‰+ å…‰å­¦é˜²æŠ–çš„æ——èˆ°æœºã€‚  \n- **ä½¿ç”¨æŠ€å·§**ï¼šå…³é—­åå°é«˜è€—ç”µåº”ç”¨ã€ä½¿ç”¨ä¼˜åŒ–æ‹æ‘„æ¨¡å¼ï¼ˆå¦‚æ‰‹åŠ¨å¤œæ™¯ï¼‰ï¼Œå¯éƒ¨åˆ†å¼¥è¡¥çŸ­æ¿ã€‚\n\n---\n\n### **æ€»ç»“**  \næ™ºèƒ½æ‰‹æœºåœ¨ä¾¿æºæ€§ä¸åŠŸèƒ½æ•´åˆä¸Šæ— å¯æ›¿ä»£ï¼Œä½†ç”µæ± å’Œæ‹ç…§ä»å—ç‰©ç†é™åˆ¶ã€‚æœªæ¥éšç€å›ºæ€ç”µæ± ã€æŠ˜å å±å’Œæ›´å…ˆè¿›çš„AIç®—æ³•å‘å±•ï¼Œè¿™äº›ç—›ç‚¹æˆ–é€æ­¥æ”¹å–„ã€‚ç”¨æˆ·éœ€æ ¹æ®éœ€æ±‚æƒè¡¡ï¼Œè€Œéä¸€å‘³è¿½æ±‚å‚æ•°ã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 625, <span class="string">&#x27;prompt_tokens&#x27;</span>: 16, <span class="string">&#x27;total_tokens&#x27;</span>: 641, <span class="string">&#x27;completion_tokens_details&#x27;</span>: None, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: None&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;deepseek-ai/DeepSeek-V3&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;019994251555f311e62f227a7a7913d8&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--f2f96594-7c48-4ed5-8970-49aa051748fa-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 16, <span class="string">&#x27;output_tokens&#x27;</span>: 625, <span class="string">&#x27;total_tokens&#x27;</span>: 641, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;&#125;&#125;</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.messages.ai.AIMessage&#x27;</span>&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="å…·ä½“ä½¿ç”¨chatprompttemplate">å…·ä½“ä½¿ç”¨ï¼šChatPromptTemplate</h2>
<p>1ã€å®ä¾‹åŒ–çš„æ–¹å¼ï¼ˆä¸¤ç§æ–¹å¼ï¼šä½¿ç”¨æ„é€ æ–¹æ³•ã€from_messages()ï¼‰</p>
<p>2ã€è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•ï¼šinvoke() Â format() Â format_messages() Â format_prompt()</p>
<p>3ã€æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹</p>
<p>4ã€ç»“åˆLLM</p>
<p>5ã€æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder</p>
<h3 id="å®ä¾‹åŒ–çš„æ–¹å¼">å®ä¾‹åŒ–çš„æ–¹å¼</h3>
<p>æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, MessagesPlaceholder  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate(  </span><br><span class="line">    messages=[  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ],  </span><br><span class="line">    input_variables=[<span class="string">&quot;name&quot;</span>, <span class="string">&quot;question&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(response.messages))</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p>æ›´ç®€æ´çš„æ–¹å¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(response.messages))</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<h3 id="è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•">è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•</h3>
<p>invoke() Â format() Â format_messages() Â format_prompt()</p>
<p>invoke()ï¼šä¼ å…¥çš„æ˜¯å­—å…¸ï¼Œè¿”å›ChatPromptValue</p>
<p>format():ä¼ å…¥å˜é‡çš„å€¼ï¼Œè¿”å›str</p>
<p>format_messages(): ä¼ å…¥å˜é‡çš„å€¼ï¼Œè¿”å›æ¶ˆæ¯æ„æˆçš„list</p>
<p>format_prompt(): ä¼ å…¥å˜é‡çš„å€¼ï¼Œè¿”å›ChatPromptValue</p>
<p><strong>ä¸¾ä¾‹1ï¼šinvoke()</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼šformat() <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.<span class="built_in">format</span>(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">System: ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º</span><br><span class="line">Human: æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ</span><br><span class="line">&lt;class <span class="string">&#x27;str&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹3ï¼šformat_messages() <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.format_messages(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#from langchain_core.prompts import ChatPromptTemplate  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.format_messages(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;list&#x27;&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;list&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ç»“è®º</strong>ï¼šç»™å ä½ç¬¦èµ‹å€¼ï¼Œé’ˆå¯¹äºChatPromptTemplateï¼Œæ¨èä½¿ç”¨<code>format_messages()</code>æ–¹æ³•ï¼Œè¿”å›æ¶ˆæ¯åˆ— è¡¨ã€‚</p>
<p>ä¸¾ä¾‹4ï¼šformat_prompt() <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">response = chat_prompt_template.format_prompt(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  <span class="comment">#&lt;class &#x27;langchain_core.prompt_values.ChatPromptValue&#x27;&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br><span class="line">&lt;class <span class="string">&#x27;langchain_core.prompt_values.ChatPromptValue&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹">æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹</h2>
<p>æœ¬è´¨ï¼šä¸ç®¡ä½¿ç”¨æ„é€ æ–¹æ³•ã€è¿˜æ˜¯ä½¿ç”¨from_message()æ¥åˆ›å»ºChatPromptTemplateçš„å®ä¾‹ï¼Œæœ¬è´¨ä¸Šæ¥è®²ï¼Œä¼ å…¥çš„éƒ½æ˜¯æ¶ˆæ¯æ„æˆçš„åˆ—è¡¨ã€‚</p>
<p>ä»è°ƒç”¨ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œä¸ç®¡ä½¿ç”¨æ„é€ æ–¹æ³•ï¼Œè¿˜æ˜¯ä½¿ç”¨from_message()ï¼Œmessageså‚æ•°çš„ç±»å‹éƒ½æ˜¯åˆ—è¡¨ï¼Œä½†æ˜¯åˆ—è¡¨çš„å…ƒç´ çš„ç±»å‹æ˜¯å¤šæ ·çš„ã€‚å…ƒç´ å¯ä»¥æ˜¯ï¼š</p>
<p>å­—ç¬¦ä¸²ç±»å‹ã€å­—å…¸ç±»å‹ã€æ¶ˆæ¯ç±»å‹ã€å…ƒç»„æ„æˆçš„åˆ—è¡¨ï¼ˆæœ€å¸¸ç”¨ã€æœ€åŸºç¡€ã€æœ€ç®€å•ï¼‰ã€Chatæç¤ºè¯æ¨¡æ¿ç±»å‹ã€æ¶ˆæ¯æç¤ºè¯æ¨¡æ¿ç±»å‹</p>
<p>ä¸¾ä¾‹1ï¼šå…ƒç»„æ„æˆçš„åˆ—è¡¨ï¼ˆæœ€å¸¸ç”¨ã€æœ€åŸºç¡€ã€æœ€ç®€å•ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line"><span class="comment">#ç¬¬1ç§æ–¹å¼  </span></span><br><span class="line">chat_prompt_template1 = ChatPromptTemplate(  </span><br><span class="line">    messages=[  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line"><span class="comment">#ç¬¬2ç§æ–¹å¼  </span></span><br><span class="line">chat_prompt_template2 = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line">response = chat_prompt_template1.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼šå­—ç¬¦ä¸² <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>  <span class="comment">#é»˜è®¤çš„è§’è‰²æ˜¯ï¼šhuman !  </span></span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">messages=[HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹3ï¼šå­—å…¸ç±»å‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;human&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>&#125;,  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line">response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯1 + 2 * 3 = ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹4ï¼šæ¶ˆæ¯ç±»å‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> SystemMessage, HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    SystemMessage(content=<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># response = chat_prompt_template.invoke(&#123;&quot;name&quot;:&quot;å°æ™º&quot;, &quot;question&quot;:&quot;1 + 2 * 3 = ï¼Ÿ&quot;&#125;)  </span></span><br><span class="line">response = chat_prompt_template.invoke(&#123;&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">messages=[SystemMessage(content=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹5ï¼šChatæç¤ºè¯æ¨¡æ¿ç±»å‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ä½¿ç”¨ BaseChatPromptTemplateï¼ˆåµŒå¥—çš„ ChatPromptTemplateï¼‰  </span></span><br><span class="line">nested_prompt_template1 = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«&#123;name&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">nested_prompt_template2 = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ ,æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    nested_prompt_template1,  </span><br><span class="line">    nested_prompt_template2  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">prompt_template.format_messages(name=<span class="string">&quot;å°æ™º&quot;</span>, question=<span class="string">&quot;ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆå¸…ï¼Ÿ&quot;</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;),</span><br><span class="line"> HumanMessage(content=<span class="string">&#x27;å¾ˆé«˜å…´è®¤è¯†ä½ ,æˆ‘çš„é—®é¢˜æ˜¯ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆå¸…ï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹6ï¼šæ¶ˆæ¯æç¤ºè¯æ¨¡æ¿ç±»å‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥èŠå¤©æ¶ˆæ¯ç±»æ¨¡æ¿  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, HumanMessagePromptTemplate, SystemMessagePromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæ¶ˆæ¯æ¨¡æ¿  </span></span><br><span class="line">system_template = <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸“å®¶&#123;role&#125;&quot;</span>  </span><br><span class="line">system_message_prompt = SystemMessagePromptTemplate.from_template(system_template)  </span><br><span class="line">  </span><br><span class="line">human_template = <span class="string">&quot;ç»™æˆ‘è§£é‡Š&#123;concept&#125;ï¼Œç”¨æµ…æ˜¾æ˜“æ‡‚çš„è¯­è¨€&quot;</span>  </span><br><span class="line">human_message_prompt = HumanMessagePromptTemplate.from_template(human_template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç»„åˆæˆèŠå¤©æç¤ºæ¨¡æ¿  </span></span><br><span class="line">chat_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    system_message_prompt, human_message_prompt  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ ¼å¼åŒ–æç¤º  </span></span><br><span class="line">formatted_messages = chat_prompt.format_messages(  </span><br><span class="line">    role=<span class="string">&quot;ç‰©ç†å­¦å®¶&quot;</span>,  </span><br><span class="line">    concept=<span class="string">&quot;ç›¸å¯¹è®º&quot;</span>  </span><br><span class="line">)  </span><br><span class="line"><span class="built_in">print</span>(formatted_messages)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªä¸“å®¶ç‰©ç†å­¦å®¶&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;ç»™æˆ‘è§£é‡Šç›¸å¯¹è®ºï¼Œç”¨æµ…æ˜¾æ˜“æ‡‚çš„è¯­è¨€&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<h2 id="ç»“åˆllm">ç»“åˆLLM</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ã€æä¾›å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;gpt-4o-mini&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€é€šè¿‡Chatæç¤ºè¯æ¨¡æ¿ï¼Œåˆ›å»ºæç¤ºè¯  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹  </span></span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">prompt_response = chat_prompt_template.invoke(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;1 + 2 * 3 = ï¼Ÿ&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3ã€é€šè¿‡å¤§æ¨¡å‹è°ƒç”¨æç¤ºè¯ï¼Œå¾—åˆ°å“åº”æ•°æ®  </span></span><br><span class="line">response = chat_model.invoke(prompt_response)  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content=<span class="string">&#x27;æ ¹æ®è¿ç®—é¡ºåºï¼Œé¦–å…ˆè®¡ç®—ä¹˜æ³•ï¼Œå†è®¡ç®—åŠ æ³•ã€‚\n\næ‰€ä»¥ï¼š\n1 + 2 * 3 = 1 + 6 = 7\n\nç­”æ¡ˆæ˜¯7ã€‚&#x27;</span> additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125; response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 39, <span class="string">&#x27;prompt_tokens&#x27;</span>: 35, <span class="string">&#x27;total_tokens&#x27;</span>: 74, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7eyBoZ4oBRoEYb1BzgWYfqXZvJQA&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125; <span class="built_in">id</span>=<span class="string">&#x27;run--ee6524a9-9df4-4058-9220-99e86e13ec84-0&#x27;</span> usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 35, <span class="string">&#x27;output_tokens&#x27;</span>: 39, <span class="string">&#x27;total_tokens&#x27;</span>: 74, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ’å…¥æ¶ˆæ¯åˆ—è¡¨messageplaceholder">æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder</h2>
<p>ä½¿ç”¨åœºæ™¯ï¼šå½“ChatPromptTemplatemæ¨¡æ¿ä¸­çš„æ¶ˆæ¯ç±»å‹å’Œä¸ªæ•°ä¸ç¡®å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨MessagePlaceholderã€‚</p>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.chat <span class="keyword">import</span> MessagesPlaceholder  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    MessagesPlaceholder(variable_name=<span class="string">&quot;msgs&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template.invoke(&#123;  </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;msgs&quot;</span>: [HumanMessage(content=<span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&quot;</span>)]  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ChatPromptValue(messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)])</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> AIMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts.chat <span class="keyword">import</span> MessagesPlaceholder  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«&#123;name&#125;&quot;</span>),  </span><br><span class="line">    MessagesPlaceholder(variable_name=<span class="string">&quot;msgs&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template.invoke(&#123;  </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;å°æ™º&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;msgs&quot;</span>: [HumanMessage(content=<span class="string">&quot;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&quot;</span>),AIMessage(content=<span class="string">&quot;1 + 2 * 3 = 7&quot;</span>)]  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ChatPromptValue(messages=[SystemMessage(content=<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œä½ çš„åå­—å«å°æ™º&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘çš„é—®é¢˜æ˜¯ï¼š1 + 2 * 3 = ?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;1 + 2 * 3 = 7&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)])</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹3ï¼šå­˜å‚¨å¯¹è¯å†å²è®°å½•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate, MessagesPlaceholder  </span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> AIMessage  </span><br><span class="line">  </span><br><span class="line">prompt = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;You are a helpful assistant.&quot;</span>),  </span><br><span class="line">        MessagesPlaceholder(<span class="string">&quot;history&quot;</span>),  </span><br><span class="line">        (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;question&#125;&quot;</span>)  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt_value = prompt.format_messages(  </span><br><span class="line">    history=[HumanMessage(content=<span class="string">&quot;1+2*3 = ?&quot;</span>),AIMessage(content=<span class="string">&quot;1+2*3=7&quot;</span>)],  </span><br><span class="line">    question=<span class="string">&quot;æˆ‘åˆšæ‰é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(prompt_value)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># prompt.invoke(  </span></span><br><span class="line"><span class="comment">#     &#123;  </span></span><br><span class="line"><span class="comment">#         &quot;history&quot;: [(&quot;human&quot;, &quot;what&#x27;s 5 + 2&quot;), (&quot;ai&quot;, &quot;5 + 2 is 7&quot;)],  </span></span><br><span class="line"><span class="comment">#         &quot;question&quot;: &quot;now multiply that by 4&quot;  </span></span><br><span class="line"><span class="comment">#     &#125;  </span></span><br><span class="line"><span class="comment"># )</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SystemMessage(content=<span class="string">&#x27;You are a helpful assistant.&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;1+2*3 = ?&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), AIMessage(content=<span class="string">&#x27;1+2*3=7&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;), HumanMessage(content=<span class="string">&#x27;æˆ‘åˆšæ‰é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ&#x27;</span>, additional_kwargs=&#123;&#125;, response_metadata=&#123;&#125;)]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#åŠ è½½é…ç½®æ–‡ä»¶  </span></span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_BASE_URL&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–å¯¹è¯æ¨¡å‹ï¼š  </span></span><br><span class="line">chat_model = ChatOpenAI(  </span><br><span class="line">    model=<span class="string">&quot;gpt-4o-mini&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">chat_model.invoke(prompt_value)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=<span class="string">&#x27;ä½ åˆšæ‰é—®çš„é—®é¢˜æ˜¯â€œ1+2*3 = ?â€ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œç»“æœæ˜¯7ï¼Œå› ä¸ºæŒ‰ç…§è¿ç®—é¡ºåºï¼Œå…ˆè®¡ç®—ä¹˜æ³•ï¼Œå†è®¡ç®—åŠ æ³•ã€‚&#x27;</span>, additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125;, response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 41, <span class="string">&#x27;prompt_tokens&#x27;</span>: 45, <span class="string">&#x27;total_tokens&#x27;</span>: 86, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C7fAHDJiMfEZ4RyHo5lZ7sEOIDE1G&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125;, <span class="built_in">id</span>=<span class="string">&#x27;run--45d7ab91-e19d-417b-b026-00a5f070ff04-0&#x27;</span>, usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 45, <span class="string">&#x27;output_tokens&#x27;</span>: 41, <span class="string">&#x27;total_tokens&#x27;</span>: 86, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨">å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨</h1>
<h2 id="ä½¿ç”¨è¯´æ˜-1">ä½¿ç”¨è¯´æ˜</h2>
<p>åœ¨æ„å»ºpromptæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„å»ºä¸€ä¸ª å°‘é‡ç¤ºä¾‹åˆ—è¡¨å»è¿›ä¸€æ­¥æ ¼å¼åŒ–promptï¼Œè¿™æ˜¯ä¸€ç§ç®€å•ä½†å¼ºå¤§çš„æŒ‡ å¯¼ç”Ÿæˆçš„æ–¹å¼ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥ æ˜¾è‘—æé«˜æ¨¡å‹æ€§èƒ½ã€‚ å°‘é‡ç¤ºä¾‹æç¤ºæ¨¡æ¿å¯ä»¥ç”± ä¸€ç»„ç¤ºä¾‹æˆ–ä¸€ä¸ªè´Ÿè´£ä»å®šä¹‰çš„é›†åˆä¸­é€‰æ‹© - å‰è€…ï¼šä½¿ç”¨ ä¸€éƒ¨åˆ†ç¤ºä¾‹çš„ç¤ºä¾‹é€‰æ‹©å™¨æ„å»ºã€‚ FewShotPromptTemplate æˆ– FewShotChatMessagePromptTemplate - åè€…ï¼šä½¿ç”¨ Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨) æ¯ä¸ªç¤ºä¾‹çš„ç»“æ„éƒ½æ˜¯ä¸€ä¸ª å­—å…¸ï¼Œå…¶ä¸­é”®æ˜¯è¾“å…¥å˜é‡ï¼Œå€¼æ˜¯è¾“å…¥å˜é‡çš„å€¼ã€‚</p>
<p>ä½“ä¼šï¼šzeroshotä¼šå¯¼è‡´ä½è´¨é‡å›</p>
<p>FewShotPromptTemplate: ä¸PromptTemplateä¸€èµ·ä½¿ç”¨</p>
<p>FewShotChatMessagePromptTemplate:ä¸ChatPromptTemplateä¸€èµ·ä½¿ç”¨</p>
<p>Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨):</p>
<h2 id="fewshotprompttemplateçš„ä½¿ç”¨">FewShotPromptTemplateçš„ä½¿ç”¨</h2>
<p>ä¸¾ä¾‹1ï¼šæœªæä¾›ç¤ºä¾‹çš„æƒ…å†µ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> FewShotPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>,  </span><br><span class="line">                        temperature=<span class="number">0.4</span>)  </span><br><span class="line">  </span><br><span class="line">res = chat_model.invoke(<span class="string">&quot;2 ğŸ¦œ 9æ˜¯å¤šå°‘?&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(res.content)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2 ğŸ¦œ 9 çš„æ„æ€å¯èƒ½ä¸å¤ªæ˜ç¡®ã€‚å¦‚æœä½ æ˜¯åœ¨é—® 2 å’Œ 9 çš„æ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•æˆ–é™¤æ³•ï¼Œè¯·å‘Šè¯‰æˆ‘å…·ä½“çš„è¿ç®—æ–¹å¼ã€‚å¦‚æœæ˜¯å…¶ä»–æ„æ€ï¼Œè¯·æä¾›æ›´å¤šçš„ä¸Šä¸‹æ–‡ã€‚</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼šä½¿ç”¨FewShotPromptTemplate <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºPromptTemplateçš„å®ä¾‹  </span></span><br><span class="line">example_prompt = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;input:&#123;input&#125;\noutput:&#123;output&#125;&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æä¾›ä¸€äº›ç¤ºä¾‹  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;åŒ—äº¬å¸‚&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å—äº¬ä¸‹é›¨å—&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;å—äº¬å¸‚&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æ­¦æ±‰çƒ­å—&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ­¦æ±‰å¸‚&quot;</span>&#125;  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºFewShotPromptTemplateçš„å®ä¾‹  </span></span><br><span class="line">few_shot_template = FewShotPromptTemplate(  </span><br><span class="line">    example_prompt=example_prompt,  </span><br><span class="line">    examples = examples,  </span><br><span class="line">    suffix=<span class="string">&quot;input:&#123;input&#125;\noutput:&quot;</span>,   <span class="comment">#å£°æ˜åœ¨ç¤ºä¾‹åé¢çš„æç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">    input_variables=[<span class="string">&quot;input&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">few_shot_template.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;å¤©æ´¥ä¼šä¸‹é›¨å—ï¼Ÿ&quot;</span>&#125;)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringPromptValue(text=<span class="string">&#x27;input:åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·\noutput:åŒ—äº¬å¸‚\n\ninput:å—äº¬ä¸‹é›¨å—\noutput:å—äº¬å¸‚\n\ninput:æ­¦æ±‰çƒ­å—\noutput:æ­¦æ±‰å¸‚\n\ninput:å¤©æ´¥ä¼šä¸‹é›¨å—ï¼Ÿ\noutput:&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨å¤§æ¨¡å‹ä»¥åï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)</span><br><span class="line"></span><br><span class="line">chat_model.invoke(few_shot_template.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;å¤©æ´¥ä¼šä¸‹é›¨å—ï¼Ÿ&quot;</span>&#125;))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=<span class="string">&#x27;å¤©æ´¥å¸‚&#x27;</span>, additional_kwargs=&#123;<span class="string">&#x27;refusal&#x27;</span>: None&#125;, response_metadata=&#123;<span class="string">&#x27;token_usage&#x27;</span>: &#123;<span class="string">&#x27;completion_tokens&#x27;</span>: 3, <span class="string">&#x27;prompt_tokens&#x27;</span>: 50, <span class="string">&#x27;total_tokens&#x27;</span>: 53, <span class="string">&#x27;completion_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;accepted_prediction_tokens&#x27;</span>: 0, <span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;reasoning_tokens&#x27;</span>: 0, <span class="string">&#x27;rejected_prediction_tokens&#x27;</span>: 0&#125;, <span class="string">&#x27;prompt_tokens_details&#x27;</span>: &#123;<span class="string">&#x27;audio_tokens&#x27;</span>: 0, <span class="string">&#x27;cached_tokens&#x27;</span>: 0&#125;&#125;, <span class="string">&#x27;model_name&#x27;</span>: <span class="string">&#x27;gpt-4o-mini-2024-07-18&#x27;</span>, <span class="string">&#x27;system_fingerprint&#x27;</span>: <span class="string">&#x27;fp_efad92c60b&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;chatcmpl-C8Mbv1EY0HWqyBA7NsTDDRlCgsyLj&#x27;</span>, <span class="string">&#x27;service_tier&#x27;</span>: None, <span class="string">&#x27;finish_reason&#x27;</span>: <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;logprobs&#x27;</span>: None&#125;, <span class="built_in">id</span>=<span class="string">&#x27;run--e663e04c-3bee-4b37-b2f8-eca41d7bff07-0&#x27;</span>, usage_metadata=&#123;<span class="string">&#x27;input_tokens&#x27;</span>: 50, <span class="string">&#x27;output_tokens&#x27;</span>: 3, <span class="string">&#x27;total_tokens&#x27;</span>: 53, <span class="string">&#x27;input_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;cache_read&#x27;</span>: 0&#125;, <span class="string">&#x27;output_token_details&#x27;</span>: &#123;<span class="string">&#x27;audio&#x27;</span>: 0, <span class="string">&#x27;reasoning&#x27;</span>: 0&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹3ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€åˆ›å»ºæç¤ºæ¨¡æ¿  </span></span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºæç¤ºæ¨¡æ¿ï¼Œé…ç½®ä¸€ä¸ªæç¤ºæ¨¡æ¿ï¼Œå°†ä¸€ä¸ªç¤ºä¾‹æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²  </span></span><br><span class="line">prompt_template = <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦ä¸“å®¶,ç®—å¼ï¼š &#123;input&#125; å€¼ï¼š &#123;output&#125; ä½¿ç”¨ï¼š &#123;description&#125; &quot;</span>  </span><br><span class="line"><span class="comment"># è¿™æ˜¯ä¸€ä¸ªæç¤ºæ¨¡æ¿ï¼Œç”¨äºè®¾ç½®æ¯ä¸ªç¤ºä¾‹çš„æ ¼å¼  </span></span><br><span class="line">prompt_sample = PromptTemplate.from_template(prompt_template)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#2ã€æä¾›ç¤ºä¾‹  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;2+2&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;4&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;åŠ æ³•è¿ç®—&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;5-2&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;3&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;å‡æ³•è¿ç®—&quot;</span>&#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#3ã€åˆ›å»ºä¸€ä¸ªFewShotPromptTemplateå¯¹è±¡  </span></span><br><span class="line"><span class="keyword">from</span> langchain.prompts.few_shot <span class="keyword">import</span> FewShotPromptTemplate  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">prompt = FewShotPromptTemplate(  </span><br><span class="line">    examples=examples,  </span><br><span class="line">    example_prompt=prompt_sample,  </span><br><span class="line">    suffix=<span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦ä¸“å®¶,ç®—å¼: &#123;input&#125;  å€¼: &#123;output&#125;&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;input&quot;</span>, <span class="string">&quot;output&quot;</span>]  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># print(prompt.invoke(&#123;&quot;input&quot;:&quot;2*5&quot;, &quot;output&quot;:&quot;10&quot;&#125;))  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#4ã€åˆå§‹åŒ–å¤§æ¨¡å‹ï¼Œç„¶åè°ƒç”¨  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">result = chat_model.invoke(prompt.invoke(&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;2*5&quot;</span>, <span class="string">&quot;output&quot;</span>:<span class="string">&quot;10&quot;</span>&#125;))  </span><br><span class="line"><span class="built_in">print</span>(result.content)  <span class="comment"># ä½¿ç”¨: ä¹˜æ³•è¿ç®—</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ï¼šä¹˜æ³•è¿ç®—</span><br><span class="line"></span><br><span class="line">ä½ æ˜¯ä¸€ä¸ªæ•°å­¦ä¸“å®¶,ç®—å¼ï¼š 10Ã·2 å€¼ï¼š 5 ä½¿ç”¨ï¼š é™¤æ³•è¿ç®—</span><br></pre></td></tr></table></figure>
<h2 id="fewshotchatmessageprompttemplateçš„ä½¿ç”¨">FewShotChatMessagePromptTemplateçš„ä½¿ç”¨</h2>
<p>é™¤äº†FewShotPromptTemplateä¹‹å¤–ï¼ŒFewShotChatMessagePromptTemplateæ˜¯ä¸“é—¨ä¸º <strong>èŠå¤©å¯¹è¯åœº æ™¯</strong> è®¾è®¡çš„å°‘æ ·æœ¬ï¼ˆfew-shotï¼‰æç¤ºæ¨¡æ¿ï¼Œå®ƒç»§æ‰¿è‡ª FewShotPromptTemplateï¼Œä½†é’ˆå¯¹èŠå¤©æ¶ˆæ¯çš„æ ¼ å¼è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p>
<p>ç‰¹ç‚¹ï¼š - è‡ªåŠ¨å°†ç¤ºä¾‹æ ¼å¼åŒ–ä¸ºèŠå¤©æ¶ˆæ¯ï¼ˆHumanMessage/AIMessage ç­‰ï¼‰ - è¾“å‡ºç»“æ„åŒ–èŠå¤©æ¶ˆæ¯ï¼ˆList[BaseMessage]ï¼‰ - ä¿ç•™å¯¹è¯è½®æ¬¡ç»“æ„</p>
<p>ä¸¾ä¾‹1ï¼šå®ä¾‹åŒ– <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> (  </span><br><span class="line">    FewShotChatMessagePromptTemplate,  </span><br><span class="line">    ChatPromptTemplate  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1.ç¤ºä¾‹æ¶ˆæ¯æ ¼å¼  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;1+1ç­‰äºå‡ ï¼Ÿ&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;1+1ç­‰äº2&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;æ³•å›½çš„é¦–éƒ½æ˜¯ï¼Ÿ&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;å·´é»&quot;</span>&#125;  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ç¤ºä¾‹çš„æ¶ˆæ¯æ ¼å¼æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">msg_example_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;input&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;ai&quot;</span>, <span class="string">&quot;&#123;output&#125;&quot;</span>),  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰FewShotChatMessagePromptTemplateå¯¹è±¡  </span></span><br><span class="line">few_shot_prompt = FewShotChatMessagePromptTemplate(  </span><br><span class="line">    example_prompt=msg_example_prompt,  </span><br><span class="line">    examples=examples  </span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 4.è¾“å‡ºæ ¼å¼åŒ–åçš„æ¶ˆæ¯  </span></span><br><span class="line"><span class="built_in">print</span>(few_shot_prompt.<span class="built_in">format</span>())</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Human: 1+1ç­‰äºå‡ ï¼Ÿ</span><br><span class="line">AI: 1+1ç­‰äº2</span><br><span class="line">Human: æ³•å›½çš„é¦–éƒ½æ˜¯ï¼Ÿ</span><br><span class="line">AI: å·´é»</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> (FewShotChatMessagePromptTemplate, ChatPromptTemplate)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ç¤ºä¾‹ç»„  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;2ğŸ¦œ2&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;4&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;2ğŸ¦œ3&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;6&quot;</span>&#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ç¤ºä¾‹çš„æ¶ˆæ¯æ ¼å¼æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">example_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&#x27;human&#x27;</span>, <span class="string">&#x27;&#123;input&#125; æ˜¯å¤šå°‘?&#x27;</span>),  </span><br><span class="line">    (<span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;&#123;output&#125;&#x27;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰FewShotChatMessagePromptTemplateå¯¹è±¡  </span></span><br><span class="line">few_shot_prompt = FewShotChatMessagePromptTemplate(  </span><br><span class="line">    examples=examples,  <span class="comment"># ç¤ºä¾‹ç»„  </span></span><br><span class="line">    example_prompt=example_prompt,  <span class="comment"># ç¤ºä¾‹æç¤ºè¯è¯æ¨¡ç‰ˆ  </span></span><br><span class="line">)  </span><br><span class="line"><span class="comment"># 5.è¾“å‡ºå®Œæ•´æç¤ºè¯çš„æ¶ˆæ¯æ¨¡ç‰ˆ  </span></span><br><span class="line">final_prompt = ChatPromptTemplate.from_messages(  </span><br><span class="line">    [  </span><br><span class="line">        (<span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªæ•°å­¦å¥‡æ‰&#x27;</span>),  </span><br><span class="line">        few_shot_prompt,  </span><br><span class="line">        (<span class="string">&#x27;human&#x27;</span>, <span class="string">&#x27;&#123;input&#125;&#x27;</span>),  </span><br><span class="line">    ]  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#6.æä¾›å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>,  </span><br><span class="line">                        temperature=<span class="number">0.4</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model.invoke(final_prompt.invoke(<span class="built_in">input</span>=<span class="string">&quot;2ğŸ¦œ4&quot;</span>)).content</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;8&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="example-selectorsç¤ºä¾‹é€‰æ‹©å™¨">Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨)</h2>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> Chroma  </span><br><span class="line"><span class="keyword">from</span> langchain_core.example_selectors <span class="keyword">import</span> SemanticSimilarityExampleSelector  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">embeddings_model = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;text-embedding-ada-002&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.å®šä¹‰ç¤ºä¾‹ç»„  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;è°æ´»å¾—æ›´ä¹…ï¼Œç©†ç½•é»˜å¾·Â·é˜¿é‡Œè¿˜æ˜¯è‰¾ä¼¦Â·å›¾çµ?&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šç©†ç½•é»˜å¾·Â·é˜¿é‡Œå»ä¸–æ—¶å¤šå¤§å¹´çºªï¼Ÿ  </span></span><br><span class="line"><span class="string">        ä¸­é—´ç­”æ¡ˆï¼šç©†ç½•é»˜å¾·Â·é˜¿é‡Œå»ä¸–æ—¶äº«å¹´74å²ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;craigslistçš„åˆ›å§‹äººæ˜¯ä»€ä¹ˆæ—¶å€™å‡ºç”Ÿçš„ï¼Ÿ&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šè°æ˜¯craigslistçš„åˆ›å§‹äººï¼Ÿ  </span></span><br><span class="line"><span class="string">        ä¸­çº§ç­”æ¡ˆï¼šCraigslistæ˜¯ç”±å…‹é›·æ ¼Â·çº½é©¬å…‹åˆ›ç«‹çš„ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;è°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„å¤–ç¥–çˆ¶ï¼Ÿ&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šè°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„æ¯äº²ï¼Ÿ  </span></span><br><span class="line"><span class="string">        ä¸­é—´ç­”æ¡ˆï¼šä¹”æ²»Â·åç››é¡¿çš„æ¯äº²æ˜¯ç›ä¸½Â·é²å°”Â·åç››é¡¿ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="string">&quot;question&quot;</span>: <span class="string">&quot;ã€Šå¤§ç™½é²¨ã€‹å’Œã€Šçš‡å®¶èµŒåœºã€‹çš„å¯¼æ¼”éƒ½æ¥è‡ªåŒä¸€ä¸ªå›½å®¶å—ï¼Ÿ&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ  </span></span><br><span class="line"><span class="string">        è¿½é—®ï¼šã€Šå¤§ç™½é²¨ã€‹çš„å¯¼æ¼”æ˜¯è°ï¼Ÿ        ä¸­çº§ç­”æ¡ˆï¼šã€Šå¤§ç™½é²¨ã€‹çš„å¯¼æ¼”æ˜¯å²è’‚æ–‡Â·æ–¯çš®å°”ä¼¯æ ¼ã€‚  </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>,  </span><br><span class="line">    &#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰ç¤ºä¾‹é€‰æ‹©å™¨  </span></span><br><span class="line">example_selector = SemanticSimilarityExampleSelector.from_examples(  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯å¯ä¾›é€‰æ‹©çš„ç¤ºä¾‹åˆ—è¡¨  </span></span><br><span class="line">    examples,  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯ç”¨äºç”ŸæˆåµŒå…¥çš„åµŒå…¥ç±»ï¼Œç”¨äºè¡¡é‡è¯­ä¹‰ç›¸ä¼¼æ€§  </span></span><br><span class="line">    embeddings_model,  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯ç”¨äºå­˜å‚¨åµŒå…¥å¹¶è¿›è¡Œç›¸ä¼¼æ€§æœç´¢çš„ VectorStore ç±»  </span></span><br><span class="line">    Chroma,  </span><br><span class="line">    <span class="comment"># è¿™æ˜¯è¦ç”Ÿæˆçš„ç¤ºä¾‹æ•°é‡  </span></span><br><span class="line">    k=<span class="number">1</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é€‰æ‹©ä¸è¾“å…¥æœ€ç›¸ä¼¼çš„ç¤ºä¾‹  </span></span><br><span class="line">question = <span class="string">&quot;ç›ä¸½Â·é²å°”Â·åç››é¡¿çš„çˆ¶äº²æ˜¯è°?&quot;</span>  </span><br><span class="line">selected_examples = example_selector.select_examples(&#123;<span class="string">&quot;question&quot;</span>: question&#125;)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ä¸è¾“å…¥æœ€ç›¸ä¼¼çš„ç¤ºä¾‹ï¼š<span class="subst">&#123;selected_examples&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># for example in selected_examples:  </span></span><br><span class="line"><span class="comment">#     print(&quot;\n&quot;)  </span></span><br><span class="line"><span class="comment">#     for k, v in example.items():  </span></span><br><span class="line"><span class="comment">#         print(f&quot;&#123;k&#125;: &#123;v&#125;&quot;)</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸è¾“å…¥æœ€ç›¸ä¼¼çš„ç¤ºä¾‹ï¼š[&#123;<span class="string">&#x27;question&#x27;</span>: <span class="string">&#x27;è°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„å¤–ç¥–çˆ¶ï¼Ÿ&#x27;</span>, <span class="string">&#x27;answer&#x27;</span>: <span class="string">&#x27;\n        æ¥ä¸‹æ¥è¿˜éœ€è¦é—®ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ\n        è¿½é—®ï¼šè°æ˜¯ä¹”æ²»Â·åç››é¡¿çš„æ¯äº²ï¼Ÿ\n        ä¸­é—´ç­”æ¡ˆï¼šä¹”æ²»Â·åç››é¡¿çš„æ¯äº²æ˜¯ç›ä¸½Â·é²å°”Â·åç››é¡¿ã€‚\n        &#x27;</span>&#125;]</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS  </span><br><span class="line"><span class="keyword">from</span> langchain_core.example_selectors <span class="keyword">import</span> SemanticSimilarityExampleSelector  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> FewShotPromptTemplate, PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2.å®šä¹‰ç¤ºä¾‹æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">example_prompt = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;Input: &#123;input&#125;\nOutput: &#123;output&#125;&quot;</span>,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">examples = [  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é«˜å…´&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ‚²ä¼¤&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é«˜&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;çŸ®&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é•¿&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;çŸ­&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ç²¾åŠ›å……æ²›&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ— ç²¾æ‰“é‡‡&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;é˜³å…‰&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;é˜´æš—&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;ç²—ç³™&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;å…‰æ»‘&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å¹²ç‡¥&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;æ½®æ¹¿&quot;</span>&#125;,  </span><br><span class="line">    &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;å¯Œè£•&quot;</span>, <span class="string">&quot;output&quot;</span>: <span class="string">&quot;è´«ç©·&quot;</span>&#125;,  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰åµŒå…¥æ¨¡å‹  </span></span><br><span class="line">embeddings = OpenAIEmbeddings(  </span><br><span class="line">    model=<span class="string">&quot;text-embedding-ada-002&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5.åˆ›å»ºè¯­ä¹‰ç›¸ä¼¼æ€§ç¤ºä¾‹é€‰æ‹©å™¨  </span></span><br><span class="line">example_selector = SemanticSimilarityExampleSelector.from_examples(  </span><br><span class="line">    examples,  </span><br><span class="line">    embeddings,  </span><br><span class="line">    FAISS,  </span><br><span class="line">    k=<span class="number">2</span>,  </span><br><span class="line">)  </span><br><span class="line"><span class="comment">#æˆ–è€…  </span></span><br><span class="line"><span class="comment">#example_selector = SemanticSimilarityExampleSelector(  </span></span><br><span class="line"><span class="comment">#    examples,  </span></span><br><span class="line"><span class="comment">#    embeddings,  </span></span><br><span class="line"><span class="comment">#    FAISS,  </span></span><br><span class="line"><span class="comment">#    k=2  </span></span><br><span class="line"><span class="comment">#)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 6.å®šä¹‰å°æ ·æœ¬æç¤ºè¯æ¨¡ç‰ˆ  </span></span><br><span class="line">similar_prompt = FewShotPromptTemplate(  </span><br><span class="line">    example_selector=example_selector,  </span><br><span class="line">    example_prompt=example_prompt,  </span><br><span class="line">    prefix=<span class="string">&quot;ç»™å‡ºæ¯ä¸ªè¯ç»„çš„åä¹‰è¯&quot;</span>,  </span><br><span class="line">    suffix=<span class="string">&quot;Input: &#123;word&#125;\nOutput:&quot;</span>,  </span><br><span class="line">    input_variables=[<span class="string">&quot;word&quot;</span>],  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">response = similar_prompt.invoke(&#123;<span class="string">&quot;word&quot;</span>:<span class="string">&quot;å¿§éƒ&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç»™å‡ºæ¯ä¸ªè¯ç»„çš„åä¹‰è¯</span><br><span class="line"></span><br><span class="line">Input: é«˜å…´</span><br><span class="line">Output: æ‚²ä¼¤</span><br><span class="line"></span><br><span class="line">Input: é˜³å…‰</span><br><span class="line">Output: é˜´æš—</span><br><span class="line"></span><br><span class="line">Input: å¿§éƒ</span><br><span class="line">Output:</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="ä»æ–‡æ¡£ä¸­åŠ è½½promptäº†è§£">ä»æ–‡æ¡£ä¸­åŠ è½½Prompt(äº†è§£)</h1>
<p>ä¸€æ–¹é¢ï¼Œå°†æƒ³è¦è®¾å®špromptæ‰€æ”¯æŒçš„æ ¼å¼ä¿å­˜ä¸ºJSONæˆ–è€…YAMLæ ¼å¼æ–‡ä»¶ã€‚ å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡è¯»å–æŒ‡å®šè·¯å¾„çš„æ ¼å¼åŒ–æ–‡ä»¶ï¼Œè·å–ç›¸åº”çš„promptã€‚ ç›®çš„ä¸ä½¿ç”¨åœºæ™¯ï¼š - ä¸ºäº†ä¾¿äºå…±äº«ã€å­˜å‚¨å’ŒåŠ å¼ºå¯¹promptçš„ç‰ˆæœ¬æ§åˆ¶ã€‚ - å½“æˆ‘ä»¬çš„promptæ¨¡æ¿æ•°æ®è¾ƒå¤§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤–éƒ¨å¯¼å…¥çš„æ–¹å¼è¿›è¡Œç®¡ç†å’Œç»´æŠ¤ã€‚ ## yamlæ ¼å¼æç¤ºè¯ assetä¸‹åˆ›å»ºyamlæ–‡ä»¶ï¼šprompt.yaml <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">_type:</span>  </span><br><span class="line">    <span class="string">&quot;prompt&quot;</span>  </span><br><span class="line"><span class="attr">input_variables:</span>  </span><br><span class="line">    [<span class="string">&quot;name&quot;</span>,<span class="string">&quot;what&quot;</span>]  </span><br><span class="line"><span class="attr">template:</span>  </span><br><span class="line">    <span class="string">&quot;è¯·ç»™&#123;name&#125;è®²ä¸€ä¸ªå…³äº&#123;what&#125;çš„æ•…äº‹&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸¾ä¾‹1ï¼šä»ç‰©ç†ç£ç›˜çš„yamlæ–‡ä»¶ä¸­è¯»å–promptæ•°æ® <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> load_prompt  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">prompt = load_prompt(<span class="string">&quot;prompt.yaml&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)  </span><br><span class="line"><span class="comment"># print(prompt)  </span></span><br><span class="line"><span class="built_in">print</span>(prompt.<span class="built_in">format</span>(name=<span class="string">&quot;å¹´è½»äºº&quot;</span>, what=<span class="string">&quot;æ»‘ç¨½&quot;</span>))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·ç»™å¹´è½»äººè®²ä¸€ä¸ªå…³äºæ»‘ç¨½çš„æ•…äº‹</span><br></pre></td></tr></table></figure>
<h2 id="jsonæ ¼å¼æç¤ºè¯">jsonæ ¼å¼æç¤ºè¯</h2>
<p>assetä¸‹åˆ›å»ºjsonæ–‡ä»¶ï¼šprompt.json <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">  <span class="attr">&quot;_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;prompt&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">  <span class="attr">&quot;input_variables&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;name&quot;</span><span class="punctuation">,</span> <span class="string">&quot;what&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>  </span><br><span class="line">  <span class="attr">&quot;template&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯·&#123;name&#125;è®²ä¸€ä¸ª&#123;what&#125;çš„æ•…äº‹ã€‚&quot;</span>  </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸¾ä¾‹2ï¼šä»ç‰©ç†ç£ç›˜çš„jsonæ–‡ä»¶ä¸­è¯»å–promptæ•°æ® <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> load_prompt  </span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv  </span><br><span class="line">  </span><br><span class="line">load_dotenv()  </span><br><span class="line">  </span><br><span class="line">prompt = load_prompt(<span class="string">&quot;prompt.json&quot;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(prompt.<span class="built_in">format</span>(name=<span class="string">&quot;å¼ ä¸‰&quot;</span>,what=<span class="string">&quot;æç¬‘çš„&quot;</span>))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¼ ä¸‰è®²ä¸€ä¸ªæç¬‘çš„çš„æ•…äº‹ã€‚</span><br></pre></td></tr></table></figure>
<h1 id="model-ioä¹‹output-parsers">Model I/Oä¹‹Output Parsers</h1>
<p>è¯­è¨€æ¨¡å‹è¿”å›çš„å†…å®¹é€šå¸¸éƒ½æ˜¯å­—ç¬¦ä¸²çš„æ ¼å¼ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰ï¼Œä½†åœ¨å®é™…AIåº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å¸Œæœ› modelå¯ä»¥è¿”å›<strong>æ›´ç›´è§‚ã€æ›´æ ¼å¼åŒ–çš„å†…å®¹</strong>ï¼Œä»¥ç¡®ä¿åº”ç”¨èƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œåç»­çš„é€»è¾‘å¤„ç†ã€‚æ­¤æ—¶ï¼Œ LangChainæä¾›çš„ è¾“å‡ºè§£æå™¨å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ è¾“å‡ºè§£æå™¨ï¼ˆOutput Parserï¼‰è´Ÿè´£è·å– LLM çš„è¾“å‡ºå¹¶å°†å…¶è½¬æ¢ä¸ºæ›´åˆé€‚çš„æ ¼å¼ã€‚<strong>è¿™åœ¨åº”ç”¨å¼€å‘ä¸­åŠå…¶ é‡è¦ã€‚</strong></p>
<h2 id="è¾“å‡ºè§£æå™¨çš„åˆ†ç±»">è¾“å‡ºè§£æå™¨çš„åˆ†ç±»</h2>
<p>LangChainæœ‰è®¸å¤šä¸åŒç±»å‹çš„è¾“å‡ºè§£æå™¨ - StrOutputParser ï¼šå­—ç¬¦ä¸²è§£æå™¨ - JsonOutputParser ï¼šJSONè§£æå™¨ï¼Œç¡®ä¿è¾“å‡ºç¬¦åˆç‰¹å®šJSONå¯¹è±¡æ ¼å¼ - XMLOutputParser ï¼šXMLè§£æå™¨ï¼Œå…è®¸ä»¥æµè¡Œçš„XMLæ ¼å¼ä»LLMè·å–ç»“æœ - CommaSeparatedListOutputParser ï¼šCSVè§£æå™¨ï¼Œæ¨¡å‹çš„è¾“å‡ºä»¥é€—å·åˆ†éš”ï¼Œä»¥åˆ—è¡¨å½¢å¼è¿”å›è¾“å‡º - DatetimeOutputParser ï¼šæ—¥æœŸæ—¶é—´è§£æå™¨ï¼Œå¯ç”¨äºå°† LLM è¾“å‡ºè§£æä¸ºæ—¥æœŸæ—¶é—´æ ¼å¼</p>
<p>é™¤äº†ä¸Šè¿°å¸¸ç”¨çš„è¾“å‡ºè§£æå™¨ä¹‹å¤–ï¼Œè¿˜æœ‰ï¼š - EnumOutputParser ï¼šæšä¸¾è§£æå™¨ï¼Œå°†LLMçš„è¾“å‡ºï¼Œè§£æä¸ºé¢„å®šä¹‰çš„æšä¸¾å€¼ - StructuredOutputParser ï¼šå°†<strong>éç»“æ„åŒ–æ–‡æœ¬</strong>è½¬æ¢ä¸ºé¢„å®šä¹‰æ ¼å¼çš„<strong>ç»“æ„åŒ–æ•°æ®</strong>ï¼ˆå¦‚å­—å…¸ï¼‰ - OutputFixingParser ï¼šè¾“å‡ºä¿®å¤è§£æå™¨ï¼Œç”¨äºè‡ªåŠ¨ä¿®å¤æ ¼å¼é”™è¯¯çš„è§£æå™¨ï¼Œæ¯”å¦‚å°†è¿”å›çš„ä¸ç¬¦åˆ é¢„æœŸæ ¼å¼çš„è¾“å‡ºï¼Œå°è¯•ä¿®æ­£ä¸ºæ­£ç¡®çš„ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚ JSONï¼‰ - RetryOutputParser ï¼šé‡è¯•è§£æå™¨ï¼Œå½“ä¸»è§£æå™¨ï¼ˆå¦‚ JSONOutputParserï¼‰å› æ ¼å¼é”™è¯¯æ— æ³•è§£æ LLM çš„è¾“å‡ºæ—¶ï¼Œé€šè¿‡è°ƒç”¨å¦ä¸€ä¸ª LLM è‡ªåŠ¨ä¿®æ­£é”™è¯¯ï¼Œå¹¶é‡æ–°å°è¯•è§£æ</p>
<h2 id="å…·ä½“è§£æå™¨çš„ä½¿ç”¨">å…·ä½“è§£æå™¨çš„ä½¿ç”¨</h2>
<h3 id="å­—ç¬¦ä¸²è§£æå™¨-stroutputparser">â‘  å­—ç¬¦ä¸²è§£æå™¨ StrOutputParser</h3>
<p>StrOutputParser ç®€å•åœ°å°† <strong>ä»»ä½•è¾“å…¥</strong>è½¬æ¢ä¸º <strong>å­—ç¬¦ä¸²</strong>ã€‚å®ƒæ˜¯ä¸€ä¸ªç®€å•çš„è§£æå™¨ï¼Œä»ç»“æœä¸­æå–contentå­— æ®µ ä¸¾ä¾‹ï¼šå°†ä¸€ä¸ªå¯¹è¯æ¨¡å‹çš„è¾“å‡ºç»“æœï¼Œè§£æä¸ºå­—ç¬¦ä¸²è¾“å‡º <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ã€è·å–å¤§æ¨¡å‹  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage, SystemMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser, XMLOutputParser  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> dotenv  </span><br><span class="line"><span class="keyword">from</span> langchain_core.utils <span class="keyword">import</span> pre_init  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line">dotenv.load_dotenv()  </span><br><span class="line">  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_API_KEY1&quot;</span>)  </span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_BASE_URL&#x27;</span>] = os.getenv(<span class="string">&quot;OPENAI_BASE_URL&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2ã€è°ƒç”¨å¤§æ¨¡å‹  </span></span><br><span class="line">response = chat_model.invoke(<span class="string">&quot;ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ&quot;</span>)  </span><br><span class="line"><span class="comment"># print(type(response))   #AIMessage  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#3ã€å¦‚ä½•è·å–ä¸€ä¸ªå­—ç¬¦ä¸²çš„è¾“å‡ºç»“æœå‘¢ï¼Ÿ  </span></span><br><span class="line"><span class="comment"># æ–¹å¼1ï¼šè‡ªå·±è°ƒç”¨è¾“å‡ºç»“æœçš„content  </span></span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šä½¿ç”¨StrOutputParser  </span></span><br><span class="line">parser = StrOutputParser()  </span><br><span class="line">str_response = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(str_response))  <span class="comment">#&lt;class &#x27;str&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(str_response)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;class <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line">å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Model, LLMï¼‰æ˜¯ä¸€ç§åŸºäºæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œæ—¨åœ¨ç†è§£å’Œç”Ÿæˆè‡ªç„¶è¯­è¨€æ–‡æœ¬ã€‚è¿™ç±»æ¨¡å‹é€šå¸¸ä½¿ç”¨æµ·é‡çš„æ–‡æœ¬æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œå­¦ä¹ è¯­è¨€çš„ç»“æ„ã€è¯­æ³•å’Œè¯­ä¹‰ï¼Œä»¥ä¾¿èƒ½å¤Ÿç”Ÿæˆè¿è´¯ã€ç¬¦åˆä¸Šä¸‹æ–‡çš„æ–‡æœ¬ã€‚</span><br><span class="line"></span><br><span class="line">å¤§è¯­è¨€æ¨¡å‹çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š</span><br><span class="line"></span><br><span class="line">1. **è§„æ¨¡åºå¤§**ï¼šé€šå¸¸åŒ…å«äº¿ä¸‡æˆ–ç”šè‡³æ•°ç™¾äº¿ä¸ªå‚æ•°ï¼Œè¿™ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ•æ‰å¤æ‚çš„è¯­è¨€æ¨¡å¼ã€‚</span><br><span class="line"></span><br><span class="line">2. **é¢„è®­ç»ƒä¸å¾®è°ƒ**ï¼šæ¨¡å‹é¦–å…ˆåœ¨å¤§è§„æ¨¡çš„æ–‡æœ¬æ•°æ®é›†ä¸Šè¿›è¡Œæ— ç›‘ç£çš„é¢„è®­ç»ƒï¼Œç„¶åå¯ä»¥æ ¹æ®å…·ä½“ä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬åˆ†ç±»ã€é—®ç­”ç”Ÿæˆç­‰ï¼‰è¿›è¡Œå¾®è°ƒã€‚</span><br><span class="line"></span><br><span class="line">3. **å¤šæ ·åŒ–åº”ç”¨**ï¼šå¯ç”¨äºæ–‡æœ¬ç”Ÿæˆã€ç¿»è¯‘ã€é—®ç­”ã€å¯¹è¯ç³»ç»Ÿã€å†…å®¹æ¨èç­‰å¤šç§è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">4. **ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›**ï¼šèƒ½å¤Ÿç†è§£ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç”Ÿæˆç›¸å…³çš„å’Œä¸€è‡´çš„å›åº”ï¼Œä½¿å¾—ä¸äººç±»çš„äº’åŠ¨æ›´åŠ è‡ªç„¶ã€‚</span><br><span class="line"></span><br><span class="line">å¤§è¯­è¨€æ¨¡å‹çš„ä»£è¡¨æœ‰OpenAIçš„GPTç³»åˆ—ã€Googleçš„BERTå’ŒT5ä»¥åŠMetaçš„LLaMAç­‰ã€‚å°½ç®¡è¿™äº›æ¨¡å‹è¡¨ç°å‡ºè‰²ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›æŒ‘æˆ˜ï¼Œå¦‚æ˜“äº§ç”Ÿåè§ã€ç¼ºä¹å¸¸è¯†æ¨ç†èƒ½åŠ›å’Œç”Ÿæˆä¸å‡†ç¡®æˆ–ä¸åˆé€‚çš„å†…å®¹ç­‰ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="jsonè§£æå™¨-jsonoutputparser">â‘¡ JSONè§£æå™¨ JsonOutputParser</h3>
<p>JsonOutputParserï¼Œå³JSONè¾“å‡ºè§£æå™¨ï¼Œæ˜¯ä¸€ç§ç”¨äºå°†å¤§æ¨¡å‹çš„<strong>è‡ªç”±æ–‡æœ¬</strong>è¾“å‡ºè½¬æ¢ä¸º<strong>ç»“æ„åŒ–JSONæ•° æ®</strong>çš„å·¥å…·ã€‚</p>
<p><strong>é€‚åˆåœºæ™¯</strong>ï¼šç‰¹åˆ«é€‚ç”¨äºéœ€è¦ä¸¥æ ¼ç»“æ„åŒ–è¾“å‡ºçš„åœºæ™¯ï¼Œæ¯”å¦‚ API è°ƒç”¨ã€æ•°æ®å­˜å‚¨æˆ–ä¸‹æ¸¸ä»»åŠ¡å¤„ç†ã€‚</p>
<p>å®ç°æ–¹å¼ - æ–¹å¼1ï¼šç”¨æˆ·è‡ªå·±é€šè¿‡æç¤ºè¯æŒ‡æ˜è¿”å›Jsonæ ¼å¼ - æ–¹å¼2ï¼šå€ŸåŠ©JsonOutputParserçš„get_format_instructions()ï¼Œç”Ÿæˆæ ¼å¼è¯´æ˜ï¼ŒæŒ‡å¯¼æ¨¡å‹è¾“å‡º JSON ç»“æ„</p>
<p>ä¸¾ä¾‹1ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">chat_prompt_template = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªé è°±çš„&#123;role&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;question&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ­£ç¡®çš„ï¼š  </span></span><br><span class="line">prompt = chat_prompt_template.invoke(  </span><br><span class="line">    <span class="built_in">input</span>=&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;äººå·¥æ™ºèƒ½ä¸“å®¶&quot;</span>, <span class="string">&quot;question&quot;</span>: <span class="string">&quot;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿé—®é¢˜ç”¨qè¡¨ç¤ºï¼Œç­”æ¡ˆç”¨aè¡¨ç¤ºï¼Œè¿”å›ä¸€ä¸ªJSONæ ¼å¼çš„æ•°æ®&quot;</span>&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é”™è¯¯çš„ï¼š  </span></span><br><span class="line"><span class="comment"># prompt = chat_prompt_template.invoke(input=&#123;&quot;role&quot;:&quot;äººå·¥æ™ºèƒ½ä¸“å®¶&quot;,&quot;question&quot;:&quot;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;&#125;)  </span></span><br><span class="line">  </span><br><span class="line">response = chat_model.invoke(prompt)  </span><br><span class="line"><span class="comment"># print(response.content)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–ä¸€ä¸ªJsonOutputParserçš„å®ä¾‹  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line">json_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;q&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Artificial Intelligence&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;q&#x27;<span class="punctuation">:</span> &#x27;äººå·¥æ™ºèƒ½ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ&#x27;<span class="punctuation">,</span> &#x27;a&#x27;<span class="punctuation">:</span> &#x27;Artificial Intelligence&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼•å…¥ä¾èµ–åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> JsonOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">joke_query = <span class="string">&quot;å‘Šè¯‰æˆ‘ä¸€ä¸ªç¬‘è¯ã€‚&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å®šä¹‰Jsonè§£æå™¨  </span></span><br><span class="line">parser = JsonOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#ä»¥PromptTemplateä¸ºä¾‹  </span></span><br><span class="line">prompt_template = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢\n æ»¡è¶³çš„æ ¼å¼ä¸º&#123;format_instructions&#125;\n é—®é¢˜ä¸º&#123;question&#125;\n&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;<span class="string">&quot;format_instructions&quot;</span>: parser.get_format_instructions()&#125;,  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt = prompt_template.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;question&quot;</span>: joke_query&#125;)  </span><br><span class="line">response = chat_model.invoke(prompt)  </span><br><span class="line"><span class="built_in">print</span>(response)  </span><br><span class="line">  </span><br><span class="line">json_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(json_result)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content=&#x27;```json\n<span class="punctuation">&#123;</span>\n  <span class="attr">&quot;joke&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä¸ºä»€ä¹ˆé¸¡è¿‡é©¬è·¯ï¼Ÿå› ä¸ºå®ƒæƒ³å»å¯¹é¢ï¼&quot;</span>\n<span class="punctuation">&#125;</span>\n```&#x27; additional_kwargs=<span class="punctuation">&#123;</span>&#x27;refusal&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span> response_metadata=<span class="punctuation">&#123;</span>&#x27;token_usage&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;completion_tokens&#x27;<span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span> &#x27;prompt_tokens&#x27;<span class="punctuation">:</span> <span class="number">32</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">59</span><span class="punctuation">,</span> &#x27;completion_tokens_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;accepted_prediction_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;audio_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;reasoning_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;rejected_prediction_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;prompt_tokens_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;audio_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;cached_tokens&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;model_name&#x27;<span class="punctuation">:</span> &#x27;gpt<span class="number">-4</span>o-mini<span class="number">-2024</span><span class="number">-07</span><span class="number">-18</span>&#x27;<span class="punctuation">,</span> &#x27;system_fingerprint&#x27;<span class="punctuation">:</span> &#x27;fp_efad92c60b&#x27;<span class="punctuation">,</span> &#x27;id&#x27;<span class="punctuation">:</span> &#x27;chatcmpl-C94MgvoSBRdCxkG0J6lBy3t0QJAoc&#x27;<span class="punctuation">,</span> &#x27;service_tier&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;finish_reason&#x27;<span class="punctuation">:</span> &#x27;stop&#x27;<span class="punctuation">,</span> &#x27;logprobs&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span> id=&#x27;run-<span class="number">-85</span>cc489c<span class="number">-68</span>f5<span class="number">-4e26</span>-bcda-ec0fa27a683e<span class="number">-0</span>&#x27; usage_metadata=<span class="punctuation">&#123;</span>&#x27;input_tokens&#x27;<span class="punctuation">:</span> <span class="number">32</span><span class="punctuation">,</span> &#x27;output_tokens&#x27;<span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span> &#x27;total_tokens&#x27;<span class="punctuation">:</span> <span class="number">59</span><span class="punctuation">,</span> &#x27;input_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;audio&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;cache_read&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> &#x27;output_token_details&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;audio&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> &#x27;reasoning&#x27;<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span>&#x27;joke&#x27;<span class="punctuation">:</span> &#x27;ä¸ºä»€ä¹ˆé¸¡è¿‡é©¬è·¯ï¼Ÿå› ä¸ºå®ƒæƒ³å»å¯¹é¢ï¼&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="xmlè§£æå™¨-xmloutputparser">â‘¢ XMLè§£æå™¨ XMLOutputParser</h3>
<p>XMLOutputParserï¼Œå°†æ¨¡å‹çš„è‡ªç”±æ–‡æœ¬è¾“å‡ºè½¬æ¢ä¸ºå¯ç¼–ç¨‹å¤„ç†çš„ XML æ•°æ®ã€‚ <strong>å¦‚ä½•å®ç°</strong>ï¼šåœ¨ PromptTemplate ä¸­æŒ‡å®š XML æ ¼å¼è¦æ±‚ï¼Œè®©æ¨¡å‹è¿”å› content å½¢å¼çš„æ•° æ®ã€‚ <strong>æ³¨æ„</strong>ï¼šXMLOutputParser ä¸ä¼šç›´æ¥å°†æ¨¡å‹çš„è¾“å‡ºä¿æŒä¸ºåŸå§‹XMLå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ä¼šè§£æXMLå¹¶è½¬æ¢æˆ Pythonå­—å…¸ï¼ˆæˆ–ç±»ä¼¼ç»“æ„åŒ–çš„æ•°æ®ï¼‰ã€‚ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºåç»­å¤„ç†æ•°æ®ï¼Œè€Œä¸æ˜¯å•çº¯ä¿ç•™XMLæ ¼ å¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">actor_query = <span class="string">&quot;å‘¨æ˜Ÿé©°çš„ç®€çŸ­ç”µå½±è®°å½•&quot;</span>  </span><br><span class="line">response = chat_model.invoke(<span class="string">f&quot;è¯·ç”Ÿæˆ<span class="subst">&#123;actor_query&#125;</span>ï¼Œå°†å½±ç‰‡é™„åœ¨&lt;movie&gt;&lt;/movie&gt;æ ‡ç­¾ä¸­&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response))  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> &#x27;<span class="attr">langchain_core.messages.ai.AIMessage</span>&#x27;&gt;</span></span><br><span class="line">å‘¨æ˜Ÿé©°ï¼ˆStephen Chowï¼‰æ˜¯ä¸€ä½è‘—åçš„ä¸­å›½æ¼”å‘˜ã€å¯¼æ¼”å’Œç¼–å‰§ï¼Œä»¥å…¶ç‹¬ç‰¹çš„å–œå‰§é£æ ¼å’Œå¹½é»˜æ‰åè€Œé—»åã€‚ä»¥ä¸‹æ˜¯ä»–çš„å‡ éƒ¨ç»å…¸ç”µå½±è®°å½•ï¼š</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>å¤§è¯è¥¿æ¸¸ä¹‹æœˆå…‰å®ç›’<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>1995<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>è¿™æ˜¯ä¸€éƒ¨èåˆäº†å–œå‰§ã€çˆ±æƒ…å’Œå¥‡å¹»å…ƒç´ çš„ç»å…¸ç”µå½±ï¼Œè®²è¿°äº†è‡³å°Šå®å’Œç´«éœä»™å­çš„çˆ±æƒ…æ•…äº‹ï¼Œæ‰“ç ´äº†ä¼ ç»Ÿçš„è¥¿æ¸¸è®°æƒ…èŠ‚ï¼Œæˆä¸ºåè¯­ç”µå½±çš„ç»å…¸ä¹‹ä½œã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>åŠŸå¤«<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2004<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>è¿™éƒ¨ç”µå½±æ˜¯ä¸€éƒ¨ç»“åˆäº†åŠŸå¤«ä¸å–œå‰§çš„å½±ç‰‡ï¼Œè®²è¿°äº†ä¸€åå°æ··æ··åœ¨æ„å¤–ä¸­èµ°ä¸Šæ­¦é“ä¹‹è·¯ï¼Œæœ€ç»ˆæˆé•¿ä¸ºä¸€åè‹±é›„çš„æ•…äº‹ã€‚è¯¥ç‰‡å› å…¶ç‹¬ç‰¹çš„è§†å¬æ•ˆæœå’Œå¹½é»˜é£æ ¼å—åˆ°å¹¿æ³›å¥½è¯„ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>é£Ÿç¥<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>1996<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>å½±ç‰‡è®²è¿°äº†ä¸€ä½å¤±å»å¨è‰ºçš„æ˜æ˜Ÿå¨å¸ˆåœ¨è‰°éš¾çš„ç¯å¢ƒä¸­é‡æ‹¾ä¿¡å¿ƒä¸æŠ€è‰ºï¼Œå¹¶æœ€ç»ˆæˆä¸ºé£Ÿç¥çš„åŠ±å¿—æ•…äº‹ï¼Œèåˆäº†ç¾é£Ÿå’Œæç¬‘å…ƒç´ ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>å°‘æ—è¶³çƒ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2001<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>è¿™æ˜¯ä¸€éƒ¨å°†è¶³çƒä¸å°‘æ—åŠŸå¤«ç»“åˆçš„å–œå‰§ç”µå½±ï¼Œè®²è¿°äº†ä¸€ç¾¤ç»æœ›çš„å°‘æ—å¯ºå¼Ÿå­é€šè¿‡è¶³çƒé‡æ‹¾ä¿¡å¿ƒçš„æ•…äº‹ï¼Œå±•ç°äº†å›¢é˜Ÿçš„åŠ›é‡å’Œå¹½é»˜ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>å–œå‰§ä¹‹ç‹<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>1999<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>æœ¬ç‰‡æ˜¯ä¸€éƒ¨å…³äºè¿½æ±‚æ¢¦æƒ³çš„å–œå‰§ï¼Œè®²è¿°äº†ä¸€ä¸ªåœ¨ç”µå½±ç•ŒæŒ£æ‰å¥‹æ–—çš„å¹´è½»äººï¼Œæœ€ç»ˆæ‰¾åˆ°è‡ªæˆ‘ä»·å€¼å’Œçˆ±æƒ…çš„æ„Ÿäººæ•…äº‹ã€‚<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼šä½“ä¼šXMLOutputParserçš„æ ¼å¼ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers.xml <span class="keyword">import</span> XMLOutputParser  </span><br><span class="line">  </span><br><span class="line">parser = XMLOutputParser()  </span><br><span class="line"><span class="built_in">print</span>(parser.get_format_instructions())</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">The output should be formatted as a XML file.</span><br><span class="line">1. Output should conform to the tags below.</span><br><span class="line">2. If tags are not given, make them on your own.</span><br><span class="line">3. Remember to always open and close all the tags.</span><br><span class="line"></span><br><span class="line">As an example, <span class="keyword">for</span> the tags [<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>]:</span><br><span class="line">1. String <span class="string">&quot;&lt;foo&gt;</span></span><br><span class="line"><span class="string">   &lt;bar&gt;</span></span><br><span class="line"><span class="string">      &lt;baz&gt;&lt;/baz&gt;</span></span><br><span class="line"><span class="string">   &lt;/bar&gt;</span></span><br><span class="line"><span class="string">&lt;/foo&gt;&quot;</span> is a well-formatted instance of the schema.</span><br><span class="line">2. String <span class="string">&quot;&lt;foo&gt;</span></span><br><span class="line"><span class="string">   &lt;bar&gt;</span></span><br><span class="line"><span class="string">   &lt;/foo&gt;&quot;</span> is a badly-formatted instance.</span><br><span class="line">3. String <span class="string">&quot;&lt;foo&gt;</span></span><br><span class="line"><span class="string">   &lt;tag&gt;</span></span><br><span class="line"><span class="string">   &lt;/tag&gt;</span></span><br><span class="line"><span class="string">&lt;/foo&gt;&quot;</span> is a badly-formatted instance.</span><br><span class="line"></span><br><span class="line">Here are the output tags:</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹3ï¼šXMLOutputParser çš„ä½¿ç”¨ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¯¼å…¥ç›¸å…³åŒ…  </span></span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> XMLOutputParser  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 2. åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 3.æµ‹è¯•æ¨¡å‹çš„xmlè§£ææ•ˆæœ  </span></span><br><span class="line">actor_query = <span class="string">&quot;ç”Ÿæˆæ±¤å§†Â·æ±‰å…‹æ–¯çš„ç®€çŸ­ç”µå½±è®°å½•,ä½¿ç”¨ä¸­æ–‡å›å¤&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 4.å®šä¹‰XMLOutputParserå¯¹è±¡  </span></span><br><span class="line">parser = XMLOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 5. ç”Ÿæˆæç¤ºè¯æ¨¡æ¿  </span></span><br><span class="line">prompt_template1 = PromptTemplate.from_template(  </span><br><span class="line">    template=<span class="string">&quot;ç”¨æˆ·çš„é—®é¢˜ï¼š&#123;query&#125;\nä½¿ç”¨çš„æ ¼å¼ï¼š&#123;format_instructions&#125;&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">prompt_template2 = prompt_template1.partial(format_instructions=parser.get_format_instructions())  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">response = chat_model.invoke(prompt_template2.invoke(<span class="built_in">input</span>=&#123;<span class="string">&quot;query&quot;</span>: actor_query&#125;))  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ç”µå½±è®°å½•</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">æ¼”å‘˜</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">åå­—</span>&gt;</span>æ±¤å§†Â·æ±‰å…‹æ–¯<span class="tag">&lt;/<span class="name">åå­—</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">å‡ºç”Ÿå¹´ä»½</span>&gt;</span>1956<span class="tag">&lt;/<span class="name">å‡ºç”Ÿå¹´ä»½</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ä»£è¡¨ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šé˜¿ç”˜æ­£ä¼ ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šæ‹¯æ•‘å¤§å…µç‘æ©ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šå¤±è€Œå¤å¾—ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šå¤–æ˜ŸäººE.T.ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ä½œå“</span>&gt;</span>ã€Šè´¹åŸæ•…äº‹ã€‹<span class="tag">&lt;/<span class="name">ä½œå“</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ä»£è¡¨ä½œå“</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">è·å¥–ç»å†</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">å¥–é¡¹</span>&gt;</span>å¥¥æ–¯å¡é‡‘åƒå¥–<span class="tag">&lt;/<span class="name">å¥–é¡¹</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">å¥–é¡¹</span>&gt;</span>é‡‘çƒå¥–<span class="tag">&lt;/<span class="name">å¥–é¡¹</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">å¥–é¡¹</span>&gt;</span>BAFTAå¥–<span class="tag">&lt;/<span class="name">å¥–é¡¹</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">è·å¥–ç»å†</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">æ¼”å‘˜</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ç”µå½±è®°å½•</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xml_result = parser.invoke(response)  </span><br><span class="line"><span class="built_in">print</span>(xml_result)</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;ç”µå½±è®°å½•&#x27;: [&#123;&#x27;æ¼”å‘˜&#x27;: [&#123;&#x27;åå­—&#x27;: &#x27;æ±¤å§†Â·æ±‰å…‹æ–¯&#x27;&#125;, &#123;&#x27;å‡ºç”Ÿå¹´ä»½&#x27;: &#x27;1956&#x27;&#125;, &#123;&#x27;ä»£è¡¨ä½œå“&#x27;: [&#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šé˜¿ç”˜æ­£ä¼ ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šæ‹¯æ•‘å¤§å…µç‘æ©ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šå¤±è€Œå¤å¾—ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šå¤–æ˜ŸäººE.T.ã€‹&#x27;&#125;, &#123;&#x27;ä½œå“&#x27;: &#x27;ã€Šè´¹åŸæ•…äº‹ã€‹&#x27;&#125;]&#125;, &#123;&#x27;è·å¥–ç»å†&#x27;: [&#123;&#x27;å¥–é¡¹&#x27;: &#x27;å¥¥æ–¯å¡é‡‘åƒå¥–&#x27;&#125;, &#123;&#x27;å¥–é¡¹&#x27;: &#x27;é‡‘çƒå¥–&#x27;&#125;, &#123;&#x27;å¥–é¡¹&#x27;: &#x27;BAFTAå¥–&#x27;&#125;]&#125;]&#125;]&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ—è¡¨è§£æå™¨-commaseparatedlistoutputparser">åˆ—è¡¨è§£æå™¨ CommaSeparatedListOutputParser</h2>
<p>åˆ—è¡¨è§£æå™¨ï¼šåˆ©ç”¨æ­¤è§£æå™¨å¯ä»¥å°†æ¨¡å‹çš„æ–‡æœ¬å“åº”è½¬æ¢ä¸ºä¸€ä¸ªç”¨<strong>é€—å·åˆ†éš”çš„åˆ—è¡¨ï¼ˆList[str]ï¼‰</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> CommaSeparatedListOutputParser  </span><br><span class="line">  </span><br><span class="line">output_parser = CommaSeparatedListOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¿”å›ä¸€äº›æŒ‡ä»¤æˆ–æ¨¡æ¿ï¼Œè¿™äº›æŒ‡ä»¤å‘Šè¯‰ç³»ç»Ÿå¦‚ä½•è§£ææˆ–æ ¼å¼åŒ–è¾“å‡ºæ•°æ®  </span></span><br><span class="line">format_instructions = output_parser.get_format_instructions()  </span><br><span class="line"><span class="built_in">print</span>(format_instructions)  </span><br><span class="line">  </span><br><span class="line">messages = <span class="string">&quot;å¤§è±¡,çŒ©çŒ©,ç‹®å­&quot;</span>  </span><br><span class="line">result = output_parser.parse(messages)  </span><br><span class="line"><span class="built_in">print</span>(result)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(result))</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Your response should be a list of comma separated values, eg: `foo, bar, baz` or `foo,bar,baz`</span><br><span class="line">[<span class="string">&#x27;å¤§è±¡&#x27;</span>, <span class="string">&#x27;çŒ©çŒ©&#x27;</span>, <span class="string">&#x27;ç‹®å­&#x27;</span>]</span><br><span class="line">&lt;class <span class="string">&#x27;list&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> PromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> CommaSeparatedListOutputParser  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹  </span></span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºè§£æå™¨  </span></span><br><span class="line">output_parser = CommaSeparatedListOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºLangChainæç¤ºæ¨¡æ¿  </span></span><br><span class="line">chat_prompt = PromptTemplate.from_template(  </span><br><span class="line">    <span class="string">&quot;ç”Ÿæˆ5ä¸ªå…³äº&#123;text&#125;çš„åˆ—è¡¨.\n\n&#123;format_instructions&#125;&quot;</span>,  </span><br><span class="line">    partial_variables=&#123;  </span><br><span class="line">    <span class="string">&quot;format_instructions&quot;</span>: output_parser.get_format_instructions()  </span><br><span class="line">    &#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æç¤ºæ¨¡æ¿ä¸è¾“å‡ºè§£æå™¨ä¼ é€’è¾“å‡º  </span></span><br><span class="line"><span class="comment"># chat_prompt = chat_prompt.partial(format_instructions=output_parser.get_format_instructions())  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># å°†æç¤ºå’Œæ¨¡å‹åˆå¹¶ä»¥è¿›è¡Œè°ƒç”¨  </span></span><br><span class="line">chain = chat_prompt | chat_model | output_parser  </span><br><span class="line">res = chain.invoke(&#123;<span class="string">&quot;text&quot;</span>: <span class="string">&quot;ç”µå½±&quot;</span>&#125;)  </span><br><span class="line"><span class="built_in">print</span>(res)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(res))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;1. åŠ¨ä½œç‰‡&#x27;</span>, <span class="string">&#x27;ç§‘å¹»ç‰‡&#x27;</span>, <span class="string">&#x27;ææ€–ç‰‡&#x27;</span>, <span class="string">&#x27;å–œå‰§ç‰‡&#x27;</span>, <span class="string">&#x27;çˆ±æƒ…ç‰‡  &#x27;</span>, <span class="string">&#x27;2. ç»å…¸ç”µå½±&#x27;</span>, <span class="string">&#x27;ç°ä»£ç”µå½±&#x27;</span>, <span class="string">&#x27;å¤–å›½ç”µå½±&#x27;</span>, <span class="string">&#x27;åŠ¨ç”»ç”µå½±&#x27;</span>, <span class="string">&#x27;çºªå½•ç‰‡  &#x27;</span>, <span class="string">&#x27;3. å¯¼æ¼”&#x27;</span>, <span class="string">&#x27;ç¼–å‰§&#x27;</span>, <span class="string">&#x27;ä¸»æ¼”&#x27;</span>, <span class="string">&#x27;é…è§’&#x27;</span>, <span class="string">&#x27;åˆ¶ç‰‡äºº  &#x27;</span>, <span class="string">&#x27;4. ç¥¨æˆ¿æ”¶å…¥&#x27;</span>, <span class="string">&#x27;å½±è¯„è¯„åˆ†&#x27;</span>, <span class="string">&#x27;è§‚ä¼—è¯„åˆ†&#x27;</span>, <span class="string">&#x27;å‚èµ›å¥–é¡¹&#x27;</span>, <span class="string">&#x27;å½±å±•è·å¥–  &#x27;</span>, <span class="string">&#x27;5. ç”µå½±ç±»å‹&#x27;</span>, <span class="string">&#x27;æ”¾æ˜ æ—¶é—´&#x27;</span>, <span class="string">&#x27;ç”µå½±æ—¶é•¿&#x27;</span>, <span class="string">&#x27;ç”µå½±è¯„åˆ†&#x27;</span>, <span class="string">&#x27;è§‚çœ‹æ–¹å¼  &#x27;</span>]</span><br><span class="line">&lt;class <span class="string">&#x27;list&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="æ—¥æœŸè§£æå™¨-datetimeoutputparser">æ—¥æœŸè§£æå™¨ DatetimeOutputParser</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> DatetimeOutputParser  </span><br><span class="line">  </span><br><span class="line">output_parser = DatetimeOutputParser()  </span><br><span class="line">  </span><br><span class="line">format_instructions = output_parser.get_format_instructions()  </span><br><span class="line"><span class="built_in">print</span>(format_instructions)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Write a datetime string that matches the following pattern: <span class="string">&#x27;%Y-%m-%dT%H:%M:%S.%fZ&#x27;</span>.</span><br><span class="line"></span><br><span class="line">Examples: 1853-04-07T06:45:24.945854Z, 0835-04-16T12:35:51.978680Z, 1877-10-31T12:04:45.397316Z</span><br><span class="line"></span><br><span class="line">Return ONLY this string, no other words!</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¾‹2ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI  </span><br><span class="line"><span class="keyword">from</span> langchain.prompts.chat <span class="keyword">import</span> HumanMessagePromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate  </span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> DatetimeOutputParser  </span><br><span class="line">  </span><br><span class="line">chat_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">chat_prompt = ChatPromptTemplate.from_messages([  </span><br><span class="line">    (<span class="string">&quot;system&quot;</span>,<span class="string">&quot;&#123;format_instructions&#125;&quot;</span>),  </span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;request&#125;&quot;</span>)  </span><br><span class="line">])  </span><br><span class="line">  </span><br><span class="line">output_parser = DatetimeOutputParser()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼1ï¼š  </span></span><br><span class="line"><span class="comment"># model_request = chat_prompt.format_messages(  </span></span><br><span class="line"><span class="comment">#     request=&quot;ä¸­åäººæ°‘å…±å’Œå›½æ˜¯ä»€ä¹ˆæ—¶å€™æˆç«‹çš„&quot;,  </span></span><br><span class="line"><span class="comment">#     format_instructions=output_parser.get_format_instructions()  </span></span><br><span class="line"><span class="comment"># )  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># response = chat_model.invoke(model_request)  </span></span><br><span class="line"><span class="comment"># result = output_parser.invoke(response)  </span></span><br><span class="line"><span class="comment"># print(result)  </span></span><br><span class="line"><span class="comment"># print(type(result))  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼š  </span></span><br><span class="line">chain = chat_prompt | chat_model | output_parser  </span><br><span class="line">resp = chain.invoke(&#123;<span class="string">&quot;request&quot;</span>:<span class="string">&quot;ä¸­åäººæ°‘å…±å’Œå›½æ˜¯ä»€ä¹ˆæ—¶å€™æˆç«‹çš„&quot;</span>,  </span><br><span class="line">                     <span class="string">&quot;format_instructions&quot;</span>:output_parser.get_format_instructions()&#125;)  </span><br><span class="line"><span class="built_in">print</span>(resp)  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(resp))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1949-10-01 00:00:00</span><br><span class="line">&lt;class <span class="string">&#x27;datetime.datetime&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<h1 id="langchainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹">LangChainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹</h1>
<p>ç¬¬1æ­¥ï¼šä¸‹è½½å¹¶å®‰è£…Ollama</p>
<p>ç¬¬2æ­¥ï¼šåœ¨Ollamaä¸‹éƒ¨ç½²å¤§æ¨¡å‹ï¼šdeepseek-r1:7b</p>
<p>ç¬¬3æ­¥ï¼šåœ¨LangChainä¸­è°ƒç”¨Ollamaä¸‹çš„å¤§æ¨¡å‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> HumanMessage  </span><br><span class="line"><span class="keyword">from</span> langchain_ollama <span class="keyword">import</span> ChatOllama  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ChatOpenAI()  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#æ­¤æ—¶è°ƒç”¨çš„æ˜¯æœ¬åœ°çš„å¤§æ¨¡å‹ã€‚çœç•¥base_urlã€api-key  </span></span><br><span class="line">llm = ChatOllama(  </span><br><span class="line">    model = <span class="string">&quot;deepseek-r1:7b&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># llm.invoke(&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ï¼&quot;)  </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">messages = [  </span><br><span class="line">    HumanMessage(content=<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ï¼&quot;</span>)  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">response = llm.invoke(messages)  </span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;think&gt;</span><br><span class="line">æ‚¨å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½çš„æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å…¬å¸å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚å¦‚æ‚¨æœ‰ä»»ä½•ä»»ä½•é—®é¢˜ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚</span><br><span class="line">&lt;/think&gt;</span><br><span class="line"></span><br><span class="line">æ‚¨å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½çš„æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å…¬å¸å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚å¦‚æ‚¨æœ‰ä»»ä½•ä»»ä½•é—®é¢˜ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io">Yinjin Yao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://cryingatnight.github.io/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/">https://cryingatnight.github.io/2025/09/29/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BModel%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://cryingatnight.github.io" target="_blank">Yinjin Yaoçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/LangChain/">LangChain</a></div><div class="post-share"><div class="social-share" data-image="/img/lita4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory"><img class="cover" src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Memory</div></div><div class="info-2"><div class="info-item-1">Memoryæ¦‚è¿° ä¸ºä»€ä¹ˆéœ€è¦Memory å¤§å¤šæ•°çš„å¤§æ¨¡å‹åº”ç”¨ç¨‹åºéƒ½ä¼šæœ‰ä¸€ä¸ªä¼šè¯æ¥å£ï¼Œå…è®¸æˆ‘ä»¬è¿›è¡Œå¤šè½®çš„å¯¹è¯ï¼Œå¹¶æœ‰ä¸€å®šçš„ä¸Šä¸‹æ–‡è®°å¿†èƒ½ åŠ›ã€‚  ä½†å®é™…ä¸Šï¼Œæ¨¡å‹æœ¬èº«æ˜¯ ä¸ä¼šè®°å¿†ä»»ä½•ä¸Šä¸‹æ–‡çš„ï¼Œåªèƒ½ä¾é ç”¨æˆ·æœ¬èº«çš„è¾“å…¥å»äº§ç”Ÿè¾“å‡ºã€‚  å¦‚ä½•å®ç°è®°å¿†åŠŸèƒ½å‘¢ï¼Ÿ å®ç°è¿™ä¸ªè®°å¿†åŠŸèƒ½ï¼Œå°±éœ€è¦ é¢å¤–çš„æ¨¡å—å»ä¿å­˜æˆ‘ä»¬å’Œæ¨¡å‹å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæŠŠ æ‰€æœ‰çš„å†å²ä¿¡æ¯éƒ½è¾“å…¥ç»™æ¨¡å‹ï¼Œè®©æ¨¡å‹è¾“å‡ºæœ€ç»ˆç»“æœã€‚ è€Œåœ¨ LangChain ä¸­ï¼Œæä¾›è¿™ä¸ªåŠŸèƒ½çš„æ¨¡å—å°±ç§°ä¸º Memory(è®°å¿†) ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·å’Œæ¨¡å‹äº¤äº’çš„å†å²ä¿¡æ¯ã€‚ ä»€ä¹ˆæ˜¯Memory Memoryï¼Œæ˜¯LangChainä¸­ç”¨äºå¤šè½®å¯¹è¯ä¸­ä¿å­˜å’Œç®¡ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ï¼‰çš„ç»„ä»¶ã€‚å®ƒè®©åº”ç”¨èƒ½å¤Ÿè®°ä½ç”¨æˆ·ä¹‹å‰è¯´äº†ä»€ä¹ˆï¼Œä»è€Œå®ç°å¯¹è¯çš„ æ„ŸçŸ¥çš„é“¾å¼å¯¹è¯ç³»ç»Ÿæä¾›äº†åŸºç¡€ã€‚ Memoryçš„è®¾è®¡ç†å¿µ   è¾“å…¥é—®é¢˜ï¼š({â€œquestionâ€: â€¦}) è¯»å–å†å²æ¶ˆæ¯ï¼šä»Memoryä¸­READå†å²æ¶ˆæ¯ï¼ˆ{â€œpast_messagesâ€: [â€¦]}ï¼‰ æ„å»ºæç¤ºï¼ˆPrompt)ï¼šè¯»å–åˆ°çš„å†å²æ¶ˆæ¯å’Œå½“å‰é—®é¢˜ä¼šè¢«åˆå¹¶ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„Prompt...</div></div></div></a><a class="pagination-related" href="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/" title="LangChainä½¿ç”¨ä¹‹Retrieval"><img class="cover" src="/img/lita8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Retrieval</div></div><div class="info-2"><div class="info-item-1">Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰ å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜ æ‹¥æœ‰è®°å¿†åï¼Œç¡®å®æ‰©å±•äº†AIå·¥ç¨‹çš„åº”ç”¨åœºæ™¯ã€‚ ä½†æ˜¯åœ¨ä¸“æœ‰é¢†åŸŸï¼ŒLLMæ— æ³•å­¦ä¹ åˆ°æ‰€æœ‰çš„ä¸“ä¸šçŸ¥è¯†ç»†èŠ‚ï¼Œå› æ­¤åœ¨ é¢å‘ä¸“ä¸šé¢†åŸŸçŸ¥è¯†çš„æé—®æ—¶ï¼Œæ— æ³•ç»™å‡º å¯é å‡†ç¡®çš„å›ç­”ï¼Œç”šè‡³ä¼šâ€œèƒ¡è¨€ä¹±è¯­â€ï¼Œè¿™ç§ç°è±¡ç§°ä¹‹ä¸º LLMçš„â€œå¹»è§‰â€ã€‚ å¤§æ¨¡å‹ç”Ÿæˆå†…å®¹çš„ä¸å¯æ§ï¼Œå°¤å…¶æ˜¯åœ¨é‡‘èå’ŒåŒ»ç–—é¢†åŸŸç­‰é¢†åŸŸï¼Œä¸€æ¬¡é‡‘é¢è¯„ä¼°çš„é”™è¯¯ï¼Œä¸€æ¬¡åŒ»ç–—è¯Šæ–­çš„å¤±è¯¯ï¼Œå“ªæ€•åªå‡ºç°ä¸€æ¬¡éƒ½æ˜¯è‡´å‘½çš„ã€‚ä½†ï¼Œå¯¹äºéä¸“ä¸šäººå£«æ¥è¯´å¯èƒ½éš¾ä»¥è¾¨è¯†ã€‚ç›®å‰è¿˜æ²¡æœ‰èƒ½å¤Ÿç™¾åˆ†ä¹‹ç™¾è§£å†³è¿™ç§æƒ…å†µçš„æ–¹æ¡ˆã€‚ å½“å‰å¤§å®¶æ™®éè¾¾æˆå…±è¯†çš„ä¸€ä¸ªæ–¹æ¡ˆï¼š é¦–å…ˆï¼Œä¸ºå¤§æ¨¡å‹æä¾›ä¸€å®šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè®©å…¶è¾“å‡ºä¼šå˜å¾—æ›´ç¨³å®šã€‚ å…¶æ¬¡ï¼Œåˆ©ç”¨æœ¬ç« çš„RAGï¼Œå°†æ£€ç´¢å‡ºæ¥çš„ æ–‡æ¡£å’Œæç¤ºè¯è¾“é€ç»™å¤§æ¨¡å‹ï¼Œç”Ÿæˆæ›´å¯é çš„ç­”æ¡ˆã€‚ RAGçš„ä¼˜ç¼ºç‚¹  RAGçš„ä¼˜ç‚¹  ç›¸æ¯”æç¤ºè¯å·¥ç¨‹ï¼ŒRAGæœ‰ æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡å’Œæ•°æ®æ ·æœ¬ï¼Œå¯ä»¥ä¸éœ€è¦ç”¨æˆ·æä¾›è¿‡å¤šçš„èƒŒæ™¯æè¿°ï¼Œå°±èƒ½ç”Ÿ æˆæ¯”è¾ƒç¬¦åˆç”¨æˆ·é¢„æœŸçš„ç­”æ¡ˆã€‚ ç›¸æ¯”äºæ¨¡å‹å¾®è°ƒï¼ŒRAGå¯ä»¥æå‡é—®ç­”å†…å®¹çš„ æ—¶æ•ˆæ€§å’Œ å¯é æ€§ åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤äº†ä¸šåŠ¡æ•°æ®çš„ éšç§æ€§ã€‚  RAGçš„ç¼ºç‚¹  ç”±äºæ¯æ¬¡é—®ç­”éƒ½æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿæ•°æ®æ£€ç´¢ï¼Œå› æ­¤RAG...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory"><img class="cover" src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-13</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Memory</div></div><div class="info-2"><div class="info-item-1">Memoryæ¦‚è¿° ä¸ºä»€ä¹ˆéœ€è¦Memory å¤§å¤šæ•°çš„å¤§æ¨¡å‹åº”ç”¨ç¨‹åºéƒ½ä¼šæœ‰ä¸€ä¸ªä¼šè¯æ¥å£ï¼Œå…è®¸æˆ‘ä»¬è¿›è¡Œå¤šè½®çš„å¯¹è¯ï¼Œå¹¶æœ‰ä¸€å®šçš„ä¸Šä¸‹æ–‡è®°å¿†èƒ½ åŠ›ã€‚  ä½†å®é™…ä¸Šï¼Œæ¨¡å‹æœ¬èº«æ˜¯ ä¸ä¼šè®°å¿†ä»»ä½•ä¸Šä¸‹æ–‡çš„ï¼Œåªèƒ½ä¾é ç”¨æˆ·æœ¬èº«çš„è¾“å…¥å»äº§ç”Ÿè¾“å‡ºã€‚  å¦‚ä½•å®ç°è®°å¿†åŠŸèƒ½å‘¢ï¼Ÿ å®ç°è¿™ä¸ªè®°å¿†åŠŸèƒ½ï¼Œå°±éœ€è¦ é¢å¤–çš„æ¨¡å—å»ä¿å­˜æˆ‘ä»¬å’Œæ¨¡å‹å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæŠŠ æ‰€æœ‰çš„å†å²ä¿¡æ¯éƒ½è¾“å…¥ç»™æ¨¡å‹ï¼Œè®©æ¨¡å‹è¾“å‡ºæœ€ç»ˆç»“æœã€‚ è€Œåœ¨ LangChain ä¸­ï¼Œæä¾›è¿™ä¸ªåŠŸèƒ½çš„æ¨¡å—å°±ç§°ä¸º Memory(è®°å¿†) ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·å’Œæ¨¡å‹äº¤äº’çš„å†å²ä¿¡æ¯ã€‚ ä»€ä¹ˆæ˜¯Memory Memoryï¼Œæ˜¯LangChainä¸­ç”¨äºå¤šè½®å¯¹è¯ä¸­ä¿å­˜å’Œç®¡ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ï¼‰çš„ç»„ä»¶ã€‚å®ƒè®©åº”ç”¨èƒ½å¤Ÿè®°ä½ç”¨æˆ·ä¹‹å‰è¯´äº†ä»€ä¹ˆï¼Œä»è€Œå®ç°å¯¹è¯çš„ æ„ŸçŸ¥çš„é“¾å¼å¯¹è¯ç³»ç»Ÿæä¾›äº†åŸºç¡€ã€‚ Memoryçš„è®¾è®¡ç†å¿µ   è¾“å…¥é—®é¢˜ï¼š({â€œquestionâ€: â€¦}) è¯»å–å†å²æ¶ˆæ¯ï¼šä»Memoryä¸­READå†å²æ¶ˆæ¯ï¼ˆ{â€œpast_messagesâ€: [â€¦]}ï¼‰ æ„å»ºæç¤ºï¼ˆPrompt)ï¼šè¯»å–åˆ°çš„å†å²æ¶ˆæ¯å’Œå½“å‰é—®é¢˜ä¼šè¢«åˆå¹¶ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„Prompt...</div></div></div></a><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BChains/" title="LangChainä½¿ç”¨ä¹‹Chains"><img class="cover" src="/img/lita6.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-13</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Chains</div></div><div class="info-2"><div class="info-item-1">Chainsçš„åŸºæœ¬ä½¿ç”¨ Chainçš„åŸºæœ¬æ¦‚å¿µ Chainï¼šé“¾ï¼Œç”¨äºå°†å¤šä¸ªç»„ä»¶ï¼ˆæç¤ºæ¨¡æ¿ã€LLMæ¨¡å‹ã€è®°å¿†ã€å·¥å…·ç­‰ï¼‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆå¯å¤ç”¨çš„å·¥ä½œæµï¼Œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚ Chain çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç»„åˆä¸åŒçš„æ¨¡å—åŒ–å•å…ƒï¼Œå®ç°æ¯”å•ä¸€ç»„ä»¶æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼š - å°†LLMä¸ Prompt Template ï¼ˆæç¤ºæ¨¡æ¿ï¼‰ç»“åˆ - å°†LLMä¸ è¾“å‡ºè§£æå™¨ç»“åˆ - å°†LLMä¸ å¤–éƒ¨æ•°æ®ç»“åˆï¼Œä¾‹å¦‚ç”¨äºé—®ç­” - å°†LLMä¸ é•¿æœŸè®°å¿†ç»“åˆï¼Œä¾‹å¦‚ç”¨äºèŠå¤©å†å²è®°å½• - é€šè¿‡å°† ç¬¬ä¸€ä¸ªLLM çš„è¾“å‡ºä½œä¸ºç¬¬äºŒä¸ªLLM çš„è¾“å…¥ï¼Œâ€¦ï¼Œå°†å¤šä¸ªLLMæŒ‰é¡ºåºç»“åˆåœ¨ä¸€èµ· LCEL åŠå…¶åŸºæœ¬æ„æˆ ä½¿ç”¨LCELï¼Œå¯ä»¥æ„é€ å‡ºç»“æ„æœ€ç®€å•çš„Chainã€‚ LangChainè¡¨è¾¾å¼è¯­è¨€ï¼ˆLCELï¼ŒLangChain Expression Languageï¼‰æ˜¯ä¸€ç§å£°æ˜å¼æ–¹æ³•ï¼Œå¯ä»¥è½»æ¾åœ° å°†å¤šä¸ªç»„ä»¶é“¾æ¥æˆ AI å·¥ä½œæµã€‚å®ƒé€šè¿‡PythonåŸç”Ÿæ“ä½œç¬¦ï¼ˆå¦‚ç®¡é“ç¬¦|ï¼‰å°†ç»„ä»¶è¿æ¥æˆå¯æ‰§è¡Œæµç¨‹ï¼Œæ˜¾ è‘—ç®€åŒ–äº†AIåº”ç”¨çš„å¼€å‘ã€‚ LCELçš„åŸºæœ¬æ„æˆï¼šæç¤ºï¼ˆPromptï¼‰+ æ¨¡å‹ï¼ˆModelï¼‰+ è¾“å‡ºè§£æå™¨ï¼ˆOutputParserï¼‰ å³ï¼š ...</div></div></div></a><a class="pagination-related" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools"><img class="cover" src="/img/lita3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-13</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Tools</div></div><div class="info-2"><div class="info-item-1"> </div></div></div></a><a class="pagination-related" href="/2025/09/26/LangChain%E4%BD%BF%E7%94%A8%E6%A6%82%E8%BF%B0/" title="LangChainä½¿ç”¨æ¦‚è¿°"><img class="cover" src="/img/lita5.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-26</div><div class="info-item-2">LangChainä½¿ç”¨æ¦‚è¿°</div></div><div class="info-2"><div class="info-item-1">LangChainä½¿ç”¨æ¦‚è¿° LangChainçš„ä½¿ç”¨åœºæ™¯    é¡¹ç›®åç§° æŠ€æœ¯ç‚¹ éš¾åº¦     æ–‡æ¡£é—®ç­”åŠ©æ‰‹ Prompt + Embedding + RetrievalQA â­â­   æ™ºèƒ½æ—¥ç¨‹è§„åˆ’åŠ©æ‰‹ Agent + Tool + Memory â­â­â­   LLM+æ•°æ®åº“é—®ç­” SQLDatabaseToolkit + Agent â­â­â­â­   å¤šæ¨¡å‹è·¯ç”±å¯¹è¯ç³»ç»Ÿ RouterChain + å¤š LLM â­â­â­â­   äº’è”ç½‘æ™ºèƒ½å®¢æœ ConversationChain + RAG +Agent â­â­â­â­â­   ä¼ä¸šçŸ¥è¯†åº“åŠ©æ‰‹ï¼ˆRAG + æœ¬åœ°æ¨¡ å‹ï¼‰ VectorDB + LLM + Streamlit â­â­â­â­â­    LangChainèµ„æ–™ä»‹ç»  å®˜ç½‘åœ°å€ï¼šhttps://www.langchain.com/langchain å®˜ç½‘æ–‡æ¡£ï¼šhttps://python.langchain.com/docs/introduction/ APIæ–‡æ¡£ï¼šhttps://python.langc...</div></div></div></a><a class="pagination-related" href="/2025/09/28/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BRetrieval/" title="LangChainä½¿ç”¨ä¹‹Retrieval"><img class="cover" src="/img/lita8.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-28</div><div class="info-item-2">LangChainä½¿ç”¨ä¹‹Retrieval</div></div><div class="info-2"><div class="info-item-1">Retrievalæ¨¡å—çš„è®¾è®¡æ„ä¹‰ å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜ æ‹¥æœ‰è®°å¿†åï¼Œç¡®å®æ‰©å±•äº†AIå·¥ç¨‹çš„åº”ç”¨åœºæ™¯ã€‚ ä½†æ˜¯åœ¨ä¸“æœ‰é¢†åŸŸï¼ŒLLMæ— æ³•å­¦ä¹ åˆ°æ‰€æœ‰çš„ä¸“ä¸šçŸ¥è¯†ç»†èŠ‚ï¼Œå› æ­¤åœ¨ é¢å‘ä¸“ä¸šé¢†åŸŸçŸ¥è¯†çš„æé—®æ—¶ï¼Œæ— æ³•ç»™å‡º å¯é å‡†ç¡®çš„å›ç­”ï¼Œç”šè‡³ä¼šâ€œèƒ¡è¨€ä¹±è¯­â€ï¼Œè¿™ç§ç°è±¡ç§°ä¹‹ä¸º LLMçš„â€œå¹»è§‰â€ã€‚ å¤§æ¨¡å‹ç”Ÿæˆå†…å®¹çš„ä¸å¯æ§ï¼Œå°¤å…¶æ˜¯åœ¨é‡‘èå’ŒåŒ»ç–—é¢†åŸŸç­‰é¢†åŸŸï¼Œä¸€æ¬¡é‡‘é¢è¯„ä¼°çš„é”™è¯¯ï¼Œä¸€æ¬¡åŒ»ç–—è¯Šæ–­çš„å¤±è¯¯ï¼Œå“ªæ€•åªå‡ºç°ä¸€æ¬¡éƒ½æ˜¯è‡´å‘½çš„ã€‚ä½†ï¼Œå¯¹äºéä¸“ä¸šäººå£«æ¥è¯´å¯èƒ½éš¾ä»¥è¾¨è¯†ã€‚ç›®å‰è¿˜æ²¡æœ‰èƒ½å¤Ÿç™¾åˆ†ä¹‹ç™¾è§£å†³è¿™ç§æƒ…å†µçš„æ–¹æ¡ˆã€‚ å½“å‰å¤§å®¶æ™®éè¾¾æˆå…±è¯†çš„ä¸€ä¸ªæ–¹æ¡ˆï¼š é¦–å…ˆï¼Œä¸ºå¤§æ¨¡å‹æä¾›ä¸€å®šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè®©å…¶è¾“å‡ºä¼šå˜å¾—æ›´ç¨³å®šã€‚ å…¶æ¬¡ï¼Œåˆ©ç”¨æœ¬ç« çš„RAGï¼Œå°†æ£€ç´¢å‡ºæ¥çš„ æ–‡æ¡£å’Œæç¤ºè¯è¾“é€ç»™å¤§æ¨¡å‹ï¼Œç”Ÿæˆæ›´å¯é çš„ç­”æ¡ˆã€‚ RAGçš„ä¼˜ç¼ºç‚¹  RAGçš„ä¼˜ç‚¹  ç›¸æ¯”æç¤ºè¯å·¥ç¨‹ï¼ŒRAGæœ‰ æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡å’Œæ•°æ®æ ·æœ¬ï¼Œå¯ä»¥ä¸éœ€è¦ç”¨æˆ·æä¾›è¿‡å¤šçš„èƒŒæ™¯æè¿°ï¼Œå°±èƒ½ç”Ÿ æˆæ¯”è¾ƒç¬¦åˆç”¨æˆ·é¢„æœŸçš„ç­”æ¡ˆã€‚ ç›¸æ¯”äºæ¨¡å‹å¾®è°ƒï¼ŒRAGå¯ä»¥æå‡é—®ç­”å†…å®¹çš„ æ—¶æ•ˆæ€§å’Œ å¯é æ€§ åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤äº†ä¸šåŠ¡æ•°æ®çš„ éšç§æ€§ã€‚  RAGçš„ç¼ºç‚¹  ç”±äºæ¯æ¬¡é—®ç­”éƒ½æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿæ•°æ®æ£€ç´¢ï¼Œå› æ­¤RAG...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/headimage.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yinjin Yao</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cryingatnight/cryingatnight.github.io"><i class="fab fa-github"></i><span>å…³æ³¨</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/cryingatnight/cryingatnight.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1816192779@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#model-io%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">Model I&#x2F;Oä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B1llms%E9%9D%9E%E5%AF%B9%E8%AF%9D%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">ç±»å‹1ï¼šLLMs(éå¯¹è¯æ¨¡å‹)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B2chat-models%E5%AF%B9%E8%AF%9D%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text">ç±»å‹2ï¼šChat Models(å¯¹è¯æ¨¡å‹)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B3embedding-model%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">ç±»å‹3ï¼šEmbedding Model(åµŒå…¥æ¨¡å‹)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%92%E5%BA%A62%E5%87%BA%E5%8F%91%E5%8F%82%E6%95%B0%E4%BD%8D%E7%BD%AE%E4%B8%8D%E5%90%8C%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.4.</span> <span class="toc-text">è§’åº¦2å‡ºå‘ï¼šå‚æ•°ä½ç½®ä¸åŒä¸¾ä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%B0%83%E7%94%A8%E7%9A%84%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%E5%8F%8A%E5%8F%82%E6%95%B0"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ¨¡å‹è°ƒç”¨çš„ä¸»è¦æ–¹æ³•åŠå‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%E7%A1%AC%E7%BC%96%E7%A0%81"><span class="toc-number">1.4.2.</span> <span class="toc-text">æ–¹å¼1ï¼šç¡¬ç¼–ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">1.4.3.</span> <span class="toc-text">æ–¹å¼2ï¼šé…ç½®ç¯å¢ƒå˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F3%E4%BD%BF%E7%94%A8.env%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.4.</span> <span class="toc-text">æ–¹å¼3ï¼šä½¿ç”¨.envé…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93%E8%8E%B7%E5%8F%96%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%A0%87%E5%87%86%E6%96%B9%E5%BC%8F"><span class="toc-number">1.4.5.</span> <span class="toc-text">å°ç»“ï¼šè·å–å¤§æ¨¡å‹çš„æ ‡å‡†æ–¹å¼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#model-io%E4%B9%8B%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B2"><span class="toc-number">2.</span> <span class="toc-text">Model I&#x2F;Oä¹‹è°ƒç”¨æ¨¡å‹2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%AF%B9%E8%AF%9D%E6%A8%A1%E5%9E%8B%E7%9A%84message%E6%B6%88%E6%81%AF"><span class="toc-number">2.1.</span> <span class="toc-text">å…³äºå¯¹è¯æ¨¡å‹çš„Message(æ¶ˆæ¯)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%A4%9A%E8%BD%AE%E5%AF%B9%E8%AF%9D%E4%B8%8E%E4%B8%8A%E4%B8%8B%E6%96%87%E8%AE%B0%E5%BF%86"><span class="toc-number">2.2.</span> <span class="toc-text">å…³äºå¤šè½®å¯¹è¯ä¸ä¸Šä¸‹æ–‡è®°å¿†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E6%A8%A1%E5%9E%8B%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text">å…³äºæ¨¡å‹è°ƒç”¨çš„æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B1%E9%9D%9E%E6%B5%81%E5%BC%8F%E8%BE%93%E5%87%BA"><span class="toc-number">2.3.1.</span> <span class="toc-text">ä¸¾ä¾‹1ï¼šéæµå¼è¾“å‡ºï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B2%E6%B5%81%E5%BC%8F%E7%9A%84%E6%BC%94%E7%A4%BA"><span class="toc-number">2.3.2.</span> <span class="toc-text">ä¸¾ä¾‹2ï¼šæµå¼çš„æ¼”ç¤º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B3%E4%BD%BF%E7%94%A8batch%E6%B5%8B%E8%AF%95%E6%89%B9%E9%87%8F%E8%B0%83%E7%94%A8"><span class="toc-number">2.3.3.</span> <span class="toc-text">ä¸¾ä¾‹3ï¼šä½¿ç”¨batchï¼Œæµ‹è¯•æ‰¹é‡è°ƒç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B4%E5%85%B3%E4%BA%8E%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5%E6%96%B9%E6%B3%95%E7%9A%84%E8%B0%83%E7%94%A8"><span class="toc-number">2.3.4.</span> <span class="toc-text">ä¸¾ä¾‹4ï¼šå…³äºåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#model-io%E4%B9%8Bprompt-template"><span class="toc-number">3.</span> <span class="toc-text">Model I&#x2F;Oä¹‹Prompt Template</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%88%86%E7%B1%BB"><span class="toc-number">3.1.</span> <span class="toc-text">ä»‹ç»ä¸åˆ†ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8prompttemplate"><span class="toc-number">3.2.</span> <span class="toc-text">å…·ä½“ä½¿ç”¨ï¼šPromptTemplate</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="toc-number">3.2.1.</span> <span class="toc-text">ä½¿ç”¨è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%96%B9%E5%BC%8F"><span class="toc-number">3.2.2.</span> <span class="toc-text">ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">æ–¹å¼1ï¼šä½¿ç”¨æ„é€ æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B2%E5%AE%9A%E4%B9%89%E5%A4%9A%E5%8F%98%E9%87%8F%E6%A8%A1%E6%9D%BF%E6%8E%A8%E8%8D%90"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">ä¸¾ä¾‹2ï¼šå®šä¹‰å¤šå˜é‡æ¨¡æ¿(æ¨è)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E6%96%B0%E7%9A%84%E7%BB%93%E6%9E%84%E5%BD%A2%E5%BC%8F"><span class="toc-number">3.2.3.</span> <span class="toc-text">ä¸¤ç§æ–°çš„ç»“æ„å½¢å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%A2%E5%BC%8F1%E9%83%A8%E5%88%86%E6%8F%90%E7%A4%BA%E8%AF%8D%E6%A8%A1%E7%89%88"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">å½¢å¼1ï¼šéƒ¨åˆ†æç¤ºè¯æ¨¡ç‰ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95partial"><span class="toc-number">3.2.3.2.</span> <span class="toc-text">æ–¹å¼2ï¼šè°ƒç”¨æ–¹æ³•partial()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%8F%90%E7%A4%BA%E8%AF%8D%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BA%86%E8%A7%A3"><span class="toc-number">3.2.3.3.</span> <span class="toc-text">ç»„åˆæç¤ºè¯çš„ä½¿ç”¨ï¼ˆäº†è§£ï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%99%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8Fformat-invoke"><span class="toc-number">3.3.</span> <span class="toc-text">ç»™å˜é‡èµ‹å€¼çš„ä¸¤ç§æ–¹å¼ï¼šformat() &#x2F; invoke()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E5%90%88%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.4.</span> <span class="toc-text">ç»“åˆå¤§æ¨¡å‹çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8chatprompttemplate"><span class="toc-number">3.5.</span> <span class="toc-text">å…·ä½“ä½¿ç”¨ï¼šChatPromptTemplate</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%8C%96%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">3.5.1.</span> <span class="toc-text">å®ä¾‹åŒ–çš„æ–¹å¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E6%8F%90%E7%A4%BA%E8%AF%8D%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E6%B3%95"><span class="toc-number">3.5.2.</span> <span class="toc-text">è°ƒç”¨æç¤ºè¯æ¨¡æ¿çš„å‡ ç§æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E4%B8%B0%E5%AF%8C%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.6.</span> <span class="toc-text">æ›´ä¸°å¯Œçš„å®ä¾‹åŒ–å‚æ•°ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E5%90%88llm"><span class="toc-number">3.7.</span> <span class="toc-text">ç»“åˆLLM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%B6%88%E6%81%AF%E5%88%97%E8%A1%A8messageplaceholder"><span class="toc-number">3.8.</span> <span class="toc-text">æ’å…¥æ¶ˆæ¯åˆ—è¡¨ï¼šMessagePlaceholder</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%91%E9%87%8F%E7%A4%BA%E4%BE%8B%E7%9A%84%E6%8F%90%E7%A4%BA%E8%AF%8D%E6%A8%A1%E6%9D%BF%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">å°‘é‡ç¤ºä¾‹çš„æç¤ºè¯æ¨¡æ¿çš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-1"><span class="toc-number">4.1.</span> <span class="toc-text">ä½¿ç”¨è¯´æ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fewshotprompttemplate%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">FewShotPromptTemplateçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fewshotchatmessageprompttemplate%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.3.</span> <span class="toc-text">FewShotChatMessagePromptTemplateçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example-selectors%E7%A4%BA%E4%BE%8B%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">4.4.</span> <span class="toc-text">Example selectors(ç¤ºä¾‹é€‰æ‹©å™¨)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8E%E6%96%87%E6%A1%A3%E4%B8%AD%E5%8A%A0%E8%BD%BDprompt%E4%BA%86%E8%A7%A3"><span class="toc-number">5.</span> <span class="toc-text">ä»æ–‡æ¡£ä¸­åŠ è½½Prompt(äº†è§£)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#json%E6%A0%BC%E5%BC%8F%E6%8F%90%E7%A4%BA%E8%AF%8D"><span class="toc-number">5.1.</span> <span class="toc-text">jsonæ ¼å¼æç¤ºè¯</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#model-io%E4%B9%8Boutput-parsers"><span class="toc-number">6.</span> <span class="toc-text">Model I&#x2F;Oä¹‹Output Parsers</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E8%A7%A3%E6%9E%90%E5%99%A8%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">6.1.</span> <span class="toc-text">è¾“å‡ºè§£æå™¨çš„åˆ†ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E8%A7%A3%E6%9E%90%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">6.2.</span> <span class="toc-text">å…·ä½“è§£æå™¨çš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E5%99%A8-stroutputparser"><span class="toc-number">6.2.1.</span> <span class="toc-text">â‘  å­—ç¬¦ä¸²è§£æå™¨ StrOutputParser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#json%E8%A7%A3%E6%9E%90%E5%99%A8-jsonoutputparser"><span class="toc-number">6.2.2.</span> <span class="toc-text">â‘¡ JSONè§£æå™¨ JsonOutputParser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xml%E8%A7%A3%E6%9E%90%E5%99%A8-xmloutputparser"><span class="toc-number">6.2.3.</span> <span class="toc-text">â‘¢ XMLè§£æå™¨ XMLOutputParser</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E8%A7%A3%E6%9E%90%E5%99%A8-commaseparatedlistoutputparser"><span class="toc-number">6.3.</span> <span class="toc-text">åˆ—è¡¨è§£æå™¨ CommaSeparatedListOutputParser</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E8%A7%A3%E6%9E%90%E5%99%A8-datetimeoutputparser"><span class="toc-number">6.4.</span> <span class="toc-text">æ—¥æœŸè§£æå™¨ DatetimeOutputParser</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#langchain%E8%B0%83%E7%94%A8%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B"><span class="toc-number">7.</span> <span class="toc-text">LangChainè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" title="Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·"><img src="/img/lita5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·"/></a><div class="content"><a class="title" href="/2025/10/18/Maven%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" title="Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·">Mavenä¾èµ–ç®¡ç†é¡¹ç›®æ„å»ºå·¥å…·</a><time datetime="2025-10-18T11:44:55.269Z" title="æ›´æ–°äº 2025-10-18 19:44:55">2025-10-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools"><img src="/img/lita3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChainä½¿ç”¨ä¹‹Tools"/></a><div class="content"><a class="title" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BTools/" title="LangChainä½¿ç”¨ä¹‹Tools">LangChainä½¿ç”¨ä¹‹Tools</a><time datetime="2025-10-13T03:16:46.008Z" title="æ›´æ–°äº 2025-10-13 11:16:46">2025-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory"><img src="/img/%E4%BA%94%E6%9D%A1%E6%82%9F.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChainä½¿ç”¨ä¹‹Memory"/></a><div class="content"><a class="title" href="/2025/10/13/LangChain%E4%BD%BF%E7%94%A8%E4%B9%8BMemory/" title="LangChainä½¿ç”¨ä¹‹Memory">LangChainä½¿ç”¨ä¹‹Memory</a><time datetime="2025-10-13T03:15:12.499Z" title="æ›´æ–°äº 2025-10-13 11:15:12">2025-10-13</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Yinjin Yao</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text">æ„Ÿè°¢é˜…è¯»</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="è¾“å…¥ä»¥æœç´¢å†…å®¹..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>